import{A as jb,B as bn,C as hi,D as Qd,E as $c,F as o_,G as Bb,H as Ub,I as G,J as on,K as ft,L as a_,M as $b,N as Hc,O as fe,P as pn,Q as Yd,R as c_,S as Dn,T as fi,U as us,V as Zd,W as Hb,X as $n,Y as St,a as A,b as oe,c as r_,d as g,e as Mb,f as qd,g as Nb,h as Rb,i as T,j as So,k as Gd,l as Pb,m as kb,n as yt,o as zd,p as Uc,q as i_,r as Ob,s as ar,t as s_,u as Wd,v as Fb,w as Vb,x as Kd,y as et,z as Lb}from"./chunk-44ZLHZR4.js";var qb=null;var l_=1,u_=Symbol("SIGNAL");function De(t){let e=qb;return qb=t,e}var Gb={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function GF(t){if(!(f_(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===l_)){if(!t.producerMustRecompute(t)&&!d_(t)){t.dirty=!1,t.lastCleanEpoch=l_;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=l_}}function zb(t){return t&&(t.nextProducerIndex=0),De(t)}function Wb(t,e){if(De(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(f_(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)h_(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function d_(t){Xd(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(GF(n),r!==n.version))return!0}return!1}function Kb(t){if(Xd(t),f_(t))for(let e=0;e<t.producerNode.length;e++)h_(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function h_(t,e){if(zF(t),Xd(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)h_(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];Xd(i),i.producerIndexOfThis[r]=e}}function f_(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function Xd(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function zF(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function WF(){throw new Error}var KF=WF;function Qb(t){KF=t}function Q(t){return typeof t=="function"}function Ao(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Jd=Ao(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function ds(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Qe=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(Q(r))try{r()}catch(s){e=s instanceof Jd?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{Yb(s)}catch(o){e=e??[],o instanceof Jd?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Jd(e)}}add(e){var n;if(e&&e!==this)if(this.closed)Yb(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&ds(n,e)}remove(e){let{_finalizers:n}=this;n&&ds(n,e),e instanceof t&&e._removeParent(this)}};Qe.EMPTY=(()=>{let t=new Qe;return t.closed=!0,t})();var p_=Qe.EMPTY;function eh(t){return t instanceof Qe||t&&"closed"in t&&Q(t.remove)&&Q(t.add)&&Q(t.unsubscribe)}function Yb(t){Q(t)?t():t.unsubscribe()}var Hn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Mo={setTimeout(t,e,...n){let{delegate:r}=Mo;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=Mo;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function th(t){Mo.setTimeout(()=>{let{onUnhandledError:e}=Hn;if(e)e(t);else throw t})}function hs(){}var Zb=g_("C",void 0,void 0);function Xb(t){return g_("E",void 0,t)}function Jb(t){return g_("N",t,void 0)}function g_(t,e,n){return{kind:t,value:e,error:n}}var fs=null;function No(t){if(Hn.useDeprecatedSynchronousErrorHandling){let e=!fs;if(e&&(fs={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=fs;if(fs=null,n)throw r}}else t()}function eD(t){Hn.useDeprecatedSynchronousErrorHandling&&fs&&(fs.errorThrown=!0,fs.error=t)}var ps=class extends Qe{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,eh(e)&&e.add(this)):this.destination=ZF}static create(e,n,r){return new Br(e,n,r)}next(e){this.isStopped?__(Jb(e),this):this._next(e)}error(e){this.isStopped?__(Xb(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?__(Zb,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},QF=Function.prototype.bind;function m_(t,e){return QF.call(t,e)}var y_=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){nh(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){nh(r)}else nh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){nh(n)}}},Br=class extends ps{constructor(e,n,r){super();let i;if(Q(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&Hn.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&m_(e.next,s),error:e.error&&m_(e.error,s),complete:e.complete&&m_(e.complete,s)}):i=e}this.destination=new y_(i)}};function nh(t){Hn.useDeprecatedSynchronousErrorHandling?eD(t):th(t)}function YF(t){throw t}function __(t,e){let{onStoppedNotification:n}=Hn;n&&Mo.setTimeout(()=>n(t,e))}var ZF={closed:!0,next:hs,error:YF,complete:hs};var Ro=typeof Symbol=="function"&&Symbol.observable||"@@observable";function At(t){return t}function v_(...t){return x_(t)}function x_(t){return t.length===0?At:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var ae=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=JF(n)?n:new Br(n,r,i);return No(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=tD(r),new r((i,s)=>{let o=new Br({next:a=>{try{n(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[Ro](){return this}pipe(...n){return x_(n)(this)}toPromise(n){return n=tD(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function tD(t){var e;return(e=t??Hn.Promise)!==null&&e!==void 0?e:Promise}function XF(t){return t&&Q(t.next)&&Q(t.error)&&Q(t.complete)}function JF(t){return t&&t instanceof ps||XF(t)&&eh(t)}function w_(t){return Q(t?.lift)}function J(t){return e=>{if(w_(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Y(t,e,n,r,i){return new E_(t,e,n,r,i)}var E_=class extends ps{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Po(){return J((t,e)=>{let n=null;t._refCount++;let r=Y(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var ko=class extends ae{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,w_(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Qe;let n=this.getSubject();e.add(this.source.subscribe(Y(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Qe.EMPTY)}return e}refCount(){return Po()(this)}};var nD=Ao(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ge=(()=>{class t extends ae{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new rh(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new nD}next(n){No(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){No(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){No(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?p_:(this.currentObservers=null,s.push(n),new Qe(()=>{this.currentObservers=null,ds(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new ae;return n.source=this,n}}return t.create=(e,n)=>new rh(e,n),t})(),rh=class extends Ge{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:p_}};var Mt=class extends Ge{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var qc={now(){return(qc.delegate||Date).now()},delegate:void 0};var ih=class extends Ge{constructor(e=1/0,n=1/0,r=qc){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=n.now(),a=0;for(let c=1;c<r.length&&r[c]<=o;c+=2)a=c;a&&r.splice(0,a+1)}}};var sh=class extends Qe{constructor(e,n){super()}schedule(e,n=0){return this}};var Gc={setInterval(t,e,...n){let{delegate:r}=Gc;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=Gc;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var Oo=class extends sh{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return Gc.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&Gc.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,ds(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var Fo=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};Fo.now=qc.now;var Vo=class extends Fo{constructor(e,n=Fo.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var gs=new Vo(Oo);var oh=class extends Oo{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var ah=class extends Vo{};var C_=new ah(oh);var zt=new ae(t=>t.complete());function rD(t){return t&&Q(t.schedule)}function I_(t){return t[t.length-1]}function Lo(t){return Q(I_(t))?t.pop():void 0}function cr(t){return rD(I_(t))?t.pop():void 0}function iD(t,e){return typeof I_(t)=="number"?t.pop():e}var ch=t=>t&&typeof t.length=="number"&&typeof t!="function";function lh(t){return Q(t?.then)}function uh(t){return Q(t[Ro])}function dh(t){return Symbol.asyncIterator&&Q(t?.[Symbol.asyncIterator])}function hh(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function eV(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var fh=eV();function ph(t){return Q(t?.[fh])}function gh(t){return Nb(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield qd(n.read());if(i)return yield qd(void 0);yield yield qd(r)}}finally{n.releaseLock()}})}function mh(t){return Q(t?.getReader)}function Ne(t){if(t instanceof ae)return t;if(t!=null){if(uh(t))return tV(t);if(ch(t))return nV(t);if(lh(t))return rV(t);if(dh(t))return sD(t);if(ph(t))return iV(t);if(mh(t))return sV(t)}throw hh(t)}function tV(t){return new ae(e=>{let n=t[Ro]();if(Q(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function nV(t){return new ae(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function rV(t){return new ae(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,th)})}function iV(t){return new ae(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function sD(t){return new ae(e=>{oV(t,e).catch(n=>e.error(n))})}function sV(t){return sD(gh(t))}function oV(t,e){var n,r,i,s;return Mb(this,void 0,void 0,function*(){try{for(n=Rb(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function an(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function Tn(t,e=0){return J((n,r)=>{n.subscribe(Y(r,i=>an(r,t,()=>r.next(i),e),()=>an(r,t,()=>r.complete(),e),i=>an(r,t,()=>r.error(i),e)))})}function qn(t,e=0){return J((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function oD(t,e){return Ne(t).pipe(qn(e),Tn(e))}function aD(t,e){return Ne(t).pipe(qn(e),Tn(e))}function cD(t,e){return new ae(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function lD(t,e){return new ae(n=>{let r;return an(n,e,()=>{r=t[fh](),an(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>Q(r?.return)&&r.return()})}function _h(t,e){if(!t)throw new Error("Iterable cannot be null");return new ae(n=>{an(n,e,()=>{let r=t[Symbol.asyncIterator]();an(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function uD(t,e){return _h(gh(t),e)}function dD(t,e){if(t!=null){if(uh(t))return oD(t,e);if(ch(t))return cD(t,e);if(lh(t))return aD(t,e);if(dh(t))return _h(t,e);if(ph(t))return lD(t,e);if(mh(t))return uD(t,e)}throw hh(t)}function Ce(t,e){return e?dD(t,e):Ne(t)}function U(...t){let e=cr(t);return Ce(t,e)}function jo(t,e){let n=Q(t)?t:()=>t,r=i=>i.error(n());return new ae(e?i=>e.schedule(r,0,i):r)}function b_(t){return!!t&&(t instanceof ae||Q(t.lift)&&Q(t.subscribe))}var Ur=Ao(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function B(t,e){return J((n,r)=>{let i=0;n.subscribe(Y(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:aV}=Array;function cV(t,e){return aV(e)?t(...e):t(e)}function yh(t){return B(e=>cV(t,e))}var{isArray:lV}=Array,{getPrototypeOf:uV,prototype:dV,keys:hV}=Object;function vh(t){if(t.length===1){let e=t[0];if(lV(e))return{args:e,keys:null};if(fV(e)){let n=hV(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function fV(t){return t&&typeof t=="object"&&uV(t)===dV}function xh(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function zc(...t){let e=cr(t),n=Lo(t),{args:r,keys:i}=vh(t);if(r.length===0)return Ce([],e);let s=new ae(pV(r,e,i?o=>xh(i,o):At));return n?s.pipe(yh(n)):s}function pV(t,e,n=At){return r=>{hD(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)hD(e,()=>{let l=Ce(t[c],e),u=!1;l.subscribe(Y(r,d=>{s[c]=d,u||(u=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function hD(t,e,n){t?an(n,t,e):e()}function fD(t,e,n,r,i,s,o,a){let c=[],l=0,u=0,d=!1,h=()=>{d&&!c.length&&!l&&e.complete()},f=m=>l<r?p(m):c.push(m),p=m=>{s&&e.next(m),l++;let v=!1;Ne(n(m,u++)).subscribe(Y(e,b=>{i?.(b),s?f(b):e.next(b)},()=>{v=!0},void 0,()=>{if(v)try{for(l--;c.length&&l<r;){let b=c.shift();o?an(e,o,()=>p(b)):p(b)}h()}catch(b){e.error(b)}}))};return t.subscribe(Y(e,f,()=>{d=!0,h()})),()=>{a?.()}}function tt(t,e,n=1/0){return Q(e)?tt((r,i)=>B((s,o)=>e(r,s,i,o))(Ne(t(r,i))),n):(typeof e=="number"&&(n=e),J((r,i)=>fD(r,i,t,n)))}function pi(t=1/0){return tt(At,t)}function pD(){return pi(1)}function Bo(...t){return pD()(Ce(t,cr(t)))}function wh(t){return new ae(e=>{Ne(t()).subscribe(e)})}function D_(...t){let e=Lo(t),{args:n,keys:r}=vh(t),i=new ae(s=>{let{length:o}=n;if(!o){s.complete();return}let a=new Array(o),c=o,l=o;for(let u=0;u<o;u++){let d=!1;Ne(n[u]).subscribe(Y(s,h=>{d||(d=!0,l--),a[u]=h},()=>c--,void 0,()=>{(!c||!d)&&(l||s.next(r?xh(r,a):a),s.complete())}))}});return e?i.pipe(yh(e)):i}function Uo(...t){let e=cr(t),n=iD(t,1/0),r=t;return r.length?r.length===1?Ne(r[0]):pi(n)(Ce(r,e)):zt}function Nt(t,e){return J((n,r)=>{let i=0;n.subscribe(Y(r,s=>t.call(e,s,i++)&&r.next(s)))})}function gi(t){return J((e,n)=>{let r=null,i=!1,s;r=e.subscribe(Y(n,void 0,void 0,o=>{s=Ne(t(o,gi(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function gD(t,e,n,r,i){return(s,o)=>{let a=n,c=e,l=0;s.subscribe(Y(o,u=>{let d=l++;c=a?t(c,u,d):(a=!0,u),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function ms(t,e){return Q(e)?tt(t,e,1):tt(t,1)}function mi(t){return J((e,n)=>{let r=!1;e.subscribe(Y(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function $r(t){return t<=0?()=>zt:J((e,n)=>{let r=0;e.subscribe(Y(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function T_(t){return B(()=>t)}function Wc(t,e=At){return t=t??gV,J((n,r)=>{let i,s=!0;n.subscribe(Y(r,o=>{let a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function gV(t,e){return t===e}function Eh(t=mV){return J((e,n)=>{let r=!1;e.subscribe(Y(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function mV(){return new Ur}function Kc(t){return J((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function Sn(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Nt((i,s)=>t(i,s,r)):At,$r(1),n?mi(e):Eh(()=>new Ur))}function $o(t){return t<=0?()=>zt:J((e,n)=>{let r=[];e.subscribe(Y(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function S_(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Nt((i,s)=>t(i,s,r)):At,$o(1),n?mi(e):Eh(()=>new Ur))}function Qc(){return J((t,e)=>{let n,r=!1;t.subscribe(Y(e,i=>{let s=n;n=i,r&&e.next([s,i]),r=!0}))})}function lr(t,e){return J(gD(t,e,arguments.length>=2,!0))}function Yc(t={}){let{connector:e=()=>new Ge,resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,c,l=0,u=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=c=void 0,u=d=!1},p=()=>{let m=o;f(),m?.unsubscribe()};return J((m,v)=>{l++,!d&&!u&&h();let b=c=c??e();v.add(()=>{l--,l===0&&!d&&!u&&(a=A_(p,i))}),b.subscribe(v),!o&&l>0&&(o=new Br({next:F=>b.next(F),error:F=>{d=!0,h(),a=A_(f,n,F),b.error(F)},complete:()=>{u=!0,h(),a=A_(f,r),b.complete()}}),Ne(m).subscribe(o))})(s)}}function A_(t,e,...n){if(e===!0){t();return}if(e===!1)return;let r=new Br({next:()=>{r.unsubscribe(),t()}});return Ne(e(...n)).subscribe(r)}function Ch(t,e,n){let r,i=!1;return t&&typeof t=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t:r=t??1/0,Yc({connector:()=>new ih(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function M_(t){return J((e,n)=>{let r=!1,i=0;e.subscribe(Y(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}function _s(...t){let e=cr(t);return J((n,r)=>{(e?Bo(t,n,e):Bo(t,n)).subscribe(r)})}function Be(t,e){return J((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(Y(r,c=>{i?.unsubscribe();let l=0,u=s++;Ne(t(c,u)).subscribe(i=Y(r,d=>r.next(e?e(c,d,u,l++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Ih(t,e){return Q(e)?Be(()=>t,e):Be(()=>t)}function N_(t){return J((e,n)=>{Ne(t).subscribe(Y(n,()=>n.complete(),hs)),!n.closed&&e.subscribe(n)})}function pt(t,e,n){let r=Q(t)||e||n?{next:t,error:e,complete:n}:t;return r?J((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(Y(s,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),s.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):At}function R_(...t){let e=Lo(t);return J((n,r)=>{let i=t.length,s=new Array(i),o=t.map(()=>!1),a=!1;for(let c=0;c<i;c++)Ne(t[c]).subscribe(Y(r,l=>{s[c]=l,!a&&!o[c]&&(o[c]=!0,(a=o.every(At))&&(o=null))},hs));n.subscribe(Y(r,c=>{if(a){let l=[c,...s];r.next(e?e(...l):l)}}))})}var tT="https://g.co/ng/security#xss",H=class extends Error{constructor(e,n){super(k0(e,n)),this.code=e}};function k0(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}function ll(t){return{toString:t}.toString()}var bh="__parameters__";function _V(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function nT(t,e,n){return ll(()=>{let r=_V(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,l,u){let d=c.hasOwnProperty(bh)?c[bh]:Object.defineProperty(c,bh,{value:[]})[bh];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),c}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}var Kt=globalThis;function Re(t){for(let e in t)if(t[e]===Re)return e;throw Error("Could not find renamed property on target object.")}function yV(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function Qt(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(Qt).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function mD(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var vV=Re({__forward_ref__:Re});function Gr(t){return t.__forward_ref__=Gr,t.toString=function(){return Qt(this())},t}function Wt(t){return rT(t)?t():t}function rT(t){return typeof t=="function"&&t.hasOwnProperty(vV)&&t.__forward_ref__===Gr}function V(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function rt(t){return{providers:t.providers||[],imports:t.imports||[]}}function sf(t){return _D(t,sT)||_D(t,oT)}function iT(t){return sf(t)!==null}function _D(t,e){return t.hasOwnProperty(e)?t[e]:null}function xV(t){let e=t&&(t[sT]||t[oT]);return e||null}function yD(t){return t&&(t.hasOwnProperty(vD)||t.hasOwnProperty(wV))?t[vD]:null}var sT=Re({\u0275prov:Re}),vD=Re({\u0275inj:Re}),oT=Re({ngInjectableDef:Re}),wV=Re({ngInjectorDef:Re}),O=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=V({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function aT(t){return t&&!!t.\u0275providers}var EV=Re({\u0275cmp:Re}),CV=Re({\u0275dir:Re}),IV=Re({\u0275pipe:Re}),bV=Re({\u0275mod:Re}),Oh=Re({\u0275fac:Re}),Zc=Re({__NG_ELEMENT_ID__:Re}),xD=Re({__NG_ENV_ID__:Re});function of(t){return typeof t=="string"?t:t==null?"":String(t)}function DV(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():of(t)}function TV(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new H(-200,t)}function O0(t,e){throw new H(-201,!1)}var ue=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(ue||{}),W_;function cT(){return W_}function An(t){let e=W_;return W_=t,e}function lT(t,e,n){let r=sf(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&ue.Optional)return null;if(e!==void 0)return e;O0(t,"Injector")}var SV={},Jc=SV,K_="__NG_DI_FLAG__",Fh="ngTempTokenPath",AV="ngTokenPath",MV=/\n/gm,NV="\u0275",wD="__source",Wo;function RV(){return Wo}function _i(t){let e=Wo;return Wo=t,e}function PV(t,e=ue.Default){if(Wo===void 0)throw new H(-203,!1);return Wo===null?lT(t,void 0,e):Wo.get(t,e&ue.Optional?null:void 0,e)}function C(t,e=ue.Default){return(cT()||PV)(Wt(t),e)}function P(t,e=ue.Default){return C(t,af(e))}function af(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function Q_(t){let e=[];for(let n=0;n<t.length;n++){let r=Wt(t[n]);if(Array.isArray(r)){if(r.length===0)throw new H(900,!1);let i,s=ue.Default;for(let o=0;o<r.length;o++){let a=r[o],c=kV(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(C(i,s))}else e.push(C(r))}return e}function uT(t,e){return t[K_]=e,t.prototype[K_]=e,t}function kV(t){return t[K_]}function OV(t,e,n,r){let i=t[Fh];throw e[wD]&&i.unshift(e[wD]),t.message=FV(`
`+t.message,i,n,r),t[AV]=i,t[Fh]=null,t}function FV(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==NV?t.slice(2):t;let i=Qt(e);if(Array.isArray(e))i=e.map(Qt).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Qt(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(MV,`
  `)}`}var ia=uT(nT("Optional"),8);var F0=uT(nT("SkipSelf"),4);function Qo(t,e){let n=t.hasOwnProperty(Oh);return n?t[Oh]:null}function V0(t,e){t.forEach(n=>Array.isArray(n)?V0(n,e):e(n))}function dT(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Vh(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function VV(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let s=i-2;t[i]=t[s],i--}t[e]=n,t[e+1]=r}}function LV(t,e,n){let r=ul(t,e);return r>=0?t[r|1]=n:(r=~r,VV(t,r,e,n)),r}function P_(t,e){let n=ul(t,e);if(n>=0)return t[n|1]}function ul(t,e){return jV(t,e,1)}function jV(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}var Yo={},Mn=[],Zo=new O(""),hT=new O("",-1),fT=new O(""),Lh=class{get(e,n=Jc){if(n===Jc){let r=new Error(`NullInjectorError: No provider for ${Qt(e)}!`);throw r.name="NullInjectorError",r}return n}},pT=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(pT||{}),hr=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(hr||{}),Ft=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(Ft||{});function BV(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function Y_(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];UV(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function gT(t){return t===3||t===4||t===6}function UV(t){return t.charCodeAt(0)===64}function el(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?ED(t,n,i,null,e[++r]):ED(t,n,i,null,null))}}return t}function ED(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var mT="ng-template";function $V(t,e,n,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&BV(e[i+1].toLowerCase(),n,0)!==-1)return!0}else if(L0(t))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===n)return!0}return!1}function L0(t){return t.type===4&&t.value!==mT}function HV(t,e,n){let r=t.type===4&&!n?mT:t.value;return e===r}function qV(t,e,n){let r=4,i=t.attrs,s=i!==null?WV(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!Gn(r)&&!Gn(c))return!1;if(o&&Gn(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!HV(t,c,n)||c===""&&e.length===1){if(Gn(r))return!1;o=!0}}else if(r&8){if(i===null||!$V(t,i,c,n)){if(Gn(r))return!1;o=!0}}else{let l=e[++a],u=GV(c,i,L0(t),n);if(u===-1){if(Gn(r))return!1;o=!0;continue}if(l!==""){let d;if(u>s?d="":d=i[u+1].toLowerCase(),r&2&&l!==d){if(Gn(r))return!1;o=!0}}}}return Gn(r)||o}function Gn(t){return(t&1)===0}function GV(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return KV(e,t)}function zV(t,e,n=!1){for(let r=0;r<e.length;r++)if(qV(t,e[r],n))return!0;return!1}function WV(t){for(let e=0;e<t.length;e++){let n=t[e];if(gT(n))return e}return t.length}function KV(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function CD(t,e){return t?":not("+e.trim()+")":e}function QV(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Gn(o)&&(e+=CD(s,i),i=""),r=o,s=s||!Gn(r);n++}return i!==""&&(e+=CD(s,i)),e}function YV(t){return t.map(QV).join(",")}function ZV(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!Gn(i))break;i=s}r++}return{attrs:e,classes:n}}function cn(t){return ll(()=>{let e=wT(t),n=oe(A({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===pT.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||hr.Emulated,styles:t.styles||Mn,_:null,schemas:t.schemas||null,tView:null,id:""});ET(n);let r=t.dependencies;return n.directiveDefs=bD(r,!1),n.pipeDefs=bD(r,!0),n.id=eL(n),n})}function XV(t){return vi(t)||_T(t)}function JV(t){return t!==null}function it(t){return ll(()=>({type:t.type,bootstrap:t.bootstrap||Mn,declarations:t.declarations||Mn,imports:t.imports||Mn,exports:t.exports||Mn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function ID(t,e){if(t==null)return Yo;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s,o,a=Ft.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(n[s]=a!==Ft.None?[r,a]:r,e[s]=o):n[s]=r}return n}function st(t){return ll(()=>{let e=wT(t);return ET(e),e})}function vi(t){return t[EV]||null}function _T(t){return t[CV]||null}function yT(t){return t[IV]||null}function vT(t){let e=vi(t)||_T(t)||yT(t);return e!==null?e.standalone:!1}function xT(t,e){let n=t[bV]||null;if(!n&&e===!0)throw new Error(`Type ${Qt(t)} does not have '\u0275mod' property.`);return n}function wT(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||Yo,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||Mn,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:ID(t.inputs,e),outputs:ID(t.outputs),debugInfo:null}}function ET(t){t.features?.forEach(e=>e(t))}function bD(t,e){if(!t)return null;let n=e?yT:XV;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(JV)}function eL(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function tL(...t){return{\u0275providers:CT(!0,t),\u0275fromNgModule:!0}}function CT(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return V0(e,o=>{let a=o;Z_(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&IT(i,s),n}function IT(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];j0(i,s=>{e(s,r)})}}function Z_(t,e,n,r){if(t=Wt(t),!t)return!1;let i=null,s=yD(t),o=!s&&vi(t);if(!s&&!o){let c=t.ngModule;if(s=yD(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)Z_(l,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{V0(s.imports,u=>{Z_(u,e,n,r)&&(l||=[],l.push(u))})}finally{}l!==void 0&&IT(l,e)}if(!a){let l=Qo(i)||(()=>new i);e({provide:i,useFactory:l,deps:Mn},i),e({provide:fT,useValue:i,multi:!0},i),e({provide:Zo,useValue:()=>C(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let l=t;j0(c,u=>{e(u,l)})}}else return!1;return i!==t&&t.providers!==void 0}function j0(t,e){for(let n of t)aT(n)&&(n=n.\u0275providers),Array.isArray(n)?j0(n,e):e(n)}var nL=Re({provide:String,useValue:Re});function bT(t){return t!==null&&typeof t=="object"&&nL in t}function rL(t){return!!(t&&t.useExisting)}function iL(t){return!!(t&&t.useFactory)}function Xo(t){return typeof t=="function"}function sL(t){return!!t.useClass}var cf=new O(""),Mh={},oL={},k_;function B0(){return k_===void 0&&(k_=new Lh),k_}var gn=class{},tl=class extends gn{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,J_(e,o=>this.processProvider(o)),this.records.set(hT,Ho(void 0,this)),i.has("environment")&&this.records.set(gn,Ho(void 0,this));let s=this.records.get(cf);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(fT,Mn,ue.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=De(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),De(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=_i(this),r=An(void 0),i;try{return e()}finally{_i(n),An(r)}}get(e,n=Jc,r=ue.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(xD))return e[xD](this);r=af(r);let i,s=_i(this),o=An(void 0);try{if(!(r&ue.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=dL(e)&&sf(e);l&&this.injectableDefInScope(l)?c=Ho(X_(e),Mh):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&ue.Self?B0():this.parent;return n=r&ue.Optional&&n===Jc?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[Fh]=a[Fh]||[]).unshift(Qt(e)),s)throw a;return OV(a,e,"R3InjectorError",this.source)}else throw a}finally{An(o),_i(s)}}resolveInjectorInitializers(){let e=De(null),n=_i(this),r=An(void 0),i;try{let s=this.get(Zo,Mn,ue.Self);for(let o of s)o()}finally{_i(n),An(r),De(e)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(Qt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new H(205,!1)}processProvider(e){e=Wt(e);let n=Xo(e)?e:Wt(e&&e.provide),r=cL(e);if(!Xo(e)&&e.multi===!0){let i=this.records.get(n);i||(i=Ho(void 0,Mh,!0),i.factory=()=>Q_(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){let r=De(null);try{return n.value===Mh&&(n.value=oL,n.value=n.factory()),typeof n.value=="object"&&n.value&&uL(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{De(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let n=Wt(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function X_(t){let e=sf(t),n=e!==null?e.factory:Qo(t);if(n!==null)return n;if(t instanceof O)throw new H(204,!1);if(t instanceof Function)return aL(t);throw new H(204,!1)}function aL(t){if(t.length>0)throw new H(204,!1);let n=xV(t);return n!==null?()=>n.factory(t):()=>new t}function cL(t){if(bT(t))return Ho(void 0,t.useValue);{let e=DT(t);return Ho(e,Mh)}}function DT(t,e,n){let r;if(Xo(t)){let i=Wt(t);return Qo(i)||X_(i)}else if(bT(t))r=()=>Wt(t.useValue);else if(iL(t))r=()=>t.useFactory(...Q_(t.deps||[]));else if(rL(t))r=()=>C(Wt(t.useExisting));else{let i=Wt(t&&(t.useClass||t.provide));if(lL(t))r=()=>new i(...Q_(t.deps));else return Qo(i)||X_(i)}return r}function Ho(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function lL(t){return!!t.deps}function uL(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function dL(t){return typeof t=="function"||typeof t=="object"&&t instanceof O}function J_(t,e){for(let n of t)Array.isArray(n)?J_(n,e):n&&aT(n)?J_(n.\u0275providers,e):e(n)}function zr(t,e){t instanceof tl&&t.assertNotDestroyed();let n,r=_i(t),i=An(void 0);try{return e()}finally{_i(r),An(i)}}function TT(){return cT()!==void 0||RV()!=null}function hL(t){if(!TT())throw new H(-203,!1)}function fL(t){let e=Kt.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function pL(t){return typeof t=="function"}var Wr=0,_e=1,W=2,Vt=3,zn=4,Qn=5,jh=6,nl=7,Wn=8,Jo=9,Kn=10,nt=11,rl=12,DD=13,sa=14,fr=15,lf=16,qo=17,ea=18,uf=19,ST=20,yi=21,O_=22,xs=23,xi=25,AT=1;var ws=7,Bh=8,Uh=9,Nn=10,U0=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(U0||{});function ys(t){return Array.isArray(t)&&typeof t[AT]=="object"}function Kr(t){return Array.isArray(t)&&t[AT]===!0}function MT(t){return(t.flags&4)!==0}function df(t){return t.componentOffset>-1}function $0(t){return(t.flags&1)===1}function wi(t){return!!t.template}function gL(t){return(t[W]&512)!==0}var e0=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function NT(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}function Ci(){return RT}function RT(t){return t.type.prototype.ngOnChanges&&(t.setInput=_L),mL}Ci.ngInherit=!0;function mL(){let t=kT(this),e=t?.current;if(e){let n=t.previous;if(n===Yo)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function _L(t,e,n,r,i){let s=this.declaredInputs[r],o=kT(t)||yL(t,{previous:Yo,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new e0(l&&l.currentValue,n,c===Yo),NT(t,e,i,n)}var PT="__ngSimpleChanges__";function kT(t){return t[PT]||null}function yL(t,e){return t[PT]=e}var TD=null;var ur=function(t,e,n){TD?.(t,e,n)},vL="svg",xL="math",wL=!1;function EL(){return wL}function pr(t){for(;Array.isArray(t);)t=t[Wr];return t}function OT(t,e){return pr(e[t])}function Rn(t,e){return pr(e[t.index])}function FT(t,e){return t.data[e]}function Ii(t,e){let n=e[t];return ys(n)?n:n[Wr]}function H0(t){return(t[W]&128)===128}function CL(t){return Kr(t[Vt])}function $h(t,e){return e==null?null:t[e]}function VT(t){t[qo]=0}function IL(t){t[W]&1024||(t[W]|=1024,H0(t)&&il(t))}function bL(t,e){for(;t>0;)e=e[sa],t--;return e}function q0(t){return!!(t[W]&9216||t[xs]?.dirty)}function t0(t){t[Kn].changeDetectionScheduler?.notify(1),q0(t)?il(t):t[W]&64&&(EL()?(t[W]|=1024,il(t)):t[Kn].changeDetectionScheduler?.notify())}function il(t){t[Kn].changeDetectionScheduler?.notify();let e=sl(t);for(;e!==null&&!(e[W]&8192||(e[W]|=8192,!H0(e)));)e=sl(e)}function LT(t,e){if((t[W]&256)===256)throw new H(911,!1);t[yi]===null&&(t[yi]=[]),t[yi].push(e)}function DL(t,e){if(t[yi]===null)return;let n=t[yi].indexOf(e);n!==-1&&t[yi].splice(n,1)}function sl(t){let e=t[Vt];return Kr(e)?e[Vt]:e}var pe={lFrame:GT(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function TL(){return pe.lFrame.elementDepthCount}function SL(){pe.lFrame.elementDepthCount++}function AL(){pe.lFrame.elementDepthCount--}function jT(){return pe.bindingsEnabled}function ML(){return pe.skipHydrationRootTNode!==null}function NL(t){return pe.skipHydrationRootTNode===t}function RL(){pe.skipHydrationRootTNode=null}function Pe(){return pe.lFrame.lView}function ln(){return pe.lFrame.tView}function ye(t){return pe.lFrame.contextLView=t,t[Wn]}function ve(t){return pe.lFrame.contextLView=null,t}function un(){let t=BT();for(;t!==null&&t.type===64;)t=t.parent;return t}function BT(){return pe.lFrame.currentTNode}function PL(){let t=pe.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function dl(t,e){let n=pe.lFrame;n.currentTNode=t,n.isParent=e}function UT(){return pe.lFrame.isParent}function kL(){pe.lFrame.isParent=!1}function OL(){let t=pe.lFrame,e=t.bindingRootIndex;return e===-1&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function FL(t){return pe.lFrame.bindingIndex=t}function hf(){return pe.lFrame.bindingIndex++}function VL(t){let e=pe.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function LL(){return pe.lFrame.inI18n}function jL(t,e){let n=pe.lFrame;n.bindingIndex=n.bindingRootIndex=t,n0(e)}function BL(){return pe.lFrame.currentDirectiveIndex}function n0(t){pe.lFrame.currentDirectiveIndex=t}function UL(t){let e=pe.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function $T(t){pe.lFrame.currentQueryIndex=t}function $L(t){let e=t[_e];return e.type===2?e.declTNode:e.type===1?t[Qn]:null}function HT(t,e,n){if(n&ue.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&ue.Host);)if(i=$L(s),i===null||(s=s[sa],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=pe.lFrame=qT();return r.currentTNode=e,r.lView=t,!0}function G0(t){let e=qT(),n=t[_e];pe.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function qT(){let t=pe.lFrame,e=t===null?null:t.child;return e===null?GT(t):e}function GT(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function zT(){let t=pe.lFrame;return pe.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var WT=zT;function z0(){let t=zT();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function HL(t){return(pe.lFrame.contextLView=bL(t,pe.lFrame.contextLView))[Wn]}function oa(){return pe.lFrame.selectedIndex}function Es(t){pe.lFrame.selectedIndex=t}function ff(){let t=pe.lFrame;return FT(t.tView,t.selectedIndex)}function qL(){return pe.lFrame.currentNamespace}var KT=!0;function W0(){return KT}function K0(t){KT=t}function GL(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=RT(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function Q0(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),c&&(t.viewHooks??=[]).push(-n,c),l&&((t.viewHooks??=[]).push(n,l),(t.viewCheckHooks??=[]).push(n,l)),u!=null&&(t.destroyHooks??=[]).push(n,u)}}function Nh(t,e,n){QT(t,e,3,n)}function Rh(t,e,n,r){(t[W]&3)===n&&QT(t,e,n,r)}function F_(t,e){let n=t[W];(n&3)===e&&(n&=16383,n+=1,t[W]=n)}function QT(t,e,n,r){let i=r!==void 0?t[qo]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(t[qo]+=65536),(a<s||s==-1)&&(zL(t,n,e,c),t[qo]=(t[qo]&4294901760)+c+2),c++}function SD(t,e){ur(4,t,e);let n=De(null);try{e.call(t)}finally{De(n),ur(5,t,e)}}function zL(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[W]>>14<t[qo]>>16&&(t[W]&3)===e&&(t[W]+=16384,SD(a,s)):SD(a,s)}var Ko=-1,Cs=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function WL(t){return t instanceof Cs}function KL(t){return(t.flags&8)!==0}function QL(t){return(t.flags&16)!==0}function YT(t){return t!==Ko}function Hh(t){return t&32767}function YL(t){return t>>16}function qh(t,e){let n=YL(t),r=e;for(;n>0;)r=r[sa],n--;return r}var r0=!0;function AD(t){let e=r0;return r0=t,e}var ZL=256,ZT=ZL-1,XT=5,XL=0,dr={};function JL(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(Zc)&&(r=n[Zc]),r==null&&(r=n[Zc]=XL++);let i=r&ZT,s=1<<i;e.data[t+(i>>XT)]|=s}function Gh(t,e){let n=JT(t,e);if(n!==-1)return n;let r=e[_e];r.firstCreatePass&&(t.injectorIndex=e.length,V_(r.data,t),V_(e,null),V_(r.blueprint,null));let i=Y0(t,e),s=t.injectorIndex;if(YT(i)){let o=Hh(i),a=qh(i,e),c=a[_e].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function V_(t,e){t.push(0,0,0,0,0,0,0,0,e)}function JT(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function Y0(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=iS(i),r===null)return Ko;if(n++,i=i[sa],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return Ko}function i0(t,e,n){JL(t,e,n)}function e4(t,e){if(e==="class")return t.classes;if(e==="style")return t.styles;let n=t.attrs;if(n){let r=n.length,i=0;for(;i<r;){let s=n[i];if(gT(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof n[i]=="string";)i++;else{if(s===e)return n[i+1];i=i+2}}}return null}function eS(t,e,n){if(n&ue.Optional||t!==void 0)return t;O0(e,"NodeInjector")}function tS(t,e,n,r){if(n&ue.Optional&&r===void 0&&(r=null),!(n&(ue.Self|ue.Host))){let i=t[Jo],s=An(void 0);try{return i?i.get(e,r,n&ue.Optional):lT(e,r,n&ue.Optional)}finally{An(s)}}return eS(r,e,n)}function nS(t,e,n,r=ue.Default,i){if(t!==null){if(e[W]&2048&&!(r&ue.Self)){let o=s4(t,e,n,r,dr);if(o!==dr)return o}let s=rS(t,e,n,r,dr);if(s!==dr)return s}return tS(e,n,r,i)}function rS(t,e,n,r,i){let s=r4(n);if(typeof s=="function"){if(!HT(e,t,r))return r&ue.Host?eS(i,n,r):tS(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&ue.Optional))O0(n);else return o}finally{WT()}}else if(typeof s=="number"){let o=null,a=JT(t,e),c=Ko,l=r&ue.Host?e[fr][Qn]:null;for((a===-1||r&ue.SkipSelf)&&(c=a===-1?Y0(t,e):e[a+8],c===Ko||!ND(r,!1)?a=-1:(o=e[_e],a=Hh(c),e=qh(c,e)));a!==-1;){let u=e[_e];if(MD(s,a,u.data)){let d=t4(a,e,n,o,r,l);if(d!==dr)return d}c=e[a+8],c!==Ko&&ND(r,e[_e].data[a+8]===l)&&MD(s,a,e)?(o=u,a=Hh(c),e=qh(c,e)):a=-1}}return i}function t4(t,e,n,r,i,s){let o=e[_e],a=o.data[t+8],c=r==null?df(a)&&r0:r!=o&&(a.type&3)!==0,l=i&ue.Host&&s===a,u=n4(a,o,n,c,l);return u!==null?ta(e,o,u,a):dr}function n4(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,c=t.directiveStart,l=t.directiveEnd,u=s>>20,d=r?a:a+u,h=i?a+u:l;for(let f=d;f<h;f++){let p=o[f];if(f<c&&n===p||f>=c&&p.type===n)return f}if(i){let f=o[c];if(f&&wi(f)&&f.type===n)return c}return null}function ta(t,e,n,r){let i=t[n],s=e.data;if(WL(i)){let o=i;o.resolving&&TV(DV(s[n]));let a=AD(o.canSeeViewProviders);o.resolving=!0;let c,l=o.injectImpl?An(o.injectImpl):null,u=HT(t,r,ue.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&GL(n,s[n],e)}finally{l!==null&&An(l),AD(a),o.resolving=!1,WT()}}return i}function r4(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(Zc)?t[Zc]:void 0;return typeof e=="number"?e>=0?e&ZT:i4:e}function MD(t,e,n){let r=1<<t;return!!(n[e+(t>>XT)]&r)}function ND(t,e){return!(t&ue.Self)&&!(t&ue.Host&&e)}var vs=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return nS(this._tNode,this._lView,e,af(r),n)}};function i4(){return new vs(un(),Pe())}function Qr(t){return ll(()=>{let e=t.prototype.constructor,n=e[Oh]||s0(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[Oh]||s0(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function s0(t){return rT(t)?()=>{let e=s0(Wt(t));return e&&e()}:Qo(t)}function s4(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[W]&2048&&!(o[W]&512);){let a=rS(s,o,n,r|ue.Self,dr);if(a!==dr)return a;let c=s.parent;if(!c){let l=o[ST];if(l){let u=l.get(n,dr,r);if(u!==dr)return u}c=iS(o),o=o[sa]}s=c}return i}function iS(t){let e=t[_e],n=e.type;return n===2?e.declTNode:n===1?t[Qn]:null}function Z0(t){return e4(un(),t)}function RD(t,e=null,n=null,r){let i=sS(t,e,n,r);return i.resolveInjectorInitializers(),i}function sS(t,e=null,n=null,r,i=new Set){let s=[n||Mn,tL(t)];return r=r||(typeof t=="object"?void 0:Qt(t)),new tl(s,e||B0(),r||null,i)}var Yn=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return RD({name:""},i,r,"");{let s=r.name??"";return RD({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=Jc,e.NULL=new Lh,e.\u0275prov=V({token:e,providedIn:"any",factory:()=>C(hT)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})();var o4="ngOriginalError";function L_(t){return t[o4]}var gr=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&L_(e);for(;n&&L_(n);)n=L_(n);return n||null}},oS=new O("",{providedIn:"root",factory:()=>P(gr).handleError.bind(void 0)}),X0=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=a4,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),o0=class extends X0{constructor(e){super(),this._lView=e}onDestroy(e){return LT(this._lView,e),()=>DL(this._lView,e)}};function a4(){return new o0(Pe())}function c4(){return pf(un(),Pe())}function pf(t,e){return new Zn(Rn(t,e))}var Zn=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=c4;let t=e;return t})();var a0=class extends Ge{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,TT()&&(this.destroyRef=P(X0,{optional:!0})??void 0)}emit(e){let n=De(null);try{super.next(e)}finally{De(n)}}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=j_(s),i&&(i=j_(i)),o&&(o=j_(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof Qe&&e.add(a),a}};function j_(t){return e=>{setTimeout(t,void 0,e)}}var gt=a0;function aS(t){return(t.flags&128)===128}var c0;function cS(t){c0=t}function l4(){if(c0!==void 0)return c0;if(typeof document<"u")return document;throw new H(210,!1)}var gf=new O("",{providedIn:"root",factory:()=>u4}),u4="ng",J0=new O(""),Lt=new O("",{providedIn:"platform",factory:()=>"unknown"});var ey=new O("",{providedIn:"root",factory:()=>l4().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var d4="h",h4="b";var f4=()=>null;function ty(t,e,n=!1){return f4(t,e,n)}var lS=!1,p4=new O("",{providedIn:"root",factory:()=>lS});var Dh;function g4(){if(Dh===void 0&&(Dh=null,Kt.trustedTypes))try{Dh=Kt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Dh}function PD(t){return g4()?.createScriptURL(t)||t}var zh=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${tT})`}};function hl(t){return t instanceof zh?t.changingThisBreaksApplicationSecurity:t}function ny(t,e){let n=m4(t);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${tT})`)}return n===e}function m4(t){return t instanceof zh&&t.getTypeName()||null}var _4=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function uS(t){return t=String(t),t.match(_4)?t:"unsafe:"+t}var mf=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(mf||{});function y4(t){let e=hS();return e?e.sanitize(mf.URL,t)||"":ny(t,"URL")?hl(t):uS(of(t))}function v4(t){let e=hS();if(e)return PD(e.sanitize(mf.RESOURCE_URL,t)||"");if(ny(t,"ResourceURL"))return PD(hl(t));throw new H(904,!1)}function x4(t,e){return e==="src"&&(t==="embed"||t==="frame"||t==="iframe"||t==="media"||t==="script")||e==="href"&&(t==="base"||t==="link")?v4:y4}function dS(t,e,n){return x4(e,n)(t)}function hS(){let t=Pe();return t&&t[Kn].sanitizer}var fS=new Map,w4=0;function E4(){return w4++}function C4(t){fS.set(t[uf],t)}function I4(t){fS.delete(t[uf])}var kD="__ngContext__";function Is(t,e){ys(e)?(t[kD]=e[uf],C4(e)):t[kD]=e}function pS(t){return t instanceof Function?t():t}function b4(t){return(t??P(Yn)).get(Lt)==="browser"}var Hr=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Hr||{}),D4;function ry(t,e){return D4(t,e)}function Go(t,e,n,r,i){if(r!=null){let s,o=!1;Kr(r)?s=r:ys(r)&&(o=!0,r=r[Wr]);let a=pr(r);t===0&&n!==null?i==null?vS(e,n,a):Wh(e,n,a,i||null,!0):t===1&&n!==null?Wh(e,n,a,i||null,!0):t===2?H4(e,a,o):t===3&&e.destroyNode(a),s!=null&&G4(e,t,s,n,i)}}function T4(t,e){return t.createText(e)}function S4(t,e,n){t.setValue(e,n)}function gS(t,e,n){return t.createElement(e,n)}function A4(t,e){mS(t,e),e[Wr]=null,e[Qn]=null}function M4(t,e,n,r,i,s){r[Wr]=i,r[Qn]=e,_f(t,r,n,1,i,s)}function mS(t,e){e[Kn].changeDetectionScheduler?.notify(1),_f(t,e,e[nt],2,null,null)}function N4(t){let e=t[rl];if(!e)return B_(t[_e],t);for(;e;){let n=null;if(ys(e))n=e[rl];else{let r=e[Nn];r&&(n=r)}if(!n){for(;e&&!e[zn]&&e!==t;)ys(e)&&B_(e[_e],e),e=e[Vt];e===null&&(e=t),ys(e)&&B_(e[_e],e),n=e&&e[zn]}e=n}}function R4(t,e,n,r){let i=Nn+r,s=n.length;r>0&&(n[i-1][zn]=e),r<s-Nn?(e[zn]=n[i],dT(n,Nn+r,e)):(n.push(e),e[zn]=null),e[Vt]=n;let o=e[lf];o!==null&&n!==o&&P4(o,e);let a=e[ea];a!==null&&a.insertView(t),t0(e),e[W]|=128}function P4(t,e){let n=t[Uh],i=e[Vt][Vt][fr];e[fr]!==i&&(t[W]|=U0.HasTransplantedViews),n===null?t[Uh]=[e]:n.push(e)}function _S(t,e){let n=t[Uh],r=n.indexOf(e);n.splice(r,1)}function l0(t,e){if(t.length<=Nn)return;let n=Nn+e,r=t[n];if(r){let i=r[lf];i!==null&&i!==t&&_S(i,r),e>0&&(t[n-1][zn]=r[zn]);let s=Vh(t,Nn+e);A4(r[_e],r);let o=s[ea];o!==null&&o.detachView(s[_e]),r[Vt]=null,r[zn]=null,r[W]&=-129}return r}function yS(t,e){if(!(e[W]&256)){let n=e[nt];n.destroyNode&&_f(t,e,n,3,null,null),N4(e)}}function B_(t,e){if(e[W]&256)return;let n=De(null);try{e[W]&=-129,e[W]|=256,e[xs]&&Kb(e[xs]),O4(t,e),k4(t,e),e[_e].type===1&&e[nt].destroy();let r=e[lf];if(r!==null&&Kr(e[Vt])){r!==e[Vt]&&_S(r,e);let i=e[ea];i!==null&&i.detachView(t)}I4(e)}finally{De(n)}}function k4(t,e){let n=t.cleanup,r=e[nl];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[nl]=null);let i=e[yi];if(i!==null){e[yi]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function O4(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof Cs)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];ur(4,a,c);try{c.call(a)}finally{ur(5,a,c)}}else{ur(4,i,s);try{s.call(i)}finally{ur(5,i,s)}}}}}function F4(t,e,n){return V4(t,e.parent,n)}function V4(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[Wr];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===hr.None||s===hr.Emulated)return null}return Rn(r,n)}}function Wh(t,e,n,r,i){t.insertBefore(e,n,r,i)}function vS(t,e,n){t.appendChild(e,n)}function OD(t,e,n,r,i){r!==null?Wh(t,e,n,r,i):vS(t,e,n)}function L4(t,e,n,r){t.removeChild(e,n,r)}function iy(t,e){return t.parentNode(e)}function j4(t,e){return t.nextSibling(e)}function B4(t,e,n){return $4(t,e,n)}function U4(t,e,n){return t.type&40?Rn(t,n):null}var $4=U4,FD;function sy(t,e,n,r){let i=F4(t,r,e),s=e[nt],o=r.parent||e[Qn],a=B4(o,r,e);if(i!=null)if(Array.isArray(n))for(let c=0;c<n.length;c++)OD(s,i,n[c],a,!1);else OD(s,i,n,a,!1);FD!==void 0&&FD(s,r,e,n,i)}function Ph(t,e){if(e!==null){let n=e.type;if(n&3)return Rn(e,t);if(n&4)return u0(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return Ph(t,r);{let i=t[e.index];return Kr(i)?u0(-1,i):pr(i)}}else{if(n&32)return ry(e,t)()||pr(t[e.index]);{let r=xS(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=sl(t[fr]);return Ph(i,r)}else return Ph(t,e.next)}}}return null}function xS(t,e){if(e!==null){let r=t[fr][Qn],i=e.projection;return r.projection[i]}return null}function u0(t,e){let n=Nn+t+1;if(n<e.length){let r=e[n],i=r[_e].firstChild;if(i!==null)return Ph(r,i)}return e[ws]}function H4(t,e,n){let r=iy(t,e);r&&L4(t,r,e,n)}function oy(t,e,n,r,i,s,o){for(;n!=null;){let a=r[n.index],c=n.type;if(o&&e===0&&(a&&Is(pr(a),r),n.flags|=2),(n.flags&32)!==32)if(c&8)oy(t,e,n.child,r,i,s,!1),Go(e,t,i,a,s);else if(c&32){let l=ry(n,r),u;for(;u=l();)Go(e,t,i,u,s);Go(e,t,i,a,s)}else c&16?q4(t,e,r,n,i,s):Go(e,t,i,a,s);n=o?n.projectionNext:n.next}}function _f(t,e,n,r,i,s){oy(n,r,t.firstChild,e,i,s,!1)}function q4(t,e,n,r,i,s){let o=n[fr],c=o[Qn].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let u=c[l];Go(e,t,i,u,s)}else{let l=c,u=o[Vt];aS(r)&&(l.flags|=128),oy(t,e,l,u,i,s,!0)}}function G4(t,e,n,r,i){let s=n[ws],o=pr(n);s!==o&&Go(e,t,r,s,i);for(let a=Nn;a<n.length;a++){let c=n[a];_f(c[_e],c,t,e,r,s)}}function z4(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=r.indexOf("-")===-1?void 0:Hr.DashCase;i==null?t.removeStyle(n,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Hr.Important),t.setStyle(n,r,i,s))}}function W4(t,e,n){t.setAttribute(e,"style",n)}function wS(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function ES(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&Y_(t,e,r),i!==null&&wS(t,e,i),s!==null&&W4(t,e,s)}var bi={};function L(t=1){CS(ln(),Pe(),oa()+t,!1)}function CS(t,e,n,r){if(!r)if((e[W]&3)===3){let s=t.preOrderCheckHooks;s!==null&&Nh(e,s,n)}else{let s=t.preOrderHooks;s!==null&&Rh(e,s,0,n)}Es(n)}function te(t,e=ue.Default){let n=Pe();if(n===null)return C(t,e);let r=un();return nS(r,n,Wt(t),e)}function IS(){let t="invalid";throw new Error(t)}function bS(t,e,n,r,i,s){let o=De(null);try{let a=null;i&Ft.SignalBased&&(a=e[r][u_]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&Ft.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,r):NT(e,a,r,s)}finally{De(o)}}function K4(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)Es(~i);else{let s=i,o=n[++r],a=n[++r];jL(o,s);let c=e[s];a(2,c)}}}finally{Es(-1)}}function yf(t,e,n,r,i,s,o,a,c,l,u){let d=e.blueprint.slice();return d[Wr]=i,d[W]=r|4|128|8|64,(l!==null||t&&t[W]&2048)&&(d[W]|=2048),VT(d),d[Vt]=d[sa]=t,d[Wn]=n,d[Kn]=o||t&&t[Kn],d[nt]=a||t&&t[nt],d[Jo]=c||t&&t[Jo]||null,d[Qn]=s,d[uf]=E4(),d[jh]=u,d[ST]=l,d[fr]=e.type==2?t[fr]:d,d}function vf(t,e,n,r,i){let s=t.data[e];if(s===null)s=Q4(t,e,n,r,i),LL()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=PL();s.injectorIndex=o===null?-1:o.injectorIndex}return dl(s,!0),s}function Q4(t,e,n,r,i){let s=BT(),o=UT(),a=o?s:s&&s.parent,c=t.data[e]=e5(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function DS(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function TS(t,e,n,r,i){let s=oa(),o=r&2;try{Es(-1),o&&e.length>xi&&CS(t,e,xi,!1),ur(o?2:0,i),n(r,i)}finally{Es(s),ur(o?3:1,i)}}function SS(t,e,n){if(MT(e)){let r=De(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];if(a.contentQueries){let c=n[o];a.contentQueries(1,c,o)}}}finally{De(r)}}}function AS(t,e,n){jT()&&(o5(t,e,n,Rn(n,e)),(n.flags&64)===64&&kS(t,e,n))}function MS(t,e,n=Rn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function NS(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=ay(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function ay(t,e,n,r,i,s,o,a,c,l,u){let d=xi+r,h=d+i,f=Y4(d,h),p=typeof l=="function"?l():l;return f[_e]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:u}}function Y4(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:bi);return n}function Z4(t,e,n,r){let s=r.get(p4,lS)||n===hr.ShadowDom,o=t.selectRootElement(e,s);return X4(o),o}function X4(t){J4(t)}var J4=()=>null;function e5(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return ML()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function VD(t,e,n,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=Ft.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let l=s;if(i!==null){if(!i.hasOwnProperty(s))continue;l=i[s]}t===0?LD(r,n,l,a,c):LD(r,n,l,a)}return r}function LD(t,e,n,r,i){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,r):s=t[n]=[e,r],i!==void 0&&s.push(i)}function t5(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],c=null,l=null;for(let u=r;u<i;u++){let d=s[u],h=n?n.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;c=VD(0,d.inputs,u,c,f),l=VD(1,d.outputs,u,l,p);let m=c!==null&&o!==null&&!L0(e)?_5(c,u,o):null;a.push(m)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function n5(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function cy(t,e,n,r,i,s,o,a){let c=Rn(e,n),l=e.inputs,u;!a&&l!=null&&(u=l[r])?(ly(t,n,u,r,i),df(e)&&r5(n,e.index)):e.type&3?(r=n5(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(c,r,i)):e.type&12}function r5(t,e){let n=Ii(e,t);n[W]&16||(n[W]|=64)}function RS(t,e,n,r){if(jT()){let i=r===null?null:{"":-1},s=c5(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&PS(t,e,n,o,i,a),i&&l5(n,r,i)}n.mergedAttrs=el(n.mergedAttrs,n.attrs)}function PS(t,e,n,r,i,s){for(let l=0;l<r.length;l++)i0(Gh(n,e),t,r[l].type);d5(n,t.data.length,r.length);for(let l=0;l<r.length;l++){let u=r[l];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,c=DS(t,e,r.length,null);for(let l=0;l<r.length;l++){let u=r[l];n.mergedAttrs=el(n.mergedAttrs,u.hostAttrs),h5(t,n,e,c,u),u5(c,u,i),u.contentQueries!==null&&(n.flags|=4),(u.hostBindings!==null||u.hostAttrs!==null||u.hostVars!==0)&&(n.flags|=64);let d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),c++}t5(t,n,s)}function i5(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;s5(o)!=a&&o.push(a),o.push(n,r,s)}}function s5(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function o5(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;df(n)&&f5(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||Gh(n,e),Is(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let c=t.data[a],l=ta(e,t,a,n);if(Is(l,e),o!==null&&m5(e,a-i,l,c,n,o),wi(c)){let u=Ii(n.index,e);u[Wn]=ta(e,t,a,n)}}}function kS(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=BL();try{Es(s);for(let a=r;a<i;a++){let c=t.data[a],l=e[a];n0(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&a5(c,l)}}finally{Es(-1),n0(o)}}function a5(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function c5(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(zV(e,o.selectors,!1))if(r||(r=[]),wi(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;d0(t,e,c)}else r.unshift(o),d0(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function d0(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function l5(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new H(-301,!1);r.push(e[i],s)}}}function u5(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;wi(e)&&(n[""]=t)}}function d5(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function h5(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=Qo(i.type,!0)),o=new Cs(s,wi(i),te);t.blueprint[r]=o,n[r]=o,i5(t,e,r,DS(t,n,i.hostVars,bi),i)}function f5(t,e,n){let r=Rn(e,t),i=NS(n),s=t[Kn].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=xf(t,yf(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function p5(t,e,n,r,i,s){let o=Rn(t,e);g5(e[nt],o,s,t.value,n,r,i)}function g5(t,e,n,r,i,s,o){if(s==null)t.removeAttribute(e,i,n);else{let a=o==null?of(s):o(s,r||"",i);t.setAttribute(e,i,a,n)}}function m5(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],l=o[a++],u=o[a++],d=o[a++];bS(r,n,c,l,u,d)}}function _5(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],n[i+1]);break}}i+=2}return r}function OS(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function FS(t,e){let n=t.contentQueries;if(n!==null){let r=De(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];$T(s),a.contentQueries(2,e[o],o)}}}finally{De(r)}}}function xf(t,e){return t[rl]?t[DD][zn]=e:t[rl]=e,t[DD]=e,e}function h0(t,e,n){$T(0);let r=De(null);try{e(t,n)}finally{De(r)}}function y5(t){return t[nl]||(t[nl]=[])}function v5(t){return t.cleanup||(t.cleanup=[])}function VS(t,e){let n=t[Jo],r=n?n.get(gr,null):null;r&&r.handleError(e)}function ly(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],c=n[s++],l=e[o],u=t.data[o];bS(u,l,r,a,c,i)}}function x5(t,e,n){let r=OT(e,t);S4(t[nt],r,n)}function w5(t,e){let n=Ii(e,t),r=n[_e];E5(r,n);let i=n[Wr];i!==null&&n[jh]===null&&(n[jh]=ty(i,n[Jo])),uy(r,n,n[Wn])}function E5(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function uy(t,e,n){G0(e);try{let r=t.viewQuery;r!==null&&h0(1,r,n);let i=t.template;i!==null&&TS(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[ea]?.finishViewCreation(t),t.staticContentQueries&&FS(t,e),t.staticViewQueries&&h0(2,t.viewQuery,n);let s=t.components;s!==null&&C5(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[W]&=-5,z0()}}function C5(t,e){for(let n=0;n<e.length;n++)w5(t,e[n])}function I5(t,e,n,r){let i=De(null);try{let s=e.tView,a=t[W]&4096?4096:16,c=yf(t,s,n,a,null,e,null,null,null,r?.injector??null,r?.dehydratedView??null),l=t[e.index];c[lf]=l;let u=t[ea];return u!==null&&(c[ea]=u.createEmbeddedView(s)),uy(s,c,n),c}finally{De(i)}}function jD(t,e){return!e||e.firstChild===null||aS(t)}function b5(t,e,n,r=!0){let i=e[_e];if(R4(i,e,t,n),r){let o=u0(n,t),a=e[nt],c=iy(a,t[ws]);c!==null&&M4(i,t[Qn],a,e,c,o)}let s=e[jh];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function Kh(t,e,n,r,i=!1){for(;n!==null;){let s=e[n.index];s!==null&&r.push(pr(s)),Kr(s)&&D5(s,r);let o=n.type;if(o&8)Kh(t,e,n.child,r);else if(o&32){let a=ry(n,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=xS(e,n);if(Array.isArray(a))r.push(...a);else{let c=sl(e[fr]);Kh(c[_e],c,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function D5(t,e){for(let n=Nn;n<t.length;n++){let r=t[n],i=r[_e].firstChild;i!==null&&Kh(r[_e],r,i,e)}t[ws]!==t[Wr]&&e.push(t[ws])}var LS=[];function T5(t){return t[xs]??S5(t)}function S5(t){let e=LS.pop()??Object.create(M5);return e.lView=t,e}function A5(t){t.lView[xs]!==t&&(t.lView=null,LS.push(t))}var M5=oe(A({},Gb),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{il(t.lView)},consumerOnSignalRead(){this.lView[xs]=this}});function jS(t){return US(t[rl])}function BS(t){return US(t[zn])}function US(t){for(;t!==null&&!Kr(t);)t=t[zn];return t}var $S=100;function HS(t,e=!0,n=0){let r=t[Kn],i=r.rendererFactory,s=!1;s||i.begin?.();try{N5(t,n)}catch(o){throw e&&VS(t,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function N5(t,e){f0(t,e);let n=0;for(;q0(t);){if(n===$S)throw new H(103,!1);n++,f0(t,1)}}function R5(t,e,n,r){let i=e[W];if((i&256)===256)return;let s=!1;!s&&e[Kn].inlineEffectRunner?.flush(),G0(e);let o=null,a=null;!s&&P5(t)&&(a=T5(e),o=zb(a));try{VT(e),FL(t.bindingStartIndex),n!==null&&TS(t,e,n,2,r);let c=(i&3)===3;if(!s)if(c){let d=t.preOrderCheckHooks;d!==null&&Nh(e,d,null)}else{let d=t.preOrderHooks;d!==null&&Rh(e,d,0,null),F_(e,0)}if(k5(e),qS(e,0),t.contentQueries!==null&&FS(t,e),!s)if(c){let d=t.contentCheckHooks;d!==null&&Nh(e,d)}else{let d=t.contentHooks;d!==null&&Rh(e,d,1),F_(e,1)}K4(t,e);let l=t.components;l!==null&&zS(e,l,0);let u=t.viewQuery;if(u!==null&&h0(2,u,r),!s)if(c){let d=t.viewCheckHooks;d!==null&&Nh(e,d)}else{let d=t.viewHooks;d!==null&&Rh(e,d,2),F_(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[O_]){for(let d of e[O_])d();e[O_]=null}s||(e[W]&=-73)}catch(c){throw il(e),c}finally{a!==null&&(Wb(a,o),A5(a)),z0()}}function P5(t){return t.type!==2}function qS(t,e){for(let n=jS(t);n!==null;n=BS(n))for(let r=Nn;r<n.length;r++){let i=n[r];GS(i,e)}}function k5(t){for(let e=jS(t);e!==null;e=BS(e)){if(!(e[W]&U0.HasTransplantedViews))continue;let n=e[Uh];for(let r=0;r<n.length;r++){let i=n[r],s=i[Vt];IL(i)}}}function O5(t,e,n){let r=Ii(e,t);GS(r,n)}function GS(t,e){H0(t)&&f0(t,e)}function f0(t,e){let r=t[_e],i=t[W],s=t[xs],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&d_(s)),s&&(s.dirty=!1),t[W]&=-9217,o)R5(r,t,r.template,t[Wn]);else if(i&8192){qS(t,1);let a=r.components;a!==null&&zS(t,a,1)}}function zS(t,e,n){for(let r=0;r<e.length;r++)O5(t,e[r],n)}function dy(t){for(t[Kn].changeDetectionScheduler?.notify();t;){t[W]|=64;let e=sl(t);if(gL(t)&&!e)return t;t=e}return null}var bs=class{get rootNodes(){let e=this._lView,n=e[_e];return Kh(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Wn]}set context(e){this._lView[Wn]=e}get destroyed(){return(this._lView[W]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Vt];if(Kr(e)){let n=e[Bh],r=n?n.indexOf(this):-1;r>-1&&(l0(e,r),Vh(n,r))}this._attachedToViewContainer=!1}yS(this._lView[_e],this._lView)}onDestroy(e){LT(this._lView,e)}markForCheck(){dy(this._cdRefInjectingView||this._lView)}detach(){this._lView[W]&=-129}reattach(){t0(this._lView),this._lView[W]|=128}detectChanges(){this._lView[W]|=1024,HS(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new H(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,mS(this._lView[_e],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new H(902,!1);this._appRef=e,t0(this._lView)}},wf=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=L5;let t=e;return t})(),F5=wf,V5=class extends F5{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=I5(this._declarationLView,this._declarationTContainer,e,{injector:n,dehydratedView:r});return new bs(i)}};function L5(){return j5(un(),Pe())}function j5(t,e){return t.type&4?new V5(e,t,pf(t,e)):null}var AJ=new RegExp(`^(\\d+)*(${h4}|${d4})*(.*)`);var B5=()=>null;function BD(t,e){return B5(t,e)}var Qh=class{},p0=class{},Yh=class{};function U5(t){let e=Error(`No component factory found for ${Qt(t)}.`);return e[$5]=t,e}var $5="ngComponent";var g0=class{resolveComponentFactory(e){throw U5(e)}},Ef=(()=>{let e=class e{};e.NULL=new g0;let t=e;return t})(),ol=class{},mr=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>H5();let t=e;return t})();function H5(){let t=Pe(),e=un(),n=Ii(e.index,t);return(ys(n)?n:t)[nt]}var q5=(()=>{let e=class e{};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),U_={};var UD=new Set;function hy(t){UD.has(t)||(UD.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function $D(...t){}function G5(){let t=typeof Kt.requestAnimationFrame=="function",e=Kt[t?"requestAnimationFrame":"setTimeout"],n=Kt[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var ge=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new gt(!1),this.onMicrotaskEmpty=new gt(!1),this.onStable=new gt(!1),this.onError=new gt(!1),typeof Zone>"u")throw new H(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=G5().nativeRequestAnimationFrame,K5(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new H(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new H(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,z5,$D,$D);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},z5={};function fy(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function W5(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Kt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,m0(t),t.isCheckStableRunning=!0,fy(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),m0(t))}function K5(t){let e=()=>{W5(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(Q5(a))return n.invokeTask(i,s,o,a);try{return HD(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),qD(t)}},onInvoke:(n,r,i,s,o,a,c)=>{try{return HD(t),n.invoke(i,s,o,a,c)}finally{t.shouldCoalesceRunChangeDetection&&e(),qD(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,m0(t),fy(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function m0(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function HD(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function qD(t){t._nesting--,fy(t)}var _0=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new gt,this.onMicrotaskEmpty=new gt,this.onStable=new gt,this.onError=new gt}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}};function Q5(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}function Y5(t="zone.js",e){return t==="noop"?new _0:t==="zone.js"?new ge(e):t}var zo=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(zo||{}),Z5={destroy(){}};function py(t,e){!e&&hL(py);let n=e?.injector??P(Yn);if(!b4(n))return Z5;hy("NgAfterNextRender");let r=n.get(gy),i=r.handler??=new v0,s=e?.phase??zo.MixedReadWrite,o=()=>{i.unregister(c),a()},a=n.get(X0).onDestroy(o),c=zr(n,()=>new y0(s,()=>{o(),t()}));return i.register(c),{destroy:o}}var y0=class{constructor(e,n){this.phase=e,this.callbackFn=n,this.zone=P(ge),this.errorHandler=P(gr,{optional:!0}),P(Qh,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},v0=class{constructor(){this.executingCallbacks=!1,this.buckets={[zo.EarlyRead]:new Set,[zo.Write]:new Set,[zo.MixedReadWrite]:new Set,[zo.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let n of e)n.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},gy=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function x0(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=mD(i,a);else if(s==2){let c=a,l=e[++o];r=mD(r,c+": "+l+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var Zh=class extends Ef{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=vi(e);return new na(n,this.ngModule)}};function GD(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let r=t[n];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:n})}return e}function X5(t){let e=t.toLowerCase();return e==="svg"?vL:e==="math"?xL:null}var w0=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=af(r);let i=this.injector.get(e,U_,r);return i!==U_||n===U_?i:this.parentInjector.get(e,n,r)}},na=class extends Yh{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=GD(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return GD(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=YV(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){let s=De(null);try{i=i||this.ngModule;let o=i instanceof gn?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new w0(e,o):e,c=a.get(ol,null);if(c===null)throw new H(407,!1);let l=a.get(q5,null),u=a.get(gy,null),d=a.get(Qh,null),h={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:u,changeDetectionScheduler:d},f=c.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",m=r?Z4(f,r,this.componentDef.encapsulation,a):gS(f,p,X5(p)),v=512;this.componentDef.signals?v|=4096:this.componentDef.onPush||(v|=16);let b=null;m!==null&&(b=ty(m,a,!0));let F=ay(0,null,null,1,0,null,null,null,null,null,null),S=yf(null,F,null,v,null,null,h,f,a,null,b);G0(S);let q,K;try{let X=this.componentDef,Me,sn=null;X.findHostDirectiveDefs?(Me=[],sn=new Map,X.findHostDirectiveDefs(X,Me,sn),Me.push(X)):Me=[X];let n_=J5(S,m),Hd=e3(n_,m,X,Me,S,h,f);K=FT(F,xi),m&&r3(f,X,m,r),n!==void 0&&i3(K,this.ngContentSelectors,n),q=n3(Hd,X,Me,sn,S,[s3]),uy(F,S,null)}finally{z0()}return new E0(this.componentType,q,pf(K,S),S,K)}finally{De(s)}}},E0=class extends p0{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new bs(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;ly(s[_e],s,i,e,n),this.previousInputValues.set(e,n);let o=Ii(this._tNode.index,s);dy(o)}}get injector(){return new vs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function J5(t,e){let n=t[_e],r=xi;return t[r]=e,vf(n,r,2,"#host",null)}function e3(t,e,n,r,i,s,o){let a=i[_e];t3(r,t,e,o);let c=null;e!==null&&(c=ty(e,i[Jo]));let l=s.rendererFactory.createRenderer(e,n),u=16;n.signals?u=4096:n.onPush&&(u=64);let d=yf(i,NS(n),null,u,i[t.index],t,s,l,null,null,c);return a.firstCreatePass&&d0(a,t,r.length-1),xf(i,d),i[t.index]=d}function t3(t,e,n,r){for(let i of t)e.mergedAttrs=el(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(x0(e,e.mergedAttrs,!0),n!==null&&ES(r,n,e))}function n3(t,e,n,r,i,s){let o=un(),a=i[_e],c=Rn(o,i);PS(a,i,o,n,null,r);for(let u=0;u<n.length;u++){let d=o.directiveStart+u,h=ta(i,a,d,o);Is(h,i)}kS(a,i,o),c&&Is(c,i);let l=ta(i,a,o.directiveStart+o.componentOffset,o);if(t[Wn]=i[Wn]=l,s!==null)for(let u of s)u(l,e);return SS(a,o,i),l}function r3(t,e,n,r){if(r)Y_(t,n,["ng-version","17.3.0"]);else{let{attrs:i,classes:s}=ZV(e.selectors[0]);i&&Y_(t,n,i),s&&s.length>0&&wS(t,n,s.join(" "))}}function i3(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function s3(){let t=un();Q0(Pe()[_e],t)}var aa=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=o3;let t=e;return t})();function o3(){let t=un();return c3(t,Pe())}var a3=aa,WS=class extends a3{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return pf(this._hostTNode,this._hostLView)}get injector(){return new vs(this._hostTNode,this._hostLView)}get parentInjector(){let e=Y0(this._hostTNode,this._hostLView);if(YT(e)){let n=qh(e,this._hostLView),r=Hh(e),i=n[_e].data[r+8];return new vs(i,n)}else return new vs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=zD(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-Nn}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=BD(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,jD(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!pL(e),a;if(o)a=n;else{let p=n||{};a=p.index,r=p.injector,i=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let c=o?e:new na(vi(e)),l=r||this.parentInjector;if(!s&&c.ngModule==null){let m=(o?l:this.parentInjector).get(gn,null);m&&(s=m)}let u=vi(c.componentType??{}),d=BD(this._lContainer,u?.id??null),h=d?.firstChild??null,f=c.create(l,i,h,s);return this.insertImpl(f.hostView,a,jD(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(CL(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[Vt],l=new WS(c,c[Qn],c[Vt]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return b5(o,i,s,r),e.attachToViewContainerRef(),dT($_(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=zD(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=l0(this._lContainer,n);r&&(Vh($_(this._lContainer),n),yS(r[_e],r))}detach(e){let n=this._adjustIndex(e,-1),r=l0(this._lContainer,n);return r&&Vh($_(this._lContainer),n)!=null?new bs(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function zD(t){return t[Bh]}function $_(t){return t[Bh]||(t[Bh]=[])}function c3(t,e){let n,r=e[t.index];return Kr(r)?n=r:(n=OS(r,e,null,t),e[t.index]=n,xf(e,n)),u3(n,e,t,r),new WS(n,t,e)}function l3(t,e){let n=t[nt],r=n.createComment(""),i=Rn(e,t),s=iy(n,i);return Wh(n,s,r,j4(n,i),!1),r}var u3=f3,d3=()=>!1;function h3(t,e,n){return d3(t,e,n)}function f3(t,e,n,r){if(t[ws])return;let i;n.type&8?i=pr(r):i=l3(e,n),t[ws]=i}function p3(t){return typeof t=="function"&&t[u_]!==void 0}function KS(t){return p3(t)&&typeof t.set=="function"}function g3(t){let e=[],n=new Map;function r(i){let s=n.get(i);if(!s){let o=t(i);n.set(i,s=o.then(v3))}return s}return Xh.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(l=>{i.template=l}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let l=i.styles.length,u=i.styleUrls;i.styleUrls.forEach((d,h)=>{a.push(""),o.push(r(d).then(f=>{a[l+h]=f,u.splice(u.indexOf(d),1),u.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(l=>{a.push(l),i.styleUrl=void 0}));let c=Promise.all(o).then(()=>x3(s));e.push(c)}),_3(),Promise.all(e).then(()=>{})}var Xh=new Map,m3=new Set;function _3(){let t=Xh;return Xh=new Map,t}function y3(){return Xh.size===0}function v3(t){return typeof t=="string"?t:t.text()}function x3(t){m3.delete(t)}function w3(t){return Object.getPrototypeOf(t.prototype).constructor}function _r(t){let e=w3(t.type),n=!0,r=[t];for(;e;){let i;if(wi(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new H(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let o=t;o.inputs=Th(t.inputs),o.inputTransforms=Th(t.inputTransforms),o.declaredInputs=Th(t.declaredInputs),o.outputs=Th(t.outputs);let a=i.hostBindings;a&&D3(t,a);let c=i.viewQuery,l=i.contentQueries;if(c&&I3(t,c),l&&b3(t,l),E3(t,i),yV(t.outputs,i.outputs),wi(i)&&i.data.animation){let u=t.data;u.animation=(u.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(t),a===_r&&(n=!1)}}e=Object.getPrototypeOf(e)}C3(r)}function E3(t,e){for(let n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;let r=e.inputs[n];if(r!==void 0&&(t.inputs[n]=r,t.declaredInputs[n]=e.declaredInputs[n],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;t.inputTransforms??={},t.inputTransforms[i]=e.inputTransforms[i]}}}function C3(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=el(i.hostAttrs,n=el(n,i.hostAttrs))}}function Th(t){return t===Yo?{}:t===Mn?[]:t}function I3(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function b3(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,s)=>{e(r,i,s),n(r,i,s)}:t.contentQueries=e}function D3(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}function my(t){let e=t.inputConfig,n={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(n[r]=i[3])}t.inputTransforms=n}var Ei=class{},al=class{};var Jh=class extends Ei{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Zh(this);let i=xT(e);this._bootstrapComponents=pS(i.bootstrap),this._r3Injector=sS(e,n,[{provide:Ei,useValue:this},{provide:Ef,useValue:this.componentFactoryResolver},...r],Qt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},ef=class extends al{constructor(e){super(),this.moduleType=e}create(e){return new Jh(this.moduleType,e,[])}};function T3(t,e,n){return new Jh(t,e,n)}var C0=class extends Ei{constructor(e){super(),this.componentFactoryResolver=new Zh(this),this.instance=null;let n=new tl([...e.providers,{provide:Ei,useValue:this},{provide:Ef,useValue:this.componentFactoryResolver}],e.parent||B0(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Cf(t,e,n=null){return new C0({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var If=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Mt(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function QS(t){return A3(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function S3(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{let n=t[Symbol.iterator](),r;for(;!(r=n.next()).done;)e(r.value)}}function A3(t){return t!==null&&(typeof t=="function"||typeof t=="object")}function M3(t,e,n){return t[e]=n}function ca(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function N3(t){return(t.flags&32)===32}function R3(t,e,n,r,i,s,o,a,c){let l=e.consts,u=vf(e,t,4,o||null,$h(l,a));RS(e,n,u,$h(l,c)),Q0(e,u);let d=u.tView=ay(2,u,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}function vt(t,e,n,r,i,s,o,a){let c=Pe(),l=ln(),u=t+xi,d=l.firstCreatePass?R3(u,l,c,e,n,r,i,s,o):l.data[u];dl(d,!1);let h=P3(l,c,d,t);W0()&&sy(l,c,h,d),Is(h,c);let f=OS(h,c,h,d);return c[u]=f,xf(c,f),h3(f,d,c),$0(d)&&AS(l,c,d),o!=null&&MS(c,d,a),vt}var P3=k3;function k3(t,e,n,r){return K0(!0),e[nt].createComment("")}function fl(t,e,n,r){let i=Pe(),s=hf();if(ca(i,s,e)){let o=ln(),a=ff();p5(a,i,t,e,n,r)}return fl}function YS(t,e,n,r){return ca(t,hf(),n)?e+of(n)+r:bi}function Sh(t,e){return t<<17|e<<2}function Ds(t){return t>>17&32767}function O3(t){return(t&2)==2}function F3(t,e){return t&131071|e<<17}function I0(t){return t|2}function ra(t){return(t&131068)>>2}function H_(t,e){return t&-131069|e<<2}function V3(t){return(t&1)===1}function b0(t){return t|1}function L3(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=Ds(o),c=ra(o);t[r]=n;let l=!1,u;if(Array.isArray(n)){let d=n;u=d[1],(u===null||ul(d,u)>0)&&(l=!0)}else u=n;if(i)if(c!==0){let h=Ds(t[a+1]);t[r+1]=Sh(h,a),h!==0&&(t[h+1]=H_(t[h+1],r)),t[a+1]=F3(t[a+1],r)}else t[r+1]=Sh(a,0),a!==0&&(t[a+1]=H_(t[a+1],r)),a=r;else t[r+1]=Sh(c,0),a===0?a=r:t[c+1]=H_(t[c+1],r),c=r;l&&(t[r+1]=I0(t[r+1])),WD(t,u,r,!0),WD(t,u,r,!1),j3(e,u,t,r,s),o=Sh(a,c),s?e.classBindings=o:e.styleBindings=o}function j3(t,e,n,r,i){let s=i?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&ul(s,e)>=0&&(n[r+1]=b0(n[r+1]))}function WD(t,e,n,r){let i=t[n+1],s=e===null,o=r?Ds(i):ra(i),a=!1;for(;o!==0&&(a===!1||s);){let c=t[o],l=t[o+1];B3(c,e)&&(a=!0,t[o+1]=r?b0(l):I0(l)),o=r?Ds(l):ra(l)}a&&(t[n+1]=r?I0(i):b0(i))}function B3(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?ul(t,e)>=0:!1}function z(t,e,n){let r=Pe(),i=hf();if(ca(r,i,e)){let s=ln(),o=ff();cy(s,o,r,t,e,r[nt],n,!1)}return z}function KD(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";ly(t,n,s[o],o,r)}function _y(t,e){return U3(t,e,null,!0),_y}function U3(t,e,n,r){let i=Pe(),s=ln(),o=VL(2);if(s.firstUpdatePass&&H3(s,t,o,r),e!==bi&&ca(i,o,e)){let a=s.data[oa()];K3(s,a,i,i[nt],t,i[o+1]=Q3(e,n),r,o)}}function $3(t,e){return e>=t.expandoStartIndex}function H3(t,e,n,r){let i=t.data;if(i[n+1]===null){let s=i[oa()],o=$3(t,n);Y3(s,r)&&e===null&&!o&&(e=!1),e=q3(i,s,e,r),L3(i,s,e,n,o,r)}}function q3(t,e,n,r){let i=UL(t),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=q_(null,t,e,n,r),n=cl(n,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==i)if(n=q_(i,t,e,n,r),s===null){let c=G3(t,e,r);c!==void 0&&Array.isArray(c)&&(c=q_(null,t,e,c[1],r),c=cl(c,e.attrs,r),z3(t,e,r,c))}else s=W3(t,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),n}function G3(t,e,n){let r=n?e.classBindings:e.styleBindings;if(ra(r)!==0)return t[Ds(r)]}function z3(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[Ds(i)]=r}function W3(t,e,n){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=t[s].hostAttrs;r=cl(r,o,n)}return cl(r,e.attrs,n)}function q_(t,e,n,r,i){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],r=cl(r,s.hostAttrs,i),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function cl(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),LV(t,o,n?!0:e[++s]))}return t===void 0?null:t}function K3(t,e,n,r,i,s,o,a){if(!(e.type&3))return;let c=t.data,l=c[a+1],u=V3(l)?QD(c,e,n,i,ra(l),o):void 0;if(!tf(u)){tf(s)||O3(l)&&(s=QD(c,null,n,i,a,o));let d=OT(oa(),n);z4(r,o,d,i,s)}}function QD(t,e,n,r,i,s){let o=e===null,a;for(;i>0;){let c=t[i],l=Array.isArray(c),u=l?c[1]:c,d=u===null,h=n[i+1];h===bi&&(h=d?Mn:void 0);let f=d?P_(h,r):u===r?h:void 0;if(l&&!tf(f)&&(f=P_(c,r)),tf(f)&&(a=f,o))return a;let p=t[i+1];i=o?Ds(p):ra(p)}if(e!==null){let c=s?e.residualClasses:e.residualStyles;c!=null&&(a=P_(c,r))}return a}function tf(t){return t!==void 0}function Q3(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=Qt(hl(t)))),t}function Y3(t,e){return(t.flags&(e?8:16))!==0}function Z3(t,e,n,r,i,s){let o=e.consts,a=$h(o,i),c=vf(e,t,2,r,a);return RS(e,n,c,$h(o,s)),c.attrs!==null&&x0(c,c.attrs,!1),c.mergedAttrs!==null&&x0(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function x(t,e,n,r){let i=Pe(),s=ln(),o=xi+t,a=i[nt],c=s.firstCreatePass?Z3(o,s,i,e,n,r):s.data[o],l=X3(s,i,c,a,e,t);i[o]=l;let u=$0(c);return dl(c,!0),ES(a,l,c),!N3(c)&&W0()&&sy(s,i,l,c),TL()===0&&Is(l,i),SL(),u&&(AS(s,i,c),SS(s,c,i)),r!==null&&MS(i,c),x}function w(){let t=un();UT()?kL():(t=t.parent,dl(t,!1));let e=t;NL(e)&&RL(),AL();let n=ln();return n.firstCreatePass&&(Q0(n,t),MT(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&KL(e)&&KD(n,e,Pe(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&QL(e)&&KD(n,e,Pe(),e.stylesWithoutHost,!1),w}function dn(t,e,n,r){return x(t,e,n,r),w(),dn}var X3=(t,e,n,r,i,s)=>(K0(!0),gS(r,i,qL()));function mt(){return Pe()}var nf="en-US";var J3=nf;function ej(t){typeof t=="string"&&(J3=t.toLowerCase().replace(/_/g,"-"))}function de(t,e,n,r){let i=Pe(),s=ln(),o=un();return ZS(s,i,i[nt],o,t,e,r),de}function tj(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[nl],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function ZS(t,e,n,r,i,s,o){let a=$0(r),l=t.firstCreatePass&&v5(t),u=e[Wn],d=y5(e),h=!0;if(r.type&3||o){let m=Rn(r,e),v=o?o(m):m,b=d.length,F=o?q=>o(pr(q[r.index])):r.index,S=null;if(!o&&a&&(S=tj(t,e,i,r.index)),S!==null){let q=S.__ngLastListenerFn__||S;q.__ngNextListenerFn__=s,S.__ngLastListenerFn__=s,h=!1}else{s=ZD(r,e,u,s,!1);let q=n.listen(v,i,s);d.push(s,q),l&&l.push(i,F,b,b+1)}}else s=ZD(r,e,u,s,!1);let f=r.outputs,p;if(h&&f!==null&&(p=f[i])){let m=p.length;if(m)for(let v=0;v<m;v+=2){let b=p[v],F=p[v+1],K=e[b][F].subscribe(s),X=d.length;d.push(s,K),l&&l.push(i,r.index,X,-(X+1))}}}function YD(t,e,n,r){let i=De(null);try{return ur(6,e,n),n(r)!==!1}catch(s){return VS(t,s),!1}finally{ur(7,e,n),De(i)}}function ZD(t,e,n,r,i){return function s(o){if(o===Function)return r;let a=t.componentOffset>-1?Ii(t.index,e):e;dy(a);let c=YD(e,n,r,o),l=s.__ngNextListenerFn__;for(;l;)c=YD(e,n,l,o)&&c,l=l.__ngNextListenerFn__;return i&&c===!1&&o.preventDefault(),c}}function ee(t=1){return HL(t)}function Ts(t,e,n){return XS(t,"",e,"",n),Ts}function XS(t,e,n,r,i){let s=Pe(),o=YS(s,e,n,r);if(o!==bi){let a=ln(),c=ff();cy(a,c,s,t,o,s[nt],i,!1)}return XS}function D(t,e=""){let n=Pe(),r=ln(),i=t+xi,s=r.firstCreatePass?vf(r,i,1,e,null):r.data[i],o=nj(r,n,s,e,t);n[i]=o,W0()&&sy(r,n,o,s),dl(s,!1)}var nj=(t,e,n,r,i)=>(K0(!0),T4(e[nt],r));function xt(t){return pl("",t,""),xt}function pl(t,e,n){let r=Pe(),i=YS(r,t,e,n);return i!==bi&&x5(r,oa(),i),pl}function jt(t,e,n){KS(e)&&(e=e());let r=Pe(),i=hf();if(ca(r,i,e)){let s=ln(),o=ff();cy(s,o,r,t,e,r[nt],n,!1)}return jt}function Yt(t,e){let n=KS(t);return n&&t.set(e),n}function Bt(t,e){let n=Pe(),r=ln(),i=un();return ZS(r,n,n[nt],i,t,e),Bt}function rj(t,e,n){let r=ln();if(r.firstCreatePass){let i=wi(t);D0(n,r.data,r.blueprint,i,!0),D0(e,r.data,r.blueprint,i,!1)}}function D0(t,e,n,r,i){if(t=Wt(t),Array.isArray(t))for(let s=0;s<t.length;s++)D0(t[s],e,n,r,i);else{let s=ln(),o=Pe(),a=un(),c=Xo(t)?t:Wt(t.provide),l=DT(t),u=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(Xo(t)||!t.multi){let f=new Cs(l,i,te),p=z_(c,e,i?u:u+h,d);p===-1?(i0(Gh(a,o),s,c),G_(s,t,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(f),o.push(f)):(n[p]=f,o[p]=f)}else{let f=z_(c,e,u+h,d),p=z_(c,e,u,u+h),m=f>=0&&n[f],v=p>=0&&n[p];if(i&&!v||!i&&!m){i0(Gh(a,o),s,c);let b=oj(i?sj:ij,n.length,i,r,l);!i&&v&&(n[p].providerFactory=b),G_(s,t,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(b),o.push(b)}else{let b=JS(n[i?p:f],l,!i&&r);G_(s,t,f>-1?f:p,b)}!i&&r&&v&&n[p].componentProviders++}}}function G_(t,e,n,r){let i=Xo(e),s=sL(e);if(i||s){let c=(s?Wt(e.useClass):e).prototype.ngOnDestroy;if(c){let l=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let u=l.indexOf(n);u===-1?l.push(n,[r,c]):l[u+1].push(r,c)}else l.push(n,c)}}}function JS(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function z_(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function ij(t,e,n,r){return T0(this.multi,[])}function sj(t,e,n,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=ta(n,n[_e],this.providerFactory.index,r);s=a.slice(0,o),T0(i,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],T0(i,s);return s}function T0(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function oj(t,e,n,r,i){let s=new Cs(t,n,te);return s.multi=[],s.index=e,s.componentProviders=0,JS(s,i,r&&!n),s}function Ss(t,e=[]){return n=>{n.providersResolver=(r,i)=>rj(r,i?i(t):t,e)}}var aj=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=CT(!1,r.type),s=i.length>0?Cf([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=V({token:e,providedIn:"environment",factory:()=>new e(C(gn))});let t=e;return t})();function eA(t){hy("NgStandalone"),t.getStandaloneInjector=e=>e.get(aj).getOrCreateStandaloneInjector(t)}function ot(t,e,n,r){return lj(Pe(),OL(),t,e,n,r)}function cj(t,e){let n=t[e];return n===bi?void 0:n}function lj(t,e,n,r,i,s){let o=e+n;return ca(t,o,i)?M3(t,o+1,s?r.call(s,i):r(i)):cj(t,o+1)}var Ah=null;function uj(t){Ah!==null&&(t.defaultEncapsulation!==Ah.defaultEncapsulation||t.preserveWhitespaces!==Ah.preserveWhitespaces)||(Ah=t)}var qr=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},tA=new qr("17.3.0"),bf=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();var yy=new O(""),gl=new O(""),Df=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,vy||(dj(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ge.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(C(ge),C(Tf),C(gl))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),Tf=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return vy?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();function dj(t){vy=t}var vy;function As(t){return!!t&&typeof t.then=="function"}function nA(t){return!!t&&typeof t.subscribe=="function"}var Sf=new O(""),rA=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=P(Sf,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(As(o))r.push(o);else if(nA(o)){let a=new Promise((c,l)=>{o.subscribe({complete:c,error:l})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),xy=new O("");function hj(){Qb(()=>{throw new H(600,!1)})}function fj(t){return t.isBoundToModule}function pj(t,e,n){try{let r=n();return As(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}function iA(t,e){return Array.isArray(e)?e.reduce(iA,t):A(A({},t),e)}var la=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=P(oS),this.afterRenderEffectManager=P(gy),this.externalTestViews=new Set,this.beforeRender=new Ge,this.afterTick=new Ge,this.componentTypes=[],this.components=[],this.isStable=P(If).hasPendingTasks.pipe(B(r=>!r)),this._injector=P(gn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof Yh;if(!this._injector.get(rA).done){let f=!s&&vT(r),p=!1;throw new H(405,p)}let a;s?a=r:a=this._injector.get(Ef).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=fj(a)?void 0:this._injector.get(Ei),l=i||a.selector,u=a.create(Yn.NULL,[],l,c),d=u.location.nativeElement,h=u.injector.get(yy,null);return h?.registerApplication(d),u.onDestroy(()=>{this.detachView(u.hostView),kh(this.components,u),h?.unregisterApplication(d)}),this._loadComponent(u),u}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new H(101,!1);let i=De(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,De(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===$S)throw new H(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:c}of this._views)gj(a,o,c)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>S0(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>S0(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;kh(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(xy,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>kh(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new H(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function kh(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function gj(t,e,n){!e&&!S0(t)||mj(t,n,e)}function S0(t){return q0(t)}function mj(t,e,n){let r;n?(r=0,t[W]|=1024):t[W]&64?r=0:r=1,HS(t,e,r)}var A0=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},Af=(()=>{let e=class e{compileModuleSync(r){return new ef(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=xT(r),o=pS(s.declarations).reduce((a,c)=>{let l=vi(c);return l&&a.push(new na(l)),a},[]);return new A0(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),_j=new O("");function yj(t,e,n){let r=new ef(n);return Promise.resolve(r)}function XD(t){for(let e=t.length-1;e>=0;e--)if(t[e]!==void 0)return t[e]}var vj=(()=>{let e=class e{constructor(){this.zone=P(ge),this.applicationRef=P(la)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function xj(t){return[{provide:ge,useFactory:t},{provide:Zo,multi:!0,useFactory:()=>{let e=P(vj,{optional:!0});return()=>e.initialize()}},{provide:Zo,multi:!0,useFactory:()=>{let e=P(Cj);return()=>{e.initialize()}}},{provide:oS,useFactory:wj}]}function wj(){let t=P(ge),e=P(gr);return n=>t.runOutsideAngular(()=>e.handleError(n))}function Ej(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var Cj=(()=>{let e=class e{constructor(){this.subscription=new Qe,this.initialized=!1,this.zone=P(ge),this.pendingTasks=P(If)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{ge.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{ge.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Ij(){return typeof $localize<"u"&&$localize.locale||nf}var wy=new O("",{providedIn:"root",factory:()=>P(wy,ue.Optional|ue.SkipSelf)||Ij()});var sA=new O(""),oA=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=Y5(i?.ngZone,Ej({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=T3(r.moduleType,this.injector,xj(()=>s)),a=o.injector.get(gr,null);return s.runOutsideAngular(()=>{let c=s.onError.subscribe({next:l=>{a.handleError(l)}});o.onDestroy(()=>{kh(this._modules,o),c.unsubscribe()})}),pj(a,s,()=>{let c=o.injector.get(rA);return c.runInitializers(),c.donePromise.then(()=>{let l=o.injector.get(wy,nf);return ej(l||nf),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=iA({},i);return yj(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(la);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new H(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new H(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(sA,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(C(Yn))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),Xc=null,aA=new O("");function bj(t){if(Xc&&!Xc.get(aA,!1))throw new H(400,!1);hj(),Xc=t;let e=t.get(oA);return Sj(t),e}function Ey(t,e,n=[]){let r=`Platform: ${e}`,i=new O(r);return(s=[])=>{let o=cA();if(!o||o.injector.get(aA,!1)){let a=[...n,...s,{provide:i,useValue:!0}];t?t(a):bj(Dj(a,r))}return Tj(i)}}function Dj(t=[],e){return Yn.create({name:e,providers:[{provide:cf,useValue:"platform"},{provide:sA,useValue:new Set([()=>Xc=null])},...t]})}function Tj(t){let e=cA();if(!e)throw new H(401,!1);return e}function cA(){return Xc?.get(oA)??null}function Sj(t){t.get(J0,null)?.forEach(n=>n())}function Cy(){return!1}var Ms=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=Aj;let t=e;return t})();function Aj(t){return Mj(un(),Pe(),(t&16)===16)}function Mj(t,e,n){if(df(t)&&!n){let r=Ii(t.index,e);return new bs(r,r)}else if(t.type&47){let r=e[fr];return new bs(r,e)}return null}var M0=class{constructor(){}supports(e){return QS(e)}create(e){return new N0(e)}},Nj=(t,e)=>e,N0=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Nj}forEachItem(e){let n;for(n=this._itHead;n!==null;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,s=null;for(;n||r;){let o=!r||n&&n.currentIndex<JD(r,i,s)?n:r,a=JD(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(n=n._next,o.previousIndex==null)i++;else{s||(s=[]);let l=a-i,u=c-i;if(l!=u){for(let h=0;h<l;h++){let f=h<s.length?s[h]:s[h]=0,p=f+h;u<=p&&p<l&&(s[h]=f+1)}let d=o.previousIndex;s[d]=u-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)e(n)}diff(e){if(e==null&&(e=[]),!QS(e))throw new H(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,s,o,a),r=!0):(r&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)),n=n._next}else i=0,S3(e,a=>{o=this._trackByFn(i,a),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,a,o,i),r=!0):(r&&(n=this._verifyReinsertion(n,a,o,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,i)):e=this._addAfter(new R0(n,r),s,i)),e}_verifyReinsertion(e,n,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let n=e._next;this._addToRemovals(this._unlink(e)),e=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){let i=n===null?this._itHead:n._next;return e._next=i,e._prev=n,i===null?this._itTail=e:i._prev=e,n===null?this._itHead=e:n._next=e,this._linkedRecords===null&&(this._linkedRecords=new rf),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let n=e._prev,r=e._next;return n===null?this._itHead=r:n._next=r,r===null?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new rf),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},R0=class{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},P0=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;r!==null;r=r._nextDup)if((n===null||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let n=e._prevDup,r=e._nextDup;return n===null?this._head=r:n._nextDup=r,r===null?this._tail=n:r._prevDup=n,this._head===null}},rf=class{constructor(){this.map=new Map}put(e){let n=e.trackById,r=this.map.get(n);r||(r=new P0,this.map.set(n,r)),r.add(e)}get(e,n){let r=e,i=this.map.get(r);return i?i.get(e,n):null}remove(e){let n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function JD(t,e,n){let r=t.previousIndex;if(r===null)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}function eT(){return new Iy([new M0])}var Iy=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||eT()),deps:[[e,new F0,new ia]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new H(901,!1)}};e.\u0275prov=V({token:e,providedIn:"root",factory:eT});let t=e;return t})();var lA=Ey(null,"core",[]),uA=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(C(la))},e.\u0275mod=it({type:e}),e.\u0275inj=rt({});let t=e;return t})();function Ns(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function dA(t){let e=vi(t);if(!e)return null;let n=new na(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var _A=null;function yr(){return _A}function yA(t){_A??=t}var Mf=class{};var hn=new O(""),My=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(Rj),providedIn:"platform"});let t=e;return t})(),vA=new O(""),Rj=(()=>{let e=class e extends My{constructor(){super(),this._doc=P(hn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return yr().getBaseHref(this._doc)}onPopState(r){let i=yr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=yr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>new e,providedIn:"platform"});let t=e;return t})();function Ny(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function hA(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function Yr(t){return t&&t[0]!=="?"?"?"+t:t}var Zr=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(Ry),providedIn:"root"});let t=e;return t})(),xA=new O(""),Ry=(()=>{let e=class e extends Zr{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??P(hn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return Ny(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+Yr(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Yr(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Yr(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(C(My),C(xA,8))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),wA=(()=>{let e=class e extends Zr{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=Ny(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Yr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Yr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(C(My),C(xA,8))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),ua=(()=>{let e=class e{constructor(r){this._subject=new gt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=Oj(hA(fA(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+Yr(i))}normalize(r){return e.stripTrailingSlash(kj(this._basePath,fA(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Yr(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Yr(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=Yr,e.joinWithSlash=Ny,e.stripTrailingSlash=hA,e.\u0275fac=function(i){return new(i||e)(C(Zr))},e.\u0275prov=V({token:e,factory:()=>Pj(),providedIn:"root"});let t=e;return t})();function Pj(){return new ua(C(Zr))}function kj(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function fA(t){return t.replace(/\/index.html$/,"")}function Oj(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function EA(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var by=/\s+/,pA=[],da=(()=>{let e=class e{constructor(r,i){this._ngEl=r,this._renderer=i,this.initialClasses=pA,this.stateMap=new Map}set klass(r){this.initialClasses=r!=null?r.trim().split(by):pA}set ngClass(r){this.rawClass=typeof r=="string"?r.trim().split(by):r}ngDoCheck(){for(let i of this.initialClasses)this._updateState(i,!0);let r=this.rawClass;if(Array.isArray(r)||r instanceof Set)for(let i of r)this._updateState(i,!0);else if(r!=null)for(let i of Object.keys(r))this._updateState(i,!!r[i]);this._applyStateDiff()}_updateState(r,i){let s=this.stateMap.get(r);s!==void 0?(s.enabled!==i&&(s.changed=!0,s.enabled=i),s.touched=!0):this.stateMap.set(r,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(let r of this.stateMap){let i=r[0],s=r[1];s.changed?(this._toggleClass(i,s.enabled),s.changed=!1):s.touched||(s.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),s.touched=!1}}_toggleClass(r,i){r=r.trim(),r.length>0&&r.split(by).forEach(s=>{i?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}};e.\u0275fac=function(i){return new(i||e)(te(Zn),te(mr))},e.\u0275dir=st({type:e,selectors:[["","ngClass",""]],inputs:{klass:[Ft.None,"class","klass"],ngClass:"ngClass"},standalone:!0});let t=e;return t})();var Dy=class{constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},ha=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new Dy(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let c=i.get(o);i.move(c,a),gA(c,s)}});for(let s=0,o=i.length;s<o;s++){let c=i.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);gA(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(te(aa),te(wf),te(Iy))},e.\u0275dir=st({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let t=e;return t})();function gA(t,e){t.context.$implicit=e.item}var fa=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new Ty,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){mA("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){mA("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(te(aa),te(wf))},e.\u0275dir=st({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let t=e;return t})(),Ty=class{constructor(){this.$implicit=null,this.ngIf=null}};function mA(t,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${t} must be a TemplateRef, but received '${Qt(e)}'.`)}var CA=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=it({type:e}),e.\u0275inj=rt({});let t=e;return t})(),Py="browser",Fj="server";function Vj(t){return t===Py}function Rs(t){return t===Fj}var IA=(()=>{let e=class e{};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>Vj(P(Lt))?new Sy(P(hn),window):new Ay});let t=e;return t})(),Sy=class{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let n=Lj(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function Lj(t,e){let n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var Ay=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},Nf=class{};var Fy=class extends Mf{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Vy=class t extends Fy{static makeCurrent(){yA(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=Bj();return n==null?null:Uj(n)}resetBaseElement(){ml=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return EA(document.cookie,e)}},ml=null;function Bj(){return ml=ml||document.querySelector("base"),ml?ml.getAttribute("href"):null}function Uj(t){return new URL(t,document.baseURI).pathname}var Ly=class{addToWindow(e){Kt.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new H(5103,!1);return s},Kt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Kt.getAllAngularRootElements=()=>e.getAllRootElements();let n=r=>{let i=Kt.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};Kt.frameworkStabilizers||(Kt.frameworkStabilizers=[]),Kt.frameworkStabilizers.push(n)}findTestabilityInTree(e,n,r){if(n==null)return null;let i=e.getTestability(n);return i??(r?yr().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},$j=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),jy=new O(""),SA=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new H(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(C(jy),C(ge))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),Pf=class{constructor(e){this._doc=e}},ky="ng-app-id",AA=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Rs(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${ky}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(ky),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(ky,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(C(hn),C(gf),C(ey,8),C(Lt))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),Oy={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Uy=/%COMP%/g,MA="%COMP%",Hj=`_nghost-${MA}`,qj=`_ngcontent-${MA}`,Gj=!0,zj=new O("",{providedIn:"root",factory:()=>Gj});function Wj(t){return qj.replace(Uy,t)}function Kj(t){return Hj.replace(Uy,t)}function NA(t,e){return e.map(n=>n.replace(Uy,t))}var bA=(()=>{let e=class e{constructor(r,i,s,o,a,c,l,u=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=Rs(c),this.defaultRenderer=new _l(r,a,l,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===hr.ShadowDom&&(i=oe(A({},i),{encapsulation:hr.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof kf?s.applyToHost(r):s instanceof yl&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,c=this.ngZone,l=this.eventManager,u=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case hr.Emulated:o=new kf(l,u,i,this.appId,d,a,c,h);break;case hr.ShadowDom:return new By(l,u,r,i,a,c,this.nonce,h);default:o=new yl(l,u,i,d,a,c,h);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(C(SA),C(AA),C(gf),C(zj),C(hn),C(Lt),C(ge),C(ey))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),_l=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(Oy[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(DA(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(DA(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new H(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=Oy[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=Oy[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Hr.DashCase|Hr.Important)?e.style.setProperty(n,r,i&Hr.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Hr.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=yr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function DA(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var By=class extends _l{constructor(e,n,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=NA(i.id,i.styles);for(let u of l){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=u,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},yl=class extends _l{constructor(e,n,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=c?NA(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},kf=class extends yl{constructor(e,n,r,i,s,o,a,c){let l=i+"-"+r.id;super(e,n,r,s,o,a,c,l),this.contentAttr=Wj(l),this.hostAttr=Kj(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},Qj=(()=>{let e=class e extends Pf{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(C(hn))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),TA=["alt","control","meta","shift"],Yj={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Zj={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},Xj=(()=>{let e=class e extends Pf{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>yr().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),TA.forEach(u=>{let d=i.indexOf(u);d>-1&&(i.splice(d,1),a+=u+".")}),a+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(r,i){let s=Yj[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),TA.forEach(a=>{if(a!==s){let c=Zj[a];c(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(C(hn))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function Jj(){Vy.makeCurrent()}function e9(){return new gr}function t9(){return cS(document),document}var n9=[{provide:Lt,useValue:Py},{provide:J0,useValue:Jj,multi:!0},{provide:hn,useFactory:t9,deps:[]}],RA=Ey(lA,"browser",n9),r9=new O(""),i9=[{provide:gl,useClass:Ly,deps:[]},{provide:yy,useClass:Df,deps:[ge,Tf,gl]},{provide:Df,useClass:Df,deps:[ge,Tf,gl]}],s9=[{provide:cf,useValue:"root"},{provide:gr,useFactory:e9,deps:[]},{provide:jy,useClass:Qj,multi:!0,deps:[hn,ge,Lt]},{provide:jy,useClass:Xj,multi:!0,deps:[hn]},bA,AA,SA,{provide:ol,useExisting:bA},{provide:Nf,useClass:$j,deps:[]},[]],PA=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:gf,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(C(r9,12))},e.\u0275mod=it({type:e}),e.\u0275inj=rt({providers:[...s9,...i9],imports:[CA,uA]});let t=e;return t})();var kA=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(C(hn))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var se="primary",Pl=Symbol("RouteTitle"),zy=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function ya(t){return new zy(t)}function o9(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function a9(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!vr(t[n],e[n]))return!1;return!0}function vr(t,e){let n=t?Wy(t):void 0,r=e?Wy(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!qA(t[i],e[i]))return!1;return!0}function Wy(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function qA(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function GA(t){return t.length>0?t[t.length-1]:null}function Mi(t){return b_(t)?t:As(t)?Ce(Promise.resolve(t)):U(t)}var c9={exact:WA,subset:KA},zA={exact:l9,subset:u9,ignored:()=>!0};function FA(t,e,n){return c9[n.paths](t.root,e.root,n.matrixParams)&&zA[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function l9(t,e){return vr(t,e)}function WA(t,e,n){if(!ks(t.segments,e.segments)||!Vf(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!WA(t.children[r],e.children[r],n))return!1;return!0}function u9(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>qA(t[n],e[n]))}function KA(t,e,n){return QA(t,e,e.segments,n)}function QA(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!ks(i,n)||e.hasChildren()||!Vf(i,n,r))}else if(t.segments.length===n.length){if(!ks(t.segments,n)||!Vf(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!KA(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!ks(t.segments,i)||!Vf(t.segments,i,r)||!t.children[se]?!1:QA(t.children[se],e,s,r)}}function Vf(t,e,n){return e.every((r,i)=>zA[n](t[i].parameters,r.parameters))}var Di=class{constructor(e=new Te([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=ya(this.queryParams),this._queryParamMap}toString(){return f9.serialize(this)}},Te=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Lf(this)}},Ps=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=ya(this.parameters),this._parameterMap}toString(){return ZA(this)}};function d9(t,e){return ks(t,e)&&t.every((n,r)=>vr(n.parameters,e[r].parameters))}function ks(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function h9(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===se&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==se&&(n=n.concat(e(i,r)))}),n}var kl=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>new bl,providedIn:"root"});let t=e;return t})(),bl=class{parse(e){let n=new Qy(e);return new Di(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${vl(e.root,!0)}`,r=m9(e.queryParams),i=typeof e.fragment=="string"?`#${p9(e.fragment)}`:"";return`${n}${r}${i}`}},f9=new bl;function Lf(t){return t.segments.map(e=>ZA(e)).join("/")}function vl(t,e){if(!t.hasChildren())return Lf(t);if(e){let n=t.children[se]?vl(t.children[se],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==se&&r.push(`${i}:${vl(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=h9(t,(r,i)=>i===se?[vl(t.children[se],!1)]:[`${i}:${vl(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[se]!=null?`${Lf(t)}/${n[0]}`:`${Lf(t)}/(${n.join("//")})`}}function YA(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Of(t){return YA(t).replace(/%3B/gi,";")}function p9(t){return encodeURI(t)}function Ky(t){return YA(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function jf(t){return decodeURIComponent(t)}function VA(t){return jf(t.replace(/\+/g,"%20"))}function ZA(t){return`${Ky(t.path)}${g9(t.parameters)}`}function g9(t){return Object.entries(t).map(([e,n])=>`;${Ky(e)}=${Ky(n)}`).join("")}function m9(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${Of(n)}=${Of(i)}`).join("&"):`${Of(n)}=${Of(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var _9=/^[^\/()?;#]+/;function $y(t){let e=t.match(_9);return e?e[0]:""}var y9=/^[^\/()?;=#]+/;function v9(t){let e=t.match(y9);return e?e[0]:""}var x9=/^[^=?&#]+/;function w9(t){let e=t.match(x9);return e?e[0]:""}var E9=/^[^&#]+/;function C9(t){let e=t.match(E9);return e?e[0]:""}var Qy=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Te([],{}):new Te([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[se]=new Te(e,n)),r}parseSegment(){let e=$y(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new H(4009,!1);return this.capture(e),new Ps(jf(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=v9(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=$y(this.remaining);i&&(r=i,this.capture(r))}e[jf(n)]=jf(r)}parseQueryParam(e){let n=w9(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=C9(this.remaining);o&&(r=o,this.capture(r))}let i=VA(n),s=VA(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=$y(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new H(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=se);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[se]:new Te([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new H(4011,!1)}};function XA(t){return t.segments.length>0?new Te([],{[se]:t}):t}function JA(t){let e={};for(let[r,i]of Object.entries(t.children)){let s=JA(i);if(r===se&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new Te(t.segments,e);return I9(n)}function I9(t){if(t.numberOfChildren===1&&t.children[se]){let e=t.children[se];return new Te(t.segments.concat(e.segments),e.children)}return t}function va(t){return t instanceof Di}function b9(t,e,n=null,r=null){let i=e1(t);return t1(i,e,n,r)}function e1(t){let e;function n(s){let o={};for(let c of s.children){let l=n(c);o[c.outlet]=l}let a=new Te(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=XA(r);return e??i}function t1(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return Hy(i,i,i,n,r);let s=D9(e);if(s.toRoot())return Hy(i,i,new Te([],{}),n,r);let o=T9(s,i,t),a=o.processChildren?El(o.segmentGroup,o.index,s.commands):r1(o.segmentGroup,o.index,s.commands);return Hy(i,o.segmentGroup,a,n,r)}function Bf(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function Dl(t){return typeof t=="object"&&t!=null&&t.outlets}function Hy(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`});let o;t===e?o=n:o=n1(t,e,n);let a=XA(JA(o));return new Di(a,s,i)}function n1(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=n1(s,e,n)}),new Te(t.segments,r)}var Uf=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&Bf(r[0]))throw new H(4003,!1);let i=r.find(Dl);if(i&&i!==GA(r))throw new H(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function D9(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new Uf(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Uf(n,e,r)}var ma=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function T9(t,e,n){if(t.isAbsolute)return new ma(e,!0,0);if(!n)return new ma(e,!1,NaN);if(n.parent===null)return new ma(n,!0,0);let r=Bf(t.commands[0])?0:1,i=n.segments.length-1+r;return S9(n,i,t.numberOfDoubleDots)}function S9(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new H(4005,!1);i=r.segments.length}return new ma(r,!1,i-s)}function A9(t){return Dl(t[0])?t[0].outlets:{[se]:t}}function r1(t,e,n){if(t??=new Te([],{}),t.segments.length===0&&t.hasChildren())return El(t,e,n);let r=M9(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new Te(t.segments.slice(0,r.pathIndex),{});return s.children[se]=new Te(t.segments.slice(r.pathIndex),t.children),El(s,0,i)}else return r.match&&i.length===0?new Te(t.segments,{}):r.match&&!t.hasChildren()?Yy(t,e,n):r.match?El(t,0,i):Yy(t,e,n)}function El(t,e,n){if(n.length===0)return new Te(t.segments,{});{let r=A9(n),i={};if(Object.keys(r).some(s=>s!==se)&&t.children[se]&&t.numberOfChildren===1&&t.children[se].segments.length===0){let s=El(t.children[se],e,n);return new Te(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=r1(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Te(t.segments,i)}}function M9(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(Dl(a))break;let c=`${a}`,l=r<n.length-1?n[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!jA(c,l,o))return s;r+=2}else{if(!jA(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Yy(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(Dl(s)){let c=N9(s.outlets);return new Te(r,c)}if(i===0&&Bf(n[0])){let c=t.segments[e];r.push(new Ps(c.path,LA(n[0]))),i++;continue}let o=Dl(s)?s.outlets[se]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&Bf(a)?(r.push(new Ps(o,LA(a))),i+=2):(r.push(new Ps(o,{})),i++)}return new Te(r,{})}function N9(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=Yy(new Te([],{}),0,r))}),e}function LA(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function jA(t,e,n){return t==n.path&&vr(e,n.parameters)}var Cl="imperative",wt=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(wt||{}),Pn=class{constructor(e,n){this.id=e,this.url=n}},xa=class extends Pn{constructor(e,n,r="imperative",i=null){super(e,n),this.type=wt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},xr=class extends Pn{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=wt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},_n=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(_n||{}),$f=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}($f||{}),Ti=class extends Pn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=wt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Si=class extends Pn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=wt.NavigationSkipped}},Tl=class extends Pn{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=wt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Hf=class extends Pn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=wt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Zy=class extends Pn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=wt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Xy=class extends Pn{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=wt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Jy=class extends Pn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=wt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ev=class extends Pn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=wt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},tv=class{constructor(e){this.route=e,this.type=wt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},nv=class{constructor(e){this.route=e,this.type=wt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},rv=class{constructor(e){this.snapshot=e,this.type=wt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},iv=class{constructor(e){this.snapshot=e,this.type=wt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},sv=class{constructor(e){this.snapshot=e,this.type=wt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ov=class{constructor(e){this.snapshot=e,this.type=wt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},qf=class{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=wt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Sl=class{},Al=class{constructor(e){this.url=e}};var av=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Ol,this.attachRef=null}},Ol=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new av,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Gf=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=cv(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=cv(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=lv(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return lv(e,this._root).map(n=>n.value)}};function cv(t,e){if(t===e.value)return e;for(let n of e.children){let r=cv(t,n);if(r)return r}return null}function lv(t,e){if(t===e.value)return[e];for(let n of e.children){let r=lv(t,n);if(r.length)return r.unshift(e),r}return[]}var mn=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function ga(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var zf=class extends Gf{constructor(e,n){super(e),this.snapshot=n,vv(this,e)}toString(){return this.snapshot.toString()}};function i1(t){let e=R9(t),n=new Mt([new Ps("",{})]),r=new Mt({}),i=new Mt({}),s=new Mt({}),o=new Mt(""),a=new Os(n,r,s,o,i,se,t,e.root);return a.snapshot=e.root,new zf(new mn(a,[]),e)}function R9(t){let e={},n={},r={},i="",s=new Ml([],e,r,i,n,se,t,null,{});return new Wf("",new mn(s,[]))}var Os=class{constructor(e,n,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(B(l=>l[Pl]))??U(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(B(e=>ya(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(B(e=>ya(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function yv(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:A(A({},e.params),t.params),data:A(A({},e.data),t.data),resolve:A(A(A(A({},t.data),e.data),i?.data),t._resolvedData)}:r={params:A({},t.params),data:A({},t.data),resolve:A(A({},t.data),t._resolvedData??{})},i&&o1(i)&&(r.resolve[Pl]=i.title),r}var Ml=class{get title(){return this.data?.[Pl]}constructor(e,n,r,i,s,o,a,c,l){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ya(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ya(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},Wf=class extends Gf{constructor(e,n){super(n),this.url=e,vv(this,n)}toString(){return s1(this._root)}};function vv(t,e){e.value._routerState=t,e.children.forEach(n=>vv(t,n))}function s1(t){let e=t.children.length>0?` { ${t.children.map(s1).join(", ")} } `:"";return`${t.value}${e}`}function qy(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,vr(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),vr(e.params,n.params)||t.paramsSubject.next(n.params),a9(e.url,n.url)||t.urlSubject.next(n.url),vr(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function uv(t,e){let n=vr(t.params,e.params)&&d9(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||uv(t.parent,e.parent))}function o1(t){return typeof t.title=="string"||t.title===null}var xv=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=se,this.activateEvents=new gt,this.deactivateEvents=new gt,this.attachEvents=new gt,this.detachEvents=new gt,this.parentContexts=P(Ol),this.location=P(aa),this.changeDetector=P(Ms),this.environmentInjector=P(gn),this.inputBinder=P(Xf,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new H(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new H(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new H(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new H(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new dv(r,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=st({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Ci]});let t=e;return t})(),dv=class{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===Os?this.route:e===Ol?this.childContexts:this.parent.get(e,n)}},Xf=new O(""),BA=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=zc([i.queryParams,i.params,i.data]).pipe(Be(([o,a,c],l)=>(c=A(A(A({},o),a),c),l===0?U(c):Promise.resolve(c)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=dA(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function P9(t,e,n){let r=Nl(t,e._root,n?n._root:void 0);return new zf(r,e)}function Nl(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=k9(t,e,n);return new mn(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Nl(t,a)),o}}let r=O9(e.value),i=e.children.map(s=>Nl(t,s));return new mn(r,i)}}function k9(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return Nl(t,r,i);return Nl(t,r)})}function O9(t){return new Os(new Mt(t.url),new Mt(t.params),new Mt(t.queryParams),new Mt(t.fragment),new Mt(t.data),t.outlet,t.component,t)}var a1="ngNavigationCancelingError";function c1(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=va(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=l1(!1,_n.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function l1(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[a1]=!0,n.cancellationCode=e,n}function F9(t){return u1(t)&&va(t.url)}function u1(t){return!!t&&t[a1]}var V9=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=cn({type:e,selectors:[["ng-component"]],standalone:!0,features:[eA],decls:1,vars:0,template:function(i,s){i&1&&dn(0,"router-outlet")},dependencies:[xv],encapsulation:2});let t=e;return t})();function L9(t,e){return t.providers&&!t._injector&&(t._injector=Cf(t.providers,e,`Route: ${t.path}`)),t._injector??e}function wv(t){let e=t.children&&t.children.map(wv),n=e?oe(A({},t),{children:e}):A({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==se&&(n.component=V9),n}function wr(t){return t.outlet||se}function j9(t,e){let n=t.filter(r=>wr(r)===e);return n.push(...t.filter(r=>wr(r)!==e)),n}function Fl(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var B9=(t,e,n,r)=>B(i=>(new hv(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),hv=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),qy(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=ga(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=ga(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=ga(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=ga(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new ov(s.value.snapshot))}),e.children.length&&this.forwardEvent(new iv(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(qy(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),qy(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=Fl(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},Kf=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},_a=class{constructor(e,n){this.component=e,this.route=n}};function U9(t,e,n){let r=t._root,i=e?e._root:null;return xl(r,i,n,[r.value])}function $9(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function Ea(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!iT(t)?t:e.get(t):r}function xl(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=ga(e);return t.children.forEach(o=>{H9(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Il(a,n.getContext(o),i)),i}function H9(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=q9(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Kf(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?xl(t,e,a?a.children:null,r,i):xl(t,e,n,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new _a(a.outlet.component,o))}else o&&Il(e,a,i),i.canActivateChecks.push(new Kf(r)),s.component?xl(t,null,a?a.children:null,r,i):xl(t,null,n,r,i);return i}function q9(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!ks(t.url,e.url);case"pathParamsOrQueryParamsChange":return!ks(t.url,e.url)||!vr(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!uv(t,e)||!vr(t.queryParams,e.queryParams);case"paramsChange":default:return!uv(t,e)}}function Il(t,e,n){let r=ga(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Il(o,e.children.getContext(s),n):Il(o,null,n):Il(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new _a(e.outlet.component,i)):n.canDeactivateChecks.push(new _a(null,i)):n.canDeactivateChecks.push(new _a(null,i))}function Vl(t){return typeof t=="function"}function G9(t){return typeof t=="boolean"}function z9(t){return t&&Vl(t.canLoad)}function W9(t){return t&&Vl(t.canActivate)}function K9(t){return t&&Vl(t.canActivateChild)}function Q9(t){return t&&Vl(t.canDeactivate)}function Y9(t){return t&&Vl(t.canMatch)}function d1(t){return t instanceof Ur||t?.name==="EmptyError"}var Ff=Symbol("INITIAL_VALUE");function wa(){return Be(t=>zc(t.map(e=>e.pipe($r(1),_s(Ff)))).pipe(B(e=>{for(let n of e)if(n!==!0){if(n===Ff)return Ff;if(n===!1||n instanceof Di)return n}return!0}),Nt(e=>e!==Ff),$r(1)))}function Z9(t,e){return tt(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?U(oe(A({},n),{guardsResult:!0})):X9(o,r,i,t).pipe(tt(a=>a&&G9(a)?J9(r,s,t,e):U(a)),B(a=>oe(A({},n),{guardsResult:a})))})}function X9(t,e,n,r){return Ce(t).pipe(tt(i=>iB(i.component,i.route,n,e,r)),Sn(i=>i!==!0,!0))}function J9(t,e,n,r){return Ce(e).pipe(ms(i=>Bo(tB(i.route.parent,r),eB(i.route,r),rB(t,i.path,n),nB(t,i.route,n))),Sn(i=>i!==!0,!0))}function eB(t,e){return t!==null&&e&&e(new sv(t)),U(!0)}function tB(t,e){return t!==null&&e&&e(new rv(t)),U(!0)}function nB(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return U(!0);let i=r.map(s=>wh(()=>{let o=Fl(e)??n,a=Ea(s,o),c=W9(a)?a.canActivate(e,t):zr(o,()=>a(e,t));return Mi(c).pipe(Sn())}));return U(i).pipe(wa())}function rB(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>$9(o)).filter(o=>o!==null).map(o=>wh(()=>{let a=o.guards.map(c=>{let l=Fl(o.node)??n,u=Ea(c,l),d=K9(u)?u.canActivateChild(r,t):zr(l,()=>u(r,t));return Mi(d).pipe(Sn())});return U(a).pipe(wa())}));return U(s).pipe(wa())}function iB(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return U(!0);let o=s.map(a=>{let c=Fl(e)??i,l=Ea(a,c),u=Q9(l)?l.canDeactivate(t,e,n,r):zr(c,()=>l(t,e,n,r));return Mi(u).pipe(Sn())});return U(o).pipe(wa())}function sB(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return U(!0);let s=i.map(o=>{let a=Ea(o,t),c=z9(a)?a.canLoad(e,n):zr(t,()=>a(e,n));return Mi(c)});return U(s).pipe(wa(),h1(r))}function h1(t){return v_(pt(e=>{if(va(e))throw c1(t,e)}),B(e=>e===!0))}function oB(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return U(!0);let s=i.map(o=>{let a=Ea(o,t),c=Y9(a)?a.canMatch(e,n):zr(t,()=>a(e,n));return Mi(c)});return U(s).pipe(wa(),h1(r))}var Rl=class{constructor(e){this.segmentGroup=e||null}},Qf=class extends Error{constructor(e){super(),this.urlTree=e}};function pa(t){return jo(new Rl(t))}function aB(t){return jo(new H(4e3,!1))}function cB(t){return jo(l1(!1,_n.GuardRejected))}var fv=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return U(r);if(i.numberOfChildren>1||!i.children[se])return aB(e.redirectTo);i=i.children[se]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new Qf(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new Di(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new Te(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new H(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},pv={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function lB(t,e,n,r,i){let s=Ev(t,e,n);return s.matched?(r=L9(e,r),oB(r,e,n,i).pipe(B(o=>o===!0?s:A({},pv)))):U(s)}function Ev(t,e,n){if(e.path==="**")return uB(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?A({},pv):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||o9)(n,t,e);if(!i)return A({},pv);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?A(A({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function uB(t){return{matched:!0,parameters:t.length>0?GA(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function UA(t,e,n,r){return n.length>0&&fB(t,n,r)?{segmentGroup:new Te(e,hB(r,new Te(n,t.children))),slicedSegments:[]}:n.length===0&&pB(t,n,r)?{segmentGroup:new Te(t.segments,dB(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new Te(t.segments,t.children),slicedSegments:n}}function dB(t,e,n,r){let i={};for(let s of n)if(Jf(t,e,s)&&!r[wr(s)]){let o=new Te([],{});i[wr(s)]=o}return A(A({},r),i)}function hB(t,e){let n={};n[se]=e;for(let r of t)if(r.path===""&&wr(r)!==se){let i=new Te([],{});n[wr(r)]=i}return n}function fB(t,e,n){return n.some(r=>Jf(t,e,r)&&wr(r)!==se)}function pB(t,e,n){return n.some(r=>Jf(t,e,r))}function Jf(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function gB(t,e,n,r){return wr(t)!==r&&(r===se||!Jf(e,n,t))?!1:Ev(e,t,n).matched}function mB(t,e,n){return e.length===0&&!t.children[n]}var gv=class{};function _B(t,e,n,r,i,s,o="emptyOnly"){return new mv(t,e,n,r,i,o,s).recognize()}var yB=31,mv=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new fv(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new H(4002,`'${e.segmentGroup}'`)}recognize(){let e=UA(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(B(n=>{let r=new Ml([],Object.freeze({}),Object.freeze(A({},this.urlTree.queryParams)),this.urlTree.fragment,{},se,this.rootComponentType,null,{}),i=new mn(r,n),s=new Wf("",i),o=b9(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,se).pipe(gi(r=>{if(r instanceof Qf)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Rl?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=yv(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(B(s=>s instanceof mn?[s]:[]))}processChildren(e,n,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return Ce(i).pipe(ms(s=>{let o=r.children[s],a=j9(n,s);return this.processSegmentGroup(e,a,o,s)}),lr((s,o)=>(s.push(...o),s)),mi(null),S_(),tt(s=>{if(s===null)return pa(r);let o=f1(s);return vB(o),U(o)}))}processSegment(e,n,r,i,s,o){return Ce(n).pipe(ms(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(gi(c=>{if(c instanceof Rl)return U(null);throw c}))),Sn(a=>!!a),gi(a=>{if(d1(a))return mB(r,i,s)?U(new gv):pa(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return gB(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):pa(i):pa(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:l,remainingSegments:u}=Ev(n,i,s);if(!a)return pa(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>yB&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,d).pipe(tt(h=>this.processSegment(e,r,n,h.concat(u),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){let o=lB(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),o.pipe(Be(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Be(({routes:c})=>{let l=r._loadedInjector??e,{consumedSegments:u,remainingSegments:d,parameters:h}=a,f=new Ml(u,h,Object.freeze(A({},this.urlTree.queryParams)),this.urlTree.fragment,wB(r),wr(r),r.component??r._loadedComponent??null,r,EB(r)),{segmentGroup:p,slicedSegments:m}=UA(n,u,d,c);if(m.length===0&&p.hasChildren())return this.processChildren(l,c,p).pipe(B(b=>b===null?null:new mn(f,b)));if(c.length===0&&m.length===0)return U(new mn(f,[]));let v=wr(r)===s;return this.processSegment(l,c,p,m,v?se:s,!0).pipe(B(b=>new mn(f,b instanceof mn?[b]:[])))}))):pa(n)))}getChildConfig(e,n,r){return n.children?U({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?U({routes:n._loadedRoutes,injector:n._loadedInjector}):sB(e,n,r,this.urlSerializer).pipe(tt(i=>i?this.configLoader.loadChildren(e,n).pipe(pt(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):cB(n))):U({routes:[],injector:e})}};function vB(t){t.sort((e,n)=>e.value.outlet===se?-1:n.value.outlet===se?1:e.value.outlet.localeCompare(n.value.outlet))}function xB(t){let e=t.value.routeConfig;return e&&e.path===""}function f1(t){let e=[],n=new Set;for(let r of t){if(!xB(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=f1(r.children);e.push(new mn(r.value,i))}return e.filter(r=>!n.has(r))}function wB(t){return t.data||{}}function EB(t){return t.resolve||{}}function CB(t,e,n,r,i,s){return tt(o=>_B(t,e,n,r,o.extractedUrl,i,s).pipe(B(({state:a,tree:c})=>oe(A({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function IB(t,e){return tt(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return U(n);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of p1(c))o.add(l);let a=0;return Ce(o).pipe(ms(c=>s.has(c)?bB(c,r,t,e):(c.data=yv(c,c.parent,t).resolve,U(void 0))),pt(()=>a++),$o(1),tt(c=>a===o.size?U(n):zt))})}function p1(t){let e=t.children.map(n=>p1(n)).flat();return[t,...e]}function bB(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!o1(i)&&(s[Pl]=i.title),DB(s,t,e,r).pipe(B(o=>(t._resolvedData=o,t.data=yv(t,t.parent,n).resolve,null)))}function DB(t,e,n,r){let i=Wy(t);if(i.length===0)return U({});let s={};return Ce(i).pipe(tt(o=>TB(t[o],e,n,r).pipe(Sn(),pt(a=>{s[o]=a}))),$o(1),T_(s),gi(o=>d1(o)?zt:jo(o)))}function TB(t,e,n,r){let i=Fl(e)??r,s=Ea(t,i),o=s.resolve?s.resolve(e,n):zr(i,()=>s(e,n));return Mi(o)}function Gy(t){return Be(e=>{let n=t(e);return n?Ce(n).pipe(B(()=>e)):U(e)})}var g1=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===se);return i}getResolvedTitleForRoute(r){return r.data[Pl]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(SB),providedIn:"root"});let t=e;return t})(),SB=(()=>{let e=class e extends g1{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(C(kA))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Ll=new O("",{providedIn:"root",factory:()=>({})}),Yf=new O(""),Cv=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=P(Af)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return U(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Mi(r.loadComponent()).pipe(B(m1),pt(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),Kc(()=>{this.componentLoaders.delete(r)})),s=new ko(i,()=>new Ge).pipe(Po());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return U({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=AB(i,this.compiler,r,this.onLoadEndListener).pipe(Kc(()=>{this.childrenLoaders.delete(i)})),a=new ko(o,()=>new Ge).pipe(Po());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function AB(t,e,n,r){return Mi(t.loadChildren()).pipe(B(m1),tt(i=>i instanceof al||Array.isArray(i)?U(i):Ce(e.compileModuleAsync(i))),B(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(Yf,[],{optional:!0,self:!0}).flat()),{routes:o.map(wv),injector:s}}))}function MB(t){return t&&typeof t=="object"&&"default"in t}function m1(t){return MB(t)?t.default:t}var Iv=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(NB),providedIn:"root"});let t=e;return t})(),NB=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),_1=new O(""),y1=new O("");function RB(t,e,n){let r=t.get(y1),i=t.get(hn);return t.get(ge).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,Promise.resolve();let s,o=new Promise(l=>{s=l}),a=i.startViewTransition(()=>(s(),PB(t))),{onViewTransitionCreated:c}=r;return c&&zr(t,()=>c({transition:a,from:e,to:n})),o})}function PB(t){return new Promise(e=>{py(e,{injector:t})})}var bv=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Ge,this.transitionAbortSubject=new Ge,this.configLoader=P(Cv),this.environmentInjector=P(gn),this.urlSerializer=P(kl),this.rootContexts=P(Ol),this.location=P(ua),this.inputBindingEnabled=P(Xf,{optional:!0})!==null,this.titleStrategy=P(g1),this.options=P(Ll,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=P(Iv),this.createViewTransition=P(_1,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>U(void 0),this.rootComponentType=null;let r=s=>this.events.next(new tv(s)),i=s=>this.events.next(new nv(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(oe(A(A({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new Mt({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Cl,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Nt(o=>o.id!==0),B(o=>oe(A({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Be(o=>{let a=!1,c=!1;return U(o).pipe(Be(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",_n.SupersededByNewNavigation),zt;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?oe(A({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let u=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=l.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!u&&d!=="reload"){let h="";return this.events.next(new Si(l.id,this.urlSerializer.serialize(l.rawUrl),h,$f.IgnoredSameUrlNavigation)),l.resolve(null),zt}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return U(l).pipe(Be(h=>{let f=this.transitions?.getValue();return this.events.next(new xa(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?zt:Promise.resolve(h)}),CB(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),pt(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=oe(A({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new Hf(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:h,extractedUrl:f,source:p,restoredState:m,extras:v}=l,b=new xa(h,this.urlSerializer.serialize(f),p,m);this.events.next(b);let F=i1(this.rootComponentType).snapshot;return this.currentTransition=o=oe(A({},l),{targetSnapshot:F,urlAfterRedirects:f,extras:oe(A({},v),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,U(o)}else{let h="";return this.events.next(new Si(l.id,this.urlSerializer.serialize(l.extractedUrl),h,$f.IgnoredByUrlHandlingStrategy)),l.resolve(null),zt}}),pt(l=>{let u=new Zy(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}),B(l=>(this.currentTransition=o=oe(A({},l),{guards:U9(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),Z9(this.environmentInjector,l=>this.events.next(l)),pt(l=>{if(o.guardsResult=l.guardsResult,va(l.guardsResult))throw c1(this.urlSerializer,l.guardsResult);let u=new Xy(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(u)}),Nt(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",_n.GuardRejected),!1)),Gy(l=>{if(l.guards.canActivateChecks.length)return U(l).pipe(pt(u=>{let d=new Jy(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}),Be(u=>{let d=!1;return U(u).pipe(IB(this.paramsInheritanceStrategy,this.environmentInjector),pt({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(u,"",_n.NoDataFromResolver)}}))}),pt(u=>{let d=new ev(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}))}),Gy(l=>{let u=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(pt(f=>{d.component=f}),B(()=>{})));for(let f of d.children)h.push(...u(f));return h};return zc(u(l.targetSnapshot.root)).pipe(mi(null),$r(1))}),Gy(()=>this.afterPreactivation()),Be(()=>{let{currentSnapshot:l,targetSnapshot:u}=o,d=this.createViewTransition?.(this.environmentInjector,l.root,u.root);return d?Ce(d).pipe(B(()=>o)):U(o)}),B(l=>{let u=P9(r.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=oe(A({},l),{targetRouterState:u}),this.currentNavigation.targetRouterState=u,o}),pt(()=>{this.events.next(new Sl)}),B9(this.rootContexts,r.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),$r(1),pt({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new xr(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),N_(this.transitionAbortSubject.pipe(pt(l=>{throw l}))),Kc(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",_n.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),gi(l=>{if(c=!0,u1(l))this.events.next(new Ti(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),F9(l)?this.events.next(new Al(l.url)):o.resolve(!1);else{this.events.next(new Tl(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(l))}catch(u){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(u)}}return zt}))}))}cancelNavigationTransition(r,i,s){let o=new Ti(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function kB(t){return t!==Cl}var OB=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(FB),providedIn:"root"});let t=e;return t})(),_v=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},FB=(()=>{let e=class e extends _v{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Qr(e)))(s||e)}})(),e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),v1=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(VB),providedIn:"root"});let t=e;return t})(),VB=(()=>{let e=class e extends v1{constructor(){super(...arguments),this.location=P(ua),this.urlSerializer=P(kl),this.options=P(Ll,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=P(Iv),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Di,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=i1(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof xa)this.stateMemento=this.createStateMemento();else if(r instanceof Si)this.rawUrlTree=i.initialUrl;else if(r instanceof Hf){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof Sl?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof Ti&&(r.code===_n.GuardRejected||r.code===_n.NoDataFromResolver)?this.restoreHistory(i):r instanceof Tl?this.restoreHistory(i,!0):r instanceof xr&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=A(A({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=A(A({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Qr(e)))(s||e)}})(),e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),wl=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(wl||{});function x1(t,e){t.events.pipe(Nt(n=>n instanceof xr||n instanceof Ti||n instanceof Tl||n instanceof Si),B(n=>n instanceof xr||n instanceof Si?wl.COMPLETE:(n instanceof Ti?n.code===_n.Redirect||n.code===_n.SupersededByNewNavigation:!1)?wl.REDIRECTING:wl.FAILED),Nt(n=>n!==wl.REDIRECTING),$r(1)).subscribe(()=>{e()})}function LB(t){throw t}var jB={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},BB={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Ai=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=P(bf),this.stateManager=P(v1),this.options=P(Ll,{optional:!0})||{},this.pendingTasks=P(If),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=P(bv),this.urlSerializer=P(kl),this.location=P(ua),this.urlHandlingStrategy=P(Iv),this._events=new Ge,this.errorHandler=this.options.errorHandler||LB,this.navigated=!1,this.routeReuseStrategy=P(OB),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=P(Yf,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!P(Xf,{optional:!0}),this.eventsSubscription=new Qe,this.isNgZoneEnabled=P(ge)instanceof ge&&ge.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Ti&&i.code!==_n.Redirect&&i.code!==_n.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof xr)this.navigated=!0;else if(i instanceof Al){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||kB(s.source)};this.scheduleNavigation(a,Cl,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}$B(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Cl,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let l=A({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(wv),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=i,u=l?this.currentUrlTree.fragment:a,d=null;switch(c){case"merge":d=A(A({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=s?s.snapshot:this.routerState.snapshot.root;h=e1(f)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),h=this.currentUrlTree.root}return t1(h,r,d,u??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=va(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,Cl,null,i)}navigate(r,i={skipLocationChange:!1}){return UB(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=A({},jB):i===!1?s=A({},BB):s=i,va(r))return FA(this.currentUrlTree,r,s);let o=this.parseUrl(r);return FA(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,u;a?(c=a.resolve,l=a.reject,u=a.promise):u=new Promise((h,f)=>{c=h,l=f});let d=this.pendingTasks.add();return x1(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:c,reject:l,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(h=>Promise.reject(h))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function UB(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new H(4008,!1)}function $B(t){return!(t instanceof Sl)&&!(t instanceof Al)}var w1=(()=>{let e=class e{constructor(r,i,s,o,a,c){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new Ge,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=r.events.subscribe(u=>{u instanceof xr&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:dS(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(te(Ai),te(Os),Z0("tabindex"),te(mr),te(Zn),te(Zr))},e.\u0275dir=st({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&de("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&fl("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[Ft.HasDecoratorInputTransform,"preserveFragment","preserveFragment",Ns],skipLocationChange:[Ft.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",Ns],replaceUrl:[Ft.HasDecoratorInputTransform,"replaceUrl","replaceUrl",Ns],routerLink:"routerLink"},standalone:!0,features:[my,Ci]});let t=e;return t})();var Zf=class{};var HB=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(Nt(r=>r instanceof xr),ms(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=Cf(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return Ce(s).pipe(pi())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=U(null);let o=s.pipe(tt(a=>a===null?U(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return Ce([o,a]).pipe(pi())}else return o})}};e.\u0275fac=function(i){return new(i||e)(C(Ai),C(Af),C(gn),C(Zf),C(Cv))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),E1=new O(""),qB=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof xa?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof xr?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof Si&&r.code===$f.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof qf&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new qf(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){IS()},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function GB(t){return t.routerState.root}function jl(t,e){return{\u0275kind:t,\u0275providers:e}}function zB(){let t=P(Yn);return e=>{let n=t.get(la);if(e!==n.components[0])return;let r=t.get(Ai),i=t.get(C1);t.get(Dv)===1&&r.initialNavigation(),t.get(I1,null,ue.Optional)?.setUpPreloading(),t.get(E1,null,ue.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var C1=new O("",{factory:()=>new Ge}),Dv=new O("",{providedIn:"root",factory:()=>1});function WB(){return jl(2,[{provide:Dv,useValue:0},{provide:Sf,multi:!0,deps:[Yn],useFactory:e=>{let n=e.get(vA,Promise.resolve());return()=>n.then(()=>new Promise(r=>{let i=e.get(Ai),s=e.get(C1);x1(i,()=>{r(!0)}),e.get(bv).afterPreactivation=()=>(r(!0),s.closed?U(void 0):s),i.initialNavigation()}))}}])}function KB(){return jl(3,[{provide:Sf,multi:!0,useFactory:()=>{let e=P(Ai);return()=>{e.setUpLocationChangeListener()}}},{provide:Dv,useValue:2}])}var I1=new O("");function QB(t){return jl(0,[{provide:I1,useExisting:HB},{provide:Zf,useExisting:t}])}function YB(){return jl(8,[BA,{provide:Xf,useExisting:BA}])}function ZB(t){let e=[{provide:_1,useValue:RB},{provide:y1,useValue:A({skipNextTransition:!!t?.skipInitialTransition},t)}];return jl(9,e)}var $A=new O("ROUTER_FORROOT_GUARD"),XB=[ua,{provide:kl,useClass:bl},Ai,Ol,{provide:Os,useFactory:GB,deps:[Ai]},Cv,[]],Tv=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[XB,[],{provide:Yf,multi:!0,useValue:r},{provide:$A,useFactory:nU,deps:[[Ai,new ia,new F0]]},{provide:Ll,useValue:i||{}},i?.useHash?eU():tU(),JB(),i?.preloadingStrategy?QB(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?rU(i):[],i?.bindToComponentInputs?YB().\u0275providers:[],i?.enableViewTransitions?ZB().\u0275providers:[],iU()]}}static forChild(r){return{ngModule:e,providers:[{provide:Yf,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(C($A,8))},e.\u0275mod=it({type:e}),e.\u0275inj=rt({});let t=e;return t})();function JB(){return{provide:E1,useFactory:()=>{let t=P(IA),e=P(ge),n=P(Ll),r=P(bv),i=P(kl);return n.scrollOffset&&t.setOffset(n.scrollOffset),new qB(i,r,t,e,n)}}}function eU(){return{provide:Zr,useClass:wA}}function tU(){return{provide:Zr,useClass:Ry}}function nU(t){return"guarded"}function rU(t){return[t.initialNavigation==="disabled"?KB().\u0275providers:[],t.initialNavigation==="enabledBlocking"?WB().\u0275providers:[]]}var HA=new O("");function iU(){return[{provide:HA,useFactory:zB},{provide:xy,multi:!0,useExisting:HA}]}var Sv=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=cn({type:e,selectors:[["app-home"]],decls:20,vars:0,consts:[[1,"page"],[2,"text-align","center","margin-bottom","2rem"],[1,"row",2,"align-items","start"],[1,"column"]],template:function(i,s){i&1&&(x(0,"div",0)(1,"h1",1),D(2,"Evaluaci\xF3n Tercer Parcial"),w(),x(3,"h2",1),D(4,"Desarrollo Web Profesional"),w(),x(5,"div",2)(6,"div",3)(7,"h3"),D(8,"Integrantes:"),w(),x(9,"p"),D(10,"Diosdado Rodr\xEDguez Miguel \xC1ngel"),w(),x(11,"p"),D(12,"Hern\xE1ndez \xC1vila Fernanda Montserrat"),w(),x(13,"p"),D(14,"Pinz\xF3n Huerta Erick"),w()(),x(15,"div",3)(16,"h3"),D(17,"Descripci\xF3n:"),w(),x(18,"p"),D(19,"Aplicaci\xF3n Web de venta de coches con CRUD de clientes y coches hecha con Angular."),w()()()())}});let t=e;return t})();var Ca=class{constructor(e){this.id="",this.marca="",this.modelo="",this.precio=0,this.kilometros=0,this.vendido=!1,this.transmision="",this.transacciones=[],this.due\u00F1oActual="",this.marca=e.marca,this.modelo=e.modelo,this.precio=e.precio,this.kilometros=e.kilometros,this.vendido=e.vendido,this.transmision=e.transmision,this.due\u00F1oActual=e.due\u00F1oActual}};var Rt=function(t){return t[t.create=0]="create",t[t.select=1]="select",t[t.sell=2]="sell",t}(Rt||{});function Bl(t){return/^[a-zA-Z---]+(?:\s+[a-zA-Z---]+)*$/.test(t)}function Av(t){return/^[1-9][0-9]*$/.test(t)}function b1(t){return/^\d{10}$/.test(t)}function D1(t){return/^[a-zA-Z0-9---]+(?:\s*[a-zA-Z0-9---]+)*$/.test(t)}function T1(t){return/^\S[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}\S$/.test(t)}var Fs=class{constructor(e){this.id="",this.fecha="",this.precio=0,this.metodoPago="",this.coche="",this.cliente="",this.tipo="",this.fecha=e.fecha,this.precio=e.precio,this.metodoPago=e.metodoPago,this.coche=e.coche,this.cliente=e.cliente,this.tipo=e.tipo}};var oU="firebase",aU="10.10.0";$n(oU,aU,"app");var Vs=new qr("ANGULARFIRE2_VERSION");var cU=(t,e)=>{let n=e?[e]:Hb(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Xr=class{constructor(){return cU(lU)}},lU="app-check";function Mv(){}var ep=class{zone;delegate;constructor(e,n=C_){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},Nv=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Mv,{},Mv,Mv)),n.pipe(pt({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Ia=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new ep(Zone.current)),this.insideAngular=n.run(()=>new ep(Zone.current,gs)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(C(ge))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function uU(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function Ye(t){return dU(uU())(t)}function dU(t){return function(n){return n=n.lift(new Nv(t.ngZone)),n.pipe(qn(t.outsideAngular),Tn(t.insideAngular))}}var hU=new Map,fU={activated:!1,tokenObservers:[]},pU={initialized:!1,enabled:!1};function Xn(t){return hU.get(t)||Object.assign({},fU)}function k1(){return pU}var gU="https://content-firebaseappcheck.googleapis.com/v1";var mU="exchangeDebugToken",S1={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},lte=24*60*60*1e3;var kv=class{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return g(this,null,function*(){this.stop();try{this.pending=new yt,this.pending.promise.catch(n=>{}),yield _U(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new yt,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function _U(t){return new Promise(e=>{setTimeout(e,t)})}var yU={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Ni=new Vb("appCheck","AppCheck",yU);function O1(t){if(!Xn(t).activated)throw Ni.create("use-before-activation",{appName:t.name})}function F1(r,i){return g(this,arguments,function*({url:t,body:e},n){let s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let f=yield o.getHeartbeatsHeader();f&&(s["X-Firebase-Client"]=f)}let a={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(t,a)}catch(f){throw Ni.create("fetch-network-error",{originalErrorMessage:f?.message})}if(c.status!==200)throw Ni.create("fetch-status-error",{httpStatus:c.status});let l;try{l=yield c.json()}catch(f){throw Ni.create("fetch-parse-error",{originalErrorMessage:f?.message})}let u=l.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw Ni.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let d=Number(u[1])*1e3,h=Date.now();return{token:l.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function V1(t,e){let{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${gU}/projects/${n}/apps/${r}:${mU}?key=${i}`,body:{debug_token:e}}}var vU="firebase-app-check-database",xU=1,Ov="firebase-app-check-store";var tp=null;function wU(){return tp||(tp=new Promise((t,e)=>{try{let n=indexedDB.open(vU,xU);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var i;e(Ni.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Ov,{keyPath:"compositeKey"})}}}catch(n){e(Ni.create("storage-open",{originalErrorMessage:n?.message}))}}),tp)}function EU(t,e){return CU(IU(t),e)}function CU(t,e){return g(this,null,function*(){let r=(yield wU()).transaction(Ov,"readwrite"),s=r.objectStore(Ov).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},r.onerror=c=>{var l;a(Ni.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})})}function IU(t){return`${t.options.appId}-${t.name}`}var Fv=new fi("@firebase/app-check");function Pv(t,e){return Wd()?EU(t,e).catch(n=>{Fv.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function L1(){return k1().enabled}function j1(){return g(this,null,function*(){let t=k1();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var bU={error:"UNKNOWN_ERROR"};function DU(t){return Gd.encodeString(JSON.stringify(t),!1)}function Vv(t,e=!1){return g(this,null,function*(){let n=t.app;O1(n);let r=Xn(n),i=r.token,s;if(i&&!Ul(i)&&(r.token=void 0,i=void 0),!i){let c=yield r.cachedTokenPromise;c&&(Ul(c)?i=c:yield Pv(n,void 0))}if(!e&&i&&Ul(i))return{token:i.token};let o=!1;if(L1()){r.exchangeTokenPromise||(r.exchangeTokenPromise=F1(V1(n,yield j1()),t.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let c=yield r.exchangeTokenPromise;return yield Pv(n,c),r.token=c,{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield Xn(n).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?Fv.warn(c.message):Fv.error(c),s=c}let a;return i?s?Ul(i)?a={token:i.token,internalError:s}:a=M1(s):(a={token:i.token},r.token=i,yield Pv(n,i)):a=M1(s),o&&MU(n,a),a})}function TU(t){return g(this,null,function*(){let e=t.app;O1(e);let{provider:n}=Xn(e);if(L1()){let r=yield j1(),{token:i}=yield F1(V1(e,r),t.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield n.getToken();return{token:r}}})}function SU(t,e,n,r){let{app:i}=t,s=Xn(i),o={next:n,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Ul(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),A1(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>A1(t))}function B1(t,e){let n=Xn(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function A1(t){let{app:e}=t,n=Xn(e),r=n.tokenRefresher;r||(r=AU(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function AU(t){let{app:e}=t;return new kv(()=>g(this,null,function*(){let n=Xn(e),r;if(n.token?r=yield Vv(t,!0):r=yield Vv(t),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=Xn(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,i=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},S1.RETRIAL_MIN_WAIT,S1.RETRIAL_MAX_WAIT)}function MU(t,e){let n=Xn(t).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Ul(t){return t.expireTimeMillis-Date.now()>0}function M1(t){return{token:DU(bU),error:t}}var Lv=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=Xn(this.app);for(let n of e)B1(this.app,n.next);return Promise.resolve()}};function NU(t,e){return new Lv(t,e)}function RU(t){return{getToken:e=>Vv(t,e),getLimitedUseToken:()=>TU(t),addTokenListener:e=>SU(t,"INTERNAL",e),removeTokenListener:e=>B1(t.app,e)}}var PU="@firebase/app-check",kU="0.8.3";var OU="app-check",N1="app-check-internal";function FU(){us(new pn(OU,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return NU(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(N1).initialize()})),us(new pn(N1,t=>{let e=t.getProvider("app-check").getImmediate();return RU(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),$n(PU,kU)}FU();var VU=["localhost","0.0.0.0","127.0.0.1"],wte=typeof window<"u"&&VU.includes(window.location.hostname);var LU="firebase",jU="10.10.0";St.registerVersion(LU,jU,"app-compat");var BU=["ngOnDestroy"],$1=(t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(BU.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let c=a?.[s];return typeof c=="function"?c.bind(a):c?.then?c.then(l=>n.run(()=>l)):n.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>o[c],apply:(a,c,l)=>o.then(u=>{let d=u?.(...l);return r?.spy?.apply&&r.spy.apply(s,l,d),d})})})});var np=class{constructor(e){return e}},Ri=new O("angularfire2.app.options"),Pi=new O("angularfire2.app.name");function Ls(t,e,n){let r=typeof n=="string"&&n||"[DEFAULT]",i=typeof n=="object"&&n||{};i.name=i.name||r;let o=St.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>St.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let a=!!module.hot;UU("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new np(o)}var UU=(t,...e)=>{Cy()&&typeof console<"u"&&console[t](...e)},$U={provide:np,useFactory:Ls,deps:[Ri,ge,[new ia,Pi]]},H1=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:Ri,useValue:n},{provide:Pi,useValue:r}]}}constructor(n){St.registerVersion("angularfire",Vs.full,"core"),St.registerVersion("angularfire",Vs.full,"app-compat"),St.registerVersion("angular",tA.full,n.toString())}static \u0275fac=function(r){return new(r||t)(C(Lt))};static \u0275mod=it({type:t});static \u0275inj=rt({providers:[$U]})}return t})();function ba(t,e,n,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return HU(i,o)||(U1("error",`${e} was already initialized on the ${n} Firebase App with different settings.${qU?" You may need to reload as Firebase is not HMR aware.":""}`),U1("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}function HU(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var qU=typeof module<"u"&&!!module.hot,U1=(t,...e)=>{Cy()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var $l=new O("angularfire2.auth.use-emulator"),Hl=new O("angularfire2.auth.settings"),ql=new O("angularfire2.auth.tenant-id"),Gl=new O("angularfire2.auth.langugage-code"),zl=new O("angularfire2.auth.use-device-language"),Wl=new O("angularfire.auth.persistence"),Kl=(t,e,n,r,i,s,o,a)=>ba(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let c=e.runOutsideAngular(()=>t.auth());if(n&&c.useEmulator(...n),r&&(c.tenantId=r),c.languageCode=i,s&&c.useDeviceLanguage(),o)for(let[l,u]of Object.entries(o))c.settings[l]=u;return a&&c.setPersistence(a),c},[n,r,i,s,o,a]),rp=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,c,l,u,d,h,f){let p=new Ge,m=U(void 0).pipe(Tn(o.outsideAngular),Be(()=>s.runOutsideAngular(()=>import("./chunk-EA5I5XF3.js"))),B(()=>Ls(n,s,r)),B(v=>Kl(v,s,a,l,u,d,c,h)),Ch({bufferSize:1,refCount:!1}));if(Rs(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=U(null);else{m.pipe(Sn()).subscribe();let v=m.pipe(Be(S=>S.getRedirectResult().then(q=>q,()=>null)),Ye,Ch({bufferSize:1,refCount:!1})),b=m.pipe(Be(S=>new ae(q=>({unsubscribe:s.runOutsideAngular(()=>S.onAuthStateChanged(K=>q.next(K),K=>q.error(K),()=>q.complete()))})))),F=m.pipe(Be(S=>new ae(q=>({unsubscribe:s.runOutsideAngular(()=>S.onIdTokenChanged(K=>q.next(K),K=>q.error(K),()=>q.complete()))}))));this.authState=v.pipe(Ih(b),qn(o.outsideAngular),Tn(o.insideAngular)),this.user=v.pipe(Ih(F),qn(o.outsideAngular),Tn(o.insideAngular)),this.idToken=this.user.pipe(Be(S=>S?Ce(S.getIdToken()):U(null))),this.idTokenResult=this.user.pipe(Be(S=>S?Ce(S.getIdTokenResult()):U(null))),this.credential=Uo(v,p,this.authState.pipe(Nt(S=>!S))).pipe(B(S=>S?.user?S:null),qn(o.outsideAngular),Tn(o.insideAngular))}return $1(this,m,s,{spy:{apply:(v,b,F)=>{(v.startsWith("signIn")||v.startsWith("createUser"))&&F.then(S=>p.next(S))}}})}static \u0275fac=function(r){return new(r||t)(C(Ri),C(Pi,8),C(Lt),C(ge),C(Ia),C($l,8),C(Hl,8),C(ql,8),C(Gl,8),C(zl,8),C(Wl,8),C(Xr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var GU=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},er={},R,ax=ax||{},Z=GU||self;function _p(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function cu(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function zU(t){return Object.prototype.hasOwnProperty.call(t,Bv)&&t[Bv]||(t[Bv]=++WU)}var Bv="closure_uid_"+(1e9*Math.random()>>>0),WU=0;function KU(t,e,n){return t.call.apply(t.bind,arguments)}function QU(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Ut(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Ut=KU:Ut=QU,Ut.apply(null,arguments)}function ip(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Ct(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function ki(){this.s=this.s,this.o=this.o}var YU=0;ki.prototype.s=!1;ki.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),YU!=0)&&zU(this)};ki.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var rM=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function cx(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function G1(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(_p(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function $t(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}$t.prototype.h=function(){this.defaultPrevented=!0};var ZU=function(){if(!Z.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};Z.addEventListener("test",n,e),Z.removeEventListener("test",n,e)}catch{}return t}();function eu(t){return/^[\s\xa0]*$/.test(t)}function yp(){var t=Z.navigator;return t&&(t=t.userAgent)?t:""}function Er(t){return yp().indexOf(t)!=-1}function lx(t){return lx[" "](t),t}lx[" "]=function(){};function XU(t,e){var n=B6;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var JU=Er("Opera"),Aa=Er("Trident")||Er("MSIE"),iM=Er("Edge"),Gv=iM||Aa,sM=Er("Gecko")&&!(yp().toLowerCase().indexOf("webkit")!=-1&&!Er("Edge"))&&!(Er("Trident")||Er("MSIE"))&&!Er("Edge"),e6=yp().toLowerCase().indexOf("webkit")!=-1&&!Er("Edge");function oM(){var t=Z.document;return t?t.documentMode:void 0}var zv;e:{if(sp="",op=function(){var t=yp();if(sM)return/rv:([^\);]+)(\)|;)/.exec(t);if(iM)return/Edge\/([\d\.]+)/.exec(t);if(Aa)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(e6)return/WebKit\/(\S+)/.exec(t);if(JU)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),op&&(sp=op?op[1]:""),Aa&&(ap=oM(),ap!=null&&ap>parseFloat(sp))){zv=String(ap);break e}zv=sp}var sp,op,ap,Wv;Z.document&&Aa?(Uv=oM(),Wv=Uv||parseInt(zv,10)||void 0):Wv=void 0;var Uv,t6=Wv;function tu(t,e){if($t.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(sM){e:{try{lx(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:n6[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&tu.$.h.call(this)}}Ct(tu,$t);var n6={2:"touch",3:"pen",4:"mouse"};tu.prototype.h=function(){tu.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var lu="closure_listenable_"+(1e6*Math.random()|0),r6=0;function i6(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++r6,this.fa=this.ia=!1}function vp(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function ux(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function s6(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function aM(t){let e={};for(let n in t)e[n]=t[n];return e}var z1="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function cM(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<z1.length;s++)n=z1[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function xp(t){this.src=t,this.g={},this.h=0}xp.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=Qv(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new i6(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function Kv(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=rM(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(vp(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Qv(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var dx="closure_lm_"+(1e6*Math.random()|0),$v={};function lM(t,e,n,r,i){if(r&&r.once)return dM(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)lM(t,e[s],n,r,i);return null}return n=px(n),t&&t[lu]?t.O(e,n,cu(r)?!!r.capture:!!r,i):uM(t,e,n,!1,r,i)}function uM(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=cu(i)?!!i.capture:!!i,a=fx(t);if(a||(t[dx]=a=new xp(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=o6(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)ZU||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(fM(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function o6(){function t(n){return e.call(t.src,t.listener,n)}let e=a6;return t}function dM(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)dM(t,e[s],n,r,i);return null}return n=px(n),t&&t[lu]?t.P(e,n,cu(r)?!!r.capture:!!r,i):uM(t,e,n,!0,r,i)}function hM(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)hM(t,e[s],n,r,i);else r=cu(r)?!!r.capture:!!r,n=px(n),t&&t[lu]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=Qv(s,n,r,i),-1<n&&(vp(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=fx(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Qv(e,n,r,i)),(n=-1<t?e[t]:null)&&hx(n))}function hx(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[lu])Kv(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(fM(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=fx(e))?(Kv(n,t),n.h==0&&(n.src=null,e[dx]=null)):vp(t)}}}function fM(t){return t in $v?$v[t]:$v[t]="on"+t}function a6(t,e){if(t.fa)t=!0;else{e=new tu(e,this);var n=t.listener,r=t.la||t.src;t.ia&&hx(t),t=n.call(r,e)}return t}function fx(t){return t=t[dx],t instanceof xp?t:null}var Hv="__closure_events_fn_"+(1e9*Math.random()>>>0);function px(t){return typeof t=="function"?t:(t[Hv]||(t[Hv]=function(e){return t.handleEvent(e)}),t[Hv])}function Et(){ki.call(this),this.i=new xp(this),this.S=this,this.J=null}Ct(Et,ki);Et.prototype[lu]=!0;Et.prototype.removeEventListener=function(t,e,n,r){hM(this,t,e,n,r)};function kt(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new $t(e,t);else if(e instanceof $t)e.target=e.target||t;else{var i=e;e=new $t(r,t),cM(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=cp(o,r,!0,e)&&i}if(o=e.g=t,i=cp(o,r,!0,e)&&i,i=cp(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=cp(o,r,!1,e)&&i}Et.prototype.N=function(){if(Et.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)vp(n[r]);delete t.g[e],t.h--}}this.J=null};Et.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};Et.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function cp(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&Kv(t.i,o),i=a.call(c,r)!==!1&&i}}return i&&!r.defaultPrevented}var gx=Z.JSON.stringify,Yv=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function c6(){var t=mx;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Zv=class{constructor(){this.h=this.g=null}add(e,n){let r=pM.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},pM=new Yv(()=>new Xv,t=>t.reset()),Xv=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function l6(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function u6(t){Z.setTimeout(()=>{throw t},0)}var nu,ru=!1,mx=new Zv,gM=()=>{let t=Z.Promise.resolve(void 0);nu=()=>{t.then(d6)}},d6=()=>{for(var t;t=c6();){try{t.h.call(t.g)}catch(n){u6(n)}var e=pM;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}ru=!1};function wp(t,e){Et.call(this),this.h=t||1,this.g=e||Z,this.j=Ut(this.qb,this),this.l=Date.now()}Ct(wp,Et);R=wp.prototype;R.ga=!1;R.T=null;R.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),kt(this,"tick"),this.ga&&(_x(this),this.start()))}};R.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function _x(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}R.N=function(){wp.$.N.call(this),_x(this),delete this.g};function yx(t,e,n){if(typeof t=="function")n&&(t=Ut(t,n));else if(t&&typeof t.handleEvent=="function")t=Ut(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Z.setTimeout(t,e||0)}function mM(t){t.g=yx(()=>{t.g=null,t.i&&(t.i=!1,mM(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var Jv=class extends ki{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:mM(this)}N(){super.N(),this.g&&(Z.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function iu(t){ki.call(this),this.h=t,this.g={}}Ct(iu,ki);var W1=[];function _M(t,e,n,r){Array.isArray(n)||(n&&(W1[0]=n.toString()),n=W1);for(var i=0;i<n.length;i++){var s=lM(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function yM(t){ux(t.g,function(e,n){this.g.hasOwnProperty(n)&&hx(e)},t),t.g={}}iu.prototype.N=function(){iu.$.N.call(this),yM(this)};iu.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Ep(){this.g=!0}Ep.prototype.Ea=function(){this.g=!1};function h6(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var d=u.split("_");o=2<=d.length&&d[1]=="type"?o+(u+"="+l+"&"):o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function f6(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function Ta(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+g6(t,n)+(r?" "+r:"")})}function p6(t,e){t.info(function(){return"TIMEOUT: "+e})}Ep.prototype.info=function(){};function g6(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return gx(n)}catch{return e}}var $s={},K1=null;function Cp(){return K1=K1||new Et}$s.Ta="serverreachability";function vM(t){$t.call(this,$s.Ta,t)}Ct(vM,$t);function su(t){let e=Cp();kt(e,new vM(e))}$s.STAT_EVENT="statevent";function xM(t,e){$t.call(this,$s.STAT_EVENT,t),this.stat=e}Ct(xM,$t);function Zt(t){let e=Cp();kt(e,new xM(e,t))}$s.Ua="timingevent";function wM(t,e){$t.call(this,$s.Ua,t),this.size=e}Ct(wM,$t);function uu(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return Z.setTimeout(function(){t()},e)}var Ip={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},EM={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function vx(){}vx.prototype.h=null;function Q1(t){return t.h||(t.h=t.i())}function CM(){}var du={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function xx(){$t.call(this,"d")}Ct(xx,$t);function wx(){$t.call(this,"c")}Ct(wx,$t);var ex;function bp(){}Ct(bp,vx);bp.prototype.g=function(){return new XMLHttpRequest};bp.prototype.i=function(){return{}};ex=new bp;function hu(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new iu(this),this.P=m6,t=Gv?125:void 0,this.V=new wp(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new IM}function IM(){this.i=null,this.g="",this.h=!1}var m6=45e3,bM={},tx={};R=hu.prototype;R.setTimeout=function(t){this.P=t};function nx(t,e,n){t.L=1,t.A=Tp(ei(e)),t.u=n,t.S=!0,DM(t,null)}function DM(t,e){t.G=Date.now(),fu(t),t.B=ei(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),kM(n.i,"t",r),t.o=0,n=t.l.J,t.h=new IM,t.g=tN(t.l,n?e:null,!t.u),0<t.O&&(t.M=new Jv(Ut(t.Pa,t,t.g),t.O)),_M(t.U,t.g,"readystatechange",t.nb),e=t.I?aM(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),su(),h6(t.j,t.v,t.B,t.m,t.W,t.u)}R.nb=function(t){t=t.target;let e=this.M;e&&Cr(t)==3?e.l():this.Pa(t)};R.Pa=function(t){try{if(t==this.g)e:{let u=Cr(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>u)&&(u!=3||Gv||this.g&&(this.h.h||this.g.ja()||J1(this.g)))){this.J||u!=4||e==7||(e==8||0>=d?su(3):su(2)),Dp(this);var n=this.g.da();this.ca=n;t:if(TM(this)){var r=J1(this.g);t="";var i=r.length,s=Cr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){js(this),Jl(this);var o="";break t}this.h.i=new Z.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,f6(this.j,this.v,this.B,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!eu(a)){var l=a;break t}}l=null}if(n=l)Ta(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,rx(this,n);else{this.i=!1,this.s=3,Zt(12),js(this),Jl(this);break e}}this.S?(SM(this,u,o),Gv&&this.i&&u==3&&(_M(this.U,this.V,"tick",this.mb),this.V.start())):(Ta(this.j,this.m,o,null),rx(this,o)),u==4&&js(this),this.i&&!this.J&&(u==4?ZM(this.l,this):(this.i=!1,fu(this)))}else V6(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,Zt(12)):(this.s=0,Zt(13)),js(this),Jl(this)}}}catch{}finally{}};function TM(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function SM(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=_6(t,n),i==tx){e==4&&(t.s=4,Zt(14),r=!1),Ta(t.j,t.m,null,"[Incomplete Response]");break}else if(i==bM){t.s=4,Zt(15),Ta(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Ta(t.j,t.m,i,null),rx(t,i);TM(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,Zt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Tx(e),e.M=!0,Zt(11))):(Ta(t.j,t.m,n,"[Invalid Chunked Response]"),js(t),Jl(t))}R.mb=function(){if(this.g){var t=Cr(this.g),e=this.g.ja();this.o<e.length&&(Dp(this),SM(this,t,e),this.i&&t!=4&&fu(this))}};function _6(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?tx:(n=Number(e.substring(n,r)),isNaN(n)?bM:(r+=1,r+n>e.length?tx:(e=e.slice(r,r+n),t.o=r+n,e)))}R.cancel=function(){this.J=!0,js(this)};function fu(t){t.Y=Date.now()+t.P,AM(t,t.P)}function AM(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=uu(Ut(t.lb,t),e)}function Dp(t){t.C&&(Z.clearTimeout(t.C),t.C=null)}R.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(p6(this.j,this.B),this.L!=2&&(su(),Zt(17)),js(this),this.s=2,Jl(this)):AM(this,this.Y-t)};function Jl(t){t.l.H==0||t.J||ZM(t.l,t)}function js(t){Dp(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,_x(t.V),yM(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function rx(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||ix(n.i,t))){if(!t.K&&ix(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)fp(n),Mp(n);else break e;Dx(n),Zt(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=uu(Ut(n.ib,n),6e3));if(1>=VM(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Bs(n,11)}else if((t.K||n.g==t)&&fp(n),!eu(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(n.V=l[0],l=l[1],n.H==2)if(l[0]=="c"){n.K=l[1],n.pa=l[2];let u=l[3];u!=null&&(n.ra=u,n.l.info("VER="+n.ra));let d=l[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let h=l[5];h!=null&&typeof h=="number"&&0<h&&(r=1.5*h,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let f=t.g;if(f){let p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=r.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(Ex(s,s.h),s.h=null))}if(r.F){let m=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;m&&(r.Da=m,Le(r.I,r.F,m))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=eN(r,r.J?r.pa:null,r.Y),o.K){LM(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.C&&(Dp(a),fu(a)),r.g=o}else QM(r);0<n.j.length&&Np(n)}else l[0]!="stop"&&l[0]!="close"||Bs(n,7);else n.H==3&&(l[0]=="stop"||l[0]=="close"?l[0]=="stop"?Bs(n,7):bx(n):l[0]!="noop"&&n.h&&n.h.Aa(l),n.A=0)}}su(4)}catch{}}function y6(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(_p(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function v6(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(_p(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function MM(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(_p(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=v6(t),r=y6(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var NM=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function x6(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Us(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Us){this.h=t.h,dp(this,t.j),this.s=t.s,this.g=t.g,hp(this,t.m),this.l=t.l;var e=t.i,n=new ou;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Y1(this,n),this.o=t.o}else t&&(e=String(t).match(NM))?(this.h=!1,dp(this,e[1]||"",!0),this.s=Zl(e[2]||""),this.g=Zl(e[3]||"",!0),hp(this,e[4]),this.l=Zl(e[5]||"",!0),Y1(this,e[6]||"",!0),this.o=Zl(e[7]||"")):(this.h=!1,this.i=new ou(null,this.h))}Us.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Xl(e,Z1,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Xl(e,Z1,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Xl(n,n.charAt(0)=="/"?C6:E6,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Xl(n,b6)),t.join("")};function ei(t){return new Us(t)}function dp(t,e,n){t.j=n?Zl(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function hp(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Y1(t,e,n){e instanceof ou?(t.i=e,D6(t.i,t.h)):(n||(e=Xl(e,I6)),t.i=new ou(e,t.h))}function Le(t,e,n){t.i.set(e,n)}function Tp(t){return Le(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Zl(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Xl(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,w6),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function w6(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Z1=/[#\/\?@]/g,E6=/[#\?:]/g,C6=/[#\?]/g,I6=/[#\?@]/g,b6=/#/g;function ou(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Oi(t){t.g||(t.g=new Map,t.h=0,t.i&&x6(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}R=ou.prototype;R.add=function(t,e){Oi(this),this.i=null,t=Ma(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function RM(t,e){Oi(t),e=Ma(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function PM(t,e){return Oi(t),e=Ma(t,e),t.g.has(e)}R.forEach=function(t,e){Oi(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};R.ta=function(){Oi(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};R.Z=function(t){Oi(this);let e=[];if(typeof t=="string")PM(this,t)&&(e=e.concat(this.g.get(Ma(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};R.set=function(t,e){return Oi(this),this.i=null,t=Ma(this,t),PM(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};R.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function kM(t,e,n){RM(t,e),0<n.length&&(t.i=null,t.g.set(Ma(t,e),cx(n)),t.h+=n.length)}R.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function Ma(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function D6(t,e){e&&!t.j&&(Oi(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(RM(this,r),kM(this,i,n))},t)),t.j=e}var T6=class{constructor(t,e){this.g=t,this.map=e}};function OM(t){this.l=t||S6,Z.PerformanceNavigationTiming?(t=Z.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(Z.g&&Z.g.Ka&&Z.g.Ka()&&Z.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var S6=10;function FM(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function VM(t){return t.h?1:t.g?t.g.size:0}function ix(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function Ex(t,e){t.g?t.g.add(e):t.h=e}function LM(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}OM.prototype.cancel=function(){if(this.i=jM(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function jM(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return cx(t.i)}var A6=class{stringify(t){return Z.JSON.stringify(t,void 0)}parse(t){return Z.JSON.parse(t,void 0)}};function M6(){this.g=new A6}function N6(t,e,n){let r=n||"";try{MM(t,function(i,s){let o=i;cu(i)&&(o=gx(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function R6(t,e){let n=new Ep;if(Z.Image){let r=new Image;r.onload=ip(lp,n,r,"TestLoadImage: loaded",!0,e),r.onerror=ip(lp,n,r,"TestLoadImage: error",!1,e),r.onabort=ip(lp,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=ip(lp,n,r,"TestLoadImage: timeout",!1,e),Z.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function lp(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function pu(t){this.l=t.ec||null,this.j=t.ob||!1}Ct(pu,vx);pu.prototype.g=function(){return new Sp(this.l,this.j)};pu.prototype.i=function(t){return function(){return t}}({});function Sp(t,e){Et.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Cx,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ct(Sp,Et);var Cx=0;R=Sp.prototype;R.open=function(t,e){if(this.readyState!=Cx)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,au(this)};R.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Z).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};R.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,gu(this)),this.readyState=Cx};R.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,au(this)),this.g&&(this.readyState=3,au(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Z.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;BM(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function BM(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}R.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?gu(this):au(this),this.readyState==3&&BM(this)}};R.Za=function(t){this.g&&(this.response=this.responseText=t,gu(this))};R.Ya=function(t){this.g&&(this.response=t,gu(this))};R.ka=function(){this.g&&gu(this)};function gu(t){t.readyState=4,t.l=null,t.j=null,t.A=null,au(t)}R.setRequestHeader=function(t,e){this.v.append(t,e)};R.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};R.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function au(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Sp.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var P6=Z.JSON.parse;function ze(t){Et.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=UM,this.L=this.M=!1}Ct(ze,Et);var UM="",k6=/^https?$/i,O6=["POST","PUT"];R=ze.prototype;R.Oa=function(t){this.M=t};R.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():ex.g(),this.C=this.u?Q1(this.u):Q1(ex),this.g.onreadystatechange=Ut(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){X1(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=Z.FormData&&t instanceof Z.FormData,!(0<=rM(O6,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{qM(this),0<this.B&&((this.L=F6(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ut(this.ua,this)):this.A=yx(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){X1(this,s)}};function F6(t){return Aa&&typeof t.timeout=="number"&&t.ontimeout!==void 0}R.ua=function(){typeof ax<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,kt(this,"timeout"),this.abort(8))};function X1(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,$M(t),Ap(t)}function $M(t){t.F||(t.F=!0,kt(t,"complete"),kt(t,"error"))}R.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,kt(this,"complete"),kt(this,"abort"),Ap(this))};R.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ap(this,!0)),ze.$.N.call(this)};R.La=function(){this.s||(this.G||this.v||this.l?HM(this):this.kb())};R.kb=function(){HM(this)};function HM(t){if(t.h&&typeof ax<"u"&&(!t.C[1]||Cr(t)!=4||t.da()!=2)){if(t.v&&Cr(t)==4)yx(t.La,0,t);else if(kt(t,"readystatechange"),Cr(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(NM)[1]||null;!i&&Z.self&&Z.self.location&&(i=Z.self.location.protocol.slice(0,-1)),r=!k6.test(i?i.toLowerCase():"")}n=r}if(n)kt(t,"complete"),kt(t,"success");else{t.m=6;try{var s=2<Cr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",$M(t)}}finally{Ap(t)}}}}function Ap(t,e){if(t.g){qM(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||kt(t,"ready");try{n.onreadystatechange=r}catch{}}}function qM(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Z.clearTimeout(t.A),t.A=null)}R.isActive=function(){return!!this.g};function Cr(t){return t.g?t.g.readyState:0}R.da=function(){try{return 2<Cr(this)?this.g.status:-1}catch{return-1}};R.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};R.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),P6(e)}};function J1(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case UM:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function V6(t){let e={};t=(t.g&&2<=Cr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(eu(t[r]))continue;var n=l6(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}s6(e,function(r){return r.join(", ")})}R.Ia=function(){return this.m};R.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function GM(t){let e="";return ux(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function Ix(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=GM(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Le(t,e,n))}function Ql(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function zM(t){this.Ga=0,this.j=[],this.l=new Ep,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Ql("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Ql("baseRetryDelayMs",5e3,t),this.hb=Ql("retryDelaySeedMs",1e4,t),this.eb=Ql("forwardChannelMaxRetries",2,t),this.xa=Ql("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new OM(t&&t.concurrentRequestLimit),this.Ja=new M6,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}R=zM.prototype;R.ra=8;R.H=1;function bx(t){if(WM(t),t.H==3){var e=t.W++,n=ei(t.I);if(Le(n,"SID",t.K),Le(n,"RID",e),Le(n,"TYPE","terminate"),mu(t,n),e=new hu(t,t.l,e),e.L=2,e.A=Tp(ei(n)),n=!1,Z.navigator&&Z.navigator.sendBeacon)try{n=Z.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&Z.Image&&(new Image().src=e.A,n=!0),n||(e.g=tN(e.l,null),e.g.ha(e.A)),e.G=Date.now(),fu(e)}JM(t)}function Mp(t){t.g&&(Tx(t),t.g.cancel(),t.g=null)}function WM(t){Mp(t),t.u&&(Z.clearTimeout(t.u),t.u=null),fp(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&Z.clearTimeout(t.m),t.m=null)}function Np(t){if(!FM(t.i)&&!t.m){t.m=!0;var e=t.Na;nu||gM(),ru||(nu(),ru=!0),mx.add(e,t),t.C=0}}function L6(t,e){return VM(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=uu(Ut(t.Na,t,e),XM(t,t.C)),t.C++,!0)}R.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new hu(this,this.l,t),s=this.s;if(this.U&&(s?(s=aM(s),cM(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=KM(this,i,e),n=ei(this.I),Le(n,"RID",t),Le(n,"CVER",22),this.F&&Le(n,"X-HTTP-Session-Id",this.F),mu(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(GM(s)))+"&"+e:this.o&&Ix(n,this.o,s)),Ex(this.i,i),this.bb&&Le(n,"TYPE","init"),this.P?(Le(n,"$req",e),Le(n,"SID","null"),i.aa=!0,nx(i,n,null)):nx(i,n,e),this.H=2}}else this.H==3&&(t?eM(this,t):this.j.length==0||FM(this.i)||eM(this))};function eM(t,e){var n;e?n=e.m:n=t.W++;let r=ei(t.I);Le(r,"SID",t.K),Le(r,"RID",n),Le(r,"AID",t.V),mu(t,r),t.o&&t.s&&Ix(r,t.o,t.s),n=new hu(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=KM(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Ex(t.i,n),nx(n,r,e)}function mu(t,e){t.na&&ux(t.na,function(n,r){Le(e,r,n)}),t.h&&MM({},function(n,r){Le(e,r,n)})}function KM(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Ut(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<n;c++){let l=i[c].g,u=i[c].map;if(l-=s,0>l)s=Math.max(0,i[c].g-100),a=!1;else try{N6(u,o,"req"+l+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function QM(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;nu||gM(),ru||(nu(),ru=!0),mx.add(e,t),t.A=0}}function Dx(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=uu(Ut(t.Ma,t),XM(t,t.A)),t.A++,!0)}R.Ma=function(){if(this.u=null,YM(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=uu(Ut(this.jb,this),t)}};R.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Zt(10),Mp(this),YM(this))};function Tx(t){t.B!=null&&(Z.clearTimeout(t.B),t.B=null)}function YM(t){t.g=new hu(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=ei(t.wa);Le(e,"RID","rpc"),Le(e,"SID",t.K),Le(e,"AID",t.V),Le(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Le(e,"TO",t.qa),Le(e,"TYPE","xmlhttp"),mu(t,e),t.o&&t.s&&Ix(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=Tp(ei(e)),n.u=null,n.S=!0,DM(n,t)}R.ib=function(){this.v!=null&&(this.v=null,Mp(this),Dx(this),Zt(19))};function fp(t){t.v!=null&&(Z.clearTimeout(t.v),t.v=null)}function ZM(t,e){var n=null;if(t.g==e){fp(t),Tx(t),t.g=null;var r=2}else if(ix(t.i,e))n=e.F,LM(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=Cp(),kt(r,new wM(r,n)),Np(t)}else QM(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&L6(t,e)||r==2&&Dx(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Bs(t,5);break;case 4:Bs(t,10);break;case 3:Bs(t,6);break;default:Bs(t,2)}}}function XM(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Bs(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Ut(t.pb,t);n||(n=new Us("//www.google.com/images/cleardot.gif"),Z.location&&Z.location.protocol=="http"||dp(n,"https"),Tp(n)),R6(n.toString(),r)}else Zt(2);t.H=0,t.h&&t.h.za(e),JM(t),WM(t)}R.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Zt(2)):(this.l.info("Failed to ping google.com"),Zt(1))};function JM(t){if(t.H=0,t.ma=[],t.h){let e=jM(t.i);(e.length!=0||t.j.length!=0)&&(G1(t.ma,e),G1(t.ma,t.j),t.i.i.length=0,cx(t.j),t.j.length=0),t.h.ya()}}function eN(t,e,n){var r=n instanceof Us?ei(n):new Us(n);if(r.g!="")e&&(r.g=e+"."+r.g),hp(r,r.m);else{var i=Z.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Us(null);r&&dp(s,r),e&&(s.g=e),i&&hp(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&Le(r,n,e),Le(r,"VER",t.ra),mu(t,r),r}function tN(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new ze(new pu({ob:n})):new ze(t.va),e.Oa(t.J),e}R.isActive=function(){return!!this.h&&this.h.isActive(this)};function nN(){}R=nN.prototype;R.Ba=function(){};R.Aa=function(){};R.za=function(){};R.ya=function(){};R.isActive=function(){return!0};R.Va=function(){};function pp(){if(Aa&&!(10<=Number(t6)))throw Error("Environmental error: no available transport.")}pp.prototype.g=function(t,e){return new yn(t,e)};function yn(t,e){Et.call(this),this.g=new zM(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!eu(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!eu(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Na(this)}Ct(yn,Et);yn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Zt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=eN(t,null,t.Y),Np(t)};yn.prototype.close=function(){bx(this.g)};yn.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=gx(t),t=n);e.j.push(new T6(e.fb++,t)),e.H==3&&Np(e)};yn.prototype.N=function(){this.g.h=null,delete this.j,bx(this.g),delete this.g,yn.$.N.call(this)};function rN(t){xx.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Ct(rN,xx);function iN(){wx.call(this),this.status=1}Ct(iN,wx);function Na(t){this.g=t}Ct(Na,nN);Na.prototype.Ba=function(){kt(this.g,"a")};Na.prototype.Aa=function(t){kt(this.g,new rN(t))};Na.prototype.za=function(t){kt(this.g,new iN)};Na.prototype.ya=function(){kt(this.g,"b")};function j6(){this.blockSize=-1}function Jn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Ct(Jn,j6);Jn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function qv(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}Jn.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)qv(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){qv(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){qv(this,r),i=0;break}}this.h=i,this.i+=e};Jn.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function Se(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var B6={};function Sx(t){return-128<=t&&128>t?XU(t,function(e){return new Se([e|0],0>e?-1:0)}):new Se([t|0],0>t?-1:0)}function Ir(t){if(isNaN(t)||!isFinite(t))return Sa;if(0>t)return Pt(Ir(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=sx;return new Se(e,0)}function sN(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Pt(sN(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Ir(Math.pow(e,8)),r=Sa,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=Ir(Math.pow(e,s)),r=r.R(s).add(Ir(o))):(r=r.R(n),r=r.add(Ir(o)))}return r}var sx=4294967296,Sa=Sx(0),ox=Sx(1),tM=Sx(16777216);R=Se.prototype;R.ea=function(){if(kn(this))return-Pt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:sx+r)*e,e*=sx}return t};R.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Jr(this))return"0";if(kn(this))return"-"+Pt(this).toString(t);for(var e=Ir(Math.pow(t,6)),n=this,r="";;){var i=mp(n,e).g;n=gp(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Jr(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};R.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Jr(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function kn(t){return t.h==-1}R.X=function(t){return t=gp(this,t),kn(t)?-1:Jr(t)?0:1};function Pt(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Se(n,~t.h).add(ox)}R.abs=function(){return kn(this)?Pt(this):this};R.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new Se(n,n[n.length-1]&-2147483648?-1:0)};function gp(t,e){return t.add(Pt(e))}R.R=function(t){if(Jr(this)||Jr(t))return Sa;if(kn(this))return kn(t)?Pt(this).R(Pt(t)):Pt(Pt(this).R(t));if(kn(t))return Pt(this.R(Pt(t)));if(0>this.X(tM)&&0>t.X(tM))return Ir(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,c=t.D(i)&65535;n[2*r+2*i]+=o*c,up(n,2*r+2*i),n[2*r+2*i+1]+=s*c,up(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,up(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,up(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Se(n,0)};function up(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Yl(t,e){this.g=t,this.h=e}function mp(t,e){if(Jr(e))throw Error("division by zero");if(Jr(t))return new Yl(Sa,Sa);if(kn(t))return e=mp(Pt(t),e),new Yl(Pt(e.g),Pt(e.h));if(kn(e))return e=mp(t,Pt(e)),new Yl(Pt(e.g),e.h);if(30<t.g.length){if(kn(t)||kn(e))throw Error("slowDivide_ only works with positive integers.");for(var n=ox,r=e;0>=r.X(t);)n=nM(n),r=nM(r);var i=Da(n,1),s=Da(r,1);for(r=Da(r,2),n=Da(n,2);!Jr(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=Da(r,1),n=Da(n,1)}return e=gp(t,i.R(e)),new Yl(i,e)}for(i=Sa;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Ir(n),o=s.R(e);kn(o)||0<o.X(t);)n-=r,s=Ir(n),o=s.R(e);Jr(s)&&(s=ox),i=i.add(s),t=gp(t,o)}return new Yl(i,t)}R.gb=function(t){return mp(this,t).h};R.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Se(n,this.h&t.h)};R.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Se(n,this.h|t.h)};R.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Se(n,this.h^t.h)};function nM(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Se(n,t.h)}function Da(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new Se(i,t.h)}pp.prototype.createWebChannel=pp.prototype.g;yn.prototype.send=yn.prototype.u;yn.prototype.open=yn.prototype.m;yn.prototype.close=yn.prototype.close;Ip.NO_ERROR=0;Ip.TIMEOUT=8;Ip.HTTP_ERROR=6;EM.COMPLETE="complete";CM.EventType=du;du.OPEN="a";du.CLOSE="b";du.ERROR="c";du.MESSAGE="d";Et.prototype.listen=Et.prototype.O;ze.prototype.listenOnce=ze.prototype.P;ze.prototype.getLastError=ze.prototype.Sa;ze.prototype.getLastErrorCode=ze.prototype.Ia;ze.prototype.getStatus=ze.prototype.da;ze.prototype.getResponseJson=ze.prototype.Wa;ze.prototype.getResponseText=ze.prototype.ja;ze.prototype.send=ze.prototype.ha;ze.prototype.setWithCredentials=ze.prototype.Oa;Jn.prototype.digest=Jn.prototype.l;Jn.prototype.reset=Jn.prototype.reset;Jn.prototype.update=Jn.prototype.j;Se.prototype.add=Se.prototype.add;Se.prototype.multiply=Se.prototype.R;Se.prototype.modulo=Se.prototype.gb;Se.prototype.compare=Se.prototype.X;Se.prototype.toNumber=Se.prototype.ea;Se.prototype.toString=Se.prototype.toString;Se.prototype.getBits=Se.prototype.D;Se.fromNumber=Ir;Se.fromString=sN;var oN=er.createWebChannelTransport=function(){return new pp},aN=er.getStatEventTarget=function(){return Cp()},Rp=er.ErrorCode=Ip,cN=er.EventType=EM,lN=er.Event=$s,Ax=er.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},zte=er.FetchXmlHttpFactory=pu,_u=er.WebChannel=CM,uN=er.XhrIo=ze,dN=er.Md5=Jn,Hs=er.Integer=Se;var hN="@firebase/firestore";var ut=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ut.UNAUTHENTICATED=new ut(null),ut.GOOGLE_CREDENTIALS=new ut("google-credentials-uid"),ut.FIRST_PARTY=new ut("first-party-uid"),ut.MOCK_USER=new ut("mock-user");var cc="10.10.0";var $i=new fi("@firebase/firestore");function Fa(){return $i.logLevel}function hR(t){$i.setLogLevel(t)}function I(t,...e){if($i.logLevel<=Dn.DEBUG){let n=e.map(RE);$i.debug(`Firestore (${cc}): ${t}`,...n)}}function Ze(t,...e){if($i.logLevel<=Dn.ERROR){let n=e.map(RE);$i.error(`Firestore (${cc}): ${t}`,...n)}}function Fn(t,...e){if($i.logLevel<=Dn.WARN){let n=e.map(RE);$i.warn(`Firestore (${cc}): ${t}`,...n)}}function RE(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function k(t="Unexpected state"){let e=`FIRESTORE (${cc}) INTERNAL ASSERTION FAILED: `+t;throw Ze(e),new Error(e)}function j(t,e){t||k()}function fR(t,e){t||k()}function N(t,e){return t}var y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},E=class extends Fb{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var dt=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var Hp=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},kx=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(ut.UNAUTHENTICATED))}shutdown(){}},Ox=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},Fx=class{constructor(e){this.t=e,this.currentUser=ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve(),s=new dt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new dt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>g(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{I("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(I("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new dt)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(I("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(j(typeof r.accessToken=="string"),new Hp(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return j(e===null||typeof e=="string"),new ut(e)}},Vx=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=ut.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Lx=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new Vx(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(ut.FIRST_PARTY))}shutdown(){}invalidateToken(){}},jx=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Bx=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&I("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,I("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{I("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):I("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(j(typeof n.token=="string"),this.R=n.token,new jx(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function $6(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var qp=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=$6(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function ne(t,e){return t<e?-1:t>e?1:0}function Ga(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function pR(t){return t+"\0"}var He=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new E(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new E(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new E(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new E(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ne(this.nanoseconds,e.nanoseconds):ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var $=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new He(0,0))}static max(){return new t(new He(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Gp=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&k(),r===void 0?r=e.length-n:r>e.length-n&&k(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},we=class t extends Gp{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new E(y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},H6=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Xe=class t extends Gp{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return H6.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new E(y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new E(y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new E(y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new E(y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var M=class t{constructor(e){this.path=e}static fromPath(e){return new t(we.fromString(e))}static fromName(e){return new t(we.fromString(e).popFirst(5))}static empty(){return new t(we.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&we.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return we.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new we(e.slice()))}};var za=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};function Ux(t){return t.fields.find(e=>e.kind===2)}function Gs(t){return t.fields.filter(e=>e.kind!==2)}za.UNKNOWN_ID=-1;var $a=class{constructor(e,n){this.fieldPath=e,this.kind=n}};var Au=class t{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new t(0,Vn.min())}};function gR(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=$.fromTimestamp(r===1e9?new He(n+1,0):new He(n,r));return new Vn(i,M.empty(),e)}function mR(t){return new Vn(t.readTime,t.key,-1)}var Vn=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t($.min(),M.empty(),-1)}static max(){return new t($.max(),M.empty(),-1)}};function PE(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=M.comparator(t.documentKey,e.documentKey),n!==0?n:ne(t.largestBatchId,e.largestBatchId))}var _R="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",zp=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Xi(t){return g(this,null,function*(){if(t.code!==y.FAILED_PRECONDITION||t.message!==_R)throw t;I("LocalStore","Unexpectedly lost primary lease")})}var _=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&k(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;n(e[l]).next(u=>{o[l]=u,++a,a===s&&r(o)},u=>i(u))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};var Wp=class t{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new dt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Zs(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=kE(r.target.error);this.V.reject(new Zs(e,i))}}static open(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(s){throw new Zs(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(I("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let n=this.transaction.objectStore(e);return new Hx(n)}},ri=class t{constructor(e,n,r){this.name=e,this.version=n,this.p=r,t.S(Uc())===12.2&&Ze("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return I("SimpleDb","Removing database:",e),zs(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Wd())return!1;if(t.C())return!0;let e=Uc(),n=t.S(e),r=0<n&&n<10,i=t.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,n){return e.store(n)}static S(e){let n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){let n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){return g(this,null,function*(){return this.db||(I("SimpleDb","Opening database:",this.name),this.db=yield new Promise((n,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;n(o)},i.onblocked=()=>{r(new Zs(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new E(y.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new E(y.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Zs(e,o))},i.onupgradeneeded=s=>{I("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.N(o,i.transaction,s.oldVersion,this.version).next(()=>{I("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.L&&(this.db.onversionchange=n=>this.L(n)),this.db})}B(e){this.L=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){return g(this,null,function*(){let s=n==="readonly",o=0;for(;;){++o;try{this.db=yield this.O(e);let a=Wp.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),_.reject(l))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&o<3;if(I("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}},$x=class{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return zs(this.k.delete())}},Zs=class extends E{constructor(e,n){super(y.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}};function Ji(t){return t.name==="IndexedDbTransactionError"}var Hx=class{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(I("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(I("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),zs(r)}add(e){return I("SimpleDb","ADD",this.store.name,e,e),zs(this.store.add(e))}get(e){return zs(this.store.get(e)).next(n=>(n===void 0&&(n=null),I("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return I("SimpleDb","DELETE",this.store.name,e),zs(this.store.delete(e))}count(){return I("SimpleDb","COUNT",this.store.name),zs(this.store.count())}W(e,n){let r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new _((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.G(s,(a,c)=>{o.push(c)}).next(()=>o)}}j(e,n){let r=this.store.getAll(e,n===null?void 0:n);return new _((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,n){I("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,n);r.J=!1;let i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,n){let r;n?r=e:(r={},n=e);let i=this.cursor(r);return this.G(i,n)}Z(e){let n=this.cursor({});return new _((r,i)=>{n.onerror=s=>{let o=kE(s.target.error);i(o)},n.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){let r=[];return new _((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new $x(a),l=n(a.primaryKey,a.value,c);if(l instanceof _){let u=l.catch(d=>(c.done(),_.reject(d)));r.push(u)}c.isDone?i():c.$===null?a.continue():a.continue(c.$)}}).next(()=>_.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){let r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}};function zs(t){return new _((e,n)=>{t.onsuccess=r=>{let i=r.target.result;e(i)},t.onerror=r=>{let i=kE(r.target.error);n(i)}})}var fN=!1;function kE(t){let e=ri.S(Uc());if(e>=12.2&&e<13){let n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){let r=new E("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return fN||(fN=!0,setTimeout(()=>{throw r},0)),r}}return t}var qx=class{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){I("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>g(this,null,function*(){this.task=null;try{I("IndexBackfiller",`Documents written: ${yield this.X.te()}`)}catch(n){Ji(n)?I("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):yield Xi(n)}yield this.ee(6e4)}))}},Gx=class{constructor(e,n){this.localStore=e,this.persistence=n}te(e=50){return g(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.ne(n,e))})}ne(e,n){let r=new Set,i=n,s=!0;return _.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return I("IndexBackfiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(I("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{let o=mR(s);PE(o,r)>0&&(r=o)}),new Vn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}};var vn=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function Zu(t){return t==null}function Mu(t){return t===0&&1/t==-1/0}function yR(t){return typeof t=="number"&&Number.isInteger(t)&&!Mu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Xt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=pN(e)),e=q6(t.get(n),e);return pN(e)}function q6(t,e){let n=e,r=t.length;for(let i=0;i<r;i++){let s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function pN(t){return t+""}function br(t){let e=t.length;if(j(e>=2),e===2)return j(t.charAt(0)===""&&t.charAt(1)===""),we.emptyPath();let n=e-2,r=[],i="";for(let s=0;s<e;){let o=t.indexOf("",s);switch((o<0||o>n)&&k(),t.charAt(o+1)){case"":let a=t.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:k()}s=o+2}return new we(r)}var gN=["userId","batchId"];function Vp(t,e){return[t,Xt(e)]}function vR(t,e,n){return[t,Xt(e),n]}var G6={},z6=["prefixPath","collectionGroup","readTime","documentId"],W6=["prefixPath","collectionGroup","documentId"],K6=["collectionGroup","readTime","prefixPath","documentId"],Q6=["canonicalId","targetId"],Y6=["targetId","path"],Z6=["path","targetId"],X6=["collectionId","parent"],J6=["indexId","uid"],e8=["uid","sequenceNumber"],t8=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],n8=["indexId","uid","orderedDocumentKey"],r8=["userId","collectionPath","documentId"],i8=["userId","collectionPath","largestBatchId"],s8=["userId","collectionGroup","largestBatchId"],xR=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],o8=[...xR,"documentOverlays"],wR=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],ER=wR,a8=[...ER,"indexConfiguration","indexState","indexEntries"];var Nu=class extends zp{constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}};function bt(t,e){let n=N(t);return ri.M(n.ae,e)}function mN(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function lo(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function CR(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var je=class t{constructor(e,n){this.comparator=e,this.root=n||Tr.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Tr.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Tr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ua(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ua(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ua(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ua(this.root,e,this.comparator,!0)}},Ua=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Tr=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw k();let e=this.left.check();if(e!==this.right.check())throw k();return e+(this.isRed()?0:1)}};Tr.EMPTY=null,Tr.RED=!0,Tr.BLACK=!1;Tr.EMPTY=new class{constructor(){this.size=0}get key(){throw k()}get value(){throw k()}get color(){throw k()}get left(){throw k()}get right(){throw k()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Tr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var ke=class t{constructor(e){this.comparator=e,this.data=new je(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Kp(this.data.getIterator())}getIteratorFrom(e){return new Kp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},Kp=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Ra(t){return t.hasNext()?t.getNext():void 0}var xn=class t{constructor(e){this.fields=e,e.sort(Xe.comparator)}static empty(){return new t([])}unionWith(e){let n=new ke(Xe.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ga(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var Qp=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function IR(){return typeof atob<"u"}var It=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Qp("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};It.EMPTY_BYTE_STRING=new It("");var c8=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Hi(t){if(j(!!t),typeof t=="string"){let e=0,n=c8.exec(t);if(j(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:We(t.seconds),nanos:We(t.nanos)}}function We(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function qi(t){return typeof t=="string"?It.fromBase64String(t):It.fromUint8Array(t)}function jg(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function OE(t){let e=t.mapValue.fields.__previous_value__;return jg(e)?OE(e):e}function Ru(t){let e=Hi(t.mapValue.fields.__local_write_time__.timestampValue);return new He(e.seconds,e.nanos)}var zx=class{constructor(e,n,r,i,s,o,a,c,l){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},Gi=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var Bi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Lp={nullValue:"NULL_VALUE"};function Xs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?jg(t)?4:bR(t)?9007199254740991:10:k()}function Mr(t,e){if(t===e)return!0;let n=Xs(t);if(n!==Xs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ru(t).isEqual(Ru(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Hi(i.timestampValue),a=Hi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return qi(i.bytesValue).isEqual(qi(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return We(i.geoPointValue.latitude)===We(s.geoPointValue.latitude)&&We(i.geoPointValue.longitude)===We(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return We(i.integerValue)===We(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=We(i.doubleValue),a=We(s.doubleValue);return o===a?Mu(o)===Mu(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Ga(t.arrayValue.values||[],e.arrayValue.values||[],Mr);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(mN(o)!==mN(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Mr(o[c],a[c])))return!1;return!0}(t,e);default:return k()}}function Pu(t,e){return(t.values||[]).find(n=>Mr(n,e))!==void 0}function zi(t,e){if(t===e)return 0;let n=Xs(t),r=Xs(e);if(n!==r)return ne(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ne(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=We(s.integerValue||s.doubleValue),c=We(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return _N(t.timestampValue,e.timestampValue);case 4:return _N(Ru(t),Ru(e));case 5:return ne(t.stringValue,e.stringValue);case 6:return function(s,o){let a=qi(s),c=qi(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){let u=ne(a[l],c[l]);if(u!==0)return u}return ne(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=ne(We(s.latitude),We(o.latitude));return a!==0?a:ne(We(s.longitude),We(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let l=0;l<a.length&&l<c.length;++l){let u=zi(a[l],c[l]);if(u)return u}return ne(a.length,c.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Bi.mapValue&&o===Bi.mapValue)return 0;if(s===Bi.mapValue)return 1;if(o===Bi.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),l=o.fields||{},u=Object.keys(l);c.sort(),u.sort();for(let d=0;d<c.length&&d<u.length;++d){let h=ne(c[d],u[d]);if(h!==0)return h;let f=zi(a[c[d]],l[u[d]]);if(f!==0)return f}return ne(c.length,u.length)}(t.mapValue,e.mapValue);default:throw k()}}function _N(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ne(t,e);let n=Hi(t),r=Hi(e),i=ne(n.seconds,r.seconds);return i!==0?i:ne(n.nanos,r.nanos)}function Wa(t){return Wx(t)}function Wx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=Hi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return qi(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return M.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=Wx(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${Wx(n.fields[o])}`;return i+"}"}(t.mapValue):k()}function Js(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Kx(t){return!!t&&"integerValue"in t}function ku(t){return!!t&&"arrayValue"in t}function yN(t){return!!t&&"nullValue"in t}function vN(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function jp(t){return!!t&&"mapValue"in t}function Iu(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return lo(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Iu(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Iu(t.arrayValue.values[n]);return e}return Object.assign({},t)}function bR(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function l8(t){return"nullValue"in t?Lp:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Js(Gi.empty(),M.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:k()}function u8(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Js(Gi.empty(),M.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Bi:k()}function xN(t,e){let n=zi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function wN(t,e){let n=zi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}var qt=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!jp(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Iu(n)}setAll(e){let n=Xe.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Iu(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());jp(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Mr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];jp(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){lo(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(Iu(this.value))}};function DR(t){let e=[];return lo(t.fields,(n,r)=>{let i=new Xe([n]);if(jp(r)){let s=DR(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new xn(e)}var ht=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,$.min(),$.min(),$.min(),qt.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,$.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,$.min(),$.min(),qt.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,$.min(),$.min(),qt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual($.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=qt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=qt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=$.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Nr=class{constructor(e,n){this.position=e,this.inclusive=n}};function EN(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=M.comparator(M.fromName(o.referenceValue),n.key):r=zi(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function CN(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Mr(t.position[n],e.position[n]))return!1;return!0}var eo=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function d8(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Yp=class{},me=class t extends Yp{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Zx(e,n,r):n==="array-contains"?new ew(e,r):n==="in"?new Zp(e,r):n==="not-in"?new tw(e,r):n==="array-contains-any"?new nw(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new Xx(e,r):new Jx(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(zi(n,this.value)):n!==null&&Xs(this.value)===Xs(n)&&this.matchesComparison(zi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return k()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ae=class t extends Yp{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new t(e,n)}matches(e){return Ka(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}};function Ka(t){return t.op==="and"}function Qx(t){return t.op==="or"}function FE(t){return TR(t)&&Ka(t)}function TR(t){for(let e of t.filters)if(e instanceof Ae)return!1;return!0}function Yx(t){if(t instanceof me)return t.field.canonicalString()+t.op.toString()+Wa(t.value);if(FE(t))return t.filters.map(e=>Yx(e)).join(",");{let e=t.filters.map(n=>Yx(n)).join(",");return`${t.op}(${e})`}}function SR(t,e){return t instanceof me?function(r,i){return i instanceof me&&r.op===i.op&&r.field.isEqual(i.field)&&Mr(r.value,i.value)}(t,e):t instanceof Ae?function(r,i){return i instanceof Ae&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&SR(o,i.filters[a]),!0):!1}(t,e):void k()}function AR(t,e){let n=t.filters.concat(e);return Ae.create(n,t.op)}function MR(t){return t instanceof me?function(n){return`${n.field.canonicalString()} ${n.op} ${Wa(n.value)}`}(t):t instanceof Ae?function(n){return n.op.toString()+" {"+n.getFilters().map(MR).join(" ,")+"}"}(t):"Filter"}var Zx=class extends me{constructor(e,n,r){super(e,n,r),this.key=M.fromName(r.referenceValue)}matches(e){let n=M.comparator(e.key,this.key);return this.matchesComparison(n)}},Xx=class extends me{constructor(e,n){super(e,"in",n),this.keys=NR("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},Jx=class extends me{constructor(e,n){super(e,"not-in",n),this.keys=NR("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function NR(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>M.fromName(r.referenceValue))}var ew=class extends me{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return ku(n)&&Pu(n.arrayValue,this.value)}},Zp=class extends me{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&Pu(this.value.arrayValue,n)}},tw=class extends me{constructor(e,n){super(e,"not-in",n)}matches(e){if(Pu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!Pu(this.value.arrayValue,n)}},nw=class extends me{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!ku(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Pu(this.value.arrayValue,r))}};var rw=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}};function iw(t,e=null,n=[],r=[],i=null,s=null,o=null){return new rw(t,e,n,r,i,s,o)}function to(t){let e=N(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Yx(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Zu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Wa(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Wa(r)).join(",")),e.ce=n}return e.ce}function Xu(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!d8(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!SR(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!CN(t.startAt,e.startAt)&&CN(t.endAt,e.endAt)}function Xp(t){return M.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Jp(t,e){return t.filters.filter(n=>n instanceof me&&n.field.isEqual(e))}function IN(t,e,n){let r=Lp,i=!0;for(let s of Jp(t,e)){let o=Lp,a=!0;switch(s.op){case"<":case"<=":o=l8(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Lp}xN({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];xN({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function bN(t,e,n){let r=Bi,i=!0;for(let s of Jp(t,e)){let o=Bi,a=!0;switch(s.op){case">=":case">":o=u8(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Bi}wN({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];wN({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}var tr=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}};function RR(t,e,n,r,i,s,o,a){return new tr(t,e,n,r,i,s,o,a)}function lc(t){return new tr(t)}function DN(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function VE(t){return t.collectionGroup!==null}function Ha(t){let e=N(t);if(e.le===null){e.le=[];let n=new Set;for(let s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new ke(Xe.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new eo(s,r))}),n.has(Xe.keyField().canonicalString())||e.le.push(new eo(Xe.keyField(),r))}return e.le}function Jt(t){let e=N(t);return e.he||(e.he=h8(e,Ha(t))),e.he}function h8(t,e){if(t.limitType==="F")return iw(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new eo(i.field,s)});let n=t.endAt?new Nr(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Nr(t.startAt.position,t.startAt.inclusive):null;return iw(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function sw(t,e){let n=t.filters.concat([e]);return new tr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function eg(t,e,n){return new tr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ju(t,e){return Xu(Jt(t),Jt(e))&&t.limitType===e.limitType}function PR(t){return`${to(Jt(t))}|lt:${t.limitType}`}function Va(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>MR(i)).join(", ")}]`),Zu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Wa(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Wa(i)).join(",")),`Target(${r})`}(Jt(t))}; limitType=${t.limitType})`}function ed(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):M.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of Ha(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let l=EN(o,a,c);return o.inclusive?l<=0:l<0}(r.startAt,Ha(r),i)||r.endAt&&!function(o,a,c){let l=EN(o,a,c);return o.inclusive?l>=0:l>0}(r.endAt,Ha(r),i))}(t,e)}function kR(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function OR(t){return(e,n)=>{let r=!1;for(let i of Ha(t)){let s=f8(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function f8(t,e,n){let r=t.field.isKeyField()?M.comparator(e.key,n.key):function(s,o,a){let c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?zi(c,l):k()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return k()}}var Rr=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){lo(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return CR(this.inner)}size(){return this.innerSize}};var p8=new je(M.comparator);function fn(){return p8}var FR=new je(M.comparator);function Eu(...t){let e=FR;for(let n of t)e=e.insert(n.key,n);return e}function VR(t){let e=FR;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Dr(){return bu()}function LR(){return bu()}function bu(){return new Rr(t=>t.toString(),(t,e)=>t.isEqual(e))}var g8=new je(M.comparator),m8=new ke(M.comparator);function ie(...t){let e=m8;for(let n of t)e=e.add(n);return e}var _8=new ke(ne);function LE(){return _8}function jR(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Mu(e)?"-0":e}}function BR(t){return{integerValue:""+t}}function UR(t,e){return yR(e)?BR(e):jR(t,e)}var Qa=class{constructor(){this._=void 0}};function y8(t,e,n){return t instanceof Wi?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&jg(s)&&(s=OE(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof ii?HR(t,e):t instanceof si?qR(t,e):function(i,s){let o=$R(i,s),a=TN(o)+TN(i.Ie);return Kx(o)&&Kx(i.Ie)?BR(a):jR(i.serializer,a)}(t,e)}function v8(t,e,n){return t instanceof ii?HR(t,e):t instanceof si?qR(t,e):n}function $R(t,e){return t instanceof Ki?function(r){return Kx(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Wi=class extends Qa{},ii=class extends Qa{constructor(e){super(),this.elements=e}};function HR(t,e){let n=GR(e);for(let r of t.elements)n.some(i=>Mr(i,r))||n.push(r);return{arrayValue:{values:n}}}var si=class extends Qa{constructor(e){super(),this.elements=e}};function qR(t,e){let n=GR(e);for(let r of t.elements)n=n.filter(i=>!Mr(i,r));return{arrayValue:{values:n}}}var Ki=class extends Qa{constructor(e,n){super(),this.serializer=e,this.Ie=n}};function TN(t){return We(t.integerValue||t.doubleValue)}function GR(t){return ku(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var no=class{constructor(e,n){this.field=e,this.transform=n}};function x8(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof ii&&i instanceof ii||r instanceof si&&i instanceof si?Ga(r.elements,i.elements,Mr):r instanceof Ki&&i instanceof Ki?Mr(r.Ie,i.Ie):r instanceof Wi&&i instanceof Wi}(t.transform,e.transform)}var ow=class{constructor(e,n){this.version=e,this.transformResults=n}},Ke=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Bp(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var Ya=class{};function zR(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Yi(t.key,Ke.none()):new Qi(t.key,t.data,Ke.none());{let n=t.data,r=qt.empty(),i=new ke(Xe.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new nr(t.key,r,new xn(i.toArray()),Ke.none())}}function w8(t,e,n){t instanceof Qi?function(i,s,o){let a=i.value.clone(),c=AN(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof nr?function(i,s,o){if(!Bp(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=AN(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(WR(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Du(t,e,n,r){return t instanceof Qi?function(s,o,a,c){if(!Bp(s.precondition,o))return a;let l=s.value.clone(),u=MN(s.fieldTransforms,c,o);return l.setAll(u),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(t,e,n,r):t instanceof nr?function(s,o,a,c){if(!Bp(s.precondition,o))return a;let l=MN(s.fieldTransforms,c,o),u=o.data;return u.setAll(WR(s)),u.setAll(l),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,o,a){return Bp(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function E8(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=$R(r.transform,i||null);s!=null&&(n===null&&(n=qt.empty()),n.set(r.field,s))}return n||null}function SN(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ga(r,i,(s,o)=>x8(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var Qi=class extends Ya{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},nr=class extends Ya{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function WR(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function AN(t,e,n){let r=new Map;j(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,v8(o,a,n[i]))}return r}function MN(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,y8(s,o,e))}return r}var Yi=class extends Ya{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Ou=class extends Ya{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Fu=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&w8(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=Du(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=Du(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=LR();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let c=zR(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument($.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ie())}isEqual(e){return this.batchId===e.batchId&&Ga(this.mutations,e.mutations,(n,r)=>SN(n,r))&&Ga(this.baseMutations,e.baseMutations,(n,r)=>SN(n,r))}},aw=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){j(e.mutations.length===r.length);let i=function(){return g8}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var Vu=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var cw=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var ct,xe;function KR(t){switch(t){default:return k();case y.CANCELLED:case y.UNKNOWN:case y.DEADLINE_EXCEEDED:case y.RESOURCE_EXHAUSTED:case y.INTERNAL:case y.UNAVAILABLE:case y.UNAUTHENTICATED:return!1;case y.INVALID_ARGUMENT:case y.NOT_FOUND:case y.ALREADY_EXISTS:case y.PERMISSION_DENIED:case y.FAILED_PRECONDITION:case y.ABORTED:case y.OUT_OF_RANGE:case y.UNIMPLEMENTED:case y.DATA_LOSS:return!0}}function QR(t){if(t===void 0)return Ze("GRPC error has no .code"),y.UNKNOWN;switch(t){case ct.OK:return y.OK;case ct.CANCELLED:return y.CANCELLED;case ct.UNKNOWN:return y.UNKNOWN;case ct.DEADLINE_EXCEEDED:return y.DEADLINE_EXCEEDED;case ct.RESOURCE_EXHAUSTED:return y.RESOURCE_EXHAUSTED;case ct.INTERNAL:return y.INTERNAL;case ct.UNAVAILABLE:return y.UNAVAILABLE;case ct.UNAUTHENTICATED:return y.UNAUTHENTICATED;case ct.INVALID_ARGUMENT:return y.INVALID_ARGUMENT;case ct.NOT_FOUND:return y.NOT_FOUND;case ct.ALREADY_EXISTS:return y.ALREADY_EXISTS;case ct.PERMISSION_DENIED:return y.PERMISSION_DENIED;case ct.FAILED_PRECONDITION:return y.FAILED_PRECONDITION;case ct.ABORTED:return y.ABORTED;case ct.OUT_OF_RANGE:return y.OUT_OF_RANGE;case ct.UNIMPLEMENTED:return y.UNIMPLEMENTED;case ct.DATA_LOSS:return y.DATA_LOSS;default:return k()}}(xe=ct||(ct={}))[xe.OK=0]="OK",xe[xe.CANCELLED=1]="CANCELLED",xe[xe.UNKNOWN=2]="UNKNOWN",xe[xe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",xe[xe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",xe[xe.NOT_FOUND=5]="NOT_FOUND",xe[xe.ALREADY_EXISTS=6]="ALREADY_EXISTS",xe[xe.PERMISSION_DENIED=7]="PERMISSION_DENIED",xe[xe.UNAUTHENTICATED=16]="UNAUTHENTICATED",xe[xe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",xe[xe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",xe[xe.ABORTED=10]="ABORTED",xe[xe.OUT_OF_RANGE=11]="OUT_OF_RANGE",xe[xe.UNIMPLEMENTED=12]="UNIMPLEMENTED",xe[xe.INTERNAL=13]="INTERNAL",xe[xe.UNAVAILABLE=14]="UNAVAILABLE",xe[xe.DATA_LOSS=15]="DATA_LOSS";var NN=null;function YR(){return new TextEncoder}var C8=new Hs([4294967295,4294967295],0);function RN(t){let e=YR().encode(t),n=new dN;return n.update(e),new Uint8Array(n.digest())}function PN(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Hs([n,r],0),new Hs([i,s],0)]}var lw=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ys(`Invalid padding: ${n}`);if(r<0)throw new Ys(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ys(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ys(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=Hs.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(Hs.fromNumber(r)));return i.compare(C8)===1&&(i=new Hs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let n=RN(e),[r,i]=PN(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;let n=RN(e),[r,i]=PN(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);this.Re(o)}}Re(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},Ys=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Lu=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,ju.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t($.min(),i,new je(ne),fn(),ie())}},ju=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,ie(),ie(),ie())}};var qa=class{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}},tg=class{constructor(e,n){this.targetId=e,this.fe=n}},ng=class{constructor(e,n,r=It.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},rg=class{constructor(){this.ge=0,this.pe=ON(),this.ye=It.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=ie(),n=ie(),r=ie();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:k()}}),new ju(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=ON()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,j(this.ge>=0)}Le(){this.Se=!0,this.we=!0}},uw=class{constructor(e){this.Be=e,this.ke=new Map,this.qe=fn(),this.Qe=kN(),this.Ke=new je(ne)}$e(e){for(let n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(let n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{let r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Le(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:k()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){let n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){let s=i.target;if(Xp(s))if(r===0){let o=new M(s.path);this.We(n,o,ht.newNoDocument(o,$.min()))}else j(r===1);else{let o=this.Ze(n);if(o!==r){let a=this.Xe(e),c=a?this.et(a,e,o):1;if(c!==0){this.He(n);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,l)}NN?.tt(function(u,d,h,f,p){var m,v,b,F,S,q;let K={localCacheCount:u,existenceFilterCount:d.count,databaseId:h.database,projectId:h.projectId},X=d.unchangedNames;return X&&(K.bloomFilter={applied:p===0,hashCount:(m=X?.hashCount)!==null&&m!==void 0?m:0,bitmapLength:(F=(b=(v=X?.bits)===null||v===void 0?void 0:v.bitmap)===null||b===void 0?void 0:b.length)!==null&&F!==void 0?F:0,padding:(q=(S=X?.bits)===null||S===void 0?void 0:S.padding)!==null&&q!==void 0?q:0,mightContain:Me=>{var sn;return(sn=f?.mightContain(Me))!==null&&sn!==void 0&&sn}}),K}(o,e.fe,this.Be.nt(),a,c))}}}}Xe(e){let n=e.fe.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=qi(r).toUint8Array()}catch(c){if(c instanceof Qp)return Fn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new lw(o,i,s)}catch(c){return Fn(c instanceof Ys?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Te===0?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){let r=this.Be.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Be.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){let n=new Map;this.ke.forEach((s,o)=>{let a=this.Ye(o);if(a){if(s.current&&Xp(a.target)){let c=new M(a.target.path);this.qe.get(c)!==null||this.st(o,c)||this.We(o,c,ht.newNoDocument(c,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=ie();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.Ye(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));let i=new Lu(e,n,this.Ke,this.qe,r);return this.qe=fn(),this.Qe=kN(),this.Ke=new je(ne),i}Ue(e,n){if(!this.je(e))return;let r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;let i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){let n=this.ze(e).ve();return this.Be.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new rg,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new ke(ne),this.Qe=this.Qe.insert(e,n)),n}je(e){let n=this.Ye(e)!==null;return n||I("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){let n=this.ke.get(e);return n&&n.be?null:this.Be._t(e)}He(e){this.ke.set(e,new rg),this.Be.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Be.getRemoteKeysForTarget(e).has(n)}};function kN(){return new je(M.comparator)}function ON(){return new je(M.comparator)}var I8={asc:"ASCENDING",desc:"DESCENDING"},b8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},D8={and:"AND",or:"OR"},dw=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function hw(t,e){return t.useProto3Json||Zu(e)?e:{value:e}}function Za(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ZR(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function T8(t,e){return Za(t,e.toTimestamp())}function Je(t){return j(!!t),$.fromTimestamp(function(n){let r=Hi(n);return new He(r.seconds,r.nanos)}(t))}function jE(t,e){return fw(t,e).canonicalString()}function fw(t,e){let n=function(i){return new we(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function XR(t){let e=we.fromString(t);return j(cP(e)),e}function Bu(t,e){return jE(t.databaseId,e.path)}function Sr(t,e){let n=XR(e);if(n.get(1)!==t.databaseId.projectId)throw new E(y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new E(y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new M(tP(n))}function JR(t,e){return jE(t.databaseId,e)}function eP(t){let e=XR(t);return e.length===4?we.emptyPath():tP(e)}function pw(t){return new we(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function tP(t){return j(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function FN(t,e,n){return{name:Bu(t,e),fields:n.value.mapValue.fields}}function nP(t,e,n){let r=Sr(t,e.name),i=Je(e.updateTime),s=e.createTime?Je(e.createTime):$.min(),o=new qt({mapValue:{fields:e.fields}}),a=ht.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function S8(t,e){return"found"in e?function(r,i){j(!!i.found),i.found.name,i.found.updateTime;let s=Sr(r,i.found.name),o=Je(i.found.updateTime),a=i.found.createTime?Je(i.found.createTime):$.min(),c=new qt({mapValue:{fields:i.found.fields}});return ht.newFoundDocument(s,o,a,c)}(t,e):"missing"in e?function(r,i){j(!!i.missing),j(!!i.readTime);let s=Sr(r,i.missing),o=Je(i.readTime);return ht.newNoDocument(s,o)}(t,e):k()}function A8(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:k()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,u){return l.useProto3Json?(j(u===void 0||typeof u=="string"),It.fromBase64String(u||"")):(j(u===void 0||u instanceof Uint8Array),It.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){let u=l.code===void 0?y.UNKNOWN:QR(l.code);return new E(u,l.message||"")}(o);n=new ng(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Sr(t,r.document.name),s=Je(r.document.updateTime),o=r.document.createTime?Je(r.document.createTime):$.min(),a=new qt({mapValue:{fields:r.document.fields}}),c=ht.newFoundDocument(i,s,o,a),l=r.targetIds||[],u=r.removedTargetIds||[];n=new qa(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Sr(t,r.document),s=r.readTime?Je(r.readTime):$.min(),o=ht.newNoDocument(i,s),a=r.removedTargetIds||[];n=new qa([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Sr(t,r.document),s=r.removedTargetIds||[];n=new qa([],s,i,null)}else{if(!("filter"in e))return k();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new cw(i,s),a=r.targetId;n=new tg(a,o)}}return n}function Uu(t,e){let n;if(e instanceof Qi)n={update:FN(t,e.key,e.value)};else if(e instanceof Yi)n={delete:Bu(t,e.key)};else if(e instanceof nr)n={update:FN(t,e.key,e.data),updateMask:O8(e.fieldMask)};else{if(!(e instanceof Ou))return k();n={verify:Bu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Wi)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ii)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof si)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ki)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw k()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:T8(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:k()}(t,e.precondition)),n}function gw(t,e){let n=e.currentDocument?function(s){return s.updateTime!==void 0?Ke.updateTime(Je(s.updateTime)):s.exists!==void 0?Ke.exists(s.exists):Ke.none()}(e.currentDocument):Ke.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)j(a.setToServerValue==="REQUEST_TIME"),c=new Wi;else if("appendMissingElements"in a){let u=a.appendMissingElements.values||[];c=new ii(u)}else if("removeAllFromArray"in a){let u=a.removeAllFromArray.values||[];c=new si(u)}else"increment"in a?c=new Ki(o,a.increment):k();let l=Xe.fromServerFormat(a.fieldPath);return new no(l,c)}(t,i)):[];if(e.update){e.update.name;let i=Sr(t,e.update.name),s=new qt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let l=c.fieldPaths||[];return new xn(l.map(u=>Xe.fromServerFormat(u)))}(e.updateMask);return new nr(i,s,o,n,r)}return new Qi(i,s,n,r)}if(e.delete){let i=Sr(t,e.delete);return new Yi(i,n)}if(e.verify){let i=Sr(t,e.verify);return new Ou(i,n)}return k()}function M8(t,e){return t&&t.length>0?(j(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?Je(i.updateTime):Je(s);return o.isEqual($.min())&&(o=Je(s)),new ow(o,i.transformResults||[])}(n,e))):[]}function rP(t,e){return{documents:[JR(t,e.path)]}}function iP(t,e){let n={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=JR(t,i);let s=function(l){if(l.length!==0)return aP(Ae.create(l,"and"))}(e.filters);s&&(n.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(u=>function(h){return{field:La(h.field),direction:R8(h.dir)}}(u))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);let a=hw(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{ut:n,parent:i}}function sP(t){let e=eP(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){j(r===1);let u=n.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];n.where&&(s=function(d){let h=oP(d);return h instanceof Ae&&FE(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(h=>function(p){return new eo(ja(p.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,Zu(h)?null:h}(n.limit));let c=null;n.startAt&&(c=function(d){let h=!!d.before,f=d.values||[];return new Nr(f,h)}(n.startAt));let l=null;return n.endAt&&(l=function(d){let h=!d.before,f=d.values||[];return new Nr(f,h)}(n.endAt)),RR(e,i,o,s,a,"F",c,l)}function N8(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return k()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function oP(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=ja(n.unaryFilter.field);return me.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=ja(n.unaryFilter.field);return me.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=ja(n.unaryFilter.field);return me.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=ja(n.unaryFilter.field);return me.create(o,"!=",{nullValue:"NULL_VALUE"});default:return k()}}(t):t.fieldFilter!==void 0?function(n){return me.create(ja(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return k()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ae.create(n.compositeFilter.filters.map(r=>oP(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return k()}}(n.compositeFilter.op))}(t):k()}function R8(t){return I8[t]}function P8(t){return b8[t]}function k8(t){return D8[t]}function La(t){return{fieldPath:t.canonicalString()}}function ja(t){return Xe.fromServerFormat(t.fieldPath)}function aP(t){return t instanceof me?function(n){if(n.op==="=="){if(vN(n.value))return{unaryFilter:{field:La(n.field),op:"IS_NAN"}};if(yN(n.value))return{unaryFilter:{field:La(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(vN(n.value))return{unaryFilter:{field:La(n.field),op:"IS_NOT_NAN"}};if(yN(n.value))return{unaryFilter:{field:La(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:La(n.field),op:P8(n.op),value:n.value}}}(t):t instanceof Ae?function(n){let r=n.getFilters().map(i=>aP(i));return r.length===1?r[0]:{compositeFilter:{op:k8(n.op),filters:r}}}(t):k()}function O8(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function cP(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var Xa=class t{constructor(e,n,r,i,s=$.min(),o=$.min(),a=It.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var ig=class{constructor(e){this.ct=e}};function F8(t,e){let n;if(e.document)n=nP(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=M.fromSegments(e.noDocument.path),i=io(e.noDocument.readTime);n=ht.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return k();{let r=M.fromSegments(e.unknownDocument.path),i=io(e.unknownDocument.version);n=ht.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){let s=new He(i[0],i[1]);return $.fromTimestamp(s)}(e.readTime)),n}function VN(t,e){let n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:sg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Bu(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Za(s,o.version.toTimestamp()),createTime:Za(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ro(e.version)};else{if(!e.isUnknownDocument())return k();r.unknownDocument={path:n.path.toArray(),version:ro(e.version)}}return r}function sg(t){let e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ro(t){let e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function io(t){let e=new He(t.seconds,t.nanoseconds);return $.fromTimestamp(e)}function Ws(t,e){let n=(e.baseMutations||[]).map(s=>gw(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>gw(t.ct,s)),i=He.fromMillis(e.localWriteTimeMs);return new Fu(e.batchId,i,n,r)}function Cu(t){let e=io(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?io(t.lastLimboFreeSnapshotVersion):$.min(),r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return j(s.documents.length===1),Jt(lc(eP(s.documents[0])))}(t.query):function(s){return Jt(sP(s))}(t.query),new Xa(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,It.fromBase64String(t.resumeToken))}function lP(t,e){let n=ro(e.snapshotVersion),r=ro(e.lastLimboFreeSnapshotVersion),i;i=Xp(e.target)?rP(t.ct,e.target):iP(t.ct,e.target).ut;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:to(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function BE(t){let e=sP({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?eg(e,e.limit,"L"):e}function Mx(t,e){return new Vu(e.largestBatchId,gw(t.ct,e.overlayMutation))}function LN(t,e){let n=e.path.lastSegment();return[t,Xt(e.path.popLast()),n]}function jN(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:ro(r.readTime),documentKey:Xt(r.documentKey.path),largestBatchId:r.largestBatchId}}var mw=class{getBundleMetadata(e,n){return BN(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:io(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return BN(e).put(function(i){return{bundleId:i.id,createTime:ro(Je(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return UN(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:BE(s.bundledQuery),readTime:io(s.readTime)}}(r)})}saveNamedQuery(e,n){return UN(e).put(function(i){return{name:i.name,readTime:ro(Je(i.readTime)),bundledQuery:i.bundledQuery}}(n))}};function BN(t){return bt(t,"bundles")}function UN(t){return bt(t,"namedQueries")}var og=class t{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){let r=n.uid||"";return new t(e,r)}getOverlay(e,n){return yu(e).get(LN(this.userId,n)).next(r=>r?Mx(this.serializer,r):null)}getOverlays(e,n){let r=Dr();return _.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){let i=[];return r.forEach((s,o)=>{let a=new Vu(n,o);i.push(this.ht(e,a))}),_.waitFor(i)}removeOverlaysForBatchId(e,n,r){let i=new Set;n.forEach(o=>i.add(Xt(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(yu(e).H("collectionPathOverlayIndex",a))}),_.waitFor(s)}getOverlaysForCollection(e,n,r){let i=Dr(),s=Xt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return yu(e).W("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let l=Mx(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,n,r,i){let s=Dr(),o,a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return yu(e).Y({index:"collectionGroupOverlayIndex",range:a},(c,l,u)=>{let d=Mx(this.serializer,l);s.size()<i||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):u.done()}).next(()=>s)}ht(e,n){return yu(e).put(function(i,s,o){let[a,c,l]=LN(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Uu(i.ct,o.mutation)}}(this.serializer,this.userId,n))}};function yu(t){return bt(t,"documentOverlays")}var ti=class{constructor(){}Pt(e,n){this.It(e,n),n.Tt()}It(e,n){if("nullValue"in e)this.Et(n,5);else if("booleanValue"in e)this.Et(n,10),n.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(n,15),n.dt(We(e.integerValue));else if("doubleValue"in e){let r=We(e.doubleValue);isNaN(r)?this.Et(n,13):(this.Et(n,15),Mu(r)?n.dt(0):n.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(n,20),typeof r=="string"?n.At(r):(n.At(`${r.seconds||""}`),n.dt(r.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,n),this.Vt(n);else if("bytesValue"in e)this.Et(n,30),n.ft(qi(e.bytesValue)),this.Vt(n);else if("referenceValue"in e)this.gt(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(n,45),n.dt(r.latitude||0),n.dt(r.longitude||0)}else"mapValue"in e?bR(e)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,n),this.Vt(n)):"arrayValue"in e?(this.wt(e.arrayValue,n),this.Vt(n)):k()}Rt(e,n){this.Et(n,25),this.St(e,n)}St(e,n){n.At(e)}yt(e,n){let r=e.fields||{};this.Et(n,55);for(let i of Object.keys(r))this.Rt(i,n),this.It(r[i],n)}wt(e,n){let r=e.values||[];this.Et(n,50);for(let i of r)this.It(i,n)}gt(e,n){this.Et(n,37),M.fromName(e).path.forEach(r=>{this.Et(n,60),this.St(r,n)})}Et(e,n){e.dt(n)}Vt(e){e.dt(2)}};ti.bt=new ti;function V8(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function $N(t){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=V8(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}var _w=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Ct(r.value),r=n.next();this.vt()}Ft(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Mt(r.value),r=n.next();this.xt()}Ot(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=n.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=n.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Lt(e){let n=this.Bt(e),r=$N(n);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}qt(e){let n=this.Bt(e),r=$N(n);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){let n=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ct(e){let n=255&e;n===0?(this.Kt(0),this.Kt(255)):n===255?(this.Kt(255),this.Kt(0)):this.Kt(n)}Mt(e){let n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},yw=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}},vw=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},Ks=class{constructor(){this.Gt=new _w,this.zt=new yw(this.Gt),this.jt=new vw(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var Qs=class t{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}};function Fi(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=HN(t.arrayValue,e.arrayValue),n!==0?n:(n=HN(t.directionalValue,e.directionalValue),n!==0?n:M.comparator(t.documentKey,e.documentKey)))}function HN(t,e){for(let n=0;n<t.length&&n<e.length;++n){let r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}var ag=class{constructor(e){this.Yt=new ke((n,r)=>Xe.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let n of e.filters){let r=n;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(j(e.collectionGroup===this.collectionId),this.en)return!1;let n=Ux(e);if(n!==void 0&&!this.nn(n))return!1;let r=Gs(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.rn(a,c)||!this.sn(this.Zt[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new ke(Xe.comparator),n=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new $a(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new $a(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new $a(r.field,r.dir==="asc"?0:1)));return new za(za.UNKNOWN_ID,this.collectionId,n,Au.empty())}nn(e){for(let n of this.Xt)if(this.rn(n,e))return!0;return!1}rn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}sn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}};function uP(t){var e,n;if(j(t instanceof me||t instanceof Ae),t instanceof me){if(t instanceof Zp){let i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>me.create(t.field,"==",s)))||[];return Ae.create(i,"or")}return t}let r=t.filters.map(i=>uP(i));return Ae.create(r,t.op)}function L8(t){if(t.getFilters().length===0)return[];let e=Ew(uP(t));return j(dP(e)),xw(e)||ww(e)?[e]:e.getFilters()}function xw(t){return t instanceof me}function ww(t){return t instanceof Ae&&FE(t)}function dP(t){return xw(t)||ww(t)||function(n){if(n instanceof Ae&&Qx(n)){for(let r of n.getFilters())if(!xw(r)&&!ww(r))return!1;return!0}return!1}(t)}function Ew(t){if(j(t instanceof me||t instanceof Ae),t instanceof me)return t;if(t.filters.length===1)return Ew(t.filters[0]);let e=t.filters.map(r=>Ew(r)),n=Ae.create(e,t.op);return n=cg(n),dP(n)?n:(j(n instanceof Ae),j(Ka(n)),j(n.filters.length>1),n.filters.reduce((r,i)=>UE(r,i)))}function UE(t,e){let n;return j(t instanceof me||t instanceof Ae),j(e instanceof me||e instanceof Ae),n=t instanceof me?e instanceof me?function(i,s){return Ae.create([i,s],"and")}(t,e):qN(t,e):e instanceof me?qN(e,t):function(i,s){if(j(i.filters.length>0&&s.filters.length>0),Ka(i)&&Ka(s))return AR(i,s.getFilters());let o=Qx(i)?i:s,a=Qx(i)?s:i,c=o.filters.map(l=>UE(l,a));return Ae.create(c,"or")}(t,e),cg(n)}function qN(t,e){if(Ka(e))return AR(e,t.getFilters());{let n=e.filters.map(r=>UE(t,r));return Ae.create(n,"or")}}function cg(t){if(j(t instanceof me||t instanceof Ae),t instanceof me)return t;let e=t.getFilters();if(e.length===1)return cg(e[0]);if(TR(t))return t;let n=e.map(i=>cg(i)),r=[];return n.forEach(i=>{i instanceof me?r.push(i):i instanceof Ae&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Ae.create(r,t.op)}var Cw=class{constructor(){this._n=new $u}addToCollectionParentIndex(e,n){return this._n.add(n),_.resolve()}getCollectionParents(e,n){return _.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return _.resolve()}deleteFieldIndex(e,n){return _.resolve()}deleteAllFieldIndexes(e){return _.resolve()}createTargetIndexes(e,n){return _.resolve()}getDocumentsMatchingTarget(e,n){return _.resolve(null)}getIndexType(e,n){return _.resolve(0)}getFieldIndexes(e,n){return _.resolve([])}getNextCollectionGroupToUpdate(e){return _.resolve(null)}getMinOffset(e,n){return _.resolve(Vn.min())}getMinOffsetFromCollectionGroup(e,n){return _.resolve(Vn.min())}updateCollectionGroup(e,n,r){return _.resolve()}updateIndexEntries(e,n){return _.resolve()}},$u=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new ke(we.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new ke(we.comparator)).toArray()}};var Pp=new Uint8Array(0),Iw=class{constructor(e,n){this.databaseId=n,this.an=new $u,this.un=new Rr(r=>to(r),(r,i)=>Xu(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.an.has(n)){let r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.an.add(n)});let s={collectionId:r,parent:Xt(i)};return GN(e).put(s)}return _.resolve()}getCollectionParents(e,n){let r=[],i=IDBKeyRange.bound([n,""],[pR(n),""],!1,!0);return GN(e).W(i).next(s=>{for(let o of s){if(o.collectionId!==n)break;r.push(br(o.parent))}return r})}addFieldIndex(e,n){let r=vu(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete i.indexId;let s=r.add(i);if(n.indexState){let o=ka(e);return s.next(a=>{o.put(jN(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){let r=vu(e),i=ka(e),s=Pa(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let n=vu(e),r=Pa(e),i=ka(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return _.forEach(this.cn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new ag(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){let r=Pa(e),i=!0,s=new Map;return _.forEach(this.cn(n),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ie(),a=[];return _.forEach(s,(c,l)=>{I("IndexedDbIndexManager",`Using index ${function(S){return`id=${S.indexId}|cg=${S.collectionGroup}|f=${S.fields.map(q=>`${q.fieldPath}:${q.kind}`).join(",")}`}(c)} to execute ${to(n)}`);let u=function(S,q){let K=Ux(q);if(K===void 0)return null;for(let X of Jp(S,K.fieldPath))switch(X.op){case"array-contains-any":return X.value.arrayValue.values||[];case"array-contains":return[X.value]}return null}(l,c),d=function(S,q){let K=new Map;for(let X of Gs(q))for(let Me of Jp(S,X.fieldPath))switch(Me.op){case"==":case"in":K.set(X.fieldPath.canonicalString(),Me.value);break;case"not-in":case"!=":return K.set(X.fieldPath.canonicalString(),Me.value),Array.from(K.values())}return null}(l,c),h=function(S,q){let K=[],X=!0;for(let Me of Gs(q)){let sn=Me.kind===0?IN(S,Me.fieldPath,S.startAt):bN(S,Me.fieldPath,S.startAt);K.push(sn.value),X&&(X=sn.inclusive)}return new Nr(K,X)}(l,c),f=function(S,q){let K=[],X=!0;for(let Me of Gs(q)){let sn=Me.kind===0?bN(S,Me.fieldPath,S.endAt):IN(S,Me.fieldPath,S.endAt);K.push(sn.value),X&&(X=sn.inclusive)}return new Nr(K,X)}(l,c),p=this.hn(c,l,h),m=this.hn(c,l,f),v=this.Pn(c,l,d),b=this.In(c.indexId,u,p,h.inclusive,m,f.inclusive,v);return _.forEach(b,F=>r.j(F,n.limit).next(S=>{S.forEach(q=>{let K=M.fromSegments(q.documentKey);o.has(K)||(o=o.add(K),a.push(K))})}))}).next(()=>a)}return _.resolve(null)})}cn(e){let n=this.un.get(e);return n||(e.filters.length===0?n=[e]:n=L8(Ae.create(e.filters,"and")).map(r=>iw(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,n),n)}In(e,n,r,i,s,o,a){let c=(n!=null?n.length:1)*Math.max(r.length,s.length),l=c/(n!=null?n.length:1),u=[];for(let d=0;d<c;++d){let h=n?this.Tn(n[d/l]):Pp,f=this.En(e,h,r[d%l],i),p=this.dn(e,h,s[d%l],o),m=a.map(v=>this.En(e,h,v,!0));u.push(...this.createRange(f,p,m))}return u}En(e,n,r,i){let s=new Qs(e,M.empty(),n,r);return i?s:s.Jt()}dn(e,n,r,i){let s=new Qs(e,M.empty(),n,r);return i?s.Jt():s}ln(e,n){let r=new ag(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2,i=this.cn(n);return _.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let l=new ke(Xe.comparator),u=!1;for(let d of c.filters)for(let h of d.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?u=!0:l=l.add(h.field));for(let d of c.orderBy)d.field.isKeyField()||(l=l.add(d.field));return l.size+(u?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}An(e,n){let r=new Ks;for(let i of Gs(e)){let s=n.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);ti.bt.Pt(s,o)}return r.Wt()}Tn(e){let n=new Ks;return ti.bt.Pt(e,n.Ht(0)),n.Wt()}Rn(e,n){let r=new Ks;return ti.bt.Pt(Js(this.databaseId,n),r.Ht(function(s){let o=Gs(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,n,r){if(r===null)return[];let i=[];i.push(new Ks);let s=0;for(let o of Gs(e)){let a=r[s++];for(let c of i)if(this.Vn(n,o.fieldPath)&&ku(a))i=this.mn(i,o,a);else{let l=c.Ht(o.kind);ti.bt.Pt(a,l)}}return this.fn(i)}hn(e,n,r){return this.Pn(e,n,r.position)}fn(e){let n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Wt();return n}mn(e,n,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new Ks;c.seed(a.Wt()),ti.bt.Pt(o,c.Ht(n.kind)),s.push(c)}return s}Vn(e,n){return!!e.filters.find(r=>r instanceof me&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){let r=vu(e),i=ka(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{let o=[];return _.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(u,d){let h=d?new Au(d.sequenceNumber,new Vn(io(d.readTime),new M(br(d.documentKey)),d.largestBatchId)):Au.empty(),f=u.fields.map(([p,m])=>new $a(Xe.fromServerFormat(p),m));return new za(u.indexId,u.collectionGroup,f,h)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ne(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){let i=vu(e),s=ka(e);return this.gn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>_.forEach(a,c=>s.put(jN(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){let r=new Map;return _.forEach(n,(i,s)=>{let o=r.get(i.collectionGroup);return(o?_.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),_.forEach(a,c=>this.pn(e,i,c).next(l=>{let u=this.yn(s,c);return l.isEqual(u)?_.resolve():this.wn(e,s,c,l,u)}))))})}Sn(e,n,r,i){return Pa(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,n.key),documentKey:n.key.path.toArray()})}bn(e,n,r,i){return Pa(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,n.key),n.key.path.toArray()])}pn(e,n,r){let i=Pa(e),s=new ke(Fi);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,n)])},(o,a)=>{s=s.add(new Qs(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,n){let r=new ke(Fi),i=this.An(n,e);if(i==null)return r;let s=Ux(n);if(s!=null){let o=e.data.field(s.fieldPath);if(ku(o))for(let a of o.arrayValue.values||[])r=r.add(new Qs(n.indexId,e.key,this.Tn(a),i))}else r=r.add(new Qs(n.indexId,e.key,Pp,i));return r}wn(e,n,r,i,s){I("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);let o=[];return function(c,l,u,d,h){let f=c.getIterator(),p=l.getIterator(),m=Ra(f),v=Ra(p);for(;m||v;){let b=!1,F=!1;if(m&&v){let S=u(m,v);S<0?F=!0:S>0&&(b=!0)}else m!=null?F=!0:b=!0;b?(d(v),v=Ra(p)):F?(h(m),m=Ra(f)):(m=Ra(f),v=Ra(p))}}(i,s,Fi,a=>{o.push(this.Sn(e,n,r,a))},a=>{o.push(this.bn(e,n,r,a))}),_.waitFor(o)}gn(e){let n=1;return ka(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Fi(o,a)).filter((o,a,c)=>!a||Fi(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=Fi(o,e),c=Fi(o,n);if(a===0)i[0]=e.Jt();else if(a>0&&c<0)i.push(o),i.push(o.Jt());else if(c>0)break}i.push(n);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Pp,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Pp,[]];s.push(IDBKeyRange.bound(a,c))}return s}Dn(e,n){return Fi(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(zN)}getMinOffset(e,n){return _.mapArray(this.cn(n),r=>this.ln(e,r).next(i=>i||k())).next(zN)}};function GN(t){return bt(t,"collectionParents")}function Pa(t){return bt(t,"indexEntries")}function vu(t){return bt(t,"indexConfiguration")}function ka(t){return bt(t,"indexState")}function zN(t){j(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){let i=t[r].indexState.offset;PE(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Vn(e.readTime,e.documentKey,n)}var WN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},On=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function hP(t,e,n){let r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId),a=0,c=r.Y({range:o},(u,d,h)=>(a++,h.delete()));s.push(c.next(()=>{j(a===1)}));let l=[];for(let u of n.mutations){let d=vR(e,u.key.path,n.batchId);s.push(i.delete(d)),l.push(u.key)}return _.waitFor(s).next(()=>l)}function lg(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw k();e=t.noDocument}return JSON.stringify(e).length}On.DEFAULT_COLLECTION_PERCENTILE=10,On.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,On.DEFAULT=new On(41943040,On.DEFAULT_COLLECTION_PERCENTILE,On.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),On.DISABLED=new On(-1,0,0);var ug=class t{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,n,r,i){j(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new t(s,n,r,i)}checkEmpty(e){let n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Vi(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){let s=Ba(e),o=Vi(e);return o.add({}).next(a=>{j(typeof a=="number");let c=new Fu(a,n,r,i),l=function(f,p,m){let v=m.baseMutations.map(F=>Uu(f.ct,F)),b=m.mutations.map(F=>Uu(f.ct,F));return{userId:p,batchId:m.batchId,localWriteTimeMs:m.localWriteTime.toMillis(),baseMutations:v,mutations:b}}(this.serializer,this.userId,c),u=[],d=new ke((h,f)=>ne(h.canonicalString(),f.canonicalString()));for(let h of i){let f=vR(this.userId,h.key.path,a);d=d.add(h.key.path.popLast()),u.push(o.put(l)),u.push(s.put(f,G6))}return d.forEach(h=>{u.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Cn[a]=c.keys()}),_.waitFor(u).next(()=>c)})}lookupMutationBatch(e,n){return Vi(e).get(n).next(r=>r?(j(r.userId===this.userId),Ws(this.serializer,r)):null)}vn(e,n){return this.Cn[n]?_.resolve(this.Cn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){let i=r.keys();return this.Cn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return Vi(e).Y({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(j(a.batchId>=r),s=Ws(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Vi(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Vi(e).W("userMutationsIndex",n).next(r=>r.map(i=>Ws(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){let r=Vp(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Ba(e).Y({range:i},(o,a,c)=>{let[l,u,d]=o,h=br(u);if(l===this.userId&&n.path.isEqual(h))return Vi(e).get(d).next(f=>{if(!f)throw k();j(f.userId===this.userId),s.push(Ws(this.serializer,f))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ke(ne),i=[];return n.forEach(s=>{let o=Vp(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=Ba(e).Y({range:a},(l,u,d)=>{let[h,f,p]=l,m=br(f);h===this.userId&&s.path.isEqual(m)?r=r.add(p):d.done()});i.push(c)}),_.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=Vp(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new ke(ne);return Ba(e).Y({range:o},(c,l,u)=>{let[d,h,f]=c,p=br(h);d===this.userId&&r.isPrefixOf(p)?p.length===i&&(a=a.add(f)):u.done()}).next(()=>this.Fn(e,a))}Fn(e,n){let r=[],i=[];return n.forEach(s=>{i.push(Vi(e).get(s).next(o=>{if(o===null)throw k();j(o.userId===this.userId),r.push(Ws(this.serializer,o))}))}),_.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return hP(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Mn(n.batchId)}),_.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return _.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Ba(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=br(s[1]);i.push(c)}else a.done()}).next(()=>{j(i.length===0)})})}containsKey(e,n){return fP(e,this.userId,n)}xn(e){return pP(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function fP(t,e,n){let r=Vp(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return Ba(t).Y({range:s,J:!0},(a,c,l)=>{let[u,d,h]=a;u===e&&d===i&&(o=!0),l.done()}).next(()=>o)}function Vi(t){return bt(t,"mutations")}function Ba(t){return bt(t,"documentMutations")}function pP(t){return bt(t,"mutationQueues")}var Ja=class t{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new t(0)}static Ln(){return new t(-1)}};var bw=class{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Bn(e).next(n=>{let r=new Ja(n.highestTargetId);return n.highestTargetId=r.next(),this.kn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(n=>$.fromTimestamp(new He(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.kn(e,i)))}addTargetData(e,n){return this.qn(e,n).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.Qn(n,r),this.kn(e,r))))}updateTargetData(e,n){return this.qn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Oa(e).delete(n.targetId)).next(()=>this.Bn(e)).next(r=>(j(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,n,r){let i=0,s=[];return Oa(e).Y((o,a)=>{let c=Cu(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>_.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Oa(e).Y((r,i)=>{let s=Cu(i);n(s)})}Bn(e){return KN(e).get("targetGlobalKey").next(n=>(j(n!==null),n))}kn(e,n){return KN(e).put("targetGlobalKey",n)}qn(e,n){return Oa(e).put(lP(this.serializer,n))}Qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(n=>n.targetCount)}getTargetData(e,n){let r=to(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return Oa(e).Y({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let l=Cu(a);Xu(n,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,n,r){let i=[],s=Li(e);return n.forEach(o=>{let a=Xt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),_.waitFor(i)}removeMatchingKeys(e,n,r){let i=Li(e);return _.forEach(n,s=>{let o=Xt(s.path);return _.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){let r=Li(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){let r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Li(e),s=ie();return i.Y({range:r,J:!0},(o,a,c)=>{let l=br(o[1]),u=new M(l);s=s.add(u)}).next(()=>s)}containsKey(e,n){let r=Xt(n.path),i=IDBKeyRange.bound([r],[pR(r)],!1,!0),s=0;return Li(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}_t(e,n){return Oa(e).get(n).next(r=>r?Cu(r):null)}};function Oa(t){return bt(t,"targets")}function KN(t){return bt(t,"targetGlobal")}function Li(t){return bt(t,"targetDocuments")}function QN([t,e],[n,r]){let i=ne(t,n);return i===0?ne(e,r):i}var Dw=class{constructor(e){this.Kn=e,this.buffer=new ke(QN),this.$n=0}Un(){return++this.$n}Wn(e){let n=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();QN(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},Tw=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){I("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>g(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ji(n)?I("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield Xi(n)}yield this.zn(3e5)}))}},Sw=class{constructor(e,n){this.jn=e,this.params=n}calculateTargetCount(e,n){return this.jn.Hn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return _.resolve(vn._e);let r=new Dw(n);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(I("LruGarbageCollector","Garbage collection skipped; disabled"),_.resolve(WN)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(I("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),WN):this.Yn(e,n))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,n){let r,i,s,o,a,c,l,u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(I("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(l=Date.now(),Fa()<=Dn.DEBUG&&I("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${d} documents in `+(l-c)+`ms
Total Duration: ${l-u}ms`),_.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}};function j8(t,e){return new Sw(t,e)}var Aw=class{constructor(e,n){this.db=e,this.garbageCollector=j8(this,n)}Hn(e){let n=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Zn(e){let n=0;return this.Jn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Jn(e,n){return this.Xn(e,(r,i)=>n(i))}addReference(e,n,r){return kp(e,r)}removeReference(e,n,r){return kp(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return kp(e,n)}er(e,n){return function(i,s){let o=!1;return pP(i).Z(a=>fP(i,a,s).next(c=>(c&&(o=!0),_.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=n){let c=this.er(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,$.min()),Li(e).delete(function(d){return[0,Xt(d.path)]}(o))))});i.push(c)}}).next(()=>_.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return kp(e,n)}Xn(e,n){let r=Li(e),i,s=vn._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(s!==vn._e&&n(new M(br(i)),s),s=l,i=c):s=vn._e}).next(()=>{s!==vn._e&&n(new M(br(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function kp(t,e){return Li(t).put(function(r,i){return{targetId:0,path:Xt(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}var dg=class{constructor(){this.changes=new Rr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ht.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?_.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Mw=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return qs(e).put(r)}removeEntry(e,n,r){return qs(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],sg(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.tr(e,r)))}getEntry(e,n){let r=ht.newInvalidDocument(n);return qs(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(xu(n))},(i,s)=>{r=this.nr(n,s)}).next(()=>r)}rr(e,n){let r={size:0,document:ht.newInvalidDocument(n)};return qs(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(xu(n))},(i,s)=>{r={document:this.nr(n,s),size:lg(s)}}).next(()=>r)}getEntries(e,n){let r=fn();return this.ir(e,n,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,n){let r=fn(),i=new je(M.comparator);return this.ir(e,n,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,lg(o))}).next(()=>({documents:r,_r:i}))}ir(e,n,r){if(n.isEmpty())return _.resolve();let i=new ke(XN);n.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(xu(i.first()),xu(i.last())),o=i.getIterator(),a=o.getNext();return qs(e).Y({index:"documentKeyIndex",range:s},(c,l,u)=>{let d=M.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&XN(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?u.U(xu(a)):u.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){let o=n.path,a=[o.popLast().toArray(),o.lastSegment(),sg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return qs(e).W(IDBKeyRange.bound(a,c,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let u=fn();for(let d of l){let h=this.nr(M.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);h.isFoundDocument()&&(ed(n,h)||i.has(h.key))&&(u=u.insert(h.key,h))}return u})}getAllFromCollectionGroup(e,n,r,i){let s=fn(),o=ZN(n,r),a=ZN(n,Vn.max());return qs(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,u)=>{let d=this.nr(M.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(d.key,d),s.size===i&&u.done()}).next(()=>s)}newChangeBuffer(e){return new Nw(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return YN(e).get("remoteDocumentGlobalKey").next(n=>(j(!!n),n))}tr(e,n){return YN(e).put("remoteDocumentGlobalKey",n)}nr(e,n){if(n){let r=F8(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual($.min())))return r}return ht.newInvalidDocument(e)}};function gP(t){return new Mw(t)}var Nw=class extends dg{constructor(e,n){super(),this.ar=e,this.trackRemovals=n,this.ur=new Rr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let n=[],r=0,i=new ke((s,o)=>ne(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(n.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=VN(this.ar.serializer,o);i=i.add(s.path.popLast());let l=lg(c);r+=l-a.size,n.push(this.ar.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=VN(this.ar.serializer,o.convertToNoDocument($.min()));n.push(this.ar.addEntry(e,s,c))}}),i.forEach(s=>{n.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.ar.updateMetadata(e,r)),_.waitFor(n)}getFromCache(e,n){return this.ar.rr(e,n).next(r=>(this.ur.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.ar.sr(e,n).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function YN(t){return bt(t,"remoteDocumentGlobal")}function qs(t){return bt(t,"remoteDocumentsV14")}function xu(t){let e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function ZN(t,e){let n=e.documentKey.path.toArray();return[t,sg(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function XN(t,e){let n=t.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=ne(n[s],r[s]),i)return i;return i=ne(n.length,r.length),i||(i=ne(n[n.length-2],r[r.length-2]),i||ne(n[n.length-1],r[r.length-1]))}var Rw=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var hg=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Du(r.mutation,i,xn.empty(),He.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ie()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ie()){let i=Dr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Eu();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=Dr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ie()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=fn(),o=bu(),a=function(){return bu()}();return n.forEach((c,l)=>{let u=r.get(l.key);i.has(l.key)&&(u===void 0||u.mutation instanceof nr)?s=s.insert(l.key,l):u!==void 0?(o.set(l.key,u.mutation.getFieldMask()),Du(u.mutation,l,u.mutation.getFieldMask(),He.now())):o.set(l.key,xn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,u)=>o.set(l,u)),n.forEach((l,u)=>{var d;return a.set(l,new Rw(u,(d=o.get(l))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){let r=bu(),i=new je((o,a)=>o-a),s=ie();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=n.get(c);if(l===null)return;let u=r.get(c)||xn.empty();u=a.applyToLocalView(l,u),r.set(c,u);let d=(i.get(a.batchId)||ie()).add(c);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,u=c.value,d=LR();u.forEach(h=>{if(!s.has(h)){let f=zR(n.get(h),r.get(h));f!==null&&d.set(h,f),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,d))}return _.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return M.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):VE(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):_.resolve(Dr()),a=-1,c=s;return o.next(l=>_.forEach(l,(u,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(u)?_.resolve():this.remoteDocumentCache.getEntry(e,u).next(h=>{c=c.insert(u,h)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,ie())).next(u=>({batchId:a,changes:VR(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new M(n)).next(r=>{let i=Eu();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=Eu();return this.indexManager.getCollectionParents(e,s).next(a=>_.forEach(a,c=>{let l=function(d,h){return new tr(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(u=>{u.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((c,l)=>{let u=l.getKey();o.get(u)===null&&(o=o.insert(u,ht.newInvalidDocument(u)))});let a=Eu();return o.forEach((c,l)=>{let u=s.get(c);u!==void 0&&Du(u.mutation,l,xn.empty(),He.now()),ed(n,l)&&(a=a.insert(c,l))}),a})}};var Pw=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return _.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Je(i.createTime)}}(n)),_.resolve()}getNamedQuery(e,n){return _.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(i){return{name:i.name,query:BE(i.bundledQuery),readTime:Je(i.readTime)}}(n)),_.resolve()}};var kw=class{constructor(){this.overlays=new je(M.comparator),this.hr=new Map}getOverlay(e,n){return _.resolve(this.overlays.get(n))}getOverlays(e,n){let r=Dr();return _.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),_.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),_.resolve()}getOverlaysForCollection(e,n,r){let i=Dr(),s=n.length+1,o=new M(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return _.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new je((l,u)=>l-u),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let u=s.get(l.largestBatchId);u===null&&(u=Dr(),s=s.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}let a=Dr(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=i)););return _.resolve(a)}ht(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Vu(n,r));let s=this.hr.get(n);s===void 0&&(s=ie(),this.hr.set(n,s)),this.hr.set(n,s.add(r.key))}};var Hu=class{constructor(){this.Pr=new ke(lt.Ir),this.Tr=new ke(lt.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){let r=new lt(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new lt(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){let n=new M(new we([])),r=new lt(n,e),i=new lt(n,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let n=new M(new we([])),r=new lt(n,e),i=new lt(n,e+1),s=ie();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new lt(e,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},lt=class{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return M.comparator(e.key,n.key)||ne(e.pr,n.pr)}static Er(e,n){return ne(e.pr,n.pr)||M.comparator(e.key,n.key)}};var Ow=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new ke(lt.Ir)}checkEmpty(e){return _.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Fu(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new lt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return _.resolve(o)}lookupMutationBatch(e,n){return _.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.br(r),s=i<0?0:i;return _.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return _.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return _.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new lt(n,0),i=new lt(n,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),_.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ke(ne);return n.forEach(i=>{let s=new lt(i,0),o=new lt(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),_.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;M.isDocumentKey(s)||(s=s.child(""));let o=new lt(new M(s),0),a=new ke(ne);return this.wr.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.pr)),!0)},o),_.resolve(this.Dr(a))}Dr(e){let n=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){j(this.Cr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return _.forEach(n.mutations,i=>{let s=new lt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){let r=new lt(n,0),i=this.wr.firstAfterOrEqual(r);return _.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,_.resolve()}Cr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var Fw=class{constructor(e){this.vr=e,this.docs=function(){return new je(M.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return _.resolve(r?r.document.mutableCopy():ht.newInvalidDocument(n))}getEntries(e,n){let r=fn();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ht.newInvalidDocument(i))}),_.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=fn(),o=n.path,a=new M(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:u}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||PE(mR(u),r)<=0||(i.has(u.key)||ed(n,u))&&(s=s.insert(u.key,u.mutableCopy()))}return _.resolve(s)}getAllFromCollectionGroup(e,n,r,i){k()}Fr(e,n){return _.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Vw(this)}getSize(e){return _.resolve(this.size)}},Vw=class extends dg{constructor(e){super(),this.ar=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),_.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}};var Lw=class{constructor(e){this.persistence=e,this.Mr=new Rr(n=>to(n),Xu),this.lastRemoteSnapshotVersion=$.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Hu,this.targetCount=0,this.Lr=Ja.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,i)=>n(i)),_.resolve()}getLastRemoteSnapshotVersion(e){return _.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return _.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),_.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),_.resolve()}qn(e){this.Mr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Lr=new Ja(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,_.resolve()}updateTargetData(e,n){return this.qn(n),_.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,_.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),_.waitFor(s).next(()=>i)}getTargetCount(e){return _.resolve(this.targetCount)}getTargetData(e,n){let r=this.Mr.get(n)||null;return _.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),_.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),_.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),_.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Nr.gr(n);return _.resolve(r)}containsKey(e,n){return _.resolve(this.Nr.containsKey(n))}};var fg=class{constructor(e,n){this.Br={},this.overlays={},this.kr=new vn(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new Lw(this),this.indexManager=new Cw,this.remoteDocumentCache=function(i){return new Fw(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new ig(n),this.$r=new Pw(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new kw,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new Ow(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){I("MemoryPersistence","Starting transaction:",e);let i=new jw(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,n){return _.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}},jw=class extends zp{constructor(e){super(),this.currentSequenceNumber=e}},pg=class t{constructor(e){this.persistence=e,this.zr=new Hu,this.jr=null}static Hr(e){return new t(e)}get Jr(){if(this.jr)return this.jr;throw k()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),_.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),_.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),_.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return _.forEach(this.Jr,r=>{let i=M.fromPath(r);return this.Yr(e,i).next(s=>{s||n.removeEntry(i,$.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return _.or([()=>_.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}};var Bw=class{constructor(e){this.serializer=e}N(e,n,r,i){let s=new Wp("createOrUpgrade",n);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",gN,{unique:!0}),c.createObjectStore("documentMutations")}(e),JN(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=_.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),JN(e)),o=o.next(()=>function(c){let l=c.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:$.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",u)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,l){return l.store("mutations").W().next(u=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",gN,{unique:!0});let d=l.store("mutations"),h=u.map(f=>d.put(f));return _.waitFor(h)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let l=c.createObjectStore("documentOverlays",{keyPath:r8});l.createIndex("collectionPathOverlayIndex",i8,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",s8,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let l=c.createObjectStore("remoteDocumentsV14",{keyPath:z6});l.createIndex("documentKeyIndex",W6),l.createIndex("collectionGroupIndex",K6)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:J6}).createIndex("sequenceNumberIndex",e8,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:t8}).createIndex("documentKeyIndex",n8,{unique:!1})}(e))),o}ei(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=lg(i)}).next(()=>{let r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>_.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>_.forEach(a,c=>{j(c.userId===s.userId);let l=Ws(this.serializer,c);return hP(e,s.userId,l).next(()=>{})}))}))}ti(e){let n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.Y((o,a)=>{let c=new we(o),l=function(d){return[0,Xt(d)]}(c);s.push(n.get(l).next(u=>u?_.resolve():(d=>n.put({targetId:0,path:Xt(d),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>_.waitFor(s))})}ni(e,n){e.createObjectStore("collectionParents",{keyPath:X6});let r=n.store("collectionParents"),i=new $u,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:Xt(c)})}};return n.store("remoteDocuments").Y({J:!0},(o,a)=>{let c=new we(o);return s(c.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([o,a,c],l)=>{let u=br(a);return s(u.popLast())}))}ri(e){let n=e.store("targets");return n.Y((r,i)=>{let s=Cu(i),o=lP(this.serializer,s);return n.put(o)})}ii(e,n){let r=n.store("remoteDocuments"),i=[];return r.Y((s,o)=>{let a=n.store("remoteDocumentsV14"),c=function(d){return d.document?new M(we.fromString(d.document.name).popFirst(5)):d.noDocument?M.fromSegments(d.noDocument.path):d.unknownDocument?M.fromSegments(d.unknownDocument.path):k()}(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(l))}).next(()=>_.waitFor(i))}si(e,n){let r=n.store("mutations"),i=gP(this.serializer),s=new fg(pg.Hr,this.serializer.ct);return r.W().next(o=>{let a=new Map;return o.forEach(c=>{var l;let u=(l=a.get(c.userId))!==null&&l!==void 0?l:ie();Ws(this.serializer,c).keys().forEach(d=>u=u.add(d)),a.set(c.userId,u)}),_.forEach(a,(c,l)=>{let u=new ut(l),d=og.lt(this.serializer,u),h=s.getIndexManager(u),f=ug.lt(u,this.serializer,h,s.referenceDelegate);return new hg(i,f,d,h).recalculateAndSaveOverlaysForDocumentKeys(new Nu(n,vn._e),c).next()})})}};function JN(t){t.createObjectStore("targetDocuments",{keyPath:Y6}).createIndex("documentTargetsIndex",Z6,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Q6,{unique:!0}),t.createObjectStore("targetGlobal")}var Nx="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Uw=class t{constructor(e,n,r,i,s,o,a,c,l,u,d=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=l,this.ai=u,this.ui=d,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=h=>Promise.resolve(),!t.D())throw new E(y.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Aw(this,i),this.Ti=n+"main",this.serializer=new ig(c),this.Ei=new ri(this.Ti,this.ui,new Bw(this.serializer)),this.Qr=new bw(this.referenceDelegate,this.serializer),this.remoteDocumentCache=gP(this.serializer),this.$r=new mw,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,u===!1&&Ze("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new E(y.FAILED_PRECONDITION,Nx);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new vn(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=n=>g(this,null,function*(){if(this.started)return e(n)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.B(n=>g(this,null,function*(){n.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>g(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Op(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(n=>{n||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(n=>this.isPrimary&&!n?this.yi(e).next(()=>!1):!!n&&this.wi(e).next(()=>!0))).catch(e=>{if(Ji(e))return I("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return I("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return wu(e).get("owner").next(n=>_.resolve(this.Si(n)))}bi(e){return Op(e).delete(this.clientId)}Di(){return g(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{let r=bt(n,"clientMetadata");return r.W().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return _.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let n of e)this.di.removeItem(this.Fi(n.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?_.resolve(!0):wu(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)){if(this.Si(n)&&this.networkEnabled)return!0;if(!this.Si(n)){if(!n.allowTabSynchronization)throw new E(y.FAILED_PRECONDITION,Nx);return!1}}return!(!this.networkEnabled||!this.inForeground)||Op(e).W().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&I("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return g(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let n=new Nu(e,vn._e);return this.yi(n).next(()=>this.bi(n))}),this.Ei.close(),this.Li()})}vi(e,n){return e.filter(r=>this.Ci(r.updateTimeMs,n)&&!this.Mi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>Op(e).W().next(n=>this.vi(n,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,n){return ug.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Iw(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return og.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,n,r){I("IndexedDbPersistence","Starting transaction:",e);let i=n==="readonly"?"readonly":"readwrite",s=function(c){return c===15?a8:c===14?ER:c===13?wR:c===12?o8:c===11?xR:void k()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new Nu(a,this.kr?this.kr.next():vn._e),n==="readwrite-primary"?this.gi(o).next(c=>!!c||this.pi(o)).next(c=>{if(!c)throw Ze(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new E(y.FAILED_PRECONDITION,_R);return r(o)}).next(c=>this.wi(o).next(()=>c)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return wu(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)&&!this.Si(n)&&!(this.ai||this.allowTabSynchronization&&n.allowTabSynchronization))throw new E(y.FAILED_PRECONDITION,Nx)})}wi(e){let n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return wu(e).put("owner",n)}static D(){return ri.D()}yi(e){let n=wu(e);return n.get("owner").next(r=>this.Si(r)?(I("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):_.resolve())}Ci(e,n){let r=Date.now();return!(e<r-n)&&(!(e>r)||(Ze(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let n=/(?:Version|Mobile)\/1[456]/;s_()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var n;try{let r=((n=this.di)===null||n===void 0?void 0:n.getItem(this.Fi(e)))!==null;return I("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ze("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){Ze("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function wu(t){return bt(t,"owner")}function Op(t){return bt(t,"clientMetadata")}function $E(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var $w=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=i}static Ki(e,n){let r=ie(),i=ie();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var Hw=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var gg=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return s_()?8:ri.v(Uc())>0?6:4}()}initialize(e,n){this.zi=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.ji(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new Hw;return this.Ji(e,n,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,n,o,a.size)})}).next(()=>s.result)}Yi(e,n,r,i){return r.documentReadCount<this.Wi?(Fa()<=Dn.DEBUG&&I("QueryEngine","SDK will not create cache indexes for query:",Va(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),_.resolve()):(Fa()<=Dn.DEBUG&&I("QueryEngine","Query:",Va(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(Fa()<=Dn.DEBUG&&I("QueryEngine","The SDK decides to create cache indexes for query:",Va(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Jt(n))):_.resolve())}ji(e,n){if(DN(n))return _.resolve(null);let r=Jt(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=eg(n,null,"F"),r=Jt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=ie(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.Zi(n,a);return this.Xi(n,l,o,c.readTime)?this.ji(e,eg(n,null,"F")):this.es(e,l,n,c)}))})))}Hi(e,n,r,i){return DN(n)||i.isEqual($.min())?_.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(n,s);return this.Xi(n,o,r,i)?_.resolve(null):(Fa()<=Dn.DEBUG&&I("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Va(n)),this.es(e,o,n,gR(i,-1)).next(a=>a))})}Zi(e,n){let r=new ke(OR(e));return n.forEach((i,s)=>{ed(e,s)&&(r=r.add(s))}),r}Xi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,n,r){return Fa()<=Dn.DEBUG&&I("QueryEngine","Using full collection scan to execute query:",Va(n)),this.zi.getDocumentsMatchingQuery(e,n,Vn.min(),r)}es(e,n,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var qw=class{constructor(e,n,r,i){this.persistence=e,this.ts=n,this.serializer=i,this.ns=new je(ne),this.rs=new Rr(s=>to(s),Xu),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new hg(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ns))}};function mP(t,e,n,r){return new qw(t,e,n,r)}function _P(t,e){return g(this,null,function*(){let n=N(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n._s(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=ie();for(let l of i){o.push(l.batchId);for(let u of l.mutations)c=c.add(u.key)}for(let l of s){a.push(l.batchId);for(let u of l.mutations)c=c.add(u.key)}return n.localDocuments.getDocuments(r,c).next(l=>({us:l,removedBatchIds:o,addedBatchIds:a}))})})})}function B8(t,e){let n=N(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(a,c,l,u){let d=l.batch,h=d.keys(),f=_.resolve();return h.forEach(p=>{f=f.next(()=>u.getEntry(c,p)).next(m=>{let v=l.docVersions.get(p);j(v!==null),m.version.compareTo(v)<0&&(d.applyToRemoteDocument(m,l),m.isValidDocument()&&(m.setReadTime(l.commitVersion),u.addEntry(m)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(c,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=ie();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function yP(t){let e=N(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function U8(t,e){let n=N(t),r=e.snapshotVersion,i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;let a=[];e.targetChanges.forEach((u,d)=>{let h=i.get(d);if(!h)return;a.push(n.Qr.removeMatchingKeys(s,u.removedDocuments,d).next(()=>n.Qr.addMatchingKeys(s,u.addedDocuments,d)));let f=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(It.EMPTY_BYTE_STRING,$.min()).withLastLimboFreeSnapshotVersion($.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,r)),i=i.insert(d,f),function(m,v,b){return m.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=3e8?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(h,f,u)&&a.push(n.Qr.updateTargetData(s,f))});let c=fn(),l=ie();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(vP(s,o,e.documentUpdates).next(u=>{c=u.cs,l=u.ls})),!r.isEqual($.min())){let u=n.Qr.getLastRemoteSnapshotVersion(s).next(d=>n.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(u)}return _.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(n.ns=i,s))}function vP(t,e,n){let r=ie(),i=ie();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=fn();return n.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual($.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):I("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{cs:o,ls:i}})}function $8(t,e){let n=N(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function ec(t,e){let n=N(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Qr.getTargetData(r,e).next(s=>s?(i=s,_.resolve(i)):n.Qr.allocateTargetId(r).next(o=>(i=new Xa(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(r.targetId,r),n.rs.set(e,r.targetId)),r})}function tc(t,e,n){return g(this,null,function*(){let r=N(t),i=r.ns.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Ji(o))throw o;I("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function mg(t,e,n){let r=N(t),i=$.min(),s=ie();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,u){let d=N(c),h=d.rs.get(u);return h!==void 0?_.resolve(d.ns.get(h)):d.Qr.getTargetData(l,u)}(r,o,Jt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,n?i:$.min(),n?s:ie())).next(a=>(EP(r,kR(e),a),{documents:a,hs:s})))}function xP(t,e){let n=N(t),r=N(n.Qr),i=n.ns.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function wP(t,e){let n=N(t),r=n.ss.get(e)||$.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.os.getAllFromCollectionGroup(i,e,gR(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(EP(n,e,i),i))}function EP(t,e,n){let r=t.ss.get(e)||$.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.ss.set(e,r)}function H8(t,e,n,r){return g(this,null,function*(){let i=N(t),s=ie(),o=fn();for(let l of n){let u=e.Ps(l.metadata.name);l.document&&(s=s.add(u));let d=e.Is(l);d.setReadTime(e.Ts(l.metadata.readTime)),o=o.insert(u,d)}let a=i.os.newChangeBuffer({trackRemovals:!0}),c=yield ec(i,function(u){return Jt(lc(we.fromString(`__bundle__/docs/${u}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>vP(l,a,o).next(u=>(a.apply(l),u)).next(u=>i.Qr.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.Qr.addMatchingKeys(l,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,u.cs,u.ls)).next(()=>u.cs)))})}function q8(r,i){return g(this,arguments,function*(t,e,n=ie()){let s=yield ec(t,Jt(BE(e.bundledQuery))),o=N(t);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=Je(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.$r.saveNamedQuery(a,e);let l=s.withResumeToken(It.EMPTY_BYTE_STRING,c);return o.ns=o.ns.insert(l.targetId,l),o.Qr.updateTargetData(a,l).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,n,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function eR(t,e){return`firestore_clients_${t}_${e}`}function tR(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Rx(t,e){return`firestore_targets_${t}_${e}`}var _g=class t{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Es(e,n,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new E(i.error.code,i.error.message))),o?new t(e,n,i.state,s):(Ze("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Tu=class t{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Es(e,n){let r=JSON.parse(n),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new E(r.error.code,r.error.message))),s?new t(e,r.state,i):(Ze("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},yg=class t{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Es(e,n){let r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=LE();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=yR(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new t(e,s):(Ze("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}},Gw=class t{constructor(e,n){this.clientId=e,this.onlineState=n}static Es(e){let n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t(n.clientId,n.onlineState):(Ze("SharedClientState",`Failed to parse online state: ${e}`),null)}},qu=class{constructor(){this.activeTargetIds=LE()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Su=class{constructor(e,n,r,i,s){this.window=e,this.oi=n,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new je(ne),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=eR(this.persistenceKey,this.Vs),this.Ss=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new qu),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Fs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return g(this,null,function*(){let e=yield this.syncEngine.Bi();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(eR(this.persistenceKey,r));if(i){let s=yg.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let n=this.storage.getItem(this.vs);if(n){let r=this.xs(n);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let n=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,n,r){this.Ls(e,n,r),this.Bs(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(Rx(this.persistenceKey,e));if(r){let i=Tu.Es(e,r);i&&(n=i.state)}}return this.ks.As(e),this.Ms(),n}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Rx(this.persistenceKey,e))}updateQueryState(e,n,r){this.qs(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let n=this.storage.getItem(e);return I("SharedClientState","READ",e,n),n}setItem(e,n){I("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){I("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let n=e;if(n.storageArea===this.storage){if(I("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ws)return void Ze("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>g(this,null,function*(){if(this.started){if(n.key!==null){if(this.bs.test(n.key)){if(n.newValue==null){let r=this.$s(n.key);return this.Us(r,null)}{let r=this.Ws(n.key,n.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){let r=this.Gs(n.key,n.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(n.key)){if(n.newValue!==null){let r=this.js(n.key,n.newValue);if(r)return this.Hs(r)}}else if(n.key===this.vs){if(n.newValue!==null){let r=this.xs(n.newValue);if(r)return this.Os(r)}}else if(n.key===this.Ss){let r=function(s){let o=vn._e;if(s!=null)try{let a=JSON.parse(s);j(typeof a=="number"),o=a}catch(a){Ze("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==vn._e&&this.sequenceNumberHandler(r)}else if(n.key===this.Fs){let r=this.Js(n.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(n)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,n,r){let i=new _g(this.currentUser,e,n,r),s=tR(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Bs(e){let n=tR(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Qs(e){let n={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(n))}qs(e,n,r){let i=Rx(this.persistenceKey,e),s=new Tu(e,n,r);this.setItem(i,s.ds())}Ks(e){let n=JSON.stringify(Array.from(e));this.setItem(this.Fs,n)}$s(e){let n=this.bs.exec(e);return n?n[1]:null}Ws(e,n){let r=this.$s(e);return yg.Es(r,n)}Gs(e,n){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return _g.Es(new ut(s),i,n)}js(e,n){let r=this.Cs.exec(e),i=Number(r[1]);return Tu.Es(i,n)}xs(e){return Gw.Es(e)}Js(e){return JSON.parse(e)}zs(e){return g(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);I("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,n){let r=n?this.ps.insert(e,n):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let n=LE();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}},vg=class{constructor(){this.no=new qu,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,n,r){this.ro[e]=n}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new qu,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var zw=class{io(e){}shutdown(){}};var xg=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){I("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){I("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Fp=null;function Px(){return Fp===null?Fp=function(){return 268435456+Math.round(2147483648*Math.random())}():Fp++,"0x"+Fp.toString(16)}var G8={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Ww=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}};var Ht="WebChannelConnection",Kw=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.fo=r+"://"+n.host,this.po=`projects/${i}/databases/${s}`,this.yo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get wo(){return!1}So(n,r,i,s,o){let a=Px(),c=this.bo(n,r.toUriEncodedString());I("RestConnection",`Sending RPC '${n}' ${a}:`,c,i);let l={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(l,s,o),this.Co(n,c,l,i).then(u=>(I("RestConnection",`Received RPC '${n}' ${a}: `,u),u),u=>{throw Fn("RestConnection",`RPC '${n}' ${a} failed with error: `,u,"url: ",c,"request:",i),u})}vo(n,r,i,s,o,a){return this.So(n,r,i,s,o)}Do(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+cc}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}bo(n,r){let i=G8[n];return`${this.fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,n,r,i){let s=Px();return new Promise((o,a)=>{let c=new uN;c.setWithCredentials(!0),c.listenOnce(cN.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Rp.NO_ERROR:let u=c.getResponseJson();I(Ht,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(u)),o(u);break;case Rp.TIMEOUT:I(Ht,`RPC '${e}' ${s} timed out`),a(new E(y.DEADLINE_EXCEEDED,"Request time out"));break;case Rp.HTTP_ERROR:let d=c.getStatus();if(I(Ht,`RPC '${e}' ${s} failed with status:`,d,"response text:",c.getResponseText()),d>0){let h=c.getResponseJson();Array.isArray(h)&&(h=h[0]);let f=h?.error;if(f&&f.status&&f.message){let p=function(v){let b=v.toLowerCase().replace(/_/g,"-");return Object.values(y).indexOf(b)>=0?b:y.UNKNOWN}(f.status);a(new E(p,f.message))}else a(new E(y.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new E(y.UNAVAILABLE,"Connection failed."));break;default:k()}}finally{I(Ht,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);I(Ht,`RPC '${e}' ${s} sending request:`,i),c.send(n,"POST",l,r,15)})}Fo(e,n,r){let i=Px(),s=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=oN(),a=aN(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Do(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;let u=s.join("");I(Ht,`Creating RPC '${e}' stream ${i}: ${u}`,c);let d=o.createWebChannel(u,c),h=!1,f=!1,p=new Ww({lo:v=>{f?I(Ht,`Not sending because RPC '${e}' stream ${i} is closed:`,v):(h||(I(Ht,`Opening RPC '${e}' stream ${i} transport.`),d.open(),h=!0),I(Ht,`RPC '${e}' stream ${i} sending:`,v),d.send(v))},ho:()=>d.close()}),m=(v,b,F)=>{v.listen(b,S=>{try{F(S)}catch(q){setTimeout(()=>{throw q},0)}})};return m(d,_u.EventType.OPEN,()=>{f||I(Ht,`RPC '${e}' stream ${i} transport opened.`)}),m(d,_u.EventType.CLOSE,()=>{f||(f=!0,I(Ht,`RPC '${e}' stream ${i} transport closed`),p.Vo())}),m(d,_u.EventType.ERROR,v=>{f||(f=!0,Fn(Ht,`RPC '${e}' stream ${i} transport errored:`,v),p.Vo(new E(y.UNAVAILABLE,"The operation could not be completed")))}),m(d,_u.EventType.MESSAGE,v=>{var b;if(!f){let F=v.data[0];j(!!F);let S=F,q=S.error||((b=S[0])===null||b===void 0?void 0:b.error);if(q){I(Ht,`RPC '${e}' stream ${i} received error:`,q);let K=q.status,X=function(n_){let Hd=ct[n_];if(Hd!==void 0)return QR(Hd)}(K),Me=q.message;X===void 0&&(X=y.INTERNAL,Me="Unknown error status: "+K+" with message "+q.message),f=!0,p.Vo(new E(X,Me)),d.close()}else I(Ht,`RPC '${e}' stream ${i} received:`,F),p.mo(F)}}),m(a,lN.STAT_EVENT,v=>{v.stat===Ax.PROXY?I(Ht,`RPC '${e}' stream ${i} detected buffering proxy`):v.stat===Ax.NOPROXY&&I(Ht,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.Ro()},0),p}};function CP(){return typeof window<"u"?window:null}function Up(){return typeof document<"u"?document:null}function td(t){return new dw(t,!0)}var Gu=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=n,this.Mo=r,this.xo=i,this.Oo=s,this.No=0,this.Lo=null,this.Bo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();let n=Math.floor(this.No+this.Qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,n-r);i>0&&I("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Lo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){this.Lo!==null&&(this.Lo.skipDelay(),this.Lo=null)}cancel(){this.Lo!==null&&(this.Lo.cancel(),this.Lo=null)}Qo(){return(Math.random()-.5)*this.No}};var wg=class{constructor(e,n,r,i,s,o,a,c){this.oi=e,this.$o=r,this.Uo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new Gu(e,n)}Ho(){return this.state===1||this.state===5||this.Jo()}Jo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Yo()}stop(){return g(this,null,function*(){this.Ho()&&(yield this.close(0))})}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&this.Go===null&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,()=>this.e_()))}t_(e){this.n_(),this.stream.send(e)}e_(){return g(this,null,function*(){if(this.Jo())return this.close(0)})}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}close(e,n){return g(this,null,function*(){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,e!==4?this.jo.reset():n&&n.code===y.RESOURCE_EXHAUSTED?(Ze(n.toString()),Ze("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):n&&n.code===y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.To(n)})}i_(){}auth(){this.state=1;let e=this.s_(this.Wo),n=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Wo===n&&this.o_(r,i)},r=>{e(()=>{let i=new E(y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.__(i)})})}o_(e,n){let r=this.s_(this.Wo);this.stream=this.a_(e,n),this.stream.Po(()=>{r(()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,()=>(this.Jo()&&(this.state=3),Promise.resolve())),this.listener.Po()))}),this.stream.To(i=>{r(()=>this.__(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Yo(){this.state=5,this.jo.qo(()=>g(this,null,function*(){this.state=0,this.start()}))}__(e){return I("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return n=>{this.oi.enqueueAndForget(()=>this.Wo===e?n():(I("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Qw=class extends wg{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}a_(e,n){return this.connection.Fo("Listen",e,n)}onMessage(e){this.jo.reset();let n=A8(this.serializer,e),r=function(s){if(!("targetChange"in s))return $.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?$.min():o.readTime?Je(o.readTime):$.min()}(e);return this.listener.u_(n,r)}c_(e){let n={};n.database=pw(this.serializer),n.addTarget=function(s,o){let a,c=o.target;if(a=Xp(c)?{documents:rP(s,c)}:{query:iP(s,c).ut},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=ZR(s,o.resumeToken);let l=hw(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo($.min())>0){a.readTime=Za(s,o.snapshotVersion.toTimestamp());let l=hw(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=N8(this.serializer,e);r&&(n.labels=r),this.t_(n)}l_(e){let n={};n.database=pw(this.serializer),n.removeTarget=e,this.t_(n)}},Yw=class extends wg{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,n){return this.connection.Fo("Write",e,n)}onMessage(e){if(j(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();let n=M8(e.writeResults,e.commitTime),r=Je(e.commitTime);return this.listener.T_(r,n)}return j(!e.writeResults||e.writeResults.length===0),this.h_=!0,this.listener.E_()}d_(){let e={};e.database=pw(this.serializer),this.t_(e)}I_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>Uu(this.serializer,r))};this.t_(n)}};var Zw=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new E(y.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,fw(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new E(y.UNKNOWN,s.toString())})}vo(e,n,r,i,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.vo(e,fw(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new E(y.UNKNOWN,o.toString())})}terminate(){this.A_=!0,this.connection.terminate()}};var Xw=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){this.m_===0&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve())))}S_(e){this.state==="Online"?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,e==="Online"&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(Ze(n),this.g_=!1):I("OnlineStateTracker",n)}b_(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}};var Jw=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=s,this.M_.io(o=>{r.enqueueAndForget(()=>g(this,null,function*(){es(this)&&(I("RemoteStore","Restarting streams for network reachability change."),yield function(c){return g(this,null,function*(){let l=N(c);l.v_.add(4),yield uc(l),l.x_.set("Unknown"),l.v_.delete(4),yield nd(l)})}(this))}))}),this.x_=new Xw(r,i)}};function nd(t){return g(this,null,function*(){if(es(t))for(let e of t.F_)yield e(!0)})}function uc(t){return g(this,null,function*(){for(let e of t.F_)yield e(!1)})}function Bg(t,e){let n=N(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),GE(n)?qE(n):hc(n).Jo()&&HE(n,e))}function nc(t,e){let n=N(t),r=hc(n);n.C_.delete(e),r.Jo()&&IP(n,e),n.C_.size===0&&(r.Jo()?r.Xo():es(n)&&n.x_.set("Unknown"))}function HE(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo($.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}hc(t).c_(e)}function IP(t,e){t.O_.Oe(e),hc(t).l_(e)}function qE(t){t.O_=new uw({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),hc(t).start(),t.x_.p_()}function GE(t){return es(t)&&!hc(t).Ho()&&t.C_.size>0}function es(t){return N(t).v_.size===0}function bP(t){t.O_=void 0}function z8(t){return g(this,null,function*(){t.C_.forEach((e,n)=>{HE(t,e)})})}function W8(t,e){return g(this,null,function*(){bP(t),GE(t)?(t.x_.S_(e),qE(t)):t.x_.set("Unknown")})}function K8(t,e,n){return g(this,null,function*(){if(t.x_.set("Online"),e instanceof ng&&e.state===2&&e.cause)try{yield function(i,s){return g(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.C_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.C_.delete(a),i.O_.removeTarget(a))})}(t,e)}catch(r){I("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Eg(t,r)}else if(e instanceof qa?t.O_.$e(e):e instanceof tg?t.O_.Je(e):t.O_.Ge(e),!n.isEqual($.min()))try{let r=yield yP(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.O_.it(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let u=s.C_.get(l);u&&s.C_.set(l,u.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{let u=s.C_.get(c);if(!u)return;s.C_.set(c,u.withResumeToken(It.EMPTY_BYTE_STRING,u.snapshotVersion)),IP(s,c);let d=new Xa(u.target,c,l,u.sequenceNumber);HE(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){I("RemoteStore","Failed to raise snapshot:",r),yield Eg(t,r)}})}function Eg(t,e,n){return g(this,null,function*(){if(!Ji(e))throw e;t.v_.add(1),yield uc(t),t.x_.set("Offline"),n||(n=()=>yP(t.localStore)),t.asyncQueue.enqueueRetryable(()=>g(this,null,function*(){I("RemoteStore","Retrying IndexedDB access"),yield n(),t.v_.delete(1),yield nd(t)}))})}function DP(t,e){return e().catch(n=>Eg(t,n,e))}function dc(t){return g(this,null,function*(){let e=N(t),n=Zi(e),r=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;Q8(e);)try{let i=yield $8(e.localStore,r);if(i===null){e.D_.length===0&&n.Xo();break}r=i.batchId,Y8(e,i)}catch(i){yield Eg(e,i)}TP(e)&&SP(e)})}function Q8(t){return es(t)&&t.D_.length<10}function Y8(t,e){t.D_.push(e);let n=Zi(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function TP(t){return es(t)&&!Zi(t).Ho()&&t.D_.length>0}function SP(t){Zi(t).start()}function Z8(t){return g(this,null,function*(){Zi(t).d_()})}function X8(t){return g(this,null,function*(){let e=Zi(t);for(let n of t.D_)e.I_(n.mutations)})}function J8(t,e,n){return g(this,null,function*(){let r=t.D_.shift(),i=aw.from(r,e,n);yield DP(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield dc(t)})}function e$(t,e){return g(this,null,function*(){e&&Zi(t).P_&&(yield function(r,i){return g(this,null,function*(){if(function(o){return KR(o)&&o!==y.ABORTED}(i.code)){let s=r.D_.shift();Zi(r).Zo(),yield DP(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield dc(r)}})}(t,e)),TP(t)&&SP(t)})}function nR(t,e){return g(this,null,function*(){let n=N(t);n.asyncQueue.verifyOperationInProgress(),I("RemoteStore","RemoteStore received new credentials");let r=es(n);n.v_.add(3),yield uc(n),r&&n.x_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),yield nd(n)})}function eE(t,e){return g(this,null,function*(){let n=N(t);e?(n.v_.delete(2),yield nd(n)):e||(n.v_.add(2),yield uc(n),n.x_.set("Unknown"))})}function hc(t){return t.N_||(t.N_=function(n,r,i){let s=N(n);return s.R_(),new Qw(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:z8.bind(null,t),To:W8.bind(null,t),u_:K8.bind(null,t)}),t.F_.push(e=>g(this,null,function*(){e?(t.N_.Zo(),GE(t)?qE(t):t.x_.set("Unknown")):(yield t.N_.stop(),bP(t))}))),t.N_}function Zi(t){return t.L_||(t.L_=function(n,r,i){let s=N(n);return s.R_(),new Yw(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:Z8.bind(null,t),To:e$.bind(null,t),E_:X8.bind(null,t),T_:J8.bind(null,t)}),t.F_.push(e=>g(this,null,function*(){e?(t.L_.Zo(),yield dc(t)):(yield t.L_.stop(),t.D_.length>0&&(I("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.L_}var tE=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new dt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new E(y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function fc(t,e){if(Ze("AsyncQueue",`${e}: ${t}`),Ji(t))return new E(y.UNAVAILABLE,`${e}: ${t}`);throw t}var Cg=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||M.comparator(n.key,r.key):(n,r)=>M.comparator(n.key,r.key),this.keyedMap=Eu(),this.sortedSet=new je(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var Ig=class{constructor(){this.B_=new je(M.comparator)}track(e){let n=e.doc.key,r=this.B_.get(n);r?e.type!==0&&r.type===3?this.B_=this.B_.insert(n,e):e.type===3&&r.type!==1?this.B_=this.B_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.B_=this.B_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.B_=this.B_.remove(n):e.type===1&&r.type===2?this.B_=this.B_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):k():this.B_=this.B_.insert(n,e)}k_(){let e=[];return this.B_.inorderTraversal((n,r)=>{e.push(r)}),e}},rc=class t{constructor(e,n,r,i,s,o,a,c,l){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,Cg.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ju(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var nE=class{constructor(){this.q_=void 0,this.Q_=[]}K_(){return this.Q_.some(e=>e.U_())}},rE=class{constructor(){this.queries=new Rr(e=>PR(e),Ju),this.onlineState="Unknown",this.W_=new Set}};function zE(t,e){return g(this,null,function*(){let n=N(t),r=3,i=e.query,s=n.queries.get(i);s?!s.K_()&&e.U_()&&(r=2):(s=new nE,r=e.U_()?0:1);try{switch(r){case 0:s.q_=yield n.onListen(i,!0);break;case 1:s.q_=yield n.onListen(i,!1);break;case 2:yield n.onFirstRemoteStoreListen(i)}}catch(o){let a=fc(o,`Initialization of query '${Va(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Q_.push(e),e.G_(n.onlineState),s.q_&&e.z_(s.q_)&&KE(n)})}function WE(t,e){return g(this,null,function*(){let n=N(t),r=e.query,i=3,s=n.queries.get(r);if(s){let o=s.Q_.indexOf(e);o>=0&&(s.Q_.splice(o,1),s.Q_.length===0?i=e.U_()?0:1:!s.K_()&&e.U_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}})}function t$(t,e){let n=N(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.Q_)a.z_(i)&&(r=!0);o.q_=i}}r&&KE(n)}function n$(t,e,n){let r=N(t),i=r.queries.get(e);if(i)for(let s of i.Q_)s.onError(n);r.queries.delete(e)}function KE(t){t.W_.forEach(e=>{e.next()})}var iE,rR;(rR=iE||(iE={})).j_="default",rR.Cache="cache";var zu=class{constructor(e,n,r){this.query=e,this.H_=n,this.J_=!1,this.Y_=null,this.onlineState="Unknown",this.options=r||{}}z_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new rc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.J_?this.Z_(e)&&(this.H_.next(e),n=!0):this.X_(e,this.onlineState)&&(this.ea(e),n=!0),this.Y_=e,n}onError(e){this.H_.error(e)}G_(e){this.onlineState=e;let n=!1;return this.Y_&&!this.J_&&this.X_(this.Y_,e)&&(this.ea(this.Y_),n=!0),n}X_(e,n){if(!e.fromCache||!this.U_())return!0;let r=n!=="Offline";return(!this.options.ta||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Z_(e){if(e.docChanges.length>0)return!0;let n=this.Y_&&this.Y_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ea(e){e=rc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.J_=!0,this.H_.next(e)}U_(){return this.options.source!==iE.Cache}};var sE=class{constructor(e,n){this.na=e,this.byteLength=n}ra(){return"metadata"in this.na}};var bg=class{constructor(e){this.serializer=e}Ps(e){return Sr(this.serializer,e)}Is(e){return e.metadata.exists?nP(this.serializer,e.document,!1):ht.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return Je(e)}},oE=class{constructor(e,n,r){this.ia=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=AP(e)}sa(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.na.namedQuery)this.queries.push(e.na.namedQuery);else if(e.na.documentMetadata){this.documents.push({metadata:e.na.documentMetadata}),e.na.documentMetadata.exists||++n;let r=we.fromString(e.na.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.na.document&&(this.documents[this.documents.length-1].document=e.na.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}oa(e){let n=new Map,r=new bg(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(n.get(o)||ie()).add(s);n.set(o,a)}}return n}complete(){return g(this,null,function*(){let e=yield H8(this.localStore,new bg(this.serializer),this.documents,this.ia.id),n=this.oa(this.documents);for(let r of this.queries)yield q8(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,_a:this.collectionGroups,aa:e}})}};function AP(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Dg=class{constructor(e){this.key=e}},Tg=class{constructor(e){this.key=e}},Sg=class{constructor(e,n){this.query=e,this.ua=n,this.ca=null,this.hasCachedResults=!1,this.current=!1,this.la=ie(),this.mutatedKeys=ie(),this.ha=OR(e),this.Pa=new Cg(this.ha)}get Ia(){return this.ua}Ta(e,n){let r=n?n.Ea:new Ig,i=n?n.Pa:this.Pa,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,d)=>{let h=i.get(u),f=ed(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),m=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations),v=!1;h&&f?h.data.isEqual(f.data)?p!==m&&(r.track({type:3,doc:f}),v=!0):this.da(h,f)||(r.track({type:2,doc:f}),v=!0,(c&&this.ha(f,c)>0||l&&this.ha(f,l)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),v=!0):h&&!f&&(r.track({type:1,doc:h}),v=!0,(c||l)&&(a=!0)),v&&(f?(o=o.add(f),s=m?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),r.track({type:1,doc:u})}return{Pa:o,Ea:r,Xi:a,mutatedKeys:s}}da(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.Pa;this.Pa=e.Pa,this.mutatedKeys=e.mutatedKeys;let o=e.Ea.k_();o.sort((u,d)=>function(f,p){let m=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return k()}};return m(f)-m(p)}(u.type,d.type)||this.ha(u.doc,d.doc)),this.Aa(r),i=i!=null&&i;let a=n&&!i?this.Ra():[],c=this.la.size===0&&this.current&&!i?1:0,l=c!==this.ca;return this.ca=c,o.length!==0||l?{snapshot:new rc(this.query,e.Pa,s,o,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),Va:a}:{Va:a}}G_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Pa:this.Pa,Ea:new Ig,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{Va:[]}}ma(e){return!this.ua.has(e)&&!!this.Pa.has(e)&&!this.Pa.get(e).hasLocalMutations}Aa(e){e&&(e.addedDocuments.forEach(n=>this.ua=this.ua.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ua=this.ua.delete(n)),this.current=e.current)}Ra(){if(!this.current)return[];let e=this.la;this.la=ie(),this.Pa.forEach(r=>{this.ma(r.key)&&(this.la=this.la.add(r.key))});let n=[];return e.forEach(r=>{this.la.has(r)||n.push(new Tg(r))}),this.la.forEach(r=>{e.has(r)||n.push(new Dg(r))}),n}fa(e){this.ua=e.hs,this.la=ie();let n=this.Ta(e.documents);return this.applyChanges(n,!0)}ga(){return rc.fromInitialDocuments(this.query,this.Pa,this.mutatedKeys,this.ca===0,this.hasCachedResults)}},aE=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},cE=class{constructor(e){this.key=e,this.pa=!1}},lE=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.ya={},this.wa=new Rr(a=>PR(a),Ju),this.Sa=new Map,this.ba=new Set,this.Da=new je(M.comparator),this.Ca=new Map,this.va=new Hu,this.Fa={},this.Ma=new Map,this.xa=Ja.Ln(),this.onlineState="Unknown",this.Oa=void 0}get isPrimaryClient(){return this.Oa===!0}};function r$(t,e,n=!0){return g(this,null,function*(){let r=Ug(t),i,s=r.wa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ga()):i=yield MP(r,e,n,!0),i})}function i$(t,e){return g(this,null,function*(){let n=Ug(t);yield MP(n,e,!0,!1)})}function MP(t,e,n,r){return g(this,null,function*(){let i=yield ec(t.localStore,Jt(e)),s=i.targetId,o=n?t.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield QE(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&Bg(t.remoteStore,i),a})}function QE(t,e,n,r,i){return g(this,null,function*(){t.Na=(d,h,f)=>function(m,v,b,F){return g(this,null,function*(){let S=v.view.Ta(b);S.Xi&&(S=yield mg(m.localStore,v.query,!1).then(({documents:Me})=>v.view.Ta(Me,S)));let q=F&&F.targetChanges.get(v.targetId),K=F&&F.targetMismatches.get(v.targetId)!=null,X=v.view.applyChanges(S,m.isPrimaryClient,q,K);return uE(m,v.targetId,X.Va),X.snapshot})}(t,d,h,f);let s=yield mg(t.localStore,e,!0),o=new Sg(e,s.hs),a=o.Ta(s.documents),c=ju.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),l=o.applyChanges(a,t.isPrimaryClient,c);uE(t,n,l.Va);let u=new aE(e,n,o);return t.wa.set(e,u),t.Sa.has(n)?t.Sa.get(n).push(e):t.Sa.set(n,[e]),l.snapshot})}function s$(t,e,n){return g(this,null,function*(){let r=N(t),i=r.wa.get(e),s=r.Sa.get(i.targetId);if(s.length>1)return r.Sa.set(i.targetId,s.filter(o=>!Ju(o,e))),void r.wa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield tc(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&nc(r.remoteStore,i.targetId),ic(r,i.targetId)}).catch(Xi))):(ic(r,i.targetId),yield tc(r.localStore,i.targetId,!0))})}function o$(t,e){return g(this,null,function*(){let n=N(t),r=n.wa.get(e),i=n.Sa.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),nc(n.remoteStore,r.targetId))})}function a$(t,e,n){return g(this,null,function*(){let r=JE(t);try{let i=yield function(o,a){let c=N(o),l=He.now(),u=a.reduce((f,p)=>f.add(p.key),ie()),d,h;return c.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=fn(),m=ie();return c.os.getEntries(f,u).next(v=>{p=v,p.forEach((b,F)=>{F.isValidDocument()||(m=m.add(b))})}).next(()=>c.localDocuments.getOverlayedDocuments(f,p)).next(v=>{d=v;let b=[];for(let F of a){let S=E8(F,d.get(F.key).overlayedDocument);S!=null&&b.push(new nr(F.key,S,DR(S.value.mapValue),Ke.exists(!0)))}return c.mutationQueue.addMutationBatch(f,l,b,a)}).next(v=>{h=v;let b=v.applyToLocalDocumentSet(d,m);return c.documentOverlayCache.saveOverlays(f,v.batchId,b)})}).then(()=>({batchId:h.batchId,changes:VR(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let l=o.Fa[o.currentUser.toKey()];l||(l=new je(ne)),l=l.insert(a,c),o.Fa[o.currentUser.toKey()]=l}(r,i.batchId,n),yield ci(r,i.changes),yield dc(r.remoteStore)}catch(i){let s=fc(i,"Failed to persist write");n.reject(s)}})}function NP(t,e){return g(this,null,function*(){let n=N(t);try{let r=yield U8(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.Ca.get(s);o&&(j(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.pa=!0:i.modifiedDocuments.size>0?j(o.pa):i.removedDocuments.size>0&&(j(o.pa),o.pa=!1))}),yield ci(n,r,e)}catch(r){yield Xi(r)}})}function iR(t,e,n){let r=N(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.wa.forEach((s,o)=>{let a=o.view.G_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=N(o);c.onlineState=a;let l=!1;c.queries.forEach((u,d)=>{for(let h of d.Q_)h.G_(a)&&(l=!0)}),l&&KE(c)}(r.eventManager,e),i.length&&r.ya.u_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function c$(t,e,n){return g(this,null,function*(){let r=N(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.Ca.get(e),s=i&&i.key;if(s){let o=new je(M.comparator);o=o.insert(s,ht.newNoDocument(s,$.min()));let a=ie().add(s),c=new Lu($.min(),new Map,new je(ne),o,a);yield NP(r,c),r.Da=r.Da.remove(s),r.Ca.delete(e),XE(r)}else yield tc(r.localStore,e,!1).then(()=>ic(r,e,n)).catch(Xi)})}function l$(t,e){return g(this,null,function*(){let n=N(t),r=e.batch.batchId;try{let i=yield B8(n.localStore,e);ZE(n,r,null),YE(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield ci(n,i)}catch(i){yield Xi(i)}})}function u$(t,e,n){return g(this,null,function*(){let r=N(t);try{let i=yield function(o,a){let c=N(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let u;return c.mutationQueue.lookupMutationBatch(l,a).next(d=>(j(d!==null),u=d.keys(),c.mutationQueue.removeMutationBatch(l,d))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,u,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,u)).next(()=>c.localDocuments.getDocuments(l,u))})}(r.localStore,e);ZE(r,e,n),YE(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield ci(r,i)}catch(i){yield Xi(i)}})}function d$(t,e){return g(this,null,function*(){let n=N(t);es(n.remoteStore)||I("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=N(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(n.localStore);if(r===-1)return void e.resolve();let i=n.Ma.get(r)||[];i.push(e),n.Ma.set(r,i)}catch(r){let i=fc(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function YE(t,e){(t.Ma.get(e)||[]).forEach(n=>{n.resolve()}),t.Ma.delete(e)}function ZE(t,e,n){let r=N(t),i=r.Fa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Fa[r.currentUser.toKey()]=i}}function ic(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.Sa.get(e))t.wa.delete(r),n&&t.ya.La(r,n);t.Sa.delete(e),t.isPrimaryClient&&t.va.Vr(e).forEach(r=>{t.va.containsKey(r)||RP(t,r)})}function RP(t,e){t.ba.delete(e.path.canonicalString());let n=t.Da.get(e);n!==null&&(nc(t.remoteStore,n),t.Da=t.Da.remove(e),t.Ca.delete(n),XE(t))}function uE(t,e,n){for(let r of n)r instanceof Dg?(t.va.addReference(r.key,e),h$(t,r)):r instanceof Tg?(I("SyncEngine","Document no longer in limbo: "+r.key),t.va.removeReference(r.key,e),t.va.containsKey(r.key)||RP(t,r.key)):k()}function h$(t,e){let n=e.key,r=n.path.canonicalString();t.Da.get(n)||t.ba.has(r)||(I("SyncEngine","New document in limbo: "+n),t.ba.add(r),XE(t))}function XE(t){for(;t.ba.size>0&&t.Da.size<t.maxConcurrentLimboResolutions;){let e=t.ba.values().next().value;t.ba.delete(e);let n=new M(we.fromString(e)),r=t.xa.next();t.Ca.set(r,new cE(n)),t.Da=t.Da.insert(n,r),Bg(t.remoteStore,new Xa(Jt(lc(n.path)),r,"TargetPurposeLimboResolution",vn._e))}}function ci(t,e,n){return g(this,null,function*(){let r=N(t),i=[],s=[],o=[];r.wa.isEmpty()||(r.wa.forEach((a,c)=>{o.push(r.Na(c,e,n).then(l=>{if((l||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,l?.fromCache?"not-current":"current"),l){i.push(l);let u=$w.Ki(c.targetId,l);s.push(u)}}))}),yield Promise.all(o),r.ya.u_(i),yield function(c,l){return g(this,null,function*(){let u=N(c);try{yield u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>_.forEach(l,h=>_.forEach(h.qi,f=>u.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>_.forEach(h.Qi,f=>u.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!Ji(d))throw d;I("LocalStore","Failed to update sequence numbers: "+d)}for(let d of l){let h=d.targetId;if(!d.fromCache){let f=u.ns.get(h),p=f.snapshotVersion,m=f.withLastLimboFreeSnapshotVersion(p);u.ns=u.ns.insert(h,m)}}})}(r.localStore,s))})}function f$(t,e){return g(this,null,function*(){let n=N(t);if(!n.currentUser.isEqual(e)){I("SyncEngine","User change. New user:",e.toKey());let r=yield _P(n.localStore,e);n.currentUser=e,function(s,o){s.Ma.forEach(a=>{a.forEach(c=>{c.reject(new E(y.CANCELLED,o))})}),s.Ma.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ci(n,r.us)}})}function p$(t,e){let n=N(t),r=n.Ca.get(e);if(r&&r.pa)return ie().add(r.key);{let i=ie(),s=n.Sa.get(e);if(!s)return i;for(let o of s){let a=n.wa.get(o);i=i.unionWith(a.view.Ia)}return i}}function g$(t,e){return g(this,null,function*(){let n=N(t),r=yield mg(n.localStore,e.query,!0),i=e.view.fa(r);return n.isPrimaryClient&&uE(n,e.targetId,i.Va),i})}function m$(t,e){return g(this,null,function*(){let n=N(t);return wP(n.localStore,e).then(r=>ci(n,r))})}function _$(t,e,n,r){return g(this,null,function*(){let i=N(t),s=yield function(a,c){let l=N(a),u=N(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",d=>u.vn(d,c).next(h=>h?l.localDocuments.getDocuments(d,h):_.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?yield dc(i.remoteStore):n==="acknowledged"||n==="rejected"?(ZE(i,e,r||null),YE(i,e),function(a,c){N(N(a).mutationQueue).Mn(c)}(i.localStore,e)):k(),yield ci(i,s)):I("SyncEngine","Cannot apply mutation batch with id: "+e)})}function y$(t,e){return g(this,null,function*(){let n=N(t);if(Ug(n),JE(n),e===!0&&n.Oa!==!0){let r=n.sharedClientState.getAllActiveQueryTargets(),i=yield sR(n,r.toArray());n.Oa=!0,yield eE(n.remoteStore,!0);for(let s of i)Bg(n.remoteStore,s)}else if(e===!1&&n.Oa!==!1){let r=[],i=Promise.resolve();n.Sa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(ic(n,o),tc(n.localStore,o,!0))),nc(n.remoteStore,o)}),yield i,yield sR(n,r),function(o){let a=N(o);a.Ca.forEach((c,l)=>{nc(a.remoteStore,l)}),a.va.mr(),a.Ca=new Map,a.Da=new je(M.comparator)}(n),n.Oa=!1,yield eE(n.remoteStore,!1)}})}function sR(t,e,n){return g(this,null,function*(){let r=N(t),i=[],s=[];for(let o of e){let a,c=r.Sa.get(o);if(c&&c.length!==0){a=yield ec(r.localStore,Jt(c[0]));for(let l of c){let u=r.wa.get(l),d=yield g$(r,u);d.snapshot&&s.push(d.snapshot)}}else{let l=yield xP(r.localStore,o);a=yield ec(r.localStore,l),yield QE(r,PP(l),o,!1,a.resumeToken)}i.push(a)}return r.ya.u_(s),i})}function PP(t){return RR(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function v$(t){return function(n){return N(N(n).persistence).Bi()}(N(t).localStore)}function x$(t,e,n,r){return g(this,null,function*(){let i=N(t);if(i.Oa)return void I("SyncEngine","Ignoring unexpected query state notification.");let s=i.Sa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{let o=yield wP(i.localStore,kR(s[0])),a=Lu.createSynthesizedRemoteEventForCurrentChange(e,n==="current",It.EMPTY_BYTE_STRING);yield ci(i,o,a);break}case"rejected":yield tc(i.localStore,e,!0),ic(i,e,r);break;default:k()}})}function w$(t,e,n){return g(this,null,function*(){let r=Ug(t);if(r.Oa){for(let i of e){if(r.Sa.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){I("SyncEngine","Adding an already active target "+i);continue}let s=yield xP(r.localStore,i),o=yield ec(r.localStore,s);yield QE(r,PP(s),o.targetId,!1,o.resumeToken),Bg(r.remoteStore,o)}for(let i of n)r.Sa.has(i)&&(yield tc(r.localStore,i,!1).then(()=>{nc(r.remoteStore,i),ic(r,i)}).catch(Xi))}})}function Ug(t){let e=N(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=NP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=p$.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=c$.bind(null,e),e.ya.u_=t$.bind(null,e.eventManager),e.ya.La=n$.bind(null,e.eventManager),e}function JE(t){let e=N(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=l$.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=u$.bind(null,e),e}function E$(t,e,n){let r=N(t);(function(s,o,a){return g(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(f,p){let m=N(f),v=Je(p.createTime);return m.persistence.runTransaction("hasNewerBundle","readonly",b=>m.$r.getBundleMetadata(b,p.id)).then(b=>!!b&&b.createTime.compareTo(v)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(AP(c));let l=new oE(c,s.localStore,o.serializer),u=yield o.Ba();for(;u;){let h=yield l.sa(u);h&&a._updateProgress(h),u=yield o.Ba()}let d=yield l.complete();return yield ci(s,d.aa,void 0),yield function(f,p){let m=N(f);return m.persistence.runTransaction("Save bundle","readwrite",v=>m.$r.saveBundleMetadata(v,p))}(s.localStore,c),a._completeWith(d.progress),Promise.resolve(d._a)}catch(c){return Fn("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var Wu=class{constructor(){this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){this.serializer=td(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return mP(this.persistence,new gg,e.initialUser,this.serializer)}createPersistence(e){return new fg(pg.Hr,this.serializer)}createSharedClientState(e){return new vg}terminate(){return g(this,null,function*(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Ag=class t extends Wu{constructor(e,n,r){super(),this.ka=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){yield r_(t.prototype,this,"initialize").call(this,e),yield this.ka.initialize(this,e),yield JE(this.ka.syncEngine),yield dc(this.ka.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return mP(this.persistence,new gg,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){let r=this.persistence.referenceDelegate.garbageCollector;return new Tw(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){let r=new Gx(n,this.persistence);return new qx(e.asyncQueue,r)}createPersistence(e){let n=$E(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?On.withCacheSize(this.cacheSizeBytes):On.DEFAULT;return new Uw(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,CP(),Up(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new vg}},dE=class t extends Ag{constructor(e,n){super(e,n,!1),this.ka=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){return g(this,null,function*(){yield r_(t.prototype,this,"initialize").call(this,e);let n=this.ka.syncEngine;this.sharedClientState instanceof Su&&(this.sharedClientState.syncEngine={Zs:_$.bind(null,n),Xs:x$.bind(null,n),eo:w$.bind(null,n),Bi:v$.bind(null,n),Ys:m$.bind(null,n)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>g(this,null,function*(){yield y$(this.ka.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let n=CP();if(!Su.D(n))throw new E(y.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=$E(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Su(n,e.asyncQueue,r,e.clientId,e.initialUser)}},Ku=class{initialize(e,n){return g(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>iR(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=f$.bind(null,this.syncEngine),yield eE(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new rE}()}createDatastore(e){let n=td(e.databaseInfo.databaseId),r=function(s){return new Kw(s)}(e.databaseInfo);return function(s,o,a,c){return new Zw(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new Jw(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>iR(this.syncEngine,n,0),function(){return xg.D()?new xg:new zw}())}createSyncEngine(e,n){return function(i,s,o,a,c,l,u){let d=new lE(i,s,o,a,c,l);return u&&(d.Oa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return g(this,null,function*(){var e;yield function(r){return g(this,null,function*(){let i=N(r);I("RemoteStore","RemoteStore shutting down."),i.v_.add(5),yield uc(i),i.M_.shutdown(),i.x_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function oR(t,e=10240){let n=0;return{read(){return g(this,null,function*(){if(n<t.byteLength){let i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}})},cancel(){return g(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var sc=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.qa(this.observer.next,e)}error(e){this.observer.error?this.qa(this.observer.error,e):Ze("Uncaught Error in snapshot listener:",e.toString())}Qa(){this.muted=!0}qa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var hE=class{constructor(e,n){this.Ka=e,this.serializer=n,this.metadata=new dt,this.buffer=new Uint8Array,this.$a=function(){return new TextDecoder("utf-8")}(),this.Ua().then(r=>{r&&r.ra()?this.metadata.resolve(r.na.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.na)}`))},r=>this.metadata.reject(r))}close(){return this.Ka.cancel()}getMetadata(){return g(this,null,function*(){return this.metadata.promise})}Ba(){return g(this,null,function*(){return yield this.getMetadata(),this.Ua()})}Ua(){return g(this,null,function*(){let e=yield this.Wa();if(e===null)return null;let n=this.$a.decode(e),r=Number(n);isNaN(r)&&this.Ga(`length string (${n}) is not valid number`);let i=yield this.za(r);return new sE(JSON.parse(i),e.length+r)})}ja(){return this.buffer.findIndex(e=>e===123)}Wa(){return g(this,null,function*(){for(;this.ja()<0&&!(yield this.Ha()););if(this.buffer.length===0)return null;let e=this.ja();e<0&&this.Ga("Reached the end of bundle when a length string is expected.");let n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n})}za(e){return g(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ha())&&this.Ga("Reached the end of bundle when more is expected.");let n=this.$a.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n})}Ga(e){throw this.Ka.cancel(),new Error(`Invalid bundle format: ${e}`)}Ha(){return g(this,null,function*(){let e=yield this.Ka.read();if(!e.done){let n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done})}};var fE=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new E(y.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let n=yield function(i,s){return g(this,null,function*(){let o=N(i),a={documents:s.map(d=>Bu(o.serializer,d))},c=yield o.vo("BatchGetDocuments",o.serializer.databaseId,we.emptyPath(),a,s.length),l=new Map;c.forEach(d=>{let h=S8(o.serializer,d);l.set(h.key.toString(),h)});let u=[];return s.forEach(d=>{let h=l.get(d.toString());j(!!h),u.push(h)}),u})}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n})}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Yi(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{let i=M.fromPath(r);this.mutations.push(new Ou(i,this.precondition(i)))}),yield function(r,i){return g(this,null,function*(){let s=N(r),o={writes:i.map(a=>Uu(s.serializer,a))};yield s.So("Commit",s.serializer.databaseId,we.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw k();n=$.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new E(y.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){let n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual($.min())?Ke.exists(!1):Ke.updateTime(n):Ke.none()}preconditionForUpdate(e){let n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual($.min()))throw new E(y.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ke.updateTime(n)}return Ke.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var pE=class{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Ja=r.maxAttempts,this.jo=new Gu(this.asyncQueue,"transaction_retry")}Ya(){this.Ja-=1,this.Za()}Za(){this.jo.qo(()=>g(this,null,function*(){let e=new fE(this.datastore),n=this.Xa(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.eu(i)}))}).catch(r=>{this.eu(r)})}))}Xa(e){try{let n=this.updateFunction(e);return!Zu(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}eu(e){this.Ja>0&&this.tu(e)?(this.Ja-=1,this.asyncQueue.enqueueAndForget(()=>(this.Za(),Promise.resolve()))):this.deferred.reject(e)}tu(e){if(e.name==="FirebaseError"){let n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!KR(n)}return!1}};var gE=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=ut.UNAUTHENTICATED,this.clientId=qp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>g(this,null,function*(){I("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(I("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new E(y.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new dt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=fc(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function $p(t,e){return g(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),I("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>g(this,null,function*(){r.isEqual(i)||(yield _P(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function mE(t,e){return g(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield eC(t);I("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>nR(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>nR(e.remoteStore,i)),t._onlineComponents=e})}function kP(t){return t.name==="FirebaseError"?t.code===y.FAILED_PRECONDITION||t.code===y.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function eC(t){return g(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){I("FirestoreClient","Using user provided OfflineComponentProvider");try{yield $p(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!kP(n))throw n;Fn("Error using user provided cache. Falling back to memory cache: "+n),yield $p(t,new Wu)}}else I("FirestoreClient","Using default OfflineComponentProvider"),yield $p(t,new Wu);return t._offlineComponents})}function $g(t){return g(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(I("FirestoreClient","Using user provided OnlineComponentProvider"),yield mE(t,t._uninitializedComponentsProvider._online)):(I("FirestoreClient","Using default OnlineComponentProvider"),yield mE(t,new Ku))),t._onlineComponents})}function OP(t){return eC(t).then(e=>e.persistence)}function tC(t){return eC(t).then(e=>e.localStore)}function FP(t){return $g(t).then(e=>e.remoteStore)}function nC(t){return $g(t).then(e=>e.syncEngine)}function C$(t){return $g(t).then(e=>e.datastore)}function oc(t){return g(this,null,function*(){let e=yield $g(t),n=e.eventManager;return n.onListen=r$.bind(null,e.syncEngine),n.onUnlisten=s$.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=i$.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=o$.bind(null,e.syncEngine),n})}function I$(t){return t.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield OP(t),n=yield FP(t);return e.setNetworkEnabled(!0),function(i){let s=N(i);return s.v_.delete(0),nd(s)}(n)}))}function b$(t){return t.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield OP(t),n=yield FP(t);return e.setNetworkEnabled(!1),function(i){return g(this,null,function*(){let s=N(i);s.v_.add(0),yield uc(s),s.x_.set("Offline")})}(n)}))}function D$(t,e){let n=new dt;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield function(l,u){let d=N(l);return d.persistence.runTransaction("read document","readonly",h=>d.localDocuments.getDocument(h,u))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new E(y.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=fc(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield tC(t),e,n)})),n.promise}function VP(t,e,n={}){let r=new dt;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,l){let u=new sc({next:h=>{o.enqueueAndForget(()=>WE(s,d));let f=h.docs.has(a);!f&&h.fromCache?l.reject(new E(y.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&c&&c.source==="server"?l.reject(new E(y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(h)},error:h=>l.reject(h)}),d=new zu(lc(a.path),u,{includeMetadataChanges:!0,ta:!0});return zE(s,d)}(yield oc(t),t.asyncQueue,e,n,r)})),r.promise}function T$(t,e){let n=new dt;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield mg(i,s,!0),c=new Sg(s,a.hs),l=c.Ta(a.documents),u=c.applyChanges(l,!1);o.resolve(u.snapshot)}catch(a){let c=fc(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield tC(t),e,n)})),n.promise}function LP(t,e,n={}){let r=new dt;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,l){let u=new sc({next:h=>{o.enqueueAndForget(()=>WE(s,d)),h.fromCache&&c.source==="server"?l.reject(new E(y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(h)},error:h=>l.reject(h)}),d=new zu(a,u,{includeMetadataChanges:!0,ta:!0});return zE(s,d)}(yield oc(t),t.asyncQueue,e,n,r)})),r.promise}function S$(t,e){let n=new sc(e);return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){N(i).W_.add(s),s.next()}(yield oc(t),n)})),()=>{n.Qa(),t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){N(i).W_.delete(s)}(yield oc(t),n)}))}}function A$(t,e,n,r){let i=function(o,a){let c;return c=typeof o=="string"?YR().encode(o):o,function(u,d){return new hE(u,d)}(function(u,d){if(u instanceof Uint8Array)return oR(u,d);if(u instanceof ArrayBuffer)return oR(new Uint8Array(u),d);if(u instanceof ReadableStream)return u.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(n,td(e));t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){E$(yield nC(t),i,r)}))}function M$(t,e){return t.asyncQueue.enqueue(()=>g(this,null,function*(){return function(r,i){let s=N(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield tC(t),e)}))}function jP(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var aR=new Map;function rC(t,e,n){if(!n)throw new E(y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function iC(t,e,n,r){if(e===!0&&r===!0)throw new E(y.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function cR(t){if(!M.isDocumentKey(t))throw new E(y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function lR(t){if(M.isDocumentKey(t))throw new E(y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Hg(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":k()}function Ee(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new E(y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=Hg(t);throw new E(y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function BP(t,e){if(e<=0)throw new E(y.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}var Mg=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new E(y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new E(y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}iC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=jP((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new E(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new E(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new E(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},so=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Mg({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new E(y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new E(y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Mg(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new kx;switch(r.type){case"firstParty":return new Lx(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new E(y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=aR.get(n);r&&(I("ComponentProvider","Removing Datastore"),aR.delete(n),r.terminate())}(this),Promise.resolve()}};function UP(t,e,n,r={}){var i;let s=(t=Ee(t,so))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Fn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=ut.MOCK_USER;else{a=zd(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new E(y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new ut(l)}t._authCredentials=new Ox(new Hp(a,c))}}var Ot=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},Fe=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ar(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},Ar=class t extends Ot{constructor(e,n,r){super(e,n,lc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Fe(this.firestore,null,new M(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function sC(t,e,...n){if(t=fe(t),rC("collection","path",e),t instanceof so){let r=we.fromString(e,...n);return lR(r),new Ar(t,null,r)}{if(!(t instanceof Fe||t instanceof Ar))throw new E(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(we.fromString(e,...n));return lR(r),new Ar(t.firestore,null,r)}}function $P(t,e){if(t=Ee(t,so),rC("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new E(y.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Ot(t,null,function(r){return new tr(we.emptyPath(),r)}(e))}function rd(t,e,...n){if(t=fe(t),arguments.length===1&&(e=qp.newId()),rC("doc","path",e),t instanceof so){let r=we.fromString(e,...n);return cR(r),new Fe(t,null,new M(r))}{if(!(t instanceof Fe||t instanceof Ar))throw new E(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(we.fromString(e,...n));return cR(r),new Fe(t.firestore,t instanceof Ar?t.converter:null,new M(r))}}function oC(t,e){return t=fe(t),e=fe(e),(t instanceof Fe||t instanceof Ar)&&(e instanceof Fe||e instanceof Ar)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function aC(t,e){return t=fe(t),e=fe(e),t instanceof Ot&&e instanceof Ot&&t.firestore===e.firestore&&Ju(t._query,e._query)&&t.converter===e.converter}var _E=class{constructor(){this.nu=Promise.resolve(),this.ru=[],this.iu=!1,this.su=[],this.ou=null,this._u=!1,this.au=!1,this.uu=[],this.jo=new Gu(this,"async_queue_retry"),this.cu=()=>{let n=Up();n&&I("AsyncQueue","Visibility state changed to "+n.visibilityState),this.jo.Ko()};let e=Up();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.cu)}get isShuttingDown(){return this.iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.lu(),this.hu(e)}enterRestrictedMode(e){if(!this.iu){this.iu=!0,this.au=e||!1;let n=Up();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.cu)}}enqueue(e){if(this.lu(),this.iu)return new Promise(()=>{});let n=new dt;return this.hu(()=>this.iu&&this.au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.ru.push(e),this.Pu()))}Pu(){return g(this,null,function*(){if(this.ru.length!==0){try{yield this.ru[0](),this.ru.shift(),this.jo.reset()}catch(e){if(!Ji(e))throw e;I("AsyncQueue","Operation failed with retryable error: "+e)}this.ru.length>0&&this.jo.qo(()=>this.Pu())}})}hu(e){let n=this.nu.then(()=>(this._u=!0,e().catch(r=>{this.ou=r,this._u=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Ze("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this._u=!1,r))));return this.nu=n,n}enqueueAfterDelay(e,n,r){this.lu(),this.uu.indexOf(e)>-1&&(n=0);let i=tE.createAndSchedule(this,e,n,r,s=>this.Iu(s));return this.su.push(i),i}lu(){this.ou&&k()}verifyOperationInProgress(){}Tu(){return g(this,null,function*(){let e;do e=this.nu,yield e;while(e!==this.nu)})}Eu(e){for(let n of this.su)if(n.timerId===e)return!0;return!1}du(e){return this.Tu().then(()=>{this.su.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.su)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tu()})}Au(e){this.uu.push(e)}Iu(e){let n=this.su.indexOf(e);this.su.splice(n,1)}};function yE(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var vE=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new dt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var HP=-1,Ue=class extends so{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new _E}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||qP(this),this._firestoreClient.terminate()}};function _t(t){return t._firestoreClient||qP(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function qP(t){var e,n,r;let i=t._freezeSettings(),s=function(a,c,l,u){return new zx(a,c,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,jP(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new gE(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function GP(t,e){ek(t=Ee(t,Ue));let n=_t(t);if(n._uninitializedComponentsProvider)throw new E(y.FAILED_PRECONDITION,"SDK cache is already specified.");Fn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=t._freezeSettings(),i=new Ku;return WP(n,i,new Ag(i,r.cacheSizeBytes,e?.forceOwnership))}function zP(t){ek(t=Ee(t,Ue));let e=_t(t);if(e._uninitializedComponentsProvider)throw new E(y.FAILED_PRECONDITION,"SDK cache is already specified.");Fn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=t._freezeSettings(),r=new Ku;return WP(e,r,new dE(r,n.cacheSizeBytes))}function WP(t,e,n){let r=new dt;return t.asyncQueue.enqueue(()=>g(this,null,function*(){try{yield $p(t,n),yield mE(t,e),r.resolve()}catch(i){let s=i;if(!kP(s))throw s;Fn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function KP(t){if(t._initialized&&!t._terminated)throw new E(y.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new dt;return t._queue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{yield function(r){return g(this,null,function*(){if(!ri.D())return Promise.resolve();let i=r+"main";yield ri.delete(i)})}($E(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}})),e.promise}function QP(t){return function(n){let r=new dt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return d$(yield nC(n),r)})),r.promise}(_t(t=Ee(t,Ue)))}function YP(t){return I$(_t(t=Ee(t,Ue)))}function ZP(t){return b$(_t(t=Ee(t,Ue)))}function XP(t,e){let n=_t(t=Ee(t,Ue)),r=new vE;return A$(n,t._databaseId,e,r),r}function JP(t,e){return M$(_t(t=Ee(t,Ue)),e).then(n=>n?new Ot(t,null,n.query):null)}function ek(t){if(t._initialized||t._terminated)throw new E(y.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Pr=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(It.fromBase64String(e))}catch(n){throw new E(y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(It.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var rr=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new E(y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Xe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var oi=class{constructor(e){this._methodName=e}};var oo=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new E(y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new E(y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ne(this._lat,e._lat)||ne(this._long,e._long)}};var N$=/^__.*__$/,xE=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new nr(e,this.data,this.fieldMask,n,this.fieldTransforms):new Qi(e,this.data,n,this.fieldTransforms)}},Ng=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new nr(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function tk(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw k()}}var Rg=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ru(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Vu(){return this.settings.Vu}mu(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}fu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.mu({path:r,gu:!1});return i.pu(e),i}yu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.mu({path:r,gu:!1});return i.Ru(),i}wu(e){return this.mu({path:void 0,gu:!0})}Su(e){return Pg(e,this.settings.methodName,this.settings.bu||!1,this.path,this.settings.Du)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Ru(){if(this.path)for(let e=0;e<this.path.length;e++)this.pu(this.path.get(e))}pu(e){if(e.length===0)throw this.Su("Document fields must not be empty");if(tk(this.Vu)&&N$.test(e))throw this.Su('Document fields cannot begin and end with "__"')}},wE=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||td(e)}Cu(e,n,r,i=!1){return new Rg({Vu:e,methodName:n,Du:r,path:Xe.emptyPath(),gu:!1,bu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function uo(t){let e=t._freezeSettings(),n=td(t._databaseId);return new wE(t._databaseId,!!e.ignoreUndefinedProperties,n)}function qg(t,e,n,r,i,s={}){let o=t.Cu(s.merge||s.mergeFields?2:0,e,n,i);uC("Data must be an object, but it was:",o,r);let a=ik(r,o),c,l;if(s.merge)c=new xn(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let u=[];for(let d of s.mergeFields){let h=DE(e,d,n);if(!o.contains(h))throw new E(y.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);ok(u,h)||u.push(h)}c=new xn(u),l=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,l=o.fieldTransforms;return new xE(new qt(a),c,l)}var Qu=class t extends oi{_toFieldTransform(e){if(e.Vu!==2)throw e.Vu===1?e.Su(`${this._methodName}() can only appear at the top level of your update data`):e.Su(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};function nk(t,e,n){return new Rg({Vu:3,Du:e.settings.Du,methodName:t._methodName,gu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var EE=class t extends oi{_toFieldTransform(e){return new no(e.path,new Wi)}isEqual(e){return e instanceof t}},CE=class t extends oi{constructor(e,n){super(e),this.vu=n}_toFieldTransform(e){let n=nk(this,e,!0),r=this.vu.map(s=>ho(s,n)),i=new ii(r);return new no(e.path,i)}isEqual(e){return e instanceof t&&o_(this.vu,e.vu)}},IE=class t extends oi{constructor(e,n){super(e),this.vu=n}_toFieldTransform(e){let n=nk(this,e,!0),r=this.vu.map(s=>ho(s,n)),i=new si(r);return new no(e.path,i)}isEqual(e){return e instanceof t&&o_(this.vu,e.vu)}},bE=class t extends oi{constructor(e,n){super(e),this.Fu=n}_toFieldTransform(e){let n=new Ki(e.serializer,UR(e.serializer,this.Fu));return new no(e.path,n)}isEqual(e){return e instanceof t&&this.Fu===e.Fu}};function cC(t,e,n,r){let i=t.Cu(1,e,n);uC("Data must be an object, but it was:",i,r);let s=[],o=qt.empty();lo(r,(c,l)=>{let u=dC(e,c,n);l=fe(l);let d=i.yu(u);if(l instanceof Qu)s.push(u);else{let h=ho(l,d);h!=null&&(s.push(u),o.set(u,h))}});let a=new xn(s);return new Ng(o,a,i.fieldTransforms)}function lC(t,e,n,r,i,s){let o=t.Cu(1,e,n),a=[DE(e,r,n)],c=[i];if(s.length%2!=0)throw new E(y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(DE(e,s[h])),c.push(s[h+1]);let l=[],u=qt.empty();for(let h=a.length-1;h>=0;--h)if(!ok(l,a[h])){let f=a[h],p=c[h];p=fe(p);let m=o.yu(f);if(p instanceof Qu)l.push(f);else{let v=ho(p,m);v!=null&&(l.push(f),u.set(f,v))}}let d=new xn(l);return new Ng(u,d,o.fieldTransforms)}function rk(t,e,n,r=!1){return ho(n,t.Cu(r?4:3,e))}function ho(t,e){if(sk(t=fe(t)))return uC("Unsupported field value:",e,t),ik(t,e);if(t instanceof oi)return function(r,i){if(!tk(i.Vu))throw i.Su(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Su(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.gu&&e.Vu!==4)throw e.Su("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=ho(a,i.wu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=fe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return UR(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=He.fromDate(r);return{timestampValue:Za(i.serializer,s)}}if(r instanceof He){let s=new He(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Za(i.serializer,s)}}if(r instanceof oo)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Pr)return{bytesValue:ZR(i.serializer,r._byteString)};if(r instanceof Fe){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Su(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:jE(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Su(`Unsupported field value: ${Hg(r)}`)}(t,e)}function ik(t,e){let n={};return CR(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):lo(t,(r,i)=>{let s=ho(i,e.fu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function sk(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof He||t instanceof oo||t instanceof Pr||t instanceof Fe||t instanceof oi)}function uC(t,e,n){if(!sk(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=Hg(n);throw r==="an object"?e.Su(t+" a custom object"):e.Su(t+" "+r)}}function DE(t,e,n){if((e=fe(e))instanceof rr)return e._internalPath;if(typeof e=="string")return dC(t,e);throw Pg("Field path arguments must be of type string or ",t,!1,void 0,n)}var R$=new RegExp("[~\\*/\\[\\]]");function dC(t,e,n){if(e.search(R$)>=0)throw Pg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new rr(...e.split("."))._internalPath}catch{throw Pg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Pg(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new E(y.INVALID_ARGUMENT,a+t+c)}function ok(t,e){return t.some(n=>n.isEqual(e))}var ao=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Fe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new TE(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(Gg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},TE=class extends ao{data(){return super.data()}};function Gg(t,e){return typeof e=="string"?dC(t,e):e instanceof rr?e._internalPath:e._delegate._internalPath}function ak(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new E(y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Yu=class{},co=class extends Yu{};function li(t,e,...n){let r=[];e instanceof Yu&&r.push(e),r=r.concat(n),function(s){let o=s.filter(c=>c instanceof SE).length,a=s.filter(c=>c instanceof kg).length;if(o>1||o>0&&a>0)throw new E(y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var kg=class t extends co{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return _k(e._query,n),new Ot(e.firestore,e.converter,sw(e._query,n))}_parse(e){let n=uo(e.firestore);return function(s,o,a,c,l,u,d){let h;if(l.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new E(y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){dR(d,u);let f=[];for(let p of d)f.push(uR(c,s,p));h={arrayValue:{values:f}}}else h=uR(c,s,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||dR(d,u),h=rk(a,o,d,u==="in"||u==="not-in");return me.create(l,u,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function ck(t,e,n){let r=e,i=Gg("where",t);return kg._create(i,r,n)}var SE=class t extends Yu{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ae.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)_k(o,c),o=sw(o,c)}(e._query,n),new Ot(e.firestore,e.converter,sw(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var AE=class t extends co{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t(e,n)}_apply(e){let n=function(i,s,o){if(i.startAt!==null)throw new E(y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new E(y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new eo(s,o)}(e._query,this._field,this._direction);return new Ot(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new tr(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}};function lk(t,e="asc"){let n=e,r=Gg("orderBy",t);return AE._create(r,n)}var Og=class t extends co{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){return new Ot(e.firestore,e.converter,eg(e._query,this._limit,this._limitType))}};function uk(t){return BP("limit",t),Og._create("limit",t,"F")}function dk(t){return BP("limitToLast",t),Og._create("limitToLast",t,"L")}var Fg=class t extends co{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=mk(e,this.type,this._docOrFields,this._inclusive);return new Ot(e.firestore,e.converter,function(i,s){return new tr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function hk(...t){return Fg._create("startAt",t,!0)}function fk(...t){return Fg._create("startAfter",t,!1)}var Vg=class t extends co{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=mk(e,this.type,this._docOrFields,this._inclusive);return new Ot(e.firestore,e.converter,function(i,s){return new tr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function pk(...t){return Vg._create("endBefore",t,!1)}function gk(...t){return Vg._create("endAt",t,!0)}function mk(t,e,n,r){if(n[0]=fe(n[0]),n[0]instanceof ao)return function(s,o,a,c,l){if(!c)throw new E(y.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let u=[];for(let d of Ha(s))if(d.field.isKeyField())u.push(Js(o,c.key));else{let h=c.data.field(d.field);if(jg(h))throw new E(y.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){let f=d.field.canonicalString();throw new E(y.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}u.push(h)}return new Nr(u,l)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{let i=uo(t.firestore);return function(o,a,c,l,u,d){let h=o.explicitOrderBy;if(u.length>h.length)throw new E(y.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let f=[];for(let p=0;p<u.length;p++){let m=u[p];if(h[p].field.isKeyField()){if(typeof m!="string")throw new E(y.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof m}`);if(!VE(o)&&m.indexOf("/")!==-1)throw new E(y.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${m}' contains a slash.`);let v=o.path.child(we.fromString(m));if(!M.isDocumentKey(v))throw new E(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${v}' is not because it contains an odd number of segments.`);let b=new M(v);f.push(Js(a,b))}else{let v=rk(c,l,m);f.push(v)}}return new Nr(f,d)}(t._query,t.firestore._databaseId,i,e,n,r)}}function uR(t,e,n){if(typeof(n=fe(n))=="string"){if(n==="")throw new E(y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!VE(e)&&n.indexOf("/")!==-1)throw new E(y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(we.fromString(n));if(!M.isDocumentKey(r))throw new E(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Js(t,new M(r))}if(n instanceof Fe)return Js(t,n._key);throw new E(y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Hg(n)}.`)}function dR(t,e){if(!Array.isArray(t)||t.length===0)throw new E(y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function _k(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new E(y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new E(y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var ac=class{convertValue(e,n="none"){switch(Xs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return We(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(qi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw k()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return lo(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new oo(We(e.latitude),We(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=OE(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ru(e));default:return null}}convertTimestamp(e){let n=Hi(e);return new He(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=we.fromString(e);j(cP(r));let i=new Gi(r.get(1),r.get(3)),s=new M(r.popFirst(5));return i.isEqual(n)||Ze(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function zg(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var ME=class extends ac{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Fe(this.firestore,null,n)}};var ni=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ln=class extends ao{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new Ui(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(Gg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},Ui=class extends Ln{data(e={}){return super.data(e)}},ir=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new ni(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ui(this._firestore,this._userDataWriter,r.key,r,new ni(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new E(y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new Ui(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ni(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new Ui(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ni(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,u=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:P$(a.type),doc:c,oldIndex:l,newIndex:u}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function P$(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return k()}}function hC(t,e){return t instanceof Ln&&e instanceof Ln?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof ir&&e instanceof ir&&t._firestore===e._firestore&&aC(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function yk(t){t=Ee(t,Fe);let e=Ee(t.firestore,Ue);return VP(_t(e),t._key).then(n=>mC(e,t,n))}var ai=class extends ac{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Fe(this.firestore,null,n)}};function vk(t){t=Ee(t,Fe);let e=Ee(t.firestore,Ue),n=_t(e),r=new ai(e);return D$(n,t._key).then(i=>new Ln(e,r,t._key,i,new ni(i!==null&&i.hasLocalMutations,!0),t.converter))}function xk(t){t=Ee(t,Fe);let e=Ee(t.firestore,Ue);return VP(_t(e),t._key,{source:"server"}).then(n=>mC(e,t,n))}function wk(t){t=Ee(t,Ot);let e=Ee(t.firestore,Ue),n=_t(e),r=new ai(e);return ak(t._query),LP(n,t._query).then(i=>new ir(e,r,t,i))}function Ek(t){t=Ee(t,Ot);let e=Ee(t.firestore,Ue),n=_t(e),r=new ai(e);return T$(n,t._query).then(i=>new ir(e,r,t,i))}function Ck(t){t=Ee(t,Ot);let e=Ee(t.firestore,Ue),n=_t(e),r=new ai(e);return LP(n,t._query,{source:"server"}).then(i=>new ir(e,r,t,i))}function fC(t,e,n){t=Ee(t,Fe);let r=Ee(t.firestore,Ue),i=zg(t.converter,e,n);return pc(r,[qg(uo(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Ke.none())])}function pC(t,e,n,...r){t=Ee(t,Fe);let i=Ee(t.firestore,Ue),s=uo(i),o;return o=typeof(e=fe(e))=="string"||e instanceof rr?lC(s,"updateDoc",t._key,e,n,r):cC(s,"updateDoc",t._key,e),pc(i,[o.toMutation(t._key,Ke.exists(!0))])}function Ik(t){return pc(Ee(t.firestore,Ue),[new Yi(t._key,Ke.none())])}function bk(t,e){let n=Ee(t.firestore,Ue),r=rd(t),i=zg(t.converter,e);return pc(n,[qg(uo(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Ke.exists(!1))]).then(()=>r)}function gC(t,...e){var n,r,i;t=fe(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||yE(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(yE(e[o])){let d=e[o];e[o]=(n=d.next)===null||n===void 0?void 0:n.bind(d),e[o+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let c,l,u;if(t instanceof Fe)l=Ee(t.firestore,Ue),u=lc(t._key.path),c={next:d=>{e[o]&&e[o](mC(l,t,d))},error:e[o+1],complete:e[o+2]};else{let d=Ee(t,Ot);l=Ee(d.firestore,Ue),u=d._query;let h=new ai(l);c={next:f=>{e[o]&&e[o](new ir(l,h,d,f))},error:e[o+1],complete:e[o+2]},ak(t._query)}return function(h,f,p,m){let v=new sc(m),b=new zu(f,v,p);return h.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return zE(yield oc(h),b)})),()=>{v.Qa(),h.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return WE(yield oc(h),b)}))}}(_t(l),u,a,c)}function Dk(t,e){return S$(_t(t=Ee(t,Ue)),yE(e)?e:{next:e})}function pc(t,e){return function(r,i){let s=new dt;return r.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return a$(yield nC(r),i,s)})),s.promise}(_t(t),e)}function mC(t,e,n){let r=n.docs.get(e._key),i=new ai(t);return new Ln(t,i,e._key,r,new ni(n.hasPendingWrites,n.fromCache),e.converter)}var k$={maxAttempts:5};var Lg=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=uo(e)}set(e,n,r){this._verifyNotCommitted();let i=ji(e,this._firestore),s=zg(i.converter,n,r),o=qg(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Ke.none())),this}update(e,n,r,...i){this._verifyNotCommitted();let s=ji(e,this._firestore),o;return o=typeof(n=fe(n))=="string"||n instanceof rr?lC(this._dataReader,"WriteBatch.update",s._key,n,r,i):cC(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,Ke.exists(!0))),this}delete(e){this._verifyNotCommitted();let n=ji(e,this._firestore);return this._mutations=this._mutations.concat(new Yi(n._key,Ke.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new E(y.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function ji(t,e){if((t=fe(t)).firestore!==e)throw new E(y.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var NE=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=uo(n)}get(n){let r=ji(n,this._firestore),i=new ME(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return k();let o=s[0];if(o.isFoundDocument())return new ao(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new ao(this._firestore,i,r._key,null,r.converter);throw k()})}set(n,r,i){let s=ji(n,this._firestore),o=zg(s.converter,r,i),a=qg(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){let o=ji(n,this._firestore),a;return a=typeof(r=fe(r))=="string"||r instanceof rr?lC(this._dataReader,"Transaction.update",o._key,r,i,s):cC(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){let r=ji(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){let n=ji(e,this._firestore),r=new ai(this._firestore);return super.get(e).then(i=>new Ln(this._firestore,r,n._key,i._document,new ni(!1,!1),n.converter))}};function Tk(t,e,n){t=Ee(t,Ue);let r=Object.assign(Object.assign({},k$),n);return function(s){if(s.maxAttempts<1)throw new E(y.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new dt;return s.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let l=yield C$(s);new pE(s.asyncQueue,l,a,o,c).Ya()})),c.promise}(_t(t),i=>e(new NE(t,i)),r)}function Sk(){return new Qu("deleteField")}function Ak(){return new EE("serverTimestamp")}function Mk(...t){return new CE("arrayUnion",t)}function Nk(...t){return new IE("arrayRemove",t)}function Rk(t){return new bE("increment",t)}(function(e,n=!0){(function(i){cc=i})(Zd),us(new pn("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Ue(new Fx(r.getProvider("auth-internal")),new Bx(r.getProvider("app-check-internal")),function(l,u){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new E(y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Gi(l.options.projectId,u)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),$n(hN,"4.5.1",e),$n(hN,"4.5.1","esm2017")})();var O$="@firebase/firestore-compat",F$="0.3.28";function EC(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new E("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function Pk(){if(typeof Uint8Array>"u")throw new E("unimplemented","Uint8Arrays are not available in this environment.")}function kk(){if(!IR())throw new E("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Wg=class t{constructor(e){this._delegate=e}static fromBase64String(e){return kk(),new t(Pr.fromBase64String(e))}static fromUint8Array(e){return Pk(),new t(Pr.fromUint8Array(e))}toBase64(){return kk(),this._delegate.toBase64()}toUint8Array(){return Pk(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function _C(t){return V$(t,["next","error","complete"])}function V$(t,e){if(typeof t!="object"||t===null)return!1;let n=t;for(let r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}var yC=class{enableIndexedDbPersistence(e,n){return GP(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return zP(e._delegate)}clearIndexedDbPersistence(e){return KP(e._delegate)}},Kg=class{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Gi||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Fn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){UP(this._delegate,e,n,r)}enableNetwork(){return YP(this._delegate)}disableNetwork(){return ZP(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,iC("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return QP(this._delegate)}onSnapshotsInSync(e){return Dk(this._delegate,e)}get app(){if(!this._appCompat)throw new E("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new _c(this,sC(this._delegate,e))}catch(n){throw en(n,"collection()","Firestore.collection()")}}doc(e){try{return new kr(this,rd(this._delegate,e))}catch(n){throw en(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new mo(this,$P(this._delegate,e))}catch(n){throw en(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Tk(this._delegate,n=>e(new Qg(this,n)))}batch(){return _t(this._delegate),new Yg(new Lg(this._delegate,e=>pc(this._delegate,e)))}loadBundle(e){return XP(this._delegate,e)}namedQuery(e){return JP(this._delegate,e).then(n=>n?new mo(this,n):null)}},gc=class extends ac{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wg(new Pr(e))}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return kr.forKey(n,this.firestore,null)}};function L$(t){hR(t)}var Qg=class{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new gc(e)}get(e){let n=fo(e);return this._delegate.get(n).then(r=>new po(this._firestore,new Ln(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){let i=fo(e);return r?(EC("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=fo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=fo(e);return this._delegate.delete(n),this}},Yg=class{constructor(e){this._delegate=e}set(e,n,r){let i=fo(e);return r?(EC("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=fo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=fo(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}},mc=class t{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){let r=new Ui(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new go(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){let r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new t(e,new gc(e),n),i.set(n,s)),s}};mc.INSTANCES=new WeakMap;var kr=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new gc(e)}static forPath(e,n,r){if(e.length%2!==0)throw new E("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new t(n,new Fe(n._delegate,r,new M(e)))}static forKey(e,n,r){return new t(n,new Fe(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new _c(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new _c(this.firestore,sC(this._delegate,e))}catch(n){throw en(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=fe(e),e instanceof Fe?oC(this._delegate,e):!1}set(e,n){n=EC("DocumentReference.set",n);try{return n?fC(this._delegate,e,n):fC(this._delegate,e)}catch(r){throw en(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?pC(this._delegate,e):pC(this._delegate,e,n,...r)}catch(i){throw en(i,"updateDoc()","DocumentReference.update()")}}delete(){return Ik(this._delegate)}onSnapshot(...e){let n=Ok(e),r=Fk(e,i=>new po(this.firestore,new Ln(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return gC(this._delegate,n,r)}get(e){let n;return e?.source==="cache"?n=vk(this._delegate):e?.source==="server"?n=xk(this._delegate):n=yk(this._delegate),n.then(r=>new po(this.firestore,new Ln(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(mc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function en(t,e,n){return t.message=t.message.replace(e,n),t}function Ok(t){for(let e of t)if(typeof e=="object"&&!_C(e))return e;return{}}function Fk(t,e){var n,r;let i;return _C(t[0])?i=t[0]:_C(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var po=class{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new kr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return hC(this._delegate,e._delegate)}},go=class extends po{data(e){let n=this._delegate.data(e);return this._delegate._converter||fR(n!==void 0,"Document in a QueryDocumentSnapshot should exist"),n}},mo=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new gc(e)}where(e,n,r){try{return new t(this.firestore,li(this._delegate,ck(e,n,r)))}catch(i){throw en(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new t(this.firestore,li(this._delegate,lk(e,n)))}catch(r){throw en(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new t(this.firestore,li(this._delegate,uk(e)))}catch(n){throw en(n,"limit()","Query.limit()")}}limitToLast(e){try{return new t(this.firestore,li(this._delegate,dk(e)))}catch(n){throw en(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new t(this.firestore,li(this._delegate,hk(...e)))}catch(n){throw en(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new t(this.firestore,li(this._delegate,fk(...e)))}catch(n){throw en(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new t(this.firestore,li(this._delegate,pk(...e)))}catch(n){throw en(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new t(this.firestore,li(this._delegate,gk(...e)))}catch(n){throw en(n,"endAt()","Query.endAt()")}}isEqual(e){return aC(this._delegate,e._delegate)}get(e){let n;return e?.source==="cache"?n=Ek(this._delegate):e?.source==="server"?n=Ck(this._delegate):n=wk(this._delegate),n.then(r=>new id(this.firestore,new ir(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let n=Ok(e),r=Fk(e,i=>new id(this.firestore,new ir(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return gC(this._delegate,n,r)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(mc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},vC=class{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new go(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},id=class{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new mo(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new go(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new vC(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new go(this._firestore,r))})}isEqual(e){return hC(this._delegate,e._delegate)}},_c=class t extends mo{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new kr(this.firestore,e):null}doc(e){try{return e===void 0?new kr(this.firestore,rd(this._delegate)):new kr(this.firestore,rd(this._delegate,e))}catch(n){throw en(n,"doc()","CollectionReference.doc()")}}add(e){return bk(this._delegate,e).then(n=>new kr(this.firestore,n))}isEqual(e){return oC(this._delegate,e._delegate)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(mc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function fo(t){return Ee(t,Fe)}var xC=class t{constructor(...e){this._delegate=new rr(...e)}static documentId(){return new t(Xe.keyField().canonicalString())}isEqual(e){return e=fe(e),e instanceof rr?this._delegate._internalPath.isEqual(e._internalPath):!1}};var wC=class t{constructor(e){this._delegate=e}static serverTimestamp(){let e=Ak();return e._methodName="FieldValue.serverTimestamp",new t(e)}static delete(){let e=Sk();return e._methodName="FieldValue.delete",new t(e)}static arrayUnion(...e){let n=Mk(...e);return n._methodName="FieldValue.arrayUnion",new t(n)}static arrayRemove(...e){let n=Nk(...e);return n._methodName="FieldValue.arrayRemove",new t(n)}static increment(e){let n=Rk(e);return n._methodName="FieldValue.increment",new t(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var j$={Firestore:Kg,GeoPoint:oo,Timestamp:He,Blob:Wg,Transaction:Qg,WriteBatch:Yg,DocumentReference:kr,DocumentSnapshot:po,Query:mo,QueryDocumentSnapshot:go,QuerySnapshot:id,CollectionReference:_c,FieldPath:xC,FieldValue:wC,setLogLevel:L$,CACHE_SIZE_UNLIMITED:HP};function B$(t,e){t.INTERNAL.registerComponent(new pn("firestore-compat",n=>{let r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},j$)))}function U$(t){B$(t,(e,n)=>new Kg(e,n,new yC)),t.registerVersion(O$,F$)}U$(St);function $$(t,e=gs){return new ae(n=>{let r;return e!=null?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}function Vk(t,e){return $$(t,e)}function H$(t,e){return Vk(t,e).pipe(_s(void 0),Qc(),B(n=>{let[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function bC(t,e){return Vk(t,e).pipe(B(n=>({payload:n,type:"query"})))}var Zg=class{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){let r=this.ref.collection(e),{ref:i,query:s}=Bk(r,n);return new Jg(i,s,this.afs)}snapshotChanges(){return H$(this.ref,this.afs.schedulers.outsideAngular).pipe(Ye)}valueChanges(e={}){return this.snapshotChanges().pipe(B(({payload:n})=>e.idField?oe(A({},n.data()),{[e.idField]:n.id}):n.data()))}get(e){return Ce(this.ref.get(e)).pipe(Ye)}};function Xg(t,e){return bC(t,e).pipe(_s(void 0),Qc(),B(n=>{let[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,c)=>{let l=s.find(d=>d.doc.ref.isEqual(a.ref)),u=r?.payload.docs.find(d=>d.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&u&&JSON.stringify(u.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),o}))}function Lk(t,e,n){return Xg(t,n).pipe(lr((r,i)=>q$(r,i.map(s=>s.payload),e),[]),Wc(),B(r=>r.map(i=>({type:i.type,payload:i}))))}function q$(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=G$(t,r))}),t}function CC(t,e,n,...r){let i=t.slice();return i.splice(e,n,...r),i}function G$(t,e){switch(e.type){case"added":if(!(t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)))return CC(t,e.newIndex,0,e);break;case"modified":if(t[e.oldIndex]==null||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}else return CC(t,e.newIndex,1,e);break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return CC(t,e.oldIndex,1);break}return t}function jk(t){return(!t||t.length===0)&&(t=["added","removed","modified"]),t}var Jg=class{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=Xg(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(B(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(_s(void 0),Qc(),Nt(([r,i])=>i.length>0||!r),B(([,r])=>r),Ye)}auditTrail(e){return this.stateChanges(e).pipe(lr((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=jk(e);return Lk(this.query,n,this.afs.schedulers.outsideAngular).pipe(Ye)}valueChanges(e={}){return bC(this.query,this.afs.schedulers.outsideAngular).pipe(B(n=>n.payload.docs.map(r=>e.idField?oe(A({},r.data()),{[e.idField]:r.id}):r.data())),Ye)}get(e){return Ce(this.query.get(e)).pipe(Ye)}add(e){return this.ref.add(e)}doc(e){return new Zg(this.ref.doc(e),this.afs)}},IC=class{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return!e||e.length===0?Xg(this.query,this.afs.schedulers.outsideAngular).pipe(Ye):Xg(this.query,this.afs.schedulers.outsideAngular).pipe(B(n=>n.filter(r=>e.indexOf(r.type)>-1)),Nt(n=>n.length>0),Ye)}auditTrail(e){return this.stateChanges(e).pipe(lr((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=jk(e);return Lk(this.query,n,this.afs.schedulers.outsideAngular).pipe(Ye)}valueChanges(e={}){return bC(this.query,this.afs.schedulers.outsideAngular).pipe(B(r=>r.payload.docs.map(i=>e.idField?A({[e.idField]:i.id},i.data()):i.data())),Ye)}get(e){return Ce(this.query.get(e)).pipe(Ye)}},z$=new O("angularfire2.enableFirestorePersistence"),W$=new O("angularfire2.firestore.persistenceSettings"),K$=new O("angularfire2.firestore.settings"),Q$=new O("angularfire2.firestore.use-emulator");function Bk(t,e=n=>n){return{query:e(t),ref:t}}var yc=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,c,l,u,d,h,f,p,m,v,b,F){this.schedulers=c;let S=Ls(n,a,r),q=u;d&&Kl(S,a,h,p,m,v,f,b),[this.firestore,this.persistenceEnabled$]=ba(`${S.name}.firestore`,"AngularFirestore",S.name,()=>{let K=a.runOutsideAngular(()=>S.firestore());if(s&&K.settings(s),q&&K.useEmulator(...q),i&&!Rs(o)){let X=()=>{try{return Ce(K.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(Me){return typeof console<"u"&&console.warn(Me),U(!1)}};return[K,a.runOutsideAngular(X)]}else return[K,U(!1)]},[s,q,i])}collection(n,r){let i;typeof n=="string"?i=this.firestore.collection(n):i=n;let{ref:s,query:o}=Bk(i,r),a=this.schedulers.ngZone.run(()=>s);return new Jg(a,o,this)}collectionGroup(n,r){let i=r||(o=>o),s=this.firestore.collectionGroup(n);return new IC(i(s),this)}doc(n){let r;typeof n=="string"?r=this.firestore.doc(n):r=n;let i=this.schedulers.ngZone.run(()=>r);return new Zg(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(C(Ri),C(Pi,8),C(z$,8),C(K$,8),C(Lt),C(ge),C(Ia),C(W$,8),C(Q$,8),C(rp,8),C($l,8),C(Hl,8),C(ql,8),C(Gl,8),C(zl,8),C(Wl,8),C(Xr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var em=(()=>{let e=class e{constructor(r){this.firestore=r}getTransacciones(){return g(this,null,function*(){return yield this.parseData(this.firestore.collection("transacciones").snapshotChanges())})}getTransaccionById(r){return g(this,null,function*(){return(yield this.parseData(this.firestore.collection("transacciones",s=>s.where("id","==",r)).snapshotChanges()))[0]})}parseData(r){let i=[];return new Promise(s=>{r.subscribe(o=>{i=o.map(a=>oe(A({},a.payload.doc.data()),{id:a.payload.doc.id})),s(i)})})}createTransaccion(r){return g(this,null,function*(){return yield this.firestore.collection("transacciones").add(Object.assign({},r))})}updateTransaccion(r){return g(this,null,function*(){yield this.firestore.doc("transacciones/"+r.id).update(r)})}deleteTransaccion(r){return g(this,null,function*(){yield this.firestore.doc("transacciones/"+r).delete()})}};e.\u0275fac=function(i){return new(i||e)(C(yc))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var $k=(()=>{let e=class e{constructor(r,i){this.firestore=r,this.transaccionService=i}getCoches(){return g(this,null,function*(){return yield this.parseData(this.firestore.collection("coches").snapshotChanges())})}getCocheById(r){return g(this,null,function*(){return new Promise(i=>{this.firestore.doc("coches/"+r).valueChanges().subscribe(s=>{i(oe(A({},s),{id:r}))})})})}parseData(r){let i=[];return new Promise(s=>{r.subscribe(o=>{i=o.map(a=>oe(A({},a.payload.doc.data()),{id:a.payload.doc.id})),s(i)})})}addTransaccion(r,i){return g(this,null,function*(){let s=yield this.getCocheById(r);s.transacciones.push(i),yield this.updateCoche(s)})}sellCoche(r,i,s,o){return g(this,null,function*(){let a=yield this.getCocheById(r);a.vendido=!0;let c=yield this.transaccionService.createTransaccion(new Fs({fecha:new Date().toLocaleString(),precio:a.precio,metodoPago:o,coche:r,cliente:i,tipo:"venta"})),{id:l}=yield c.get();yield this.addTransaccion(r,l),yield this.updateCoche(a)})}createCoche(r){return g(this,null,function*(){return yield this.firestore.collection("coches").add(Object.assign({},r))})}updateCoche(r){return g(this,null,function*(){yield this.firestore.doc("coches/"+r.id).update(r)})}deleteCoche(r){return g(this,null,function*(){console.log(...Z$("420197562_131_4_131_24_4",r)),yield this.firestore.doc("coches/"+r).delete()})}};e.\u0275fac=function(i){return new(i||e)(C(yc),C(em))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Y$(){try{return(0,eval)("globalThis._console_ninja")||(0,eval)(`/* https://github.com/wallabyjs/console-ninja#how-does-it-work */'use strict';var _0x3e00e0=_0x4050;(function(_0x1495ec,_0x1c7fcc){var _0x5affcb=_0x4050,_0x4b80e2=_0x1495ec();while(!![]){try{var _0xd8dcae=parseInt(_0x5affcb(0x210))/0x1*(parseInt(_0x5affcb(0x284))/0x2)+-parseInt(_0x5affcb(0x255))/0x3+parseInt(_0x5affcb(0x239))/0x4+-parseInt(_0x5affcb(0x234))/0x5+parseInt(_0x5affcb(0x243))/0x6+-parseInt(_0x5affcb(0x260))/0x7*(-parseInt(_0x5affcb(0x1d5))/0x8)+-parseInt(_0x5affcb(0x1b2))/0x9;if(_0xd8dcae===_0x1c7fcc)break;else _0x4b80e2['push'](_0x4b80e2['shift']());}catch(_0x25996e){_0x4b80e2['push'](_0x4b80e2['shift']());}}}(_0x3ba1,0xbdbe5));var j=Object[_0x3e00e0(0x296)],H=Object[_0x3e00e0(0x1bc)],G=Object[_0x3e00e0(0x29f)],ee=Object[_0x3e00e0(0x254)],te=Object[_0x3e00e0(0x269)],ne=Object[_0x3e00e0(0x1ec)][_0x3e00e0(0x253)],re=(_0x5f4893,_0x512f21,_0x525e3a,_0x408afa)=>{var _0x14b3bd=_0x3e00e0;if(_0x512f21&&typeof _0x512f21==_0x14b3bd(0x22e)||typeof _0x512f21==_0x14b3bd(0x24e)){for(let _0x7522c9 of ee(_0x512f21))!ne['call'](_0x5f4893,_0x7522c9)&&_0x7522c9!==_0x525e3a&&H(_0x5f4893,_0x7522c9,{'get':()=>_0x512f21[_0x7522c9],'enumerable':!(_0x408afa=G(_0x512f21,_0x7522c9))||_0x408afa[_0x14b3bd(0x1d6)]});}return _0x5f4893;},x=(_0x1fc85e,_0xced39c,_0x4eee27)=>(_0x4eee27=_0x1fc85e!=null?j(te(_0x1fc85e)):{},re(_0xced39c||!_0x1fc85e||!_0x1fc85e[_0x3e00e0(0x21e)]?H(_0x4eee27,_0x3e00e0(0x223),{'value':_0x1fc85e,'enumerable':!0x0}):_0x4eee27,_0x1fc85e)),X=class{constructor(_0x2f4673,_0x3195b1,_0x2dab36,_0x4b2d9b,_0x3599e5){var _0x3f88e9=_0x3e00e0;this[_0x3f88e9(0x28d)]=_0x2f4673,this['host']=_0x3195b1,this[_0x3f88e9(0x202)]=_0x2dab36,this[_0x3f88e9(0x1f7)]=_0x4b2d9b,this[_0x3f88e9(0x250)]=_0x3599e5,this[_0x3f88e9(0x1ee)]=!0x0,this[_0x3f88e9(0x217)]=!0x0,this[_0x3f88e9(0x258)]=!0x1,this[_0x3f88e9(0x23d)]=!0x1,this[_0x3f88e9(0x1e9)]=_0x2f4673[_0x3f88e9(0x1f4)]?.['env']?.['NEXT_RUNTIME']===_0x3f88e9(0x1d9),this[_0x3f88e9(0x280)]=!this[_0x3f88e9(0x28d)][_0x3f88e9(0x1f4)]?.[_0x3f88e9(0x1d0)]?.['node']&&!this['_inNextEdge'],this[_0x3f88e9(0x290)]=null,this[_0x3f88e9(0x1c3)]=0x0,this[_0x3f88e9(0x1c9)]=0x14,this['_webSocketErrorDocsLink']=_0x3f88e9(0x1ca),this['_sendErrorMessage']=(this[_0x3f88e9(0x280)]?'Console\\x20Ninja\\x20failed\\x20to\\x20send\\x20logs,\\x20refreshing\\x20the\\x20page\\x20may\\x20help;\\x20also\\x20see\\x20':_0x3f88e9(0x1f8))+this['_webSocketErrorDocsLink'];}async[_0x3e00e0(0x23f)](){var _0x4b7b3c=_0x3e00e0;if(this[_0x4b7b3c(0x290)])return this[_0x4b7b3c(0x290)];let _0x2792ff;if(this[_0x4b7b3c(0x280)]||this[_0x4b7b3c(0x1e9)])_0x2792ff=this[_0x4b7b3c(0x28d)][_0x4b7b3c(0x228)];else{if(this[_0x4b7b3c(0x28d)]['process']?.[_0x4b7b3c(0x1cb)])_0x2792ff=this[_0x4b7b3c(0x28d)][_0x4b7b3c(0x1f4)]?.[_0x4b7b3c(0x1cb)];else try{let _0x4b57b1=await import(_0x4b7b3c(0x283));_0x2792ff=(await import((await import(_0x4b7b3c(0x26f)))[_0x4b7b3c(0x25d)](_0x4b57b1[_0x4b7b3c(0x251)](this[_0x4b7b3c(0x1f7)],_0x4b7b3c(0x22d)))['toString']()))['default'];}catch{try{_0x2792ff=require(require('path')[_0x4b7b3c(0x251)](this['nodeModules'],'ws'));}catch{throw new Error(_0x4b7b3c(0x1c7));}}}return this['_WebSocketClass']=_0x2792ff,_0x2792ff;}[_0x3e00e0(0x1d3)](){var _0xa05933=_0x3e00e0;this['_connecting']||this['_connected']||this[_0xa05933(0x1c3)]>=this[_0xa05933(0x1c9)]||(this['_allowedToConnectOnSend']=!0x1,this['_connecting']=!0x0,this[_0xa05933(0x1c3)]++,this[_0xa05933(0x1e1)]=new Promise((_0x6c9c40,_0x3c54db)=>{var _0x57a641=_0xa05933;this['getWebSocketClass']()[_0x57a641(0x221)](_0x4cf87a=>{var _0x2db465=_0x57a641;let _0x1c4c7e=new _0x4cf87a(_0x2db465(0x200)+(!this[_0x2db465(0x280)]&&this[_0x2db465(0x250)]?'gateway.docker.internal':this[_0x2db465(0x1be)])+':'+this[_0x2db465(0x202)]);_0x1c4c7e[_0x2db465(0x1fe)]=()=>{var _0x313f8f=_0x2db465;this[_0x313f8f(0x1ee)]=!0x1,this['_disposeWebsocket'](_0x1c4c7e),this[_0x313f8f(0x213)](),_0x3c54db(new Error(_0x313f8f(0x28e)));},_0x1c4c7e[_0x2db465(0x1b3)]=()=>{var _0x2575de=_0x2db465;this[_0x2575de(0x280)]||_0x1c4c7e['_socket']&&_0x1c4c7e[_0x2575de(0x1ea)][_0x2575de(0x207)]&&_0x1c4c7e[_0x2575de(0x1ea)][_0x2575de(0x207)](),_0x6c9c40(_0x1c4c7e);},_0x1c4c7e[_0x2db465(0x22a)]=()=>{var _0x3e01a0=_0x2db465;this[_0x3e01a0(0x217)]=!0x0,this['_disposeWebsocket'](_0x1c4c7e),this['_attemptToReconnectShortly']();},_0x1c4c7e['onmessage']=_0x1886d4=>{var _0x115305=_0x2db465;try{_0x1886d4&&_0x1886d4[_0x115305(0x26e)]&&this[_0x115305(0x280)]&&JSON[_0x115305(0x27d)](_0x1886d4['data'])[_0x115305(0x29e)]===_0x115305(0x1b7)&&this['global'][_0x115305(0x263)][_0x115305(0x1b7)]();}catch{}};})[_0x57a641(0x221)](_0xbb9a45=>(this[_0x57a641(0x258)]=!0x0,this[_0x57a641(0x23d)]=!0x1,this[_0x57a641(0x217)]=!0x1,this[_0x57a641(0x1ee)]=!0x0,this[_0x57a641(0x1c3)]=0x0,_0xbb9a45))[_0x57a641(0x1fc)](_0x5d288d=>(this['_connected']=!0x1,this[_0x57a641(0x23d)]=!0x1,console[_0x57a641(0x1c4)]('logger\\x20failed\\x20to\\x20connect\\x20to\\x20host,\\x20see\\x20'+this['_webSocketErrorDocsLink']),_0x3c54db(new Error('failed\\x20to\\x20connect\\x20to\\x20host:\\x20'+(_0x5d288d&&_0x5d288d[_0x57a641(0x295)])))));}));}['_disposeWebsocket'](_0x411a98){var _0x1173cc=_0x3e00e0;this[_0x1173cc(0x258)]=!0x1,this[_0x1173cc(0x23d)]=!0x1;try{_0x411a98['onclose']=null,_0x411a98['onerror']=null,_0x411a98['onopen']=null;}catch{}try{_0x411a98[_0x1173cc(0x216)]<0x2&&_0x411a98[_0x1173cc(0x25e)]();}catch{}}[_0x3e00e0(0x213)](){var _0x463729=_0x3e00e0;clearTimeout(this['_reconnectTimeout']),!(this['_connectAttemptCount']>=this[_0x463729(0x1c9)])&&(this[_0x463729(0x242)]=setTimeout(()=>{var _0x5bf991=_0x463729;this[_0x5bf991(0x258)]||this[_0x5bf991(0x23d)]||(this[_0x5bf991(0x1d3)](),this[_0x5bf991(0x1e1)]?.['catch'](()=>this[_0x5bf991(0x213)]()));},0x1f4),this[_0x463729(0x242)][_0x463729(0x207)]&&this[_0x463729(0x242)][_0x463729(0x207)]());}async[_0x3e00e0(0x219)](_0x47f47a){var _0x70e9e4=_0x3e00e0;try{if(!this['_allowedToSend'])return;this[_0x70e9e4(0x217)]&&this['_connectToHostNow'](),(await this[_0x70e9e4(0x1e1)])[_0x70e9e4(0x219)](JSON[_0x70e9e4(0x1bf)](_0x47f47a));}catch(_0x385094){console[_0x70e9e4(0x1c4)](this[_0x70e9e4(0x24c)]+':\\x20'+(_0x385094&&_0x385094[_0x70e9e4(0x295)])),this['_allowedToSend']=!0x1,this['_attemptToReconnectShortly']();}}};function b(_0x1985ee,_0x14e652,_0x511de9,_0x533eb3,_0x2a9f03,_0x502cf1){var _0x2f507c=_0x3e00e0;let _0x3d6d95=_0x511de9[_0x2f507c(0x28b)](',')[_0x2f507c(0x29b)](_0x204c57=>{var _0x3cc821=_0x2f507c;try{_0x1985ee[_0x3cc821(0x1ef)]||((_0x2a9f03===_0x3cc821(0x276)||_0x2a9f03==='remix'||_0x2a9f03===_0x3cc821(0x1d4)||_0x2a9f03===_0x3cc821(0x289))&&(_0x2a9f03+=!_0x1985ee['process']?.[_0x3cc821(0x1d0)]?.['node']&&_0x1985ee[_0x3cc821(0x1f4)]?.[_0x3cc821(0x1c1)]?.[_0x3cc821(0x23e)]!==_0x3cc821(0x1d9)?_0x3cc821(0x1d1):_0x3cc821(0x264)),_0x1985ee[_0x3cc821(0x1ef)]={'id':+new Date(),'tool':_0x2a9f03});let _0x172705=new X(_0x1985ee,_0x14e652,_0x204c57,_0x533eb3,_0x502cf1);return _0x172705[_0x3cc821(0x219)][_0x3cc821(0x1ce)](_0x172705);}catch(_0x23df2b){return console[_0x3cc821(0x1c4)]('logger\\x20failed\\x20to\\x20connect\\x20to\\x20host',_0x23df2b&&_0x23df2b[_0x3cc821(0x295)]),()=>{};}});return _0x1ac5bc=>_0x3d6d95[_0x2f507c(0x21a)](_0xf8150e=>_0xf8150e(_0x1ac5bc));}function W(_0x423b66){var _0x4e4618=_0x3e00e0;let _0x1fae98=function(_0x4570c9,_0x5c2ec0){return _0x5c2ec0-_0x4570c9;},_0x3e26ef;if(_0x423b66[_0x4e4618(0x224)])_0x3e26ef=function(){var _0x592362=_0x4e4618;return _0x423b66[_0x592362(0x224)]['now']();};else{if(_0x423b66['process']&&_0x423b66[_0x4e4618(0x1f4)][_0x4e4618(0x205)]&&_0x423b66[_0x4e4618(0x1f4)]?.[_0x4e4618(0x1c1)]?.['NEXT_RUNTIME']!=='edge')_0x3e26ef=function(){var _0x54573e=_0x4e4618;return _0x423b66['process'][_0x54573e(0x205)]();},_0x1fae98=function(_0xd38af4,_0xedcc6f){return 0x3e8*(_0xedcc6f[0x0]-_0xd38af4[0x0])+(_0xedcc6f[0x1]-_0xd38af4[0x1])/0xf4240;};else try{let {performance:_0x2c1e88}=require(_0x4e4618(0x225));_0x3e26ef=function(){var _0x5f4815=_0x4e4618;return _0x2c1e88[_0x5f4815(0x24d)]();};}catch{_0x3e26ef=function(){return+new Date();};}}return{'elapsed':_0x1fae98,'timeStamp':_0x3e26ef,'now':()=>Date[_0x4e4618(0x24d)]()};}function J(_0x3a0d4d,_0x2c315c,_0x15812b){var _0x47306e=_0x3e00e0;if(_0x3a0d4d[_0x47306e(0x28a)]!==void 0x0)return _0x3a0d4d['_consoleNinjaAllowedToStart'];let _0x332e2d=_0x3a0d4d[_0x47306e(0x1f4)]?.[_0x47306e(0x1d0)]?.['node']||_0x3a0d4d[_0x47306e(0x1f4)]?.[_0x47306e(0x1c1)]?.[_0x47306e(0x23e)]===_0x47306e(0x1d9);return _0x332e2d&&_0x15812b==='nuxt'?_0x3a0d4d[_0x47306e(0x28a)]=!0x1:_0x3a0d4d[_0x47306e(0x28a)]=_0x332e2d||!_0x2c315c||_0x3a0d4d[_0x47306e(0x263)]?.[_0x47306e(0x218)]&&_0x2c315c['includes'](_0x3a0d4d[_0x47306e(0x263)][_0x47306e(0x218)]),_0x3a0d4d[_0x47306e(0x28a)];}function Y(_0x215415,_0x243cf5,_0x414e35,_0x12e098){var _0x580cf2=_0x3e00e0;_0x215415=_0x215415,_0x243cf5=_0x243cf5,_0x414e35=_0x414e35,_0x12e098=_0x12e098;let _0x32d079=W(_0x215415),_0x1e922d=_0x32d079[_0x580cf2(0x20e)],_0x19745e=_0x32d079[_0x580cf2(0x277)];class _0x39411a{constructor(){var _0x21380a=_0x580cf2;this['_keyStrRegExp']=/^(?!(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$)[_$a-zA-Z\\xA0-\\uFFFF][_$a-zA-Z0-9\\xA0-\\uFFFF]*$/,this['_numberRegExp']=/^(0|[1-9][0-9]*)$/,this['_quotedRegExp']=/'([^\\\\']|\\\\')*'/,this[_0x21380a(0x20b)]=_0x215415[_0x21380a(0x1f3)],this['_HTMLAllCollection']=_0x215415[_0x21380a(0x209)],this['_getOwnPropertyDescriptor']=Object['getOwnPropertyDescriptor'],this['_getOwnPropertyNames']=Object[_0x21380a(0x254)],this['_Symbol']=_0x215415['Symbol'],this['_regExpToString']=RegExp['prototype'][_0x21380a(0x28c)],this[_0x21380a(0x24f)]=Date['prototype']['toString'];}['serialize'](_0x5c006d,_0x1810c9,_0x2c7546,_0x4c5987){var _0x12ffaa=_0x580cf2,_0x511889=this,_0x5d43f0=_0x2c7546[_0x12ffaa(0x21f)];function _0x1713c1(_0x690af5,_0x3df467,_0x50524c){var _0x3fad0b=_0x12ffaa;_0x3df467[_0x3fad0b(0x287)]=_0x3fad0b(0x237),_0x3df467[_0x3fad0b(0x230)]=_0x690af5[_0x3fad0b(0x295)],_0x5dc1a0=_0x50524c[_0x3fad0b(0x1eb)]['current'],_0x50524c['node'][_0x3fad0b(0x25a)]=_0x3df467,_0x511889[_0x3fad0b(0x27c)](_0x3df467,_0x50524c);}try{_0x2c7546['level']++,_0x2c7546[_0x12ffaa(0x21f)]&&_0x2c7546[_0x12ffaa(0x1ff)][_0x12ffaa(0x1f9)](_0x1810c9);var _0x5c41ed,_0x396633,_0x19f036,_0x37ba38,_0x529025=[],_0x41636a=[],_0x274ceb,_0x45533b=this[_0x12ffaa(0x1e7)](_0x1810c9),_0x1e5560=_0x45533b==='array',_0x12a821=!0x1,_0x45cc3c=_0x45533b==='function',_0x241b8d=this[_0x12ffaa(0x28f)](_0x45533b),_0x445f9b=this['_isPrimitiveWrapperType'](_0x45533b),_0x536c33=_0x241b8d||_0x445f9b,_0x2943ac={},_0x5cc79c=0x0,_0x5e7a19=!0x1,_0x5dc1a0,_0x26b99e=/^(([1-9]{1}[0-9]*)|0)$/;if(_0x2c7546[_0x12ffaa(0x227)]){if(_0x1e5560){if(_0x396633=_0x1810c9['length'],_0x396633>_0x2c7546[_0x12ffaa(0x1e3)]){for(_0x19f036=0x0,_0x37ba38=_0x2c7546[_0x12ffaa(0x1e3)],_0x5c41ed=_0x19f036;_0x5c41ed<_0x37ba38;_0x5c41ed++)_0x41636a['push'](_0x511889[_0x12ffaa(0x1da)](_0x529025,_0x1810c9,_0x45533b,_0x5c41ed,_0x2c7546));_0x5c006d['cappedElements']=!0x0;}else{for(_0x19f036=0x0,_0x37ba38=_0x396633,_0x5c41ed=_0x19f036;_0x5c41ed<_0x37ba38;_0x5c41ed++)_0x41636a['push'](_0x511889['_addProperty'](_0x529025,_0x1810c9,_0x45533b,_0x5c41ed,_0x2c7546));}_0x2c7546[_0x12ffaa(0x26d)]+=_0x41636a[_0x12ffaa(0x257)];}if(!(_0x45533b===_0x12ffaa(0x293)||_0x45533b==='undefined')&&!_0x241b8d&&_0x45533b!==_0x12ffaa(0x1db)&&_0x45533b!==_0x12ffaa(0x27a)&&_0x45533b!==_0x12ffaa(0x1fd)){var _0x14cb11=_0x4c5987['props']||_0x2c7546[_0x12ffaa(0x1e2)];if(this[_0x12ffaa(0x278)](_0x1810c9)?(_0x5c41ed=0x0,_0x1810c9[_0x12ffaa(0x21a)](function(_0x36d817){var _0x238c11=_0x12ffaa;if(_0x5cc79c++,_0x2c7546[_0x238c11(0x26d)]++,_0x5cc79c>_0x14cb11){_0x5e7a19=!0x0;return;}if(!_0x2c7546[_0x238c11(0x259)]&&_0x2c7546[_0x238c11(0x21f)]&&_0x2c7546[_0x238c11(0x26d)]>_0x2c7546[_0x238c11(0x1c0)]){_0x5e7a19=!0x0;return;}_0x41636a[_0x238c11(0x1f9)](_0x511889[_0x238c11(0x1da)](_0x529025,_0x1810c9,_0x238c11(0x1f5),_0x5c41ed++,_0x2c7546,function(_0x38081e){return function(){return _0x38081e;};}(_0x36d817)));})):this[_0x12ffaa(0x1cd)](_0x1810c9)&&_0x1810c9[_0x12ffaa(0x21a)](function(_0xbcc0fe,_0x5f49cf){var _0x4eb0de=_0x12ffaa;if(_0x5cc79c++,_0x2c7546['autoExpandPropertyCount']++,_0x5cc79c>_0x14cb11){_0x5e7a19=!0x0;return;}if(!_0x2c7546[_0x4eb0de(0x259)]&&_0x2c7546[_0x4eb0de(0x21f)]&&_0x2c7546[_0x4eb0de(0x26d)]>_0x2c7546[_0x4eb0de(0x1c0)]){_0x5e7a19=!0x0;return;}var _0x2a1875=_0x5f49cf['toString']();_0x2a1875[_0x4eb0de(0x257)]>0x64&&(_0x2a1875=_0x2a1875[_0x4eb0de(0x267)](0x0,0x64)+_0x4eb0de(0x1e6)),_0x41636a[_0x4eb0de(0x1f9)](_0x511889[_0x4eb0de(0x1da)](_0x529025,_0x1810c9,_0x4eb0de(0x238),_0x2a1875,_0x2c7546,function(_0x349c20){return function(){return _0x349c20;};}(_0xbcc0fe)));}),!_0x12a821){try{for(_0x274ceb in _0x1810c9)if(!(_0x1e5560&&_0x26b99e['test'](_0x274ceb))&&!this[_0x12ffaa(0x1c2)](_0x1810c9,_0x274ceb,_0x2c7546)){if(_0x5cc79c++,_0x2c7546[_0x12ffaa(0x26d)]++,_0x5cc79c>_0x14cb11){_0x5e7a19=!0x0;break;}if(!_0x2c7546[_0x12ffaa(0x259)]&&_0x2c7546[_0x12ffaa(0x21f)]&&_0x2c7546[_0x12ffaa(0x26d)]>_0x2c7546[_0x12ffaa(0x1c0)]){_0x5e7a19=!0x0;break;}_0x41636a[_0x12ffaa(0x1f9)](_0x511889['_addObjectProperty'](_0x529025,_0x2943ac,_0x1810c9,_0x45533b,_0x274ceb,_0x2c7546));}}catch{}if(_0x2943ac[_0x12ffaa(0x292)]=!0x0,_0x45cc3c&&(_0x2943ac[_0x12ffaa(0x20c)]=!0x0),!_0x5e7a19){var _0x135ef8=[][_0x12ffaa(0x1d7)](this[_0x12ffaa(0x226)](_0x1810c9))[_0x12ffaa(0x1d7)](this['_getOwnPropertySymbols'](_0x1810c9));for(_0x5c41ed=0x0,_0x396633=_0x135ef8[_0x12ffaa(0x257)];_0x5c41ed<_0x396633;_0x5c41ed++)if(_0x274ceb=_0x135ef8[_0x5c41ed],!(_0x1e5560&&_0x26b99e['test'](_0x274ceb['toString']()))&&!this['_blacklistedProperty'](_0x1810c9,_0x274ceb,_0x2c7546)&&!_0x2943ac[_0x12ffaa(0x24b)+_0x274ceb['toString']()]){if(_0x5cc79c++,_0x2c7546[_0x12ffaa(0x26d)]++,_0x5cc79c>_0x14cb11){_0x5e7a19=!0x0;break;}if(!_0x2c7546[_0x12ffaa(0x259)]&&_0x2c7546[_0x12ffaa(0x21f)]&&_0x2c7546['autoExpandPropertyCount']>_0x2c7546[_0x12ffaa(0x1c0)]){_0x5e7a19=!0x0;break;}_0x41636a[_0x12ffaa(0x1f9)](_0x511889[_0x12ffaa(0x21c)](_0x529025,_0x2943ac,_0x1810c9,_0x45533b,_0x274ceb,_0x2c7546));}}}}}if(_0x5c006d[_0x12ffaa(0x287)]=_0x45533b,_0x536c33?(_0x5c006d['value']=_0x1810c9[_0x12ffaa(0x273)](),this[_0x12ffaa(0x1ba)](_0x45533b,_0x5c006d,_0x2c7546,_0x4c5987)):_0x45533b===_0x12ffaa(0x1b9)?_0x5c006d[_0x12ffaa(0x20f)]=this[_0x12ffaa(0x24f)][_0x12ffaa(0x235)](_0x1810c9):_0x45533b===_0x12ffaa(0x1fd)?_0x5c006d[_0x12ffaa(0x20f)]=_0x1810c9[_0x12ffaa(0x28c)]():_0x45533b===_0x12ffaa(0x1e5)?_0x5c006d[_0x12ffaa(0x20f)]=this[_0x12ffaa(0x26c)]['call'](_0x1810c9):_0x45533b===_0x12ffaa(0x1b4)&&this[_0x12ffaa(0x1fa)]?_0x5c006d['value']=this[_0x12ffaa(0x1fa)][_0x12ffaa(0x1ec)][_0x12ffaa(0x28c)][_0x12ffaa(0x235)](_0x1810c9):!_0x2c7546[_0x12ffaa(0x227)]&&!(_0x45533b===_0x12ffaa(0x293)||_0x45533b===_0x12ffaa(0x1f3))&&(delete _0x5c006d[_0x12ffaa(0x20f)],_0x5c006d[_0x12ffaa(0x1cf)]=!0x0),_0x5e7a19&&(_0x5c006d[_0x12ffaa(0x291)]=!0x0),_0x5dc1a0=_0x2c7546['node'][_0x12ffaa(0x25a)],_0x2c7546[_0x12ffaa(0x1eb)][_0x12ffaa(0x25a)]=_0x5c006d,this['_treeNodePropertiesBeforeFullValue'](_0x5c006d,_0x2c7546),_0x41636a[_0x12ffaa(0x257)]){for(_0x5c41ed=0x0,_0x396633=_0x41636a[_0x12ffaa(0x257)];_0x5c41ed<_0x396633;_0x5c41ed++)_0x41636a[_0x5c41ed](_0x5c41ed);}_0x529025[_0x12ffaa(0x257)]&&(_0x5c006d[_0x12ffaa(0x1e2)]=_0x529025);}catch(_0x166c54){_0x1713c1(_0x166c54,_0x5c006d,_0x2c7546);}return this[_0x12ffaa(0x23b)](_0x1810c9,_0x5c006d),this[_0x12ffaa(0x21d)](_0x5c006d,_0x2c7546),_0x2c7546['node'][_0x12ffaa(0x25a)]=_0x5dc1a0,_0x2c7546[_0x12ffaa(0x204)]--,_0x2c7546['autoExpand']=_0x5d43f0,_0x2c7546[_0x12ffaa(0x21f)]&&_0x2c7546[_0x12ffaa(0x1ff)][_0x12ffaa(0x29c)](),_0x5c006d;}[_0x580cf2(0x274)](_0x15a2f5){var _0x3dc735=_0x580cf2;return Object[_0x3dc735(0x294)]?Object['getOwnPropertySymbols'](_0x15a2f5):[];}[_0x580cf2(0x278)](_0x9424f3){var _0x223148=_0x580cf2;return!!(_0x9424f3&&_0x215415[_0x223148(0x1f5)]&&this[_0x223148(0x1df)](_0x9424f3)===_0x223148(0x236)&&_0x9424f3[_0x223148(0x21a)]);}['_blacklistedProperty'](_0x148cb6,_0x4329c6,_0x5c6870){var _0x179a4c=_0x580cf2;return _0x5c6870[_0x179a4c(0x233)]?typeof _0x148cb6[_0x4329c6]=='function':!0x1;}[_0x580cf2(0x1e7)](_0x10e05e){var _0x56913d=_0x580cf2,_0x5b3420='';return _0x5b3420=typeof _0x10e05e,_0x5b3420===_0x56913d(0x22e)?this[_0x56913d(0x1df)](_0x10e05e)==='[object\\x20Array]'?_0x5b3420=_0x56913d(0x222):this[_0x56913d(0x1df)](_0x10e05e)===_0x56913d(0x25b)?_0x5b3420=_0x56913d(0x1b9):this[_0x56913d(0x1df)](_0x10e05e)===_0x56913d(0x1e0)?_0x5b3420=_0x56913d(0x1fd):_0x10e05e===null?_0x5b3420=_0x56913d(0x293):_0x10e05e[_0x56913d(0x1c8)]&&(_0x5b3420=_0x10e05e[_0x56913d(0x1c8)]['name']||_0x5b3420):_0x5b3420===_0x56913d(0x1f3)&&this[_0x56913d(0x271)]&&_0x10e05e instanceof this['_HTMLAllCollection']&&(_0x5b3420=_0x56913d(0x209)),_0x5b3420;}[_0x580cf2(0x1df)](_0x2430eb){var _0x2de4e4=_0x580cf2;return Object[_0x2de4e4(0x1ec)][_0x2de4e4(0x28c)]['call'](_0x2430eb);}['_isPrimitiveType'](_0x2254c7){var _0x717faf=_0x580cf2;return _0x2254c7===_0x717faf(0x285)||_0x2254c7==='string'||_0x2254c7==='number';}[_0x580cf2(0x298)](_0x33b761){var _0x5de3c4=_0x580cf2;return _0x33b761===_0x5de3c4(0x27e)||_0x33b761==='String'||_0x33b761===_0x5de3c4(0x286);}[_0x580cf2(0x1da)](_0x1403a4,_0x33b3c9,_0x5c5969,_0x4ca4d9,_0x1f9f89,_0x23e785){var _0x172523=this;return function(_0x552a4e){var _0x4ac5cf=_0x4050,_0x149bdc=_0x1f9f89[_0x4ac5cf(0x1eb)]['current'],_0xf3bf8e=_0x1f9f89[_0x4ac5cf(0x1eb)][_0x4ac5cf(0x246)],_0x289fa8=_0x1f9f89[_0x4ac5cf(0x1eb)][_0x4ac5cf(0x299)];_0x1f9f89['node'][_0x4ac5cf(0x299)]=_0x149bdc,_0x1f9f89[_0x4ac5cf(0x1eb)][_0x4ac5cf(0x246)]=typeof _0x4ca4d9=='number'?_0x4ca4d9:_0x552a4e,_0x1403a4[_0x4ac5cf(0x1f9)](_0x172523['_property'](_0x33b3c9,_0x5c5969,_0x4ca4d9,_0x1f9f89,_0x23e785)),_0x1f9f89[_0x4ac5cf(0x1eb)][_0x4ac5cf(0x299)]=_0x289fa8,_0x1f9f89[_0x4ac5cf(0x1eb)][_0x4ac5cf(0x246)]=_0xf3bf8e;};}['_addObjectProperty'](_0x45d005,_0x25a8bd,_0x2941ae,_0x334bb9,_0x2e1f95,_0x2c63f7,_0x346ff2){var _0x3393ba=_0x580cf2,_0x341c11=this;return _0x25a8bd[_0x3393ba(0x24b)+_0x2e1f95[_0x3393ba(0x28c)]()]=!0x0,function(_0x581781){var _0x374460=_0x3393ba,_0x3b6da8=_0x2c63f7['node'][_0x374460(0x25a)],_0x4ef2ee=_0x2c63f7[_0x374460(0x1eb)]['index'],_0x4fe5bb=_0x2c63f7[_0x374460(0x1eb)][_0x374460(0x299)];_0x2c63f7['node']['parent']=_0x3b6da8,_0x2c63f7[_0x374460(0x1eb)][_0x374460(0x246)]=_0x581781,_0x45d005[_0x374460(0x1f9)](_0x341c11[_0x374460(0x1f0)](_0x2941ae,_0x334bb9,_0x2e1f95,_0x2c63f7,_0x346ff2)),_0x2c63f7[_0x374460(0x1eb)][_0x374460(0x299)]=_0x4fe5bb,_0x2c63f7[_0x374460(0x1eb)][_0x374460(0x246)]=_0x4ef2ee;};}[_0x580cf2(0x1f0)](_0x949503,_0x40b535,_0x107e4c,_0x19820a,_0x5c53d8){var _0x2d5853=_0x580cf2,_0x5ab694=this;_0x5c53d8||(_0x5c53d8=function(_0x5f2fcc,_0x206d35){return _0x5f2fcc[_0x206d35];});var _0x1134e9=_0x107e4c['toString'](),_0x14b66d=_0x19820a[_0x2d5853(0x203)]||{},_0x42313b=_0x19820a[_0x2d5853(0x227)],_0x3e99cc=_0x19820a['isExpressionToEvaluate'];try{var _0x3a59ef=this[_0x2d5853(0x1cd)](_0x949503),_0x167d32=_0x1134e9;_0x3a59ef&&_0x167d32[0x0]==='\\x27'&&(_0x167d32=_0x167d32[_0x2d5853(0x1d2)](0x1,_0x167d32[_0x2d5853(0x257)]-0x2));var _0x1746b8=_0x19820a[_0x2d5853(0x203)]=_0x14b66d[_0x2d5853(0x24b)+_0x167d32];_0x1746b8&&(_0x19820a[_0x2d5853(0x227)]=_0x19820a[_0x2d5853(0x227)]+0x1),_0x19820a[_0x2d5853(0x259)]=!!_0x1746b8;var _0x8036e=typeof _0x107e4c=='symbol',_0x1e667b={'name':_0x8036e||_0x3a59ef?_0x1134e9:this[_0x2d5853(0x1bd)](_0x1134e9)};if(_0x8036e&&(_0x1e667b[_0x2d5853(0x1b4)]=!0x0),!(_0x40b535===_0x2d5853(0x222)||_0x40b535===_0x2d5853(0x1de))){var _0x36d41d=this[_0x2d5853(0x1d8)](_0x949503,_0x107e4c);if(_0x36d41d&&(_0x36d41d[_0x2d5853(0x231)]&&(_0x1e667b[_0x2d5853(0x262)]=!0x0),_0x36d41d[_0x2d5853(0x272)]&&!_0x1746b8&&!_0x19820a[_0x2d5853(0x29a)]))return _0x1e667b[_0x2d5853(0x261)]=!0x0,this[_0x2d5853(0x265)](_0x1e667b,_0x19820a),_0x1e667b;}var _0x1ab170;try{_0x1ab170=_0x5c53d8(_0x949503,_0x107e4c);}catch(_0x368958){return _0x1e667b={'name':_0x1134e9,'type':_0x2d5853(0x237),'error':_0x368958['message']},this[_0x2d5853(0x265)](_0x1e667b,_0x19820a),_0x1e667b;}var _0x84ca62=this[_0x2d5853(0x1e7)](_0x1ab170),_0x1ab3e7=this[_0x2d5853(0x28f)](_0x84ca62);if(_0x1e667b[_0x2d5853(0x287)]=_0x84ca62,_0x1ab3e7)this[_0x2d5853(0x265)](_0x1e667b,_0x19820a,_0x1ab170,function(){var _0x423481=_0x2d5853;_0x1e667b[_0x423481(0x20f)]=_0x1ab170[_0x423481(0x273)](),!_0x1746b8&&_0x5ab694[_0x423481(0x1ba)](_0x84ca62,_0x1e667b,_0x19820a,{});});else{var _0xa08ad1=_0x19820a[_0x2d5853(0x21f)]&&_0x19820a['level']<_0x19820a[_0x2d5853(0x27f)]&&_0x19820a[_0x2d5853(0x1ff)][_0x2d5853(0x268)](_0x1ab170)<0x0&&_0x84ca62!==_0x2d5853(0x24e)&&_0x19820a[_0x2d5853(0x26d)]<_0x19820a[_0x2d5853(0x1c0)];_0xa08ad1||_0x19820a[_0x2d5853(0x204)]<_0x42313b||_0x1746b8?(this['serialize'](_0x1e667b,_0x1ab170,_0x19820a,_0x1746b8||{}),this[_0x2d5853(0x23b)](_0x1ab170,_0x1e667b)):this['_processTreeNodeResult'](_0x1e667b,_0x19820a,_0x1ab170,function(){var _0x52fe44=_0x2d5853;_0x84ca62==='null'||_0x84ca62===_0x52fe44(0x1f3)||(delete _0x1e667b[_0x52fe44(0x20f)],_0x1e667b['capped']=!0x0);});}return _0x1e667b;}finally{_0x19820a[_0x2d5853(0x203)]=_0x14b66d,_0x19820a[_0x2d5853(0x227)]=_0x42313b,_0x19820a[_0x2d5853(0x259)]=_0x3e99cc;}}[_0x580cf2(0x1ba)](_0x48c102,_0x234116,_0x1ca502,_0x54835a){var _0x3aaaed=_0x580cf2,_0x133d8f=_0x54835a[_0x3aaaed(0x1c5)]||_0x1ca502['strLength'];if((_0x48c102===_0x3aaaed(0x1dc)||_0x48c102===_0x3aaaed(0x1db))&&_0x234116['value']){let _0x5a33f7=_0x234116[_0x3aaaed(0x20f)][_0x3aaaed(0x257)];_0x1ca502['allStrLength']+=_0x5a33f7,_0x1ca502[_0x3aaaed(0x22b)]>_0x1ca502[_0x3aaaed(0x266)]?(_0x234116['capped']='',delete _0x234116[_0x3aaaed(0x20f)]):_0x5a33f7>_0x133d8f&&(_0x234116['capped']=_0x234116[_0x3aaaed(0x20f)][_0x3aaaed(0x1d2)](0x0,_0x133d8f),delete _0x234116['value']);}}[_0x580cf2(0x1cd)](_0x447e6b){var _0x14a105=_0x580cf2;return!!(_0x447e6b&&_0x215415['Map']&&this[_0x14a105(0x1df)](_0x447e6b)==='[object\\x20Map]'&&_0x447e6b[_0x14a105(0x21a)]);}[_0x580cf2(0x1bd)](_0x1bb517){var _0x47b23d=_0x580cf2;if(_0x1bb517[_0x47b23d(0x24a)](/^\\d+$/))return _0x1bb517;var _0x2659aa;try{_0x2659aa=JSON[_0x47b23d(0x1bf)](''+_0x1bb517);}catch{_0x2659aa='\\x22'+this[_0x47b23d(0x1df)](_0x1bb517)+'\\x22';}return _0x2659aa[_0x47b23d(0x24a)](/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?_0x2659aa=_0x2659aa[_0x47b23d(0x1d2)](0x1,_0x2659aa[_0x47b23d(0x257)]-0x2):_0x2659aa=_0x2659aa[_0x47b23d(0x288)](/'/g,'\\x5c\\x27')[_0x47b23d(0x288)](/\\\\"/g,'\\x22')[_0x47b23d(0x288)](/(^"|"$)/g,'\\x27'),_0x2659aa;}[_0x580cf2(0x265)](_0x4a636c,_0x5984ec,_0x2f6cd2,_0x457c04){var _0x569e80=_0x580cf2;this[_0x569e80(0x27c)](_0x4a636c,_0x5984ec),_0x457c04&&_0x457c04(),this[_0x569e80(0x23b)](_0x2f6cd2,_0x4a636c),this['_treeNodePropertiesAfterFullValue'](_0x4a636c,_0x5984ec);}['_treeNodePropertiesBeforeFullValue'](_0x8e1725,_0x5a6fe4){var _0x4aea0f=_0x580cf2;this[_0x4aea0f(0x247)](_0x8e1725,_0x5a6fe4),this['_setNodeQueryPath'](_0x8e1725,_0x5a6fe4),this['_setNodeExpressionPath'](_0x8e1725,_0x5a6fe4),this[_0x4aea0f(0x245)](_0x8e1725,_0x5a6fe4);}[_0x580cf2(0x247)](_0x53059c,_0x46a130){}[_0x580cf2(0x211)](_0x9a1c3c,_0x4ddcc8){}[_0x580cf2(0x208)](_0x153d8f,_0x1b813e){}[_0x580cf2(0x1fb)](_0x166dd0){var _0x4af6c8=_0x580cf2;return _0x166dd0===this[_0x4af6c8(0x20b)];}[_0x580cf2(0x21d)](_0xb25851,_0x12000f){var _0x35c7b8=_0x580cf2;this['_setNodeLabel'](_0xb25851,_0x12000f),this['_setNodeExpandableState'](_0xb25851),_0x12000f[_0x35c7b8(0x20d)]&&this[_0x35c7b8(0x21b)](_0xb25851),this[_0x35c7b8(0x297)](_0xb25851,_0x12000f),this[_0x35c7b8(0x232)](_0xb25851,_0x12000f),this[_0x35c7b8(0x229)](_0xb25851);}[_0x580cf2(0x23b)](_0x3a692c,_0x34a849){var _0xe0d5e7=_0x580cf2;let _0x3b0162;try{_0x215415[_0xe0d5e7(0x1dd)]&&(_0x3b0162=_0x215415[_0xe0d5e7(0x1dd)]['error'],_0x215415['console']['error']=function(){}),_0x3a692c&&typeof _0x3a692c[_0xe0d5e7(0x257)]==_0xe0d5e7(0x1f1)&&(_0x34a849[_0xe0d5e7(0x257)]=_0x3a692c[_0xe0d5e7(0x257)]);}catch{}finally{_0x3b0162&&(_0x215415['console'][_0xe0d5e7(0x230)]=_0x3b0162);}if(_0x34a849[_0xe0d5e7(0x287)]===_0xe0d5e7(0x1f1)||_0x34a849[_0xe0d5e7(0x287)]===_0xe0d5e7(0x286)){if(isNaN(_0x34a849[_0xe0d5e7(0x20f)]))_0x34a849['nan']=!0x0,delete _0x34a849[_0xe0d5e7(0x20f)];else switch(_0x34a849['value']){case Number[_0xe0d5e7(0x201)]:_0x34a849[_0xe0d5e7(0x22c)]=!0x0,delete _0x34a849['value'];break;case Number[_0xe0d5e7(0x1f6)]:_0x34a849['negativeInfinity']=!0x0,delete _0x34a849[_0xe0d5e7(0x20f)];break;case 0x0:this['_isNegativeZero'](_0x34a849['value'])&&(_0x34a849['negativeZero']=!0x0);break;}}else _0x34a849['type']===_0xe0d5e7(0x24e)&&typeof _0x3a692c[_0xe0d5e7(0x279)]=='string'&&_0x3a692c[_0xe0d5e7(0x279)]&&_0x34a849[_0xe0d5e7(0x279)]&&_0x3a692c['name']!==_0x34a849[_0xe0d5e7(0x279)]&&(_0x34a849[_0xe0d5e7(0x270)]=_0x3a692c['name']);}[_0x580cf2(0x215)](_0x48d840){var _0x58b943=_0x580cf2;return 0x1/_0x48d840===Number[_0x58b943(0x1f6)];}[_0x580cf2(0x21b)](_0x52cab4){var _0x2f97cc=_0x580cf2;!_0x52cab4[_0x2f97cc(0x1e2)]||!_0x52cab4[_0x2f97cc(0x1e2)][_0x2f97cc(0x257)]||_0x52cab4[_0x2f97cc(0x287)]===_0x2f97cc(0x222)||_0x52cab4['type']===_0x2f97cc(0x238)||_0x52cab4['type']==='Set'||_0x52cab4[_0x2f97cc(0x1e2)]['sort'](function(_0x28b6c8,_0x3277ac){var _0x574835=_0x2f97cc,_0x8ddd5a=_0x28b6c8[_0x574835(0x279)][_0x574835(0x1b5)](),_0x5c5bbd=_0x3277ac['name'][_0x574835(0x1b5)]();return _0x8ddd5a<_0x5c5bbd?-0x1:_0x8ddd5a>_0x5c5bbd?0x1:0x0;});}['_addFunctionsNode'](_0x214a8b,_0x2c6909){var _0x9c1f6b=_0x580cf2;if(!(_0x2c6909['noFunctions']||!_0x214a8b['props']||!_0x214a8b[_0x9c1f6b(0x1e2)][_0x9c1f6b(0x257)])){for(var _0x4e67b9=[],_0x5efe0a=[],_0x1f2f67=0x0,_0x44506b=_0x214a8b['props']['length'];_0x1f2f67<_0x44506b;_0x1f2f67++){var _0x479203=_0x214a8b['props'][_0x1f2f67];_0x479203[_0x9c1f6b(0x287)]===_0x9c1f6b(0x24e)?_0x4e67b9[_0x9c1f6b(0x1f9)](_0x479203):_0x5efe0a[_0x9c1f6b(0x1f9)](_0x479203);}if(!(!_0x5efe0a[_0x9c1f6b(0x257)]||_0x4e67b9['length']<=0x1)){_0x214a8b[_0x9c1f6b(0x1e2)]=_0x5efe0a;var _0x31b386={'functionsNode':!0x0,'props':_0x4e67b9};this[_0x9c1f6b(0x247)](_0x31b386,_0x2c6909),this[_0x9c1f6b(0x208)](_0x31b386,_0x2c6909),this[_0x9c1f6b(0x240)](_0x31b386),this[_0x9c1f6b(0x245)](_0x31b386,_0x2c6909),_0x31b386['id']+='\\x20f',_0x214a8b[_0x9c1f6b(0x1e2)][_0x9c1f6b(0x241)](_0x31b386);}}}[_0x580cf2(0x232)](_0x3980e5,_0x378fb1){}[_0x580cf2(0x240)](_0x1bbee1){}[_0x580cf2(0x22f)](_0x59cca2){var _0x3a8c68=_0x580cf2;return Array[_0x3a8c68(0x249)](_0x59cca2)||typeof _0x59cca2==_0x3a8c68(0x22e)&&this[_0x3a8c68(0x1df)](_0x59cca2)==='[object\\x20Array]';}[_0x580cf2(0x245)](_0x559321,_0xc8a8c6){}[_0x580cf2(0x229)](_0x4d0efb){var _0x5200be=_0x580cf2;delete _0x4d0efb[_0x5200be(0x1e4)],delete _0x4d0efb['_hasSetOnItsPath'],delete _0x4d0efb[_0x5200be(0x206)];}[_0x580cf2(0x29d)](_0x5bbc19,_0x501b71){}}let _0x55375b=new _0x39411a(),_0x5692c0={'props':0x64,'elements':0x64,'strLength':0x400*0x32,'totalStrLength':0x400*0x32,'autoExpandLimit':0x1388,'autoExpandMaxDepth':0xa},_0x223e3e={'props':0x5,'elements':0x5,'strLength':0x100,'totalStrLength':0x100*0x3,'autoExpandLimit':0x1e,'autoExpandMaxDepth':0x2};function _0x4ab6c9(_0x4f9b32,_0x2d57a6,_0x517fc1,_0x14445b,_0x4f8f22,_0x7c9ae3){var _0x296ff5=_0x580cf2;let _0x27eb2b,_0xb7c039;try{_0xb7c039=_0x19745e(),_0x27eb2b=_0x414e35[_0x2d57a6],!_0x27eb2b||_0xb7c039-_0x27eb2b['ts']>0x1f4&&_0x27eb2b['count']&&_0x27eb2b[_0x296ff5(0x1b8)]/_0x27eb2b[_0x296ff5(0x212)]<0x64?(_0x414e35[_0x2d57a6]=_0x27eb2b={'count':0x0,'time':0x0,'ts':_0xb7c039},_0x414e35[_0x296ff5(0x281)]={}):_0xb7c039-_0x414e35[_0x296ff5(0x281)]['ts']>0x32&&_0x414e35[_0x296ff5(0x281)]['count']&&_0x414e35[_0x296ff5(0x281)][_0x296ff5(0x1b8)]/_0x414e35['hits'][_0x296ff5(0x212)]<0x64&&(_0x414e35[_0x296ff5(0x281)]={});let _0x4f1fd0=[],_0x165369=_0x27eb2b[_0x296ff5(0x282)]||_0x414e35[_0x296ff5(0x281)][_0x296ff5(0x282)]?_0x223e3e:_0x5692c0,_0x341129=_0x14c918=>{var _0x11bf1b=_0x296ff5;let _0x1db7ec={};return _0x1db7ec['props']=_0x14c918['props'],_0x1db7ec[_0x11bf1b(0x1e3)]=_0x14c918[_0x11bf1b(0x1e3)],_0x1db7ec['strLength']=_0x14c918[_0x11bf1b(0x1c5)],_0x1db7ec[_0x11bf1b(0x266)]=_0x14c918[_0x11bf1b(0x266)],_0x1db7ec[_0x11bf1b(0x1c0)]=_0x14c918[_0x11bf1b(0x1c0)],_0x1db7ec[_0x11bf1b(0x27f)]=_0x14c918[_0x11bf1b(0x27f)],_0x1db7ec['sortProps']=!0x1,_0x1db7ec[_0x11bf1b(0x233)]=!_0x243cf5,_0x1db7ec[_0x11bf1b(0x227)]=0x1,_0x1db7ec[_0x11bf1b(0x204)]=0x0,_0x1db7ec[_0x11bf1b(0x220)]='root_exp_id',_0x1db7ec[_0x11bf1b(0x1f2)]=_0x11bf1b(0x214),_0x1db7ec['autoExpand']=!0x0,_0x1db7ec[_0x11bf1b(0x1ff)]=[],_0x1db7ec[_0x11bf1b(0x26d)]=0x0,_0x1db7ec[_0x11bf1b(0x29a)]=!0x0,_0x1db7ec['allStrLength']=0x0,_0x1db7ec[_0x11bf1b(0x1eb)]={'current':void 0x0,'parent':void 0x0,'index':0x0},_0x1db7ec;};for(var _0x1efdc8=0x0;_0x1efdc8<_0x4f8f22[_0x296ff5(0x257)];_0x1efdc8++)_0x4f1fd0[_0x296ff5(0x1f9)](_0x55375b[_0x296ff5(0x248)]({'timeNode':_0x4f9b32==='time'||void 0x0},_0x4f8f22[_0x1efdc8],_0x341129(_0x165369),{}));if(_0x4f9b32===_0x296ff5(0x1bb)){let _0x1692d3=Error[_0x296ff5(0x244)];try{Error['stackTraceLimit']=0x1/0x0,_0x4f1fd0[_0x296ff5(0x1f9)](_0x55375b['serialize']({'stackNode':!0x0},new Error()[_0x296ff5(0x252)],_0x341129(_0x165369),{'strLength':0x1/0x0}));}finally{Error[_0x296ff5(0x244)]=_0x1692d3;}}return{'method':_0x296ff5(0x25f),'version':_0x12e098,'args':[{'ts':_0x517fc1,'session':_0x14445b,'args':_0x4f1fd0,'id':_0x2d57a6,'context':_0x7c9ae3}]};}catch(_0x315eb1){return{'method':_0x296ff5(0x25f),'version':_0x12e098,'args':[{'ts':_0x517fc1,'session':_0x14445b,'args':[{'type':_0x296ff5(0x237),'error':_0x315eb1&&_0x315eb1[_0x296ff5(0x295)]}],'id':_0x2d57a6,'context':_0x7c9ae3}]};}finally{try{if(_0x27eb2b&&_0xb7c039){let _0xe9e58d=_0x19745e();_0x27eb2b[_0x296ff5(0x212)]++,_0x27eb2b[_0x296ff5(0x1b8)]+=_0x1e922d(_0xb7c039,_0xe9e58d),_0x27eb2b['ts']=_0xe9e58d,_0x414e35['hits'][_0x296ff5(0x212)]++,_0x414e35[_0x296ff5(0x281)]['time']+=_0x1e922d(_0xb7c039,_0xe9e58d),_0x414e35[_0x296ff5(0x281)]['ts']=_0xe9e58d,(_0x27eb2b['count']>0x32||_0x27eb2b[_0x296ff5(0x1b8)]>0x64)&&(_0x27eb2b[_0x296ff5(0x282)]=!0x0),(_0x414e35[_0x296ff5(0x281)]['count']>0x3e8||_0x414e35[_0x296ff5(0x281)][_0x296ff5(0x1b8)]>0x12c)&&(_0x414e35[_0x296ff5(0x281)][_0x296ff5(0x282)]=!0x0);}}catch{}}}return _0x4ab6c9;}function _0x3ba1(){var _0x3cb73c=['set','_addLoadNode','noFunctions','1206340CLTvMI','call','[object\\x20Set]','unknown','Map','4195960EqFetw','','_additionalMetadata','timeEnd','_connecting','NEXT_RUNTIME','getWebSocketClass','_setNodeExpandableState','unshift','_reconnectTimeout','2487450WbCORR','stackTraceLimit','_setNodePermissions','index','_setNodeId','serialize','isArray','match','_p_','_sendErrorMessage','now','function','_dateToString','dockerizedApp','join','stack','hasOwnProperty','getOwnPropertyNames','956202PGyymO','disabledTrace','length','_connected','isExpressionToEvaluate','current','[object\\x20Date]','60394','pathToFileURL','close','log','26929djpwuv','getter','setter','location','\\x20server','_processTreeNodeResult','totalStrLength','slice','indexOf','getPrototypeOf','127.0.0.1','_console_ninja','_regExpToString','autoExpandPropertyCount','data','url','funcName','_HTMLAllCollection','get','valueOf','_getOwnPropertySymbols','1.0.0','next.js','timeStamp','_isSet','name','Buffer','coverage','_treeNodePropertiesBeforeFullValue','parse','Boolean','autoExpandMaxDepth','_inBrowser','hits','reduceLimits','path','26QMRMjI','boolean','Number','type','replace','angular','_consoleNinjaAllowedToStart','split','toString','global','logger\\x20websocket\\x20error','_isPrimitiveType','_WebSocketClass','cappedProps','_p_length','null','getOwnPropertySymbols','message','create','_addFunctionsNode','_isPrimitiveWrapperType','parent','resolveGetters','map','pop','_setNodeExpressionPath','method','getOwnPropertyDescriptor','21533868gqWHvM','onopen','symbol','toLowerCase','','reload','time','date','_capIfString','trace','defineProperty','_propertyName','host','stringify','autoExpandLimit','env','_blacklistedProperty','_connectAttemptCount','warn','strLength',':logPointId:','failed\\x20to\\x20find\\x20and\\x20load\\x20WebSocket','constructor','_maxConnectAttemptCount','https://tinyurl.com/37x8b79t','_WebSocket','1712674027416','_isMap','bind','capped','versions','\\x20browser','substr','_connectToHostNow','astro','2696crpfQW','enumerable','concat','_getOwnPropertyDescriptor','edge','_addProperty','String','string','console','Error','_objectToString','[object\\x20BigInt]','_ws','props','elements','_hasSymbolPropertyOnItsPath','RegExp','...','_type','disabledLog','_inNextEdge','_socket','node','prototype','angular','_allowedToSend','_console_ninja_session','_property','number','rootExpression','undefined','process','Set','NEGATIVE_INFINITY','nodeModules','Console\\x20Ninja\\x20failed\\x20to\\x20send\\x20logs,\\x20restarting\\x20the\\x20process\\x20may\\x20help;\\x20also\\x20see\\x20','push','_Symbol','_isUndefined','catch','bigint','onerror','autoExpandPreviousObjects','ws://','POSITIVE_INFINITY','port','expressionsToEvaluate','level','hrtime','_hasMapOnItsPath','unref','_setNodeLabel','HTMLAllCollection',["localhost","127.0.0.1","example.cypress.io","LAPTOP-1V5HLGOD","172.27.80.1","192.168.56.1","10.0.0.19"],'_undefined','_p_name','sortProps','elapsed','value','74603ihYVjm','_setNodeQueryPath','count','_attemptToReconnectShortly','root_exp','_isNegativeZero','readyState','_allowedToConnectOnSend','hostname','send','forEach','_sortProps','_addObjectProperty','_treeNodePropertiesAfterFullValue','__es'+'Module','autoExpand','expId','then','array','default','performance','perf_hooks','_getOwnPropertyNames','depth','WebSocket','_cleanNode','onclose','allStrLength','positiveInfinity','ws/index.js','object','_isArray','error'];_0x3ba1=function(){return _0x3cb73c;};return _0x3ba1();}function _0x4050(_0x1c8374,_0x5de145){var _0x3ba176=_0x3ba1();return _0x4050=function(_0x4050b6,_0x21c3f2){_0x4050b6=_0x4050b6-0x1b2;var _0x778d89=_0x3ba176[_0x4050b6];return _0x778d89;},_0x4050(_0x1c8374,_0x5de145);}((_0x487bd,_0x5c4a99,_0x4c2d22,_0x10b48f,_0x227054,_0x4f59aa,_0x4c070f,_0x4250b1,_0x4da373,_0x1553fd)=>{var _0x226a79=_0x3e00e0;if(_0x487bd[_0x226a79(0x26b)])return _0x487bd[_0x226a79(0x26b)];if(!J(_0x487bd,_0x4250b1,_0x227054))return _0x487bd[_0x226a79(0x26b)]={'consoleLog':()=>{},'consoleTrace':()=>{},'consoleTime':()=>{},'consoleTimeEnd':()=>{},'autoLog':()=>{},'autoLogMany':()=>{},'autoTraceMany':()=>{},'coverage':()=>{},'autoTrace':()=>{},'autoTime':()=>{},'autoTimeEnd':()=>{}},_0x487bd[_0x226a79(0x26b)];let _0x103977=W(_0x487bd),_0x287de0=_0x103977[_0x226a79(0x20e)],_0x42af2b=_0x103977['timeStamp'],_0x49bbf3=_0x103977['now'],_0xe07dc4={'hits':{},'ts':{}},_0x4bdb46=Y(_0x487bd,_0x4da373,_0xe07dc4,_0x4f59aa),_0x5b442d=_0x51c231=>{_0xe07dc4['ts'][_0x51c231]=_0x42af2b();},_0x1fa9ee=(_0x2bf05a,_0x3b55dd)=>{var _0x50ccc1=_0x226a79;let _0x26b57d=_0xe07dc4['ts'][_0x3b55dd];if(delete _0xe07dc4['ts'][_0x3b55dd],_0x26b57d){let _0x2d3478=_0x287de0(_0x26b57d,_0x42af2b());_0x20f993(_0x4bdb46(_0x50ccc1(0x1b8),_0x2bf05a,_0x49bbf3(),_0x4acb65,[_0x2d3478],_0x3b55dd));}},_0x842b9b=_0x272ce1=>_0x185cc5=>{var _0x38e8e3=_0x226a79;try{_0x5b442d(_0x185cc5),_0x272ce1(_0x185cc5);}finally{_0x487bd[_0x38e8e3(0x1dd)]['time']=_0x272ce1;}},_0x2d0550=_0x54edb2=>_0x4db119=>{var _0x5b39c3=_0x226a79;try{let [_0x33c90b,_0x3198b1]=_0x4db119[_0x5b39c3(0x28b)](_0x5b39c3(0x1c6));_0x1fa9ee(_0x3198b1,_0x33c90b),_0x54edb2(_0x33c90b);}finally{_0x487bd['console'][_0x5b39c3(0x23c)]=_0x54edb2;}};_0x487bd[_0x226a79(0x26b)]={'consoleLog':(_0x2a467d,_0x10253c)=>{var _0xb052d=_0x226a79;_0x487bd['console']['log'][_0xb052d(0x279)]!==_0xb052d(0x1e8)&&_0x20f993(_0x4bdb46('log',_0x2a467d,_0x49bbf3(),_0x4acb65,_0x10253c));},'consoleTrace':(_0x20e2bb,_0x4de0d7)=>{var _0x28e452=_0x226a79;_0x487bd[_0x28e452(0x1dd)][_0x28e452(0x25f)][_0x28e452(0x279)]!==_0x28e452(0x256)&&_0x20f993(_0x4bdb46(_0x28e452(0x1bb),_0x20e2bb,_0x49bbf3(),_0x4acb65,_0x4de0d7));},'consoleTime':()=>{var _0x24e2e1=_0x226a79;_0x487bd['console'][_0x24e2e1(0x1b8)]=_0x842b9b(_0x487bd[_0x24e2e1(0x1dd)][_0x24e2e1(0x1b8)]);},'consoleTimeEnd':()=>{var _0x3c3822=_0x226a79;_0x487bd['console'][_0x3c3822(0x23c)]=_0x2d0550(_0x487bd[_0x3c3822(0x1dd)][_0x3c3822(0x23c)]);},'autoLog':(_0x39acfb,_0x3c947a)=>{var _0x53b01d=_0x226a79;_0x20f993(_0x4bdb46(_0x53b01d(0x25f),_0x3c947a,_0x49bbf3(),_0x4acb65,[_0x39acfb]));},'autoLogMany':(_0x5c0f7,_0xd934fd)=>{var _0x365320=_0x226a79;_0x20f993(_0x4bdb46(_0x365320(0x25f),_0x5c0f7,_0x49bbf3(),_0x4acb65,_0xd934fd));},'autoTrace':(_0x543ec0,_0x471149)=>{_0x20f993(_0x4bdb46('trace',_0x471149,_0x49bbf3(),_0x4acb65,[_0x543ec0]));},'autoTraceMany':(_0x7a10e6,_0x5bcec8)=>{var _0x512abc=_0x226a79;_0x20f993(_0x4bdb46(_0x512abc(0x1bb),_0x7a10e6,_0x49bbf3(),_0x4acb65,_0x5bcec8));},'autoTime':(_0x229ff6,_0x12be8f,_0x538b55)=>{_0x5b442d(_0x538b55);},'autoTimeEnd':(_0x12ab50,_0x1f3a17,_0x210e06)=>{_0x1fa9ee(_0x1f3a17,_0x210e06);},'coverage':_0x37d67d=>{var _0x6e1486=_0x226a79;_0x20f993({'method':_0x6e1486(0x27b),'version':_0x4f59aa,'args':[{'id':_0x37d67d}]});}};let _0x20f993=b(_0x487bd,_0x5c4a99,_0x4c2d22,_0x10b48f,_0x227054,_0x1553fd),_0x4acb65=_0x487bd[_0x226a79(0x1ef)];return _0x487bd[_0x226a79(0x26b)];})(globalThis,_0x3e00e0(0x26a),_0x3e00e0(0x25c),"c:\\\\Users\\\\gatit\\\\.vscode\\\\extensions\\\\wallabyjs.console-ninja-1.0.298\\\\node_modules",_0x3e00e0(0x1ed),_0x3e00e0(0x275),_0x3e00e0(0x1cc),_0x3e00e0(0x20a),_0x3e00e0(0x1b6),_0x3e00e0(0x23a));`)}catch{}}function Z$(t,...e){try{Y$().consoleLog(t,e)}catch{}return e}var tm=(()=>{let e=class e{constructor(r){this.firestore=r}getClientes(){return g(this,null,function*(){return yield this.parseData(this.firestore.collection("clientes").snapshotChanges())})}getClienteById(r){return g(this,null,function*(){return(yield this.parseData(this.firestore.collection("clientes",s=>s.where("id","==",r)).snapshotChanges()))[0]})}parseData(r){let i=[];return new Promise(s=>{r.subscribe(o=>{i=o.map(a=>oe(A({},a.payload.doc.data()),{id:a.payload.doc.id})),s(i)})})}createCliente(r){return g(this,null,function*(){return yield this.firestore.collection("clientes").add(Object.assign({},r))})}updateCliente(r){return g(this,null,function*(){yield this.firestore.doc("clientes/"+r.id).update(r)})}deleteCliente(r){return g(this,null,function*(){yield this.firestore.doc("clientes/"+r).delete()})}addCoche(r,i){return g(this,null,function*(){let s=yield this.getClienteById(r);s.coches.push(i),yield this.updateCliente(s)})}removeCoche(r,i){return g(this,null,function*(){let s=yield this.getClienteById(r);s.coches=s.coches.filter(o=>o!==i),yield this.updateCliente(s)})}addTransaccion(r,i){return g(this,null,function*(){let s=yield this.getClienteById(r);s.transacciones.push(i),yield this.updateCliente(s)})}};e.\u0275fac=function(i){return new(i||e)(C(yc))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Jk=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(te(mr),te(Zn))},e.\u0275dir=st({type:e});let t=e;return t})(),sm=(()=>{let e=class e extends Jk{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Qr(e)))(s||e)}})(),e.\u0275dir=st({type:e,features:[_r]});let t=e;return t})(),cd=new O("");var J$={provide:cd,useExisting:Gr(()=>xc),multi:!0};function e7(){let t=yr()?yr().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var t7=new O(""),xc=(()=>{let e=class e extends Jk{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!e7())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(te(mr),te(Zn),te(t7,8))},e.\u0275dir=st({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&de("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[Ss([J$]),_r]});let t=e;return t})();function n7(t){return t!=null&&typeof t.length=="number"}var e2=new O(""),r7=new O("");function i7(t){return e=>n7(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}function qk(t){return null}function t2(t){return t!=null}function n2(t){return As(t)?Ce(t):t}function r2(t){let e={};return t.forEach(n=>{e=n!=null?A(A({},e),n):e}),Object.keys(e).length===0?null:e}function i2(t,e){return e.map(n=>n(t))}function s7(t){return!t.validate}function s2(t){return t.map(e=>s7(e)?e:n=>e.validate(n))}function o7(t){if(!t)return null;let e=t.filter(t2);return e.length==0?null:function(n){return r2(i2(n,e))}}function o2(t){return t!=null?o7(s2(t)):null}function a7(t){if(!t)return null;let e=t.filter(t2);return e.length==0?null:function(n){let r=i2(n,e).map(n2);return D_(r).pipe(B(r2))}}function a2(t){return t!=null?a7(s2(t)):null}function Gk(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function c7(t){return t._rawValidators}function l7(t){return t._rawAsyncValidators}function TC(t){return t?Array.isArray(t)?t:[t]:[]}function rm(t,e){return Array.isArray(t)?t.includes(e):t===e}function zk(t,e){let n=TC(e);return TC(t).forEach(i=>{rm(n,i)||n.push(i)}),n}function Wk(t,e){return TC(e).filter(n=>!rm(t,n))}var im=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=o2(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=a2(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},SC=class extends im{get formDirective(){return null}get path(){return null}},ad=class extends im{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},AC=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},u7={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Kne=oe(A({},u7),{"[class.ng-submitted]":"isSubmitted"}),wc=(()=>{let e=class e extends AC{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(te(ad,2))},e.\u0275dir=st({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&_y("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[_r]});let t=e;return t})();var sd="VALID",nm="INVALID",vc="PENDING",od="DISABLED";function d7(t){return(om(t)?t.validators:t)||null}function h7(t){return Array.isArray(t)?o2(t):t||null}function f7(t,e){return(om(e)?e.asyncValidators:t)||null}function p7(t){return Array.isArray(t)?a2(t):t||null}function om(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}var MC=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===sd}get invalid(){return this.status===nm}get pending(){return this.status==vc}get disabled(){return this.status===od}get enabled(){return this.status!==od}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(zk(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(zk(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Wk(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Wk(e,this._rawAsyncValidators))}hasValidator(e){return rm(this._rawValidators,e)}hasAsyncValidator(e){return rm(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=vc,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=od,this.errors=null,this._forEachChild(r=>{r.disable(oe(A({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(oe(A({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=sd,this._forEachChild(r=>{r.enable(oe(A({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(oe(A({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===sd||this.status===vc)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?od:sd}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=vc,this._hasOwnPendingAsyncValidator=!0;let n=n2(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new gt,this.statusChanges=new gt}_calculateStatus(){return this._allControlsDisabled()?od:this.errors?nm:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(vc)?vc:this._anyControlsHaveStatus(nm)?nm:sd}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){om(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=h7(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=p7(this._rawAsyncValidators)}};var c2=new O("CallSetDisabledState",{providedIn:"root",factory:()=>NC}),NC="always";function g7(t,e){return[...e.path,t]}function m7(t,e,n=NC){y7(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),v7(t,e),w7(t,e),x7(t,e),_7(t,e)}function Kk(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function _7(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function y7(t,e){let n=c7(t);e.validator!==null?t.setValidators(Gk(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=l7(t);e.asyncValidator!==null?t.setAsyncValidators(Gk(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();Kk(e._rawValidators,i),Kk(e._rawAsyncValidators,i)}function v7(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&l2(t,e)})}function x7(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&l2(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function l2(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function w7(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function E7(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function C7(t){return Object.getPrototypeOf(t.constructor)===sm}function I7(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(s=>{s.constructor===xc?n=s:C7(s)?r=s:i=s}),i||r||n||null}function Qk(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function Yk(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var b7=class extends MC{constructor(e=null,n,r){super(d7(n),f7(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),om(n)&&(n.nonNullable||n.initialValueIsDefault)&&(Yk(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Qk(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Qk(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Yk(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var D7={provide:ad,useExisting:Gr(()=>_o)},Zk=Promise.resolve(),_o=(()=>{let e=class e extends ad{constructor(r,i,s,o,a,c){super(),this._changeDetectorRef=a,this.callSetDisabledState=c,this.control=new b7,this._registered=!1,this.name="",this.update=new gt,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=I7(this,o)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),E7(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){m7(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){Zk.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,s=i!==0&&Ns(i);Zk.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?g7(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(te(SC,9),te(e2,10),te(r7,10),te(cd,10),te(Ms,8),te(c2,8))},e.\u0275dir=st({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[Ft.None,"disabled","isDisabled"],model:[Ft.None,"ngModel","model"],options:[Ft.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Ss([D7]),_r,Ci]});let t=e;return t})();var T7={provide:cd,useExisting:Gr(()=>RC),multi:!0},RC=(()=>{let e=class e extends sm{writeValue(r){let i=r??"";this.setProperty("value",i)}registerOnChange(r){this.onChange=i=>{r(i==""?null:parseFloat(i))}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Qr(e)))(s||e)}})(),e.\u0275dir=st({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,s){i&1&&de("input",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},features:[Ss([T7]),_r]});let t=e;return t})();var S7={provide:cd,useExisting:Gr(()=>Ec),multi:!0};function u2(t,e){return t==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function A7(t){return t.split(":")[0]}var Ec=(()=>{let e=class e extends sm{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i=this._getOptionId(r),s=u2(i,r);this.setProperty("value",s)}registerOnChange(r){this.onChange=i=>{this.value=this._getOptionValue(i),r(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),r))return i;return null}_getOptionValue(r){let i=A7(r);return this._optionMap.has(i)?this._optionMap.get(i):r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Qr(e)))(s||e)}})(),e.\u0275dir=st({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,s){i&1&&de("change",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[Ss([S7]),_r]});let t=e;return t})(),am=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(r){this._select!=null&&(this._select._optionMap.set(this.id,r),this._setElementValue(u2(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._setElementValue(r),this._select&&this._select.writeValue(this._select.value)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(te(Zn),te(mr),te(Ec,9))},e.\u0275dir=st({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})(),M7={provide:cd,useExisting:Gr(()=>d2),multi:!0};function Xk(t,e){return t==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function N7(t){return t.split(":")[0]}var d2=(()=>{let e=class e extends sm{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i;if(Array.isArray(r)){let s=r.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(r){this.onChange=i=>{let s=[],o=i.selectedOptions;if(o!==void 0){let a=o;for(let c=0;c<a.length;c++){let l=a[c],u=this._getOptionValue(l.value);s.push(u)}}else{let a=i.options;for(let c=0;c<a.length;c++){let l=a[c];if(l.selected){let u=this._getOptionValue(l.value);s.push(u)}}}this.value=s,r(s)}}_registerOption(r){let i=(this._idCounter++).toString();return this._optionMap.set(i,r),i}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,r))return i;return null}_getOptionValue(r){let i=N7(r);return this._optionMap.has(i)?this._optionMap.get(i)._value:r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Qr(e)))(s||e)}})(),e.\u0275dir=st({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,s){i&1&&de("change",function(a){return s.onChange(a.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[Ss([M7]),_r]});let t=e;return t})(),cm=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(r){this._select!=null&&(this._value=r,this._setElementValue(Xk(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._select?(this._value=r,this._setElementValue(Xk(this.id,r)),this._select.writeValue(this._select.value)):this._setElementValue(r)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}_setSelected(r){this._renderer.setProperty(this._element.nativeElement,"selected",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(te(Zn),te(mr),te(d2,9))},e.\u0275dir=st({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})();function R7(t){return typeof t=="number"?t:parseInt(t,10)}var P7=(()=>{let e=class e{constructor(){this._validator=qk}ngOnChanges(r){if(this.inputName in r){let i=this.normalizeInput(r[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):qk,this._onChange&&this._onChange()}}validate(r){return this._validator(r)}registerOnValidatorChange(r){this._onChange=r}enabled(r){return r!=null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=st({type:e,features:[Ci]});let t=e;return t})();var k7={provide:e2,useExisting:Gr(()=>PC),multi:!0},PC=(()=>{let e=class e extends P7{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=r=>R7(r),this.createValidator=r=>i7(r)}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Qr(e)))(s||e)}})(),e.\u0275dir=st({type:e,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(i,s){i&2&&fl("maxlength",s._enabled?s.maxlength:null)},inputs:{maxlength:"maxlength"},features:[Ss([k7]),_r]});let t=e;return t})();var O7=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=it({type:e}),e.\u0275inj=rt({});let t=e;return t})();var h2=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:c2,useValue:r.callSetDisabledState??NC}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=it({type:e}),e.\u0275inj=rt({imports:[O7]});let t=e;return t})();var Cc=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=cn({type:e,selectors:[["app-loader"]],decls:1,vars:0,consts:[[1,"loader"]],template:function(i,s){i&1&&dn(0,"div",0)},styles:[".loader[_ngcontent-%COMP%]{width:120px;aspect-ratio:1;--_c:no-repeat radial-gradient(farthest-side,var(--yellow) 92%,#0000);background:var(--_c) top,var(--_c) left,var(--_c) right,var(--_c) bottom;background-size:27px 27px;animation:_ngcontent-%COMP%_l7 1s infinite;margin:3rem auto}@keyframes _ngcontent-%COMP%_l7{to{transform:rotate(.5turn)}}"]});let t=e;return t})();var yo=t=>({invalid:t}),f2=t=>({disabled:t});function F7(t,e){t&1&&(x(0,"h2"),D(1,"A\xF1adir coche"),w())}function V7(t,e){t&1&&(x(0,"h2"),D(1,"Modificar coche"),w())}function L7(t,e){t&1&&(x(0,"h2"),D(1,"Vender coche"),w())}function j7(t,e){if(t&1){let n=mt();x(0,"div",10)(1,"div",11)(2,"label"),D(3," Marca "),x(4,"input",12),Bt("ngModelChange",function(i){ye(n);let s=ee();return Yt(s.currentCoche.marca,i)||(s.currentCoche.marca=i),ve(i)}),de("input",function(){ye(n);let i=ee();return ve(i.validateMarca())}),w()()(),x(5,"div",11)(6,"label"),D(7," Modelo "),x(8,"input",12),Bt("ngModelChange",function(i){ye(n);let s=ee();return Yt(s.currentCoche.modelo,i)||(s.currentCoche.modelo=i),ve(i)}),de("input",function(){ye(n);let i=ee();return ve(i.validateModelo())}),w()()(),x(9,"div",11)(10,"label"),D(11," Kilometros "),x(12,"input",13),Bt("ngModelChange",function(i){ye(n);let s=ee();return Yt(s.currentCoche.kilometros,i)||(s.currentCoche.kilometros=i),ve(i)}),de("input",function(){ye(n);let i=ee();return ve(i.validateKilometros())}),w()()(),x(13,"div",11)(14,"label"),D(15," Transmision "),x(16,"select",14),Bt("ngModelChange",function(i){ye(n);let s=ee();return Yt(s.currentCoche.transmision,i)||(s.currentCoche.transmision=i),ve(i)}),de("input",function(){ye(n);let i=ee();return ve(i.validateTransmision())}),x(17,"option",15),D(18,"Manual"),w(),x(19,"option",16),D(20,"Automatica"),w()()()(),x(21,"div",11)(22,"label"),D(23," Precio "),x(24,"input",13),Bt("ngModelChange",function(i){ye(n);let s=ee();return Yt(s.currentCoche.precio,i)||(s.currentCoche.precio=i),ve(i)}),de("input",function(){ye(n);let i=ee();return ve(i.validatePrecio())}),w()()()()}if(t&2){let n=ee();L(4),jt("ngModel",n.currentCoche.marca),z("ngClass",ot(10,yo,!n.isMarcaValid)),L(4),jt("ngModel",n.currentCoche.modelo),z("ngClass",ot(12,yo,!n.isModeloValid)),L(4),jt("ngModel",n.currentCoche.kilometros),z("ngClass",ot(14,yo,!n.isKilometrosValid)),L(4),jt("ngModel",n.currentCoche.transmision),z("ngClass",ot(16,yo,!n.isTransmisionValid)),L(8),jt("ngModel",n.currentCoche.precio),z("ngClass",ot(18,yo,!n.isPrecioValid))}}function B7(t,e){if(t&1&&(x(0,"option",21),D(1),w()),t&2){let n=e.$implicit;z("ngValue",n.id),L(),xt(n.nombre+" "+n.apellidos)}}function U7(t,e){if(t&1){let n=mt();x(0,"div",10)(1,"div",11)(2,"label"),D(3," Nuevo propietario "),x(4,"select",14),Bt("ngModelChange",function(i){ye(n);let s=ee();return Yt(s.venta.clienteId,i)||(s.venta.clienteId=i),ve(i)}),de("input",function(){ye(n);let i=ee();return ve(i.validateCliente())}),vt(5,B7,2,2,"option",17),w()()(),x(6,"div",11)(7,"label"),D(8," M\xE9todo de pago "),x(9,"select",14),Bt("ngModelChange",function(i){ye(n);let s=ee();return Yt(s.venta.metodoPago,i)||(s.venta.metodoPago=i),ve(i)}),de("input",function(){ye(n);let i=ee();return ve(i.validateMetodoPago())}),x(10,"option",18),D(11,"Efectivo"),w(),x(12,"option",19),D(13,"Cr\xE9dito"),w(),x(14,"option",20),D(15,"D\xE9bito"),w()()()()()}if(t&2){let n=ee();L(4),jt("ngModel",n.venta.clienteId),z("ngClass",ot(5,yo,!n.isClienteValid)),L(),z("ngForOf",n.clientes),L(4),jt("ngModel",n.venta.metodoPago),z("ngClass",ot(7,yo,!n.isMetodoPagoValid))}}function $7(t,e){if(t&1){let n=mt();x(0,"div")(1,"button",22),de("click",function(){ye(n);let i=ee();return ve(i.createCoche())}),D(2,"A\xF1adir"),w()()}if(t&2){let n=ee();L(),z("ngClass",ot(1,f2,!n.isCurrentCocheValid))}}function H7(t,e){if(t&1){let n=mt();x(0,"div")(1,"button",23),de("click",function(){ye(n);let i=ee();return ve(i.updateCoche())}),D(2,"Modificar"),w()()}if(t&2){let n=ee();L(),z("ngClass",ot(1,f2,!n.isCurrentCocheValid))}}function q7(t,e){if(t&1){let n=mt();x(0,"div")(1,"button",24),de("click",function(){ye(n);let i=ee();return ve(i.deleteCoche())}),D(2,"Eliminar"),w()()}}function G7(t,e){if(t&1){let n=mt();x(0,"div")(1,"button",25),de("click",function(){ye(n);let i=ee();return ve(i.setSellMode())}),D(2,"Vender"),w()()}}function z7(t,e){if(t&1){let n=mt();x(0,"div")(1,"button",26),de("click",function(){ye(n);let i=ee();return ve(i.resetCurrentCoche())}),D(2," A\xF1adir nuevo "),w()()}}function W7(t,e){if(t&1){let n=mt();x(0,"div",6)(1,"div")(2,"button",25),de("click",function(){ye(n);let i=ee();return ve(i.sellCoche())}),D(3,"Vender"),w()(),x(4,"div")(5,"button",26),de("click",function(){ye(n);let i=ee();return ve(i.resetCurrentCoche())}),D(6," A\xF1adir nuevo "),w()()()}}function K7(t,e){if(t&1){let n=mt();x(0,"tr",29)(1,"td"),D(2),w(),x(3,"td"),D(4),w(),x(5,"td"),D(6),w(),x(7,"td"),D(8),w(),x(9,"td"),D(10),w(),x(11,"td"),D(12),w(),x(13,"td")(14,"button",30),de("click",function(){let i=ye(n).$implicit,s=ee(2);return ve(s.setCurrentCoche(i))}),D(15," Seleccionar "),w()()()}if(t&2){let n=e.$implicit;Ts("id",n.id),L(2),xt(n.marca),L(2),xt(n.modelo),L(2),pl("",n.kilometros," KM"),L(2),xt(n.transmision),L(2),pl("$ ",n.precio,""),L(2),xt(n.vendido?"vendido":"")}}function Q7(t,e){if(t&1&&(x(0,"table",27)(1,"thead")(2,"tr")(3,"th"),D(4,"Marca"),w(),x(5,"th"),D(6,"Modelo"),w(),x(7,"th"),D(8,"Kilometros"),w(),x(9,"th"),D(10,"Transmision"),w(),x(11,"th"),D(12,"Precio"),w(),x(13,"th"),D(14,"Vendido"),w(),x(15,"th"),D(16,"Acciones"),w()()(),x(17,"tbody"),vt(18,K7,16,7,"tr",28),w()()),t&2){let n=ee();L(18),z("ngForOf",n.coches)}}function Y7(t,e){t&1&&dn(0,"app-loader")}var p2=(()=>{let e=class e{constructor(r,i){this.cocheService=r,this.clienteService=i,this.state=Rt.create,this.MODES=Rt,this.isLoading=!0,this.isMarcaValid=!1,this.isModeloValid=!1,this.isPrecioValid=!1,this.isKilometrosValid=!1,this.isTransmisionValid=!1,this.isCurrentCocheValid=!1,this.isClienteValid=!1,this.isMetodoPagoValid=!1,this.transmisiones=["manual","automatica"],this.coches=[],this.currentCoche=new Ca({marca:"",modelo:"",precio:0,kilometros:0,vendido:!1,transmision:"",due\u00F1oActual:""}),this.clientes=[],this.venta={clienteId:"",metodoPago:""}}ngOnInit(){this.updateCoches(),this.updateClientes()}updateCoches(){return g(this,null,function*(){this.isLoading=!0,this.coches=yield this.cocheService.getCoches(),this.isLoading=!1})}updateClientes(){return g(this,null,function*(){this.clientes=yield this.clienteService.getClientes()})}createCoche(){return g(this,null,function*(){if(!this.validateCurrentCoche())return;let r=new Ca(oe(A({},this.currentCoche),{vendido:!1,due\u00F1oActual:""}));yield this.cocheService.createCoche(r),yield this.updateCoches(),this.resetCurrentCoche()})}updateCoche(){return g(this,null,function*(){this.validateCurrentCoche()&&(yield this.cocheService.updateCoche(this.currentCoche),yield this.updateCoches(),this.resetCurrentCoche())})}deleteCoche(){return g(this,null,function*(){yield this.cocheService.deleteCoche(this.currentCoche.id),yield this.updateCoches(),this.resetCurrentCoche()})}setCurrentCoche(r){return g(this,null,function*(){this.currentCoche=r,this.state=Rt.select,this.setValidation(!0),this.validateCurrentCoche()})}resetCurrentCoche(){return g(this,null,function*(){this.currentCoche=new Ca({marca:"",modelo:"",precio:0,kilometros:0,vendido:!1,transmision:"",due\u00F1oActual:""}),this.state=Rt.create,this.setValidation(!1),this.validateCurrentCoche(),yield this.updateCoches()})}setSellMode(){this.state=Rt.sell,this.validateVenta()}sellCoche(){return g(this,null,function*(){let r=this.currentCoche,i=this.venta.clienteId,s=this.venta.metodoPago;yield this.cocheService.sellCoche(r.id,i,r.precio,s),this.resetCurrentCoche(),yield this.updateCoches()})}validateTransmision(){this.isTransmisionValid=this.currentCoche.transmision!==null||this.currentCoche.transmision!=="",this.validateCurrentCoche()}validateMarca(){this.isMarcaValid=Bl(this.currentCoche.marca),this.validateCurrentCoche()}validateModelo(){this.isModeloValid=D1(this.currentCoche.modelo),this.validateCurrentCoche()}validatePrecio(){if(this.currentCoche.precio===null){this.isPrecioValid=!1;return}this.isPrecioValid=Av(this.currentCoche.precio.toString()),this.validateCurrentCoche()}validateKilometros(){if(this.currentCoche.kilometros===null){this.isKilometrosValid=!1;return}this.isKilometrosValid=Av(this.currentCoche.kilometros.toString()),this.validateCurrentCoche()}validateCurrentCoche(){return this.isCurrentCocheValid=this.isKilometrosValid&&this.isMarcaValid&&this.isModeloValid&&this.isPrecioValid&&this.isTransmisionValid,this.isCurrentCocheValid}validateCliente(){this.isClienteValid=this.venta.clienteId!==null||this.venta.clienteId!=="",this.validateVenta()}validateMetodoPago(){this.isMetodoPagoValid=this.venta.metodoPago!==null||this.venta.metodoPago!=="",this.validateVenta()}validateVenta(){return this.isClienteValid&&this.isMetodoPagoValid}setValidation(r){this.isMarcaValid=r,this.isModeloValid=r,this.isPrecioValid=r,this.isKilometrosValid=r,this.isTransmisionValid=r}};e.\u0275fac=function(i){return new(i||e)(te($k),te(tm))},e.\u0275cmp=cn({type:e,selectors:[["app-coches"]],decls:21,vars:13,consts:[[1,"page"],[1,"row"],[1,"input-column"],[1,"container-title"],[4,"ngIf"],["class","container",4,"ngIf"],[1,"container","botones"],["class","container botones",4,"ngIf"],[1,"table-column"],["class","table",4,"ngIf"],[1,"container"],[1,"input-row"],["type","text",3,"ngModelChange","input","ngModel","ngClass"],["type","number",3,"ngModelChange","input","ngModel","ngClass"],[3,"ngModelChange","input","ngModel","ngClass"],["value","manual"],["value","automatica"],[3,"ngValue",4,"ngFor","ngForOf"],["value","efectivo"],["value","credito"],["value","debito"],[3,"ngValue"],[1,"btn","add",3,"click","ngClass"],[1,"btn","mod",3,"click","ngClass"],[1,"btn","del",3,"click"],[1,"btn","sell",3,"click"],[1,"btn","add",3,"click"],[1,"table"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],[1,"btn","btn-primary",3,"click"]],template:function(i,s){i&1&&(x(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),vt(4,F7,2,0,"h2",4)(5,V7,2,0,"h2",4)(6,L7,2,0,"h2",4),w(),vt(7,j7,25,20,"div",5)(8,U7,16,9,"div",5),x(9,"div",6),vt(10,$7,3,3,"div",4)(11,H7,3,3,"div",4)(12,q7,3,0,"div",4)(13,G7,3,0,"div",4)(14,z7,3,0,"div",4),w(),vt(15,W7,7,0,"div",7),w(),x(16,"div",8)(17,"h2"),D(18,"Coches"),w(),vt(19,Q7,19,1,"table",9)(20,Y7,1,0,"app-loader",4),w()()()),i&2&&(L(4),z("ngIf",s.state===s.MODES.create),L(),z("ngIf",s.state===s.MODES.select),L(),z("ngIf",s.state===s.MODES.sell),L(),z("ngIf",s.state!==s.MODES.sell),L(),z("ngIf",s.state===s.MODES.sell),L(2),z("ngIf",s.state===s.MODES.create),L(),z("ngIf",s.state===s.MODES.select),L(),z("ngIf",s.state===s.MODES.select),L(),z("ngIf",s.state===s.MODES.select&&!s.currentCoche.vendido),L(),z("ngIf",s.state===s.MODES.select),L(),z("ngIf",s.state===s.MODES.sell),L(4),z("ngIf",!s.isLoading),L(),z("ngIf",s.isLoading))},dependencies:[da,ha,fa,am,cm,xc,RC,Ec,wc,_o,Cc]});let t=e;return t})();var Z7=t=>({invalid:t}),X7=t=>({disabled:t});function J7(t,e){if(t&1){let n=mt();x(0,"div")(1,"div",6)(2,"label"),D(3," M\xE9todo de pago "),x(4,"select",7),Bt("ngModelChange",function(i){ye(n);let s=ee();return Yt(s.currentTransaccion.metodoPago,i)||(s.currentTransaccion.metodoPago=i),ve(i)}),de("input",function(){ye(n);let i=ee();return ve(i.validateMetodoPago())}),x(5,"option",8),D(6,"Efectivo"),w(),x(7,"option",9),D(8,"Credito"),w(),x(9,"option",10),D(10,"Debito"),w()()()(),x(11,"div",11)(12,"button",12),de("click",function(){ye(n);let i=ee();return ve(i.updateTransaccion())}),D(13,"Actualizar"),w()()()}if(t&2){let n=ee();L(4),jt("ngModel",n.currentTransaccion.metodoPago),z("ngClass",ot(3,Z7,!n.isMetodoPagoValid)),L(8),z("ngClass",ot(5,X7,!n.isCurrentTransaccionValid))}}function eH(t,e){if(t&1){let n=mt();x(0,"tr",15)(1,"td"),D(2),w(),x(3,"td"),D(4),w(),x(5,"td"),D(6),w(),x(7,"td"),D(8),w(),x(9,"td"),D(10),w(),x(11,"td")(12,"button",16),de("click",function(){let i=ye(n).$implicit,s=ee(2);return ve(s.setCurrentTransaccion(i))}),D(13,"Seleccionar"),w()()()}if(t&2){let n=e.$implicit;Ts("id",n.id),L(2),xt(n.fecha),L(2),xt(n.precio),L(2),xt(n.metodoPago),L(2),xt(n.coche),L(2),xt(n.cliente)}}function tH(t,e){if(t&1&&(x(0,"table",13)(1,"thead")(2,"tr")(3,"th"),D(4,"Fecha"),w(),x(5,"th"),D(6,"Precio"),w(),x(7,"th"),D(8,"Metodo de Pago"),w(),x(9,"th"),D(10,"Coche"),w(),x(11,"th"),D(12,"Cliente"),w()()(),x(13,"tbody"),vt(14,eH,14,6,"tr",14),w()()),t&2){let n=ee();L(14),z("ngForOf",n.transacciones)}}function nH(t,e){t&1&&dn(0,"app-loader")}var g2=(()=>{let e=class e{constructor(r){this.transaccionService=r,this.state=Rt.create,this.MODES=Rt,this.isLoading=!0,this.isMetodoPagoValid=!1,this.isCurrentTransaccionValid=!1,this.metodosPago=["efectivo","credito","debito"],this.transacciones=[],this.currentTransaccion=new Fs({fecha:new Date().toLocaleString(),precio:0,metodoPago:"",coche:"",cliente:"",tipo:""})}ngOnInit(){this.updateTransacciones()}updateTransacciones(){return g(this,null,function*(){this.isLoading=!0,this.transacciones=yield this.transaccionService.getTransacciones(),this.isLoading=!1})}updateTransaccion(){return g(this,null,function*(){this.validateCurrentTransaccion()&&(yield this.transaccionService.updateTransaccion(this.currentTransaccion),this.resetCurrentTransaccion(),yield this.updateTransacciones())})}setCurrentTransaccion(r){this.currentTransaccion=r,this.state=Rt.select,this.setValidation(!0),this.validateCurrentTransaccion()}resetCurrentTransaccion(){return g(this,null,function*(){this.currentTransaccion=new Fs({fecha:new Date().toLocaleString(),precio:0,metodoPago:"",coche:"",cliente:"",tipo:""}),this.state=Rt.create,this.setValidation(!1),this.validateCurrentTransaccion(),yield this.updateTransacciones()})}validateMetodoPago(){this.isMetodoPagoValid=this.currentTransaccion.metodoPago!==""||this.currentTransaccion.metodoPago===null,this.validateCurrentTransaccion()}validateCurrentTransaccion(){return this.isCurrentTransaccionValid=this.isMetodoPagoValid,this.isCurrentTransaccionValid}setValidation(r){this.isMetodoPagoValid=r}};e.\u0275fac=function(i){return new(i||e)(te(em))},e.\u0275cmp=cn({type:e,selectors:[["app-transacciones"]],decls:11,vars:3,consts:[[1,"page"],[1,"row","reverse"],[1,"input-column"],[4,"ngIf"],[1,"table-column"],["class","table",4,"ngIf"],[1,"input-row"],[3,"ngModelChange","input","ngModel","ngClass"],["value","efectivo"],["value","credito"],["value","debito"],[1,"container","botones"],[1,"btn","upd",3,"click","ngClass"],[1,"table"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],[1,"btn","btn-primary",3,"click"]],template:function(i,s){i&1&&(x(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),D(4,"Actualizar transacci\xF3n"),w(),vt(5,J7,14,7,"div",3),w(),x(6,"div",4)(7,"h2"),D(8,"Transacciones"),w(),vt(9,tH,15,1,"table",5)(10,nH,1,0,"app-loader",3),w()()()),i&2&&(L(5),z("ngIf",s.state===s.MODES.select),L(4),z("ngIf",!s.isLoading),L(),z("ngIf",s.isLoading))},dependencies:[da,ha,fa,am,cm,Ec,wc,_o,Cc]});let t=e;return t})();var ld=class{constructor(e){this.id="",this.nombre="",this.apellidos="",this.email="",this.telefono="",this.coches=[],this.transacciones=[],this.nombre=e.nombre,this.apellidos=e.apellidos,this.email=e.email,this.telefono=e.telefono}};var lm=t=>({invalid:t}),m2=t=>({disabled:t});function rH(t,e){t&1&&(x(0,"h2"),D(1,"A\xF1adir cliente"),w())}function iH(t,e){t&1&&(x(0,"h2"),D(1,"Modificar cliente"),w())}function sH(t,e){if(t&1){let n=mt();x(0,"div")(1,"button",12),de("click",function(){ye(n);let i=ee();return ve(i.createCliente())}),D(2,"A\xF1adir"),w()()}if(t&2){let n=ee();L(),z("ngClass",ot(1,m2,!n.isCurrentClienteValid))}}function oH(t,e){if(t&1){let n=mt();x(0,"div")(1,"button",13),de("click",function(){ye(n);let i=ee();return ve(i.updateCliente())}),D(2," Modificar "),w()()}if(t&2){let n=ee();L(),z("ngClass",ot(1,m2,!n.isCurrentClienteValid))}}function aH(t,e){if(t&1){let n=mt();x(0,"div")(1,"button",14),de("click",function(){ye(n);let i=ee();return ve(i.deleteCliente())}),D(2," Eliminar "),w()()}}function cH(t,e){if(t&1){let n=mt();x(0,"div")(1,"button",15),de("click",function(){ye(n);let i=ee();return ve(i.resetCurrentCliente())}),D(2," A\xF1adir nuevo "),w()()}}function lH(t,e){if(t&1){let n=mt();x(0,"tr",18)(1,"td"),D(2),w(),x(3,"td"),D(4),w(),x(5,"td"),D(6),w(),x(7,"td"),D(8),w(),x(9,"td")(10,"button",19),de("click",function(){let i=ye(n).$implicit,s=ee(2);return ve(s.setCurrentCliente(i))}),D(11," Editar "),w()()()}if(t&2){let n=e.$implicit;Ts("id",n.id),L(2),xt(n.nombre),L(2),xt(n.apellidos),L(2),xt(n.email),L(2),xt(n.telefono)}}function uH(t,e){if(t&1&&(x(0,"table",16)(1,"thead")(2,"tr")(3,"th"),D(4,"Nombre"),w(),x(5,"th"),D(6,"Apellidos"),w(),x(7,"th"),D(8,"Email"),w(),x(9,"th"),D(10,"Telefono"),w(),x(11,"th"),D(12,"Acciones"),w()()(),x(13,"tbody"),vt(14,lH,12,5,"tr",17),w()()),t&2){let n=ee();L(14),z("ngForOf",n.clientes)}}function dH(t,e){t&1&&dn(0,"app-loader")}var _2=(()=>{let e=class e{constructor(r){this.clienteService=r,this.isLoading=!0,this.isNombreValid=!1,this.isApellidosValid=!1,this.isEmailValid=!1,this.isTelefonoValid=!1,this.isCurrentClienteValid=!1,this.state=Rt.create,this.MODES=Rt,this.clientes=[],this.currentCliente=new ld({nombre:"",apellidos:"",email:"",telefono:""})}ngOnInit(){this.updateClientes()}updateClientes(){return g(this,null,function*(){this.isLoading=!0,this.clientes=yield this.clienteService.getClientes(),this.isLoading=!1})}createCliente(){return g(this,null,function*(){this.validateCurrentCliente()&&(yield this.clienteService.createCliente(this.currentCliente),this.resetCurrentCliente(),yield this.updateClientes())})}updateCliente(){return g(this,null,function*(){this.validateCurrentCliente()&&(yield this.clienteService.updateCliente(this.currentCliente),this.resetCurrentCliente(),yield this.updateClientes())})}deleteCliente(){return g(this,null,function*(){yield this.clienteService.deleteCliente(this.currentCliente.id),yield this.updateClientes(),this.resetCurrentCliente()})}setCurrentCliente(r){this.currentCliente=r,this.state=Rt.select,this.setValidation(!0),this.validateCurrentCliente()}resetCurrentCliente(){return g(this,null,function*(){this.currentCliente=new ld({nombre:"",apellidos:"",email:"",telefono:""}),this.state=Rt.create,this.setValidation(!1),this.validateCurrentCliente(),yield this.updateClientes()})}setValidation(r){this.isNombreValid=r,this.isApellidosValid=r,this.isEmailValid=r,this.isTelefonoValid=r}validateNombre(){this.isNombreValid=Bl(this.currentCliente.nombre),this.validateCurrentCliente()}validateApellidos(){this.isApellidosValid=Bl(this.currentCliente.apellidos),this.validateCurrentCliente()}validateEmail(){this.isEmailValid=T1(this.currentCliente.email),this.validateCurrentCliente()}validateTelefono(){this.isTelefonoValid=b1(this.currentCliente.telefono),this.validateCurrentCliente()}validateCurrentCliente(){return this.isCurrentClienteValid=this.isNombreValid&&this.isApellidosValid&&this.isEmailValid&&this.isTelefonoValid,this.isCurrentClienteValid}};e.\u0275fac=function(i){return new(i||e)(te(tm))},e.\u0275cmp=cn({type:e,selectors:[["app-clientes"]],decls:33,vars:24,consts:[[1,"page"],[1,"row"],[1,"input-column"],[1,"container-title"],[4,"ngIf"],[1,"container"],[1,"input-row"],["type","text",3,"ngModelChange","input","ngModel","ngClass"],["type","text","maxlength","10",3,"ngModelChange","input","ngModel","ngClass"],[1,"container","botones"],[1,"table-column"],["class","table",4,"ngIf"],[1,"btn","add",3,"click","ngClass"],[1,"btn","mod",3,"click","ngClass"],[1,"btn","del",3,"click"],[1,"btn","add",3,"click"],[1,"table"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],[1,"btn","btn-primary",3,"click"]],template:function(i,s){i&1&&(x(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),vt(4,rH,2,0,"h2",4)(5,iH,2,0,"h2",4),w(),x(6,"div",5)(7,"div",6)(8,"label"),D(9," Nombre "),x(10,"input",7),Bt("ngModelChange",function(a){return Yt(s.currentCliente.nombre,a)||(s.currentCliente.nombre=a),a}),de("input",function(){return s.validateNombre()}),w()()(),x(11,"div",6)(12,"label"),D(13," Apellidos "),x(14,"input",7),Bt("ngModelChange",function(a){return Yt(s.currentCliente.apellidos,a)||(s.currentCliente.apellidos=a),a}),de("input",function(){return s.validateApellidos()}),w()()(),x(15,"div",6)(16,"label"),D(17," Email "),x(18,"input",7),Bt("ngModelChange",function(a){return Yt(s.currentCliente.email,a)||(s.currentCliente.email=a),a}),de("input",function(){return s.validateEmail()}),w()()(),x(19,"div",6)(20,"label"),D(21," Telefono "),x(22,"input",8),Bt("ngModelChange",function(a){return Yt(s.currentCliente.telefono,a)||(s.currentCliente.telefono=a),a}),de("input",function(){return s.validateTelefono()}),w()()(),x(23,"div",9),vt(24,sH,3,3,"div",4)(25,oH,3,3,"div",4)(26,aH,3,0,"div",4)(27,cH,3,0,"div",4),w()()(),x(28,"div",10)(29,"h2"),D(30,"Clientes"),w(),vt(31,uH,15,1,"table",11)(32,dH,1,0,"app-loader",4),w()()()),i&2&&(L(4),z("ngIf",s.state===s.MODES.create),L(),z("ngIf",s.state===s.MODES.select),L(5),jt("ngModel",s.currentCliente.nombre),z("ngClass",ot(16,lm,!s.isNombreValid)),L(4),jt("ngModel",s.currentCliente.apellidos),z("ngClass",ot(18,lm,!s.isApellidosValid)),L(4),jt("ngModel",s.currentCliente.email),z("ngClass",ot(20,lm,!s.isEmailValid)),L(4),jt("ngModel",s.currentCliente.telefono),z("ngClass",ot(22,lm,!s.isTelefonoValid)),L(2),z("ngIf",s.state===s.MODES.create),L(),z("ngIf",s.state===s.MODES.select),L(),z("ngIf",s.state===s.MODES.select),L(),z("ngIf",s.state===s.MODES.select),L(4),z("ngIf",!s.isLoading),L(),z("ngIf",s.isLoading))},dependencies:[da,ha,fa,xc,wc,PC,_o,Cc]});let t=e;return t})();var hH=[{path:"home",component:Sv},{path:"coches",component:p2},{path:"transacciones",component:g2},{path:"clientes",component:_2},{path:"**",component:Sv}],y2=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=it({type:e}),e.\u0275inj=rt({imports:[Tv.forRoot(hH),Tv]});let t=e;return t})();var v2={production:!1,firebaseConfig:{apiKey:"AIzaSyAMKh_kgg0H6tNsbFMzG6bnrUO_GXcEPZU",authDomain:"car-b8820.firebaseapp.com",projectId:"car-b8820",storageBucket:"car-b8820.appspot.com",messagingSenderId:"312572004386",appId:"1:312572004386:web:78a5bf3d16d316157b227b"}};var x2="@firebase/database",w2="1.0.4";var WI="";function KI(t){WI=t}var HC=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),et(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Kd(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var qC=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return bn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var X2=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new HC(e)}}catch{}return new qC},xo=X2("localStorage"),GC=X2("sessionStorage");var Tc=new fi("@firebase/database"),J2=function(){let t=1;return function(){return t++}}(),eO=function(t){let e=$b(t),n=new Ub;n.update(e);let r=n.digest();return Gd.encodeByteArray(r)},Pd=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Pd.apply(null,r):typeof r=="object"?e+=et(r):e+=r,e+=" "}return e},wo=null,E2=!0,tO=function(t,e){T(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Tc.logLevel=Dn.VERBOSE,wo=Tc.log.bind(Tc),e&&GC.set("logging_enabled",!0)):typeof t=="function"?wo=t:(wo=null,GC.remove("logging_enabled"))},Dt=function(...t){if(E2===!0&&(E2=!1,wo===null&&GC.get("logging_enabled")===!0&&tO(!0)),wo){let e=Pd.apply(null,t);wo(e)}},kd=function(t){return function(...e){Dt(t,...e)}},zC=function(...t){let e="FIREBASE INTERNAL ERROR: "+Pd(...t);Tc.error(e)},Vr=function(...t){let e=`FIREBASE FATAL ERROR: ${Pd(...t)}`;throw Tc.error(e),new Error(e)},Gt=function(...t){let e="FIREBASE WARNING: "+Pd(...t);Tc.warn(e)},fH=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Gt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Vm=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},pH=function(t){if(ar()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},is="[MIN_NAME]",ui="[MAX_NAME]",Co=function(t,e){if(t===e)return 0;if(t===is||e===ui)return-1;if(e===is||t===ui)return 1;{let n=C2(t),r=C2(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},gH=function(t,e){return t===e?0:t<e?-1:1},ud=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+et(e))},QI=function(t){if(typeof t!="object"||t===null)return et(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=et(e[r]),n+=":",n+=QI(t[e[r]]);return n+="}",n},nO=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function Tt(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var rO=function(t){T(!Vm(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,c;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let l=[];for(c=n;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let u=l.join(""),d="";for(c=0;c<64;c+=8){let h=parseInt(u.substr(c,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},mH=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},_H=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function yH(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var vH=new RegExp("^-?(0*)\\d{1,10}$"),xH=-2147483648,wH=2147483647,C2=function(t){if(vH.test(t)){let e=Number(t);if(e>=xH&&e<=wH)return e}return null},Fc=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw Gt("Exception was thrown by user callback.",n),e},Math.floor(0))}},EH=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},pd=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var WC=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Gt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var KC=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Dt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Gt(e)}},gd=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),dm="5",iO="v",sO="s",oO="r",aO="f",cO=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,lO="ls",uO="p",QC="ac",dO="websocket",hO="long_polling";var hm=class{constructor(e,n,r,i,s=!1,o="",a=!1,c=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=xo.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&xo.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function CH(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function fO(t,e,n){T(typeof e=="string","typeof type must == string"),T(typeof n=="object","typeof params must == object");let r;if(e===dO)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===hO)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);CH(t)&&(n.ns=t.namespace);let i=[];return Tt(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var YC=class{constructor(){this.counters_={}}incrementCounter(e,n=1){bn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return kb(this.counters_)}};var FC={},VC={};function YI(t){let e=t.toString();return FC[e]||(FC[e]=new YC),FC[e]}function IH(t,e){let n=t.toString();return VC[n]||(VC[n]=e()),VC[n]}var ZC=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Fc(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var I2="start",bH="close",DH="pLPCommand",TH="pRTLPCB",pO="id",gO="pw",mO="ser",SH="cb",AH="seg",MH="ts",NH="d",RH="dframe",_O=1870,yO=30,PH=_O-yO,kH=25e3,OH=3e4,vd=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=kd(e),this.stats_=YI(n),this.urlFn=c=>(this.appCheckToken&&(c[QC]=this.appCheckToken),fO(n,hO,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new ZC(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(OH)),pH(()=>{if(this.isClosed_)return;this.scriptTagHolder=new XC((...s)=>{let[o,a,c,l,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===I2)this.id=a,this.password=c;else if(o===bH)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[I2]="t",r[mO]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[SH]=this.scriptTagHolder.uniqueCallbackIdentifier),r[iO]=dm,this.transportSessionId&&(r[sO]=this.transportSessionId),this.lastSessionId&&(r[lO]=this.lastSessionId),this.applicationId&&(r[uO]=this.applicationId),this.appCheckToken&&(r[QC]=this.appCheckToken),typeof location<"u"&&location.hostname&&cO.test(location.hostname)&&(r[oO]=aO);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return ar()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!mH()&&!_H()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=et(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=Pb(n),i=nO(r,PH);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(ar())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[RH]="t",r[pO]=e,r[gO]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=et(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},XC=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,ar())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=J2(),window[DH+this.uniqueCallbackIdentifier]=e,window[TH+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Dt("frame writing exception"),a.stack&&Dt(a.stack),Dt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Dt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[pO]=this.myID,e[gO]=this.myPW,e[mO]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+yO+r.length<=_O;){let o=this.pendingSegs.shift();r=r+"&"+AH+i+"="+o.seg+"&"+MH+i+"="+o.ts+"&"+NH+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(kH)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){ar()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Dt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var FH=16384,VH=45e3,fm=null;typeof MozWebSocket<"u"?fm=MozWebSocket:typeof WebSocket<"u"&&(fm=WebSocket);var bc=(()=>{class t{constructor(n,r,i,s,o,a,c){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=kd(this.connId),this.stats_=YI(r),this.connURL=t.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[iO]=dm,!ar()&&typeof location<"u"&&location.hostname&&cO.test(location.hostname)&&(a[oO]=aO),r&&(a[sO]=r),i&&(a[lO]=i),s&&(a[QC]=s),o&&(a[uO]=o),fO(n,dO,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,xo.set("previous_websocket_failure",!0);try{let i;if(ar()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${dm}/${WI}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new fm(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&fm!==null&&!t.forceDisallow_}static previouslyFailed(){return xo.isInMemoryStorage||xo.get("previous_websocket_failure")===!0}markConnectionHealthy(){xo.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=Kd(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(T(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=et(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=nO(r,FH);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(VH))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),vO=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[vd,bc]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=bc&&bc.isAvailable(),i=r&&!bc.previouslyFailed();if(n.webSocketOnly&&(r||Gt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[bc];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),LH=6e4,jH=5e3,BH=10*1024,UH=100*1024,LC="t",b2="d",$H="s",D2="r",HH="e",T2="o",S2="a",A2="n",M2="p",qH="h",JC=class{constructor(e,n,r,i,s,o,a,c,l,u){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=kd("c:"+this.id+":"),this.transportManager_=new vO(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=pd(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>UH?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>BH?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(LC in e){let n=e[LC];n===S2?this.upgradeIfSecondaryHealthy_():n===D2?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===T2&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=ud("t",e),r=ud("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:M2,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:S2,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:A2,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=ud("t",e),r=ud("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=ud(LC,e);if(b2 in e){let r=e[b2];if(n===qH){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===A2){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===$H?this.onConnectionShutdown_(r):n===D2?this.onReset_(r):n===HH?zC("Server Error: "+r):n===T2?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):zC("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),dm!==r&&Gt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),pd(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(LH))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):pd(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(jH))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:M2,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(xo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var pm=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var gm=class{constructor(e){this.allowedEvents_=e,this.listeners_={},T(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){T(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var mm=class t extends gm{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!i_()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return T(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var N2=32,R2=768,be=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function Ie(){return new be("")}function ce(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function ss(t){return t.pieces_.length-t.pieceNum_}function Oe(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new be(t.pieces_,e)}function ZI(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function GH(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function xd(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function xO(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new be(e,0)}function $e(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof be)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new be(n,0)}function le(t){return t.pieceNum_>=t.pieces_.length}function tn(t,e){let n=ce(t),r=ce(e);if(n===null)return e;if(n===r)return tn(Oe(t),Oe(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function zH(t,e){let n=xd(t,0),r=xd(e,0);for(let i=0;i<n.length&&i<r.length;i++){let s=Co(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function XI(t,e){if(ss(t)!==ss(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function jn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(ss(t)>ss(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var eI=class{constructor(e,n){this.errorPrefix_=n,this.parts_=xd(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Hc(this.parts_[r]);wO(this)}};function WH(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Hc(e),wO(t)}function KH(t){let e=t.parts_.pop();t.byteLength_-=Hc(e),t.parts_.length>0&&(t.byteLength_-=1)}function wO(t){if(t.byteLength_>R2)throw new Error(t.errorPrefix_+"has a key path longer than "+R2+" bytes ("+t.byteLength_+").");if(t.parts_.length>N2)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+N2+") or object contains a cycle "+vo(t))}function vo(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var tI=class t extends gm{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return T(e==="visible","Unknown event type: "+e),[this.visible_]}};var dd=1e3,QH=60*5*1e3,P2=30*1e3,YH=1.3,ZH=3e4,XH="server_kill",k2=3,JI=(()=>{class t extends pm{constructor(n,r,i,s,o,a,c,l){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=l,this.id=t.nextPersistentConnectionId_++,this.log_=kd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=dd,this.maxReconnectDelay_=QH,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!ar())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");tI.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&mm.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(et(o)),T(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new yt,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),T(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),T(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,c=>{let l=c.d,u=c.s;t.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",c),u!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(u,l))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&bn(n,"w")){let i=hi(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Gt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||jb(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=P2)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=Lb(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),T(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+et(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):zC("Unrecognized action received from server: "+et(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){T(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=dd,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=dd,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>ZH&&(this.reconnectDelay_=dd),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*YH)}this.onConnectStatus_(!1)}establishConnection_(){return g(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,l=function(){c?c.close():(a=!0,i())},u=function(h){T(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(h)};this.realtime_={close:l,sendRequest:u};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?Dt("getToken() completed but was canceled"):(Dt("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,c=new JC(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,p=>{Gt(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(XH)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&Gt(h),l())}}})}interrupt(n){Dt("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){Dt("Resuming connection for reason: "+n),delete this.interruptReasons_[n],Qd(this.interruptReasons_)&&(this.reconnectDelay_=dd,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>QI(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new be(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){Dt("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=k2&&(this.reconnectDelay_=P2,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){Dt("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=k2&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";ar()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+WI.replace(/\./g,"-")]=1,i_()?n["framework.cordova"]=1:Ob()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=mm.getInstance().currentlyOnline();return Qd(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),he=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var Sc=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new he(is,e),i=new he(is,n);return this.compare(r,i)!==0}minPost(){return he.MIN}};var um,_m=class extends Sc{static get __EMPTY_NODE(){return um}static set __EMPTY_NODE(e){um=e}compare(e,n){return Co(e.name,n.name)}isDefinedOn(e){throw So("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return he.MIN}maxPost(){return new he(ui,um)}makePost(e,n){return T(typeof e=="string","KeyIndex indexValue must always be a string."),new he(e,um)}toString(){return".key"}},Fr=new _m;var Dc=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},sr=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??Bn.EMPTY_NODE,this.right=o??Bn.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Bn.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return Bn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),nI=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new sr(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Bn=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,sr.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,sr.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Dc(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Dc(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Dc(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Dc(this.root_,null,this.comparator_,!0,e)}};Bn.EMPTY_NODE=new nI;function JH(t,e){return Co(t.name,e.name)}function eb(t,e){return Co(t,e)}var rI;function eq(t){rI=t}var EO=function(t){return typeof t=="number"?"number:"+rO(t):"string:"+t},CO=function(t){if(t.isLeafNode()){let e=t.val();T(typeof e=="string"||typeof e=="number"||typeof e=="object"&&bn(e,".sv"),"Priority must be a string or number.")}else T(t===rI||t.isEmpty(),"priority of unexpected type.");T(t===rI||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var O2,Ac=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,T(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),CO(this.priorityNode_)}static set __childrenNodeConstructor(n){O2=n}static get __childrenNodeConstructor(){return O2}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return le(n)?this:ce(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=ce(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(T(i!==".priority"||ss(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Oe(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+EO(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=rO(this.value_):n+=this.value_,this.lazyHash_=eO(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(T(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return T(s>=0,"Unknown leaf type: "+r),T(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),IO,bO;function tq(t){IO=t}function nq(t){bO=t}var iI=class extends Sc{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?Co(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return he.MIN}maxPost(){return new he(ui,new Ac("[PRIORITY-POST]",bO))}makePost(e,n){let r=IO(e);return new he(n,new Ac("[PRIORITY-POST]",r))}toString(){return".priority"}},Ve=new iI;var rq=Math.log(2),sI=class{constructor(e){let n=s=>parseInt(Math.log(s)/rq,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},ym=function(t,e,n,r){t.sort(e);let i=function(c,l){let u=l-c,d,h;if(u===0)return null;if(u===1)return d=t[c],h=n?n(d):d,new sr(h,d.node,sr.BLACK,null,null);{let f=parseInt(u/2,10)+c,p=i(c,f),m=i(f+1,l);return d=t[f],h=n?n(d):d,new sr(h,d.node,sr.BLACK,p,m)}},s=function(c){let l=null,u=null,d=t.length,h=function(p,m){let v=d-p,b=d;d-=p;let F=i(v+1,b),S=t[v],q=n?n(S):S;f(new sr(q,S.node,m,null,F))},f=function(p){l?(l.left=p,l=p):(u=p,l=p)};for(let p=0;p<c.count;++p){let m=c.nextBitIsOne(),v=Math.pow(2,c.count-(p+1));m?h(v,sr.BLACK):(h(v,sr.BLACK),h(v,sr.RED))}return u},o=new sI(t.length),a=s(o);return new Bn(r||e,a)};var jC,Ic={},Mc=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return T(Ic&&Ve,"ChildrenNode.ts has not been loaded"),jC=jC||new t({".priority":Ic},{".priority":Ve}),jC}get(e){let n=hi(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Bn?n:null}hasIndex(e){return bn(this.indexSet_,e.toString())}addIndex(e,n){T(e!==Fr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(he.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=ym(r,e.getCompare()):a=Ic;let c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;let u=Object.assign({},this.indexes_);return u[c]=a,new t(u,l)}addToIndexes(e,n){let r=$c(this.indexes_,(i,s)=>{let o=hi(this.indexSet_,s);if(T(o,"Missing index implementation for "+s),i===Ic)if(o.isDefinedOn(e.node)){let a=[],c=n.getIterator(he.Wrap),l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),ym(a,o.getCompare())}else return Ic;else{let a=n.get(e.name),c=i;return a&&(c=c.remove(new he(e.name,a))),c.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=$c(this.indexes_,i=>{if(i===Ic)return i;{let s=n.get(e.name);return s?i.remove(new he(e.name,s)):i}});return new t(r,this.indexSet_)}};var hd,re=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&CO(this.priorityNode_),this.children_.isEmpty()&&T(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return hd||(hd=new t(new Bn(eb),null,Mc.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||hd}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?hd:r}}getChild(n){let r=ce(n);return r===null?this:this.getImmediateChild(r).getChild(Oe(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(T(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new he(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?hd:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=ce(n);if(i===null)return r;{T(ce(n)!==".priority"||ss(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Oe(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Ve,(a,c)=>{r[a]=c.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+EO(this.getPriority().val())+":"),this.forEachChild(Ve,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":eO(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new he(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new he(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new he(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,he.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,he.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===Od?-1:0}withIndex(n){if(n===Fr||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===Fr||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Ve),s=r.getIterator(Ve),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===Fr?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),oI=class extends re{constructor(){super(new Bn(eb),re.EMPTY_NODE,Mc.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return re.EMPTY_NODE}isEmpty(){return!1}},Od=new oI;Object.defineProperties(he,{MIN:{value:new he(is,re.EMPTY_NODE)},MAX:{value:new he(ui,Od)}});_m.__EMPTY_NODE=re.EMPTY_NODE;Ac.__childrenNodeConstructor=re;eq(Od);nq(Od);var iq=!0;function qe(t,e=null){if(t===null)return re.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),T(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new Ac(n,qe(e))}if(!(t instanceof Array)&&iq){let n=[],r=!1;if(Tt(t,(o,a)=>{if(o.substring(0,1)!=="."){let c=qe(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),n.push(new he(o,c)))}}),n.length===0)return re.EMPTY_NODE;let s=ym(n,JH,o=>o.name,eb);if(r){let o=ym(n,Ve.getCompare());return new re(s,qe(e),new Mc({".priority":o},{".priority":Ve}))}else return new re(s,qe(e),Mc.Default)}else{let n=re.EMPTY_NODE;return Tt(t,(r,i)=>{if(bn(t,r)&&r.substring(0,1)!=="."){let s=qe(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(qe(e))}}tq(qe);var wd=class extends Sc{constructor(e){super(),this.indexPath_=e,T(!le(e)&&ce(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?Co(e.name,n.name):s}makePost(e,n){let r=qe(e),i=re.EMPTY_NODE.updateChild(this.indexPath_,r);return new he(n,i)}maxPost(){let e=re.EMPTY_NODE.updateChild(this.indexPath_,Od);return new he(ui,e)}toString(){return xd(this.indexPath_,0).join("/")}};var aI=class extends Sc{compare(e,n){let r=e.node.compareTo(n.node);return r===0?Co(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return he.MIN}maxPost(){return he.MAX}makePost(e,n){let r=qe(e);return new he(n,r)}toString(){return".value"}},tb=new aI;function DO(t){return{type:"value",snapshotNode:t}}function Nc(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Ed(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Cd(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function sq(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var Id=class{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){T(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(Ed(n,a)):T(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Nc(n,r)):o.trackChildChange(Cd(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Ve,(i,s)=>{n.hasChild(i)||r.trackChildChange(Ed(i,s))}),n.isLeafNode()||n.forEachChild(Ve,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Cd(i,s,o))}else r.trackChildChange(Nc(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?re.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var vm=class t{constructor(e){this.indexedFilter_=new Id(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new he(n,r))||(r=re.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=re.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(re.EMPTY_NODE);let s=this;return n.forEachChild(Ve,(o,a)=>{s.matches(new he(o,a))||(i=i.updateImmediateChild(o,re.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var cI=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{let r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new vm(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new he(n,r))||(r=re.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=re.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=re.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(re.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,re.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();let a=e;T(a.numChildren()===this.limit_,"");let c=new he(n,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(c);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=i.getChildAfterChild(this.index_,l,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);let f=h==null?1:o(h,c);if(u&&!r.isEmpty()&&f>=0)return s?.trackChildChange(Cd(n,r,d)),a.updateImmediateChild(n,r);{s?.trackChildChange(Ed(n,d));let m=a.updateImmediateChild(n,re.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(Nc(h.name,h.node)),m.updateImmediateChild(h.name,h.node)):m}}else return r.isEmpty()?e:u&&o(l,c)>=0?(s!=null&&(s.trackChildChange(Ed(l.name,l.node)),s.trackChildChange(Nc(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(l.name,re.EMPTY_NODE)):e}};var bd=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ve}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return T(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return T(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:is}hasEnd(){return this.endSet_}getIndexEndValue(){return T(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return T(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ui}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return T(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ve}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function oq(t){return t.loadsAllData()?new Id(t.getIndex()):t.hasLimit()?new cI(t):new vm(t)}function aq(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function cq(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function lI(t,e,n){let r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function lq(t,e,n){let r;return t.index_===Fr||n?r=lI(t,e,n):r=lI(t,e,ui),r.startAfterSet_=!0,r}function uI(t,e,n){let r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function uq(t,e,n){let r;return t.index_===Fr||n?r=uI(t,e,n):r=uI(t,e,is),r.endBeforeSet_=!0,r}function Lm(t,e){let n=t.copy();return n.index_=e,n}function F2(t){let e={};if(t.isDefault())return e;let n;if(t.index_===Ve?n="$priority":t.index_===tb?n="$value":t.index_===Fr?n="$key":(T(t.index_ instanceof wd,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=et(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=et(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+et(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=et(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+et(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function V2(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Ve&&(e.i=t.index_.toString()),e}var dI=class t extends pm{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=kd("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(T(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let c=F2(e._queryParams);this.restRequest_(s+".json",c,(l,u)=>{let d=u;if(l===404&&(d=null,l=null),l===null&&this.onDataUpdate_(s,d,!1,r),hi(this.listens_,o)===a){let h;l?l===401?h="permission_denied":h="rest_error:"+l:h="ok",i(h,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=F2(e._queryParams),r=e._path.toString(),i=new yt;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Bb(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=Kd(a.responseText)}catch{Gt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&Gt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var hI=class{constructor(){this.rootNode_=re.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function xm(){return{value:null,children:new Map}}function Vc(t,e,n){if(le(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=ce(e);t.children.has(r)||t.children.set(r,xm());let i=t.children.get(r);e=Oe(e),Vc(i,e,n)}}function fI(t,e){if(le(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(Ve,(r,i)=>{Vc(t,new be(r),i)}),fI(t,e)}}else if(t.children.size>0){let n=ce(e);return e=Oe(e),t.children.has(n)&&fI(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function pI(t,e,n){t.value!==null?n(e,t.value):dq(t,(r,i)=>{let s=new be(e.toString()+"/"+r);pI(i,s,n)})}function dq(t,e){t.children.forEach((n,r)=>{e(r,n)})}var gI=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Tt(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var L2=10*1e3,hq=30*1e3,fq=5*60*1e3,mI=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new gI(e);let r=L2+(hq-L2)*Math.random();pd(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;Tt(e,(i,s)=>{s>0&&bn(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),pd(this.reportStats_.bind(this),Math.floor(Math.random()*2*fq))}};var Or=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(Or||{});function nb(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function rb(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function ib(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var _I=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Or.ACK_USER_WRITE,this.source=nb()}operationForChild(e){if(le(this.path)){if(this.affectedTree.value!=null)return T(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new be(e));return new t(Ie(),n,this.revert)}}else return T(ce(this.path)===e,"operationForChild called for unrelated child."),new t(Oe(this.path),this.affectedTree,this.revert)}};var wm=class t{constructor(e,n){this.source=e,this.path=n,this.type=Or.LISTEN_COMPLETE}operationForChild(e){return le(this.path)?new t(this.source,Ie()):new t(this.source,Oe(this.path))}};var Rc=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Or.OVERWRITE}operationForChild(e){return le(this.path)?new t(this.source,Ie(),this.snap.getImmediateChild(e)):new t(this.source,Oe(this.path),this.snap)}};var Dd=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Or.MERGE}operationForChild(e){if(le(this.path)){let n=this.children.subtree(new be(e));return n.isEmpty()?null:n.value?new Rc(this.source,Ie(),n.value):new t(this.source,Ie(),n)}else return T(ce(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,Oe(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Lr=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(le(e))return this.isFullyInitialized()&&!this.filtered_;let n=ce(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var yI=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function pq(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(sq(o.childName,o.snapshotNode))}),fd(t,i,"child_removed",e,r,n),fd(t,i,"child_added",e,r,n),fd(t,i,"child_moved",s,r,n),fd(t,i,"child_changed",e,r,n),fd(t,i,"value",e,r,n),i}function fd(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,c)=>mq(t,a,c)),o.forEach(a=>{let c=gq(t,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,t.query_))})})}function gq(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function mq(t,e,n){if(e.childName==null||n.childName==null)throw So("Should only compare child_ events.");let r=new he(e.childName,e.snapshotNode),i=new he(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function jm(t,e){return{eventCache:t,serverCache:e}}function md(t,e,n,r){return jm(new Lr(e,n,r),t.serverCache)}function TO(t,e,n,r){return jm(t.eventCache,new Lr(e,n,r))}function Em(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Eo(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var BC,_q=()=>(BC||(BC=new Bn(gH)),BC),nn=class t{constructor(e,n=_q()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return Tt(e,(r,i)=>{n=n.set(new be(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Ie(),value:this.value};if(le(e))return null;{let r=ce(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Oe(e),n);return s!=null?{path:$e(new be(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(le(e))return this;{let n=ce(e),r=this.children.get(n);return r!==null?r.subtree(Oe(e)):new t(null)}}set(e,n){if(le(e))return new t(n,this.children);{let r=ce(e),s=(this.children.get(r)||new t(null)).set(Oe(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(le(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=ce(e),r=this.children.get(n);if(r){let i=r.remove(Oe(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(le(e))return this.value;{let n=ce(e),r=this.children.get(n);return r?r.get(Oe(e)):null}}setTree(e,n){if(le(e))return n;{let r=ce(e),s=(this.children.get(r)||new t(null)).setTree(Oe(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(Ie(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_($e(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,Ie(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(le(e))return null;{let s=ce(e),o=this.children.get(s);return o?o.findOnPath_(Oe(e),$e(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Ie(),n)}foreachOnPath_(e,n,r){if(le(e))return this;{this.value&&r(n,this.value);let i=ce(e),s=this.children.get(i);return s?s.foreachOnPath_(Oe(e),$e(n,i),r):new t(null)}}foreach(e){this.foreach_(Ie(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_($e(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var or=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new nn(null))}};function _d(t,e,n){if(le(e))return new or(new nn(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=tn(i,e);return s=s.updateChild(o,n),new or(t.writeTree_.set(i,s))}else{let i=new nn(n),s=t.writeTree_.setTree(e,i);return new or(s)}}}function vI(t,e,n){let r=t;return Tt(n,(i,s)=>{r=_d(r,$e(e,i),s)}),r}function j2(t,e){if(le(e))return or.empty();{let n=t.writeTree_.setTree(e,new nn(null));return new or(n)}}function xI(t,e){return Io(t,e)!=null}function Io(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(tn(n.path,e)):null}function B2(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Ve,(r,i)=>{e.push(new he(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new he(r,i.value))}),e}function ns(t,e){if(le(e))return t;{let n=Io(t,e);return n!=null?new or(new nn(n)):new or(t.writeTree_.subtree(e))}}function wI(t){return t.writeTree_.isEmpty()}function Pc(t,e){return SO(Ie(),t.writeTree_,e)}function SO(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(T(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=SO($e(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild($e(t,".priority"),r)),n}}function Bm(t,e){return RO(e,t)}function yq(t,e,n,r,i){T(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=_d(t.visibleWrites,e,n)),t.lastWriteId=r}function vq(t,e,n,r){T(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=vI(t.visibleWrites,e,n),t.lastWriteId=r}function xq(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function wq(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);T(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&Eq(a,r.path)?i=!1:jn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return Cq(t),!0;if(r.snap)t.visibleWrites=j2(t.visibleWrites,r.path);else{let a=r.children;Tt(a,c=>{t.visibleWrites=j2(t.visibleWrites,$e(r.path,c))})}return!0}else return!1}function Eq(t,e){if(t.snap)return jn(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&jn($e(t.path,n),e))return!0;return!1}function Cq(t){t.visibleWrites=AO(t.allWrites,Iq,Ie()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function Iq(t){return t.visible}function AO(t,e,n){let r=or.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)jn(n,o)?(a=tn(n,o),r=_d(r,a,s.snap)):jn(o,n)&&(a=tn(o,n),r=_d(r,Ie(),s.snap.getChild(a)));else if(s.children){if(jn(n,o))a=tn(n,o),r=vI(r,a,s.children);else if(jn(o,n))if(a=tn(o,n),le(a))r=vI(r,Ie(),s.children);else{let c=hi(s.children,ce(a));if(c){let l=c.getChild(Oe(a));r=_d(r,Ie(),l)}}}else throw So("WriteRecord should have .snap or .children")}}return r}function MO(t,e,n,r,i){if(!r&&!i){let s=Io(t.visibleWrites,e);if(s!=null)return s;{let o=ns(t.visibleWrites,e);if(wI(o))return n;if(n==null&&!xI(o,Ie()))return null;{let a=n||re.EMPTY_NODE;return Pc(o,a)}}}else{let s=ns(t.visibleWrites,e);if(!i&&wI(s))return n;if(!i&&n==null&&!xI(s,Ie()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(jn(l.path,e)||jn(e,l.path))},a=AO(t.allWrites,o,e),c=n||re.EMPTY_NODE;return Pc(a,c)}}}function bq(t,e,n){let r=re.EMPTY_NODE,i=Io(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ve,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=ns(t.visibleWrites,e);return n.forEachChild(Ve,(o,a)=>{let c=Pc(ns(s,new be(o)),a);r=r.updateImmediateChild(o,c)}),B2(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=ns(t.visibleWrites,e);return B2(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function Dq(t,e,n,r,i){T(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=$e(e,n);if(xI(t.visibleWrites,s))return null;{let o=ns(t.visibleWrites,s);return wI(o)?i.getChild(n):Pc(o,i.getChild(n))}}function Tq(t,e,n,r){let i=$e(e,n),s=Io(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=ns(t.visibleWrites,i);return Pc(o,r.getNode().getImmediateChild(n))}else return null}function Sq(t,e){return Io(t.visibleWrites,e)}function Aq(t,e,n,r,i,s,o){let a,c=ns(t.visibleWrites,e),l=Io(c,Ie());if(l!=null)a=l;else if(n!=null)a=Pc(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let u=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),f=h.getNext();for(;f&&u.length<i;)d(f,r)!==0&&u.push(f),f=h.getNext();return u}else return[]}function Mq(){return{visibleWrites:or.empty(),allWrites:[],lastWriteId:-1}}function Cm(t,e,n,r){return MO(t.writeTree,t.treePath,e,n,r)}function sb(t,e){return bq(t.writeTree,t.treePath,e)}function U2(t,e,n,r){return Dq(t.writeTree,t.treePath,e,n,r)}function Im(t,e){return Sq(t.writeTree,$e(t.treePath,e))}function Nq(t,e,n,r,i,s){return Aq(t.writeTree,t.treePath,e,n,r,i,s)}function ob(t,e,n){return Tq(t.writeTree,t.treePath,e,n)}function NO(t,e){return RO($e(t.treePath,e),t.writeTree)}function RO(t,e){return{treePath:t,writeTree:e}}var EI=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;T(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),T(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,Cd(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,Ed(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,Nc(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,Cd(r,e.snapshotNode,i.oldSnap));else throw So("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var CI=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},PO=new CI,Td=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new Lr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return ob(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Eo(this.viewCache_),s=Nq(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function Rq(t){return{filter:t}}function Pq(t,e){T(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),T(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function kq(t,e,n,r,i){let s=new EI,o,a;if(n.type===Or.OVERWRITE){let l=n;l.source.fromUser?o=II(t,e,l.path,l.snap,r,i,s):(T(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!le(l.path),o=bm(t,e,l.path,l.snap,r,i,a,s))}else if(n.type===Or.MERGE){let l=n;l.source.fromUser?o=Fq(t,e,l.path,l.children,r,i,s):(T(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=bI(t,e,l.path,l.children,r,i,a,s))}else if(n.type===Or.ACK_USER_WRITE){let l=n;l.revert?o=jq(t,e,l.path,r,i,s):o=Vq(t,e,l.path,l.affectedTree,r,i,s)}else if(n.type===Or.LISTEN_COMPLETE)o=Lq(t,e,n.path,r,s);else throw So("Unknown operation type: "+n.type);let c=s.getChanges();return Oq(e,o,c),{viewCache:o,changes:c}}function Oq(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Em(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(DO(Em(e)))}}function kO(t,e,n,r,i,s){let o=e.eventCache;if(Im(r,n)!=null)return e;{let a,c;if(le(n))if(T(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=Eo(e),u=l instanceof re?l:re.EMPTY_NODE,d=sb(r,u);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let l=Cm(r,Eo(e));a=t.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=ce(n);if(l===".priority"){T(ss(n)===1,"Can't have a priority with additional path components");let u=o.getNode();c=e.serverCache.getNode();let d=U2(r,n,u,c);d!=null?a=t.filter.updatePriority(u,d):a=o.getNode()}else{let u=Oe(n),d;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();let h=U2(r,n,o.getNode(),c);h!=null?d=o.getNode().getImmediateChild(l).updateChild(u,h):d=o.getNode().getImmediateChild(l)}else d=ob(r,l,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),l,d,u,i,s):a=o.getNode()}}return md(e,a,o.isFullyInitialized()||le(n),t.filter.filtersNodes())}}function bm(t,e,n,r,i,s,o,a){let c=e.serverCache,l,u=o?t.filter:t.filter.getIndexedFilter();if(le(n))l=u.updateFullNode(c.getNode(),r,null);else if(u.filtersNodes()&&!c.isFiltered()){let f=c.getNode().updateChild(n,r);l=u.updateFullNode(c.getNode(),f,null)}else{let f=ce(n);if(!c.isCompleteForPath(n)&&ss(n)>1)return e;let p=Oe(n),v=c.getNode().getImmediateChild(f).updateChild(p,r);f===".priority"?l=u.updatePriority(c.getNode(),v):l=u.updateChild(c.getNode(),f,v,p,PO,null)}let d=TO(e,l,c.isFullyInitialized()||le(n),u.filtersNodes()),h=new Td(i,d,s);return kO(t,d,n,i,h,a)}function II(t,e,n,r,i,s,o){let a=e.eventCache,c,l,u=new Td(i,e,s);if(le(n))l=t.filter.updateFullNode(e.eventCache.getNode(),r,o),c=md(e,l,!0,t.filter.filtersNodes());else{let d=ce(n);if(d===".priority")l=t.filter.updatePriority(e.eventCache.getNode(),r),c=md(e,l,a.isFullyInitialized(),a.isFiltered());else{let h=Oe(n),f=a.getNode().getImmediateChild(d),p;if(le(h))p=r;else{let m=u.getCompleteChild(d);m!=null?ZI(h)===".priority"&&m.getChild(xO(h)).isEmpty()?p=m:p=m.updateChild(h,r):p=re.EMPTY_NODE}if(f.equals(p))c=e;else{let m=t.filter.updateChild(a.getNode(),d,p,h,u,o);c=md(e,m,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function $2(t,e){return t.eventCache.isCompleteForChild(e)}function Fq(t,e,n,r,i,s,o){let a=e;return r.foreach((c,l)=>{let u=$e(n,c);$2(e,ce(u))&&(a=II(t,a,u,l,i,s,o))}),r.foreach((c,l)=>{let u=$e(n,c);$2(e,ce(u))||(a=II(t,a,u,l,i,s,o))}),a}function H2(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function bI(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;le(n)?l=r:l=new nn(null).setTree(n,r);let u=e.serverCache.getNode();return l.children.inorderTraversal((d,h)=>{if(u.hasChild(d)){let f=e.serverCache.getNode().getImmediateChild(d),p=H2(t,f,h);c=bm(t,c,new be(d),p,i,s,o,a)}}),l.children.inorderTraversal((d,h)=>{let f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!u.hasChild(d)&&!f){let p=e.serverCache.getNode().getImmediateChild(d),m=H2(t,p,h);c=bm(t,c,new be(d),m,i,s,o,a)}}),c}function Vq(t,e,n,r,i,s,o){if(Im(i,n)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(le(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return bm(t,e,n,c.getNode().getChild(n),i,s,a,o);if(le(n)){let l=new nn(null);return c.getNode().forEachChild(Fr,(u,d)=>{l=l.set(new be(u),d)}),bI(t,e,n,l,i,s,a,o)}else return e}else{let l=new nn(null);return r.foreach((u,d)=>{let h=$e(n,u);c.isCompleteForPath(h)&&(l=l.set(u,c.getNode().getChild(h)))}),bI(t,e,n,l,i,s,a,o)}}function Lq(t,e,n,r,i){let s=e.serverCache,o=TO(e,s.getNode(),s.isFullyInitialized()||le(n),s.isFiltered());return kO(t,o,n,r,PO,i)}function jq(t,e,n,r,i,s){let o;if(Im(r,n)!=null)return e;{let a=new Td(r,e,i),c=e.eventCache.getNode(),l;if(le(n)||ce(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=Cm(r,Eo(e));else{let d=e.serverCache.getNode();T(d instanceof re,"serverChildren would be complete if leaf node"),u=sb(r,d)}u=u,l=t.filter.updateFullNode(c,u,s)}else{let u=ce(n),d=ob(r,u,e.serverCache);d==null&&e.serverCache.isCompleteForChild(u)&&(d=c.getImmediateChild(u)),d!=null?l=t.filter.updateChild(c,u,d,Oe(n),a,s):e.eventCache.getNode().hasChild(u)?l=t.filter.updateChild(c,u,re.EMPTY_NODE,Oe(n),a,s):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Cm(r,Eo(e)),o.isLeafNode()&&(l=t.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||Im(r,Ie())!=null,md(e,l,o,t.filter.filtersNodes())}}var DI=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new Id(r.getIndex()),s=oq(r);this.processor_=Rq(s);let o=n.serverCache,a=n.eventCache,c=i.updateFullNode(re.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(re.EMPTY_NODE,a.getNode(),null),u=new Lr(c,o.isFullyInitialized(),i.filtersNodes()),d=new Lr(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=jm(d,u),this.eventGenerator_=new yI(this.query_)}get query(){return this.query_}};function Bq(t){return t.viewCache_.serverCache.getNode()}function Uq(t){return Em(t.viewCache_)}function $q(t,e){let n=Eo(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!le(e)&&!n.getImmediateChild(ce(e)).isEmpty())?n.getChild(e):null}function q2(t){return t.eventRegistrations_.length===0}function Hq(t,e){t.eventRegistrations_.push(e)}function G2(t,e,n){let r=[];if(n){T(e==null,"A cancel should cancel all event registrations.");let i=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function z2(t,e,n,r){e.type===Or.MERGE&&e.source.queryId!==null&&(T(Eo(t.viewCache_),"We should always have a full cache before handling merges"),T(Em(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=kq(t.processor_,i,e,n,r);return Pq(t.processor_,s.viewCache),T(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,OO(t,s.changes,s.viewCache.eventCache.getNode(),null)}function qq(t,e){let n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ve,(s,o)=>{r.push(Nc(s,o))}),n.isFullyInitialized()&&r.push(DO(n.getNode())),OO(t,r,n.getNode(),e)}function OO(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return pq(t.eventGenerator_,e,n,i)}var Dm,Tm=class{constructor(){this.views=new Map}};function Gq(t){T(!Dm,"__referenceConstructor has already been defined"),Dm=t}function zq(){return T(Dm,"Reference.ts has not been loaded"),Dm}function Wq(t){return t.views.size===0}function ab(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return T(s!=null,"SyncTree gave us an op for an invalid query."),z2(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat(z2(o,e,n,r));return s}}function FO(t,e,n,r,i){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=Cm(n,i?r:null),c=!1;a?c=!0:r instanceof re?(a=sb(n,r),c=!1):(a=re.EMPTY_NODE,c=!1);let l=jm(new Lr(a,c,!1),new Lr(r,i,!1));return new DI(e,l)}return o}function Kq(t,e,n,r,i,s){let o=FO(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),Hq(o,n),qq(o,n)}function Qq(t,e,n,r){let i=e._queryIdentifier,s=[],o=[],a=os(t);if(i==="default")for(let[c,l]of t.views.entries())o=o.concat(G2(l,n,r)),q2(l)&&(t.views.delete(c),l.query._queryParams.loadsAllData()||s.push(l.query));else{let c=t.views.get(i);c&&(o=o.concat(G2(c,n,r)),q2(c)&&(t.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!os(t)&&s.push(new(zq())(e._repo,e._path)),{removed:s,events:o}}function VO(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function rs(t,e){let n=null;for(let r of t.views.values())n=n||$q(r,e);return n}function LO(t,e){if(e._queryParams.loadsAllData())return Um(t);{let r=e._queryIdentifier;return t.views.get(r)}}function jO(t,e){return LO(t,e)!=null}function os(t){return Um(t)!=null}function Um(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Sm;function Yq(t){T(!Sm,"__referenceConstructor has already been defined"),Sm=t}function Zq(){return T(Sm,"Reference.ts has not been loaded"),Sm}var Xq=1,Am=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new nn(null),this.pendingWriteTree_=Mq(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function cb(t,e,n,r,i){return yq(t.pendingWriteTree_,e,n,r,i),i?Lc(t,new Rc(nb(),e,n)):[]}function Jq(t,e,n,r){vq(t.pendingWriteTree_,e,n,r);let i=nn.fromObject(n);return Lc(t,new Dd(nb(),e,i))}function ts(t,e,n=!1){let r=xq(t.pendingWriteTree_,e);if(wq(t.pendingWriteTree_,e)){let s=new nn(null);return r.snap!=null?s=s.set(Ie(),!0):Tt(r.children,o=>{s=s.set(new be(o),!0)}),Lc(t,new _I(r.path,s,n))}else return[]}function Fd(t,e,n){return Lc(t,new Rc(rb(),e,n))}function eG(t,e,n){let r=nn.fromObject(n);return Lc(t,new Dd(rb(),e,r))}function tG(t,e){return Lc(t,new wm(rb(),e))}function nG(t,e,n){let r=lb(t,n);if(r){let i=ub(r),s=i.path,o=i.queryId,a=tn(s,e),c=new wm(ib(o),a);return db(t,s,c)}else return[]}function Mm(t,e,n,r,i=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||jO(o,e))){let c=Qq(o,e,n,r);Wq(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let l=c.removed;if(a=c.events,!i){let u=l.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,f)=>os(f));if(u&&!d){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let f=sG(h);for(let p=0;p<f.length;++p){let m=f[p],v=m.query,b=HO(t,m);t.listenProvider_.startListening(yd(v),Sd(t,v),b.hashFn,b.onComplete)}}}!d&&l.length>0&&!r&&(u?t.listenProvider_.stopListening(yd(e),null):l.forEach(h=>{let f=t.queryToTagMap.get(Hm(h));t.listenProvider_.stopListening(yd(h),f)}))}oG(t,l)}return a}function BO(t,e,n,r){let i=lb(t,r);if(i!=null){let s=ub(i),o=s.path,a=s.queryId,c=tn(o,e),l=new Rc(ib(a),c,n);return db(t,o,l)}else return[]}function rG(t,e,n,r){let i=lb(t,r);if(i){let s=ub(i),o=s.path,a=s.queryId,c=tn(o,e),l=nn.fromObject(n),u=new Dd(ib(a),c,l);return db(t,o,u)}else return[]}function TI(t,e,n,r=!1){let i=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(h,f)=>{let p=tn(h,i);s=s||rs(f,p),o=o||os(f)});let a=t.syncPointTree_.get(i);a?(o=o||os(a),s=s||rs(a,Ie())):(a=new Tm,t.syncPointTree_=t.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=re.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((f,p)=>{let m=rs(p,Ie());m&&(s=s.updateImmediateChild(f,m))}));let l=jO(a,e);if(!l&&!e._queryParams.loadsAllData()){let h=Hm(e);T(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let f=aG();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}let u=Bm(t.pendingWriteTree_,i),d=Kq(a,e,n,u,s,c);if(!l&&!o&&!r){let h=LO(a,e);d=d.concat(cG(t,e,h))}return d}function $m(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let c=tn(o,e),l=rs(a,c);if(l)return l});return MO(i,e,s,n,!0)}function iG(t,e){let n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(l,u)=>{let d=tn(l,n);r=r||rs(u,d)});let i=t.syncPointTree_.get(n);i?r=r||rs(i,Ie()):(i=new Tm,t.syncPointTree_=t.syncPointTree_.set(n,i));let s=r!=null,o=s?new Lr(r,!0,!1):null,a=Bm(t.pendingWriteTree_,e._path),c=FO(i,e,a,s?o.getNode():re.EMPTY_NODE,s);return Uq(c)}function Lc(t,e){return UO(e,t.syncPointTree_,null,Bm(t.pendingWriteTree_,Ie()))}function UO(t,e,n,r){if(le(t.path))return $O(t,e,n,r);{let i=e.get(Ie());n==null&&i!=null&&(n=rs(i,Ie()));let s=[],o=ce(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){let l=n?n.getImmediateChild(o):null,u=NO(r,o);s=s.concat(UO(a,c,l,u))}return i&&(s=s.concat(ab(i,t,r,n))),s}}function $O(t,e,n,r){let i=e.get(Ie());n==null&&i!=null&&(n=rs(i,Ie()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=n?n.getImmediateChild(o):null,l=NO(r,o),u=t.operationForChild(o);u&&(s=s.concat($O(u,a,c,l)))}),i&&(s=s.concat(ab(i,t,r,n))),s}function HO(t,e){let n=e.query,r=Sd(t,n);return{hashFn:()=>(Bq(e)||re.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?nG(t,n._path,r):tG(t,n._path);{let s=yH(i,n);return Mm(t,n,null,s)}}}}function Sd(t,e){let n=Hm(e);return t.queryToTagMap.get(n)}function Hm(t){return t._path.toString()+"$"+t._queryIdentifier}function lb(t,e){return t.tagToQueryMap.get(e)}function ub(t){let e=t.indexOf("$");return T(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new be(t.substr(0,e))}}function db(t,e,n){let r=t.syncPointTree_.get(e);T(r,"Missing sync point for query tag that we're tracking");let i=Bm(t.pendingWriteTree_,e);return ab(r,n,i,null)}function sG(t){return t.fold((e,n,r)=>{if(n&&os(n))return[Um(n)];{let i=[];return n&&(i=VO(n)),Tt(r,(s,o)=>{i=i.concat(o)}),i}})}function yd(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(Zq())(t._repo,t._path):t}function oG(t,e){for(let n=0;n<e.length;++n){let r=e[n];if(!r._queryParams.loadsAllData()){let i=Hm(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function aG(){return Xq++}function cG(t,e,n){let r=e._path,i=Sd(t,e),s=HO(t,n),o=t.listenProvider_.startListening(yd(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)T(!os(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((l,u,d)=>{if(!le(l)&&u&&os(u))return[Um(u).query];{let h=[];return u&&(h=h.concat(VO(u).map(f=>f.query))),Tt(d,(f,p)=>{h=h.concat(p)}),h}});for(let l=0;l<c.length;++l){let u=c[l];t.listenProvider_.stopListening(yd(u),Sd(t,u))}}return o}var SI=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},AI=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=$e(this.path_,e);return new t(this.syncTree_,n)}node(){return $m(this.syncTree_,this.path_)}},lG=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},W2=function(t,e,n){if(!t||typeof t!="object")return t;if(T(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return uG(t[".sv"],e,n);if(typeof t[".sv"]=="object")return dG(t[".sv"],e);T(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},uG=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:T(!1,"Unexpected server value: "+t)}},dG=function(t,e,n){t.hasOwnProperty("increment")||T(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&T(!1,"Unexpected increment value: "+r);let i=e.node();if(T(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},qO=function(t,e,n,r){return fb(e,new AI(n,t),r)},hb=function(t,e,n){return fb(t,new SI(e),n)};function fb(t,e,n){let r=t.getPriority().val(),i=W2(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=W2(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new Ac(a,qe(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Ac(i))),o.forEachChild(Ve,(a,c)=>{let l=fb(c,e.getImmediateChild(a),n);l!==c&&(s=s.updateImmediateChild(a,l))}),s}}var Ad=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function qm(t,e){let n=e instanceof be?e:new be(e),r=t,i=ce(n);for(;i!==null;){let s=hi(r.node.children,i)||{children:{},childCount:0};r=new Ad(i,r,s),n=Oe(n),i=ce(n)}return r}function bo(t){return t.node.value}function pb(t,e){t.node.value=e,MI(t)}function GO(t){return t.node.childCount>0}function hG(t){return bo(t)===void 0&&!GO(t)}function Gm(t,e){Tt(t.node.children,(n,r)=>{e(new Ad(n,t,r))})}function zO(t,e,n,r){n&&!r&&e(t),Gm(t,i=>{zO(i,e,!0,r)}),n&&r&&e(t)}function fG(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Vd(t){return new be(t.parent===null?t.name:Vd(t.parent)+"/"+t.name)}function MI(t){t.parent!==null&&pG(t.parent,t.name,t)}function pG(t,e,n){let r=hG(n),i=bn(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,MI(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,MI(t))}var gG=/[\[\].#$\/\u0000-\u001F\u007F]/,mG=/[\[\].#$\u0000-\u001F\u007F]/,UC=10*1024*1024,zm=function(t){return typeof t=="string"&&t.length!==0&&!gG.test(t)},WO=function(t){return typeof t=="string"&&t.length!==0&&!mG.test(t)},_G=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),WO(t)},Md=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Vm(t)||t&&typeof t=="object"&&bn(t,".sv")},jr=function(t,e,n,r){r&&e===void 0||Ld(on(t,"value"),e,n)},Ld=function(t,e,n){let r=n instanceof be?new eI(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+vo(r));if(typeof e=="function")throw new Error(t+"contains a function "+vo(r)+" with contents = "+e.toString());if(Vm(e))throw new Error(t+"contains "+e.toString()+" "+vo(r));if(typeof e=="string"&&e.length>UC/3&&Hc(e)>UC)throw new Error(t+"contains a string greater than "+UC+" utf8 bytes "+vo(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Tt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!zm(o)))throw new Error(t+" contains an invalid key ("+o+") "+vo(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);WH(r,o),Ld(t,a,r),KH(r)}),i&&s)throw new Error(t+' contains ".value" child '+vo(r)+" in addition to actual children.")}},yG=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];let s=xd(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!zm(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(zH);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&jn(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},KO=function(t,e,n,r){if(r&&e===void 0)return;let i=on(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];Tt(e,(o,a)=>{let c=new be(o);if(Ld(i,a,$e(n,c)),ZI(c)===".priority"&&!Md(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),yG(i,s)},gb=function(t,e,n){if(!(n&&e===void 0)){if(Vm(e))throw new Error(on(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Md(e))throw new Error(on(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},jd=function(t,e,n,r){if(!(r&&n===void 0)&&!zm(n))throw new Error(on(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},jc=function(t,e,n,r){if(!(r&&n===void 0)&&!WO(n))throw new Error(on(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},vG=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),jc(t,e,n,r)},wn=function(t,e){if(ce(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},QO=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!zm(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!_G(n))throw new Error(on(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var NI=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Wm(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!XI(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function YO(t,e,n){Wm(t,n),ZO(t,r=>XI(r,e))}function En(t,e,n){Wm(t,n),ZO(t,r=>jn(r,e)||jn(e,r))}function ZO(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?(xG(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function xG(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();wo&&Dt("event: "+n.toString()),Fc(r)}}}var XO="repo_interrupt",wG=25,RI=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new NI,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=xm(),this.transactionQueueTree_=new Ad,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function EG(t,e,n){if(t.stats_=YI(t.repoInfo_),t.forceRestClient_||EH())t.server_=new dI(t.repoInfo_,(r,i,s,o)=>{K2(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>Q2(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{et(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new JI(t.repoInfo_,e,(r,i,s,o)=>{K2(t,r,i,s,o)},r=>{Q2(t,r)},r=>{CG(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=IH(t.repoInfo_,()=>new mI(t.stats_,t.server_)),t.infoData_=new hI,t.infoSyncTree_=new Am({startListening:(r,i,s,o)=>{let a=[],c=t.infoData_.getNode(r._path);return c.isEmpty()||(a=Fd(t.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),mb(t,"connected",!1),t.serverSyncTree_=new Am({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,c)=>{let l=o(a,c);En(t.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function JO(t){let n=t.infoData_.getNode(new be(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Bd(t){return lG({timestamp:JO(t)})}function K2(t,e,n,r,i){t.dataUpdateCount++;let s=new be(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let c=$c(n,l=>qe(l));o=rG(t.serverSyncTree_,s,c,i)}else{let c=qe(n);o=BO(t.serverSyncTree_,s,c,i)}else if(r){let c=$c(n,l=>qe(l));o=eG(t.serverSyncTree_,s,c)}else{let c=qe(n);o=Fd(t.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=kc(t,s)),En(t.eventQueue_,a,o)}function Q2(t,e){mb(t,"connected",e),e===!1&&DG(t)}function CG(t,e){Tt(e,(n,r)=>{mb(t,n,r)})}function mb(t,e,n){let r=new be("/.info/"+e),i=qe(n);t.infoData_.updateSnapshot(r,i);let s=Fd(t.infoSyncTree_,r,i);En(t.eventQueue_,r,s)}function Km(t){return t.nextWriteId_++}function IG(t,e,n){let r=iG(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{let s=qe(i).withIndex(e._queryParams.getIndex());TI(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Fd(t.serverSyncTree_,e._path,s);else{let a=Sd(t.serverSyncTree_,e);o=BO(t.serverSyncTree_,e._path,s,a)}return En(t.eventQueue_,e._path,o),Mm(t.serverSyncTree_,e,n,null,!0),s},i=>(Bc(t,"get for query "+et(e)+" failed: "+i),Promise.reject(new Error(i))))}function _b(t,e,n,r,i){Bc(t,"set",{path:e.toString(),value:n,priority:r});let s=Bd(t),o=qe(n,r),a=$m(t.serverSyncTree_,e),c=hb(o,a,s),l=Km(t),u=cb(t.serverSyncTree_,e,c,l,!0);Wm(t.eventQueue_,u),t.server_.put(e.toString(),o.val(!0),(h,f)=>{let p=h==="ok";p||Gt("set at "+e+" failed: "+h);let m=ts(t.serverSyncTree_,l,!p);En(t.eventQueue_,e,m),as(t,i,h,f)});let d=vb(t,e);kc(t,d),En(t.eventQueue_,d,[])}function bG(t,e,n,r){Bc(t,"update",{path:e.toString(),value:n});let i=!0,s=Bd(t),o={};if(Tt(n,(a,c)=>{i=!1,o[a]=qO($e(e,a),qe(c),t.serverSyncTree_,s)}),i)Dt("update() called with empty data.  Don't do anything."),as(t,r,"ok",void 0);else{let a=Km(t),c=Jq(t.serverSyncTree_,e,o,a);Wm(t.eventQueue_,c),t.server_.merge(e.toString(),n,(l,u)=>{let d=l==="ok";d||Gt("update at "+e+" failed: "+l);let h=ts(t.serverSyncTree_,a,!d),f=h.length>0?kc(t,e):e;En(t.eventQueue_,f,h),as(t,r,l,u)}),Tt(n,l=>{let u=vb(t,$e(e,l));kc(t,u)}),En(t.eventQueue_,e,[])}}function DG(t){Bc(t,"onDisconnectEvents");let e=Bd(t),n=xm();pI(t.onDisconnect_,Ie(),(i,s)=>{let o=qO(i,s,t.serverSyncTree_,e);Vc(n,i,o)});let r=[];pI(n,Ie(),(i,s)=>{r=r.concat(Fd(t.serverSyncTree_,i,s));let o=vb(t,i);kc(t,o)}),t.onDisconnect_=xm(),En(t.eventQueue_,Ie(),r)}function TG(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&fI(t.onDisconnect_,e),as(t,n,r,i)})}function Y2(t,e,n,r){let i=qe(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Vc(t.onDisconnect_,e,i),as(t,r,s,o)})}function SG(t,e,n,r,i){let s=qe(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&Vc(t.onDisconnect_,e,s),as(t,i,o,a)})}function AG(t,e,n,r){if(Qd(n)){Dt("onDisconnect().update() called with empty data.  Don't do anything."),as(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&Tt(n,(o,a)=>{let c=qe(a);Vc(t.onDisconnect_,$e(e,o),c)}),as(t,r,i,s)})}function MG(t,e,n){let r;ce(e._path)===".info"?r=TI(t.infoSyncTree_,e,n):r=TI(t.serverSyncTree_,e,n),YO(t.eventQueue_,e._path,r)}function PI(t,e,n){let r;ce(e._path)===".info"?r=Mm(t.infoSyncTree_,e,n):r=Mm(t.serverSyncTree_,e,n),YO(t.eventQueue_,e._path,r)}function eF(t){t.persistentConnection_&&t.persistentConnection_.interrupt(XO)}function NG(t){t.persistentConnection_&&t.persistentConnection_.resume(XO)}function Bc(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Dt(n,...e)}function as(t,e,n,r){e&&Fc(()=>{if(n==="ok")e(null);else{let i=(n||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function RG(t,e,n,r,i,s){Bc(t,"transaction on "+e);let o={path:e,update:n,onComplete:r,status:null,order:J2(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=yb(t,e,void 0);o.currentInputSnapshot=a;let c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Ld("transaction failed: Data returned ",c,o.path),o.status=0;let l=qm(t.transactionQueueTree_,e),u=bo(l)||[];u.push(o),pb(l,u);let d;typeof c=="object"&&c!==null&&bn(c,".priority")?(d=hi(c,".priority"),T(Md(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=($m(t.serverSyncTree_,e)||re.EMPTY_NODE).getPriority().val();let h=Bd(t),f=qe(c,d),p=hb(f,a,h);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=Km(t);let m=cb(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);En(t.eventQueue_,e,m),Qm(t,t.transactionQueueTree_)}}function yb(t,e,n){return $m(t.serverSyncTree_,e,n)||re.EMPTY_NODE}function Qm(t,e=t.transactionQueueTree_){if(e||Ym(t,e),bo(e)){let n=nF(t,e);T(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&PG(t,Vd(e),n)}else GO(e)&&Gm(e,n=>{Qm(t,n)})}function PG(t,e,n){let r=n.map(l=>l.currentWriteId),i=yb(t,e,r),s=i,o=i.hash();for(let l=0;l<n.length;l++){let u=n[l];T(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;let d=tn(e,u.path);s=s.updateChild(d,u.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;t.server_.put(c.toString(),a,l=>{Bc(t,"transaction put response",{path:c.toString(),status:l});let u=[];if(l==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,u=u.concat(ts(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();Ym(t,qm(t.transactionQueueTree_,e)),Qm(t,t.transactionQueueTree_),En(t.eventQueue_,e,u);for(let h=0;h<d.length;h++)Fc(d[h])}else{if(l==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{Gt("transaction at "+c.toString()+" failed: "+l);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=l}kc(t,e)}},o)}function kc(t,e){let n=tF(t,e),r=Vd(n),i=nF(t,n);return kG(t,i,r),r}function kG(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],l=tn(n,c.path),u=!1,d;if(T(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)u=!0,d=c.abortReason,i=i.concat(ts(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=wG)u=!0,d="maxretry",i=i.concat(ts(t.serverSyncTree_,c.currentWriteId,!0));else{let h=yb(t,c.path,o);c.currentInputSnapshot=h;let f=e[a].update(h.val());if(f!==void 0){Ld("transaction failed: Data returned ",f,c.path);let p=qe(f);typeof f=="object"&&f!=null&&bn(f,".priority")||(p=p.updatePriority(h.getPriority()));let v=c.currentWriteId,b=Bd(t),F=hb(p,h,b);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=F,c.currentWriteId=Km(t),o.splice(o.indexOf(v),1),i=i.concat(cb(t.serverSyncTree_,c.path,F,c.currentWriteId,c.applyLocally)),i=i.concat(ts(t.serverSyncTree_,v,!0))}else u=!0,d="nodata",i=i.concat(ts(t.serverSyncTree_,c.currentWriteId,!0))}En(t.eventQueue_,n,i),i=[],u&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}Ym(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Fc(r[a]);Qm(t,t.transactionQueueTree_)}function tF(t,e){let n,r=t.transactionQueueTree_;for(n=ce(e);n!==null&&bo(r)===void 0;)r=qm(r,n),e=Oe(e),n=ce(e);return r}function nF(t,e){let n=[];return rF(t,e,n),n.sort((r,i)=>r.order-i.order),n}function rF(t,e,n){let r=bo(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);Gm(e,i=>{rF(t,i,n)})}function Ym(t,e){let n=bo(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,pb(e,n.length>0?n:void 0)}Gm(e,r=>{Ym(t,r)})}function vb(t,e){let n=Vd(tF(t,e)),r=qm(t.transactionQueueTree_,e);return fG(r,i=>{$C(t,i)}),$C(t,r),zO(r,i=>{$C(t,i)}),n}function $C(t,e){let n=bo(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(T(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(T(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(ts(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?pb(e,void 0):n.length=s+1,En(t.eventQueue_,Vd(e),i);for(let o=0;o<r.length;o++)Fc(r[o])}}function OG(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function FG(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Gt(`Invalid query segment '${n}' in query '${t}'`)}return e}var kI=function(t,e){let n=VG(t),r=n.namespace;n.domain==="firebase.com"&&Vr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Vr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||fH();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new hm(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new be(n.pathString)}},VG=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",c=443;if(typeof t=="string"){let l=t.indexOf("//");l>=0&&(a=t.substring(0,l-1),t=t.substring(l+2));let u=t.indexOf("/");u===-1&&(u=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(u,d)),u<d&&(i=OG(t.substring(u,d)));let h=FG(t.substring(Math.min(t.length,d)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;let f=e.slice(0,l);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=r}"ns"in h&&(s=h.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var Z2="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",LG=function(){let t=0,e=[];return function(n){let r=n===t;t=n;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=Z2.charAt(n%64),n=Math.floor(n/64);T(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=Z2.charAt(e[i]);return T(o.length===20,"nextPushId: Length should be 20."),o}}();var Nm=class{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+et(this.snapshot.exportVal())}},Rm=class{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Nd=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return T(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var Pm=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new yt;return TG(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){wn("OnDisconnect.remove",this._path);let e=new yt;return Y2(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){wn("OnDisconnect.set",this._path),jr("OnDisconnect.set",e,this._path,!1);let n=new yt;return Y2(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){wn("OnDisconnect.setWithPriority",this._path),jr("OnDisconnect.setWithPriority",e,this._path,!1),gb("OnDisconnect.setWithPriority",n,!1);let r=new yt;return SG(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){wn("OnDisconnect.update",this._path),KO("OnDisconnect.update",e,this._path,!1);let n=new yt;return AG(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var rn=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return le(this._path)?null:ZI(this._path)}get ref(){return new Cn(this._repo,this._path)}get _queryIdentifier(){let e=V2(this._queryParams),n=QI(e);return n==="{}"?"default":n}get _queryObject(){return V2(this._queryParams)}isEqual(e){if(e=fe(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=XI(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+GH(this._path)}};function Zm(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function ls(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Fr){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==is)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==ui)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Ve){if(e!=null&&!Md(e)||n!=null&&!Md(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(T(t.getIndex()instanceof wd||t.getIndex()===tb,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Xm(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Cn=class t extends rn{constructor(e,n){super(e,n,new bd,!1)}get parent(){let e=xO(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Oc=class t{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new be(e),r=cs(this.ref,e);return new t(this._node.getChild(n),r,Ve)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new t(i,cs(this.ref,r),Ve)))}hasChild(e){let n=new be(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function xb(t,e){return t=fe(t),t._checkNotDeleted("ref"),e!==void 0?cs(t._root,e):t._root}function wb(t,e){t=fe(t),t._checkNotDeleted("refFromURL");let n=kI(e,t._repo.repoInfo_.nodeAdmin);QO("refFromURL",n);let r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&Vr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),xb(t,n.path.toString())}function cs(t,e){return t=fe(t),ce(t._path)===null?vG("child","path",e,!1):jc("child","path",e,!1),new Cn(t._repo,$e(t._path,e))}function iF(t,e){t=fe(t),wn("push",t._path),jr("push",e,t._path,!0);let n=JO(t._repo),r=LG(n),i=cs(t,r),s=cs(t,r),o;return e!=null?o=Jm(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function sF(t){return wn("remove",t._path),Jm(t,null)}function Jm(t,e){t=fe(t),wn("set",t._path),jr("set",e,t._path,!1);let n=new yt;return _b(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function oF(t,e){t=fe(t),wn("setPriority",t._path),gb("setPriority",e,!1);let n=new yt;return _b(t._repo,$e(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function aF(t,e,n){if(wn("setWithPriority",t._path),jr("setWithPriority",e,t._path,!1),gb("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let r=new yt;return _b(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function cF(t,e){KO("update",e,t._path,!1);let n=new yt;return bG(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function lF(t){t=fe(t);let e=new Nd(()=>{}),n=new Rd(e);return IG(t._repo,t,n).then(r=>new Oc(r,new Cn(t._repo,t._path),t._queryParams.getIndex()))}var Rd=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let r=n._queryParams.getIndex();return new Nm("value",this,new Oc(e.snapshotNode,new Cn(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Rm(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},km=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Rm(this,e,n):null}createEvent(e,n){T(e.childName!=null,"Child events should have a childName.");let r=cs(new Cn(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new Nm(e.type,this,new Oc(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Ud(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=n,l=(u,d)=>{PI(t._repo,t,a),c(u,d)};l.userCallback=n.userCallback,l.context=n.context,n=l}let o=new Nd(n,s||void 0),a=e==="value"?new Rd(o):new km(e,o);return MG(t._repo,t,a),()=>PI(t._repo,t,a)}function e_(t,e,n,r){return Ud(t,"value",e,n,r)}function Eb(t,e,n,r){return Ud(t,"child_added",e,n,r)}function Cb(t,e,n,r){return Ud(t,"child_changed",e,n,r)}function Ib(t,e,n,r){return Ud(t,"child_moved",e,n,r)}function bb(t,e,n,r){return Ud(t,"child_removed",e,n,r)}function Db(t,e,n){let r=null,i=n?new Nd(n):null;e==="value"?r=new Rd(i):e&&(r=new km(e,i)),PI(t._repo,t,r)}var In=class{},Om=class extends In{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){jr("endAt",this._value,e._path,!0);let n=uI(e._queryParams,this._value,this._key);if(Xm(n),ls(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new rn(e._repo,e._path,n,e._orderByCalled)}};function uF(t,e){return jd("endAt","key",e,!0),new Om(t,e)}var OI=class extends In{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){jr("endBefore",this._value,e._path,!1);let n=uq(e._queryParams,this._value,this._key);if(Xm(n),ls(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new rn(e._repo,e._path,n,e._orderByCalled)}};function dF(t,e){return jd("endBefore","key",e,!0),new OI(t,e)}var Fm=class extends In{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){jr("startAt",this._value,e._path,!0);let n=lI(e._queryParams,this._value,this._key);if(Xm(n),ls(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new rn(e._repo,e._path,n,e._orderByCalled)}};function hF(t=null,e){return jd("startAt","key",e,!0),new Fm(t,e)}var FI=class extends In{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){jr("startAfter",this._value,e._path,!1);let n=lq(e._queryParams,this._value,this._key);if(Xm(n),ls(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new rn(e._repo,e._path,n,e._orderByCalled)}};function fF(t,e){return jd("startAfter","key",e,!0),new FI(t,e)}var VI=class extends In{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new rn(e._repo,e._path,aq(e._queryParams,this._limit),e._orderByCalled)}};function pF(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new VI(t)}var LI=class extends In{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new rn(e._repo,e._path,cq(e._queryParams,this._limit),e._orderByCalled)}};function gF(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new LI(t)}var jI=class extends In{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Zm(e,"orderByChild");let n=new be(this._path);if(le(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new wd(n),i=Lm(e._queryParams,r);return ls(i),new rn(e._repo,e._path,i,!0)}};function mF(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return jc("orderByChild","path",t,!1),new jI(t)}var BI=class extends In{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Zm(e,"orderByKey");let n=Lm(e._queryParams,Fr);return ls(n),new rn(e._repo,e._path,n,!0)}};function _F(){return new BI}var UI=class extends In{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Zm(e,"orderByPriority");let n=Lm(e._queryParams,Ve);return ls(n),new rn(e._repo,e._path,n,!0)}};function yF(){return new UI}var $I=class extends In{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Zm(e,"orderByValue");let n=Lm(e._queryParams,tb);return ls(n),new rn(e._repo,e._path,n,!0)}};function vF(){return new $I}var HI=class extends In{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(jr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Om(this._value,this._key)._apply(new Fm(this._value,this._key)._apply(e))}};function xF(t,e){return jd("equalTo","key",e,!0),new HI(t,e)}function Un(t,...e){let n=fe(t);for(let r of e)n=r._apply(n);return n}Gq(Cn);Yq(Cn);var jG="FIREBASE_DATABASE_EMULATOR_HOST",qI={},BG=!1;function UG(t,e,n,r){t.repoInfo_=new hm(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function Tb(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||Vr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Dt("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=kI(s,i),a=o.repoInfo,c,l;typeof process<"u"&&process.env&&(l=process.env[jG]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=kI(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let u=i&&c?new gd(gd.OWNER):new KC(t.name,t.options,e);QO("Invalid Firebase Database URL",o),le(o.path)||Vr("Database URL must point to the root of a Firebase Database (not including a child path).");let d=HG(a,t,u,new WC(t.name,n));return new GI(d,t)}function $G(t,e){let n=qI[e];(!n||n[t.key]!==t)&&Vr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),eF(t),delete n[t.key]}function HG(t,e,n,r){let i=qI[e.name];i||(i={},qI[e.name]=i);let s=i[t.toURLString()];return s&&Vr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new RI(t,BG,n,r),i[t.toURLString()]=s,s}var GI=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(EG(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Cn(this._repo,Ie())),this._rootInternal}_delete(){return this._rootInternal!==null&&($G(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Vr("Cannot call "+e+" on a deleted database.")}};function wF(){vO.IS_TRANSPORT_INITIALIZED&&Gt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function EF(){wF(),vd.forceDisallow()}function CF(){wF(),bc.forceDisallow(),vd.forceAllow()}function IF(t,e,n,r={}){t=fe(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Vr("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Vr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new gd(gd.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:zd(r.mockUserToken,t.app.options.projectId);s=new gd(o)}UG(i,e,n,s)}function bF(t){t=fe(t),t._checkNotDeleted("goOffline"),eF(t._repo)}function DF(t){t=fe(t),t._checkNotDeleted("goOnline"),NG(t._repo)}function TF(t,e){tO(t,e)}function qG(t){KI(Zd),us(new pn("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return Tb(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),$n(x2,w2,t),$n(x2,w2,"esm2017")}var GG={".sv":"timestamp"};function SF(){return GG}function AF(t){return{".sv":{increment:t}}}var zI=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function MF(t,e,n){var r;if(t=fe(t),wn("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let i=(r=n?.applyLocally)!==null&&r!==void 0?r:!0,s=new yt,o=(c,l,u)=>{let d=null;c?s.reject(c):(d=new Oc(u,new Cn(t._repo,t._path),Ve),s.resolve(new zI(l,d)))},a=e_(t,()=>{});return RG(t._repo,t._path,e,o,a,i),s.promise}JI.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};JI.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};qG();var zG="@firebase/database-compat",WG="1.0.4";var KG=new fi("@firebase/database-compat"),NF=function(t){let e="FIREBASE WARNING: "+t;KG.warn(e)};var QG=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(on(t,e)+"must be a boolean.")},YG=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(on(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var Sb=class{constructor(e){this._delegate=e}cancel(e){G("OnDisconnect.cancel",0,1,arguments.length),ft("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){G("OnDisconnect.remove",0,1,arguments.length),ft("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){G("OnDisconnect.set",1,2,arguments.length),ft("OnDisconnect.set","onComplete",n,!0);let r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){G("OnDisconnect.setWithPriority",2,3,arguments.length),ft("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(G("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,NF("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ft("OnDisconnect.update","onComplete",n,!0);let r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}};var Ab=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return G("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var Do=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return G("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return G("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return G("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return G("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return G("DataSnapshot.child",0,1,arguments.length),e=String(e),jc("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return G("DataSnapshot.hasChild",1,1,arguments.length),jc("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return G("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return G("DataSnapshot.forEach",1,1,arguments.length),ft("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return G("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return G("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return G("DataSnapshot.ref",0,0,arguments.length),new di(this._database,this._delegate.ref)}get ref(){return this.getRef()}},t_=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;G("Query.on",2,4,arguments.length),ft("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",r,i),a=(l,u)=>{n.call(o.context,new Do(this.database,l),u)};a.userCallback=n,a.context=o.context;let c=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return e_(this._delegate,a,c),n;case"child_added":return Eb(this._delegate,a,c),n;case"child_removed":return bb(this._delegate,a,c),n;case"child_changed":return Cb(this._delegate,a,c),n;case"child_moved":return Ib(this._delegate,a,c),n;default:throw new Error(on("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(G("Query.off",0,3,arguments.length),YG("Query.off",e,!0),ft("Query.off","callback",n,!0),a_("Query.off","context",r,!0),n){let i=()=>{};i.userCallback=n,i.context=r,Db(this._delegate,e,i)}else Db(this._delegate,e)}get(){return lF(this._delegate).then(e=>new Do(this.database,e))}once(e,n,r,i){G("Query.once",1,4,arguments.length),ft("Query.once","callback",n,!0);let s=t.getCancelAndContextArgs_("Query.once",r,i),o=new yt,a=(l,u)=>{let d=new Do(this.database,l);n&&n.call(s.context,d,u),o.resolve(d)};a.userCallback=n,a.context=s.context;let c=l=>{s.cancel&&s.cancel.call(s.context,l),o.reject(l)};switch(e){case"value":e_(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":Eb(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":bb(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":Cb(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":Ib(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(on("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return G("Query.limitToFirst",1,1,arguments.length),new t(this.database,Un(this._delegate,pF(e)))}limitToLast(e){return G("Query.limitToLast",1,1,arguments.length),new t(this.database,Un(this._delegate,gF(e)))}orderByChild(e){return G("Query.orderByChild",1,1,arguments.length),new t(this.database,Un(this._delegate,mF(e)))}orderByKey(){return G("Query.orderByKey",0,0,arguments.length),new t(this.database,Un(this._delegate,_F()))}orderByPriority(){return G("Query.orderByPriority",0,0,arguments.length),new t(this.database,Un(this._delegate,yF()))}orderByValue(){return G("Query.orderByValue",0,0,arguments.length),new t(this.database,Un(this._delegate,vF()))}startAt(e=null,n){return G("Query.startAt",0,2,arguments.length),new t(this.database,Un(this._delegate,hF(e,n)))}startAfter(e=null,n){return G("Query.startAfter",0,2,arguments.length),new t(this.database,Un(this._delegate,fF(e,n)))}endAt(e=null,n){return G("Query.endAt",0,2,arguments.length),new t(this.database,Un(this._delegate,uF(e,n)))}endBefore(e=null,n){return G("Query.endBefore",0,2,arguments.length),new t(this.database,Un(this._delegate,dF(e,n)))}equalTo(e,n){return G("Query.equalTo",1,2,arguments.length),new t(this.database,Un(this._delegate,xF(e,n)))}toString(){return G("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return G("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(G("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){let i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,ft(e,"cancel",i.cancel,!0),i.context=r,a_(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(on(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new di(this.database,new Cn(this._delegate._repo,this._delegate._path))}},di=class t extends t_{constructor(e,n){super(e,new rn(n._repo,n._path,new bd,!1)),this.database=e,this._delegate=n}getKey(){return G("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return G("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,cs(this._delegate,e))}getParent(){G("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return G("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){G("Reference.set",1,2,arguments.length),ft("Reference.set","onComplete",n,!0);let r=Jm(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(G("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,NF("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}wn("Reference.update",this._delegate._path),ft("Reference.update","onComplete",n,!0);let r=cF(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){G("Reference.setWithPriority",2,3,arguments.length),ft("Reference.setWithPriority","onComplete",r,!0);let i=aF(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){G("Reference.remove",0,1,arguments.length),ft("Reference.remove","onComplete",e,!0);let n=sF(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){G("Reference.transaction",1,3,arguments.length),ft("Reference.transaction","transactionUpdate",e,!1),ft("Reference.transaction","onComplete",n,!0),QG("Reference.transaction","applyLocally",r,!0);let i=MF(this._delegate,e,{applyLocally:r}).then(s=>new Ab(s.committed,new Do(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){G("Reference.setPriority",1,2,arguments.length),ft("Reference.setPriority","onComplete",n,!0);let r=oF(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){G("Reference.push",0,2,arguments.length),ft("Reference.push","onComplete",n,!0);let r=iF(this._delegate,e),i=r.then(o=>new t(this.database,o));n&&i.then(()=>n(null),o=>n(o));let s=new t(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return wn("Reference.onDisconnect",this._delegate._path),new Sb(new Pm(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var To=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:EF,forceLongPolling:CF}}useEmulator(e,n,r={}){IF(this._delegate,e,n,r)}ref(e){if(G("database.ref",0,1,arguments.length),e instanceof di){let n=wb(this._delegate,e.toString());return new di(this,n)}else{let n=xb(this._delegate,e);return new di(this,n)}}refFromURL(e){G("database.refFromURL",1,1,arguments.length);let r=wb(this._delegate,e);return new di(this,r)}goOffline(){return G("database.goOffline",0,0,arguments.length),bF(this._delegate)}goOnline(){return G("database.goOnline",0,0,arguments.length),DF(this._delegate)}};To.ServerValue={TIMESTAMP:SF(),increment:t=>AF(t)};function ZG({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){KI(n);let a=new c_("database-standalone"),c=new Yd("auth-internal",a);c.setComponent(new pn("auth-internal",()=>r,"PRIVATE"));let l;return i&&(l=new Yd("app-check-internal",a),l.setComponent(new pn("app-check-internal",()=>i,"PRIVATE"))),{instance:new To(Tb(t,c,l,e,o),t),namespace:s}}var XG=Object.freeze({__proto__:null,initStandalone:ZG});var JG=To.ServerValue;function ez(t){t.INTERNAL.registerComponent(new pn("database-compat",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new To(i,r)},"PUBLIC").setServiceProps({Reference:di,Query:t_,Database:To,DataSnapshot:Do,enableLogging:TF,INTERNAL:XG,ServerValue:JG}).setMultipleInstances(!0)),t.registerVersion(zG,WG)}ez(St);function $d(t,e,n="on",r=gs){return new ae(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),n==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),n==="on"?{unsubscribe(){s!=null&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(B(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),Yc())}function tz(t){return typeof t=="string"}function nz(t){return typeof t.exportVal=="function"}function FF(t){return t==null}function VF(t){return typeof t.set=="function"}function RF(t,e){return VF(e)?e:t.ref(e)}function LF(t,e){if(tz(t))return e.stringCase();if(VF(t))return e.firebaseCase();if(nz(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function jF(t){return(FF(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function BF(t,e,n){e=jF(e);let r=e.map(i=>$d(t,i,"on",n));return Uo(...r)}function rz(t,e,n){let r=BF(t,e).pipe(lr((i,s)=>[...i,s],[]));return sz(t,r,n)}function iz(t,e){return $d(t,"value","on",e).pipe(B(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}function sz(t,e,n){return iz(t,n).pipe(R_(e),B(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(c=>c.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),M_(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),B(i=>i.actions))}function PF(t,e){return function(r,i){return LF(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function oz(t){return function(n){return n?LF(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function az(t,e,n){return $d(t,"value","once",n).pipe(Be(r=>{let i=[U(r)];return e.forEach(s=>i.push($d(t,s,"on",n))),Uo(...i).pipe(lr(lz,[]))}),Wc())}function UF(t,e){let n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function cz(t,e){if(FF(e))return 0;{let n=UF(t,e);return n===-1?t.length:n+1}}function lz(t,e){let{payload:n,prevKey:r,key:i}=e,s=UF(t,i),o=cz(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(c=>{let l={payload:c,type:"value",prevKey:a,key:c.key};return a=c.key,t=[...t,l],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(c=>c.payload.key!==n.key),t.splice(o,0,e));else{if(r==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=t.splice(s,1)[0];return t=t.slice(),t.splice(o,0,a),t}return t;default:return t}}function kF(t,e,n){return e=jF(e),az(t,e,n)}function uz(t,e){let n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:PF(r,"update"),set:PF(r,"set"),push:i=>r.push(i),remove:oz(r),snapshotChanges(i){return kF(t,i,n).pipe(Ye)},stateChanges(i){return BF(t,i,n).pipe(Ye)},auditTrail(i){return rz(t,i,n).pipe(Ye)},valueChanges(i,s){return kF(t,i,n).pipe(B(a=>a.map(c=>s&&s.idField?oe(A({},c.payload.val()),{[s.idField]:c.key}):c.payload.val())),Ye)}}}function OF(t,e){return function(){return $d(t,"value","on",e)}}function dz(t,e){return{query:t,snapshotChanges(){return OF(t,e.schedulers.outsideAngular)().pipe(Ye)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return OF(t,e.schedulers.outsideAngular)().pipe(Ye,B(r=>r.payload.exists()?r.payload.val():null))}}}var hz=new O("angularfire2.realtimeDatabaseURL"),fz=new O("angularfire2.database.use-emulator"),pz=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,c,l,u,d,h,f,p,m,v){this.schedulers=a;let b=c,F=Ls(n,o,r);l&&Kl(F,o,u,h,f,p,d,m),this.database=ba(`${F.name}.database.${i}`,"AngularFireDatabase",F.name,()=>{let S=o.runOutsideAngular(()=>F.database(i||void 0));return b&&S.useEmulator(...b),S},[b])}list(n,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>RF(this.database,n)),s=i;return r&&(s=r(i)),uz(s,this)}object(n){let r=this.schedulers.ngZone.runOutsideAngular(()=>RF(this.database,n));return dz(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(C(Ri),C(Pi,8),C(hz,8),C(Lt),C(ge),C(Ia),C(fz,8),C(rp,8),C($l,8),C(Hl,8),C(ql,8),C(Gl,8),C(zl,8),C(Wl,8),C(Xr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),$F=(()=>{class t{constructor(){St.registerVersion("angularfire",Vs.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=it({type:t});static \u0275inj=rt({providers:[pz]})}return t})();var HF=(()=>{let e=class e{constructor(){this.title="360Car"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=cn({type:e,selectors:[["app-root"]],decls:21,vars:0,consts:[[1,"navbar"],["routerLink","/home",1,"navbar-brand"],["src","./assets/images/OIG_WB_white.png","alt","logo",1,"logo"],["routerLink","/home"],["routerLink","/coches"],["routerLink","/transacciones"],["routerLink","/clientes"],[1,"container"]],template:function(i,s){i&1&&(x(0,"header")(1,"nav",0)(2,"a",1),dn(3,"img",2),x(4,"span"),D(5,"360Car"),w()(),x(6,"ul")(7,"li")(8,"a",3),D(9,"Home"),w()(),x(10,"li")(11,"a",4),D(12,"Coches"),w()(),x(13,"li")(14,"a",5),D(15,"Transacciones"),w()(),x(16,"li")(17,"a",6),D(18,"Clientes"),w()()()()(),x(19,"div",7),dn(20,"router-outlet"),w())},dependencies:[xv,w1],styles:[".navbar[_ngcontent-%COMP%]{padding:0 2rem;display:flex;justify-content:space-between;align-items:center;background-color:var(--black)}.navbar-brand[_ngcontent-%COMP%]{display:flex;align-items:center}img[_ngcontent-%COMP%]{height:6rem}ul[_ngcontent-%COMP%]{display:flex;flex-direction:row}li[_ngcontent-%COMP%]{list-style:none;list-style-type:none;margin-left:3rem}a[_ngcontent-%COMP%]{text-decoration:none;color:var(--white);font-weight:700;font-size:1rem;transition:color ease .6s;padding:1rem}a[_ngcontent-%COMP%]:hover{color:var(--yellow)}"]});let t=e;return t})();var qF=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=it({type:e,bootstrap:[HF]}),e.\u0275inj=rt({imports:[PA,y2,h2,H1.initializeApp(v2.firebaseConfig),$F]});let t=e;return t})();RA().bootstrapModule(qF).catch(t=>console.error(t));
