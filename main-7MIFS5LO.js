import{A as Sb,B as xn,C as ci,D as Hd,E as Fc,F as e_,G as Ab,H as Mb,I as q,J as Jt,K as at,L as t_,M as Rb,N as Vc,O as le,P as cn,Q as qd,R as n_,S as wn,T as ui,U as as,V as Gd,W as Nb,X as Ln,Y as xt,a as A,b as ue,c as Zm,d as g,e as vb,f as Ld,g as xb,h as wb,i as D,j as bo,k as jd,l as Eb,m as Ib,n as ht,o as Bd,p as Oc,q as Xm,r as Cb,s as ir,t as Jm,u as Ud,v as bb,w as Db,x as $d,y as Ye,z as Tb}from"./chunk-44ZLHZR4.js";var Pb=null;var r_=1,i_=Symbol("SIGNAL");function we(t){let e=Pb;return Pb=t,e}var kb={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function D2(t){if(!(a_(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===r_)){if(!t.producerMustRecompute(t)&&!s_(t)){t.dirty=!1,t.lastCleanEpoch=r_;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=r_}}function Ob(t){return t&&(t.nextProducerIndex=0),we(t)}function Fb(t,e){if(we(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(a_(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)o_(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function s_(t){zd(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(D2(n),r!==n.version))return!0}return!1}function Vb(t){if(zd(t),a_(t))for(let e=0;e<t.producerNode.length;e++)o_(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function o_(t,e){if(T2(t),zd(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)o_(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];zd(i),i.producerIndexOfThis[r]=e}}function a_(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function zd(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function T2(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function S2(){throw new Error}var A2=S2;function Lb(t){A2=t}function W(t){return typeof t=="function"}function Do(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Wd=Do(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function cs(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Ge=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(W(r))try{r()}catch(s){e=s instanceof Wd?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{jb(s)}catch(o){e=e??[],o instanceof Wd?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Wd(e)}}add(e){var n;if(e&&e!==this)if(this.closed)jb(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&cs(n,e)}remove(e){let{_finalizers:n}=this;n&&cs(n,e),e instanceof t&&e._removeParent(this)}};Ge.EMPTY=(()=>{let t=new Ge;return t.closed=!0,t})();var c_=Ge.EMPTY;function Kd(t){return t instanceof Ge||t&&"closed"in t&&W(t.remove)&&W(t.add)&&W(t.unsubscribe)}function jb(t){W(t)?t():t.unsubscribe()}var jn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var To={setTimeout(t,e,...n){let{delegate:r}=To;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=To;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Qd(t){To.setTimeout(()=>{let{onUnhandledError:e}=jn;if(e)e(t);else throw t})}function us(){}var Bb=u_("C",void 0,void 0);function Ub(t){return u_("E",void 0,t)}function $b(t){return u_("N",t,void 0)}function u_(t,e,n){return{kind:t,value:e,error:n}}var ls=null;function So(t){if(jn.useDeprecatedSynchronousErrorHandling){let e=!ls;if(e&&(ls={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=ls;if(ls=null,n)throw r}}else t()}function Hb(t){jn.useDeprecatedSynchronousErrorHandling&&ls&&(ls.errorThrown=!0,ls.error=t)}var ds=class extends Ge{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Kd(e)&&e.add(this)):this.destination=N2}static create(e,n,r){return new Fr(e,n,r)}next(e){this.isStopped?d_($b(e),this):this._next(e)}error(e){this.isStopped?d_(Ub(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?d_(Bb,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},M2=Function.prototype.bind;function l_(t,e){return M2.call(t,e)}var h_=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){Yd(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){Yd(r)}else Yd(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){Yd(n)}}},Fr=class extends ds{constructor(e,n,r){super();let i;if(W(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&jn.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&l_(e.next,s),error:e.error&&l_(e.error,s),complete:e.complete&&l_(e.complete,s)}):i=e}this.destination=new h_(i)}};function Yd(t){jn.useDeprecatedSynchronousErrorHandling?Hb(t):Qd(t)}function R2(t){throw t}function d_(t,e){let{onStoppedNotification:n}=jn;n&&To.setTimeout(()=>n(t,e))}var N2={closed:!0,next:us,error:R2,complete:us};var Ao=typeof Symbol=="function"&&Symbol.observable||"@@observable";function wt(t){return t}function f_(...t){return p_(t)}function p_(t){return t.length===0?wt:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var ie=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=k2(n)?n:new Fr(n,r,i);return So(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=qb(r),new r((i,s)=>{let o=new Fr({next:a=>{try{n(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[Ao](){return this}pipe(...n){return p_(n)(this)}toPromise(n){return n=qb(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function qb(t){var e;return(e=t??jn.Promise)!==null&&e!==void 0?e:Promise}function P2(t){return t&&W(t.next)&&W(t.error)&&W(t.complete)}function k2(t){return t&&t instanceof ds||P2(t)&&Kd(t)}function g_(t){return W(t?.lift)}function Z(t){return e=>{if(g_(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function K(t,e,n,r,i){return new m_(t,e,n,r,i)}var m_=class extends ds{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Mo(){return Z((t,e)=>{let n=null;t._refCount++;let r=K(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var Ro=class extends ie{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,g_(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Ge;let n=this.getSubject();e.add(this.source.subscribe(K(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Ge.EMPTY)}return e}refCount(){return Mo()(this)}};var Gb=Do(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ue=(()=>{class t extends ie{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new Zd(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new Gb}next(n){So(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){So(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){So(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?c_:(this.currentObservers=null,s.push(n),new Ge(()=>{this.currentObservers=null,cs(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new ie;return n.source=this,n}}return t.create=(e,n)=>new Zd(e,n),t})(),Zd=class extends Ue{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:c_}};var Et=class extends Ue{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Lc={now(){return(Lc.delegate||Date).now()},delegate:void 0};var Xd=class extends Ue{constructor(e=1/0,n=1/0,r=Lc){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=n.now(),a=0;for(let c=1;c<r.length&&r[c]<=o;c+=2)a=c;a&&r.splice(0,a+1)}}};var Jd=class extends Ge{constructor(e,n){super()}schedule(e,n=0){return this}};var jc={setInterval(t,e,...n){let{delegate:r}=jc;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=jc;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var No=class extends Jd{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return jc.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&jc.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,cs(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var Po=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};Po.now=Lc.now;var ko=class extends Po{constructor(e,n=Po.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var hs=new ko(No);var eh=class extends No{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var th=class extends ko{};var __=new th(eh);var Ft=new ie(t=>t.complete());function zb(t){return t&&W(t.schedule)}function y_(t){return t[t.length-1]}function Oo(t){return W(y_(t))?t.pop():void 0}function sr(t){return zb(y_(t))?t.pop():void 0}function Wb(t,e){return typeof y_(t)=="number"?t.pop():e}var nh=t=>t&&typeof t.length=="number"&&typeof t!="function";function rh(t){return W(t?.then)}function ih(t){return W(t[Ao])}function sh(t){return Symbol.asyncIterator&&W(t?.[Symbol.asyncIterator])}function oh(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function O2(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var ah=O2();function ch(t){return W(t?.[ah])}function uh(t){return xb(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield Ld(n.read());if(i)return yield Ld(void 0);yield yield Ld(r)}}finally{n.releaseLock()}})}function lh(t){return W(t?.getReader)}function De(t){if(t instanceof ie)return t;if(t!=null){if(ih(t))return F2(t);if(nh(t))return V2(t);if(rh(t))return L2(t);if(sh(t))return Kb(t);if(ch(t))return j2(t);if(lh(t))return B2(t)}throw oh(t)}function F2(t){return new ie(e=>{let n=t[Ao]();if(W(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function V2(t){return new ie(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function L2(t){return new ie(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,Qd)})}function j2(t){return new ie(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function Kb(t){return new ie(e=>{U2(t,e).catch(n=>e.error(n))})}function B2(t){return Kb(uh(t))}function U2(t,e){var n,r,i,s;return vb(this,void 0,void 0,function*(){try{for(n=wb(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function en(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function En(t,e=0){return Z((n,r)=>{n.subscribe(K(r,i=>en(r,t,()=>r.next(i),e),()=>en(r,t,()=>r.complete(),e),i=>en(r,t,()=>r.error(i),e)))})}function Bn(t,e=0){return Z((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function Qb(t,e){return De(t).pipe(Bn(e),En(e))}function Yb(t,e){return De(t).pipe(Bn(e),En(e))}function Zb(t,e){return new ie(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function Xb(t,e){return new ie(n=>{let r;return en(n,e,()=>{r=t[ah](),en(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>W(r?.return)&&r.return()})}function dh(t,e){if(!t)throw new Error("Iterable cannot be null");return new ie(n=>{en(n,e,()=>{let r=t[Symbol.asyncIterator]();en(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function Jb(t,e){return dh(uh(t),e)}function eD(t,e){if(t!=null){if(ih(t))return Qb(t,e);if(nh(t))return Zb(t,e);if(rh(t))return Yb(t,e);if(sh(t))return dh(t,e);if(ch(t))return Xb(t,e);if(lh(t))return Jb(t,e)}throw oh(t)}function ye(t,e){return e?eD(t,e):De(t)}function B(...t){let e=sr(t);return ye(t,e)}function Fo(t,e){let n=W(t)?t:()=>t,r=i=>i.error(n());return new ie(e?i=>e.schedule(r,0,i):r)}function v_(t){return!!t&&(t instanceof ie||W(t.lift)&&W(t.subscribe))}var Vr=Do(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function j(t,e){return Z((n,r)=>{let i=0;n.subscribe(K(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:$2}=Array;function H2(t,e){return $2(e)?t(...e):t(e)}function hh(t){return j(e=>H2(t,e))}var{isArray:q2}=Array,{getPrototypeOf:G2,prototype:z2,keys:W2}=Object;function fh(t){if(t.length===1){let e=t[0];if(q2(e))return{args:e,keys:null};if(K2(e)){let n=W2(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function K2(t){return t&&typeof t=="object"&&G2(t)===z2}function ph(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function Bc(...t){let e=sr(t),n=Oo(t),{args:r,keys:i}=fh(t);if(r.length===0)return ye([],e);let s=new ie(Q2(r,e,i?o=>ph(i,o):wt));return n?s.pipe(hh(n)):s}function Q2(t,e,n=wt){return r=>{tD(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)tD(e,()=>{let u=ye(t[c],e),l=!1;u.subscribe(K(r,d=>{s[c]=d,l||(l=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function tD(t,e,n){t?en(n,t,e):e()}function nD(t,e,n,r,i,s,o,a){let c=[],u=0,l=0,d=!1,h=()=>{d&&!c.length&&!u&&e.complete()},f=m=>u<r?p(m):c.push(m),p=m=>{s&&e.next(m),u++;let v=!1;De(n(m,l++)).subscribe(K(e,C=>{i?.(C),s?f(C):e.next(C)},()=>{v=!0},void 0,()=>{if(v)try{for(u--;c.length&&u<r;){let C=c.shift();o?en(e,o,()=>p(C)):p(C)}h()}catch(C){e.error(C)}}))};return t.subscribe(K(e,f,()=>{d=!0,h()})),()=>{a?.()}}function Ze(t,e,n=1/0){return W(e)?Ze((r,i)=>j((s,o)=>e(r,s,i,o))(De(t(r,i))),n):(typeof e=="number"&&(n=e),Z((r,i)=>nD(r,i,t,n)))}function li(t=1/0){return Ze(wt,t)}function rD(){return li(1)}function Vo(...t){return rD()(ye(t,sr(t)))}function gh(t){return new ie(e=>{De(t()).subscribe(e)})}function x_(...t){let e=Oo(t),{args:n,keys:r}=fh(t),i=new ie(s=>{let{length:o}=n;if(!o){s.complete();return}let a=new Array(o),c=o,u=o;for(let l=0;l<o;l++){let d=!1;De(n[l]).subscribe(K(s,h=>{d||(d=!0,u--),a[l]=h},()=>c--,void 0,()=>{(!c||!d)&&(u||s.next(r?ph(r,a):a),s.complete())}))}});return e?i.pipe(hh(e)):i}function Lo(...t){let e=sr(t),n=Wb(t,1/0),r=t;return r.length?r.length===1?De(r[0]):li(n)(ye(r,e)):Ft}function It(t,e){return Z((n,r)=>{let i=0;n.subscribe(K(r,s=>t.call(e,s,i++)&&r.next(s)))})}function di(t){return Z((e,n)=>{let r=null,i=!1,s;r=e.subscribe(K(n,void 0,void 0,o=>{s=De(t(o,di(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function iD(t,e,n,r,i){return(s,o)=>{let a=n,c=e,u=0;s.subscribe(K(o,l=>{let d=u++;c=a?t(c,l,d):(a=!0,l),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function fs(t,e){return W(e)?Ze(t,e,1):Ze(t,1)}function hi(t){return Z((e,n)=>{let r=!1;e.subscribe(K(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function Lr(t){return t<=0?()=>Ft:Z((e,n)=>{let r=0;e.subscribe(K(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function w_(t){return j(()=>t)}function Uc(t,e=wt){return t=t??Y2,Z((n,r)=>{let i,s=!0;n.subscribe(K(r,o=>{let a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function Y2(t,e){return t===e}function mh(t=Z2){return Z((e,n)=>{let r=!1;e.subscribe(K(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function Z2(){return new Vr}function $c(t){return Z((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function In(t,e){let n=arguments.length>=2;return r=>r.pipe(t?It((i,s)=>t(i,s,r)):wt,Lr(1),n?hi(e):mh(()=>new Vr))}function jo(t){return t<=0?()=>Ft:Z((e,n)=>{let r=[];e.subscribe(K(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function E_(t,e){let n=arguments.length>=2;return r=>r.pipe(t?It((i,s)=>t(i,s,r)):wt,jo(1),n?hi(e):mh(()=>new Vr))}function Hc(){return Z((t,e)=>{let n,r=!1;t.subscribe(K(e,i=>{let s=n;n=i,r&&e.next([s,i]),r=!0}))})}function or(t,e){return Z(iD(t,e,arguments.length>=2,!0))}function qc(t={}){let{connector:e=()=>new Ue,resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,c,u=0,l=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=c=void 0,l=d=!1},p=()=>{let m=o;f(),m?.unsubscribe()};return Z((m,v)=>{u++,!d&&!l&&h();let C=c=c??e();v.add(()=>{u--,u===0&&!d&&!l&&(a=I_(p,i))}),C.subscribe(v),!o&&u>0&&(o=new Fr({next:F=>C.next(F),error:F=>{d=!0,h(),a=I_(f,n,F),C.error(F)},complete:()=>{l=!0,h(),a=I_(f,r),C.complete()}}),De(m).subscribe(o))})(s)}}function I_(t,e,...n){if(e===!0){t();return}if(e===!1)return;let r=new Fr({next:()=>{r.unsubscribe(),t()}});return De(e(...n)).subscribe(r)}function _h(t,e,n){let r,i=!1;return t&&typeof t=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t:r=t??1/0,qc({connector:()=>new Xd(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function C_(t){return Z((e,n)=>{let r=!1,i=0;e.subscribe(K(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}function ps(...t){let e=sr(t);return Z((n,r)=>{(e?Vo(t,n,e):Vo(t,n)).subscribe(r)})}function Oe(t,e){return Z((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(K(r,c=>{i?.unsubscribe();let u=0,l=s++;De(t(c,l)).subscribe(i=K(r,d=>r.next(e?e(c,d,l,u++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function yh(t,e){return W(e)?Oe(()=>t,e):Oe(()=>t)}function b_(t){return Z((e,n)=>{De(t).subscribe(K(n,()=>n.complete(),us)),!n.closed&&e.subscribe(n)})}function ct(t,e,n){let r=W(t)||e||n?{next:t,error:e,complete:n}:t;return r?Z((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(K(s,c=>{var u;(u=r.next)===null||u===void 0||u.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var u;a=!1,(u=r.error)===null||u===void 0||u.call(r,c),s.error(c)},()=>{var c,u;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):wt}function D_(...t){let e=Oo(t);return Z((n,r)=>{let i=t.length,s=new Array(i),o=t.map(()=>!1),a=!1;for(let c=0;c<i;c++)De(t[c]).subscribe(K(r,u=>{s[c]=u,!a&&!o[c]&&(o[c]=!0,(a=o.every(wt))&&(o=null))},us));n.subscribe(K(r,c=>{if(a){let u=[c,...s];r.next(e?e(...u):u)}}))})}var qD="https://g.co/ng/security#xss",$=class extends Error{constructor(e,n){super(S0(e,n)),this.code=e}};function S0(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}function ru(t){return{toString:t}.toString()}var vh="__parameters__";function X2(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function GD(t,e,n){return ru(()=>{let r=X2(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,u,l){let d=c.hasOwnProperty(vh)?c[vh]:Object.defineProperty(c,vh,{value:[]})[vh];for(;d.length<=l;)d.push(null);return(d[l]=d[l]||[]).push(o),c}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}var Lt=globalThis;function Te(t){for(let e in t)if(t[e]===Te)return e;throw Error("Could not find renamed property on target object.")}function J2(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function jt(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(jt).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function sD(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var eV=Te({__forward_ref__:Te});function vi(t){return t.__forward_ref__=vi,t.toString=function(){return jt(this())},t}function Vt(t){return zD(t)?t():t}function zD(t){return typeof t=="function"&&t.hasOwnProperty(eV)&&t.__forward_ref__===vi}function V(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Je(t){return{providers:t.providers||[],imports:t.imports||[]}}function Xh(t){return oD(t,KD)||oD(t,QD)}function WD(t){return Xh(t)!==null}function oD(t,e){return t.hasOwnProperty(e)?t[e]:null}function tV(t){let e=t&&(t[KD]||t[QD]);return e||null}function aD(t){return t&&(t.hasOwnProperty(cD)||t.hasOwnProperty(nV))?t[cD]:null}var KD=Te({\u0275prov:Te}),cD=Te({\u0275inj:Te}),QD=Te({ngInjectableDef:Te}),nV=Te({ngInjectorDef:Te}),O=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=V({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function YD(t){return t&&!!t.\u0275providers}var rV=Te({\u0275cmp:Te}),iV=Te({\u0275dir:Te}),sV=Te({\u0275pipe:Te}),oV=Te({\u0275mod:Te}),Ah=Te({\u0275fac:Te}),Gc=Te({__NG_ELEMENT_ID__:Te}),uD=Te({__NG_ENV_ID__:Te});function Jh(t){return typeof t=="string"?t:t==null?"":String(t)}function aV(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():Jh(t)}function cV(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new $(-200,t)}function A0(t,e){throw new $(-201,!1)}var ae=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(ae||{}),U_;function ZD(){return U_}function Cn(t){let e=U_;return U_=t,e}function XD(t,e,n){let r=Xh(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&ae.Optional)return null;if(e!==void 0)return e;A0(t,"Injector")}var uV={},Wc=uV,$_="__NG_DI_FLAG__",Mh="ngTempTokenPath",lV="ngTokenPath",dV=/\n/gm,hV="\u0275",lD="__source",qo;function fV(){return qo}function fi(t){let e=qo;return qo=t,e}function pV(t,e=ae.Default){if(qo===void 0)throw new $(-203,!1);return qo===null?XD(t,void 0,e):qo.get(t,e&ae.Optional?null:void 0,e)}function w(t,e=ae.Default){return(ZD()||pV)(Vt(t),e)}function P(t,e=ae.Default){return w(t,ef(e))}function ef(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function H_(t){let e=[];for(let n=0;n<t.length;n++){let r=Vt(t[n]);if(Array.isArray(r)){if(r.length===0)throw new $(900,!1);let i,s=ae.Default;for(let o=0;o<r.length;o++){let a=r[o],c=gV(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(w(i,s))}else e.push(w(r))}return e}function JD(t,e){return t[$_]=e,t.prototype[$_]=e,t}function gV(t){return t[$_]}function mV(t,e,n,r){let i=t[Mh];throw e[lD]&&i.unshift(e[lD]),t.message=_V(`
`+t.message,i,n,r),t[lV]=i,t[Mh]=null,t}function _V(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==hV?t.slice(2):t;let i=jt(e);if(Array.isArray(e))i=e.map(jt).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):jt(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(dV,`
  `)}`}var ta=JD(GD("Optional"),8);var M0=JD(GD("SkipSelf"),4);function zo(t,e){let n=t.hasOwnProperty(Ah);return n?t[Ah]:null}function R0(t,e){t.forEach(n=>Array.isArray(n)?R0(n,e):e(n))}function eT(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Rh(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function yV(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let s=i-2;t[i]=t[s],i--}t[e]=n,t[e+1]=r}}function vV(t,e,n){let r=iu(t,e);return r>=0?t[r|1]=n:(r=~r,yV(t,r,e,n)),r}function T_(t,e){let n=iu(t,e);if(n>=0)return t[n|1]}function iu(t,e){return xV(t,e,1)}function xV(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}var Wo={},bn=[],Ko=new O(""),tT=new O("",-1),nT=new O(""),Nh=class{get(e,n=Wc){if(n===Wc){let r=new Error(`NullInjectorError: No provider for ${jt(e)}!`);throw r.name="NullInjectorError",r}return n}},rT=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(rT||{}),ur=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(ur||{}),Bt=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(Bt||{});function wV(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function q_(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];EV(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function iT(t){return t===3||t===4||t===6}function EV(t){return t.charCodeAt(0)===64}function Kc(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?dD(t,n,i,null,e[++r]):dD(t,n,i,null,null))}}return t}function dD(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var sT="ng-template";function IV(t,e,n,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&wV(e[i+1].toLowerCase(),n,0)!==-1)return!0}else if(N0(t))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===n)return!0}return!1}function N0(t){return t.type===4&&t.value!==sT}function CV(t,e,n){let r=t.type===4&&!n?sT:t.value;return e===r}function bV(t,e,n){let r=4,i=t.attrs,s=i!==null?SV(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!Un(r)&&!Un(c))return!1;if(o&&Un(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!CV(t,c,n)||c===""&&e.length===1){if(Un(r))return!1;o=!0}}else if(r&8){if(i===null||!IV(t,i,c,n)){if(Un(r))return!1;o=!0}}else{let u=e[++a],l=DV(c,i,N0(t),n);if(l===-1){if(Un(r))return!1;o=!0;continue}if(u!==""){let d;if(l>s?d="":d=i[l+1].toLowerCase(),r&2&&u!==d){if(Un(r))return!1;o=!0}}}}return Un(r)||o}function Un(t){return(t&1)===0}function DV(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return AV(e,t)}function TV(t,e,n=!1){for(let r=0;r<e.length;r++)if(bV(t,e[r],n))return!0;return!1}function SV(t){for(let e=0;e<t.length;e++){let n=t[e];if(iT(n))return e}return t.length}function AV(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function hD(t,e){return t?":not("+e.trim()+")":e}function MV(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Un(o)&&(e+=hD(s,i),i=""),r=o,s=s||!Un(r);n++}return i!==""&&(e+=hD(s,i)),e}function RV(t){return t.map(MV).join(",")}function NV(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!Un(i))break;i=s}r++}return{attrs:e,classes:n}}function Tn(t){return ru(()=>{let e=lT(t),n=ue(A({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===rT.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||ur.Emulated,styles:t.styles||bn,_:null,schemas:t.schemas||null,tView:null,id:""});dT(n);let r=t.dependencies;return n.directiveDefs=pD(r,!1),n.pipeDefs=pD(r,!0),n.id=OV(n),n})}function PV(t){return gi(t)||oT(t)}function kV(t){return t!==null}function et(t){return ru(()=>({type:t.type,bootstrap:t.bootstrap||bn,declarations:t.declarations||bn,imports:t.imports||bn,exports:t.exports||bn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function fD(t,e){if(t==null)return Wo;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s,o,a=Bt.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(n[s]=a!==Bt.None?[r,a]:r,e[s]=o):n[s]=r}return n}function Ct(t){return ru(()=>{let e=lT(t);return dT(e),e})}function gi(t){return t[rV]||null}function oT(t){return t[iV]||null}function aT(t){return t[sV]||null}function cT(t){let e=gi(t)||oT(t)||aT(t);return e!==null?e.standalone:!1}function uT(t,e){let n=t[oV]||null;if(!n&&e===!0)throw new Error(`Type ${jt(t)} does not have '\u0275mod' property.`);return n}function lT(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||Wo,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||bn,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:fD(t.inputs,e),outputs:fD(t.outputs),debugInfo:null}}function dT(t){t.features?.forEach(e=>e(t))}function pD(t,e){if(!t)return null;let n=e?aT:PV;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(kV)}function OV(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function FV(...t){return{\u0275providers:hT(!0,t),\u0275fromNgModule:!0}}function hT(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return R0(e,o=>{let a=o;G_(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&fT(i,s),n}function fT(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];P0(i,s=>{e(s,r)})}}function G_(t,e,n,r){if(t=Vt(t),!t)return!1;let i=null,s=aD(t),o=!s&&gi(t);if(!s&&!o){let c=t.ngModule;if(s=aD(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let u of c)G_(u,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let u;try{R0(s.imports,l=>{G_(l,e,n,r)&&(u||=[],u.push(l))})}finally{}u!==void 0&&fT(u,e)}if(!a){let u=zo(i)||(()=>new i);e({provide:i,useFactory:u,deps:bn},i),e({provide:nT,useValue:i,multi:!0},i),e({provide:Ko,useValue:()=>w(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let u=t;P0(c,l=>{e(l,u)})}}else return!1;return i!==t&&t.providers!==void 0}function P0(t,e){for(let n of t)YD(n)&&(n=n.\u0275providers),Array.isArray(n)?P0(n,e):e(n)}var VV=Te({provide:String,useValue:Te});function pT(t){return t!==null&&typeof t=="object"&&VV in t}function LV(t){return!!(t&&t.useExisting)}function jV(t){return!!(t&&t.useFactory)}function Qo(t){return typeof t=="function"}function BV(t){return!!t.useClass}var tf=new O(""),Ch={},UV={},S_;function k0(){return S_===void 0&&(S_=new Nh),S_}var un=class{},Qc=class extends un{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,W_(e,o=>this.processProvider(o)),this.records.set(tT,Bo(void 0,this)),i.has("environment")&&this.records.set(un,Bo(void 0,this));let s=this.records.get(tf);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(nT,bn,ae.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=we(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),we(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=fi(this),r=Cn(void 0),i;try{return e()}finally{fi(n),Cn(r)}}get(e,n=Wc,r=ae.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(uD))return e[uD](this);r=ef(r);let i,s=fi(this),o=Cn(void 0);try{if(!(r&ae.SkipSelf)){let c=this.records.get(e);if(c===void 0){let u=zV(e)&&Xh(e);u&&this.injectableDefInScope(u)?c=Bo(z_(e),Ch):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&ae.Self?k0():this.parent;return n=r&ae.Optional&&n===Wc?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[Mh]=a[Mh]||[]).unshift(jt(e)),s)throw a;return mV(a,e,"R3InjectorError",this.source)}else throw a}finally{Cn(o),fi(s)}}resolveInjectorInitializers(){let e=we(null),n=fi(this),r=Cn(void 0),i;try{let s=this.get(Ko,bn,ae.Self);for(let o of s)o()}finally{fi(n),Cn(r),we(e)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(jt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new $(205,!1)}processProvider(e){e=Vt(e);let n=Qo(e)?e:Vt(e&&e.provide),r=HV(e);if(!Qo(e)&&e.multi===!0){let i=this.records.get(n);i||(i=Bo(void 0,Ch,!0),i.factory=()=>H_(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){let r=we(null);try{return n.value===Ch&&(n.value=UV,n.value=n.factory()),typeof n.value=="object"&&n.value&&GV(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{we(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let n=Vt(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function z_(t){let e=Xh(t),n=e!==null?e.factory:zo(t);if(n!==null)return n;if(t instanceof O)throw new $(204,!1);if(t instanceof Function)return $V(t);throw new $(204,!1)}function $V(t){if(t.length>0)throw new $(204,!1);let n=tV(t);return n!==null?()=>n.factory(t):()=>new t}function HV(t){if(pT(t))return Bo(void 0,t.useValue);{let e=gT(t);return Bo(e,Ch)}}function gT(t,e,n){let r;if(Qo(t)){let i=Vt(t);return zo(i)||z_(i)}else if(pT(t))r=()=>Vt(t.useValue);else if(jV(t))r=()=>t.useFactory(...H_(t.deps||[]));else if(LV(t))r=()=>w(Vt(t.useExisting));else{let i=Vt(t&&(t.useClass||t.provide));if(qV(t))r=()=>new i(...H_(t.deps));else return zo(i)||z_(i)}return r}function Bo(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function qV(t){return!!t.deps}function GV(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function zV(t){return typeof t=="function"||typeof t=="object"&&t instanceof O}function W_(t,e){for(let n of t)Array.isArray(n)?W_(n,e):n&&YD(n)?W_(n.\u0275providers,e):e(n)}function Ur(t,e){t instanceof Qc&&t.assertNotDestroyed();let n,r=fi(t),i=Cn(void 0);try{return e()}finally{fi(r),Cn(i)}}function mT(){return ZD()!==void 0||fV()!=null}function WV(t){if(!mT())throw new $(-203,!1)}function KV(t){let e=Lt.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function QV(t){return typeof t=="function"}var $r=0,pe=1,G=2,At=3,$n=4,Gn=5,Ph=6,Yc=7,Hn=8,Yo=9,qn=10,Xe=11,Zc=12,gD=13,na=14,lr=15,nf=16,Uo=17,Zo=18,rf=19,_T=20,pi=21,A_=22,_s=23,mi=25,yT=1;var ys=7,kh=8,Oh=9,Dn=10,O0=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(O0||{});function gs(t){return Array.isArray(t)&&typeof t[yT]=="object"}function Hr(t){return Array.isArray(t)&&t[yT]===!0}function vT(t){return(t.flags&4)!==0}function sf(t){return t.componentOffset>-1}function F0(t){return(t.flags&1)===1}function _i(t){return!!t.template}function YV(t){return(t[G]&512)!==0}var K_=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function xT(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}function Cs(){return wT}function wT(t){return t.type.prototype.ngOnChanges&&(t.setInput=XV),ZV}Cs.ngInherit=!0;function ZV(){let t=IT(this),e=t?.current;if(e){let n=t.previous;if(n===Wo)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function XV(t,e,n,r,i){let s=this.declaredInputs[r],o=IT(t)||JV(t,{previous:Wo,current:null}),a=o.current||(o.current={}),c=o.previous,u=c[s];a[s]=new K_(u&&u.currentValue,n,c===Wo),xT(t,e,i,n)}var ET="__ngSimpleChanges__";function IT(t){return t[ET]||null}function JV(t,e){return t[ET]=e}var mD=null;var ar=function(t,e,n){mD?.(t,e,n)},eL="svg",tL="math",nL=!1;function rL(){return nL}function dr(t){for(;Array.isArray(t);)t=t[$r];return t}function CT(t,e){return dr(e[t])}function Sn(t,e){return dr(e[t.index])}function bT(t,e){return t.data[e]}function xi(t,e){let n=e[t];return gs(n)?n:n[$r]}function V0(t){return(t[G]&128)===128}function iL(t){return Hr(t[At])}function Fh(t,e){return e==null?null:t[e]}function DT(t){t[Uo]=0}function sL(t){t[G]&1024||(t[G]|=1024,V0(t)&&Xc(t))}function oL(t,e){for(;t>0;)e=e[na],t--;return e}function L0(t){return!!(t[G]&9216||t[_s]?.dirty)}function Q_(t){t[qn].changeDetectionScheduler?.notify(1),L0(t)?Xc(t):t[G]&64&&(rL()?(t[G]|=1024,Xc(t)):t[qn].changeDetectionScheduler?.notify())}function Xc(t){t[qn].changeDetectionScheduler?.notify();let e=Jc(t);for(;e!==null&&!(e[G]&8192||(e[G]|=8192,!V0(e)));)e=Jc(e)}function TT(t,e){if((t[G]&256)===256)throw new $(911,!1);t[pi]===null&&(t[pi]=[]),t[pi].push(e)}function aL(t,e){if(t[pi]===null)return;let n=t[pi].indexOf(e);n!==-1&&t[pi].splice(n,1)}function Jc(t){let e=t[At];return Hr(e)?e[At]:e}var he={lFrame:kT(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function cL(){return he.lFrame.elementDepthCount}function uL(){he.lFrame.elementDepthCount++}function lL(){he.lFrame.elementDepthCount--}function ST(){return he.bindingsEnabled}function dL(){return he.skipHydrationRootTNode!==null}function hL(t){return he.skipHydrationRootTNode===t}function fL(){he.skipHydrationRootTNode=null}function Me(){return he.lFrame.lView}function tn(){return he.lFrame.tView}function Ut(t){return he.lFrame.contextLView=t,t[Hn]}function $t(t){return he.lFrame.contextLView=null,t}function nn(){let t=AT();for(;t!==null&&t.type===64;)t=t.parent;return t}function AT(){return he.lFrame.currentTNode}function pL(){let t=he.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function su(t,e){let n=he.lFrame;n.currentTNode=t,n.isParent=e}function MT(){return he.lFrame.isParent}function gL(){he.lFrame.isParent=!1}function mL(t){return he.lFrame.bindingIndex=t}function of(){return he.lFrame.bindingIndex++}function _L(t){let e=he.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function yL(){return he.lFrame.inI18n}function vL(t,e){let n=he.lFrame;n.bindingIndex=n.bindingRootIndex=t,Y_(e)}function xL(){return he.lFrame.currentDirectiveIndex}function Y_(t){he.lFrame.currentDirectiveIndex=t}function wL(t){let e=he.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function RT(t){he.lFrame.currentQueryIndex=t}function EL(t){let e=t[pe];return e.type===2?e.declTNode:e.type===1?t[Gn]:null}function NT(t,e,n){if(n&ae.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&ae.Host);)if(i=EL(s),i===null||(s=s[na],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=he.lFrame=PT();return r.currentTNode=e,r.lView=t,!0}function j0(t){let e=PT(),n=t[pe];he.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function PT(){let t=he.lFrame,e=t===null?null:t.child;return e===null?kT(t):e}function kT(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function OT(){let t=he.lFrame;return he.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var FT=OT;function B0(){let t=OT();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function IL(t){return(he.lFrame.contextLView=oL(t,he.lFrame.contextLView))[Hn]}function ra(){return he.lFrame.selectedIndex}function vs(t){he.lFrame.selectedIndex=t}function af(){let t=he.lFrame;return bT(t.tView,t.selectedIndex)}function CL(){return he.lFrame.currentNamespace}var VT=!0;function U0(){return VT}function $0(t){VT=t}function bL(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=wT(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function H0(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:u,ngOnDestroy:l}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),c&&(t.viewHooks??=[]).push(-n,c),u&&((t.viewHooks??=[]).push(n,u),(t.viewCheckHooks??=[]).push(n,u)),l!=null&&(t.destroyHooks??=[]).push(n,l)}}function bh(t,e,n){LT(t,e,3,n)}function Dh(t,e,n,r){(t[G]&3)===n&&LT(t,e,n,r)}function M_(t,e){let n=t[G];(n&3)===e&&(n&=16383,n+=1,t[G]=n)}function LT(t,e,n,r){let i=r!==void 0?t[Uo]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(t[Uo]+=65536),(a<s||s==-1)&&(DL(t,n,e,c),t[Uo]=(t[Uo]&4294901760)+c+2),c++}function _D(t,e){ar(4,t,e);let n=we(null);try{e.call(t)}finally{we(n),ar(5,t,e)}}function DL(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[G]>>14<t[Uo]>>16&&(t[G]&3)===e&&(t[G]+=16384,_D(a,s)):_D(a,s)}var Go=-1,xs=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function TL(t){return t instanceof xs}function SL(t){return(t.flags&8)!==0}function AL(t){return(t.flags&16)!==0}function jT(t){return t!==Go}function Vh(t){return t&32767}function ML(t){return t>>16}function Lh(t,e){let n=ML(t),r=e;for(;n>0;)r=r[na],n--;return r}var Z_=!0;function yD(t){let e=Z_;return Z_=t,e}var RL=256,BT=RL-1,UT=5,NL=0,cr={};function PL(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(Gc)&&(r=n[Gc]),r==null&&(r=n[Gc]=NL++);let i=r&BT,s=1<<i;e.data[t+(i>>UT)]|=s}function jh(t,e){let n=$T(t,e);if(n!==-1)return n;let r=e[pe];r.firstCreatePass&&(t.injectorIndex=e.length,R_(r.data,t),R_(e,null),R_(r.blueprint,null));let i=q0(t,e),s=t.injectorIndex;if(jT(i)){let o=Vh(i),a=Lh(i,e),c=a[pe].data;for(let u=0;u<8;u++)e[s+u]=a[o+u]|c[o+u]}return e[s+8]=i,s}function R_(t,e){t.push(0,0,0,0,0,0,0,0,e)}function $T(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function q0(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=WT(i),r===null)return Go;if(n++,i=i[na],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return Go}function X_(t,e,n){PL(t,e,n)}function kL(t,e){if(e==="class")return t.classes;if(e==="style")return t.styles;let n=t.attrs;if(n){let r=n.length,i=0;for(;i<r;){let s=n[i];if(iT(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof n[i]=="string";)i++;else{if(s===e)return n[i+1];i=i+2}}}return null}function HT(t,e,n){if(n&ae.Optional||t!==void 0)return t;A0(e,"NodeInjector")}function qT(t,e,n,r){if(n&ae.Optional&&r===void 0&&(r=null),!(n&(ae.Self|ae.Host))){let i=t[Yo],s=Cn(void 0);try{return i?i.get(e,r,n&ae.Optional):XD(e,r,n&ae.Optional)}finally{Cn(s)}}return HT(r,e,n)}function GT(t,e,n,r=ae.Default,i){if(t!==null){if(e[G]&2048&&!(r&ae.Self)){let o=jL(t,e,n,r,cr);if(o!==cr)return o}let s=zT(t,e,n,r,cr);if(s!==cr)return s}return qT(e,n,r,i)}function zT(t,e,n,r,i){let s=VL(n);if(typeof s=="function"){if(!NT(e,t,r))return r&ae.Host?HT(i,n,r):qT(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&ae.Optional))A0(n);else return o}finally{FT()}}else if(typeof s=="number"){let o=null,a=$T(t,e),c=Go,u=r&ae.Host?e[lr][Gn]:null;for((a===-1||r&ae.SkipSelf)&&(c=a===-1?q0(t,e):e[a+8],c===Go||!xD(r,!1)?a=-1:(o=e[pe],a=Vh(c),e=Lh(c,e)));a!==-1;){let l=e[pe];if(vD(s,a,l.data)){let d=OL(a,e,n,o,r,u);if(d!==cr)return d}c=e[a+8],c!==Go&&xD(r,e[pe].data[a+8]===u)&&vD(s,a,e)?(o=l,a=Vh(c),e=Lh(c,e)):a=-1}}return i}function OL(t,e,n,r,i,s){let o=e[pe],a=o.data[t+8],c=r==null?sf(a)&&Z_:r!=o&&(a.type&3)!==0,u=i&ae.Host&&s===a,l=FL(a,o,n,c,u);return l!==null?Xo(e,o,l,a):cr}function FL(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,c=t.directiveStart,u=t.directiveEnd,l=s>>20,d=r?a:a+l,h=i?a+l:u;for(let f=d;f<h;f++){let p=o[f];if(f<c&&n===p||f>=c&&p.type===n)return f}if(i){let f=o[c];if(f&&_i(f)&&f.type===n)return c}return null}function Xo(t,e,n,r){let i=t[n],s=e.data;if(TL(i)){let o=i;o.resolving&&cV(aV(s[n]));let a=yD(o.canSeeViewProviders);o.resolving=!0;let c,u=o.injectImpl?Cn(o.injectImpl):null,l=NT(t,r,ae.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&bL(n,s[n],e)}finally{u!==null&&Cn(u),yD(a),o.resolving=!1,FT()}}return i}function VL(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(Gc)?t[Gc]:void 0;return typeof e=="number"?e>=0?e&BT:LL:e}function vD(t,e,n){let r=1<<t;return!!(n[e+(t>>UT)]&r)}function xD(t,e){return!(t&ae.Self)&&!(t&ae.Host&&e)}var ms=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return GT(this._tNode,this._lView,e,ef(r),n)}};function LL(){return new ms(nn(),Me())}function wi(t){return ru(()=>{let e=t.prototype.constructor,n=e[Ah]||J_(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[Ah]||J_(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function J_(t){return zD(t)?()=>{let e=J_(Vt(t));return e&&e()}:zo(t)}function jL(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[G]&2048&&!(o[G]&512);){let a=zT(s,o,n,r|ae.Self,cr);if(a!==cr)return a;let c=s.parent;if(!c){let u=o[_T];if(u){let l=u.get(n,cr,r);if(l!==cr)return l}c=WT(o),o=o[na]}s=c}return i}function WT(t){let e=t[pe],n=e.type;return n===2?e.declTNode:n===1?t[Gn]:null}function G0(t){return kL(nn(),t)}function wD(t,e=null,n=null,r){let i=KT(t,e,n,r);return i.resolveInjectorInitializers(),i}function KT(t,e=null,n=null,r,i=new Set){let s=[n||bn,FV(t)];return r=r||(typeof t=="object"?void 0:jt(t)),new Qc(s,e||k0(),r||null,i)}var zn=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return wD({name:""},i,r,"");{let s=r.name??"";return wD({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=Wc,e.NULL=new Nh,e.\u0275prov=V({token:e,providedIn:"any",factory:()=>w(tT)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})();var BL="ngOriginalError";function N_(t){return t[BL]}var hr=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&N_(e);for(;n&&N_(n);)n=N_(n);return n||null}},QT=new O("",{providedIn:"root",factory:()=>P(hr).handleError.bind(void 0)}),z0=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=UL,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),e0=class extends z0{constructor(e){super(),this._lView=e}onDestroy(e){return TT(this._lView,e),()=>aL(this._lView,e)}};function UL(){return new e0(Me())}function $L(){return cf(nn(),Me())}function cf(t,e){return new fr(Sn(t,e))}var fr=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=$L;let t=e;return t})();var t0=class extends Ue{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,mT()&&(this.destroyRef=P(z0,{optional:!0})??void 0)}emit(e){let n=we(null);try{super.next(e)}finally{we(n)}}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=P_(s),i&&(i=P_(i)),o&&(o=P_(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof Ge&&e.add(a),a}};function P_(t){return e=>{setTimeout(t,void 0,e)}}var ut=t0;function YT(t){return(t.flags&128)===128}var n0;function ZT(t){n0=t}function HL(){if(n0!==void 0)return n0;if(typeof document<"u")return document;throw new $(210,!1)}var uf=new O("",{providedIn:"root",factory:()=>qL}),qL="ng",W0=new O(""),Mt=new O("",{providedIn:"platform",factory:()=>"unknown"});var K0=new O("",{providedIn:"root",factory:()=>HL().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var GL="h",zL="b";var WL=()=>null;function Q0(t,e,n=!1){return WL(t,e,n)}var XT=!1,KL=new O("",{providedIn:"root",factory:()=>XT});var xh;function QL(){if(xh===void 0&&(xh=null,Lt.trustedTypes))try{xh=Lt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return xh}function ED(t){return QL()?.createScriptURL(t)||t}var Bh=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${qD})`}};function ou(t){return t instanceof Bh?t.changingThisBreaksApplicationSecurity:t}function Y0(t,e){let n=YL(t);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${qD})`)}return n===e}function YL(t){return t instanceof Bh&&t.getTypeName()||null}var ZL=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function JT(t){return t=String(t),t.match(ZL)?t:"unsafe:"+t}var lf=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(lf||{});function XL(t){let e=tS();return e?e.sanitize(lf.URL,t)||"":Y0(t,"URL")?ou(t):JT(Jh(t))}function JL(t){let e=tS();if(e)return ED(e.sanitize(lf.RESOURCE_URL,t)||"");if(Y0(t,"ResourceURL"))return ED(ou(t));throw new $(904,!1)}function e4(t,e){return e==="src"&&(t==="embed"||t==="frame"||t==="iframe"||t==="media"||t==="script")||e==="href"&&(t==="base"||t==="link")?JL:XL}function eS(t,e,n){return e4(e,n)(t)}function tS(){let t=Me();return t&&t[qn].sanitizer}var nS=new Map,t4=0;function n4(){return t4++}function r4(t){nS.set(t[rf],t)}function i4(t){nS.delete(t[rf])}var ID="__ngContext__";function ws(t,e){gs(e)?(t[ID]=e[rf],r4(e)):t[ID]=e}function rS(t){return t instanceof Function?t():t}function s4(t){return(t??P(zn)).get(Mt)==="browser"}var jr=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(jr||{}),o4;function Z0(t,e){return o4(t,e)}function $o(t,e,n,r,i){if(r!=null){let s,o=!1;Hr(r)?s=r:gs(r)&&(o=!0,r=r[$r]);let a=dr(r);t===0&&n!==null?i==null?cS(e,n,a):Uh(e,n,a,i||null,!0):t===1&&n!==null?Uh(e,n,a,i||null,!0):t===2?I4(e,a,o):t===3&&e.destroyNode(a),s!=null&&b4(e,t,s,n,i)}}function a4(t,e){return t.createText(e)}function c4(t,e,n){t.setValue(e,n)}function iS(t,e,n){return t.createElement(e,n)}function u4(t,e){sS(t,e),e[$r]=null,e[Gn]=null}function l4(t,e,n,r,i,s){r[$r]=i,r[Gn]=e,df(t,r,n,1,i,s)}function sS(t,e){e[qn].changeDetectionScheduler?.notify(1),df(t,e,e[Xe],2,null,null)}function d4(t){let e=t[Zc];if(!e)return k_(t[pe],t);for(;e;){let n=null;if(gs(e))n=e[Zc];else{let r=e[Dn];r&&(n=r)}if(!n){for(;e&&!e[$n]&&e!==t;)gs(e)&&k_(e[pe],e),e=e[At];e===null&&(e=t),gs(e)&&k_(e[pe],e),n=e&&e[$n]}e=n}}function h4(t,e,n,r){let i=Dn+r,s=n.length;r>0&&(n[i-1][$n]=e),r<s-Dn?(e[$n]=n[i],eT(n,Dn+r,e)):(n.push(e),e[$n]=null),e[At]=n;let o=e[nf];o!==null&&n!==o&&f4(o,e);let a=e[Zo];a!==null&&a.insertView(t),Q_(e),e[G]|=128}function f4(t,e){let n=t[Oh],i=e[At][At][lr];e[lr]!==i&&(t[G]|=O0.HasTransplantedViews),n===null?t[Oh]=[e]:n.push(e)}function oS(t,e){let n=t[Oh],r=n.indexOf(e);n.splice(r,1)}function r0(t,e){if(t.length<=Dn)return;let n=Dn+e,r=t[n];if(r){let i=r[nf];i!==null&&i!==t&&oS(i,r),e>0&&(t[n-1][$n]=r[$n]);let s=Rh(t,Dn+e);u4(r[pe],r);let o=s[Zo];o!==null&&o.detachView(s[pe]),r[At]=null,r[$n]=null,r[G]&=-129}return r}function aS(t,e){if(!(e[G]&256)){let n=e[Xe];n.destroyNode&&df(t,e,n,3,null,null),d4(e)}}function k_(t,e){if(e[G]&256)return;let n=we(null);try{e[G]&=-129,e[G]|=256,e[_s]&&Vb(e[_s]),g4(t,e),p4(t,e),e[pe].type===1&&e[Xe].destroy();let r=e[nf];if(r!==null&&Hr(e[At])){r!==e[At]&&oS(r,e);let i=e[Zo];i!==null&&i.detachView(t)}i4(e)}finally{we(n)}}function p4(t,e){let n=t.cleanup,r=e[Yc];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[Yc]=null);let i=e[pi];if(i!==null){e[pi]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function g4(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof xs)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];ar(4,a,c);try{c.call(a)}finally{ar(5,a,c)}}else{ar(4,i,s);try{s.call(i)}finally{ar(5,i,s)}}}}}function m4(t,e,n){return _4(t,e.parent,n)}function _4(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[$r];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===ur.None||s===ur.Emulated)return null}return Sn(r,n)}}function Uh(t,e,n,r,i){t.insertBefore(e,n,r,i)}function cS(t,e,n){t.appendChild(e,n)}function CD(t,e,n,r,i){r!==null?Uh(t,e,n,r,i):cS(t,e,n)}function y4(t,e,n,r){t.removeChild(e,n,r)}function X0(t,e){return t.parentNode(e)}function v4(t,e){return t.nextSibling(e)}function x4(t,e,n){return E4(t,e,n)}function w4(t,e,n){return t.type&40?Sn(t,n):null}var E4=w4,bD;function J0(t,e,n,r){let i=m4(t,r,e),s=e[Xe],o=r.parent||e[Gn],a=x4(o,r,e);if(i!=null)if(Array.isArray(n))for(let c=0;c<n.length;c++)CD(s,i,n[c],a,!1);else CD(s,i,n,a,!1);bD!==void 0&&bD(s,r,e,n,i)}function Th(t,e){if(e!==null){let n=e.type;if(n&3)return Sn(e,t);if(n&4)return i0(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return Th(t,r);{let i=t[e.index];return Hr(i)?i0(-1,i):dr(i)}}else{if(n&32)return Z0(e,t)()||dr(t[e.index]);{let r=uS(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Jc(t[lr]);return Th(i,r)}else return Th(t,e.next)}}}return null}function uS(t,e){if(e!==null){let r=t[lr][Gn],i=e.projection;return r.projection[i]}return null}function i0(t,e){let n=Dn+t+1;if(n<e.length){let r=e[n],i=r[pe].firstChild;if(i!==null)return Th(r,i)}return e[ys]}function I4(t,e,n){let r=X0(t,e);r&&y4(t,r,e,n)}function ey(t,e,n,r,i,s,o){for(;n!=null;){let a=r[n.index],c=n.type;if(o&&e===0&&(a&&ws(dr(a),r),n.flags|=2),(n.flags&32)!==32)if(c&8)ey(t,e,n.child,r,i,s,!1),$o(e,t,i,a,s);else if(c&32){let u=Z0(n,r),l;for(;l=u();)$o(e,t,i,l,s);$o(e,t,i,a,s)}else c&16?C4(t,e,r,n,i,s):$o(e,t,i,a,s);n=o?n.projectionNext:n.next}}function df(t,e,n,r,i,s){ey(n,r,t.firstChild,e,i,s,!1)}function C4(t,e,n,r,i,s){let o=n[lr],c=o[Gn].projection[r.projection];if(Array.isArray(c))for(let u=0;u<c.length;u++){let l=c[u];$o(e,t,i,l,s)}else{let u=c,l=o[At];YT(r)&&(u.flags|=128),ey(t,e,u,l,i,s,!0)}}function b4(t,e,n,r,i){let s=n[ys],o=dr(n);s!==o&&$o(e,t,r,s,i);for(let a=Dn;a<n.length;a++){let c=n[a];df(c[pe],c,t,e,r,s)}}function D4(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=r.indexOf("-")===-1?void 0:jr.DashCase;i==null?t.removeStyle(n,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=jr.Important),t.setStyle(n,r,i,s))}}function T4(t,e,n){t.setAttribute(e,"style",n)}function lS(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function dS(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&q_(t,e,r),i!==null&&lS(t,e,i),s!==null&&T4(t,e,s)}var bs={};function X(t=1){hS(tn(),Me(),ra()+t,!1)}function hS(t,e,n,r){if(!r)if((e[G]&3)===3){let s=t.preOrderCheckHooks;s!==null&&bh(e,s,n)}else{let s=t.preOrderHooks;s!==null&&Dh(e,s,0,n)}vs(n)}function re(t,e=ae.Default){let n=Me();if(n===null)return w(t,e);let r=nn();return GT(r,n,Vt(t),e)}function fS(){let t="invalid";throw new Error(t)}function pS(t,e,n,r,i,s){let o=we(null);try{let a=null;i&Bt.SignalBased&&(a=e[r][i_]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&Bt.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,r):xT(e,a,r,s)}finally{we(o)}}function S4(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)vs(~i);else{let s=i,o=n[++r],a=n[++r];vL(o,s);let c=e[s];a(2,c)}}}finally{vs(-1)}}function hf(t,e,n,r,i,s,o,a,c,u,l){let d=e.blueprint.slice();return d[$r]=i,d[G]=r|4|128|8|64,(u!==null||t&&t[G]&2048)&&(d[G]|=2048),DT(d),d[At]=d[na]=t,d[Hn]=n,d[qn]=o||t&&t[qn],d[Xe]=a||t&&t[Xe],d[Yo]=c||t&&t[Yo]||null,d[Gn]=s,d[rf]=n4(),d[Ph]=l,d[_T]=u,d[lr]=e.type==2?t[lr]:d,d}function ff(t,e,n,r,i){let s=t.data[e];if(s===null)s=A4(t,e,n,r,i),yL()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=pL();s.injectorIndex=o===null?-1:o.injectorIndex}return su(s,!0),s}function A4(t,e,n,r,i){let s=AT(),o=MT(),a=o?s:s&&s.parent,c=t.data[e]=k4(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function gS(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function mS(t,e,n,r,i){let s=ra(),o=r&2;try{vs(-1),o&&e.length>mi&&hS(t,e,mi,!1),ar(o?2:0,i),n(r,i)}finally{vs(s),ar(o?3:1,i)}}function _S(t,e,n){if(vT(e)){let r=we(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];if(a.contentQueries){let c=n[o];a.contentQueries(1,c,o)}}}finally{we(r)}}}function yS(t,e,n){ST()&&(B4(t,e,n,Sn(n,e)),(n.flags&64)===64&&IS(t,e,n))}function vS(t,e,n=Sn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function xS(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=ty(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function ty(t,e,n,r,i,s,o,a,c,u,l){let d=mi+r,h=d+i,f=M4(d,h),p=typeof u=="function"?u():u;return f[pe]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:l}}function M4(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:bs);return n}function R4(t,e,n,r){let s=r.get(KL,XT)||n===ur.ShadowDom,o=t.selectRootElement(e,s);return N4(o),o}function N4(t){P4(t)}var P4=()=>null;function k4(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return dL()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function DD(t,e,n,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=Bt.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let u=s;if(i!==null){if(!i.hasOwnProperty(s))continue;u=i[s]}t===0?TD(r,n,u,a,c):TD(r,n,u,a)}return r}function TD(t,e,n,r,i){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,r):s=t[n]=[e,r],i!==void 0&&s.push(i)}function O4(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],c=null,u=null;for(let l=r;l<i;l++){let d=s[l],h=n?n.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;c=DD(0,d.inputs,l,c,f),u=DD(1,d.outputs,l,u,p);let m=c!==null&&o!==null&&!N0(e)?Z4(c,l,o):null;a.push(m)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=u}function F4(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function ny(t,e,n,r,i,s,o,a){let c=Sn(e,n),u=e.inputs,l;!a&&u!=null&&(l=u[r])?(ry(t,n,l,r,i),sf(e)&&V4(n,e.index)):e.type&3?(r=F4(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(c,r,i)):e.type&12}function V4(t,e){let n=xi(e,t);n[G]&16||(n[G]|=64)}function wS(t,e,n,r){if(ST()){let i=r===null?null:{"":-1},s=$4(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&ES(t,e,n,o,i,a),i&&H4(n,r,i)}n.mergedAttrs=Kc(n.mergedAttrs,n.attrs)}function ES(t,e,n,r,i,s){for(let u=0;u<r.length;u++)X_(jh(n,e),t,r[u].type);G4(n,t.data.length,r.length);for(let u=0;u<r.length;u++){let l=r[u];l.providersResolver&&l.providersResolver(l)}let o=!1,a=!1,c=gS(t,e,r.length,null);for(let u=0;u<r.length;u++){let l=r[u];n.mergedAttrs=Kc(n.mergedAttrs,l.hostAttrs),z4(t,n,e,c,l),q4(c,l,i),l.contentQueries!==null&&(n.flags|=4),(l.hostBindings!==null||l.hostAttrs!==null||l.hostVars!==0)&&(n.flags|=64);let d=l.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),c++}O4(t,n,s)}function L4(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;j4(o)!=a&&o.push(a),o.push(n,r,s)}}function j4(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function B4(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;sf(n)&&W4(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||jh(n,e),ws(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let c=t.data[a],u=Xo(e,t,a,n);if(ws(u,e),o!==null&&Y4(e,a-i,u,c,n,o),_i(c)){let l=xi(n.index,e);l[Hn]=Xo(e,t,a,n)}}}function IS(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=xL();try{vs(s);for(let a=r;a<i;a++){let c=t.data[a],u=e[a];Y_(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&U4(c,u)}}finally{vs(-1),Y_(o)}}function U4(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function $4(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(TV(e,o.selectors,!1))if(r||(r=[]),_i(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;s0(t,e,c)}else r.unshift(o),s0(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function s0(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function H4(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new $(-301,!1);r.push(e[i],s)}}}function q4(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;_i(e)&&(n[""]=t)}}function G4(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function z4(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=zo(i.type,!0)),o=new xs(s,_i(i),re);t.blueprint[r]=o,n[r]=o,L4(t,e,r,gS(t,n,i.hostVars,bs),i)}function W4(t,e,n){let r=Sn(e,t),i=xS(n),s=t[qn].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=pf(t,hf(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function K4(t,e,n,r,i,s){let o=Sn(t,e);Q4(e[Xe],o,s,t.value,n,r,i)}function Q4(t,e,n,r,i,s,o){if(s==null)t.removeAttribute(e,i,n);else{let a=o==null?Jh(s):o(s,r||"",i);t.setAttribute(e,i,a,n)}}function Y4(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],u=o[a++],l=o[a++],d=o[a++];pS(r,n,c,u,l,d)}}function Z4(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],n[i+1]);break}}i+=2}return r}function CS(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function bS(t,e){let n=t.contentQueries;if(n!==null){let r=we(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];RT(s),a.contentQueries(2,e[o],o)}}}finally{we(r)}}}function pf(t,e){return t[Zc]?t[gD][$n]=e:t[Zc]=e,t[gD]=e,e}function o0(t,e,n){RT(0);let r=we(null);try{e(t,n)}finally{we(r)}}function X4(t){return t[Yc]||(t[Yc]=[])}function J4(t){return t.cleanup||(t.cleanup=[])}function DS(t,e){let n=t[Yo],r=n?n.get(hr,null):null;r&&r.handleError(e)}function ry(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],c=n[s++],u=e[o],l=t.data[o];pS(l,u,r,a,c,i)}}function e3(t,e,n){let r=CT(e,t);c4(t[Xe],r,n)}function t3(t,e){let n=xi(e,t),r=n[pe];n3(r,n);let i=n[$r];i!==null&&n[Ph]===null&&(n[Ph]=Q0(i,n[Yo])),iy(r,n,n[Hn])}function n3(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function iy(t,e,n){j0(e);try{let r=t.viewQuery;r!==null&&o0(1,r,n);let i=t.template;i!==null&&mS(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[Zo]?.finishViewCreation(t),t.staticContentQueries&&bS(t,e),t.staticViewQueries&&o0(2,t.viewQuery,n);let s=t.components;s!==null&&r3(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[G]&=-5,B0()}}function r3(t,e){for(let n=0;n<e.length;n++)t3(t,e[n])}function i3(t,e,n,r){let i=we(null);try{let s=e.tView,a=t[G]&4096?4096:16,c=hf(t,s,n,a,null,e,null,null,null,r?.injector??null,r?.dehydratedView??null),u=t[e.index];c[nf]=u;let l=t[Zo];return l!==null&&(c[Zo]=l.createEmbeddedView(s)),iy(s,c,n),c}finally{we(i)}}function SD(t,e){return!e||e.firstChild===null||YT(t)}function s3(t,e,n,r=!0){let i=e[pe];if(h4(i,e,t,n),r){let o=i0(n,t),a=e[Xe],c=X0(a,t[ys]);c!==null&&l4(i,t[Gn],a,e,c,o)}let s=e[Ph];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function $h(t,e,n,r,i=!1){for(;n!==null;){let s=e[n.index];s!==null&&r.push(dr(s)),Hr(s)&&o3(s,r);let o=n.type;if(o&8)$h(t,e,n.child,r);else if(o&32){let a=Z0(n,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=uS(e,n);if(Array.isArray(a))r.push(...a);else{let c=Jc(e[lr]);$h(c[pe],c,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function o3(t,e){for(let n=Dn;n<t.length;n++){let r=t[n],i=r[pe].firstChild;i!==null&&$h(r[pe],r,i,e)}t[ys]!==t[$r]&&e.push(t[ys])}var TS=[];function a3(t){return t[_s]??c3(t)}function c3(t){let e=TS.pop()??Object.create(l3);return e.lView=t,e}function u3(t){t.lView[_s]!==t&&(t.lView=null,TS.push(t))}var l3=ue(A({},kb),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{Xc(t.lView)},consumerOnSignalRead(){this.lView[_s]=this}});function SS(t){return MS(t[Zc])}function AS(t){return MS(t[$n])}function MS(t){for(;t!==null&&!Hr(t);)t=t[$n];return t}var RS=100;function NS(t,e=!0,n=0){let r=t[qn],i=r.rendererFactory,s=!1;s||i.begin?.();try{d3(t,n)}catch(o){throw e&&DS(t,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function d3(t,e){a0(t,e);let n=0;for(;L0(t);){if(n===RS)throw new $(103,!1);n++,a0(t,1)}}function h3(t,e,n,r){let i=e[G];if((i&256)===256)return;let s=!1;!s&&e[qn].inlineEffectRunner?.flush(),j0(e);let o=null,a=null;!s&&f3(t)&&(a=a3(e),o=Ob(a));try{DT(e),mL(t.bindingStartIndex),n!==null&&mS(t,e,n,2,r);let c=(i&3)===3;if(!s)if(c){let d=t.preOrderCheckHooks;d!==null&&bh(e,d,null)}else{let d=t.preOrderHooks;d!==null&&Dh(e,d,0,null),M_(e,0)}if(p3(e),PS(e,0),t.contentQueries!==null&&bS(t,e),!s)if(c){let d=t.contentCheckHooks;d!==null&&bh(e,d)}else{let d=t.contentHooks;d!==null&&Dh(e,d,1),M_(e,1)}S4(t,e);let u=t.components;u!==null&&OS(e,u,0);let l=t.viewQuery;if(l!==null&&o0(2,l,r),!s)if(c){let d=t.viewCheckHooks;d!==null&&bh(e,d)}else{let d=t.viewHooks;d!==null&&Dh(e,d,2),M_(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[A_]){for(let d of e[A_])d();e[A_]=null}s||(e[G]&=-73)}catch(c){throw Xc(e),c}finally{a!==null&&(Fb(a,o),u3(a)),B0()}}function f3(t){return t.type!==2}function PS(t,e){for(let n=SS(t);n!==null;n=AS(n))for(let r=Dn;r<n.length;r++){let i=n[r];kS(i,e)}}function p3(t){for(let e=SS(t);e!==null;e=AS(e)){if(!(e[G]&O0.HasTransplantedViews))continue;let n=e[Oh];for(let r=0;r<n.length;r++){let i=n[r],s=i[At];sL(i)}}}function g3(t,e,n){let r=xi(e,t);kS(r,n)}function kS(t,e){V0(t)&&a0(t,e)}function a0(t,e){let r=t[pe],i=t[G],s=t[_s],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&s_(s)),s&&(s.dirty=!1),t[G]&=-9217,o)h3(r,t,r.template,t[Hn]);else if(i&8192){PS(t,1);let a=r.components;a!==null&&OS(t,a,1)}}function OS(t,e,n){for(let r=0;r<e.length;r++)g3(t,e[r],n)}function sy(t){for(t[qn].changeDetectionScheduler?.notify();t;){t[G]|=64;let e=Jc(t);if(YV(t)&&!e)return t;t=e}return null}var Es=class{get rootNodes(){let e=this._lView,n=e[pe];return $h(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Hn]}set context(e){this._lView[Hn]=e}get destroyed(){return(this._lView[G]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[At];if(Hr(e)){let n=e[kh],r=n?n.indexOf(this):-1;r>-1&&(r0(e,r),Rh(n,r))}this._attachedToViewContainer=!1}aS(this._lView[pe],this._lView)}onDestroy(e){TT(this._lView,e)}markForCheck(){sy(this._cdRefInjectingView||this._lView)}detach(){this._lView[G]&=-129}reattach(){Q_(this._lView),this._lView[G]|=128}detectChanges(){this._lView[G]|=1024,NS(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new $(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,sS(this._lView[pe],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new $(902,!1);this._appRef=e,Q_(this._lView)}},gf=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=y3;let t=e;return t})(),m3=gf,_3=class extends m3{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=i3(this._declarationLView,this._declarationTContainer,e,{injector:n,dehydratedView:r});return new Es(i)}};function y3(){return v3(nn(),Me())}function v3(t,e){return t.type&4?new _3(e,t,cf(t,e)):null}var HX=new RegExp(`^(\\d+)*(${zL}|${GL})*(.*)`);var x3=()=>null;function AD(t,e){return x3(t,e)}var Hh=class{},c0=class{},qh=class{};function w3(t){let e=Error(`No component factory found for ${jt(t)}.`);return e[E3]=t,e}var E3="ngComponent";var u0=class{resolveComponentFactory(e){throw w3(e)}},mf=(()=>{let e=class e{};e.NULL=new u0;let t=e;return t})(),eu=class{},qr=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>I3();let t=e;return t})();function I3(){let t=Me(),e=nn(),n=xi(e.index,t);return(gs(n)?n:t)[Xe]}var C3=(()=>{let e=class e{};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),O_={};var MD=new Set;function oy(t){MD.has(t)||(MD.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function RD(...t){}function b3(){let t=typeof Lt.requestAnimationFrame=="function",e=Lt[t?"requestAnimationFrame":"setTimeout"],n=Lt[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var de=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ut(!1),this.onMicrotaskEmpty=new ut(!1),this.onStable=new ut(!1),this.onError=new ut(!1),typeof Zone>"u")throw new $(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=b3().nativeRequestAnimationFrame,S3(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new $(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new $(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,D3,RD,RD);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},D3={};function ay(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function T3(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Lt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,l0(t),t.isCheckStableRunning=!0,ay(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),l0(t))}function S3(t){let e=()=>{T3(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(A3(a))return n.invokeTask(i,s,o,a);try{return ND(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),PD(t)}},onInvoke:(n,r,i,s,o,a,c)=>{try{return ND(t),n.invoke(i,s,o,a,c)}finally{t.shouldCoalesceRunChangeDetection&&e(),PD(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,l0(t),ay(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function l0(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function ND(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function PD(t){t._nesting--,ay(t)}var d0=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ut,this.onMicrotaskEmpty=new ut,this.onStable=new ut,this.onError=new ut}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}};function A3(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}function M3(t="zone.js",e){return t==="noop"?new d0:t==="zone.js"?new de(e):t}var Ho=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(Ho||{}),R3={destroy(){}};function cy(t,e){!e&&WV(cy);let n=e?.injector??P(zn);if(!s4(n))return R3;oy("NgAfterNextRender");let r=n.get(uy),i=r.handler??=new f0,s=e?.phase??Ho.MixedReadWrite,o=()=>{i.unregister(c),a()},a=n.get(z0).onDestroy(o),c=Ur(n,()=>new h0(s,()=>{o(),t()}));return i.register(c),{destroy:o}}var h0=class{constructor(e,n){this.phase=e,this.callbackFn=n,this.zone=P(de),this.errorHandler=P(hr,{optional:!0}),P(Hh,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},f0=class{constructor(){this.executingCallbacks=!1,this.buckets={[Ho.EarlyRead]:new Set,[Ho.Write]:new Set,[Ho.MixedReadWrite]:new Set,[Ho.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let n of e)n.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},uy=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function p0(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=sD(i,a);else if(s==2){let c=a,u=e[++o];r=sD(r,c+": "+u+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var Gh=class extends mf{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=gi(e);return new Jo(n,this.ngModule)}};function kD(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let r=t[n];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:n})}return e}function N3(t){let e=t.toLowerCase();return e==="svg"?eL:e==="math"?tL:null}var g0=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=ef(r);let i=this.injector.get(e,O_,r);return i!==O_||n===O_?i:this.parentInjector.get(e,n,r)}},Jo=class extends qh{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=kD(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return kD(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=RV(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){let s=we(null);try{i=i||this.ngModule;let o=i instanceof un?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new g0(e,o):e,c=a.get(eu,null);if(c===null)throw new $(407,!1);let u=a.get(C3,null),l=a.get(uy,null),d=a.get(Hh,null),h={rendererFactory:c,sanitizer:u,inlineEffectRunner:null,afterRenderEventManager:l,changeDetectionScheduler:d},f=c.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",m=r?R4(f,r,this.componentDef.encapsulation,a):iS(f,p,N3(p)),v=512;this.componentDef.signals?v|=4096:this.componentDef.onPush||(v|=16);let C=null;m!==null&&(C=Q0(m,a,!0));let F=ty(0,null,null,1,0,null,null,null,null,null,null),T=hf(null,F,null,v,null,null,h,f,a,null,C);j0(T);let H,z;try{let Y=this.componentDef,be,Xt=null;Y.findHostDirectiveDefs?(be=[],Xt=new Map,Y.findHostDirectiveDefs(Y,be,Xt),be.push(Y)):be=[Y];let Ym=P3(T,m),Vd=k3(Ym,m,Y,be,T,h,f);z=bT(F,mi),m&&V3(f,Y,m,r),n!==void 0&&L3(z,this.ngContentSelectors,n),H=F3(Vd,Y,be,Xt,T,[j3]),iy(F,T,null)}finally{B0()}return new m0(this.componentType,H,cf(z,T),T,z)}finally{we(s)}}},m0=class extends c0{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new Es(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;ry(s[pe],s,i,e,n),this.previousInputValues.set(e,n);let o=xi(this._tNode.index,s);sy(o)}}get injector(){return new ms(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function P3(t,e){let n=t[pe],r=mi;return t[r]=e,ff(n,r,2,"#host",null)}function k3(t,e,n,r,i,s,o){let a=i[pe];O3(r,t,e,o);let c=null;e!==null&&(c=Q0(e,i[Yo]));let u=s.rendererFactory.createRenderer(e,n),l=16;n.signals?l=4096:n.onPush&&(l=64);let d=hf(i,xS(n),null,l,i[t.index],t,s,u,null,null,c);return a.firstCreatePass&&s0(a,t,r.length-1),pf(i,d),i[t.index]=d}function O3(t,e,n,r){for(let i of t)e.mergedAttrs=Kc(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(p0(e,e.mergedAttrs,!0),n!==null&&dS(r,n,e))}function F3(t,e,n,r,i,s){let o=nn(),a=i[pe],c=Sn(o,i);ES(a,i,o,n,null,r);for(let l=0;l<n.length;l++){let d=o.directiveStart+l,h=Xo(i,a,d,o);ws(h,i)}IS(a,i,o),c&&ws(c,i);let u=Xo(i,a,o.directiveStart+o.componentOffset,o);if(t[Hn]=i[Hn]=u,s!==null)for(let l of s)l(u,e);return _S(a,o,i),u}function V3(t,e,n,r){if(r)q_(t,n,["ng-version","17.3.0"]);else{let{attrs:i,classes:s}=NV(e.selectors[0]);i&&q_(t,n,i),s&&s.length>0&&lS(t,n,s.join(" "))}}function L3(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function j3(){let t=nn();H0(Me()[pe],t)}var ia=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=B3;let t=e;return t})();function B3(){let t=nn();return $3(t,Me())}var U3=ia,FS=class extends U3{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return cf(this._hostTNode,this._hostLView)}get injector(){return new ms(this._hostTNode,this._hostLView)}get parentInjector(){let e=q0(this._hostTNode,this._hostLView);if(jT(e)){let n=Lh(e,this._hostLView),r=Vh(e),i=n[pe].data[r+8];return new ms(i,n)}else return new ms(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=OD(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-Dn}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=AD(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,SD(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!QV(e),a;if(o)a=n;else{let p=n||{};a=p.index,r=p.injector,i=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let c=o?e:new Jo(gi(e)),u=r||this.parentInjector;if(!s&&c.ngModule==null){let m=(o?u:this.parentInjector).get(un,null);m&&(s=m)}let l=gi(c.componentType??{}),d=AD(this._lContainer,l?.id??null),h=d?.firstChild??null,f=c.create(u,i,h,s);return this.insertImpl(f.hostView,a,SD(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(iL(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[At],u=new FS(c,c[Gn],c[At]);u.detach(u.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return s3(o,i,s,r),e.attachToViewContainerRef(),eT(F_(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=OD(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=r0(this._lContainer,n);r&&(Rh(F_(this._lContainer),n),aS(r[pe],r))}detach(e){let n=this._adjustIndex(e,-1),r=r0(this._lContainer,n);return r&&Rh(F_(this._lContainer),n)!=null?new Es(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function OD(t){return t[kh]}function F_(t){return t[kh]||(t[kh]=[])}function $3(t,e){let n,r=e[t.index];return Hr(r)?n=r:(n=CS(r,e,null,t),e[t.index]=n,pf(e,n)),q3(n,e,t,r),new FS(n,t,e)}function H3(t,e){let n=t[Xe],r=n.createComment(""),i=Sn(e,t),s=X0(n,i);return Uh(n,s,r,v4(n,i),!1),r}var q3=W3,G3=()=>!1;function z3(t,e,n){return G3(t,e,n)}function W3(t,e,n,r){if(t[ys])return;let i;n.type&8?i=dr(r):i=H3(e,n),t[ys]=i}function K3(t){return typeof t=="function"&&t[i_]!==void 0}function VS(t){return K3(t)&&typeof t.set=="function"}function Q3(t){let e=[],n=new Map;function r(i){let s=n.get(i);if(!s){let o=t(i);n.set(i,s=o.then(J3))}return s}return zh.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(u=>{i.template=u}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let u=i.styles.length,l=i.styleUrls;i.styleUrls.forEach((d,h)=>{a.push(""),o.push(r(d).then(f=>{a[u+h]=f,l.splice(l.indexOf(d),1),l.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(u=>{a.push(u),i.styleUrl=void 0}));let c=Promise.all(o).then(()=>e5(s));e.push(c)}),Z3(),Promise.all(e).then(()=>{})}var zh=new Map,Y3=new Set;function Z3(){let t=zh;return zh=new Map,t}function X3(){return zh.size===0}function J3(t){return typeof t=="string"?t:t.text()}function e5(t){Y3.delete(t)}function t5(t){return Object.getPrototypeOf(t.prototype).constructor}function Gr(t){let e=t5(t.type),n=!0,r=[t];for(;e;){let i;if(_i(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new $(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let o=t;o.inputs=wh(t.inputs),o.inputTransforms=wh(t.inputTransforms),o.declaredInputs=wh(t.declaredInputs),o.outputs=wh(t.outputs);let a=i.hostBindings;a&&o5(t,a);let c=i.viewQuery,u=i.contentQueries;if(c&&i5(t,c),u&&s5(t,u),n5(t,i),J2(t.outputs,i.outputs),_i(i)&&i.data.animation){let l=t.data;l.animation=(l.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(t),a===Gr&&(n=!1)}}e=Object.getPrototypeOf(e)}r5(r)}function n5(t,e){for(let n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;let r=e.inputs[n];if(r!==void 0&&(t.inputs[n]=r,t.declaredInputs[n]=e.declaredInputs[n],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;t.inputTransforms??={},t.inputTransforms[i]=e.inputTransforms[i]}}}function r5(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Kc(i.hostAttrs,n=Kc(n,i.hostAttrs))}}function wh(t){return t===Wo?{}:t===bn?[]:t}function i5(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function s5(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,s)=>{e(r,i,s),n(r,i,s)}:t.contentQueries=e}function o5(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}function ly(t){let e=t.inputConfig,n={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(n[r]=i[3])}t.inputTransforms=n}var yi=class{},tu=class{};var Wh=class extends yi{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Gh(this);let i=uT(e);this._bootstrapComponents=rS(i.bootstrap),this._r3Injector=KT(e,n,[{provide:yi,useValue:this},{provide:mf,useValue:this.componentFactoryResolver},...r],jt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Kh=class extends tu{constructor(e){super(),this.moduleType=e}create(e){return new Wh(this.moduleType,e,[])}};function a5(t,e,n){return new Wh(t,e,n)}var _0=class extends yi{constructor(e){super(),this.componentFactoryResolver=new Gh(this),this.instance=null;let n=new Qc([...e.providers,{provide:yi,useValue:this},{provide:mf,useValue:this.componentFactoryResolver}],e.parent||k0(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function _f(t,e,n=null){return new _0({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var yf=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Et(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function LS(t){return u5(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function c5(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{let n=t[Symbol.iterator](),r;for(;!(r=n.next()).done;)e(r.value)}}function u5(t){return t!==null&&(typeof t=="function"||typeof t=="object")}function au(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function l5(t){return(t.flags&32)===32}function d5(t,e,n,r,i,s,o,a,c){let u=e.consts,l=ff(e,t,4,o||null,Fh(u,a));wS(e,n,l,Fh(u,c)),H0(e,l);let d=l.tView=ty(2,l,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u,null);return e.queries!==null&&(e.queries.template(e,l),d.queries=e.queries.embeddedTView(l)),l}function Wn(t,e,n,r,i,s,o,a){let c=Me(),u=tn(),l=t+mi,d=u.firstCreatePass?d5(l,u,c,e,n,r,i,s,o):u.data[l];su(d,!1);let h=h5(u,c,d,t);U0()&&J0(u,c,h,d),ws(h,c);let f=CS(h,c,h,d);return c[l]=f,pf(c,f),z3(f,d,c),F0(d)&&yS(u,c,d),o!=null&&vS(c,d,a),Wn}var h5=f5;function f5(t,e,n,r){return $0(!0),e[Xe].createComment("")}function vf(t,e,n,r){let i=Me(),s=of();if(au(i,s,e)){let o=tn(),a=af();K4(a,i,t,e,n,r)}return vf}function jS(t,e,n,r){return au(t,of(),n)?e+Jh(n)+r:bs}function Eh(t,e){return t<<17|e<<2}function Is(t){return t>>17&32767}function p5(t){return(t&2)==2}function g5(t,e){return t&131071|e<<17}function y0(t){return t|2}function ea(t){return(t&131068)>>2}function V_(t,e){return t&-131069|e<<2}function m5(t){return(t&1)===1}function v0(t){return t|1}function _5(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=Is(o),c=ea(o);t[r]=n;let u=!1,l;if(Array.isArray(n)){let d=n;l=d[1],(l===null||iu(d,l)>0)&&(u=!0)}else l=n;if(i)if(c!==0){let h=Is(t[a+1]);t[r+1]=Eh(h,a),h!==0&&(t[h+1]=V_(t[h+1],r)),t[a+1]=g5(t[a+1],r)}else t[r+1]=Eh(a,0),a!==0&&(t[a+1]=V_(t[a+1],r)),a=r;else t[r+1]=Eh(c,0),a===0?a=r:t[c+1]=V_(t[c+1],r),c=r;u&&(t[r+1]=y0(t[r+1])),FD(t,l,r,!0),FD(t,l,r,!1),y5(e,l,t,r,s),o=Eh(a,c),s?e.classBindings=o:e.styleBindings=o}function y5(t,e,n,r,i){let s=i?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&iu(s,e)>=0&&(n[r+1]=v0(n[r+1]))}function FD(t,e,n,r){let i=t[n+1],s=e===null,o=r?Is(i):ea(i),a=!1;for(;o!==0&&(a===!1||s);){let c=t[o],u=t[o+1];v5(c,e)&&(a=!0,t[o+1]=r?v0(u):y0(u)),o=r?Is(u):ea(u)}a&&(t[n+1]=r?y0(i):v0(i))}function v5(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?iu(t,e)>=0:!1}function tt(t,e,n){let r=Me(),i=of();if(au(r,i,e)){let s=tn(),o=af();ny(s,o,r,t,e,r[Xe],n,!1)}return tt}function VD(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";ry(t,n,s[o],o,r)}function dy(t,e){return x5(t,e,null,!0),dy}function x5(t,e,n,r){let i=Me(),s=tn(),o=_L(2);if(s.firstUpdatePass&&E5(s,t,o,r),e!==bs&&au(i,o,e)){let a=s.data[ra()];T5(s,a,i,i[Xe],t,i[o+1]=S5(e,n),r,o)}}function w5(t,e){return e>=t.expandoStartIndex}function E5(t,e,n,r){let i=t.data;if(i[n+1]===null){let s=i[ra()],o=w5(t,n);A5(s,r)&&e===null&&!o&&(e=!1),e=I5(i,s,e,r),_5(i,s,e,n,o,r)}}function I5(t,e,n,r){let i=wL(t),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=L_(null,t,e,n,r),n=nu(n,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==i)if(n=L_(i,t,e,n,r),s===null){let c=C5(t,e,r);c!==void 0&&Array.isArray(c)&&(c=L_(null,t,e,c[1],r),c=nu(c,e.attrs,r),b5(t,e,r,c))}else s=D5(t,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),n}function C5(t,e,n){let r=n?e.classBindings:e.styleBindings;if(ea(r)!==0)return t[Is(r)]}function b5(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[Is(i)]=r}function D5(t,e,n){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=t[s].hostAttrs;r=nu(r,o,n)}return nu(r,e.attrs,n)}function L_(t,e,n,r,i){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],r=nu(r,s.hostAttrs,i),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function nu(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),vV(t,o,n?!0:e[++s]))}return t===void 0?null:t}function T5(t,e,n,r,i,s,o,a){if(!(e.type&3))return;let c=t.data,u=c[a+1],l=m5(u)?LD(c,e,n,i,ea(u),o):void 0;if(!Qh(l)){Qh(s)||p5(u)&&(s=LD(c,null,n,i,a,o));let d=CT(ra(),n);D4(r,o,d,i,s)}}function LD(t,e,n,r,i,s){let o=e===null,a;for(;i>0;){let c=t[i],u=Array.isArray(c),l=u?c[1]:c,d=l===null,h=n[i+1];h===bs&&(h=d?bn:void 0);let f=d?T_(h,r):l===r?h:void 0;if(u&&!Qh(f)&&(f=T_(c,r)),Qh(f)&&(a=f,o))return a;let p=t[i+1];i=o?Is(p):ea(p)}if(e!==null){let c=s?e.residualClasses:e.residualStyles;c!=null&&(a=T_(c,r))}return a}function Qh(t){return t!==void 0}function S5(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=jt(ou(t)))),t}function A5(t,e){return(t.flags&(e?8:16))!==0}function M5(t,e,n,r,i,s){let o=e.consts,a=Fh(o,i),c=ff(e,t,2,r,a);return wS(e,n,c,Fh(o,s)),c.attrs!==null&&p0(c,c.attrs,!1),c.mergedAttrs!==null&&p0(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function E(t,e,n,r){let i=Me(),s=tn(),o=mi+t,a=i[Xe],c=s.firstCreatePass?M5(o,s,i,e,n,r):s.data[o],u=R5(s,i,c,a,e,t);i[o]=u;let l=F0(c);return su(c,!0),dS(a,u,c),!l5(c)&&U0()&&J0(s,i,u,c),cL()===0&&ws(u,i),uL(),l&&(yS(s,i,c),_S(s,c,i)),r!==null&&vS(i,c),E}function b(){let t=nn();MT()?gL():(t=t.parent,su(t,!1));let e=t;hL(e)&&fL(),lL();let n=tn();return n.firstCreatePass&&(H0(n,t),vT(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&SL(e)&&VD(n,e,Me(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&AL(e)&&VD(n,e,Me(),e.stylesWithoutHost,!1),b}function Ei(t,e,n,r){return E(t,e,n,r),b(),Ei}var R5=(t,e,n,r,i,s)=>($0(!0),iS(r,i,CL()));function Ht(){return Me()}var Yh="en-US";var N5=Yh;function P5(t){typeof t=="string"&&(N5=t.toLowerCase().replace(/_/g,"-"))}function Fe(t,e,n,r){let i=Me(),s=tn(),o=nn();return BS(s,i,i[Xe],o,t,e,r),Fe}function k5(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[Yc],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function BS(t,e,n,r,i,s,o){let a=F0(r),u=t.firstCreatePass&&J4(t),l=e[Hn],d=X4(e),h=!0;if(r.type&3||o){let m=Sn(r,e),v=o?o(m):m,C=d.length,F=o?H=>o(dr(H[r.index])):r.index,T=null;if(!o&&a&&(T=k5(t,e,i,r.index)),T!==null){let H=T.__ngLastListenerFn__||T;H.__ngNextListenerFn__=s,T.__ngLastListenerFn__=s,h=!1}else{s=BD(r,e,l,s,!1);let H=n.listen(v,i,s);d.push(s,H),u&&u.push(i,F,C,C+1)}}else s=BD(r,e,l,s,!1);let f=r.outputs,p;if(h&&f!==null&&(p=f[i])){let m=p.length;if(m)for(let v=0;v<m;v+=2){let C=p[v],F=p[v+1],z=e[C][F].subscribe(s),Y=d.length;d.push(s,z),u&&u.push(i,r.index,Y,-(Y+1))}}}function jD(t,e,n,r){let i=we(null);try{return ar(6,e,n),n(r)!==!1}catch(s){return DS(t,s),!1}finally{ar(7,e,n),we(i)}}function BD(t,e,n,r,i){return function s(o){if(o===Function)return r;let a=t.componentOffset>-1?xi(t.index,e):e;sy(a);let c=jD(e,n,r,o),u=s.__ngNextListenerFn__;for(;u;)c=jD(e,n,u,o)&&c,u=u.__ngNextListenerFn__;return i&&c===!1&&o.preventDefault(),c}}function qt(t=1){return IL(t)}function Ds(t,e,n){return US(t,"",e,"",n),Ds}function US(t,e,n,r,i){let s=Me(),o=jS(s,e,n,r);if(o!==bs){let a=tn(),c=af();ny(a,c,s,t,o,s[Xe],i,!1)}return US}function S(t,e=""){let n=Me(),r=tn(),i=t+mi,s=r.firstCreatePass?ff(r,i,1,e,null):r.data[i],o=O5(r,n,s,e,t);n[i]=o,U0()&&J0(r,n,o,s),su(s,!1)}var O5=(t,e,n,r,i)=>($0(!0),a4(e[Xe],r));function bt(t){return cu("",t,""),bt}function cu(t,e,n){let r=Me(),i=jS(r,t,e,n);return i!==bs&&e3(r,ra(),i),cu}function rn(t,e,n){VS(e)&&(e=e());let r=Me(),i=of();if(au(r,i,e)){let s=tn(),o=af();ny(s,o,r,t,e,r[Xe],n,!1)}return rn}function ln(t,e){let n=VS(t);return n&&t.set(e),n}function sn(t,e){let n=Me(),r=tn(),i=nn();return BS(r,n,n[Xe],i,t,e),sn}function F5(t,e,n){let r=tn();if(r.firstCreatePass){let i=_i(t);x0(n,r.data,r.blueprint,i,!0),x0(e,r.data,r.blueprint,i,!1)}}function x0(t,e,n,r,i){if(t=Vt(t),Array.isArray(t))for(let s=0;s<t.length;s++)x0(t[s],e,n,r,i);else{let s=tn(),o=Me(),a=nn(),c=Qo(t)?t:Vt(t.provide),u=gT(t),l=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(Qo(t)||!t.multi){let f=new xs(u,i,re),p=B_(c,e,i?l:l+h,d);p===-1?(X_(jh(a,o),s,c),j_(s,t,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(f),o.push(f)):(n[p]=f,o[p]=f)}else{let f=B_(c,e,l+h,d),p=B_(c,e,l,l+h),m=f>=0&&n[f],v=p>=0&&n[p];if(i&&!v||!i&&!m){X_(jh(a,o),s,c);let C=j5(i?L5:V5,n.length,i,r,u);!i&&v&&(n[p].providerFactory=C),j_(s,t,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(C),o.push(C)}else{let C=$S(n[i?p:f],u,!i&&r);j_(s,t,f>-1?f:p,C)}!i&&r&&v&&n[p].componentProviders++}}}function j_(t,e,n,r){let i=Qo(e),s=BV(e);if(i||s){let c=(s?Vt(e.useClass):e).prototype.ngOnDestroy;if(c){let u=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let l=u.indexOf(n);l===-1?u.push(n,[r,c]):u[l+1].push(r,c)}else u.push(n,c)}}}function $S(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function B_(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function V5(t,e,n,r){return w0(this.multi,[])}function L5(t,e,n,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=Xo(n,n[pe],this.providerFactory.index,r);s=a.slice(0,o),w0(i,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],w0(i,s);return s}function w0(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function j5(t,e,n,r,i){let s=new xs(t,n,re);return s.multi=[],s.index=e,s.componentProviders=0,$S(s,i,r&&!n),s}function sa(t,e=[]){return n=>{n.providersResolver=(r,i)=>F5(r,i?i(t):t,e)}}var B5=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=hT(!1,r.type),s=i.length>0?_f([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=V({token:e,providedIn:"environment",factory:()=>new e(w(un))});let t=e;return t})();function HS(t){oy("NgStandalone"),t.getStandaloneInjector=e=>e.get(B5).getOrCreateStandaloneInjector(t)}var Ih=null;function U5(t){Ih!==null&&(t.defaultEncapsulation!==Ih.defaultEncapsulation||t.preserveWhitespaces!==Ih.preserveWhitespaces)||(Ih=t)}var Br=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},qS=new Br("17.3.0"),xf=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();var hy=new O(""),uu=new O(""),wf=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,fy||($5(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{de.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(w(de),w(Ef),w(uu))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),Ef=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return fy?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();function $5(t){fy=t}var fy;function Ts(t){return!!t&&typeof t.then=="function"}function GS(t){return!!t&&typeof t.subscribe=="function"}var If=new O(""),zS=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=P(If,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(Ts(o))r.push(o);else if(GS(o)){let a=new Promise((c,u)=>{o.subscribe({complete:c,error:u})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),py=new O("");function H5(){Lb(()=>{throw new $(600,!1)})}function q5(t){return t.isBoundToModule}function G5(t,e,n){try{let r=n();return Ts(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}function WS(t,e){return Array.isArray(e)?e.reduce(WS,t):A(A({},t),e)}var oa=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=P(QT),this.afterRenderEffectManager=P(uy),this.externalTestViews=new Set,this.beforeRender=new Ue,this.afterTick=new Ue,this.componentTypes=[],this.components=[],this.isStable=P(yf).hasPendingTasks.pipe(j(r=>!r)),this._injector=P(un)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof qh;if(!this._injector.get(zS).done){let f=!s&&cT(r),p=!1;throw new $(405,p)}let a;s?a=r:a=this._injector.get(mf).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=q5(a)?void 0:this._injector.get(yi),u=i||a.selector,l=a.create(zn.NULL,[],u,c),d=l.location.nativeElement,h=l.injector.get(hy,null);return h?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),Sh(this.components,l),h?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new $(101,!1);let i=we(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,we(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===RS)throw new $(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:c}of this._views)z5(a,o,c)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>E0(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>E0(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;Sh(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(py,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>Sh(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new $(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Sh(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function z5(t,e,n){!e&&!E0(t)||W5(t,n,e)}function E0(t){return L0(t)}function W5(t,e,n){let r;n?(r=0,t[G]|=1024):t[G]&64?r=0:r=1,NS(t,e,r)}var I0=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},Cf=(()=>{let e=class e{compileModuleSync(r){return new Kh(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=uT(r),o=rS(s.declarations).reduce((a,c)=>{let u=gi(c);return u&&a.push(new Jo(u)),a},[]);return new I0(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),K5=new O("");function Q5(t,e,n){let r=new Kh(n);return Promise.resolve(r)}function UD(t){for(let e=t.length-1;e>=0;e--)if(t[e]!==void 0)return t[e]}var Y5=(()=>{let e=class e{constructor(){this.zone=P(de),this.applicationRef=P(oa)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Z5(t){return[{provide:de,useFactory:t},{provide:Ko,multi:!0,useFactory:()=>{let e=P(Y5,{optional:!0});return()=>e.initialize()}},{provide:Ko,multi:!0,useFactory:()=>{let e=P(ej);return()=>{e.initialize()}}},{provide:QT,useFactory:X5}]}function X5(){let t=P(de),e=P(hr);return n=>t.runOutsideAngular(()=>e.handleError(n))}function J5(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var ej=(()=>{let e=class e{constructor(){this.subscription=new Ge,this.initialized=!1,this.zone=P(de),this.pendingTasks=P(yf)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{de.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{de.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function tj(){return typeof $localize<"u"&&$localize.locale||Yh}var gy=new O("",{providedIn:"root",factory:()=>P(gy,ae.Optional|ae.SkipSelf)||tj()});var KS=new O(""),QS=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=M3(i?.ngZone,J5({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=a5(r.moduleType,this.injector,Z5(()=>s)),a=o.injector.get(hr,null);return s.runOutsideAngular(()=>{let c=s.onError.subscribe({next:u=>{a.handleError(u)}});o.onDestroy(()=>{Sh(this._modules,o),c.unsubscribe()})}),G5(a,s,()=>{let c=o.injector.get(zS);return c.runInitializers(),c.donePromise.then(()=>{let u=o.injector.get(gy,Yh);return P5(u||Yh),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=WS({},i);return Q5(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(oa);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new $(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new $(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(KS,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(w(zn))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),zc=null,YS=new O("");function nj(t){if(zc&&!zc.get(YS,!1))throw new $(400,!1);H5(),zc=t;let e=t.get(QS);return sj(t),e}function my(t,e,n=[]){let r=`Platform: ${e}`,i=new O(r);return(s=[])=>{let o=ZS();if(!o||o.injector.get(YS,!1)){let a=[...n,...s,{provide:i,useValue:!0}];t?t(a):nj(rj(a,r))}return ij(i)}}function rj(t=[],e){return zn.create({name:e,providers:[{provide:tf,useValue:"platform"},{provide:KS,useValue:new Set([()=>zc=null])},...t]})}function ij(t){let e=ZS();if(!e)throw new $(401,!1);return e}function ZS(){return zc?.get(QS)??null}function sj(t){t.get(W0,null)?.forEach(n=>n())}function _y(){return!1}var Ss=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=oj;let t=e;return t})();function oj(t){return aj(nn(),Me(),(t&16)===16)}function aj(t,e,n){if(sf(t)&&!n){let r=xi(t.index,e);return new Es(r,r)}else if(t.type&47){let r=e[lr];return new Es(r,e)}return null}var C0=class{constructor(){}supports(e){return LS(e)}create(e){return new b0(e)}},cj=(t,e)=>e,b0=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||cj}forEachItem(e){let n;for(n=this._itHead;n!==null;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,s=null;for(;n||r;){let o=!r||n&&n.currentIndex<$D(r,i,s)?n:r,a=$D(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(n=n._next,o.previousIndex==null)i++;else{s||(s=[]);let u=a-i,l=c-i;if(u!=l){for(let h=0;h<u;h++){let f=h<s.length?s[h]:s[h]=0,p=f+h;l<=p&&p<u&&(s[h]=f+1)}let d=o.previousIndex;s[d]=l-u}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)e(n)}diff(e){if(e==null&&(e=[]),!LS(e))throw new $(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,s,o,a),r=!0):(r&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)),n=n._next}else i=0,c5(e,a=>{o=this._trackByFn(i,a),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,a,o,i),r=!0):(r&&(n=this._verifyReinsertion(n,a,o,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,i)):e=this._addAfter(new D0(n,r),s,i)),e}_verifyReinsertion(e,n,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let n=e._next;this._addToRemovals(this._unlink(e)),e=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){let i=n===null?this._itHead:n._next;return e._next=i,e._prev=n,i===null?this._itTail=e:i._prev=e,n===null?this._itHead=e:n._next=e,this._linkedRecords===null&&(this._linkedRecords=new Zh),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let n=e._prev,r=e._next;return n===null?this._itHead=r:n._next=r,r===null?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Zh),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},D0=class{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},T0=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;r!==null;r=r._nextDup)if((n===null||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let n=e._prevDup,r=e._nextDup;return n===null?this._head=r:n._nextDup=r,r===null?this._tail=n:r._prevDup=n,this._head===null}},Zh=class{constructor(){this.map=new Map}put(e){let n=e.trackById,r=this.map.get(n);r||(r=new T0,this.map.set(n,r)),r.add(e)}get(e,n){let r=e,i=this.map.get(r);return i?i.get(e,n):null}remove(e){let n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function $D(t,e,n){let r=t.previousIndex;if(r===null)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}function HD(){return new yy([new C0])}var yy=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||HD()),deps:[[e,new M0,new ta]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new $(901,!1)}};e.\u0275prov=V({token:e,providedIn:"root",factory:HD});let t=e;return t})();var XS=my(null,"core",[]),JS=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(w(oa))},e.\u0275mod=et({type:e}),e.\u0275inj=Je({});let t=e;return t})();function As(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function eA(t){let e=gi(t);if(!e)return null;let n=new Jo(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var sA=null;function pr(){return sA}function oA(t){sA??=t}var bf=class{};var on=new O(""),Iy=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(uj),providedIn:"platform"});let t=e;return t})(),aA=new O(""),uj=(()=>{let e=class e extends Iy{constructor(){super(),this._doc=P(on),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return pr().getBaseHref(this._doc)}onPopState(r){let i=pr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=pr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>new e,providedIn:"platform"});let t=e;return t})();function Cy(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function tA(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function zr(t){return t&&t[0]!=="?"?"?"+t:t}var Wr=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(by),providedIn:"root"});let t=e;return t})(),cA=new O(""),by=(()=>{let e=class e extends Wr{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??P(on).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return Cy(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+zr(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+zr(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+zr(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(w(Iy),w(cA,8))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),uA=(()=>{let e=class e extends Wr{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=Cy(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+zr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+zr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(w(Iy),w(cA,8))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),aa=(()=>{let e=class e{constructor(r){this._subject=new ut,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=hj(tA(nA(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+zr(i))}normalize(r){return e.stripTrailingSlash(dj(this._basePath,nA(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+zr(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+zr(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=zr,e.joinWithSlash=Cy,e.stripTrailingSlash=tA,e.\u0275fac=function(i){return new(i||e)(w(Wr))},e.\u0275prov=V({token:e,factory:()=>lj(),providedIn:"root"});let t=e;return t})();function lj(){return new aa(w(Wr))}function dj(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function nA(t){return t.replace(/\/index.html$/,"")}function hj(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function lA(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var vy=class{constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},ca=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new vy(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let c=i.get(o);i.move(c,a),rA(c,s)}});for(let s=0,o=i.length;s<o;s++){let c=i.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);rA(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(re(ia),re(gf),re(yy))},e.\u0275dir=Ct({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let t=e;return t})();function rA(t,e){t.context.$implicit=e.item}var Tf=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new xy,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){iA("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){iA("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(re(ia),re(gf))},e.\u0275dir=Ct({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let t=e;return t})(),xy=class{constructor(){this.$implicit=null,this.ngIf=null}};function iA(t,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${t} must be a TemplateRef, but received '${jt(e)}'.`)}var dA=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=et({type:e}),e.\u0275inj=Je({});let t=e;return t})(),Dy="browser",fj="server";function pj(t){return t===Dy}function Ms(t){return t===fj}var hA=(()=>{let e=class e{};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>pj(P(Mt))?new wy(P(on),window):new Ey});let t=e;return t})(),wy=class{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let n=gj(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function gj(t,e){let n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var Ey=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},Df=class{};var Ay=class extends bf{constructor(){super(...arguments),this.supportsDOMEvents=!0}},My=class t extends Ay{static makeCurrent(){oA(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=_j();return n==null?null:yj(n)}resetBaseElement(){lu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return lA(document.cookie,e)}},lu=null;function _j(){return lu=lu||document.querySelector("base"),lu?lu.getAttribute("href"):null}function yj(t){return new URL(t,document.baseURI).pathname}var Ry=class{addToWindow(e){Lt.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new $(5103,!1);return s},Lt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Lt.getAllAngularRootElements=()=>e.getAllRootElements();let n=r=>{let i=Lt.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};Lt.frameworkStabilizers||(Lt.frameworkStabilizers=[]),Lt.frameworkStabilizers.push(n)}findTestabilityInTree(e,n,r){if(n==null)return null;let i=e.getTestability(n);return i??(r?pr().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},vj=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),Ny=new O(""),mA=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new $(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(w(Ny),w(de))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),Af=class{constructor(e){this._doc=e}},Ty="ng-app-id",_A=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Ms(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${Ty}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(Ty),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(Ty,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(w(on),w(uf),w(K0,8),w(Mt))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),Sy={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},ky=/%COMP%/g,yA="%COMP%",xj=`_nghost-${yA}`,wj=`_ngcontent-${yA}`,Ej=!0,Ij=new O("",{providedIn:"root",factory:()=>Ej});function Cj(t){return wj.replace(ky,t)}function bj(t){return xj.replace(ky,t)}function vA(t,e){return e.map(n=>n.replace(ky,t))}var fA=(()=>{let e=class e{constructor(r,i,s,o,a,c,u,l=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=u,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=Ms(c),this.defaultRenderer=new du(r,a,u,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===ur.ShadowDom&&(i=ue(A({},i),{encapsulation:ur.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof Mf?s.applyToHost(r):s instanceof hu&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,c=this.ngZone,u=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case ur.Emulated:o=new Mf(u,l,i,this.appId,d,a,c,h);break;case ur.ShadowDom:return new Py(u,l,r,i,a,c,this.nonce,h);default:o=new hu(u,l,i,d,a,c,h);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(w(mA),w(_A),w(uf),w(Ij),w(on),w(Mt),w(de),w(K0))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),du=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(Sy[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(pA(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(pA(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new $(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=Sy[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=Sy[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(jr.DashCase|jr.Important)?e.style.setProperty(n,r,i&jr.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&jr.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=pr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function pA(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var Py=class extends du{constructor(e,n,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=vA(i.id,i.styles);for(let l of u){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=l,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},hu=class extends du{constructor(e,n,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=c?vA(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Mf=class extends hu{constructor(e,n,r,i,s,o,a,c){let u=i+"-"+r.id;super(e,n,r,s,o,a,c,u),this.contentAttr=Cj(u),this.hostAttr=bj(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},Dj=(()=>{let e=class e extends Af{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(w(on))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),gA=["alt","control","meta","shift"],Tj={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Sj={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},Aj=(()=>{let e=class e extends Af{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>pr().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),gA.forEach(l=>{let d=i.indexOf(l);d>-1&&(i.splice(d,1),a+=l+".")}),a+=o,i.length!=0||o.length===0)return null;let u={};return u.domEventName=s,u.fullKey=a,u}static matchEventFullKeyCode(r,i){let s=Tj[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),gA.forEach(a=>{if(a!==s){let c=Sj[a];c(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(w(on))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function Mj(){My.makeCurrent()}function Rj(){return new hr}function Nj(){return ZT(document),document}var Pj=[{provide:Mt,useValue:Dy},{provide:W0,useValue:Mj,multi:!0},{provide:on,useFactory:Nj,deps:[]}],xA=my(XS,"browser",Pj),kj=new O(""),Oj=[{provide:uu,useClass:Ry,deps:[]},{provide:hy,useClass:wf,deps:[de,Ef,uu]},{provide:wf,useClass:wf,deps:[de,Ef,uu]}],Fj=[{provide:tf,useValue:"root"},{provide:hr,useFactory:Rj,deps:[]},{provide:Ny,useClass:Dj,multi:!0,deps:[on,de,Mt]},{provide:Ny,useClass:Aj,multi:!0,deps:[on]},fA,_A,mA,{provide:eu,useExisting:fA},{provide:Df,useClass:vj,deps:[]},[]],wA=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:uf,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(w(kj,12))},e.\u0275mod=et({type:e}),e.\u0275inj=Je({providers:[...Fj,...Oj],imports:[dA,JS]});let t=e;return t})();var EA=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(w(on))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var ne="primary",Tu=Symbol("RouteTitle"),jy=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function fa(t){return new jy(t)}function Vj(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function Lj(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!gr(t[n],e[n]))return!1;return!0}function gr(t,e){let n=t?By(t):void 0,r=e?By(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!NA(t[i],e[i]))return!1;return!0}function By(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function NA(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function PA(t){return t.length>0?t[t.length-1]:null}function Ti(t){return v_(t)?t:Ts(t)?ye(Promise.resolve(t)):B(t)}var jj={exact:OA,subset:FA},kA={exact:Bj,subset:Uj,ignored:()=>!0};function CA(t,e,n){return jj[n.paths](t.root,e.root,n.matrixParams)&&kA[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function Bj(t,e){return gr(t,e)}function OA(t,e,n){if(!Ns(t.segments,e.segments)||!Pf(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!OA(t.children[r],e.children[r],n))return!1;return!0}function Uj(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>NA(t[n],e[n]))}function FA(t,e,n){return VA(t,e,e.segments,n)}function VA(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!Ns(i,n)||e.hasChildren()||!Pf(i,n,r))}else if(t.segments.length===n.length){if(!Ns(t.segments,n)||!Pf(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!FA(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!Ns(t.segments,i)||!Pf(t.segments,i,r)||!t.children[ne]?!1:VA(t.children[ne],e,s,r)}}function Pf(t,e,n){return e.every((r,i)=>kA[n](t[i].parameters,r.parameters))}var Ii=class{constructor(e=new Ee([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=fa(this.queryParams),this._queryParamMap}toString(){return qj.serialize(this)}},Ee=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return kf(this)}},Rs=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=fa(this.parameters),this._parameterMap}toString(){return jA(this)}};function $j(t,e){return Ns(t,e)&&t.every((n,r)=>gr(n.parameters,e[r].parameters))}function Ns(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function Hj(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===ne&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==ne&&(n=n.concat(e(i,r)))}),n}var Su=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>new vu,providedIn:"root"});let t=e;return t})(),vu=class{parse(e){let n=new $y(e);return new Ii(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${fu(e.root,!0)}`,r=Wj(e.queryParams),i=typeof e.fragment=="string"?`#${Gj(e.fragment)}`:"";return`${n}${r}${i}`}},qj=new vu;function kf(t){return t.segments.map(e=>jA(e)).join("/")}function fu(t,e){if(!t.hasChildren())return kf(t);if(e){let n=t.children[ne]?fu(t.children[ne],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==ne&&r.push(`${i}:${fu(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=Hj(t,(r,i)=>i===ne?[fu(t.children[ne],!1)]:[`${i}:${fu(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[ne]!=null?`${kf(t)}/${n[0]}`:`${kf(t)}/(${n.join("//")})`}}function LA(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Rf(t){return LA(t).replace(/%3B/gi,";")}function Gj(t){return encodeURI(t)}function Uy(t){return LA(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Of(t){return decodeURIComponent(t)}function bA(t){return Of(t.replace(/\+/g,"%20"))}function jA(t){return`${Uy(t.path)}${zj(t.parameters)}`}function zj(t){return Object.entries(t).map(([e,n])=>`;${Uy(e)}=${Uy(n)}`).join("")}function Wj(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${Rf(n)}=${Rf(i)}`).join("&"):`${Rf(n)}=${Rf(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var Kj=/^[^\/()?;#]+/;function Oy(t){let e=t.match(Kj);return e?e[0]:""}var Qj=/^[^\/()?;=#]+/;function Yj(t){let e=t.match(Qj);return e?e[0]:""}var Zj=/^[^=?&#]+/;function Xj(t){let e=t.match(Zj);return e?e[0]:""}var Jj=/^[^&#]+/;function e6(t){let e=t.match(Jj);return e?e[0]:""}var $y=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ee([],{}):new Ee([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[ne]=new Ee(e,n)),r}parseSegment(){let e=Oy(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new $(4009,!1);return this.capture(e),new Rs(Of(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=Yj(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=Oy(this.remaining);i&&(r=i,this.capture(r))}e[Of(n)]=Of(r)}parseQueryParam(e){let n=Xj(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=e6(this.remaining);o&&(r=o,this.capture(r))}let i=bA(n),s=bA(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Oy(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new $(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=ne);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[ne]:new Ee([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new $(4011,!1)}};function BA(t){return t.segments.length>0?new Ee([],{[ne]:t}):t}function UA(t){let e={};for(let[r,i]of Object.entries(t.children)){let s=UA(i);if(r===ne&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new Ee(t.segments,e);return t6(n)}function t6(t){if(t.numberOfChildren===1&&t.children[ne]){let e=t.children[ne];return new Ee(t.segments.concat(e.segments),e.children)}return t}function pa(t){return t instanceof Ii}function n6(t,e,n=null,r=null){let i=$A(t);return HA(i,e,n,r)}function $A(t){let e;function n(s){let o={};for(let c of s.children){let u=n(c);o[c.outlet]=u}let a=new Ee(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=BA(r);return e??i}function HA(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return Fy(i,i,i,n,r);let s=r6(e);if(s.toRoot())return Fy(i,i,new Ee([],{}),n,r);let o=i6(s,i,t),a=o.processChildren?mu(o.segmentGroup,o.index,s.commands):GA(o.segmentGroup,o.index,s.commands);return Fy(i,o.segmentGroup,a,n,r)}function Ff(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function xu(t){return typeof t=="object"&&t!=null&&t.outlets}function Fy(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([c,u])=>{s[c]=Array.isArray(u)?u.map(l=>`${l}`):`${u}`});let o;t===e?o=n:o=qA(t,e,n);let a=BA(UA(o));return new Ii(a,s,i)}function qA(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=qA(s,e,n)}),new Ee(t.segments,r)}var Vf=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&Ff(r[0]))throw new $(4003,!1);let i=r.find(xu);if(i&&i!==PA(r))throw new $(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function r6(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new Vf(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,u])=>{a[c]=typeof u=="string"?u.split("/"):u}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Vf(n,e,r)}var da=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function i6(t,e,n){if(t.isAbsolute)return new da(e,!0,0);if(!n)return new da(e,!1,NaN);if(n.parent===null)return new da(n,!0,0);let r=Ff(t.commands[0])?0:1,i=n.segments.length-1+r;return s6(n,i,t.numberOfDoubleDots)}function s6(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new $(4005,!1);i=r.segments.length}return new da(r,!1,i-s)}function o6(t){return xu(t[0])?t[0].outlets:{[ne]:t}}function GA(t,e,n){if(t??=new Ee([],{}),t.segments.length===0&&t.hasChildren())return mu(t,e,n);let r=a6(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new Ee(t.segments.slice(0,r.pathIndex),{});return s.children[ne]=new Ee(t.segments.slice(r.pathIndex),t.children),mu(s,0,i)}else return r.match&&i.length===0?new Ee(t.segments,{}):r.match&&!t.hasChildren()?Hy(t,e,n):r.match?mu(t,0,i):Hy(t,e,n)}function mu(t,e,n){if(n.length===0)return new Ee(t.segments,{});{let r=o6(n),i={};if(Object.keys(r).some(s=>s!==ne)&&t.children[ne]&&t.numberOfChildren===1&&t.children[ne].segments.length===0){let s=mu(t.children[ne],e,n);return new Ee(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=GA(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Ee(t.segments,i)}}function a6(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(xu(a))break;let c=`${a}`,u=r<n.length-1?n[r+1]:null;if(i>0&&c===void 0)break;if(c&&u&&typeof u=="object"&&u.outlets===void 0){if(!TA(c,u,o))return s;r+=2}else{if(!TA(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Hy(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(xu(s)){let c=c6(s.outlets);return new Ee(r,c)}if(i===0&&Ff(n[0])){let c=t.segments[e];r.push(new Rs(c.path,DA(n[0]))),i++;continue}let o=xu(s)?s.outlets[ne]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&Ff(a)?(r.push(new Rs(o,DA(a))),i+=2):(r.push(new Rs(o,{})),i++)}return new Ee(r,{})}function c6(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=Hy(new Ee([],{}),0,r))}),e}function DA(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function TA(t,e,n){return t==n.path&&gr(e,n.parameters)}var _u="imperative",ft=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(ft||{}),An=class{constructor(e,n){this.id=e,this.url=n}},ga=class extends An{constructor(e,n,r="imperative",i=null){super(e,n),this.type=ft.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},mr=class extends An{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=ft.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},hn=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(hn||{}),Lf=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(Lf||{}),Ci=class extends An{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=ft.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},bi=class extends An{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=ft.NavigationSkipped}},wu=class extends An{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=ft.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},jf=class extends An{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=ft.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},qy=class extends An{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=ft.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Gy=class extends An{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=ft.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},zy=class extends An{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=ft.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Wy=class extends An{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=ft.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ky=class{constructor(e){this.route=e,this.type=ft.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Qy=class{constructor(e){this.route=e,this.type=ft.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Yy=class{constructor(e){this.snapshot=e,this.type=ft.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Zy=class{constructor(e){this.snapshot=e,this.type=ft.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Xy=class{constructor(e){this.snapshot=e,this.type=ft.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Jy=class{constructor(e){this.snapshot=e,this.type=ft.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Bf=class{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=ft.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Eu=class{},Iu=class{constructor(e){this.url=e}};var ev=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Au,this.attachRef=null}},Au=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new ev,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Uf=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=tv(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=tv(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=nv(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return nv(e,this._root).map(n=>n.value)}};function tv(t,e){if(t===e.value)return e;for(let n of e.children){let r=tv(t,n);if(r)return r}return null}function nv(t,e){if(t===e.value)return[e];for(let n of e.children){let r=nv(t,n);if(r.length)return r.unshift(e),r}return[]}var dn=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function la(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var $f=class extends Uf{constructor(e,n){super(e),this.snapshot=n,hv(this,e)}toString(){return this.snapshot.toString()}};function zA(t){let e=u6(t),n=new Et([new Rs("",{})]),r=new Et({}),i=new Et({}),s=new Et({}),o=new Et(""),a=new Ps(n,r,s,o,i,ne,t,e.root);return a.snapshot=e.root,new $f(new dn(a,[]),e)}function u6(t){let e={},n={},r={},i="",s=new Cu([],e,r,i,n,ne,t,null,{});return new Hf("",new dn(s,[]))}var Ps=class{constructor(e,n,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(j(u=>u[Tu]))??B(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(j(e=>fa(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(j(e=>fa(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function dv(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:A(A({},e.params),t.params),data:A(A({},e.data),t.data),resolve:A(A(A(A({},t.data),e.data),i?.data),t._resolvedData)}:r={params:A({},t.params),data:A({},t.data),resolve:A(A({},t.data),t._resolvedData??{})},i&&KA(i)&&(r.resolve[Tu]=i.title),r}var Cu=class{get title(){return this.data?.[Tu]}constructor(e,n,r,i,s,o,a,c,u){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=fa(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=fa(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},Hf=class extends Uf{constructor(e,n){super(n),this.url=e,hv(this,n)}toString(){return WA(this._root)}};function hv(t,e){e.value._routerState=t,e.children.forEach(n=>hv(t,n))}function WA(t){let e=t.children.length>0?` { ${t.children.map(WA).join(", ")} } `:"";return`${t.value}${e}`}function Vy(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,gr(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),gr(e.params,n.params)||t.paramsSubject.next(n.params),Lj(e.url,n.url)||t.urlSubject.next(n.url),gr(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function rv(t,e){let n=gr(t.params,e.params)&&$j(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||rv(t.parent,e.parent))}function KA(t){return typeof t.title=="string"||t.title===null}var fv=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=ne,this.activateEvents=new ut,this.deactivateEvents=new ut,this.attachEvents=new ut,this.detachEvents=new ut,this.parentContexts=P(Au),this.location=P(ia),this.changeDetector=P(Ss),this.environmentInjector=P(un),this.inputBinder=P(Kf,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new $(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new $(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new $(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new $(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,u=new iv(r,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:u,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Ct({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Cs]});let t=e;return t})(),iv=class{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===Ps?this.route:e===Au?this.childContexts:this.parent.get(e,n)}},Kf=new O(""),SA=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=Bc([i.queryParams,i.params,i.data]).pipe(Oe(([o,a,c],u)=>(c=A(A(A({},o),a),c),u===0?B(c):Promise.resolve(c)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=eA(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function l6(t,e,n){let r=bu(t,e._root,n?n._root:void 0);return new $f(r,e)}function bu(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=d6(t,e,n);return new dn(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>bu(t,a)),o}}let r=h6(e.value),i=e.children.map(s=>bu(t,s));return new dn(r,i)}}function d6(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return bu(t,r,i);return bu(t,r)})}function h6(t){return new Ps(new Et(t.url),new Et(t.params),new Et(t.queryParams),new Et(t.fragment),new Et(t.data),t.outlet,t.component,t)}var QA="ngNavigationCancelingError";function YA(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=pa(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=ZA(!1,hn.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function ZA(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[QA]=!0,n.cancellationCode=e,n}function f6(t){return XA(t)&&pa(t.url)}function XA(t){return!!t&&t[QA]}var p6=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Tn({type:e,selectors:[["ng-component"]],standalone:!0,features:[HS],decls:1,vars:0,template:function(i,s){i&1&&Ei(0,"router-outlet")},dependencies:[fv],encapsulation:2});let t=e;return t})();function g6(t,e){return t.providers&&!t._injector&&(t._injector=_f(t.providers,e,`Route: ${t.path}`)),t._injector??e}function pv(t){let e=t.children&&t.children.map(pv),n=e?ue(A({},t),{children:e}):A({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==ne&&(n.component=p6),n}function _r(t){return t.outlet||ne}function m6(t,e){let n=t.filter(r=>_r(r)===e);return n.push(...t.filter(r=>_r(r)!==e)),n}function Mu(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var _6=(t,e,n,r)=>j(i=>(new sv(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),sv=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),Vy(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=la(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=la(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=la(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=la(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Jy(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Zy(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(Vy(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Vy(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=Mu(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},qf=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},ha=class{constructor(e,n){this.component=e,this.route=n}};function y6(t,e,n){let r=t._root,i=e?e._root:null;return pu(r,i,n,[r.value])}function v6(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function _a(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!WD(t)?t:e.get(t):r}function pu(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=la(e);return t.children.forEach(o=>{x6(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>yu(a,n.getContext(o),i)),i}function x6(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=w6(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new qf(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?pu(t,e,a?a.children:null,r,i):pu(t,e,n,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new ha(a.outlet.component,o))}else o&&yu(e,a,i),i.canActivateChecks.push(new qf(r)),s.component?pu(t,null,a?a.children:null,r,i):pu(t,null,n,r,i);return i}function w6(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!Ns(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Ns(t.url,e.url)||!gr(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!rv(t,e)||!gr(t.queryParams,e.queryParams);case"paramsChange":default:return!rv(t,e)}}function yu(t,e,n){let r=la(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?yu(o,e.children.getContext(s),n):yu(o,null,n):yu(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new ha(e.outlet.component,i)):n.canDeactivateChecks.push(new ha(null,i)):n.canDeactivateChecks.push(new ha(null,i))}function Ru(t){return typeof t=="function"}function E6(t){return typeof t=="boolean"}function I6(t){return t&&Ru(t.canLoad)}function C6(t){return t&&Ru(t.canActivate)}function b6(t){return t&&Ru(t.canActivateChild)}function D6(t){return t&&Ru(t.canDeactivate)}function T6(t){return t&&Ru(t.canMatch)}function JA(t){return t instanceof Vr||t?.name==="EmptyError"}var Nf=Symbol("INITIAL_VALUE");function ma(){return Oe(t=>Bc(t.map(e=>e.pipe(Lr(1),ps(Nf)))).pipe(j(e=>{for(let n of e)if(n!==!0){if(n===Nf)return Nf;if(n===!1||n instanceof Ii)return n}return!0}),It(e=>e!==Nf),Lr(1)))}function S6(t,e){return Ze(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?B(ue(A({},n),{guardsResult:!0})):A6(o,r,i,t).pipe(Ze(a=>a&&E6(a)?M6(r,s,t,e):B(a)),j(a=>ue(A({},n),{guardsResult:a})))})}function A6(t,e,n,r){return ye(t).pipe(Ze(i=>O6(i.component,i.route,n,e,r)),In(i=>i!==!0,!0))}function M6(t,e,n,r){return ye(e).pipe(fs(i=>Vo(N6(i.route.parent,r),R6(i.route,r),k6(t,i.path,n),P6(t,i.route,n))),In(i=>i!==!0,!0))}function R6(t,e){return t!==null&&e&&e(new Xy(t)),B(!0)}function N6(t,e){return t!==null&&e&&e(new Yy(t)),B(!0)}function P6(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return B(!0);let i=r.map(s=>gh(()=>{let o=Mu(e)??n,a=_a(s,o),c=C6(a)?a.canActivate(e,t):Ur(o,()=>a(e,t));return Ti(c).pipe(In())}));return B(i).pipe(ma())}function k6(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>v6(o)).filter(o=>o!==null).map(o=>gh(()=>{let a=o.guards.map(c=>{let u=Mu(o.node)??n,l=_a(c,u),d=b6(l)?l.canActivateChild(r,t):Ur(u,()=>l(r,t));return Ti(d).pipe(In())});return B(a).pipe(ma())}));return B(s).pipe(ma())}function O6(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return B(!0);let o=s.map(a=>{let c=Mu(e)??i,u=_a(a,c),l=D6(u)?u.canDeactivate(t,e,n,r):Ur(c,()=>u(t,e,n,r));return Ti(l).pipe(In())});return B(o).pipe(ma())}function F6(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return B(!0);let s=i.map(o=>{let a=_a(o,t),c=I6(a)?a.canLoad(e,n):Ur(t,()=>a(e,n));return Ti(c)});return B(s).pipe(ma(),e1(r))}function e1(t){return f_(ct(e=>{if(pa(e))throw YA(t,e)}),j(e=>e===!0))}function V6(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return B(!0);let s=i.map(o=>{let a=_a(o,t),c=T6(a)?a.canMatch(e,n):Ur(t,()=>a(e,n));return Ti(c)});return B(s).pipe(ma(),e1(r))}var Du=class{constructor(e){this.segmentGroup=e||null}},Gf=class extends Error{constructor(e){super(),this.urlTree=e}};function ua(t){return Fo(new Du(t))}function L6(t){return Fo(new $(4e3,!1))}function j6(t){return Fo(ZA(!1,hn.GuardRejected))}var ov=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return B(r);if(i.numberOfChildren>1||!i.children[ne])return L6(e.redirectTo);i=i.children[ne]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new Gf(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new Ii(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new Ee(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new $(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},av={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function B6(t,e,n,r,i){let s=gv(t,e,n);return s.matched?(r=g6(e,r),V6(r,e,n,i).pipe(j(o=>o===!0?s:A({},av)))):B(s)}function gv(t,e,n){if(e.path==="**")return U6(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?A({},av):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||Vj)(n,t,e);if(!i)return A({},av);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?A(A({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function U6(t){return{matched:!0,parameters:t.length>0?PA(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function AA(t,e,n,r){return n.length>0&&q6(t,n,r)?{segmentGroup:new Ee(e,H6(r,new Ee(n,t.children))),slicedSegments:[]}:n.length===0&&G6(t,n,r)?{segmentGroup:new Ee(t.segments,$6(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new Ee(t.segments,t.children),slicedSegments:n}}function $6(t,e,n,r){let i={};for(let s of n)if(Qf(t,e,s)&&!r[_r(s)]){let o=new Ee([],{});i[_r(s)]=o}return A(A({},r),i)}function H6(t,e){let n={};n[ne]=e;for(let r of t)if(r.path===""&&_r(r)!==ne){let i=new Ee([],{});n[_r(r)]=i}return n}function q6(t,e,n){return n.some(r=>Qf(t,e,r)&&_r(r)!==ne)}function G6(t,e,n){return n.some(r=>Qf(t,e,r))}function Qf(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function z6(t,e,n,r){return _r(t)!==r&&(r===ne||!Qf(e,n,t))?!1:gv(e,t,n).matched}function W6(t,e,n){return e.length===0&&!t.children[n]}var cv=class{};function K6(t,e,n,r,i,s,o="emptyOnly"){return new uv(t,e,n,r,i,o,s).recognize()}var Q6=31,uv=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new ov(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new $(4002,`'${e.segmentGroup}'`)}recognize(){let e=AA(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(j(n=>{let r=new Cu([],Object.freeze({}),Object.freeze(A({},this.urlTree.queryParams)),this.urlTree.fragment,{},ne,this.rootComponentType,null,{}),i=new dn(r,n),s=new Hf("",i),o=n6(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,ne).pipe(di(r=>{if(r instanceof Gf)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Du?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=dv(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(j(s=>s instanceof dn?[s]:[]))}processChildren(e,n,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return ye(i).pipe(fs(s=>{let o=r.children[s],a=m6(n,s);return this.processSegmentGroup(e,a,o,s)}),or((s,o)=>(s.push(...o),s)),hi(null),E_(),Ze(s=>{if(s===null)return ua(r);let o=t1(s);return Y6(o),B(o)}))}processSegment(e,n,r,i,s,o){return ye(n).pipe(fs(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(di(c=>{if(c instanceof Du)return B(null);throw c}))),In(a=>!!a),di(a=>{if(JA(a))return W6(r,i,s)?B(new cv):ua(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return z6(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):ua(i):ua(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:u,remainingSegments:l}=gv(n,i,s);if(!a)return ua(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Q6&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,u);return this.applyRedirects.lineralizeSegments(i,d).pipe(Ze(h=>this.processSegment(e,r,n,h.concat(l),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){let o=B6(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),o.pipe(Oe(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Oe(({routes:c})=>{let u=r._loadedInjector??e,{consumedSegments:l,remainingSegments:d,parameters:h}=a,f=new Cu(l,h,Object.freeze(A({},this.urlTree.queryParams)),this.urlTree.fragment,X6(r),_r(r),r.component??r._loadedComponent??null,r,J6(r)),{segmentGroup:p,slicedSegments:m}=AA(n,l,d,c);if(m.length===0&&p.hasChildren())return this.processChildren(u,c,p).pipe(j(C=>C===null?null:new dn(f,C)));if(c.length===0&&m.length===0)return B(new dn(f,[]));let v=_r(r)===s;return this.processSegment(u,c,p,m,v?ne:s,!0).pipe(j(C=>new dn(f,C instanceof dn?[C]:[])))}))):ua(n)))}getChildConfig(e,n,r){return n.children?B({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?B({routes:n._loadedRoutes,injector:n._loadedInjector}):F6(e,n,r,this.urlSerializer).pipe(Ze(i=>i?this.configLoader.loadChildren(e,n).pipe(ct(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):j6(n))):B({routes:[],injector:e})}};function Y6(t){t.sort((e,n)=>e.value.outlet===ne?-1:n.value.outlet===ne?1:e.value.outlet.localeCompare(n.value.outlet))}function Z6(t){let e=t.value.routeConfig;return e&&e.path===""}function t1(t){let e=[],n=new Set;for(let r of t){if(!Z6(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=t1(r.children);e.push(new dn(r.value,i))}return e.filter(r=>!n.has(r))}function X6(t){return t.data||{}}function J6(t){return t.resolve||{}}function eB(t,e,n,r,i,s){return Ze(o=>K6(t,e,n,r,o.extractedUrl,i,s).pipe(j(({state:a,tree:c})=>ue(A({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function tB(t,e){return Ze(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return B(n);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let u of n1(c))o.add(u);let a=0;return ye(o).pipe(fs(c=>s.has(c)?nB(c,r,t,e):(c.data=dv(c,c.parent,t).resolve,B(void 0))),ct(()=>a++),jo(1),Ze(c=>a===o.size?B(n):Ft))})}function n1(t){let e=t.children.map(n=>n1(n)).flat();return[t,...e]}function nB(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!KA(i)&&(s[Tu]=i.title),rB(s,t,e,r).pipe(j(o=>(t._resolvedData=o,t.data=dv(t,t.parent,n).resolve,null)))}function rB(t,e,n,r){let i=By(t);if(i.length===0)return B({});let s={};return ye(i).pipe(Ze(o=>iB(t[o],e,n,r).pipe(In(),ct(a=>{s[o]=a}))),jo(1),w_(s),di(o=>JA(o)?Ft:Fo(o)))}function iB(t,e,n,r){let i=Mu(e)??r,s=_a(t,i),o=s.resolve?s.resolve(e,n):Ur(i,()=>s(e,n));return Ti(o)}function Ly(t){return Oe(e=>{let n=t(e);return n?ye(n).pipe(j(()=>e)):B(e)})}var r1=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===ne);return i}getResolvedTitleForRoute(r){return r.data[Tu]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(sB),providedIn:"root"});let t=e;return t})(),sB=(()=>{let e=class e extends r1{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(w(EA))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Nu=new O("",{providedIn:"root",factory:()=>({})}),zf=new O(""),mv=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=P(Cf)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return B(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Ti(r.loadComponent()).pipe(j(i1),ct(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),$c(()=>{this.componentLoaders.delete(r)})),s=new Ro(i,()=>new Ue).pipe(Mo());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return B({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=oB(i,this.compiler,r,this.onLoadEndListener).pipe($c(()=>{this.childrenLoaders.delete(i)})),a=new Ro(o,()=>new Ue).pipe(Mo());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function oB(t,e,n,r){return Ti(t.loadChildren()).pipe(j(i1),Ze(i=>i instanceof tu||Array.isArray(i)?B(i):ye(e.compileModuleAsync(i))),j(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(zf,[],{optional:!0,self:!0}).flat()),{routes:o.map(pv),injector:s}}))}function aB(t){return t&&typeof t=="object"&&"default"in t}function i1(t){return aB(t)?t.default:t}var _v=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(cB),providedIn:"root"});let t=e;return t})(),cB=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),s1=new O(""),o1=new O("");function uB(t,e,n){let r=t.get(o1),i=t.get(on);return t.get(de).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,Promise.resolve();let s,o=new Promise(u=>{s=u}),a=i.startViewTransition(()=>(s(),lB(t))),{onViewTransitionCreated:c}=r;return c&&Ur(t,()=>c({transition:a,from:e,to:n})),o})}function lB(t){return new Promise(e=>{cy(e,{injector:t})})}var yv=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Ue,this.transitionAbortSubject=new Ue,this.configLoader=P(mv),this.environmentInjector=P(un),this.urlSerializer=P(Su),this.rootContexts=P(Au),this.location=P(aa),this.inputBindingEnabled=P(Kf,{optional:!0})!==null,this.titleStrategy=P(r1),this.options=P(Nu,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=P(_v),this.createViewTransition=P(s1,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>B(void 0),this.rootComponentType=null;let r=s=>this.events.next(new Ky(s)),i=s=>this.events.next(new Qy(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(ue(A(A({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new Et({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:_u,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(It(o=>o.id!==0),j(o=>ue(A({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Oe(o=>{let a=!1,c=!1;return B(o).pipe(Oe(u=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",hn.SupersededByNewNavigation),Ft;this.currentTransition=o,this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?ue(A({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let l=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=u.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!l&&d!=="reload"){let h="";return this.events.next(new bi(u.id,this.urlSerializer.serialize(u.rawUrl),h,Lf.IgnoredSameUrlNavigation)),u.resolve(null),Ft}if(this.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return B(u).pipe(Oe(h=>{let f=this.transitions?.getValue();return this.events.next(new ga(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?Ft:Promise.resolve(h)}),eB(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),ct(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=ue(A({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new jf(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){let{id:h,extractedUrl:f,source:p,restoredState:m,extras:v}=u,C=new ga(h,this.urlSerializer.serialize(f),p,m);this.events.next(C);let F=zA(this.rootComponentType).snapshot;return this.currentTransition=o=ue(A({},u),{targetSnapshot:F,urlAfterRedirects:f,extras:ue(A({},v),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,B(o)}else{let h="";return this.events.next(new bi(u.id,this.urlSerializer.serialize(u.extractedUrl),h,Lf.IgnoredByUrlHandlingStrategy)),u.resolve(null),Ft}}),ct(u=>{let l=new qy(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(l)}),j(u=>(this.currentTransition=o=ue(A({},u),{guards:y6(u.targetSnapshot,u.currentSnapshot,this.rootContexts)}),o)),S6(this.environmentInjector,u=>this.events.next(u)),ct(u=>{if(o.guardsResult=u.guardsResult,pa(u.guardsResult))throw YA(this.urlSerializer,u.guardsResult);let l=new Gy(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(l)}),It(u=>u.guardsResult?!0:(this.cancelNavigationTransition(u,"",hn.GuardRejected),!1)),Ly(u=>{if(u.guards.canActivateChecks.length)return B(u).pipe(ct(l=>{let d=new zy(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Oe(l=>{let d=!1;return B(l).pipe(tB(this.paramsInheritanceStrategy,this.environmentInjector),ct({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",hn.NoDataFromResolver)}}))}),ct(l=>{let d=new Wy(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),Ly(u=>{let l=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(ct(f=>{d.component=f}),j(()=>{})));for(let f of d.children)h.push(...l(f));return h};return Bc(l(u.targetSnapshot.root)).pipe(hi(null),Lr(1))}),Ly(()=>this.afterPreactivation()),Oe(()=>{let{currentSnapshot:u,targetSnapshot:l}=o,d=this.createViewTransition?.(this.environmentInjector,u.root,l.root);return d?ye(d).pipe(j(()=>o)):B(o)}),j(u=>{let l=l6(r.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=o=ue(A({},u),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,o}),ct(()=>{this.events.next(new Eu)}),_6(this.rootContexts,r.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),Lr(1),ct({next:u=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new mr(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),this.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{a=!0}}),b_(this.transitionAbortSubject.pipe(ct(u=>{throw u}))),$c(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",hn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),di(u=>{if(c=!0,XA(u))this.events.next(new Ci(o.id,this.urlSerializer.serialize(o.extractedUrl),u.message,u.cancellationCode)),f6(u)?this.events.next(new Iu(u.url)):o.resolve(!1);else{this.events.next(new wu(o.id,this.urlSerializer.serialize(o.extractedUrl),u,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(u))}catch(l){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(l)}}return Ft}))}))}cancelNavigationTransition(r,i,s){let o=new Ci(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function dB(t){return t!==_u}var hB=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(fB),providedIn:"root"});let t=e;return t})(),lv=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},fB=(()=>{let e=class e extends lv{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=wi(e)))(s||e)}})(),e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),a1=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(pB),providedIn:"root"});let t=e;return t})(),pB=(()=>{let e=class e extends a1{constructor(){super(...arguments),this.location=P(aa),this.urlSerializer=P(Su),this.options=P(Nu,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=P(_v),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Ii,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=zA(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof ga)this.stateMemento=this.createStateMemento();else if(r instanceof bi)this.rawUrlTree=i.initialUrl;else if(r instanceof jf){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof Eu?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof Ci&&(r.code===hn.GuardRejected||r.code===hn.NoDataFromResolver)?this.restoreHistory(i):r instanceof wu?this.restoreHistory(i,!0):r instanceof mr&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=A(A({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=A(A({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=wi(e)))(s||e)}})(),e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),gu=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(gu||{});function c1(t,e){t.events.pipe(It(n=>n instanceof mr||n instanceof Ci||n instanceof wu||n instanceof bi),j(n=>n instanceof mr||n instanceof bi?gu.COMPLETE:(n instanceof Ci?n.code===hn.Redirect||n.code===hn.SupersededByNewNavigation:!1)?gu.REDIRECTING:gu.FAILED),It(n=>n!==gu.REDIRECTING),Lr(1)).subscribe(()=>{e()})}function gB(t){throw t}var mB={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},_B={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Di=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=P(xf),this.stateManager=P(a1),this.options=P(Nu,{optional:!0})||{},this.pendingTasks=P(yf),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=P(yv),this.urlSerializer=P(Su),this.location=P(aa),this.urlHandlingStrategy=P(_v),this._events=new Ue,this.errorHandler=this.options.errorHandler||gB,this.navigated=!1,this.routeReuseStrategy=P(hB),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=P(zf,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!P(Kf,{optional:!0}),this.eventsSubscription=new Ge,this.isNgZoneEnabled=P(de)instanceof de&&de.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Ci&&i.code!==hn.Redirect&&i.code!==hn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof mr)this.navigated=!0;else if(i instanceof Iu){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||dB(s.source)};this.scheduleNavigation(a,_u,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}vB(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),_u,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let u=A({},s);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(o.state=u)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(pv),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:u}=i,l=u?this.currentUrlTree.fragment:a,d=null;switch(c){case"merge":d=A(A({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=s?s.snapshot:this.routerState.snapshot.root;h=$A(f)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),h=this.currentUrlTree.root}return HA(h,r,d,l??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=pa(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,_u,null,i)}navigate(r,i={skipLocationChange:!1}){return yB(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=A({},mB):i===!1?s=A({},_B):s=i,pa(r))return CA(this.currentUrlTree,r,s);let o=this.parseUrl(r);return CA(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,u,l;a?(c=a.resolve,u=a.reject,l=a.promise):l=new Promise((h,f)=>{c=h,u=f});let d=this.pendingTasks.add();return c1(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:c,reject:u,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(h=>Promise.reject(h))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function yB(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new $(4008,!1)}function vB(t){return!(t instanceof Eu)&&!(t instanceof Iu)}var u1=(()=>{let e=class e{constructor(r,i,s,o,a,c){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new Ue,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let u=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=u==="a"||u==="area",this.isAnchorElement?this.subscription=r.events.subscribe(l=>{l instanceof mr&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let u={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,u),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:eS(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(re(Di),re(Ps),G0("tabindex"),re(qr),re(fr),re(Wr))},e.\u0275dir=Ct({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&Fe("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&vf("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[Bt.HasDecoratorInputTransform,"preserveFragment","preserveFragment",As],skipLocationChange:[Bt.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",As],replaceUrl:[Bt.HasDecoratorInputTransform,"replaceUrl","replaceUrl",As],routerLink:"routerLink"},standalone:!0,features:[ly,Cs]});let t=e;return t})();var Wf=class{};var xB=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(It(r=>r instanceof mr),fs(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=_f(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return ye(s).pipe(li())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=B(null);let o=s.pipe(Ze(a=>a===null?B(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return ye([o,a]).pipe(li())}else return o})}};e.\u0275fac=function(i){return new(i||e)(w(Di),w(Cf),w(un),w(Wf),w(mv))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),l1=new O(""),wB=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof ga?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof mr?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof bi&&r.code===Lf.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Bf&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Bf(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){fS()},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function EB(t){return t.routerState.root}function Pu(t,e){return{\u0275kind:t,\u0275providers:e}}function IB(){let t=P(zn);return e=>{let n=t.get(oa);if(e!==n.components[0])return;let r=t.get(Di),i=t.get(d1);t.get(vv)===1&&r.initialNavigation(),t.get(h1,null,ae.Optional)?.setUpPreloading(),t.get(l1,null,ae.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var d1=new O("",{factory:()=>new Ue}),vv=new O("",{providedIn:"root",factory:()=>1});function CB(){return Pu(2,[{provide:vv,useValue:0},{provide:If,multi:!0,deps:[zn],useFactory:e=>{let n=e.get(aA,Promise.resolve());return()=>n.then(()=>new Promise(r=>{let i=e.get(Di),s=e.get(d1);c1(i,()=>{r(!0)}),e.get(yv).afterPreactivation=()=>(r(!0),s.closed?B(void 0):s),i.initialNavigation()}))}}])}function bB(){return Pu(3,[{provide:If,multi:!0,useFactory:()=>{let e=P(Di);return()=>{e.setUpLocationChangeListener()}}},{provide:vv,useValue:2}])}var h1=new O("");function DB(t){return Pu(0,[{provide:h1,useExisting:xB},{provide:Wf,useExisting:t}])}function TB(){return Pu(8,[SA,{provide:Kf,useExisting:SA}])}function SB(t){let e=[{provide:s1,useValue:uB},{provide:o1,useValue:A({skipNextTransition:!!t?.skipInitialTransition},t)}];return Pu(9,e)}var MA=new O("ROUTER_FORROOT_GUARD"),AB=[aa,{provide:Su,useClass:vu},Di,Au,{provide:Ps,useFactory:EB,deps:[Di]},mv,[]],xv=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[AB,[],{provide:zf,multi:!0,useValue:r},{provide:MA,useFactory:PB,deps:[[Di,new ta,new M0]]},{provide:Nu,useValue:i||{}},i?.useHash?RB():NB(),MB(),i?.preloadingStrategy?DB(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?kB(i):[],i?.bindToComponentInputs?TB().\u0275providers:[],i?.enableViewTransitions?SB().\u0275providers:[],OB()]}}static forChild(r){return{ngModule:e,providers:[{provide:zf,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(w(MA,8))},e.\u0275mod=et({type:e}),e.\u0275inj=Je({});let t=e;return t})();function MB(){return{provide:l1,useFactory:()=>{let t=P(hA),e=P(de),n=P(Nu),r=P(yv),i=P(Su);return n.scrollOffset&&t.setOffset(n.scrollOffset),new wB(i,r,t,e,n)}}}function RB(){return{provide:Wr,useClass:uA}}function NB(){return{provide:Wr,useClass:by}}function PB(t){return"guarded"}function kB(t){return[t.initialNavigation==="disabled"?bB().\u0275providers:[],t.initialNavigation==="enabledBlocking"?CB().\u0275providers:[]]}var RA=new O("");function OB(){return[{provide:RA,useFactory:IB},{provide:py,multi:!0,useExisting:RA}]}var wv=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Tn({type:e,selectors:[["app-home"]],decls:21,vars:0,consts:[[1,"page"],[2,"text-align","center"],[1,"row-reverse"],[1,"column"],[1,"colum"]],template:function(i,s){i&1&&(E(0,"div",0)(1,"h1",1),S(2,"Evaluaci\xF3n Tercer Parcial"),b(),Ei(3,"br")(4,"br")(5,"br"),E(6,"div",2)(7,"div",3)(8,"h3"),S(9,"Descripci\xF3n:"),b(),E(10,"p"),S(11,"Aplicaci\xF3n Web CRUD de clientes y coches hecha con Angular"),b()(),E(12,"div",4)(13,"h3"),S(14,"Integrantes:"),b(),E(15,"p"),S(16,"Diosdado Rodr\xEDguez Miguel \xC1ngel"),b(),E(17,"p"),S(18,"Hern\xE1ndez \xC1vila Fernanda Montserrat"),b(),E(19,"p"),S(20,"Pinz\xF3n Huerta Erick"),b()()()())}});let t=e;return t})();var ya=class{constructor(e){this.id="",this.marca="",this.modelo="",this.precio=0,this.kilometros=0,this.vendido=!1,this.transmision="",this.transacciones=[],this.due\u00F1oActual="",this.marca=e.marca,this.modelo=e.modelo,this.precio=e.precio,this.kilometros=e.kilometros,this.vendido=e.vendido,this.transmision=e.transmision,this.due\u00F1oActual=e.due\u00F1oActual}};var Kn=function(t){return t[t.create=0]="create",t[t.select=1]="select",t}(Kn||{});var ks=class{constructor(e){this.id="",this.fecha="",this.precio=0,this.metodoPago="",this.coche="",this.cliente="",this.tipo="",this.fecha=e.fecha,this.precio=e.precio,this.metodoPago=e.metodoPago,this.coche=e.coche,this.cliente=e.cliente,this.tipo=e.tipo}};var VB="firebase",LB="10.10.0";Ln(VB,LB,"app");var Os=new Br("ANGULARFIRE2_VERSION");var jB=(t,e)=>{let n=e?[e]:Nb(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Kr=class{constructor(){return jB(BB)}},BB="app-check";function Ev(){}var Yf=class{zone;delegate;constructor(e,n=__){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},Iv=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Ev,{},Ev,Ev)),n.pipe(ct({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},va=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new Yf(Zone.current)),this.insideAngular=n.run(()=>new Yf(Zone.current,hs)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(w(de))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function UB(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function ze(t){return $B(UB())(t)}function $B(t){return function(n){return n=n.lift(new Iv(t.ngZone)),n.pipe(Bn(t.outsideAngular),En(t.insideAngular))}}var HB=new Map,qB={activated:!1,tokenObservers:[]},GB={initialized:!1,enabled:!1};function Qn(t){return HB.get(t)||Object.assign({},qB)}function v1(){return GB}var zB="https://content-firebaseappcheck.googleapis.com/v1";var WB="exchangeDebugToken",f1={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},Eee=24*60*60*1e3;var Dv=class{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return g(this,null,function*(){this.stop();try{this.pending=new ht,this.pending.promise.catch(n=>{}),yield KB(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new ht,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function KB(t){return new Promise(e=>{setTimeout(e,t)})}var QB={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Si=new Db("appCheck","AppCheck",QB);function x1(t){if(!Qn(t).activated)throw Si.create("use-before-activation",{appName:t.name})}function w1(r,i){return g(this,arguments,function*({url:t,body:e},n){let s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let f=yield o.getHeartbeatsHeader();f&&(s["X-Firebase-Client"]=f)}let a={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(t,a)}catch(f){throw Si.create("fetch-network-error",{originalErrorMessage:f?.message})}if(c.status!==200)throw Si.create("fetch-status-error",{httpStatus:c.status});let u;try{u=yield c.json()}catch(f){throw Si.create("fetch-parse-error",{originalErrorMessage:f?.message})}let l=u.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw Si.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${u.ttl}`});let d=Number(l[1])*1e3,h=Date.now();return{token:u.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function E1(t,e){let{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${zB}/projects/${n}/apps/${r}:${WB}?key=${i}`,body:{debug_token:e}}}var YB="firebase-app-check-database",ZB=1,Tv="firebase-app-check-store";var Zf=null;function XB(){return Zf||(Zf=new Promise((t,e)=>{try{let n=indexedDB.open(YB,ZB);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var i;e(Si.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Tv,{keyPath:"compositeKey"})}}}catch(n){e(Si.create("storage-open",{originalErrorMessage:n?.message}))}}),Zf)}function JB(t,e){return eU(tU(t),e)}function eU(t,e){return g(this,null,function*(){let r=(yield XB()).transaction(Tv,"readwrite"),s=r.objectStore(Tv).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},r.onerror=c=>{var u;a(Si.create("storage-set",{originalErrorMessage:(u=c.target.error)===null||u===void 0?void 0:u.message}))}})})}function tU(t){return`${t.options.appId}-${t.name}`}var Sv=new ui("@firebase/app-check");function bv(t,e){return Ud()?JB(t,e).catch(n=>{Sv.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function I1(){return v1().enabled}function C1(){return g(this,null,function*(){let t=v1();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var nU={error:"UNKNOWN_ERROR"};function rU(t){return jd.encodeString(JSON.stringify(t),!1)}function Av(t,e=!1){return g(this,null,function*(){let n=t.app;x1(n);let r=Qn(n),i=r.token,s;if(i&&!ku(i)&&(r.token=void 0,i=void 0),!i){let c=yield r.cachedTokenPromise;c&&(ku(c)?i=c:yield bv(n,void 0))}if(!e&&i&&ku(i))return{token:i.token};let o=!1;if(I1()){r.exchangeTokenPromise||(r.exchangeTokenPromise=w1(E1(n,yield C1()),t.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let c=yield r.exchangeTokenPromise;return yield bv(n,c),r.token=c,{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield Qn(n).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?Sv.warn(c.message):Sv.error(c),s=c}let a;return i?s?ku(i)?a={token:i.token,internalError:s}:a=g1(s):(a={token:i.token},r.token=i,yield bv(n,i)):a=g1(s),o&&aU(n,a),a})}function iU(t){return g(this,null,function*(){let e=t.app;x1(e);let{provider:n}=Qn(e);if(I1()){let r=yield C1(),{token:i}=yield w1(E1(e,r),t.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield n.getToken();return{token:r}}})}function sU(t,e,n,r){let{app:i}=t,s=Qn(i),o={next:n,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&ku(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),p1(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>p1(t))}function b1(t,e){let n=Qn(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function p1(t){let{app:e}=t,n=Qn(e),r=n.tokenRefresher;r||(r=oU(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function oU(t){let{app:e}=t;return new Dv(()=>g(this,null,function*(){let n=Qn(e),r;if(n.token?r=yield Av(t,!0):r=yield Av(t),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=Qn(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,i=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},f1.RETRIAL_MIN_WAIT,f1.RETRIAL_MAX_WAIT)}function aU(t,e){let n=Qn(t).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function ku(t){return t.expireTimeMillis-Date.now()>0}function g1(t){return{token:rU(nU),error:t}}var Mv=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=Qn(this.app);for(let n of e)b1(this.app,n.next);return Promise.resolve()}};function cU(t,e){return new Mv(t,e)}function uU(t){return{getToken:e=>Av(t,e),getLimitedUseToken:()=>iU(t),addTokenListener:e=>sU(t,"INTERNAL",e),removeTokenListener:e=>b1(t.app,e)}}var lU="@firebase/app-check",dU="0.8.3";var hU="app-check",m1="app-check-internal";function fU(){as(new cn(hU,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return cU(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(m1).initialize()})),as(new cn(m1,t=>{let e=t.getProvider("app-check").getImmediate();return uU(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Ln(lU,dU)}fU();var pU=["localhost","0.0.0.0","127.0.0.1"],kee=typeof window<"u"&&pU.includes(window.location.hostname);var gU="firebase",mU="10.10.0";xt.registerVersion(gU,mU,"app-compat");var _U=["ngOnDestroy"],T1=(t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(_U.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let c=a?.[s];return typeof c=="function"?c.bind(a):c?.then?c.then(u=>n.run(()=>u)):n.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>o[c],apply:(a,c,u)=>o.then(l=>{let d=l?.(...u);return r?.spy?.apply&&r.spy.apply(s,u,d),d})})})});var Xf=class{constructor(e){return e}},Ai=new O("angularfire2.app.options"),Mi=new O("angularfire2.app.name");function Fs(t,e,n){let r=typeof n=="string"&&n||"[DEFAULT]",i=typeof n=="object"&&n||{};i.name=i.name||r;let o=xt.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>xt.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let a=!!module.hot;yU("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Xf(o)}var yU=(t,...e)=>{_y()&&typeof console<"u"&&console[t](...e)},vU={provide:Xf,useFactory:Fs,deps:[Ai,de,[new ta,Mi]]},S1=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:Ai,useValue:n},{provide:Mi,useValue:r}]}}constructor(n){xt.registerVersion("angularfire",Os.full,"core"),xt.registerVersion("angularfire",Os.full,"app-compat"),xt.registerVersion("angular",qS.full,n.toString())}static \u0275fac=function(r){return new(r||t)(w(Mt))};static \u0275mod=et({type:t});static \u0275inj=Je({providers:[vU]})}return t})();function xa(t,e,n,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return xU(i,o)||(D1("error",`${e} was already initialized on the ${n} Firebase App with different settings.${wU?" You may need to reload as Firebase is not HMR aware.":""}`),D1("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}function xU(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var wU=typeof module<"u"&&!!module.hot,D1=(t,...e)=>{_y()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var Ou=new O("angularfire2.auth.use-emulator"),Fu=new O("angularfire2.auth.settings"),Vu=new O("angularfire2.auth.tenant-id"),Lu=new O("angularfire2.auth.langugage-code"),ju=new O("angularfire2.auth.use-device-language"),Bu=new O("angularfire.auth.persistence"),Uu=(t,e,n,r,i,s,o,a)=>xa(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let c=e.runOutsideAngular(()=>t.auth());if(n&&c.useEmulator(...n),r&&(c.tenantId=r),c.languageCode=i,s&&c.useDeviceLanguage(),o)for(let[u,l]of Object.entries(o))c.settings[u]=l;return a&&c.setPersistence(a),c},[n,r,i,s,o,a]),Jf=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,c,u,l,d,h,f){let p=new Ue,m=B(void 0).pipe(En(o.outsideAngular),Oe(()=>s.runOutsideAngular(()=>import("./chunk-EA5I5XF3.js"))),j(()=>Fs(n,s,r)),j(v=>Uu(v,s,a,u,l,d,c,h)),_h({bufferSize:1,refCount:!1}));if(Ms(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=B(null);else{m.pipe(In()).subscribe();let v=m.pipe(Oe(T=>T.getRedirectResult().then(H=>H,()=>null)),ze,_h({bufferSize:1,refCount:!1})),C=m.pipe(Oe(T=>new ie(H=>({unsubscribe:s.runOutsideAngular(()=>T.onAuthStateChanged(z=>H.next(z),z=>H.error(z),()=>H.complete()))})))),F=m.pipe(Oe(T=>new ie(H=>({unsubscribe:s.runOutsideAngular(()=>T.onIdTokenChanged(z=>H.next(z),z=>H.error(z),()=>H.complete()))}))));this.authState=v.pipe(yh(C),Bn(o.outsideAngular),En(o.insideAngular)),this.user=v.pipe(yh(F),Bn(o.outsideAngular),En(o.insideAngular)),this.idToken=this.user.pipe(Oe(T=>T?ye(T.getIdToken()):B(null))),this.idTokenResult=this.user.pipe(Oe(T=>T?ye(T.getIdTokenResult()):B(null))),this.credential=Lo(v,p,this.authState.pipe(It(T=>!T))).pipe(j(T=>T?.user?T:null),Bn(o.outsideAngular),En(o.insideAngular))}return T1(this,m,s,{spy:{apply:(v,C,F)=>{(v.startsWith("signIn")||v.startsWith("createUser"))&&F.then(T=>p.next(T))}}})}static \u0275fac=function(r){return new(r||t)(w(Ai),w(Mi,8),w(Mt),w(de),w(va),w(Ou,8),w(Fu,8),w(Vu,8),w(Lu,8),w(ju,8),w(Bu,8),w(Kr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var EU=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Zn={},N,Jv=Jv||{},Q=EU||self;function fp(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function tl(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function IU(t){return Object.prototype.hasOwnProperty.call(t,Nv)&&t[Nv]||(t[Nv]=++CU)}var Nv="closure_uid_"+(1e9*Math.random()>>>0),CU=0;function bU(t,e,n){return t.call.apply(t.bind,arguments)}function DU(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Rt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Rt=bU:Rt=DU,Rt.apply(null,arguments)}function ep(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function gt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function Ri(){this.s=this.s,this.o=this.o}var TU=0;Ri.prototype.s=!1;Ri.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),TU!=0)&&IU(this)};Ri.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var $1=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function ex(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function M1(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(fp(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function Nt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Nt.prototype.h=function(){this.defaultPrevented=!0};var SU=function(){if(!Q.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};Q.addEventListener("test",n,e),Q.removeEventListener("test",n,e)}catch{}return t}();function Wu(t){return/^[\s\xa0]*$/.test(t)}function pp(){var t=Q.navigator;return t&&(t=t.userAgent)?t:""}function yr(t){return pp().indexOf(t)!=-1}function tx(t){return tx[" "](t),t}tx[" "]=function(){};function AU(t,e){var n=_9;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var MU=yr("Opera"),Ca=yr("Trident")||yr("MSIE"),H1=yr("Edge"),Vv=H1||Ca,q1=yr("Gecko")&&!(pp().toLowerCase().indexOf("webkit")!=-1&&!yr("Edge"))&&!(yr("Trident")||yr("MSIE"))&&!yr("Edge"),RU=pp().toLowerCase().indexOf("webkit")!=-1&&!yr("Edge");function G1(){var t=Q.document;return t?t.documentMode:void 0}var Lv;e:{if(tp="",np=function(){var t=pp();if(q1)return/rv:([^\);]+)(\)|;)/.exec(t);if(H1)return/Edge\/([\d\.]+)/.exec(t);if(Ca)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(RU)return/WebKit\/(\S+)/.exec(t);if(MU)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),np&&(tp=np?np[1]:""),Ca&&(rp=G1(),rp!=null&&rp>parseFloat(tp))){Lv=String(rp);break e}Lv=tp}var tp,np,rp,jv;Q.document&&Ca?(Pv=G1(),jv=Pv||parseInt(Lv,10)||void 0):jv=void 0;var Pv,NU=jv;function Ku(t,e){if(Nt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(q1){e:{try{tx(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:PU[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Ku.$.h.call(this)}}gt(Ku,Nt);var PU={2:"touch",3:"pen",4:"mouse"};Ku.prototype.h=function(){Ku.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var nl="closure_listenable_"+(1e6*Math.random()|0),kU=0;function OU(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++kU,this.fa=this.ia=!1}function gp(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function nx(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function FU(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function z1(t){let e={};for(let n in t)e[n]=t[n];return e}var R1="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function W1(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<R1.length;s++)n=R1[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function mp(t){this.src=t,this.g={},this.h=0}mp.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=Uv(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new OU(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function Bv(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=$1(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(gp(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Uv(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var rx="closure_lm_"+(1e6*Math.random()|0),kv={};function K1(t,e,n,r,i){if(r&&r.once)return Y1(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)K1(t,e[s],n,r,i);return null}return n=ox(n),t&&t[nl]?t.O(e,n,tl(r)?!!r.capture:!!r,i):Q1(t,e,n,!1,r,i)}function Q1(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=tl(i)?!!i.capture:!!i,a=sx(t);if(a||(t[rx]=a=new mp(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=VU(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)SU||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(X1(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function VU(){function t(n){return e.call(t.src,t.listener,n)}let e=LU;return t}function Y1(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)Y1(t,e[s],n,r,i);return null}return n=ox(n),t&&t[nl]?t.P(e,n,tl(r)?!!r.capture:!!r,i):Q1(t,e,n,!0,r,i)}function Z1(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)Z1(t,e[s],n,r,i);else r=tl(r)?!!r.capture:!!r,n=ox(n),t&&t[nl]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=Uv(s,n,r,i),-1<n&&(gp(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=sx(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Uv(e,n,r,i)),(n=-1<t?e[t]:null)&&ix(n))}function ix(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[nl])Bv(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(X1(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=sx(e))?(Bv(n,t),n.h==0&&(n.src=null,e[rx]=null)):gp(t)}}}function X1(t){return t in kv?kv[t]:kv[t]="on"+t}function LU(t,e){if(t.fa)t=!0;else{e=new Ku(e,this);var n=t.listener,r=t.la||t.src;t.ia&&ix(t),t=n.call(r,e)}return t}function sx(t){return t=t[rx],t instanceof mp?t:null}var Ov="__closure_events_fn_"+(1e9*Math.random()>>>0);function ox(t){return typeof t=="function"?t:(t[Ov]||(t[Ov]=function(e){return t.handleEvent(e)}),t[Ov])}function pt(){Ri.call(this),this.i=new mp(this),this.S=this,this.J=null}gt(pt,Ri);pt.prototype[nl]=!0;pt.prototype.removeEventListener=function(t,e,n,r){Z1(this,t,e,n,r)};function Tt(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new Nt(e,t);else if(e instanceof Nt)e.target=e.target||t;else{var i=e;e=new Nt(r,t),W1(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=ip(o,r,!0,e)&&i}if(o=e.g=t,i=ip(o,r,!0,e)&&i,i=ip(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=ip(o,r,!1,e)&&i}pt.prototype.N=function(){if(pt.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)gp(n[r]);delete t.g[e],t.h--}}this.J=null};pt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};pt.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function ip(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&Bv(t.i,o),i=a.call(c,r)!==!1&&i}}return i&&!r.defaultPrevented}var ax=Q.JSON.stringify,$v=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function jU(){var t=cx;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Hv=class{constructor(){this.h=this.g=null}add(e,n){let r=J1.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},J1=new $v(()=>new qv,t=>t.reset()),qv=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function BU(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function UU(t){Q.setTimeout(()=>{throw t},0)}var Qu,Yu=!1,cx=new Hv,eM=()=>{let t=Q.Promise.resolve(void 0);Qu=()=>{t.then($U)}},$U=()=>{for(var t;t=jU();){try{t.h.call(t.g)}catch(n){UU(n)}var e=J1;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Yu=!1};function _p(t,e){pt.call(this),this.h=t||1,this.g=e||Q,this.j=Rt(this.qb,this),this.l=Date.now()}gt(_p,pt);N=_p.prototype;N.ga=!1;N.T=null;N.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Tt(this,"tick"),this.ga&&(ux(this),this.start()))}};N.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function ux(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}N.N=function(){_p.$.N.call(this),ux(this),delete this.g};function lx(t,e,n){if(typeof t=="function")n&&(t=Rt(t,n));else if(t&&typeof t.handleEvent=="function")t=Rt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Q.setTimeout(t,e||0)}function tM(t){t.g=lx(()=>{t.g=null,t.i&&(t.i=!1,tM(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var Gv=class extends Ri{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:tM(this)}N(){super.N(),this.g&&(Q.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function Zu(t){Ri.call(this),this.h=t,this.g={}}gt(Zu,Ri);var N1=[];function nM(t,e,n,r){Array.isArray(n)||(n&&(N1[0]=n.toString()),n=N1);for(var i=0;i<n.length;i++){var s=K1(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function rM(t){nx(t.g,function(e,n){this.g.hasOwnProperty(n)&&ix(e)},t),t.g={}}Zu.prototype.N=function(){Zu.$.N.call(this),rM(this)};Zu.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function yp(){this.g=!0}yp.prototype.Ea=function(){this.g=!1};function HU(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var d=l.split("_");o=2<=d.length&&d[1]=="type"?o+(l+"="+u+"&"):o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function qU(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function Ea(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+zU(t,n)+(r?" "+r:"")})}function GU(t,e){t.info(function(){return"TIMEOUT: "+e})}yp.prototype.info=function(){};function zU(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return ax(n)}catch{return e}}var Bs={},P1=null;function vp(){return P1=P1||new pt}Bs.Ta="serverreachability";function iM(t){Nt.call(this,Bs.Ta,t)}gt(iM,Nt);function Xu(t){let e=vp();Tt(e,new iM(e))}Bs.STAT_EVENT="statevent";function sM(t,e){Nt.call(this,Bs.STAT_EVENT,t),this.stat=e}gt(sM,Nt);function Gt(t){let e=vp();Tt(e,new sM(e,t))}Bs.Ua="timingevent";function oM(t,e){Nt.call(this,Bs.Ua,t),this.size=e}gt(oM,Nt);function rl(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return Q.setTimeout(function(){t()},e)}var xp={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},aM={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function dx(){}dx.prototype.h=null;function k1(t){return t.h||(t.h=t.i())}function cM(){}var il={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function hx(){Nt.call(this,"d")}gt(hx,Nt);function fx(){Nt.call(this,"c")}gt(fx,Nt);var zv;function wp(){}gt(wp,dx);wp.prototype.g=function(){return new XMLHttpRequest};wp.prototype.i=function(){return{}};zv=new wp;function sl(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Zu(this),this.P=WU,t=Vv?125:void 0,this.V=new _p(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new uM}function uM(){this.i=null,this.g="",this.h=!1}var WU=45e3,lM={},Wv={};N=sl.prototype;N.setTimeout=function(t){this.P=t};function Kv(t,e,n){t.L=1,t.A=Ip(Yr(e)),t.u=n,t.S=!0,dM(t,null)}function dM(t,e){t.G=Date.now(),ol(t),t.B=Yr(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),vM(n.i,"t",r),t.o=0,n=t.l.J,t.h=new uM,t.g=BM(t.l,n?e:null,!t.u),0<t.O&&(t.M=new Gv(Rt(t.Pa,t,t.g),t.O)),nM(t.U,t.g,"readystatechange",t.nb),e=t.I?z1(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),Xu(),HU(t.j,t.v,t.B,t.m,t.W,t.u)}N.nb=function(t){t=t.target;let e=this.M;e&&vr(t)==3?e.l():this.Pa(t)};N.Pa=function(t){try{if(t==this.g)e:{let l=vr(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>l)&&(l!=3||Vv||this.g&&(this.h.h||this.g.ja()||L1(this.g)))){this.J||l!=4||e==7||(e==8||0>=d?Xu(3):Xu(2)),Ep(this);var n=this.g.da();this.ca=n;t:if(hM(this)){var r=L1(this.g);t="";var i=r.length,s=vr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Vs(this),zu(this);var o="";break t}this.h.i=new Q.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,qU(this.j,this.v,this.B,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Wu(a)){var u=a;break t}}u=null}if(n=u)Ea(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qv(this,n);else{this.i=!1,this.s=3,Gt(12),Vs(this),zu(this);break e}}this.S?(fM(this,l,o),Vv&&this.i&&l==3&&(nM(this.U,this.V,"tick",this.mb),this.V.start())):(Ea(this.j,this.m,o,null),Qv(this,o)),l==4&&Vs(this),this.i&&!this.J&&(l==4?FM(this.l,this):(this.i=!1,ol(this)))}else p9(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,Gt(12)):(this.s=0,Gt(13)),Vs(this),zu(this)}}}catch{}finally{}};function hM(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function fM(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=KU(t,n),i==Wv){e==4&&(t.s=4,Gt(14),r=!1),Ea(t.j,t.m,null,"[Incomplete Response]");break}else if(i==lM){t.s=4,Gt(15),Ea(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Ea(t.j,t.m,i,null),Qv(t,i);hM(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,Gt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),vx(e),e.M=!0,Gt(11))):(Ea(t.j,t.m,n,"[Invalid Chunked Response]"),Vs(t),zu(t))}N.mb=function(){if(this.g){var t=vr(this.g),e=this.g.ja();this.o<e.length&&(Ep(this),fM(this,t,e),this.i&&t!=4&&ol(this))}};function KU(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?Wv:(n=Number(e.substring(n,r)),isNaN(n)?lM:(r+=1,r+n>e.length?Wv:(e=e.slice(r,r+n),t.o=r+n,e)))}N.cancel=function(){this.J=!0,Vs(this)};function ol(t){t.Y=Date.now()+t.P,pM(t,t.P)}function pM(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=rl(Rt(t.lb,t),e)}function Ep(t){t.C&&(Q.clearTimeout(t.C),t.C=null)}N.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(GU(this.j,this.B),this.L!=2&&(Xu(),Gt(17)),Vs(this),this.s=2,zu(this)):pM(this,this.Y-t)};function zu(t){t.l.H==0||t.J||FM(t.l,t)}function Vs(t){Ep(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,ux(t.V),rM(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Qv(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||Yv(n.i,t))){if(!t.K&&Yv(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)up(n),Dp(n);else break e;yx(n),Gt(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=rl(Rt(n.ib,n),6e3));if(1>=EM(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Ls(n,11)}else if((t.K||n.g==t)&&up(n),!Wu(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let u=i[e];if(n.V=u[0],u=u[1],n.H==2)if(u[0]=="c"){n.K=u[1],n.pa=u[2];let l=u[3];l!=null&&(n.ra=l,n.l.info("VER="+n.ra));let d=u[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let h=u[5];h!=null&&typeof h=="number"&&0<h&&(r=1.5*h,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let f=t.g;if(f){let p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=r.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(px(s,s.h),s.h=null))}if(r.F){let m=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;m&&(r.Da=m,Pe(r.I,r.F,m))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=jM(r,r.J?r.pa:null,r.Y),o.K){IM(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.C&&(Ep(a),ol(a)),r.g=o}else kM(r);0<n.j.length&&Tp(n)}else u[0]!="stop"&&u[0]!="close"||Ls(n,7);else n.H==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?Ls(n,7):_x(n):u[0]!="noop"&&n.h&&n.h.Aa(u),n.A=0)}}Xu(4)}catch{}}function QU(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(fp(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function YU(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(fp(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function gM(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(fp(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=YU(t),r=QU(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var mM=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ZU(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function js(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof js){this.h=t.h,ap(this,t.j),this.s=t.s,this.g=t.g,cp(this,t.m),this.l=t.l;var e=t.i,n=new Ju;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),O1(this,n),this.o=t.o}else t&&(e=String(t).match(mM))?(this.h=!1,ap(this,e[1]||"",!0),this.s=qu(e[2]||""),this.g=qu(e[3]||"",!0),cp(this,e[4]),this.l=qu(e[5]||"",!0),O1(this,e[6]||"",!0),this.o=qu(e[7]||"")):(this.h=!1,this.i=new Ju(null,this.h))}js.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Gu(e,F1,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Gu(e,F1,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Gu(n,n.charAt(0)=="/"?e9:JU,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Gu(n,n9)),t.join("")};function Yr(t){return new js(t)}function ap(t,e,n){t.j=n?qu(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function cp(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function O1(t,e,n){e instanceof Ju?(t.i=e,r9(t.i,t.h)):(n||(e=Gu(e,t9)),t.i=new Ju(e,t.h))}function Pe(t,e,n){t.i.set(e,n)}function Ip(t){return Pe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function qu(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Gu(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,XU),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function XU(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var F1=/[#\/\?@]/g,JU=/[#\?:]/g,e9=/[#\?]/g,t9=/[#\?@]/g,n9=/#/g;function Ju(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ni(t){t.g||(t.g=new Map,t.h=0,t.i&&ZU(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}N=Ju.prototype;N.add=function(t,e){Ni(this),this.i=null,t=ba(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function _M(t,e){Ni(t),e=ba(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function yM(t,e){return Ni(t),e=ba(t,e),t.g.has(e)}N.forEach=function(t,e){Ni(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};N.ta=function(){Ni(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};N.Z=function(t){Ni(this);let e=[];if(typeof t=="string")yM(this,t)&&(e=e.concat(this.g.get(ba(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};N.set=function(t,e){return Ni(this),this.i=null,t=ba(this,t),yM(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};N.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function vM(t,e,n){_M(t,e),0<n.length&&(t.i=null,t.g.set(ba(t,e),ex(n)),t.h+=n.length)}N.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function ba(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function r9(t,e){e&&!t.j&&(Ni(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(_M(this,r),vM(this,i,n))},t)),t.j=e}var i9=class{constructor(t,e){this.g=t,this.map=e}};function xM(t){this.l=t||s9,Q.PerformanceNavigationTiming?(t=Q.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(Q.g&&Q.g.Ka&&Q.g.Ka()&&Q.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var s9=10;function wM(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function EM(t){return t.h?1:t.g?t.g.size:0}function Yv(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function px(t,e){t.g?t.g.add(e):t.h=e}function IM(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}xM.prototype.cancel=function(){if(this.i=CM(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function CM(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return ex(t.i)}var o9=class{stringify(t){return Q.JSON.stringify(t,void 0)}parse(t){return Q.JSON.parse(t,void 0)}};function a9(){this.g=new o9}function c9(t,e,n){let r=n||"";try{gM(t,function(i,s){let o=i;tl(i)&&(o=ax(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function u9(t,e){let n=new yp;if(Q.Image){let r=new Image;r.onload=ep(sp,n,r,"TestLoadImage: loaded",!0,e),r.onerror=ep(sp,n,r,"TestLoadImage: error",!1,e),r.onabort=ep(sp,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=ep(sp,n,r,"TestLoadImage: timeout",!1,e),Q.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function sp(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function al(t){this.l=t.ec||null,this.j=t.ob||!1}gt(al,dx);al.prototype.g=function(){return new Cp(this.l,this.j)};al.prototype.i=function(t){return function(){return t}}({});function Cp(t,e){pt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=gx,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}gt(Cp,pt);var gx=0;N=Cp.prototype;N.open=function(t,e){if(this.readyState!=gx)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,el(this)};N.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Q).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};N.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,cl(this)),this.readyState=gx};N.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,el(this)),this.g&&(this.readyState=3,el(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Q.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;bM(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function bM(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}N.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?cl(this):el(this),this.readyState==3&&bM(this)}};N.Za=function(t){this.g&&(this.response=this.responseText=t,cl(this))};N.Ya=function(t){this.g&&(this.response=t,cl(this))};N.ka=function(){this.g&&cl(this)};function cl(t){t.readyState=4,t.l=null,t.j=null,t.A=null,el(t)}N.setRequestHeader=function(t,e){this.v.append(t,e)};N.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};N.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function el(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Cp.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var l9=Q.JSON.parse;function $e(t){pt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=DM,this.L=this.M=!1}gt($e,pt);var DM="",d9=/^https?$/i,h9=["POST","PUT"];N=$e.prototype;N.Oa=function(t){this.M=t};N.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():zv.g(),this.C=this.u?k1(this.u):k1(zv),this.g.onreadystatechange=Rt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){V1(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=Q.FormData&&t instanceof Q.FormData,!(0<=$1(h9,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{AM(this),0<this.B&&((this.L=f9(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Rt(this.ua,this)):this.A=lx(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){V1(this,s)}};function f9(t){return Ca&&typeof t.timeout=="number"&&t.ontimeout!==void 0}N.ua=function(){typeof Jv<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Tt(this,"timeout"),this.abort(8))};function V1(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,TM(t),bp(t)}function TM(t){t.F||(t.F=!0,Tt(t,"complete"),Tt(t,"error"))}N.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Tt(this,"complete"),Tt(this,"abort"),bp(this))};N.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),bp(this,!0)),$e.$.N.call(this)};N.La=function(){this.s||(this.G||this.v||this.l?SM(this):this.kb())};N.kb=function(){SM(this)};function SM(t){if(t.h&&typeof Jv<"u"&&(!t.C[1]||vr(t)!=4||t.da()!=2)){if(t.v&&vr(t)==4)lx(t.La,0,t);else if(Tt(t,"readystatechange"),vr(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(mM)[1]||null;!i&&Q.self&&Q.self.location&&(i=Q.self.location.protocol.slice(0,-1)),r=!d9.test(i?i.toLowerCase():"")}n=r}if(n)Tt(t,"complete"),Tt(t,"success");else{t.m=6;try{var s=2<vr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",TM(t)}}finally{bp(t)}}}}function bp(t,e){if(t.g){AM(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Tt(t,"ready");try{n.onreadystatechange=r}catch{}}}function AM(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Q.clearTimeout(t.A),t.A=null)}N.isActive=function(){return!!this.g};function vr(t){return t.g?t.g.readyState:0}N.da=function(){try{return 2<vr(this)?this.g.status:-1}catch{return-1}};N.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};N.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),l9(e)}};function L1(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case DM:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function p9(t){let e={};t=(t.g&&2<=vr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(Wu(t[r]))continue;var n=BU(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}FU(e,function(r){return r.join(", ")})}N.Ia=function(){return this.m};N.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function MM(t){let e="";return nx(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function mx(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=MM(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Pe(t,e,n))}function $u(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function RM(t){this.Ga=0,this.j=[],this.l=new yp,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=$u("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=$u("baseRetryDelayMs",5e3,t),this.hb=$u("retryDelaySeedMs",1e4,t),this.eb=$u("forwardChannelMaxRetries",2,t),this.xa=$u("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new xM(t&&t.concurrentRequestLimit),this.Ja=new a9,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}N=RM.prototype;N.ra=8;N.H=1;function _x(t){if(NM(t),t.H==3){var e=t.W++,n=Yr(t.I);if(Pe(n,"SID",t.K),Pe(n,"RID",e),Pe(n,"TYPE","terminate"),ul(t,n),e=new sl(t,t.l,e),e.L=2,e.A=Ip(Yr(n)),n=!1,Q.navigator&&Q.navigator.sendBeacon)try{n=Q.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&Q.Image&&(new Image().src=e.A,n=!0),n||(e.g=BM(e.l,null),e.g.ha(e.A)),e.G=Date.now(),ol(e)}LM(t)}function Dp(t){t.g&&(vx(t),t.g.cancel(),t.g=null)}function NM(t){Dp(t),t.u&&(Q.clearTimeout(t.u),t.u=null),up(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&Q.clearTimeout(t.m),t.m=null)}function Tp(t){if(!wM(t.i)&&!t.m){t.m=!0;var e=t.Na;Qu||eM(),Yu||(Qu(),Yu=!0),cx.add(e,t),t.C=0}}function g9(t,e){return EM(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=rl(Rt(t.Na,t,e),VM(t,t.C)),t.C++,!0)}N.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new sl(this,this.l,t),s=this.s;if(this.U&&(s?(s=z1(s),W1(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=PM(this,i,e),n=Yr(this.I),Pe(n,"RID",t),Pe(n,"CVER",22),this.F&&Pe(n,"X-HTTP-Session-Id",this.F),ul(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(MM(s)))+"&"+e:this.o&&mx(n,this.o,s)),px(this.i,i),this.bb&&Pe(n,"TYPE","init"),this.P?(Pe(n,"$req",e),Pe(n,"SID","null"),i.aa=!0,Kv(i,n,null)):Kv(i,n,e),this.H=2}}else this.H==3&&(t?j1(this,t):this.j.length==0||wM(this.i)||j1(this))};function j1(t,e){var n;e?n=e.m:n=t.W++;let r=Yr(t.I);Pe(r,"SID",t.K),Pe(r,"RID",n),Pe(r,"AID",t.V),ul(t,r),t.o&&t.s&&mx(r,t.o,t.s),n=new sl(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=PM(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),px(t.i,n),Kv(n,r,e)}function ul(t,e){t.na&&nx(t.na,function(n,r){Pe(e,r,n)}),t.h&&gM({},function(n,r){Pe(e,r,n)})}function PM(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Rt(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<n;c++){let u=i[c].g,l=i[c].map;if(u-=s,0>u)s=Math.max(0,i[c].g-100),a=!1;else try{c9(l,o,"req"+u+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function kM(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Qu||eM(),Yu||(Qu(),Yu=!0),cx.add(e,t),t.A=0}}function yx(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=rl(Rt(t.Ma,t),VM(t,t.A)),t.A++,!0)}N.Ma=function(){if(this.u=null,OM(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=rl(Rt(this.jb,this),t)}};N.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Gt(10),Dp(this),OM(this))};function vx(t){t.B!=null&&(Q.clearTimeout(t.B),t.B=null)}function OM(t){t.g=new sl(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Yr(t.wa);Pe(e,"RID","rpc"),Pe(e,"SID",t.K),Pe(e,"AID",t.V),Pe(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Pe(e,"TO",t.qa),Pe(e,"TYPE","xmlhttp"),ul(t,e),t.o&&t.s&&mx(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=Ip(Yr(e)),n.u=null,n.S=!0,dM(n,t)}N.ib=function(){this.v!=null&&(this.v=null,Dp(this),yx(this),Gt(19))};function up(t){t.v!=null&&(Q.clearTimeout(t.v),t.v=null)}function FM(t,e){var n=null;if(t.g==e){up(t),vx(t),t.g=null;var r=2}else if(Yv(t.i,e))n=e.F,IM(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=vp(),Tt(r,new oM(r,n)),Tp(t)}else kM(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&g9(t,e)||r==2&&yx(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Ls(t,5);break;case 4:Ls(t,10);break;case 3:Ls(t,6);break;default:Ls(t,2)}}}function VM(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Ls(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Rt(t.pb,t);n||(n=new js("//www.google.com/images/cleardot.gif"),Q.location&&Q.location.protocol=="http"||ap(n,"https"),Ip(n)),u9(n.toString(),r)}else Gt(2);t.H=0,t.h&&t.h.za(e),LM(t),NM(t)}N.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Gt(2)):(this.l.info("Failed to ping google.com"),Gt(1))};function LM(t){if(t.H=0,t.ma=[],t.h){let e=CM(t.i);(e.length!=0||t.j.length!=0)&&(M1(t.ma,e),M1(t.ma,t.j),t.i.i.length=0,ex(t.j),t.j.length=0),t.h.ya()}}function jM(t,e,n){var r=n instanceof js?Yr(n):new js(n);if(r.g!="")e&&(r.g=e+"."+r.g),cp(r,r.m);else{var i=Q.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new js(null);r&&ap(s,r),e&&(s.g=e),i&&cp(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&Pe(r,n,e),Pe(r,"VER",t.ra),ul(t,r),r}function BM(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new $e(new al({ob:n})):new $e(t.va),e.Oa(t.J),e}N.isActive=function(){return!!this.h&&this.h.isActive(this)};function UM(){}N=UM.prototype;N.Ba=function(){};N.Aa=function(){};N.za=function(){};N.ya=function(){};N.isActive=function(){return!0};N.Va=function(){};function lp(){if(Ca&&!(10<=Number(NU)))throw Error("Environmental error: no available transport.")}lp.prototype.g=function(t,e){return new fn(t,e)};function fn(t,e){pt.call(this),this.g=new RM(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Wu(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Wu(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Da(this)}gt(fn,pt);fn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Gt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=jM(t,null,t.Y),Tp(t)};fn.prototype.close=function(){_x(this.g)};fn.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=ax(t),t=n);e.j.push(new i9(e.fb++,t)),e.H==3&&Tp(e)};fn.prototype.N=function(){this.g.h=null,delete this.j,_x(this.g),delete this.g,fn.$.N.call(this)};function $M(t){hx.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}gt($M,hx);function HM(){fx.call(this),this.status=1}gt(HM,fx);function Da(t){this.g=t}gt(Da,UM);Da.prototype.Ba=function(){Tt(this.g,"a")};Da.prototype.Aa=function(t){Tt(this.g,new $M(t))};Da.prototype.za=function(t){Tt(this.g,new HM)};Da.prototype.ya=function(){Tt(this.g,"b")};function m9(){this.blockSize=-1}function Yn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}gt(Yn,m9);Yn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Fv(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}Yn.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)Fv(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){Fv(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){Fv(this,r),i=0;break}}this.h=i,this.i+=e};Yn.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function Ie(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var _9={};function xx(t){return-128<=t&&128>t?AU(t,function(e){return new Ie([e|0],0>e?-1:0)}):new Ie([t|0],0>t?-1:0)}function xr(t){if(isNaN(t)||!isFinite(t))return Ia;if(0>t)return Dt(xr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=Zv;return new Ie(e,0)}function qM(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Dt(qM(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=xr(Math.pow(e,8)),r=Ia,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=xr(Math.pow(e,s)),r=r.R(s).add(xr(o))):(r=r.R(n),r=r.add(xr(o)))}return r}var Zv=4294967296,Ia=xx(0),Xv=xx(1),B1=xx(16777216);N=Ie.prototype;N.ea=function(){if(Mn(this))return-Dt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:Zv+r)*e,e*=Zv}return t};N.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Qr(this))return"0";if(Mn(this))return"-"+Dt(this).toString(t);for(var e=xr(Math.pow(t,6)),n=this,r="";;){var i=hp(n,e).g;n=dp(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Qr(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};N.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Qr(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Mn(t){return t.h==-1}N.X=function(t){return t=dp(this,t),Mn(t)?-1:Qr(t)?0:1};function Dt(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Ie(n,~t.h).add(Xv)}N.abs=function(){return Mn(this)?Dt(this):this};N.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new Ie(n,n[n.length-1]&-2147483648?-1:0)};function dp(t,e){return t.add(Dt(e))}N.R=function(t){if(Qr(this)||Qr(t))return Ia;if(Mn(this))return Mn(t)?Dt(this).R(Dt(t)):Dt(Dt(this).R(t));if(Mn(t))return Dt(this.R(Dt(t)));if(0>this.X(B1)&&0>t.X(B1))return xr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,c=t.D(i)&65535;n[2*r+2*i]+=o*c,op(n,2*r+2*i),n[2*r+2*i+1]+=s*c,op(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,op(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,op(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Ie(n,0)};function op(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Hu(t,e){this.g=t,this.h=e}function hp(t,e){if(Qr(e))throw Error("division by zero");if(Qr(t))return new Hu(Ia,Ia);if(Mn(t))return e=hp(Dt(t),e),new Hu(Dt(e.g),Dt(e.h));if(Mn(e))return e=hp(t,Dt(e)),new Hu(Dt(e.g),e.h);if(30<t.g.length){if(Mn(t)||Mn(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Xv,r=e;0>=r.X(t);)n=U1(n),r=U1(r);var i=wa(n,1),s=wa(r,1);for(r=wa(r,2),n=wa(n,2);!Qr(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=wa(r,1),n=wa(n,1)}return e=dp(t,i.R(e)),new Hu(i,e)}for(i=Ia;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=xr(n),o=s.R(e);Mn(o)||0<o.X(t);)n-=r,s=xr(n),o=s.R(e);Qr(s)&&(s=Xv),i=i.add(s),t=dp(t,o)}return new Hu(i,t)}N.gb=function(t){return hp(this,t).h};N.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Ie(n,this.h&t.h)};N.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Ie(n,this.h|t.h)};N.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Ie(n,this.h^t.h)};function U1(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Ie(n,t.h)}function wa(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new Ie(i,t.h)}lp.prototype.createWebChannel=lp.prototype.g;fn.prototype.send=fn.prototype.u;fn.prototype.open=fn.prototype.m;fn.prototype.close=fn.prototype.close;xp.NO_ERROR=0;xp.TIMEOUT=8;xp.HTTP_ERROR=6;aM.COMPLETE="complete";cM.EventType=il;il.OPEN="a";il.CLOSE="b";il.ERROR="c";il.MESSAGE="d";pt.prototype.listen=pt.prototype.O;$e.prototype.listenOnce=$e.prototype.P;$e.prototype.getLastError=$e.prototype.Sa;$e.prototype.getLastErrorCode=$e.prototype.Ia;$e.prototype.getStatus=$e.prototype.da;$e.prototype.getResponseJson=$e.prototype.Wa;$e.prototype.getResponseText=$e.prototype.ja;$e.prototype.send=$e.prototype.ha;$e.prototype.setWithCredentials=$e.prototype.Oa;Yn.prototype.digest=Yn.prototype.l;Yn.prototype.reset=Yn.prototype.reset;Yn.prototype.update=Yn.prototype.j;Ie.prototype.add=Ie.prototype.add;Ie.prototype.multiply=Ie.prototype.R;Ie.prototype.modulo=Ie.prototype.gb;Ie.prototype.compare=Ie.prototype.X;Ie.prototype.toNumber=Ie.prototype.ea;Ie.prototype.toString=Ie.prototype.toString;Ie.prototype.getBits=Ie.prototype.D;Ie.fromNumber=xr;Ie.fromString=qM;var GM=Zn.createWebChannelTransport=function(){return new lp},zM=Zn.getStatEventTarget=function(){return vp()},Sp=Zn.ErrorCode=xp,WM=Zn.EventType=aM,KM=Zn.Event=Bs,wx=Zn.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},ste=Zn.FetchXmlHttpFactory=al,ll=Zn.WebChannel=cM,QM=Zn.XhrIo=$e,YM=Zn.Md5=Yn,Us=Zn.Integer=Ie;var ZM="@firebase/firestore";var it=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};it.UNAUTHENTICATED=new it(null),it.GOOGLE_CREDENTIALS=new it("google-credentials-uid"),it.FIRST_PARTY=new it("first-party-uid"),it.MOCK_USER=new it("mock-user");var rc="10.10.0";var ji=new ui("@firebase/firestore");function Ra(){return ji.logLevel}function ZR(t){ji.setLogLevel(t)}function I(t,...e){if(ji.logLevel<=wn.DEBUG){let n=e.map(CE);ji.debug(`Firestore (${rc}): ${t}`,...n)}}function We(t,...e){if(ji.logLevel<=wn.ERROR){let n=e.map(CE);ji.error(`Firestore (${rc}): ${t}`,...n)}}function Nn(t,...e){if(ji.logLevel<=wn.WARN){let n=e.map(CE);ji.warn(`Firestore (${rc}): ${t}`,...n)}}function CE(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function k(t="Unexpected state"){let e=`FIRESTORE (${rc}) INTERNAL ASSERTION FAILED: `+t;throw We(e),new Error(e)}function L(t,e){t||k()}function XR(t,e){t||k()}function R(t,e){return t}var y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},x=class extends bb{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var st=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var jp=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Dx=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(it.UNAUTHENTICATED))}shutdown(){}},Tx=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},Sx=class{constructor(e){this.t=e,this.currentUser=it.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve(),s=new st;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new st,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>g(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{I("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(I("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new st)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(I("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(L(typeof r.accessToken=="string"),new jp(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return L(e===null||typeof e=="string"),new it(e)}},Ax=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=it.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Mx=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new Ax(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(it.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Rx=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Nx=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&I("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,I("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{I("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):I("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(L(typeof n.token=="string"),this.R=n.token,new Rx(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function v9(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Bp=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=v9(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function J(t,e){return t<e?-1:t>e?1:0}function Ba(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function JR(t){return t+"\0"}var je=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new x(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new x(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new x(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new x(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?J(this.nanoseconds,e.nanoseconds):J(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var U=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new je(0,0))}static max(){return new t(new je(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Up=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&k(),r===void 0?r=e.length-n:r>e.length-n&&k(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},me=class t extends Up{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new x(y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},x9=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ke=class t extends Up{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return x9.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new x(y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new x(y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new x(y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new x(y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var M=class t{constructor(e){this.path=e}static fromPath(e){return new t(me.fromString(e))}static fromName(e){return new t(me.fromString(e).popFirst(5))}static empty(){return new t(me.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&me.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return me.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new me(e.slice()))}};var Ua=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};function Px(t){return t.fields.find(e=>e.kind===2)}function Hs(t){return t.fields.filter(e=>e.kind!==2)}Ua.UNKNOWN_ID=-1;var Va=class{constructor(e,n){this.fieldPath=e,this.kind=n}};var El=class t{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new t(0,Pn.min())}};function eN(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=U.fromTimestamp(r===1e9?new je(n+1,0):new je(n,r));return new Pn(i,M.empty(),e)}function tN(t){return new Pn(t.readTime,t.key,-1)}var Pn=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(U.min(),M.empty(),-1)}static max(){return new t(U.max(),M.empty(),-1)}};function bE(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=M.comparator(t.documentKey,e.documentKey),n!==0?n:J(t.largestBatchId,e.largestBatchId))}var nN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",$p=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Qi(t){return g(this,null,function*(){if(t.code!==y.FAILED_PRECONDITION||t.message!==nN)throw t;I("LocalStore","Unexpectedly lost primary lease")})}var _=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&k(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let u=c;n(e[u]).next(l=>{o[u]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};var Hp=class t{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new st,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Qs(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=DE(r.target.error);this.V.reject(new Qs(e,i))}}static open(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(s){throw new Qs(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(I("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let n=this.transaction.objectStore(e);return new Ox(n)}},Jr=class t{constructor(e,n,r){this.name=e,this.version=n,this.p=r,t.S(Oc())===12.2&&We("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return I("SimpleDb","Removing database:",e),qs(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Ud())return!1;if(t.C())return!0;let e=Oc(),n=t.S(e),r=0<n&&n<10,i=t.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,n){return e.store(n)}static S(e){let n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){let n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){return g(this,null,function*(){return this.db||(I("SimpleDb","Opening database:",this.name),this.db=yield new Promise((n,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;n(o)},i.onblocked=()=>{r(new Qs(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new x(y.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new x(y.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Qs(e,o))},i.onupgradeneeded=s=>{I("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.N(o,i.transaction,s.oldVersion,this.version).next(()=>{I("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.L&&(this.db.onversionchange=n=>this.L(n)),this.db})}B(e){this.L=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){return g(this,null,function*(){let s=n==="readonly",o=0;for(;;){++o;try{this.db=yield this.O(e);let a=Hp.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(u=>(a.g(),u)).catch(u=>(a.abort(u),_.reject(u))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,u=c.name!=="FirebaseError"&&o<3;if(I("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}},kx=class{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return qs(this.k.delete())}},Qs=class extends x{constructor(e,n){super(y.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}};function Yi(t){return t.name==="IndexedDbTransactionError"}var Ox=class{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(I("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(I("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),qs(r)}add(e){return I("SimpleDb","ADD",this.store.name,e,e),qs(this.store.add(e))}get(e){return qs(this.store.get(e)).next(n=>(n===void 0&&(n=null),I("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return I("SimpleDb","DELETE",this.store.name,e),qs(this.store.delete(e))}count(){return I("SimpleDb","COUNT",this.store.name),qs(this.store.count())}W(e,n){let r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new _((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.G(s,(a,c)=>{o.push(c)}).next(()=>o)}}j(e,n){let r=this.store.getAll(e,n===null?void 0:n);return new _((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,n){I("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,n);r.J=!1;let i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,n){let r;n?r=e:(r={},n=e);let i=this.cursor(r);return this.G(i,n)}Z(e){let n=this.cursor({});return new _((r,i)=>{n.onerror=s=>{let o=DE(s.target.error);i(o)},n.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){let r=[];return new _((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new kx(a),u=n(a.primaryKey,a.value,c);if(u instanceof _){let l=u.catch(d=>(c.done(),_.reject(d)));r.push(l)}c.isDone?i():c.$===null?a.continue():a.continue(c.$)}}).next(()=>_.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){let r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}};function qs(t){return new _((e,n)=>{t.onsuccess=r=>{let i=r.target.result;e(i)},t.onerror=r=>{let i=DE(r.target.error);n(i)}})}var XM=!1;function DE(t){let e=Jr.S(Oc());if(e>=12.2&&e<13){let n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){let r=new x("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return XM||(XM=!0,setTimeout(()=>{throw r},0)),r}}return t}var Fx=class{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){I("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>g(this,null,function*(){this.task=null;try{I("IndexBackfiller",`Documents written: ${yield this.X.te()}`)}catch(n){Yi(n)?I("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):yield Qi(n)}yield this.ee(6e4)}))}},Vx=class{constructor(e,n){this.localStore=e,this.persistence=n}te(e=50){return g(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.ne(n,e))})}ne(e,n){let r=new Set,i=n,s=!0;return _.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return I("IndexBackfiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(I("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{let o=tN(s);bE(o,r)>0&&(r=o)}),new Pn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}};var pn=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function ql(t){return t==null}function Il(t){return t===0&&1/t==-1/0}function rN(t){return typeof t=="number"&&Number.isInteger(t)&&!Il(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function zt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=JM(e)),e=w9(t.get(n),e);return JM(e)}function w9(t,e){let n=e,r=t.length;for(let i=0;i<r;i++){let s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function JM(t){return t+""}function wr(t){let e=t.length;if(L(e>=2),e===2)return L(t.charAt(0)===""&&t.charAt(1)===""),me.emptyPath();let n=e-2,r=[],i="";for(let s=0;s<e;){let o=t.indexOf("",s);switch((o<0||o>n)&&k(),t.charAt(o+1)){case"":let a=t.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:k()}s=o+2}return new me(r)}var eR=["userId","batchId"];function Pp(t,e){return[t,zt(e)]}function iN(t,e,n){return[t,zt(e),n]}var E9={},I9=["prefixPath","collectionGroup","readTime","documentId"],C9=["prefixPath","collectionGroup","documentId"],b9=["collectionGroup","readTime","prefixPath","documentId"],D9=["canonicalId","targetId"],T9=["targetId","path"],S9=["path","targetId"],A9=["collectionId","parent"],M9=["indexId","uid"],R9=["uid","sequenceNumber"],N9=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],P9=["indexId","uid","orderedDocumentKey"],k9=["userId","collectionPath","documentId"],O9=["userId","collectionPath","largestBatchId"],F9=["userId","collectionGroup","largestBatchId"],sN=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],V9=[...sN,"documentOverlays"],oN=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],aN=oN,L9=[...aN,"indexConfiguration","indexState","indexEntries"];var Cl=class extends $p{constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}};function _t(t,e){let n=R(t);return Jr.M(n.ae,e)}function tR(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ao(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function cN(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var ke=class t{constructor(e,n){this.comparator=e,this.root=n||Ir.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ir.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ir.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Fa(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Fa(this.root,e,this.comparator,!1)}getReverseIterator(){return new Fa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Fa(this.root,e,this.comparator,!0)}},Fa=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Ir=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw k();let e=this.left.check();if(e!==this.right.check())throw k();return e+(this.isRed()?0:1)}};Ir.EMPTY=null,Ir.RED=!0,Ir.BLACK=!1;Ir.EMPTY=new class{constructor(){this.size=0}get key(){throw k()}get value(){throw k()}get color(){throw k()}get left(){throw k()}get right(){throw k()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Ir(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Se=class t{constructor(e){this.comparator=e,this.data=new ke(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new qp(this.data.getIterator())}getIteratorFrom(e){return new qp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},qp=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Ta(t){return t.hasNext()?t.getNext():void 0}var gn=class t{constructor(e){this.fields=e,e.sort(Ke.comparator)}static empty(){return new t([])}unionWith(e){let n=new Se(Ke.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ba(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var Gp=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function uN(){return typeof atob<"u"}var mt=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Gp("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return J(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};mt.EMPTY_BYTE_STRING=new mt("");var j9=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bi(t){if(L(!!t),typeof t=="string"){let e=0,n=j9.exec(t);if(L(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:He(t.seconds),nanos:He(t.nanos)}}function He(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ui(t){return typeof t=="string"?mt.fromBase64String(t):mt.fromUint8Array(t)}function Og(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function TE(t){let e=t.mapValue.fields.__previous_value__;return Og(e)?TE(e):e}function bl(t){let e=Bi(t.mapValue.fields.__local_write_time__.timestampValue);return new je(e.seconds,e.nanos)}var Lx=class{constructor(e,n,r,i,s,o,a,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}},$i=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var Vi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},kp={nullValue:"NULL_VALUE"};function Ys(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Og(t)?4:lN(t)?9007199254740991:10:k()}function Dr(t,e){if(t===e)return!0;let n=Ys(t);if(n!==Ys(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return bl(t).isEqual(bl(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Bi(i.timestampValue),a=Bi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Ui(i.bytesValue).isEqual(Ui(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return He(i.geoPointValue.latitude)===He(s.geoPointValue.latitude)&&He(i.geoPointValue.longitude)===He(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return He(i.integerValue)===He(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=He(i.doubleValue),a=He(s.doubleValue);return o===a?Il(o)===Il(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Ba(t.arrayValue.values||[],e.arrayValue.values||[],Dr);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(tR(o)!==tR(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Dr(o[c],a[c])))return!1;return!0}(t,e);default:return k()}}function Dl(t,e){return(t.values||[]).find(n=>Dr(n,e))!==void 0}function Hi(t,e){if(t===e)return 0;let n=Ys(t),r=Ys(e);if(n!==r)return J(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return J(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=He(s.integerValue||s.doubleValue),c=He(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return nR(t.timestampValue,e.timestampValue);case 4:return nR(bl(t),bl(e));case 5:return J(t.stringValue,e.stringValue);case 6:return function(s,o){let a=Ui(s),c=Ui(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){let l=J(a[u],c[u]);if(l!==0)return l}return J(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=J(He(s.latitude),He(o.latitude));return a!==0?a:J(He(s.longitude),He(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let u=0;u<a.length&&u<c.length;++u){let l=Hi(a[u],c[u]);if(l)return l}return J(a.length,c.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Vi.mapValue&&o===Vi.mapValue)return 0;if(s===Vi.mapValue)return 1;if(o===Vi.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),u=o.fields||{},l=Object.keys(u);c.sort(),l.sort();for(let d=0;d<c.length&&d<l.length;++d){let h=J(c[d],l[d]);if(h!==0)return h;let f=Hi(a[c[d]],u[l[d]]);if(f!==0)return f}return J(c.length,l.length)}(t.mapValue,e.mapValue);default:throw k()}}function nR(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return J(t,e);let n=Bi(t),r=Bi(e),i=J(n.seconds,r.seconds);return i!==0?i:J(n.nanos,r.nanos)}function $a(t){return jx(t)}function jx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=Bi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ui(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return M.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=jx(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${jx(n.fields[o])}`;return i+"}"}(t.mapValue):k()}function Zs(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Bx(t){return!!t&&"integerValue"in t}function Tl(t){return!!t&&"arrayValue"in t}function rR(t){return!!t&&"nullValue"in t}function iR(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Op(t){return!!t&&"mapValue"in t}function _l(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return ao(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=_l(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=_l(t.arrayValue.values[n]);return e}return Object.assign({},t)}function lN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function B9(t){return"nullValue"in t?kp:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Zs($i.empty(),M.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:k()}function U9(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Zs($i.empty(),M.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Vi:k()}function sR(t,e){let n=Hi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function oR(t,e){let n=Hi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}var kt=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Op(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=_l(n)}setAll(e){let n=Ke.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=_l(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());Op(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Dr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Op(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){ao(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(_l(this.value))}};function dN(t){let e=[];return ao(t.fields,(n,r)=>{let i=new Ke([n]);if(Op(r)){let s=dN(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new gn(e)}var ot=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,U.min(),U.min(),U.min(),kt.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,U.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,U.min(),U.min(),kt.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,U.min(),U.min(),kt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(U.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=kt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=kt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=U.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Tr=class{constructor(e,n){this.position=e,this.inclusive=n}};function aR(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=M.comparator(M.fromName(o.referenceValue),n.key):r=Hi(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function cR(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Dr(t.position[n],e.position[n]))return!1;return!0}var Xs=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function $9(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var zp=class{},fe=class t extends zp{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Hx(e,n,r):n==="array-contains"?new zx(e,r):n==="in"?new Wp(e,r):n==="not-in"?new Wx(e,r):n==="array-contains-any"?new Kx(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new qx(e,r):new Gx(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Hi(n,this.value)):n!==null&&Ys(this.value)===Ys(n)&&this.matchesComparison(Hi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return k()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ce=class t extends zp{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new t(e,n)}matches(e){return Ha(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}};function Ha(t){return t.op==="and"}function Ux(t){return t.op==="or"}function SE(t){return hN(t)&&Ha(t)}function hN(t){for(let e of t.filters)if(e instanceof Ce)return!1;return!0}function $x(t){if(t instanceof fe)return t.field.canonicalString()+t.op.toString()+$a(t.value);if(SE(t))return t.filters.map(e=>$x(e)).join(",");{let e=t.filters.map(n=>$x(n)).join(",");return`${t.op}(${e})`}}function fN(t,e){return t instanceof fe?function(r,i){return i instanceof fe&&r.op===i.op&&r.field.isEqual(i.field)&&Dr(r.value,i.value)}(t,e):t instanceof Ce?function(r,i){return i instanceof Ce&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&fN(o,i.filters[a]),!0):!1}(t,e):void k()}function pN(t,e){let n=t.filters.concat(e);return Ce.create(n,t.op)}function gN(t){return t instanceof fe?function(n){return`${n.field.canonicalString()} ${n.op} ${$a(n.value)}`}(t):t instanceof Ce?function(n){return n.op.toString()+" {"+n.getFilters().map(gN).join(" ,")+"}"}(t):"Filter"}var Hx=class extends fe{constructor(e,n,r){super(e,n,r),this.key=M.fromName(r.referenceValue)}matches(e){let n=M.comparator(e.key,this.key);return this.matchesComparison(n)}},qx=class extends fe{constructor(e,n){super(e,"in",n),this.keys=mN("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},Gx=class extends fe{constructor(e,n){super(e,"not-in",n),this.keys=mN("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function mN(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>M.fromName(r.referenceValue))}var zx=class extends fe{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return Tl(n)&&Dl(n.arrayValue,this.value)}},Wp=class extends fe{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&Dl(this.value.arrayValue,n)}},Wx=class extends fe{constructor(e,n){super(e,"not-in",n)}matches(e){if(Dl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!Dl(this.value.arrayValue,n)}},Kx=class extends fe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!Tl(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Dl(this.value.arrayValue,r))}};var Qx=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}};function Yx(t,e=null,n=[],r=[],i=null,s=null,o=null){return new Qx(t,e,n,r,i,s,o)}function Js(t){let e=R(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>$x(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),ql(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>$a(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>$a(r)).join(",")),e.ce=n}return e.ce}function Gl(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!$9(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!fN(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!cR(t.startAt,e.startAt)&&cR(t.endAt,e.endAt)}function Kp(t){return M.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Qp(t,e){return t.filters.filter(n=>n instanceof fe&&n.field.isEqual(e))}function uR(t,e,n){let r=kp,i=!0;for(let s of Qp(t,e)){let o=kp,a=!0;switch(s.op){case"<":case"<=":o=B9(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=kp}sR({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];sR({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function lR(t,e,n){let r=Vi,i=!0;for(let s of Qp(t,e)){let o=Vi,a=!0;switch(s.op){case">=":case">":o=U9(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Vi}oR({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];oR({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}var Xn=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}};function _N(t,e,n,r,i,s,o,a){return new Xn(t,e,n,r,i,s,o,a)}function ic(t){return new Xn(t)}function dR(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function AE(t){return t.collectionGroup!==null}function La(t){let e=R(t);if(e.le===null){e.le=[];let n=new Set;for(let s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Se(Ke.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new Xs(s,r))}),n.has(Ke.keyField().canonicalString())||e.le.push(new Xs(Ke.keyField(),r))}return e.le}function Wt(t){let e=R(t);return e.he||(e.he=H9(e,La(t))),e.he}function H9(t,e){if(t.limitType==="F")return Yx(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Xs(i.field,s)});let n=t.endAt?new Tr(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Tr(t.startAt.position,t.startAt.inclusive):null;return Yx(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Zx(t,e){let n=t.filters.concat([e]);return new Xn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Yp(t,e,n){return new Xn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function zl(t,e){return Gl(Wt(t),Wt(e))&&t.limitType===e.limitType}function yN(t){return`${Js(Wt(t))}|lt:${t.limitType}`}function Na(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>gN(i)).join(", ")}]`),ql(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>$a(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>$a(i)).join(",")),`Target(${r})`}(Wt(t))}; limitType=${t.limitType})`}function Wl(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):M.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of La(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let u=aR(o,a,c);return o.inclusive?u<=0:u<0}(r.startAt,La(r),i)||r.endAt&&!function(o,a,c){let u=aR(o,a,c);return o.inclusive?u>=0:u>0}(r.endAt,La(r),i))}(t,e)}function vN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function xN(t){return(e,n)=>{let r=!1;for(let i of La(t)){let s=q9(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function q9(t,e,n){let r=t.field.isKeyField()?M.comparator(e.key,n.key):function(s,o,a){let c=o.data.field(s),u=a.data.field(s);return c!==null&&u!==null?Hi(c,u):k()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return k()}}var Sr=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ao(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return cN(this.inner)}size(){return this.innerSize}};var G9=new ke(M.comparator);function an(){return G9}var wN=new ke(M.comparator);function gl(...t){let e=wN;for(let n of t)e=e.insert(n.key,n);return e}function EN(t){let e=wN;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Er(){return yl()}function IN(){return yl()}function yl(){return new Sr(t=>t.toString(),(t,e)=>t.isEqual(e))}var z9=new ke(M.comparator),W9=new Se(M.comparator);function te(...t){let e=W9;for(let n of t)e=e.add(n);return e}var K9=new Se(J);function ME(){return K9}function CN(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Il(e)?"-0":e}}function bN(t){return{integerValue:""+t}}function DN(t,e){return rN(e)?bN(e):CN(t,e)}var qa=class{constructor(){this._=void 0}};function Q9(t,e,n){return t instanceof qi?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Og(s)&&(s=TE(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof ei?SN(t,e):t instanceof ti?AN(t,e):function(i,s){let o=TN(i,s),a=hR(o)+hR(i.Ie);return Bx(o)&&Bx(i.Ie)?bN(a):CN(i.serializer,a)}(t,e)}function Y9(t,e,n){return t instanceof ei?SN(t,e):t instanceof ti?AN(t,e):n}function TN(t,e){return t instanceof Gi?function(r){return Bx(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var qi=class extends qa{},ei=class extends qa{constructor(e){super(),this.elements=e}};function SN(t,e){let n=MN(e);for(let r of t.elements)n.some(i=>Dr(i,r))||n.push(r);return{arrayValue:{values:n}}}var ti=class extends qa{constructor(e){super(),this.elements=e}};function AN(t,e){let n=MN(e);for(let r of t.elements)n=n.filter(i=>!Dr(i,r));return{arrayValue:{values:n}}}var Gi=class extends qa{constructor(e,n){super(),this.serializer=e,this.Ie=n}};function hR(t){return He(t.integerValue||t.doubleValue)}function MN(t){return Tl(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var eo=class{constructor(e,n){this.field=e,this.transform=n}};function Z9(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof ei&&i instanceof ei||r instanceof ti&&i instanceof ti?Ba(r.elements,i.elements,Dr):r instanceof Gi&&i instanceof Gi?Dr(r.Ie,i.Ie):r instanceof qi&&i instanceof qi}(t.transform,e.transform)}var Xx=class{constructor(e,n){this.version=e,this.transformResults=n}},qe=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Fp(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var Ga=class{};function RN(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Wi(t.key,qe.none()):new zi(t.key,t.data,qe.none());{let n=t.data,r=kt.empty(),i=new Se(Ke.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Jn(t.key,r,new gn(i.toArray()),qe.none())}}function X9(t,e,n){t instanceof zi?function(i,s,o){let a=i.value.clone(),c=pR(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Jn?function(i,s,o){if(!Fp(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=pR(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(NN(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function vl(t,e,n,r){return t instanceof zi?function(s,o,a,c){if(!Fp(s.precondition,o))return a;let u=s.value.clone(),l=gR(s.fieldTransforms,c,o);return u.setAll(l),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Jn?function(s,o,a,c){if(!Fp(s.precondition,o))return a;let u=gR(s.fieldTransforms,c,o),l=o.data;return l.setAll(NN(s)),l.setAll(u),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,o,a){return Fp(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function J9(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=TN(r.transform,i||null);s!=null&&(n===null&&(n=kt.empty()),n.set(r.field,s))}return n||null}function fR(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ba(r,i,(s,o)=>Z9(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var zi=class extends Ga{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Jn=class extends Ga{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function NN(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function pR(t,e,n){let r=new Map;L(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,Y9(o,a,n[i]))}return r}function gR(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,Q9(s,o,e))}return r}var Wi=class extends Ga{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Sl=class extends Ga{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Al=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&X9(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=vl(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=vl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=IN();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let c=RN(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(U.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),te())}isEqual(e){return this.batchId===e.batchId&&Ba(this.mutations,e.mutations,(n,r)=>fR(n,r))&&Ba(this.baseMutations,e.baseMutations,(n,r)=>fR(n,r))}},Jx=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){L(e.mutations.length===r.length);let i=function(){return z9}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var Ml=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var ew=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var nt,ge;function PN(t){switch(t){default:return k();case y.CANCELLED:case y.UNKNOWN:case y.DEADLINE_EXCEEDED:case y.RESOURCE_EXHAUSTED:case y.INTERNAL:case y.UNAVAILABLE:case y.UNAUTHENTICATED:return!1;case y.INVALID_ARGUMENT:case y.NOT_FOUND:case y.ALREADY_EXISTS:case y.PERMISSION_DENIED:case y.FAILED_PRECONDITION:case y.ABORTED:case y.OUT_OF_RANGE:case y.UNIMPLEMENTED:case y.DATA_LOSS:return!0}}function kN(t){if(t===void 0)return We("GRPC error has no .code"),y.UNKNOWN;switch(t){case nt.OK:return y.OK;case nt.CANCELLED:return y.CANCELLED;case nt.UNKNOWN:return y.UNKNOWN;case nt.DEADLINE_EXCEEDED:return y.DEADLINE_EXCEEDED;case nt.RESOURCE_EXHAUSTED:return y.RESOURCE_EXHAUSTED;case nt.INTERNAL:return y.INTERNAL;case nt.UNAVAILABLE:return y.UNAVAILABLE;case nt.UNAUTHENTICATED:return y.UNAUTHENTICATED;case nt.INVALID_ARGUMENT:return y.INVALID_ARGUMENT;case nt.NOT_FOUND:return y.NOT_FOUND;case nt.ALREADY_EXISTS:return y.ALREADY_EXISTS;case nt.PERMISSION_DENIED:return y.PERMISSION_DENIED;case nt.FAILED_PRECONDITION:return y.FAILED_PRECONDITION;case nt.ABORTED:return y.ABORTED;case nt.OUT_OF_RANGE:return y.OUT_OF_RANGE;case nt.UNIMPLEMENTED:return y.UNIMPLEMENTED;case nt.DATA_LOSS:return y.DATA_LOSS;default:return k()}}(ge=nt||(nt={}))[ge.OK=0]="OK",ge[ge.CANCELLED=1]="CANCELLED",ge[ge.UNKNOWN=2]="UNKNOWN",ge[ge.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ge[ge.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ge[ge.NOT_FOUND=5]="NOT_FOUND",ge[ge.ALREADY_EXISTS=6]="ALREADY_EXISTS",ge[ge.PERMISSION_DENIED=7]="PERMISSION_DENIED",ge[ge.UNAUTHENTICATED=16]="UNAUTHENTICATED",ge[ge.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ge[ge.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ge[ge.ABORTED=10]="ABORTED",ge[ge.OUT_OF_RANGE=11]="OUT_OF_RANGE",ge[ge.UNIMPLEMENTED=12]="UNIMPLEMENTED",ge[ge.INTERNAL=13]="INTERNAL",ge[ge.UNAVAILABLE=14]="UNAVAILABLE",ge[ge.DATA_LOSS=15]="DATA_LOSS";var mR=null;function ON(){return new TextEncoder}var e$=new Us([4294967295,4294967295],0);function _R(t){let e=ON().encode(t),n=new YM;return n.update(e),new Uint8Array(n.digest())}function yR(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Us([n,r],0),new Us([i,s],0)]}var tw=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ks(`Invalid padding: ${n}`);if(r<0)throw new Ks(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ks(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ks(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=Us.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(Us.fromNumber(r)));return i.compare(e$)===1&&(i=new Us([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let n=_R(e),[r,i]=yR(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;let n=_R(e),[r,i]=yR(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);this.Re(o)}}Re(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},Ks=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Rl=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,Nl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(U.min(),i,new ke(J),an(),te())}},Nl=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,te(),te(),te())}};var ja=class{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}},Zp=class{constructor(e,n){this.targetId=e,this.fe=n}},Xp=class{constructor(e,n,r=mt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},Jp=class{constructor(){this.ge=0,this.pe=xR(),this.ye=mt.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=te(),n=te(),r=te();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:k()}}),new Nl(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=xR()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,L(this.ge>=0)}Le(){this.Se=!0,this.we=!0}},nw=class{constructor(e){this.Be=e,this.ke=new Map,this.qe=an(),this.Qe=vR(),this.Ke=new ke(J)}$e(e){for(let n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(let n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{let r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Le(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:k()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){let n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){let s=i.target;if(Kp(s))if(r===0){let o=new M(s.path);this.We(n,o,ot.newNoDocument(o,U.min()))}else L(r===1);else{let o=this.Ze(n);if(o!==r){let a=this.Xe(e),c=a?this.et(a,e,o):1;if(c!==0){this.He(n);let u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,u)}mR?.tt(function(l,d,h,f,p){var m,v,C,F,T,H;let z={localCacheCount:l,existenceFilterCount:d.count,databaseId:h.database,projectId:h.projectId},Y=d.unchangedNames;return Y&&(z.bloomFilter={applied:p===0,hashCount:(m=Y?.hashCount)!==null&&m!==void 0?m:0,bitmapLength:(F=(C=(v=Y?.bits)===null||v===void 0?void 0:v.bitmap)===null||C===void 0?void 0:C.length)!==null&&F!==void 0?F:0,padding:(H=(T=Y?.bits)===null||T===void 0?void 0:T.padding)!==null&&H!==void 0?H:0,mightContain:be=>{var Xt;return(Xt=f?.mightContain(be))!==null&&Xt!==void 0&&Xt}}),z}(o,e.fe,this.Be.nt(),a,c))}}}}Xe(e){let n=e.fe.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=Ui(r).toUint8Array()}catch(c){if(c instanceof Gp)return Nn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new tw(o,i,s)}catch(c){return Nn(c instanceof Ks?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Te===0?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){let r=this.Be.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Be.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){let n=new Map;this.ke.forEach((s,o)=>{let a=this.Ye(o);if(a){if(s.current&&Kp(a.target)){let c=new M(a.target.path);this.qe.get(c)!==null||this.st(o,c)||this.We(o,c,ot.newNoDocument(c,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=te();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let u=this.Ye(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));let i=new Rl(e,n,this.Ke,this.qe,r);return this.qe=an(),this.Qe=vR(),this.Ke=new ke(J),i}Ue(e,n){if(!this.je(e))return;let r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;let i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){let n=this.ze(e).ve();return this.Be.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new Jp,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new Se(J),this.Qe=this.Qe.insert(e,n)),n}je(e){let n=this.Ye(e)!==null;return n||I("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){let n=this.ke.get(e);return n&&n.be?null:this.Be._t(e)}He(e){this.ke.set(e,new Jp),this.Be.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Be.getRemoteKeysForTarget(e).has(n)}};function vR(){return new ke(M.comparator)}function xR(){return new ke(M.comparator)}var t$={asc:"ASCENDING",desc:"DESCENDING"},n$={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},r$={and:"AND",or:"OR"},rw=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function iw(t,e){return t.useProto3Json||ql(e)?e:{value:e}}function za(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function FN(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function i$(t,e){return za(t,e.toTimestamp())}function Qe(t){return L(!!t),U.fromTimestamp(function(n){let r=Bi(n);return new je(r.seconds,r.nanos)}(t))}function RE(t,e){return sw(t,e).canonicalString()}function sw(t,e){let n=function(i){return new me(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function VN(t){let e=me.fromString(t);return L(WN(e)),e}function Pl(t,e){return RE(t.databaseId,e.path)}function Cr(t,e){let n=VN(e);if(n.get(1)!==t.databaseId.projectId)throw new x(y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new x(y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new M(BN(n))}function LN(t,e){return RE(t.databaseId,e)}function jN(t){let e=VN(t);return e.length===4?me.emptyPath():BN(e)}function ow(t){return new me(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function BN(t){return L(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function wR(t,e,n){return{name:Pl(t,e),fields:n.value.mapValue.fields}}function UN(t,e,n){let r=Cr(t,e.name),i=Qe(e.updateTime),s=e.createTime?Qe(e.createTime):U.min(),o=new kt({mapValue:{fields:e.fields}}),a=ot.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function s$(t,e){return"found"in e?function(r,i){L(!!i.found),i.found.name,i.found.updateTime;let s=Cr(r,i.found.name),o=Qe(i.found.updateTime),a=i.found.createTime?Qe(i.found.createTime):U.min(),c=new kt({mapValue:{fields:i.found.fields}});return ot.newFoundDocument(s,o,a,c)}(t,e):"missing"in e?function(r,i){L(!!i.missing),L(!!i.readTime);let s=Cr(r,i.missing),o=Qe(i.readTime);return ot.newNoDocument(s,o)}(t,e):k()}function o$(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:k()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,l){return u.useProto3Json?(L(l===void 0||typeof l=="string"),mt.fromBase64String(l||"")):(L(l===void 0||l instanceof Uint8Array),mt.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){let l=u.code===void 0?y.UNKNOWN:kN(u.code);return new x(l,u.message||"")}(o);n=new Xp(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Cr(t,r.document.name),s=Qe(r.document.updateTime),o=r.document.createTime?Qe(r.document.createTime):U.min(),a=new kt({mapValue:{fields:r.document.fields}}),c=ot.newFoundDocument(i,s,o,a),u=r.targetIds||[],l=r.removedTargetIds||[];n=new ja(u,l,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Cr(t,r.document),s=r.readTime?Qe(r.readTime):U.min(),o=ot.newNoDocument(i,s),a=r.removedTargetIds||[];n=new ja([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Cr(t,r.document),s=r.removedTargetIds||[];n=new ja([],s,i,null)}else{if(!("filter"in e))return k();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new ew(i,s),a=r.targetId;n=new Zp(a,o)}}return n}function kl(t,e){let n;if(e instanceof zi)n={update:wR(t,e.key,e.value)};else if(e instanceof Wi)n={delete:Pl(t,e.key)};else if(e instanceof Jn)n={update:wR(t,e.key,e.data),updateMask:h$(e.fieldMask)};else{if(!(e instanceof Sl))return k();n={verify:Pl(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof qi)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ei)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ti)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Gi)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw k()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:i$(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:k()}(t,e.precondition)),n}function aw(t,e){let n=e.currentDocument?function(s){return s.updateTime!==void 0?qe.updateTime(Qe(s.updateTime)):s.exists!==void 0?qe.exists(s.exists):qe.none()}(e.currentDocument):qe.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)L(a.setToServerValue==="REQUEST_TIME"),c=new qi;else if("appendMissingElements"in a){let l=a.appendMissingElements.values||[];c=new ei(l)}else if("removeAllFromArray"in a){let l=a.removeAllFromArray.values||[];c=new ti(l)}else"increment"in a?c=new Gi(o,a.increment):k();let u=Ke.fromServerFormat(a.fieldPath);return new eo(u,c)}(t,i)):[];if(e.update){e.update.name;let i=Cr(t,e.update.name),s=new kt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let u=c.fieldPaths||[];return new gn(u.map(l=>Ke.fromServerFormat(l)))}(e.updateMask);return new Jn(i,s,o,n,r)}return new zi(i,s,n,r)}if(e.delete){let i=Cr(t,e.delete);return new Wi(i,n)}if(e.verify){let i=Cr(t,e.verify);return new Sl(i,n)}return k()}function a$(t,e){return t&&t.length>0?(L(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?Qe(i.updateTime):Qe(s);return o.isEqual(U.min())&&(o=Qe(s)),new Xx(o,i.transformResults||[])}(n,e))):[]}function $N(t,e){return{documents:[LN(t,e.path)]}}function HN(t,e){let n={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=LN(t,i);let s=function(u){if(u.length!==0)return zN(Ce.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);let o=function(u){if(u.length!==0)return u.map(l=>function(h){return{field:Pa(h.field),direction:u$(h.dir)}}(l))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);let a=iw(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ut:n,parent:i}}function qN(t){let e=jN(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){L(r===1);let l=n.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];n.where&&(s=function(d){let h=GN(d);return h instanceof Ce&&SE(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(h=>function(p){return new Xs(ka(p.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,ql(h)?null:h}(n.limit));let c=null;n.startAt&&(c=function(d){let h=!!d.before,f=d.values||[];return new Tr(f,h)}(n.startAt));let u=null;return n.endAt&&(u=function(d){let h=!d.before,f=d.values||[];return new Tr(f,h)}(n.endAt)),_N(e,i,o,s,a,"F",c,u)}function c$(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return k()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function GN(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=ka(n.unaryFilter.field);return fe.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=ka(n.unaryFilter.field);return fe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=ka(n.unaryFilter.field);return fe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=ka(n.unaryFilter.field);return fe.create(o,"!=",{nullValue:"NULL_VALUE"});default:return k()}}(t):t.fieldFilter!==void 0?function(n){return fe.create(ka(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return k()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ce.create(n.compositeFilter.filters.map(r=>GN(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return k()}}(n.compositeFilter.op))}(t):k()}function u$(t){return t$[t]}function l$(t){return n$[t]}function d$(t){return r$[t]}function Pa(t){return{fieldPath:t.canonicalString()}}function ka(t){return Ke.fromServerFormat(t.fieldPath)}function zN(t){return t instanceof fe?function(n){if(n.op==="=="){if(iR(n.value))return{unaryFilter:{field:Pa(n.field),op:"IS_NAN"}};if(rR(n.value))return{unaryFilter:{field:Pa(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(iR(n.value))return{unaryFilter:{field:Pa(n.field),op:"IS_NOT_NAN"}};if(rR(n.value))return{unaryFilter:{field:Pa(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Pa(n.field),op:l$(n.op),value:n.value}}}(t):t instanceof Ce?function(n){let r=n.getFilters().map(i=>zN(i));return r.length===1?r[0]:{compositeFilter:{op:d$(n.op),filters:r}}}(t):k()}function h$(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function WN(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var Wa=class t{constructor(e,n,r,i,s=U.min(),o=U.min(),a=mt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var eg=class{constructor(e){this.ct=e}};function f$(t,e){let n;if(e.document)n=UN(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=M.fromSegments(e.noDocument.path),i=no(e.noDocument.readTime);n=ot.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return k();{let r=M.fromSegments(e.unknownDocument.path),i=no(e.unknownDocument.version);n=ot.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){let s=new je(i[0],i[1]);return U.fromTimestamp(s)}(e.readTime)),n}function ER(t,e){let n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:tg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Pl(s,o.key),fields:o.data.value.mapValue.fields,updateTime:za(s,o.version.toTimestamp()),createTime:za(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:to(e.version)};else{if(!e.isUnknownDocument())return k();r.unknownDocument={path:n.path.toArray(),version:to(e.version)}}return r}function tg(t){let e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function to(t){let e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function no(t){let e=new je(t.seconds,t.nanoseconds);return U.fromTimestamp(e)}function Gs(t,e){let n=(e.baseMutations||[]).map(s=>aw(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>aw(t.ct,s)),i=je.fromMillis(e.localWriteTimeMs);return new Al(e.batchId,i,n,r)}function ml(t){let e=no(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?no(t.lastLimboFreeSnapshotVersion):U.min(),r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return L(s.documents.length===1),Wt(ic(jN(s.documents[0])))}(t.query):function(s){return Wt(qN(s))}(t.query),new Wa(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,mt.fromBase64String(t.resumeToken))}function KN(t,e){let n=to(e.snapshotVersion),r=to(e.lastLimboFreeSnapshotVersion),i;i=Kp(e.target)?$N(t.ct,e.target):HN(t.ct,e.target).ut;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Js(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function NE(t){let e=qN({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Yp(e,e.limit,"L"):e}function Ex(t,e){return new Ml(e.largestBatchId,aw(t.ct,e.overlayMutation))}function IR(t,e){let n=e.path.lastSegment();return[t,zt(e.path.popLast()),n]}function CR(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:to(r.readTime),documentKey:zt(r.documentKey.path),largestBatchId:r.largestBatchId}}var cw=class{getBundleMetadata(e,n){return bR(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:no(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return bR(e).put(function(i){return{bundleId:i.id,createTime:to(Qe(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return DR(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:NE(s.bundledQuery),readTime:no(s.readTime)}}(r)})}saveNamedQuery(e,n){return DR(e).put(function(i){return{name:i.name,readTime:to(Qe(i.readTime)),bundledQuery:i.bundledQuery}}(n))}};function bR(t){return _t(t,"bundles")}function DR(t){return _t(t,"namedQueries")}var ng=class t{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){let r=n.uid||"";return new t(e,r)}getOverlay(e,n){return dl(e).get(IR(this.userId,n)).next(r=>r?Ex(this.serializer,r):null)}getOverlays(e,n){let r=Er();return _.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){let i=[];return r.forEach((s,o)=>{let a=new Ml(n,o);i.push(this.ht(e,a))}),_.waitFor(i)}removeOverlaysForBatchId(e,n,r){let i=new Set;n.forEach(o=>i.add(zt(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(dl(e).H("collectionPathOverlayIndex",a))}),_.waitFor(s)}getOverlaysForCollection(e,n,r){let i=Er(),s=zt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return dl(e).W("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let u=Ex(this.serializer,c);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){let s=Er(),o,a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return dl(e).Y({index:"collectionGroupOverlayIndex",range:a},(c,u,l)=>{let d=Ex(this.serializer,u);s.size()<i||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):l.done()}).next(()=>s)}ht(e,n){return dl(e).put(function(i,s,o){let[a,c,u]=IR(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:kl(i.ct,o.mutation)}}(this.serializer,this.userId,n))}};function dl(t){return _t(t,"documentOverlays")}var Zr=class{constructor(){}Pt(e,n){this.It(e,n),n.Tt()}It(e,n){if("nullValue"in e)this.Et(n,5);else if("booleanValue"in e)this.Et(n,10),n.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(n,15),n.dt(He(e.integerValue));else if("doubleValue"in e){let r=He(e.doubleValue);isNaN(r)?this.Et(n,13):(this.Et(n,15),Il(r)?n.dt(0):n.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(n,20),typeof r=="string"?n.At(r):(n.At(`${r.seconds||""}`),n.dt(r.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,n),this.Vt(n);else if("bytesValue"in e)this.Et(n,30),n.ft(Ui(e.bytesValue)),this.Vt(n);else if("referenceValue"in e)this.gt(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(n,45),n.dt(r.latitude||0),n.dt(r.longitude||0)}else"mapValue"in e?lN(e)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,n),this.Vt(n)):"arrayValue"in e?(this.wt(e.arrayValue,n),this.Vt(n)):k()}Rt(e,n){this.Et(n,25),this.St(e,n)}St(e,n){n.At(e)}yt(e,n){let r=e.fields||{};this.Et(n,55);for(let i of Object.keys(r))this.Rt(i,n),this.It(r[i],n)}wt(e,n){let r=e.values||[];this.Et(n,50);for(let i of r)this.It(i,n)}gt(e,n){this.Et(n,37),M.fromName(e).path.forEach(r=>{this.Et(n,60),this.St(r,n)})}Et(e,n){e.dt(n)}Vt(e){e.dt(2)}};Zr.bt=new Zr;function p$(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function TR(t){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=p$(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}var uw=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Ct(r.value),r=n.next();this.vt()}Ft(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Mt(r.value),r=n.next();this.xt()}Ot(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=n.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=n.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Lt(e){let n=this.Bt(e),r=TR(n);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}qt(e){let n=this.Bt(e),r=TR(n);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){let n=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ct(e){let n=255&e;n===0?(this.Kt(0),this.Kt(255)):n===255?(this.Kt(255),this.Kt(0)):this.Kt(n)}Mt(e){let n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},lw=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}},dw=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},zs=class{constructor(){this.Gt=new uw,this.zt=new lw(this.Gt),this.jt=new dw(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var Ws=class t{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}};function Pi(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=SR(t.arrayValue,e.arrayValue),n!==0?n:(n=SR(t.directionalValue,e.directionalValue),n!==0?n:M.comparator(t.documentKey,e.documentKey)))}function SR(t,e){for(let n=0;n<t.length&&n<e.length;++n){let r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}var rg=class{constructor(e){this.Yt=new Se((n,r)=>Ke.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let n of e.filters){let r=n;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(L(e.collectionGroup===this.collectionId),this.en)return!1;let n=Px(e);if(n!==void 0&&!this.nn(n))return!1;let r=Hs(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.rn(a,c)||!this.sn(this.Zt[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new Se(Ke.comparator),n=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Va(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Va(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Va(r.field,r.dir==="asc"?0:1)));return new Ua(Ua.UNKNOWN_ID,this.collectionId,n,El.empty())}nn(e){for(let n of this.Xt)if(this.rn(n,e))return!0;return!1}rn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}sn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}};function QN(t){var e,n;if(L(t instanceof fe||t instanceof Ce),t instanceof fe){if(t instanceof Wp){let i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>fe.create(t.field,"==",s)))||[];return Ce.create(i,"or")}return t}let r=t.filters.map(i=>QN(i));return Ce.create(r,t.op)}function g$(t){if(t.getFilters().length===0)return[];let e=pw(QN(t));return L(YN(e)),hw(e)||fw(e)?[e]:e.getFilters()}function hw(t){return t instanceof fe}function fw(t){return t instanceof Ce&&SE(t)}function YN(t){return hw(t)||fw(t)||function(n){if(n instanceof Ce&&Ux(n)){for(let r of n.getFilters())if(!hw(r)&&!fw(r))return!1;return!0}return!1}(t)}function pw(t){if(L(t instanceof fe||t instanceof Ce),t instanceof fe)return t;if(t.filters.length===1)return pw(t.filters[0]);let e=t.filters.map(r=>pw(r)),n=Ce.create(e,t.op);return n=ig(n),YN(n)?n:(L(n instanceof Ce),L(Ha(n)),L(n.filters.length>1),n.filters.reduce((r,i)=>PE(r,i)))}function PE(t,e){let n;return L(t instanceof fe||t instanceof Ce),L(e instanceof fe||e instanceof Ce),n=t instanceof fe?e instanceof fe?function(i,s){return Ce.create([i,s],"and")}(t,e):AR(t,e):e instanceof fe?AR(e,t):function(i,s){if(L(i.filters.length>0&&s.filters.length>0),Ha(i)&&Ha(s))return pN(i,s.getFilters());let o=Ux(i)?i:s,a=Ux(i)?s:i,c=o.filters.map(u=>PE(u,a));return Ce.create(c,"or")}(t,e),ig(n)}function AR(t,e){if(Ha(e))return pN(e,t.getFilters());{let n=e.filters.map(r=>PE(t,r));return Ce.create(n,"or")}}function ig(t){if(L(t instanceof fe||t instanceof Ce),t instanceof fe)return t;let e=t.getFilters();if(e.length===1)return ig(e[0]);if(hN(t))return t;let n=e.map(i=>ig(i)),r=[];return n.forEach(i=>{i instanceof fe?r.push(i):i instanceof Ce&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Ce.create(r,t.op)}var gw=class{constructor(){this._n=new Ol}addToCollectionParentIndex(e,n){return this._n.add(n),_.resolve()}getCollectionParents(e,n){return _.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return _.resolve()}deleteFieldIndex(e,n){return _.resolve()}deleteAllFieldIndexes(e){return _.resolve()}createTargetIndexes(e,n){return _.resolve()}getDocumentsMatchingTarget(e,n){return _.resolve(null)}getIndexType(e,n){return _.resolve(0)}getFieldIndexes(e,n){return _.resolve([])}getNextCollectionGroupToUpdate(e){return _.resolve(null)}getMinOffset(e,n){return _.resolve(Pn.min())}getMinOffsetFromCollectionGroup(e,n){return _.resolve(Pn.min())}updateCollectionGroup(e,n,r){return _.resolve()}updateIndexEntries(e,n){return _.resolve()}},Ol=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Se(me.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Se(me.comparator)).toArray()}};var Ap=new Uint8Array(0),mw=class{constructor(e,n){this.databaseId=n,this.an=new Ol,this.un=new Sr(r=>Js(r),(r,i)=>Gl(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.an.has(n)){let r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.an.add(n)});let s={collectionId:r,parent:zt(i)};return MR(e).put(s)}return _.resolve()}getCollectionParents(e,n){let r=[],i=IDBKeyRange.bound([n,""],[JR(n),""],!1,!0);return MR(e).W(i).next(s=>{for(let o of s){if(o.collectionId!==n)break;r.push(wr(o.parent))}return r})}addFieldIndex(e,n){let r=hl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete i.indexId;let s=r.add(i);if(n.indexState){let o=Aa(e);return s.next(a=>{o.put(CR(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){let r=hl(e),i=Aa(e),s=Sa(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let n=hl(e),r=Sa(e),i=Aa(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return _.forEach(this.cn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new rg(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){let r=Sa(e),i=!0,s=new Map;return _.forEach(this.cn(n),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=te(),a=[];return _.forEach(s,(c,u)=>{I("IndexedDbIndexManager",`Using index ${function(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(H=>`${H.fieldPath}:${H.kind}`).join(",")}`}(c)} to execute ${Js(n)}`);let l=function(T,H){let z=Px(H);if(z===void 0)return null;for(let Y of Qp(T,z.fieldPath))switch(Y.op){case"array-contains-any":return Y.value.arrayValue.values||[];case"array-contains":return[Y.value]}return null}(u,c),d=function(T,H){let z=new Map;for(let Y of Hs(H))for(let be of Qp(T,Y.fieldPath))switch(be.op){case"==":case"in":z.set(Y.fieldPath.canonicalString(),be.value);break;case"not-in":case"!=":return z.set(Y.fieldPath.canonicalString(),be.value),Array.from(z.values())}return null}(u,c),h=function(T,H){let z=[],Y=!0;for(let be of Hs(H)){let Xt=be.kind===0?uR(T,be.fieldPath,T.startAt):lR(T,be.fieldPath,T.startAt);z.push(Xt.value),Y&&(Y=Xt.inclusive)}return new Tr(z,Y)}(u,c),f=function(T,H){let z=[],Y=!0;for(let be of Hs(H)){let Xt=be.kind===0?lR(T,be.fieldPath,T.endAt):uR(T,be.fieldPath,T.endAt);z.push(Xt.value),Y&&(Y=Xt.inclusive)}return new Tr(z,Y)}(u,c),p=this.hn(c,u,h),m=this.hn(c,u,f),v=this.Pn(c,u,d),C=this.In(c.indexId,l,p,h.inclusive,m,f.inclusive,v);return _.forEach(C,F=>r.j(F,n.limit).next(T=>{T.forEach(H=>{let z=M.fromSegments(H.documentKey);o.has(z)||(o=o.add(z),a.push(z))})}))}).next(()=>a)}return _.resolve(null)})}cn(e){let n=this.un.get(e);return n||(e.filters.length===0?n=[e]:n=g$(Ce.create(e.filters,"and")).map(r=>Yx(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,n),n)}In(e,n,r,i,s,o,a){let c=(n!=null?n.length:1)*Math.max(r.length,s.length),u=c/(n!=null?n.length:1),l=[];for(let d=0;d<c;++d){let h=n?this.Tn(n[d/u]):Ap,f=this.En(e,h,r[d%u],i),p=this.dn(e,h,s[d%u],o),m=a.map(v=>this.En(e,h,v,!0));l.push(...this.createRange(f,p,m))}return l}En(e,n,r,i){let s=new Ws(e,M.empty(),n,r);return i?s:s.Jt()}dn(e,n,r,i){let s=new Ws(e,M.empty(),n,r);return i?s.Jt():s}ln(e,n){let r=new rg(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2,i=this.cn(n);return _.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let u=new Se(Ke.comparator),l=!1;for(let d of c.filters)for(let h of d.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?l=!0:u=u.add(h.field));for(let d of c.orderBy)d.field.isKeyField()||(u=u.add(d.field));return u.size+(l?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}An(e,n){let r=new zs;for(let i of Hs(e)){let s=n.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);Zr.bt.Pt(s,o)}return r.Wt()}Tn(e){let n=new zs;return Zr.bt.Pt(e,n.Ht(0)),n.Wt()}Rn(e,n){let r=new zs;return Zr.bt.Pt(Zs(this.databaseId,n),r.Ht(function(s){let o=Hs(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,n,r){if(r===null)return[];let i=[];i.push(new zs);let s=0;for(let o of Hs(e)){let a=r[s++];for(let c of i)if(this.Vn(n,o.fieldPath)&&Tl(a))i=this.mn(i,o,a);else{let u=c.Ht(o.kind);Zr.bt.Pt(a,u)}}return this.fn(i)}hn(e,n,r){return this.Pn(e,n,r.position)}fn(e){let n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Wt();return n}mn(e,n,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new zs;c.seed(a.Wt()),Zr.bt.Pt(o,c.Ht(n.kind)),s.push(c)}return s}Vn(e,n){return!!e.filters.find(r=>r instanceof fe&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){let r=hl(e),i=Aa(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{let o=[];return _.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(l,d){let h=d?new El(d.sequenceNumber,new Pn(no(d.readTime),new M(wr(d.documentKey)),d.largestBatchId)):El.empty(),f=l.fields.map(([p,m])=>new Va(Ke.fromServerFormat(p),m));return new Ua(l.indexId,l.collectionGroup,f,h)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:J(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){let i=hl(e),s=Aa(e);return this.gn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>_.forEach(a,c=>s.put(CR(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){let r=new Map;return _.forEach(n,(i,s)=>{let o=r.get(i.collectionGroup);return(o?_.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),_.forEach(a,c=>this.pn(e,i,c).next(u=>{let l=this.yn(s,c);return u.isEqual(l)?_.resolve():this.wn(e,s,c,u,l)}))))})}Sn(e,n,r,i){return Sa(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,n.key),documentKey:n.key.path.toArray()})}bn(e,n,r,i){return Sa(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,n.key),n.key.path.toArray()])}pn(e,n,r){let i=Sa(e),s=new Se(Pi);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,n)])},(o,a)=>{s=s.add(new Ws(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,n){let r=new Se(Pi),i=this.An(n,e);if(i==null)return r;let s=Px(n);if(s!=null){let o=e.data.field(s.fieldPath);if(Tl(o))for(let a of o.arrayValue.values||[])r=r.add(new Ws(n.indexId,e.key,this.Tn(a),i))}else r=r.add(new Ws(n.indexId,e.key,Ap,i));return r}wn(e,n,r,i,s){I("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);let o=[];return function(c,u,l,d,h){let f=c.getIterator(),p=u.getIterator(),m=Ta(f),v=Ta(p);for(;m||v;){let C=!1,F=!1;if(m&&v){let T=l(m,v);T<0?F=!0:T>0&&(C=!0)}else m!=null?F=!0:C=!0;C?(d(v),v=Ta(p)):F?(h(m),m=Ta(f)):(m=Ta(f),v=Ta(p))}}(i,s,Pi,a=>{o.push(this.Sn(e,n,r,a))},a=>{o.push(this.bn(e,n,r,a))}),_.waitFor(o)}gn(e){let n=1;return Aa(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Pi(o,a)).filter((o,a,c)=>!a||Pi(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=Pi(o,e),c=Pi(o,n);if(a===0)i[0]=e.Jt();else if(a>0&&c<0)i.push(o),i.push(o.Jt());else if(c>0)break}i.push(n);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Ap,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Ap,[]];s.push(IDBKeyRange.bound(a,c))}return s}Dn(e,n){return Pi(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(RR)}getMinOffset(e,n){return _.mapArray(this.cn(n),r=>this.ln(e,r).next(i=>i||k())).next(RR)}};function MR(t){return _t(t,"collectionParents")}function Sa(t){return _t(t,"indexEntries")}function hl(t){return _t(t,"indexConfiguration")}function Aa(t){return _t(t,"indexState")}function RR(t){L(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){let i=t[r].indexState.offset;bE(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Pn(e.readTime,e.documentKey,n)}var NR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Rn=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function ZN(t,e,n){let r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId),a=0,c=r.Y({range:o},(l,d,h)=>(a++,h.delete()));s.push(c.next(()=>{L(a===1)}));let u=[];for(let l of n.mutations){let d=iN(e,l.key.path,n.batchId);s.push(i.delete(d)),u.push(l.key)}return _.waitFor(s).next(()=>u)}function sg(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw k();e=t.noDocument}return JSON.stringify(e).length}Rn.DEFAULT_COLLECTION_PERCENTILE=10,Rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Rn.DEFAULT=new Rn(41943040,Rn.DEFAULT_COLLECTION_PERCENTILE,Rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Rn.DISABLED=new Rn(-1,0,0);var og=class t{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,n,r,i){L(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new t(s,n,r,i)}checkEmpty(e){let n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ki(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){let s=Oa(e),o=ki(e);return o.add({}).next(a=>{L(typeof a=="number");let c=new Al(a,n,r,i),u=function(f,p,m){let v=m.baseMutations.map(F=>kl(f.ct,F)),C=m.mutations.map(F=>kl(f.ct,F));return{userId:p,batchId:m.batchId,localWriteTimeMs:m.localWriteTime.toMillis(),baseMutations:v,mutations:C}}(this.serializer,this.userId,c),l=[],d=new Se((h,f)=>J(h.canonicalString(),f.canonicalString()));for(let h of i){let f=iN(this.userId,h.key.path,a);d=d.add(h.key.path.popLast()),l.push(o.put(u)),l.push(s.put(f,E9))}return d.forEach(h=>{l.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Cn[a]=c.keys()}),_.waitFor(l).next(()=>c)})}lookupMutationBatch(e,n){return ki(e).get(n).next(r=>r?(L(r.userId===this.userId),Gs(this.serializer,r)):null)}vn(e,n){return this.Cn[n]?_.resolve(this.Cn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){let i=r.keys();return this.Cn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return ki(e).Y({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(L(a.batchId>=r),s=Gs(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return ki(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ki(e).W("userMutationsIndex",n).next(r=>r.map(i=>Gs(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){let r=Pp(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Oa(e).Y({range:i},(o,a,c)=>{let[u,l,d]=o,h=wr(l);if(u===this.userId&&n.path.isEqual(h))return ki(e).get(d).next(f=>{if(!f)throw k();L(f.userId===this.userId),s.push(Gs(this.serializer,f))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Se(J),i=[];return n.forEach(s=>{let o=Pp(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=Oa(e).Y({range:a},(u,l,d)=>{let[h,f,p]=u,m=wr(f);h===this.userId&&s.path.isEqual(m)?r=r.add(p):d.done()});i.push(c)}),_.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=Pp(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new Se(J);return Oa(e).Y({range:o},(c,u,l)=>{let[d,h,f]=c,p=wr(h);d===this.userId&&r.isPrefixOf(p)?p.length===i&&(a=a.add(f)):l.done()}).next(()=>this.Fn(e,a))}Fn(e,n){let r=[],i=[];return n.forEach(s=>{i.push(ki(e).get(s).next(o=>{if(o===null)throw k();L(o.userId===this.userId),r.push(Gs(this.serializer,o))}))}),_.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return ZN(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Mn(n.batchId)}),_.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return _.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Oa(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=wr(s[1]);i.push(c)}else a.done()}).next(()=>{L(i.length===0)})})}containsKey(e,n){return XN(e,this.userId,n)}xn(e){return JN(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function XN(t,e,n){let r=Pp(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return Oa(t).Y({range:s,J:!0},(a,c,u)=>{let[l,d,h]=a;l===e&&d===i&&(o=!0),u.done()}).next(()=>o)}function ki(t){return _t(t,"mutations")}function Oa(t){return _t(t,"documentMutations")}function JN(t){return _t(t,"mutationQueues")}var Ka=class t{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new t(0)}static Ln(){return new t(-1)}};var _w=class{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Bn(e).next(n=>{let r=new Ka(n.highestTargetId);return n.highestTargetId=r.next(),this.kn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(n=>U.fromTimestamp(new je(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.kn(e,i)))}addTargetData(e,n){return this.qn(e,n).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.Qn(n,r),this.kn(e,r))))}updateTargetData(e,n){return this.qn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Ma(e).delete(n.targetId)).next(()=>this.Bn(e)).next(r=>(L(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,n,r){let i=0,s=[];return Ma(e).Y((o,a)=>{let c=ml(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>_.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Ma(e).Y((r,i)=>{let s=ml(i);n(s)})}Bn(e){return PR(e).get("targetGlobalKey").next(n=>(L(n!==null),n))}kn(e,n){return PR(e).put("targetGlobalKey",n)}qn(e,n){return Ma(e).put(KN(this.serializer,n))}Qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(n=>n.targetCount)}getTargetData(e,n){let r=Js(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return Ma(e).Y({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let u=ml(a);Gl(n,u.target)&&(s=u,c.done())}).next(()=>s)}addMatchingKeys(e,n,r){let i=[],s=Oi(e);return n.forEach(o=>{let a=zt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),_.waitFor(i)}removeMatchingKeys(e,n,r){let i=Oi(e);return _.forEach(n,s=>{let o=zt(s.path);return _.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){let r=Oi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){let r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Oi(e),s=te();return i.Y({range:r,J:!0},(o,a,c)=>{let u=wr(o[1]),l=new M(u);s=s.add(l)}).next(()=>s)}containsKey(e,n){let r=zt(n.path),i=IDBKeyRange.bound([r],[JR(r)],!1,!0),s=0;return Oi(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],c,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}_t(e,n){return Ma(e).get(n).next(r=>r?ml(r):null)}};function Ma(t){return _t(t,"targets")}function PR(t){return _t(t,"targetGlobal")}function Oi(t){return _t(t,"targetDocuments")}function kR([t,e],[n,r]){let i=J(t,n);return i===0?J(e,r):i}var yw=class{constructor(e){this.Kn=e,this.buffer=new Se(kR),this.$n=0}Un(){return++this.$n}Wn(e){let n=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();kR(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},vw=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){I("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>g(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(n){Yi(n)?I("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield Qi(n)}yield this.zn(3e5)}))}},xw=class{constructor(e,n){this.jn=e,this.params=n}calculateTargetCount(e,n){return this.jn.Hn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return _.resolve(pn._e);let r=new yw(n);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(I("LruGarbageCollector","Garbage collection skipped; disabled"),_.resolve(NR)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(I("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),NR):this.Yn(e,n))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,n){let r,i,s,o,a,c,u,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(I("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(u=Date.now(),Ra()<=wn.DEBUG&&I("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-l}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${d} documents in `+(u-c)+`ms
Total Duration: ${u-l}ms`),_.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}};function m$(t,e){return new xw(t,e)}var ww=class{constructor(e,n){this.db=e,this.garbageCollector=m$(this,n)}Hn(e){let n=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Zn(e){let n=0;return this.Jn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Jn(e,n){return this.Xn(e,(r,i)=>n(i))}addReference(e,n,r){return Mp(e,r)}removeReference(e,n,r){return Mp(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Mp(e,n)}er(e,n){return function(i,s){let o=!1;return JN(i).Z(a=>XN(i,a,s).next(c=>(c&&(o=!0),_.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=n){let c=this.er(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,U.min()),Oi(e).delete(function(d){return[0,zt(d.path)]}(o))))});i.push(c)}}).next(()=>_.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Mp(e,n)}Xn(e,n){let r=Oi(e),i,s=pn._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:u})=>{o===0?(s!==pn._e&&n(new M(wr(i)),s),s=u,i=c):s=pn._e}).next(()=>{s!==pn._e&&n(new M(wr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Mp(t,e){return Oi(t).put(function(r,i){return{targetId:0,path:zt(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}var ag=class{constructor(){this.changes=new Sr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ot.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?_.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Ew=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return $s(e).put(r)}removeEntry(e,n,r){return $s(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],tg(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.tr(e,r)))}getEntry(e,n){let r=ot.newInvalidDocument(n);return $s(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(fl(n))},(i,s)=>{r=this.nr(n,s)}).next(()=>r)}rr(e,n){let r={size:0,document:ot.newInvalidDocument(n)};return $s(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(fl(n))},(i,s)=>{r={document:this.nr(n,s),size:sg(s)}}).next(()=>r)}getEntries(e,n){let r=an();return this.ir(e,n,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,n){let r=an(),i=new ke(M.comparator);return this.ir(e,n,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,sg(o))}).next(()=>({documents:r,_r:i}))}ir(e,n,r){if(n.isEmpty())return _.resolve();let i=new Se(VR);n.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(fl(i.first()),fl(i.last())),o=i.getIterator(),a=o.getNext();return $s(e).Y({index:"documentKeyIndex",range:s},(c,u,l)=>{let d=M.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&VR(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?l.U(fl(a)):l.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){let o=n.path,a=[o.popLast().toArray(),o.lastSegment(),tg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return $s(e).W(IDBKeyRange.bound(a,c,!0)).next(u=>{s?.incrementDocumentReadCount(u.length);let l=an();for(let d of u){let h=this.nr(M.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);h.isFoundDocument()&&(Wl(n,h)||i.has(h.key))&&(l=l.insert(h.key,h))}return l})}getAllFromCollectionGroup(e,n,r,i){let s=an(),o=FR(n,r),a=FR(n,Pn.max());return $s(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,u,l)=>{let d=this.nr(M.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(d.key,d),s.size===i&&l.done()}).next(()=>s)}newChangeBuffer(e){return new Iw(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return OR(e).get("remoteDocumentGlobalKey").next(n=>(L(!!n),n))}tr(e,n){return OR(e).put("remoteDocumentGlobalKey",n)}nr(e,n){if(n){let r=f$(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(U.min())))return r}return ot.newInvalidDocument(e)}};function eP(t){return new Ew(t)}var Iw=class extends ag{constructor(e,n){super(),this.ar=e,this.trackRemovals=n,this.ur=new Sr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let n=[],r=0,i=new Se((s,o)=>J(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(n.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=ER(this.ar.serializer,o);i=i.add(s.path.popLast());let u=sg(c);r+=u-a.size,n.push(this.ar.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=ER(this.ar.serializer,o.convertToNoDocument(U.min()));n.push(this.ar.addEntry(e,s,c))}}),i.forEach(s=>{n.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.ar.updateMetadata(e,r)),_.waitFor(n)}getFromCache(e,n){return this.ar.rr(e,n).next(r=>(this.ur.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.ar.sr(e,n).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function OR(t){return _t(t,"remoteDocumentGlobal")}function $s(t){return _t(t,"remoteDocumentsV14")}function fl(t){let e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function FR(t,e){let n=e.documentKey.path.toArray();return[t,tg(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function VR(t,e){let n=t.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=J(n[s],r[s]),i)return i;return i=J(n.length,r.length),i||(i=J(n[n.length-2],r[r.length-2]),i||J(n[n.length-1],r[r.length-1]))}var Cw=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var cg=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&vl(r.mutation,i,gn.empty(),je.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,te()).next(()=>r))}getLocalViewOfDocuments(e,n,r=te()){let i=Er();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=gl();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=Er();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,te()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=an(),o=yl(),a=function(){return yl()}();return n.forEach((c,u)=>{let l=r.get(u.key);i.has(u.key)&&(l===void 0||l.mutation instanceof Jn)?s=s.insert(u.key,u):l!==void 0?(o.set(u.key,l.mutation.getFieldMask()),vl(l.mutation,u,l.mutation.getFieldMask(),je.now())):o.set(u.key,gn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,l)=>o.set(u,l)),n.forEach((u,l)=>{var d;return a.set(u,new Cw(l,(d=o.get(u))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){let r=yl(),i=new ke((o,a)=>o-a),s=te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(c=>{let u=n.get(c);if(u===null)return;let l=r.get(c)||gn.empty();l=a.applyToLocalView(u,l),r.set(c,l);let d=(i.get(a.batchId)||te()).add(c);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),u=c.key,l=c.value,d=IN();l.forEach(h=>{if(!s.has(h)){let f=RN(n.get(h),r.get(h));f!==null&&d.set(h,f),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,d))}return _.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return M.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):AE(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):_.resolve(Er()),a=-1,c=s;return o.next(u=>_.forEach(u,(l,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(l)?_.resolve():this.remoteDocumentCache.getEntry(e,l).next(h=>{c=c.insert(l,h)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,te())).next(l=>({batchId:a,changes:EN(l)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new M(n)).next(r=>{let i=gl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=gl();return this.indexManager.getCollectionParents(e,s).next(a=>_.forEach(a,c=>{let u=function(d,h){return new Xn(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(l=>{l.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((c,u)=>{let l=u.getKey();o.get(l)===null&&(o=o.insert(l,ot.newInvalidDocument(l)))});let a=gl();return o.forEach((c,u)=>{let l=s.get(c);l!==void 0&&vl(l.mutation,u,gn.empty(),je.now()),Wl(n,u)&&(a=a.insert(c,u))}),a})}};var bw=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return _.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Qe(i.createTime)}}(n)),_.resolve()}getNamedQuery(e,n){return _.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(i){return{name:i.name,query:NE(i.bundledQuery),readTime:Qe(i.readTime)}}(n)),_.resolve()}};var Dw=class{constructor(){this.overlays=new ke(M.comparator),this.hr=new Map}getOverlay(e,n){return _.resolve(this.overlays.get(n))}getOverlays(e,n){let r=Er();return _.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),_.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),_.resolve()}getOverlaysForCollection(e,n,r){let i=Er(),s=n.length+1,o=new M(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return _.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new ke((u,l)=>u-l),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let l=s.get(u.largestBatchId);l===null&&(l=Er(),s=s.insert(u.largestBatchId,l)),l.set(u.getKey(),u)}}let a=Er(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,l)=>a.set(u,l)),!(a.size()>=i)););return _.resolve(a)}ht(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Ml(n,r));let s=this.hr.get(n);s===void 0&&(s=te(),this.hr.set(n,s)),this.hr.set(n,s.add(r.key))}};var Fl=class{constructor(){this.Pr=new Se(rt.Ir),this.Tr=new Se(rt.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){let r=new rt(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new rt(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){let n=new M(new me([])),r=new rt(n,e),i=new rt(n,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let n=new M(new me([])),r=new rt(n,e),i=new rt(n,e+1),s=te();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new rt(e,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},rt=class{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return M.comparator(e.key,n.key)||J(e.pr,n.pr)}static Er(e,n){return J(e.pr,n.pr)||M.comparator(e.key,n.key)}};var Tw=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new Se(rt.Ir)}checkEmpty(e){return _.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Al(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new rt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return _.resolve(o)}lookupMutationBatch(e,n){return _.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.br(r),s=i<0?0:i;return _.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return _.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return _.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new rt(n,0),i=new rt(n,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),_.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Se(J);return n.forEach(i=>{let s=new rt(i,0),o=new rt(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),_.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;M.isDocumentKey(s)||(s=s.child(""));let o=new rt(new M(s),0),a=new Se(J);return this.wr.forEachWhile(c=>{let u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.pr)),!0)},o),_.resolve(this.Dr(a))}Dr(e){let n=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){L(this.Cr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return _.forEach(n.mutations,i=>{let s=new rt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){let r=new rt(n,0),i=this.wr.firstAfterOrEqual(r);return _.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,_.resolve()}Cr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var Sw=class{constructor(e){this.vr=e,this.docs=function(){return new ke(M.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return _.resolve(r?r.document.mutableCopy():ot.newInvalidDocument(n))}getEntries(e,n){let r=an();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ot.newInvalidDocument(i))}),_.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=an(),o=n.path,a=new M(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:u,value:{document:l}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||bE(tN(l),r)<=0||(i.has(l.key)||Wl(n,l))&&(s=s.insert(l.key,l.mutableCopy()))}return _.resolve(s)}getAllFromCollectionGroup(e,n,r,i){k()}Fr(e,n){return _.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Aw(this)}getSize(e){return _.resolve(this.size)}},Aw=class extends ag{constructor(e){super(),this.ar=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),_.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}};var Mw=class{constructor(e){this.persistence=e,this.Mr=new Sr(n=>Js(n),Gl),this.lastRemoteSnapshotVersion=U.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Fl,this.targetCount=0,this.Lr=Ka.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,i)=>n(i)),_.resolve()}getLastRemoteSnapshotVersion(e){return _.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return _.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),_.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),_.resolve()}qn(e){this.Mr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Lr=new Ka(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,_.resolve()}updateTargetData(e,n){return this.qn(n),_.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,_.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),_.waitFor(s).next(()=>i)}getTargetCount(e){return _.resolve(this.targetCount)}getTargetData(e,n){let r=this.Mr.get(n)||null;return _.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),_.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),_.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),_.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Nr.gr(n);return _.resolve(r)}containsKey(e,n){return _.resolve(this.Nr.containsKey(n))}};var ug=class{constructor(e,n){this.Br={},this.overlays={},this.kr=new pn(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new Mw(this),this.indexManager=new gw,this.remoteDocumentCache=function(i){return new Sw(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new eg(n),this.$r=new bw(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Dw,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new Tw(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){I("MemoryPersistence","Starting transaction:",e);let i=new Rw(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,n){return _.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}},Rw=class extends $p{constructor(e){super(),this.currentSequenceNumber=e}},lg=class t{constructor(e){this.persistence=e,this.zr=new Fl,this.jr=null}static Hr(e){return new t(e)}get Jr(){if(this.jr)return this.jr;throw k()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),_.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),_.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),_.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return _.forEach(this.Jr,r=>{let i=M.fromPath(r);return this.Yr(e,i).next(s=>{s||n.removeEntry(i,U.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return _.or([()=>_.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}};var Nw=class{constructor(e){this.serializer=e}N(e,n,r,i){let s=new Hp("createOrUpgrade",n);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",eR,{unique:!0}),c.createObjectStore("documentMutations")}(e),LR(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=_.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),LR(e)),o=o.next(()=>function(c){let u=c.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:U.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",l)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,u){return u.store("mutations").W().next(l=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",eR,{unique:!0});let d=u.store("mutations"),h=l.map(f=>d.put(f));return _.waitFor(h)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let u=c.createObjectStore("documentOverlays",{keyPath:k9});u.createIndex("collectionPathOverlayIndex",O9,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",F9,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let u=c.createObjectStore("remoteDocumentsV14",{keyPath:I9});u.createIndex("documentKeyIndex",C9),u.createIndex("collectionGroupIndex",b9)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:M9}).createIndex("sequenceNumberIndex",R9,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:N9}).createIndex("documentKeyIndex",P9,{unique:!1})}(e))),o}ei(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=sg(i)}).next(()=>{let r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>_.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>_.forEach(a,c=>{L(c.userId===s.userId);let u=Gs(this.serializer,c);return ZN(e,s.userId,u).next(()=>{})}))}))}ti(e){let n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.Y((o,a)=>{let c=new me(o),u=function(d){return[0,zt(d)]}(c);s.push(n.get(u).next(l=>l?_.resolve():(d=>n.put({targetId:0,path:zt(d),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>_.waitFor(s))})}ni(e,n){e.createObjectStore("collectionParents",{keyPath:A9});let r=n.store("collectionParents"),i=new Ol,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:zt(c)})}};return n.store("remoteDocuments").Y({J:!0},(o,a)=>{let c=new me(o);return s(c.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([o,a,c],u)=>{let l=wr(a);return s(l.popLast())}))}ri(e){let n=e.store("targets");return n.Y((r,i)=>{let s=ml(i),o=KN(this.serializer,s);return n.put(o)})}ii(e,n){let r=n.store("remoteDocuments"),i=[];return r.Y((s,o)=>{let a=n.store("remoteDocumentsV14"),c=function(d){return d.document?new M(me.fromString(d.document.name).popFirst(5)):d.noDocument?M.fromSegments(d.noDocument.path):d.unknownDocument?M.fromSegments(d.unknownDocument.path):k()}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>_.waitFor(i))}si(e,n){let r=n.store("mutations"),i=eP(this.serializer),s=new ug(lg.Hr,this.serializer.ct);return r.W().next(o=>{let a=new Map;return o.forEach(c=>{var u;let l=(u=a.get(c.userId))!==null&&u!==void 0?u:te();Gs(this.serializer,c).keys().forEach(d=>l=l.add(d)),a.set(c.userId,l)}),_.forEach(a,(c,u)=>{let l=new it(u),d=ng.lt(this.serializer,l),h=s.getIndexManager(l),f=og.lt(l,this.serializer,h,s.referenceDelegate);return new cg(i,f,d,h).recalculateAndSaveOverlaysForDocumentKeys(new Cl(n,pn._e),c).next()})})}};function LR(t){t.createObjectStore("targetDocuments",{keyPath:T9}).createIndex("documentTargetsIndex",S9,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",D9,{unique:!0}),t.createObjectStore("targetGlobal")}var Ix="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Pw=class t{constructor(e,n,r,i,s,o,a,c,u,l,d=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=u,this.ai=l,this.ui=d,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=h=>Promise.resolve(),!t.D())throw new x(y.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new ww(this,i),this.Ti=n+"main",this.serializer=new eg(c),this.Ei=new Jr(this.Ti,this.ui,new Nw(this.serializer)),this.Qr=new _w(this.referenceDelegate,this.serializer),this.remoteDocumentCache=eP(this.serializer),this.$r=new cw,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,l===!1&&We("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new x(y.FAILED_PRECONDITION,Ix);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new pn(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=n=>g(this,null,function*(){if(this.started)return e(n)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.B(n=>g(this,null,function*(){n.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>g(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Rp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(n=>{n||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(n=>this.isPrimary&&!n?this.yi(e).next(()=>!1):!!n&&this.wi(e).next(()=>!0))).catch(e=>{if(Yi(e))return I("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return I("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return pl(e).get("owner").next(n=>_.resolve(this.Si(n)))}bi(e){return Rp(e).delete(this.clientId)}Di(){return g(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{let r=_t(n,"clientMetadata");return r.W().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return _.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let n of e)this.di.removeItem(this.Fi(n.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?_.resolve(!0):pl(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)){if(this.Si(n)&&this.networkEnabled)return!0;if(!this.Si(n)){if(!n.allowTabSynchronization)throw new x(y.FAILED_PRECONDITION,Ix);return!1}}return!(!this.networkEnabled||!this.inForeground)||Rp(e).W().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&I("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return g(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let n=new Cl(e,pn._e);return this.yi(n).next(()=>this.bi(n))}),this.Ei.close(),this.Li()})}vi(e,n){return e.filter(r=>this.Ci(r.updateTimeMs,n)&&!this.Mi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>Rp(e).W().next(n=>this.vi(n,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,n){return og.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new mw(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return ng.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,n,r){I("IndexedDbPersistence","Starting transaction:",e);let i=n==="readonly"?"readonly":"readwrite",s=function(c){return c===15?L9:c===14?aN:c===13?oN:c===12?V9:c===11?sN:void k()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new Cl(a,this.kr?this.kr.next():pn._e),n==="readwrite-primary"?this.gi(o).next(c=>!!c||this.pi(o)).next(c=>{if(!c)throw We(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new x(y.FAILED_PRECONDITION,nN);return r(o)}).next(c=>this.wi(o).next(()=>c)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return pl(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)&&!this.Si(n)&&!(this.ai||this.allowTabSynchronization&&n.allowTabSynchronization))throw new x(y.FAILED_PRECONDITION,Ix)})}wi(e){let n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return pl(e).put("owner",n)}static D(){return Jr.D()}yi(e){let n=pl(e);return n.get("owner").next(r=>this.Si(r)?(I("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):_.resolve())}Ci(e,n){let r=Date.now();return!(e<r-n)&&(!(e>r)||(We(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let n=/(?:Version|Mobile)\/1[456]/;Jm()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var n;try{let r=((n=this.di)===null||n===void 0?void 0:n.getItem(this.Fi(e)))!==null;return I("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return We("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){We("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function pl(t){return _t(t,"owner")}function Rp(t){return _t(t,"clientMetadata")}function kE(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var kw=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=i}static Ki(e,n){let r=te(),i=te();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var Ow=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var dg=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return Jm()?8:Jr.v(Oc())>0?6:4}()}initialize(e,n){this.zi=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.ji(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new Ow;return this.Ji(e,n,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,n,o,a.size)})}).next(()=>s.result)}Yi(e,n,r,i){return r.documentReadCount<this.Wi?(Ra()<=wn.DEBUG&&I("QueryEngine","SDK will not create cache indexes for query:",Na(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),_.resolve()):(Ra()<=wn.DEBUG&&I("QueryEngine","Query:",Na(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(Ra()<=wn.DEBUG&&I("QueryEngine","The SDK decides to create cache indexes for query:",Na(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Wt(n))):_.resolve())}ji(e,n){if(dR(n))return _.resolve(null);let r=Wt(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Yp(n,null,"F"),r=Wt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=te(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let u=this.Zi(n,a);return this.Xi(n,u,o,c.readTime)?this.ji(e,Yp(n,null,"F")):this.es(e,u,n,c)}))})))}Hi(e,n,r,i){return dR(n)||i.isEqual(U.min())?_.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(n,s);return this.Xi(n,o,r,i)?_.resolve(null):(Ra()<=wn.DEBUG&&I("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Na(n)),this.es(e,o,n,eN(i,-1)).next(a=>a))})}Zi(e,n){let r=new Se(xN(e));return n.forEach((i,s)=>{Wl(e,s)&&(r=r.add(s))}),r}Xi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,n,r){return Ra()<=wn.DEBUG&&I("QueryEngine","Using full collection scan to execute query:",Na(n)),this.zi.getDocumentsMatchingQuery(e,n,Pn.min(),r)}es(e,n,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Fw=class{constructor(e,n,r,i){this.persistence=e,this.ts=n,this.serializer=i,this.ns=new ke(J),this.rs=new Sr(s=>Js(s),Gl),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new cg(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ns))}};function tP(t,e,n,r){return new Fw(t,e,n,r)}function nP(t,e){return g(this,null,function*(){let n=R(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n._s(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=te();for(let u of i){o.push(u.batchId);for(let l of u.mutations)c=c.add(l.key)}for(let u of s){a.push(u.batchId);for(let l of u.mutations)c=c.add(l.key)}return n.localDocuments.getDocuments(r,c).next(u=>({us:u,removedBatchIds:o,addedBatchIds:a}))})})})}function _$(t,e){let n=R(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(a,c,u,l){let d=u.batch,h=d.keys(),f=_.resolve();return h.forEach(p=>{f=f.next(()=>l.getEntry(c,p)).next(m=>{let v=u.docVersions.get(p);L(v!==null),m.version.compareTo(v)<0&&(d.applyToRemoteDocument(m,u),m.isValidDocument()&&(m.setReadTime(u.commitVersion),l.addEntry(m)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(c,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=te();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function rP(t){let e=R(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function y$(t,e){let n=R(t),r=e.snapshotVersion,i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;let a=[];e.targetChanges.forEach((l,d)=>{let h=i.get(d);if(!h)return;a.push(n.Qr.removeMatchingKeys(s,l.removedDocuments,d).next(()=>n.Qr.addMatchingKeys(s,l.addedDocuments,d)));let f=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(mt.EMPTY_BYTE_STRING,U.min()).withLastLimboFreeSnapshotVersion(U.min()):l.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(l.resumeToken,r)),i=i.insert(d,f),function(m,v,C){return m.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=3e8?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0}(h,f,l)&&a.push(n.Qr.updateTargetData(s,f))});let c=an(),u=te();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,l))}),a.push(iP(s,o,e.documentUpdates).next(l=>{c=l.cs,u=l.ls})),!r.isEqual(U.min())){let l=n.Qr.getLastRemoteSnapshotVersion(s).next(d=>n.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(l)}return _.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(n.ns=i,s))}function iP(t,e,n){let r=te(),i=te();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=an();return n.forEach((a,c)=>{let u=s.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(U.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):I("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{cs:o,ls:i}})}function v$(t,e){let n=R(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Qa(t,e){let n=R(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Qr.getTargetData(r,e).next(s=>s?(i=s,_.resolve(i)):n.Qr.allocateTargetId(r).next(o=>(i=new Wa(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(r.targetId,r),n.rs.set(e,r.targetId)),r})}function Ya(t,e,n){return g(this,null,function*(){let r=R(t),i=r.ns.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Yi(o))throw o;I("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function hg(t,e,n){let r=R(t),i=U.min(),s=te();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,l){let d=R(c),h=d.rs.get(l);return h!==void 0?_.resolve(d.ns.get(h)):d.Qr.getTargetData(u,l)}(r,o,Wt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,n?i:U.min(),n?s:te())).next(a=>(aP(r,vN(e),a),{documents:a,hs:s})))}function sP(t,e){let n=R(t),r=R(n.Qr),i=n.ns.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function oP(t,e){let n=R(t),r=n.ss.get(e)||U.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.os.getAllFromCollectionGroup(i,e,eN(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(aP(n,e,i),i))}function aP(t,e,n){let r=t.ss.get(e)||U.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.ss.set(e,r)}function x$(t,e,n,r){return g(this,null,function*(){let i=R(t),s=te(),o=an();for(let u of n){let l=e.Ps(u.metadata.name);u.document&&(s=s.add(l));let d=e.Is(u);d.setReadTime(e.Ts(u.metadata.readTime)),o=o.insert(l,d)}let a=i.os.newChangeBuffer({trackRemovals:!0}),c=yield Qa(i,function(l){return Wt(ic(me.fromString(`__bundle__/docs/${l}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",u=>iP(u,a,o).next(l=>(a.apply(u),l)).next(l=>i.Qr.removeMatchingKeysForTargetId(u,c.targetId).next(()=>i.Qr.addMatchingKeys(u,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(u,l.cs,l.ls)).next(()=>l.cs)))})}function w$(r,i){return g(this,arguments,function*(t,e,n=te()){let s=yield Qa(t,Wt(NE(e.bundledQuery))),o=R(t);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=Qe(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.$r.saveNamedQuery(a,e);let u=s.withResumeToken(mt.EMPTY_BYTE_STRING,c);return o.ns=o.ns.insert(u.targetId,u),o.Qr.updateTargetData(a,u).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,n,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function jR(t,e){return`firestore_clients_${t}_${e}`}function BR(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Cx(t,e){return`firestore_targets_${t}_${e}`}var fg=class t{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Es(e,n,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new x(i.error.code,i.error.message))),o?new t(e,n,i.state,s):(We("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},xl=class t{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Es(e,n){let r=JSON.parse(n),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new x(r.error.code,r.error.message))),s?new t(e,r.state,i):(We("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},pg=class t{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Es(e,n){let r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=ME();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=rN(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new t(e,s):(We("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}},Vw=class t{constructor(e,n){this.clientId=e,this.onlineState=n}static Es(e){let n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t(n.clientId,n.onlineState):(We("SharedClientState",`Failed to parse online state: ${e}`),null)}},Vl=class{constructor(){this.activeTargetIds=ME()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},wl=class{constructor(e,n,r,i,s){this.window=e,this.oi=n,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new ke(J),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=jR(this.persistenceKey,this.Vs),this.Ss=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new Vl),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Fs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return g(this,null,function*(){let e=yield this.syncEngine.Bi();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(jR(this.persistenceKey,r));if(i){let s=pg.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let n=this.storage.getItem(this.vs);if(n){let r=this.xs(n);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let n=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,n,r){this.Ls(e,n,r),this.Bs(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(Cx(this.persistenceKey,e));if(r){let i=xl.Es(e,r);i&&(n=i.state)}}return this.ks.As(e),this.Ms(),n}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Cx(this.persistenceKey,e))}updateQueryState(e,n,r){this.qs(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let n=this.storage.getItem(e);return I("SharedClientState","READ",e,n),n}setItem(e,n){I("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){I("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let n=e;if(n.storageArea===this.storage){if(I("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ws)return void We("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>g(this,null,function*(){if(this.started){if(n.key!==null){if(this.bs.test(n.key)){if(n.newValue==null){let r=this.$s(n.key);return this.Us(r,null)}{let r=this.Ws(n.key,n.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){let r=this.Gs(n.key,n.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(n.key)){if(n.newValue!==null){let r=this.js(n.key,n.newValue);if(r)return this.Hs(r)}}else if(n.key===this.vs){if(n.newValue!==null){let r=this.xs(n.newValue);if(r)return this.Os(r)}}else if(n.key===this.Ss){let r=function(s){let o=pn._e;if(s!=null)try{let a=JSON.parse(s);L(typeof a=="number"),o=a}catch(a){We("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==pn._e&&this.sequenceNumberHandler(r)}else if(n.key===this.Fs){let r=this.Js(n.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(n)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,n,r){let i=new fg(this.currentUser,e,n,r),s=BR(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Bs(e){let n=BR(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Qs(e){let n={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(n))}qs(e,n,r){let i=Cx(this.persistenceKey,e),s=new xl(e,n,r);this.setItem(i,s.ds())}Ks(e){let n=JSON.stringify(Array.from(e));this.setItem(this.Fs,n)}$s(e){let n=this.bs.exec(e);return n?n[1]:null}Ws(e,n){let r=this.$s(e);return pg.Es(r,n)}Gs(e,n){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return fg.Es(new it(s),i,n)}js(e,n){let r=this.Cs.exec(e),i=Number(r[1]);return xl.Es(i,n)}xs(e){return Vw.Es(e)}Js(e){return JSON.parse(e)}zs(e){return g(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);I("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,n){let r=n?this.ps.insert(e,n):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let n=ME();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}},gg=class{constructor(){this.no=new Vl,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,n,r){this.ro[e]=n}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Vl,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Lw=class{io(e){}shutdown(){}};var mg=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){I("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){I("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Np=null;function bx(){return Np===null?Np=function(){return 268435456+Math.round(2147483648*Math.random())}():Np++,"0x"+Np.toString(16)}var E$={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var jw=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}};var Pt="WebChannelConnection",Bw=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.fo=r+"://"+n.host,this.po=`projects/${i}/databases/${s}`,this.yo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get wo(){return!1}So(n,r,i,s,o){let a=bx(),c=this.bo(n,r.toUriEncodedString());I("RestConnection",`Sending RPC '${n}' ${a}:`,c,i);let u={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(u,s,o),this.Co(n,c,u,i).then(l=>(I("RestConnection",`Received RPC '${n}' ${a}: `,l),l),l=>{throw Nn("RestConnection",`RPC '${n}' ${a} failed with error: `,l,"url: ",c,"request:",i),l})}vo(n,r,i,s,o,a){return this.So(n,r,i,s,o)}Do(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+rc}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}bo(n,r){let i=E$[n];return`${this.fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,n,r,i){let s=bx();return new Promise((o,a)=>{let c=new QM;c.setWithCredentials(!0),c.listenOnce(WM.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Sp.NO_ERROR:let l=c.getResponseJson();I(Pt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(l)),o(l);break;case Sp.TIMEOUT:I(Pt,`RPC '${e}' ${s} timed out`),a(new x(y.DEADLINE_EXCEEDED,"Request time out"));break;case Sp.HTTP_ERROR:let d=c.getStatus();if(I(Pt,`RPC '${e}' ${s} failed with status:`,d,"response text:",c.getResponseText()),d>0){let h=c.getResponseJson();Array.isArray(h)&&(h=h[0]);let f=h?.error;if(f&&f.status&&f.message){let p=function(v){let C=v.toLowerCase().replace(/_/g,"-");return Object.values(y).indexOf(C)>=0?C:y.UNKNOWN}(f.status);a(new x(p,f.message))}else a(new x(y.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new x(y.UNAVAILABLE,"Connection failed."));break;default:k()}}finally{I(Pt,`RPC '${e}' ${s} completed.`)}});let u=JSON.stringify(i);I(Pt,`RPC '${e}' ${s} sending request:`,i),c.send(n,"POST",u,r,15)})}Fo(e,n,r){let i=bx(),s=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=GM(),a=zM(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Do(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;let l=s.join("");I(Pt,`Creating RPC '${e}' stream ${i}: ${l}`,c);let d=o.createWebChannel(l,c),h=!1,f=!1,p=new jw({lo:v=>{f?I(Pt,`Not sending because RPC '${e}' stream ${i} is closed:`,v):(h||(I(Pt,`Opening RPC '${e}' stream ${i} transport.`),d.open(),h=!0),I(Pt,`RPC '${e}' stream ${i} sending:`,v),d.send(v))},ho:()=>d.close()}),m=(v,C,F)=>{v.listen(C,T=>{try{F(T)}catch(H){setTimeout(()=>{throw H},0)}})};return m(d,ll.EventType.OPEN,()=>{f||I(Pt,`RPC '${e}' stream ${i} transport opened.`)}),m(d,ll.EventType.CLOSE,()=>{f||(f=!0,I(Pt,`RPC '${e}' stream ${i} transport closed`),p.Vo())}),m(d,ll.EventType.ERROR,v=>{f||(f=!0,Nn(Pt,`RPC '${e}' stream ${i} transport errored:`,v),p.Vo(new x(y.UNAVAILABLE,"The operation could not be completed")))}),m(d,ll.EventType.MESSAGE,v=>{var C;if(!f){let F=v.data[0];L(!!F);let T=F,H=T.error||((C=T[0])===null||C===void 0?void 0:C.error);if(H){I(Pt,`RPC '${e}' stream ${i} received error:`,H);let z=H.status,Y=function(Ym){let Vd=nt[Ym];if(Vd!==void 0)return kN(Vd)}(z),be=H.message;Y===void 0&&(Y=y.INTERNAL,be="Unknown error status: "+z+" with message "+H.message),f=!0,p.Vo(new x(Y,be)),d.close()}else I(Pt,`RPC '${e}' stream ${i} received:`,F),p.mo(F)}}),m(a,KM.STAT_EVENT,v=>{v.stat===wx.PROXY?I(Pt,`RPC '${e}' stream ${i} detected buffering proxy`):v.stat===wx.NOPROXY&&I(Pt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.Ro()},0),p}};function cP(){return typeof window<"u"?window:null}function Vp(){return typeof document<"u"?document:null}function Kl(t){return new rw(t,!0)}var Ll=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=n,this.Mo=r,this.xo=i,this.Oo=s,this.No=0,this.Lo=null,this.Bo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();let n=Math.floor(this.No+this.Qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,n-r);i>0&&I("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Lo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){this.Lo!==null&&(this.Lo.skipDelay(),this.Lo=null)}cancel(){this.Lo!==null&&(this.Lo.cancel(),this.Lo=null)}Qo(){return(Math.random()-.5)*this.No}};var _g=class{constructor(e,n,r,i,s,o,a,c){this.oi=e,this.$o=r,this.Uo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new Ll(e,n)}Ho(){return this.state===1||this.state===5||this.Jo()}Jo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Yo()}stop(){return g(this,null,function*(){this.Ho()&&(yield this.close(0))})}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&this.Go===null&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,()=>this.e_()))}t_(e){this.n_(),this.stream.send(e)}e_(){return g(this,null,function*(){if(this.Jo())return this.close(0)})}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}close(e,n){return g(this,null,function*(){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,e!==4?this.jo.reset():n&&n.code===y.RESOURCE_EXHAUSTED?(We(n.toString()),We("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):n&&n.code===y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.To(n)})}i_(){}auth(){this.state=1;let e=this.s_(this.Wo),n=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Wo===n&&this.o_(r,i)},r=>{e(()=>{let i=new x(y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.__(i)})})}o_(e,n){let r=this.s_(this.Wo);this.stream=this.a_(e,n),this.stream.Po(()=>{r(()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,()=>(this.Jo()&&(this.state=3),Promise.resolve())),this.listener.Po()))}),this.stream.To(i=>{r(()=>this.__(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Yo(){this.state=5,this.jo.qo(()=>g(this,null,function*(){this.state=0,this.start()}))}__(e){return I("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return n=>{this.oi.enqueueAndForget(()=>this.Wo===e?n():(I("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Uw=class extends _g{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}a_(e,n){return this.connection.Fo("Listen",e,n)}onMessage(e){this.jo.reset();let n=o$(this.serializer,e),r=function(s){if(!("targetChange"in s))return U.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?U.min():o.readTime?Qe(o.readTime):U.min()}(e);return this.listener.u_(n,r)}c_(e){let n={};n.database=ow(this.serializer),n.addTarget=function(s,o){let a,c=o.target;if(a=Kp(c)?{documents:$N(s,c)}:{query:HN(s,c).ut},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=FN(s,o.resumeToken);let u=iw(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(U.min())>0){a.readTime=za(s,o.snapshotVersion.toTimestamp());let u=iw(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);let r=c$(this.serializer,e);r&&(n.labels=r),this.t_(n)}l_(e){let n={};n.database=ow(this.serializer),n.removeTarget=e,this.t_(n)}},$w=class extends _g{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,n){return this.connection.Fo("Write",e,n)}onMessage(e){if(L(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();let n=a$(e.writeResults,e.commitTime),r=Qe(e.commitTime);return this.listener.T_(r,n)}return L(!e.writeResults||e.writeResults.length===0),this.h_=!0,this.listener.E_()}d_(){let e={};e.database=ow(this.serializer),this.t_(e)}I_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>kl(this.serializer,r))};this.t_(n)}};var Hw=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new x(y.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,sw(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new x(y.UNKNOWN,s.toString())})}vo(e,n,r,i,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.vo(e,sw(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new x(y.UNKNOWN,o.toString())})}terminate(){this.A_=!0,this.connection.terminate()}};var qw=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){this.m_===0&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve())))}S_(e){this.state==="Online"?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,e==="Online"&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(We(n),this.g_=!1):I("OnlineStateTracker",n)}b_(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}};var Gw=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=s,this.M_.io(o=>{r.enqueueAndForget(()=>g(this,null,function*(){Zi(this)&&(I("RemoteStore","Restarting streams for network reachability change."),yield function(c){return g(this,null,function*(){let u=R(c);u.v_.add(4),yield sc(u),u.x_.set("Unknown"),u.v_.delete(4),yield Ql(u)})}(this))}))}),this.x_=new qw(r,i)}};function Ql(t){return g(this,null,function*(){if(Zi(t))for(let e of t.F_)yield e(!0)})}function sc(t){return g(this,null,function*(){for(let e of t.F_)yield e(!1)})}function Fg(t,e){let n=R(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),VE(n)?FE(n):ac(n).Jo()&&OE(n,e))}function Za(t,e){let n=R(t),r=ac(n);n.C_.delete(e),r.Jo()&&uP(n,e),n.C_.size===0&&(r.Jo()?r.Xo():Zi(n)&&n.x_.set("Unknown"))}function OE(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(U.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ac(t).c_(e)}function uP(t,e){t.O_.Oe(e),ac(t).l_(e)}function FE(t){t.O_=new nw({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),ac(t).start(),t.x_.p_()}function VE(t){return Zi(t)&&!ac(t).Ho()&&t.C_.size>0}function Zi(t){return R(t).v_.size===0}function lP(t){t.O_=void 0}function I$(t){return g(this,null,function*(){t.C_.forEach((e,n)=>{OE(t,e)})})}function C$(t,e){return g(this,null,function*(){lP(t),VE(t)?(t.x_.S_(e),FE(t)):t.x_.set("Unknown")})}function b$(t,e,n){return g(this,null,function*(){if(t.x_.set("Online"),e instanceof Xp&&e.state===2&&e.cause)try{yield function(i,s){return g(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.C_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.C_.delete(a),i.O_.removeTarget(a))})}(t,e)}catch(r){I("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield yg(t,r)}else if(e instanceof ja?t.O_.$e(e):e instanceof Zp?t.O_.Je(e):t.O_.Ge(e),!n.isEqual(U.min()))try{let r=yield rP(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.O_.it(o);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){let l=s.C_.get(u);l&&s.C_.set(u,l.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,u)=>{let l=s.C_.get(c);if(!l)return;s.C_.set(c,l.withResumeToken(mt.EMPTY_BYTE_STRING,l.snapshotVersion)),uP(s,c);let d=new Wa(l.target,c,u,l.sequenceNumber);OE(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){I("RemoteStore","Failed to raise snapshot:",r),yield yg(t,r)}})}function yg(t,e,n){return g(this,null,function*(){if(!Yi(e))throw e;t.v_.add(1),yield sc(t),t.x_.set("Offline"),n||(n=()=>rP(t.localStore)),t.asyncQueue.enqueueRetryable(()=>g(this,null,function*(){I("RemoteStore","Retrying IndexedDB access"),yield n(),t.v_.delete(1),yield Ql(t)}))})}function dP(t,e){return e().catch(n=>yg(t,n,e))}function oc(t){return g(this,null,function*(){let e=R(t),n=Ki(e),r=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;D$(e);)try{let i=yield v$(e.localStore,r);if(i===null){e.D_.length===0&&n.Xo();break}r=i.batchId,T$(e,i)}catch(i){yield yg(e,i)}hP(e)&&fP(e)})}function D$(t){return Zi(t)&&t.D_.length<10}function T$(t,e){t.D_.push(e);let n=Ki(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function hP(t){return Zi(t)&&!Ki(t).Ho()&&t.D_.length>0}function fP(t){Ki(t).start()}function S$(t){return g(this,null,function*(){Ki(t).d_()})}function A$(t){return g(this,null,function*(){let e=Ki(t);for(let n of t.D_)e.I_(n.mutations)})}function M$(t,e,n){return g(this,null,function*(){let r=t.D_.shift(),i=Jx.from(r,e,n);yield dP(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield oc(t)})}function R$(t,e){return g(this,null,function*(){e&&Ki(t).P_&&(yield function(r,i){return g(this,null,function*(){if(function(o){return PN(o)&&o!==y.ABORTED}(i.code)){let s=r.D_.shift();Ki(r).Zo(),yield dP(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield oc(r)}})}(t,e)),hP(t)&&fP(t)})}function UR(t,e){return g(this,null,function*(){let n=R(t);n.asyncQueue.verifyOperationInProgress(),I("RemoteStore","RemoteStore received new credentials");let r=Zi(n);n.v_.add(3),yield sc(n),r&&n.x_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),yield Ql(n)})}function zw(t,e){return g(this,null,function*(){let n=R(t);e?(n.v_.delete(2),yield Ql(n)):e||(n.v_.add(2),yield sc(n),n.x_.set("Unknown"))})}function ac(t){return t.N_||(t.N_=function(n,r,i){let s=R(n);return s.R_(),new Uw(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:I$.bind(null,t),To:C$.bind(null,t),u_:b$.bind(null,t)}),t.F_.push(e=>g(this,null,function*(){e?(t.N_.Zo(),VE(t)?FE(t):t.x_.set("Unknown")):(yield t.N_.stop(),lP(t))}))),t.N_}function Ki(t){return t.L_||(t.L_=function(n,r,i){let s=R(n);return s.R_(),new $w(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:S$.bind(null,t),To:R$.bind(null,t),E_:A$.bind(null,t),T_:M$.bind(null,t)}),t.F_.push(e=>g(this,null,function*(){e?(t.L_.Zo(),yield oc(t)):(yield t.L_.stop(),t.D_.length>0&&(I("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.L_}var Ww=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new st,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new x(y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function cc(t,e){if(We("AsyncQueue",`${e}: ${t}`),Yi(t))return new x(y.UNAVAILABLE,`${e}: ${t}`);throw t}var vg=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||M.comparator(n.key,r.key):(n,r)=>M.comparator(n.key,r.key),this.keyedMap=gl(),this.sortedSet=new ke(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var xg=class{constructor(){this.B_=new ke(M.comparator)}track(e){let n=e.doc.key,r=this.B_.get(n);r?e.type!==0&&r.type===3?this.B_=this.B_.insert(n,e):e.type===3&&r.type!==1?this.B_=this.B_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.B_=this.B_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.B_=this.B_.remove(n):e.type===1&&r.type===2?this.B_=this.B_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):k():this.B_=this.B_.insert(n,e)}k_(){let e=[];return this.B_.inorderTraversal((n,r)=>{e.push(r)}),e}},Xa=class t{constructor(e,n,r,i,s,o,a,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,vg.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&zl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var Kw=class{constructor(){this.q_=void 0,this.Q_=[]}K_(){return this.Q_.some(e=>e.U_())}},Qw=class{constructor(){this.queries=new Sr(e=>yN(e),zl),this.onlineState="Unknown",this.W_=new Set}};function LE(t,e){return g(this,null,function*(){let n=R(t),r=3,i=e.query,s=n.queries.get(i);s?!s.K_()&&e.U_()&&(r=2):(s=new Kw,r=e.U_()?0:1);try{switch(r){case 0:s.q_=yield n.onListen(i,!0);break;case 1:s.q_=yield n.onListen(i,!1);break;case 2:yield n.onFirstRemoteStoreListen(i)}}catch(o){let a=cc(o,`Initialization of query '${Na(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Q_.push(e),e.G_(n.onlineState),s.q_&&e.z_(s.q_)&&BE(n)})}function jE(t,e){return g(this,null,function*(){let n=R(t),r=e.query,i=3,s=n.queries.get(r);if(s){let o=s.Q_.indexOf(e);o>=0&&(s.Q_.splice(o,1),s.Q_.length===0?i=e.U_()?0:1:!s.K_()&&e.U_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}})}function N$(t,e){let n=R(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.Q_)a.z_(i)&&(r=!0);o.q_=i}}r&&BE(n)}function P$(t,e,n){let r=R(t),i=r.queries.get(e);if(i)for(let s of i.Q_)s.onError(n);r.queries.delete(e)}function BE(t){t.W_.forEach(e=>{e.next()})}var Yw,$R;($R=Yw||(Yw={})).j_="default",$R.Cache="cache";var jl=class{constructor(e,n,r){this.query=e,this.H_=n,this.J_=!1,this.Y_=null,this.onlineState="Unknown",this.options=r||{}}z_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Xa(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.J_?this.Z_(e)&&(this.H_.next(e),n=!0):this.X_(e,this.onlineState)&&(this.ea(e),n=!0),this.Y_=e,n}onError(e){this.H_.error(e)}G_(e){this.onlineState=e;let n=!1;return this.Y_&&!this.J_&&this.X_(this.Y_,e)&&(this.ea(this.Y_),n=!0),n}X_(e,n){if(!e.fromCache||!this.U_())return!0;let r=n!=="Offline";return(!this.options.ta||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Z_(e){if(e.docChanges.length>0)return!0;let n=this.Y_&&this.Y_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ea(e){e=Xa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.J_=!0,this.H_.next(e)}U_(){return this.options.source!==Yw.Cache}};var Zw=class{constructor(e,n){this.na=e,this.byteLength=n}ra(){return"metadata"in this.na}};var wg=class{constructor(e){this.serializer=e}Ps(e){return Cr(this.serializer,e)}Is(e){return e.metadata.exists?UN(this.serializer,e.document,!1):ot.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return Qe(e)}},Xw=class{constructor(e,n,r){this.ia=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=pP(e)}sa(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.na.namedQuery)this.queries.push(e.na.namedQuery);else if(e.na.documentMetadata){this.documents.push({metadata:e.na.documentMetadata}),e.na.documentMetadata.exists||++n;let r=me.fromString(e.na.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.na.document&&(this.documents[this.documents.length-1].document=e.na.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}oa(e){let n=new Map,r=new wg(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(n.get(o)||te()).add(s);n.set(o,a)}}return n}complete(){return g(this,null,function*(){let e=yield x$(this.localStore,new wg(this.serializer),this.documents,this.ia.id),n=this.oa(this.documents);for(let r of this.queries)yield w$(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,_a:this.collectionGroups,aa:e}})}};function pP(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Eg=class{constructor(e){this.key=e}},Ig=class{constructor(e){this.key=e}},Cg=class{constructor(e,n){this.query=e,this.ua=n,this.ca=null,this.hasCachedResults=!1,this.current=!1,this.la=te(),this.mutatedKeys=te(),this.ha=xN(e),this.Pa=new vg(this.ha)}get Ia(){return this.ua}Ta(e,n){let r=n?n.Ea:new xg,i=n?n.Pa:this.Pa,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((l,d)=>{let h=i.get(l),f=Wl(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),m=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations),v=!1;h&&f?h.data.isEqual(f.data)?p!==m&&(r.track({type:3,doc:f}),v=!0):this.da(h,f)||(r.track({type:2,doc:f}),v=!0,(c&&this.ha(f,c)>0||u&&this.ha(f,u)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),v=!0):h&&!f&&(r.track({type:1,doc:h}),v=!0,(c||u)&&(a=!0)),v&&(f?(o=o.add(f),s=m?s.add(l):s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{Pa:o,Ea:r,Xi:a,mutatedKeys:s}}da(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.Pa;this.Pa=e.Pa,this.mutatedKeys=e.mutatedKeys;let o=e.Ea.k_();o.sort((l,d)=>function(f,p){let m=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return k()}};return m(f)-m(p)}(l.type,d.type)||this.ha(l.doc,d.doc)),this.Aa(r),i=i!=null&&i;let a=n&&!i?this.Ra():[],c=this.la.size===0&&this.current&&!i?1:0,u=c!==this.ca;return this.ca=c,o.length!==0||u?{snapshot:new Xa(this.query,e.Pa,s,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),Va:a}:{Va:a}}G_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Pa:this.Pa,Ea:new xg,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{Va:[]}}ma(e){return!this.ua.has(e)&&!!this.Pa.has(e)&&!this.Pa.get(e).hasLocalMutations}Aa(e){e&&(e.addedDocuments.forEach(n=>this.ua=this.ua.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ua=this.ua.delete(n)),this.current=e.current)}Ra(){if(!this.current)return[];let e=this.la;this.la=te(),this.Pa.forEach(r=>{this.ma(r.key)&&(this.la=this.la.add(r.key))});let n=[];return e.forEach(r=>{this.la.has(r)||n.push(new Ig(r))}),this.la.forEach(r=>{e.has(r)||n.push(new Eg(r))}),n}fa(e){this.ua=e.hs,this.la=te();let n=this.Ta(e.documents);return this.applyChanges(n,!0)}ga(){return Xa.fromInitialDocuments(this.query,this.Pa,this.mutatedKeys,this.ca===0,this.hasCachedResults)}},Jw=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},eE=class{constructor(e){this.key=e,this.pa=!1}},tE=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.ya={},this.wa=new Sr(a=>yN(a),zl),this.Sa=new Map,this.ba=new Set,this.Da=new ke(M.comparator),this.Ca=new Map,this.va=new Fl,this.Fa={},this.Ma=new Map,this.xa=Ka.Ln(),this.onlineState="Unknown",this.Oa=void 0}get isPrimaryClient(){return this.Oa===!0}};function k$(t,e,n=!0){return g(this,null,function*(){let r=Vg(t),i,s=r.wa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ga()):i=yield gP(r,e,n,!0),i})}function O$(t,e){return g(this,null,function*(){let n=Vg(t);yield gP(n,e,!0,!1)})}function gP(t,e,n,r){return g(this,null,function*(){let i=yield Qa(t.localStore,Wt(e)),s=i.targetId,o=n?t.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield UE(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&Fg(t.remoteStore,i),a})}function UE(t,e,n,r,i){return g(this,null,function*(){t.Na=(d,h,f)=>function(m,v,C,F){return g(this,null,function*(){let T=v.view.Ta(C);T.Xi&&(T=yield hg(m.localStore,v.query,!1).then(({documents:be})=>v.view.Ta(be,T)));let H=F&&F.targetChanges.get(v.targetId),z=F&&F.targetMismatches.get(v.targetId)!=null,Y=v.view.applyChanges(T,m.isPrimaryClient,H,z);return nE(m,v.targetId,Y.Va),Y.snapshot})}(t,d,h,f);let s=yield hg(t.localStore,e,!0),o=new Cg(e,s.hs),a=o.Ta(s.documents),c=Nl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,c);nE(t,n,u.Va);let l=new Jw(e,n,o);return t.wa.set(e,l),t.Sa.has(n)?t.Sa.get(n).push(e):t.Sa.set(n,[e]),u.snapshot})}function F$(t,e,n){return g(this,null,function*(){let r=R(t),i=r.wa.get(e),s=r.Sa.get(i.targetId);if(s.length>1)return r.Sa.set(i.targetId,s.filter(o=>!zl(o,e))),void r.wa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Ya(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Za(r.remoteStore,i.targetId),Ja(r,i.targetId)}).catch(Qi))):(Ja(r,i.targetId),yield Ya(r.localStore,i.targetId,!0))})}function V$(t,e){return g(this,null,function*(){let n=R(t),r=n.wa.get(e),i=n.Sa.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Za(n.remoteStore,r.targetId))})}function L$(t,e,n){return g(this,null,function*(){let r=GE(t);try{let i=yield function(o,a){let c=R(o),u=je.now(),l=a.reduce((f,p)=>f.add(p.key),te()),d,h;return c.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=an(),m=te();return c.os.getEntries(f,l).next(v=>{p=v,p.forEach((C,F)=>{F.isValidDocument()||(m=m.add(C))})}).next(()=>c.localDocuments.getOverlayedDocuments(f,p)).next(v=>{d=v;let C=[];for(let F of a){let T=J9(F,d.get(F.key).overlayedDocument);T!=null&&C.push(new Jn(F.key,T,dN(T.value.mapValue),qe.exists(!0)))}return c.mutationQueue.addMutationBatch(f,u,C,a)}).next(v=>{h=v;let C=v.applyToLocalDocumentSet(d,m);return c.documentOverlayCache.saveOverlays(f,v.batchId,C)})}).then(()=>({batchId:h.batchId,changes:EN(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let u=o.Fa[o.currentUser.toKey()];u||(u=new ke(J)),u=u.insert(a,c),o.Fa[o.currentUser.toKey()]=u}(r,i.batchId,n),yield ii(r,i.changes),yield oc(r.remoteStore)}catch(i){let s=cc(i,"Failed to persist write");n.reject(s)}})}function mP(t,e){return g(this,null,function*(){let n=R(t);try{let r=yield y$(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.Ca.get(s);o&&(L(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.pa=!0:i.modifiedDocuments.size>0?L(o.pa):i.removedDocuments.size>0&&(L(o.pa),o.pa=!1))}),yield ii(n,r,e)}catch(r){yield Qi(r)}})}function HR(t,e,n){let r=R(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.wa.forEach((s,o)=>{let a=o.view.G_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=R(o);c.onlineState=a;let u=!1;c.queries.forEach((l,d)=>{for(let h of d.Q_)h.G_(a)&&(u=!0)}),u&&BE(c)}(r.eventManager,e),i.length&&r.ya.u_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function j$(t,e,n){return g(this,null,function*(){let r=R(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.Ca.get(e),s=i&&i.key;if(s){let o=new ke(M.comparator);o=o.insert(s,ot.newNoDocument(s,U.min()));let a=te().add(s),c=new Rl(U.min(),new Map,new ke(J),o,a);yield mP(r,c),r.Da=r.Da.remove(s),r.Ca.delete(e),qE(r)}else yield Ya(r.localStore,e,!1).then(()=>Ja(r,e,n)).catch(Qi)})}function B$(t,e){return g(this,null,function*(){let n=R(t),r=e.batch.batchId;try{let i=yield _$(n.localStore,e);HE(n,r,null),$E(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield ii(n,i)}catch(i){yield Qi(i)}})}function U$(t,e,n){return g(this,null,function*(){let r=R(t);try{let i=yield function(o,a){let c=R(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let l;return c.mutationQueue.lookupMutationBatch(u,a).next(d=>(L(d!==null),l=d.keys(),c.mutationQueue.removeMutationBatch(u,d))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,l,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,l)).next(()=>c.localDocuments.getDocuments(u,l))})}(r.localStore,e);HE(r,e,n),$E(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield ii(r,i)}catch(i){yield Qi(i)}})}function $$(t,e){return g(this,null,function*(){let n=R(t);Zi(n.remoteStore)||I("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=R(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(n.localStore);if(r===-1)return void e.resolve();let i=n.Ma.get(r)||[];i.push(e),n.Ma.set(r,i)}catch(r){let i=cc(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function $E(t,e){(t.Ma.get(e)||[]).forEach(n=>{n.resolve()}),t.Ma.delete(e)}function HE(t,e,n){let r=R(t),i=r.Fa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Fa[r.currentUser.toKey()]=i}}function Ja(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.Sa.get(e))t.wa.delete(r),n&&t.ya.La(r,n);t.Sa.delete(e),t.isPrimaryClient&&t.va.Vr(e).forEach(r=>{t.va.containsKey(r)||_P(t,r)})}function _P(t,e){t.ba.delete(e.path.canonicalString());let n=t.Da.get(e);n!==null&&(Za(t.remoteStore,n),t.Da=t.Da.remove(e),t.Ca.delete(n),qE(t))}function nE(t,e,n){for(let r of n)r instanceof Eg?(t.va.addReference(r.key,e),H$(t,r)):r instanceof Ig?(I("SyncEngine","Document no longer in limbo: "+r.key),t.va.removeReference(r.key,e),t.va.containsKey(r.key)||_P(t,r.key)):k()}function H$(t,e){let n=e.key,r=n.path.canonicalString();t.Da.get(n)||t.ba.has(r)||(I("SyncEngine","New document in limbo: "+n),t.ba.add(r),qE(t))}function qE(t){for(;t.ba.size>0&&t.Da.size<t.maxConcurrentLimboResolutions;){let e=t.ba.values().next().value;t.ba.delete(e);let n=new M(me.fromString(e)),r=t.xa.next();t.Ca.set(r,new eE(n)),t.Da=t.Da.insert(n,r),Fg(t.remoteStore,new Wa(Wt(ic(n.path)),r,"TargetPurposeLimboResolution",pn._e))}}function ii(t,e,n){return g(this,null,function*(){let r=R(t),i=[],s=[],o=[];r.wa.isEmpty()||(r.wa.forEach((a,c)=>{o.push(r.Na(c,e,n).then(u=>{if((u||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,u?.fromCache?"not-current":"current"),u){i.push(u);let l=kw.Ki(c.targetId,u);s.push(l)}}))}),yield Promise.all(o),r.ya.u_(i),yield function(c,u){return g(this,null,function*(){let l=R(c);try{yield l.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>_.forEach(u,h=>_.forEach(h.qi,f=>l.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>_.forEach(h.Qi,f=>l.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!Yi(d))throw d;I("LocalStore","Failed to update sequence numbers: "+d)}for(let d of u){let h=d.targetId;if(!d.fromCache){let f=l.ns.get(h),p=f.snapshotVersion,m=f.withLastLimboFreeSnapshotVersion(p);l.ns=l.ns.insert(h,m)}}})}(r.localStore,s))})}function q$(t,e){return g(this,null,function*(){let n=R(t);if(!n.currentUser.isEqual(e)){I("SyncEngine","User change. New user:",e.toKey());let r=yield nP(n.localStore,e);n.currentUser=e,function(s,o){s.Ma.forEach(a=>{a.forEach(c=>{c.reject(new x(y.CANCELLED,o))})}),s.Ma.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ii(n,r.us)}})}function G$(t,e){let n=R(t),r=n.Ca.get(e);if(r&&r.pa)return te().add(r.key);{let i=te(),s=n.Sa.get(e);if(!s)return i;for(let o of s){let a=n.wa.get(o);i=i.unionWith(a.view.Ia)}return i}}function z$(t,e){return g(this,null,function*(){let n=R(t),r=yield hg(n.localStore,e.query,!0),i=e.view.fa(r);return n.isPrimaryClient&&nE(n,e.targetId,i.Va),i})}function W$(t,e){return g(this,null,function*(){let n=R(t);return oP(n.localStore,e).then(r=>ii(n,r))})}function K$(t,e,n,r){return g(this,null,function*(){let i=R(t),s=yield function(a,c){let u=R(a),l=R(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",d=>l.vn(d,c).next(h=>h?u.localDocuments.getDocuments(d,h):_.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?yield oc(i.remoteStore):n==="acknowledged"||n==="rejected"?(HE(i,e,r||null),$E(i,e),function(a,c){R(R(a).mutationQueue).Mn(c)}(i.localStore,e)):k(),yield ii(i,s)):I("SyncEngine","Cannot apply mutation batch with id: "+e)})}function Q$(t,e){return g(this,null,function*(){let n=R(t);if(Vg(n),GE(n),e===!0&&n.Oa!==!0){let r=n.sharedClientState.getAllActiveQueryTargets(),i=yield qR(n,r.toArray());n.Oa=!0,yield zw(n.remoteStore,!0);for(let s of i)Fg(n.remoteStore,s)}else if(e===!1&&n.Oa!==!1){let r=[],i=Promise.resolve();n.Sa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Ja(n,o),Ya(n.localStore,o,!0))),Za(n.remoteStore,o)}),yield i,yield qR(n,r),function(o){let a=R(o);a.Ca.forEach((c,u)=>{Za(a.remoteStore,u)}),a.va.mr(),a.Ca=new Map,a.Da=new ke(M.comparator)}(n),n.Oa=!1,yield zw(n.remoteStore,!1)}})}function qR(t,e,n){return g(this,null,function*(){let r=R(t),i=[],s=[];for(let o of e){let a,c=r.Sa.get(o);if(c&&c.length!==0){a=yield Qa(r.localStore,Wt(c[0]));for(let u of c){let l=r.wa.get(u),d=yield z$(r,l);d.snapshot&&s.push(d.snapshot)}}else{let u=yield sP(r.localStore,o);a=yield Qa(r.localStore,u),yield UE(r,yP(u),o,!1,a.resumeToken)}i.push(a)}return r.ya.u_(s),i})}function yP(t){return _N(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Y$(t){return function(n){return R(R(n).persistence).Bi()}(R(t).localStore)}function Z$(t,e,n,r){return g(this,null,function*(){let i=R(t);if(i.Oa)return void I("SyncEngine","Ignoring unexpected query state notification.");let s=i.Sa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{let o=yield oP(i.localStore,vN(s[0])),a=Rl.createSynthesizedRemoteEventForCurrentChange(e,n==="current",mt.EMPTY_BYTE_STRING);yield ii(i,o,a);break}case"rejected":yield Ya(i.localStore,e,!0),Ja(i,e,r);break;default:k()}})}function X$(t,e,n){return g(this,null,function*(){let r=Vg(t);if(r.Oa){for(let i of e){if(r.Sa.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){I("SyncEngine","Adding an already active target "+i);continue}let s=yield sP(r.localStore,i),o=yield Qa(r.localStore,s);yield UE(r,yP(s),o.targetId,!1,o.resumeToken),Fg(r.remoteStore,o)}for(let i of n)r.Sa.has(i)&&(yield Ya(r.localStore,i,!1).then(()=>{Za(r.remoteStore,i),Ja(r,i)}).catch(Qi))}})}function Vg(t){let e=R(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=mP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=G$.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=j$.bind(null,e),e.ya.u_=N$.bind(null,e.eventManager),e.ya.La=P$.bind(null,e.eventManager),e}function GE(t){let e=R(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=B$.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=U$.bind(null,e),e}function J$(t,e,n){let r=R(t);(function(s,o,a){return g(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(f,p){let m=R(f),v=Qe(p.createTime);return m.persistence.runTransaction("hasNewerBundle","readonly",C=>m.$r.getBundleMetadata(C,p.id)).then(C=>!!C&&C.createTime.compareTo(v)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(pP(c));let u=new Xw(c,s.localStore,o.serializer),l=yield o.Ba();for(;l;){let h=yield u.sa(l);h&&a._updateProgress(h),l=yield o.Ba()}let d=yield u.complete();return yield ii(s,d.aa,void 0),yield function(f,p){let m=R(f);return m.persistence.runTransaction("Save bundle","readwrite",v=>m.$r.saveBundleMetadata(v,p))}(s.localStore,c),a._completeWith(d.progress),Promise.resolve(d._a)}catch(c){return Nn("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var Bl=class{constructor(){this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){this.serializer=Kl(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return tP(this.persistence,new dg,e.initialUser,this.serializer)}createPersistence(e){return new ug(lg.Hr,this.serializer)}createSharedClientState(e){return new gg}terminate(){return g(this,null,function*(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var bg=class t extends Bl{constructor(e,n,r){super(),this.ka=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){yield Zm(t.prototype,this,"initialize").call(this,e),yield this.ka.initialize(this,e),yield GE(this.ka.syncEngine),yield oc(this.ka.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return tP(this.persistence,new dg,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){let r=this.persistence.referenceDelegate.garbageCollector;return new vw(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){let r=new Vx(n,this.persistence);return new Fx(e.asyncQueue,r)}createPersistence(e){let n=kE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Rn.withCacheSize(this.cacheSizeBytes):Rn.DEFAULT;return new Pw(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,cP(),Vp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new gg}},rE=class t extends bg{constructor(e,n){super(e,n,!1),this.ka=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){return g(this,null,function*(){yield Zm(t.prototype,this,"initialize").call(this,e);let n=this.ka.syncEngine;this.sharedClientState instanceof wl&&(this.sharedClientState.syncEngine={Zs:K$.bind(null,n),Xs:Z$.bind(null,n),eo:X$.bind(null,n),Bi:Y$.bind(null,n),Ys:W$.bind(null,n)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>g(this,null,function*(){yield Q$(this.ka.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let n=cP();if(!wl.D(n))throw new x(y.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=kE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new wl(n,e.asyncQueue,r,e.clientId,e.initialUser)}},Ul=class{initialize(e,n){return g(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>HR(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=q$.bind(null,this.syncEngine),yield zw(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new Qw}()}createDatastore(e){let n=Kl(e.databaseInfo.databaseId),r=function(s){return new Bw(s)}(e.databaseInfo);return function(s,o,a,c){return new Hw(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new Gw(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>HR(this.syncEngine,n,0),function(){return mg.D()?new mg:new Lw}())}createSyncEngine(e,n){return function(i,s,o,a,c,u,l){let d=new tE(i,s,o,a,c,u);return l&&(d.Oa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return g(this,null,function*(){var e;yield function(r){return g(this,null,function*(){let i=R(r);I("RemoteStore","RemoteStore shutting down."),i.v_.add(5),yield sc(i),i.M_.shutdown(),i.x_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function GR(t,e=10240){let n=0;return{read(){return g(this,null,function*(){if(n<t.byteLength){let i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}})},cancel(){return g(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var ec=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.qa(this.observer.next,e)}error(e){this.observer.error?this.qa(this.observer.error,e):We("Uncaught Error in snapshot listener:",e.toString())}Qa(){this.muted=!0}qa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var iE=class{constructor(e,n){this.Ka=e,this.serializer=n,this.metadata=new st,this.buffer=new Uint8Array,this.$a=function(){return new TextDecoder("utf-8")}(),this.Ua().then(r=>{r&&r.ra()?this.metadata.resolve(r.na.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.na)}`))},r=>this.metadata.reject(r))}close(){return this.Ka.cancel()}getMetadata(){return g(this,null,function*(){return this.metadata.promise})}Ba(){return g(this,null,function*(){return yield this.getMetadata(),this.Ua()})}Ua(){return g(this,null,function*(){let e=yield this.Wa();if(e===null)return null;let n=this.$a.decode(e),r=Number(n);isNaN(r)&&this.Ga(`length string (${n}) is not valid number`);let i=yield this.za(r);return new Zw(JSON.parse(i),e.length+r)})}ja(){return this.buffer.findIndex(e=>e===123)}Wa(){return g(this,null,function*(){for(;this.ja()<0&&!(yield this.Ha()););if(this.buffer.length===0)return null;let e=this.ja();e<0&&this.Ga("Reached the end of bundle when a length string is expected.");let n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n})}za(e){return g(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ha())&&this.Ga("Reached the end of bundle when more is expected.");let n=this.$a.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n})}Ga(e){throw this.Ka.cancel(),new Error(`Invalid bundle format: ${e}`)}Ha(){return g(this,null,function*(){let e=yield this.Ka.read();if(!e.done){let n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done})}};var sE=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new x(y.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let n=yield function(i,s){return g(this,null,function*(){let o=R(i),a={documents:s.map(d=>Pl(o.serializer,d))},c=yield o.vo("BatchGetDocuments",o.serializer.databaseId,me.emptyPath(),a,s.length),u=new Map;c.forEach(d=>{let h=s$(o.serializer,d);u.set(h.key.toString(),h)});let l=[];return s.forEach(d=>{let h=u.get(d.toString());L(!!h),l.push(h)}),l})}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n})}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Wi(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{let i=M.fromPath(r);this.mutations.push(new Sl(i,this.precondition(i)))}),yield function(r,i){return g(this,null,function*(){let s=R(r),o={writes:i.map(a=>kl(s.serializer,a))};yield s.So("Commit",s.serializer.databaseId,me.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw k();n=U.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new x(y.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){let n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(U.min())?qe.exists(!1):qe.updateTime(n):qe.none()}preconditionForUpdate(e){let n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(U.min()))throw new x(y.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return qe.updateTime(n)}return qe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var oE=class{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Ja=r.maxAttempts,this.jo=new Ll(this.asyncQueue,"transaction_retry")}Ya(){this.Ja-=1,this.Za()}Za(){this.jo.qo(()=>g(this,null,function*(){let e=new sE(this.datastore),n=this.Xa(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.eu(i)}))}).catch(r=>{this.eu(r)})}))}Xa(e){try{let n=this.updateFunction(e);return!ql(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}eu(e){this.Ja>0&&this.tu(e)?(this.Ja-=1,this.asyncQueue.enqueueAndForget(()=>(this.Za(),Promise.resolve()))):this.deferred.reject(e)}tu(e){if(e.name==="FirebaseError"){let n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!PN(n)}return!1}};var aE=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=it.UNAUTHENTICATED,this.clientId=Bp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>g(this,null,function*(){I("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(I("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new x(y.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new st;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=cc(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Lp(t,e){return g(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),I("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>g(this,null,function*(){r.isEqual(i)||(yield nP(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function cE(t,e){return g(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield zE(t);I("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>UR(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>UR(e.remoteStore,i)),t._onlineComponents=e})}function vP(t){return t.name==="FirebaseError"?t.code===y.FAILED_PRECONDITION||t.code===y.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function zE(t){return g(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){I("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Lp(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!vP(n))throw n;Nn("Error using user provided cache. Falling back to memory cache: "+n),yield Lp(t,new Bl)}}else I("FirestoreClient","Using default OfflineComponentProvider"),yield Lp(t,new Bl);return t._offlineComponents})}function Lg(t){return g(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(I("FirestoreClient","Using user provided OnlineComponentProvider"),yield cE(t,t._uninitializedComponentsProvider._online)):(I("FirestoreClient","Using default OnlineComponentProvider"),yield cE(t,new Ul))),t._onlineComponents})}function xP(t){return zE(t).then(e=>e.persistence)}function WE(t){return zE(t).then(e=>e.localStore)}function wP(t){return Lg(t).then(e=>e.remoteStore)}function KE(t){return Lg(t).then(e=>e.syncEngine)}function e8(t){return Lg(t).then(e=>e.datastore)}function tc(t){return g(this,null,function*(){let e=yield Lg(t),n=e.eventManager;return n.onListen=k$.bind(null,e.syncEngine),n.onUnlisten=F$.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=O$.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=V$.bind(null,e.syncEngine),n})}function t8(t){return t.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield xP(t),n=yield wP(t);return e.setNetworkEnabled(!0),function(i){let s=R(i);return s.v_.delete(0),Ql(s)}(n)}))}function n8(t){return t.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield xP(t),n=yield wP(t);return e.setNetworkEnabled(!1),function(i){return g(this,null,function*(){let s=R(i);s.v_.add(0),yield sc(s),s.x_.set("Offline")})}(n)}))}function r8(t,e){let n=new st;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield function(u,l){let d=R(u);return d.persistence.runTransaction("read document","readonly",h=>d.localDocuments.getDocument(h,l))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new x(y.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=cc(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield WE(t),e,n)})),n.promise}function EP(t,e,n={}){let r=new st;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,u){let l=new ec({next:h=>{o.enqueueAndForget(()=>jE(s,d));let f=h.docs.has(a);!f&&h.fromCache?u.reject(new x(y.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&c&&c.source==="server"?u.reject(new x(y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(h)},error:h=>u.reject(h)}),d=new jl(ic(a.path),l,{includeMetadataChanges:!0,ta:!0});return LE(s,d)}(yield tc(t),t.asyncQueue,e,n,r)})),r.promise}function i8(t,e){let n=new st;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield hg(i,s,!0),c=new Cg(s,a.hs),u=c.Ta(a.documents),l=c.applyChanges(u,!1);o.resolve(l.snapshot)}catch(a){let c=cc(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield WE(t),e,n)})),n.promise}function IP(t,e,n={}){let r=new st;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,u){let l=new ec({next:h=>{o.enqueueAndForget(()=>jE(s,d)),h.fromCache&&c.source==="server"?u.reject(new x(y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(h)},error:h=>u.reject(h)}),d=new jl(a,l,{includeMetadataChanges:!0,ta:!0});return LE(s,d)}(yield tc(t),t.asyncQueue,e,n,r)})),r.promise}function s8(t,e){let n=new ec(e);return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){R(i).W_.add(s),s.next()}(yield tc(t),n)})),()=>{n.Qa(),t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){R(i).W_.delete(s)}(yield tc(t),n)}))}}function o8(t,e,n,r){let i=function(o,a){let c;return c=typeof o=="string"?ON().encode(o):o,function(l,d){return new iE(l,d)}(function(l,d){if(l instanceof Uint8Array)return GR(l,d);if(l instanceof ArrayBuffer)return GR(new Uint8Array(l),d);if(l instanceof ReadableStream)return l.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(n,Kl(e));t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){J$(yield KE(t),i,r)}))}function a8(t,e){return t.asyncQueue.enqueue(()=>g(this,null,function*(){return function(r,i){let s=R(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield WE(t),e)}))}function CP(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var zR=new Map;function QE(t,e,n){if(!n)throw new x(y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function YE(t,e,n,r){if(e===!0&&r===!0)throw new x(y.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function WR(t){if(!M.isDocumentKey(t))throw new x(y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function KR(t){if(M.isDocumentKey(t))throw new x(y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function jg(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":k()}function _e(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new x(y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=jg(t);throw new x(y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function bP(t,e){if(e<=0)throw new x(y.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}var Dg=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new x(y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new x(y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}YE("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=CP((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new x(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new x(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new x(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},ro=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Dg({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new x(y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new x(y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Dg(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Dx;switch(r.type){case"firstParty":return new Mx(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new x(y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=zR.get(n);r&&(I("ComponentProvider","Removing Datastore"),zR.delete(n),r.terminate())}(this),Promise.resolve()}};function DP(t,e,n,r={}){var i;let s=(t=_e(t,ro))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Nn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=it.MOCK_USER;else{a=Bd(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new x(y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new it(u)}t._authCredentials=new Tx(new jp(a,c))}}var St=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},Re=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new br(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},br=class t extends St{constructor(e,n,r){super(e,n,ic(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Re(this.firestore,null,new M(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function ZE(t,e,...n){if(t=le(t),QE("collection","path",e),t instanceof ro){let r=me.fromString(e,...n);return KR(r),new br(t,null,r)}{if(!(t instanceof Re||t instanceof br))throw new x(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(me.fromString(e,...n));return KR(r),new br(t.firestore,null,r)}}function TP(t,e){if(t=_e(t,ro),QE("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new x(y.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new St(t,null,function(r){return new Xn(me.emptyPath(),r)}(e))}function Yl(t,e,...n){if(t=le(t),arguments.length===1&&(e=Bp.newId()),QE("doc","path",e),t instanceof ro){let r=me.fromString(e,...n);return WR(r),new Re(t,null,new M(r))}{if(!(t instanceof Re||t instanceof br))throw new x(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(me.fromString(e,...n));return WR(r),new Re(t.firestore,t instanceof br?t.converter:null,new M(r))}}function XE(t,e){return t=le(t),e=le(e),(t instanceof Re||t instanceof br)&&(e instanceof Re||e instanceof br)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function JE(t,e){return t=le(t),e=le(e),t instanceof St&&e instanceof St&&t.firestore===e.firestore&&zl(t._query,e._query)&&t.converter===e.converter}var uE=class{constructor(){this.nu=Promise.resolve(),this.ru=[],this.iu=!1,this.su=[],this.ou=null,this._u=!1,this.au=!1,this.uu=[],this.jo=new Ll(this,"async_queue_retry"),this.cu=()=>{let n=Vp();n&&I("AsyncQueue","Visibility state changed to "+n.visibilityState),this.jo.Ko()};let e=Vp();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.cu)}get isShuttingDown(){return this.iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.lu(),this.hu(e)}enterRestrictedMode(e){if(!this.iu){this.iu=!0,this.au=e||!1;let n=Vp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.cu)}}enqueue(e){if(this.lu(),this.iu)return new Promise(()=>{});let n=new st;return this.hu(()=>this.iu&&this.au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.ru.push(e),this.Pu()))}Pu(){return g(this,null,function*(){if(this.ru.length!==0){try{yield this.ru[0](),this.ru.shift(),this.jo.reset()}catch(e){if(!Yi(e))throw e;I("AsyncQueue","Operation failed with retryable error: "+e)}this.ru.length>0&&this.jo.qo(()=>this.Pu())}})}hu(e){let n=this.nu.then(()=>(this._u=!0,e().catch(r=>{this.ou=r,this._u=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw We("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this._u=!1,r))));return this.nu=n,n}enqueueAfterDelay(e,n,r){this.lu(),this.uu.indexOf(e)>-1&&(n=0);let i=Ww.createAndSchedule(this,e,n,r,s=>this.Iu(s));return this.su.push(i),i}lu(){this.ou&&k()}verifyOperationInProgress(){}Tu(){return g(this,null,function*(){let e;do e=this.nu,yield e;while(e!==this.nu)})}Eu(e){for(let n of this.su)if(n.timerId===e)return!0;return!1}du(e){return this.Tu().then(()=>{this.su.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.su)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tu()})}Au(e){this.uu.push(e)}Iu(e){let n=this.su.indexOf(e);this.su.splice(n,1)}};function lE(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var dE=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new st,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var SP=-1,Ve=class extends ro{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new uE}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||AP(this),this._firestoreClient.terminate()}};function dt(t){return t._firestoreClient||AP(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function AP(t){var e,n,r;let i=t._freezeSettings(),s=function(a,c,u,l){return new Lx(a,c,u,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,CP(l.experimentalLongPollingOptions),l.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new aE(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function MP(t,e){jP(t=_e(t,Ve));let n=dt(t);if(n._uninitializedComponentsProvider)throw new x(y.FAILED_PRECONDITION,"SDK cache is already specified.");Nn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=t._freezeSettings(),i=new Ul;return NP(n,i,new bg(i,r.cacheSizeBytes,e?.forceOwnership))}function RP(t){jP(t=_e(t,Ve));let e=dt(t);if(e._uninitializedComponentsProvider)throw new x(y.FAILED_PRECONDITION,"SDK cache is already specified.");Nn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=t._freezeSettings(),r=new Ul;return NP(e,r,new rE(r,n.cacheSizeBytes))}function NP(t,e,n){let r=new st;return t.asyncQueue.enqueue(()=>g(this,null,function*(){try{yield Lp(t,n),yield cE(t,e),r.resolve()}catch(i){let s=i;if(!vP(s))throw s;Nn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function PP(t){if(t._initialized&&!t._terminated)throw new x(y.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new st;return t._queue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{yield function(r){return g(this,null,function*(){if(!Jr.D())return Promise.resolve();let i=r+"main";yield Jr.delete(i)})}(kE(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}})),e.promise}function kP(t){return function(n){let r=new st;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return $$(yield KE(n),r)})),r.promise}(dt(t=_e(t,Ve)))}function OP(t){return t8(dt(t=_e(t,Ve)))}function FP(t){return n8(dt(t=_e(t,Ve)))}function VP(t,e){let n=dt(t=_e(t,Ve)),r=new dE;return o8(n,t._databaseId,e,r),r}function LP(t,e){return a8(dt(t=_e(t,Ve)),e).then(n=>n?new St(t,null,n.query):null)}function jP(t){if(t._initialized||t._terminated)throw new x(y.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Ar=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(mt.fromBase64String(e))}catch(n){throw new x(y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(mt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var er=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new x(y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ke(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ni=class{constructor(e){this._methodName=e}};var io=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new x(y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new x(y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return J(this._lat,e._lat)||J(this._long,e._long)}};var c8=/^__.*__$/,hE=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Jn(e,this.data,this.fieldMask,n,this.fieldTransforms):new zi(e,this.data,n,this.fieldTransforms)}},Tg=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Jn(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function BP(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw k()}}var Sg=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ru(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Vu(){return this.settings.Vu}mu(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}fu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.mu({path:r,gu:!1});return i.pu(e),i}yu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.mu({path:r,gu:!1});return i.Ru(),i}wu(e){return this.mu({path:void 0,gu:!0})}Su(e){return Ag(e,this.settings.methodName,this.settings.bu||!1,this.path,this.settings.Du)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Ru(){if(this.path)for(let e=0;e<this.path.length;e++)this.pu(this.path.get(e))}pu(e){if(e.length===0)throw this.Su("Document fields must not be empty");if(BP(this.Vu)&&c8.test(e))throw this.Su('Document fields cannot begin and end with "__"')}},fE=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Kl(e)}Cu(e,n,r,i=!1){return new Sg({Vu:e,methodName:n,Du:r,path:Ke.emptyPath(),gu:!1,bu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function co(t){let e=t._freezeSettings(),n=Kl(t._databaseId);return new fE(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Bg(t,e,n,r,i,s={}){let o=t.Cu(s.merge||s.mergeFields?2:0,e,n,i);nI("Data must be an object, but it was:",o,r);let a=HP(r,o),c,u;if(s.merge)c=new gn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){let l=[];for(let d of s.mergeFields){let h=yE(e,d,n);if(!o.contains(h))throw new x(y.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);GP(l,h)||l.push(h)}c=new gn(l),u=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,u=o.fieldTransforms;return new hE(new kt(a),c,u)}var $l=class t extends ni{_toFieldTransform(e){if(e.Vu!==2)throw e.Vu===1?e.Su(`${this._methodName}() can only appear at the top level of your update data`):e.Su(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};function UP(t,e,n){return new Sg({Vu:3,Du:e.settings.Du,methodName:t._methodName,gu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var pE=class t extends ni{_toFieldTransform(e){return new eo(e.path,new qi)}isEqual(e){return e instanceof t}},gE=class t extends ni{constructor(e,n){super(e),this.vu=n}_toFieldTransform(e){let n=UP(this,e,!0),r=this.vu.map(s=>uo(s,n)),i=new ei(r);return new eo(e.path,i)}isEqual(e){return e instanceof t&&e_(this.vu,e.vu)}},mE=class t extends ni{constructor(e,n){super(e),this.vu=n}_toFieldTransform(e){let n=UP(this,e,!0),r=this.vu.map(s=>uo(s,n)),i=new ti(r);return new eo(e.path,i)}isEqual(e){return e instanceof t&&e_(this.vu,e.vu)}},_E=class t extends ni{constructor(e,n){super(e),this.Fu=n}_toFieldTransform(e){let n=new Gi(e.serializer,DN(e.serializer,this.Fu));return new eo(e.path,n)}isEqual(e){return e instanceof t&&this.Fu===e.Fu}};function eI(t,e,n,r){let i=t.Cu(1,e,n);nI("Data must be an object, but it was:",i,r);let s=[],o=kt.empty();ao(r,(c,u)=>{let l=rI(e,c,n);u=le(u);let d=i.yu(l);if(u instanceof $l)s.push(l);else{let h=uo(u,d);h!=null&&(s.push(l),o.set(l,h))}});let a=new gn(s);return new Tg(o,a,i.fieldTransforms)}function tI(t,e,n,r,i,s){let o=t.Cu(1,e,n),a=[yE(e,r,n)],c=[i];if(s.length%2!=0)throw new x(y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(yE(e,s[h])),c.push(s[h+1]);let u=[],l=kt.empty();for(let h=a.length-1;h>=0;--h)if(!GP(u,a[h])){let f=a[h],p=c[h];p=le(p);let m=o.yu(f);if(p instanceof $l)u.push(f);else{let v=uo(p,m);v!=null&&(u.push(f),l.set(f,v))}}let d=new gn(u);return new Tg(l,d,o.fieldTransforms)}function $P(t,e,n,r=!1){return uo(n,t.Cu(r?4:3,e))}function uo(t,e){if(qP(t=le(t)))return nI("Unsupported field value:",e,t),HP(t,e);if(t instanceof ni)return function(r,i){if(!BP(i.Vu))throw i.Su(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Su(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.gu&&e.Vu!==4)throw e.Su("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=uo(a,i.wu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=le(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return DN(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=je.fromDate(r);return{timestampValue:za(i.serializer,s)}}if(r instanceof je){let s=new je(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:za(i.serializer,s)}}if(r instanceof io)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ar)return{bytesValue:FN(i.serializer,r._byteString)};if(r instanceof Re){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Su(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:RE(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Su(`Unsupported field value: ${jg(r)}`)}(t,e)}function HP(t,e){let n={};return cN(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ao(t,(r,i)=>{let s=uo(i,e.fu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function qP(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof je||t instanceof io||t instanceof Ar||t instanceof Re||t instanceof ni)}function nI(t,e,n){if(!qP(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=jg(n);throw r==="an object"?e.Su(t+" a custom object"):e.Su(t+" "+r)}}function yE(t,e,n){if((e=le(e))instanceof er)return e._internalPath;if(typeof e=="string")return rI(t,e);throw Ag("Field path arguments must be of type string or ",t,!1,void 0,n)}var u8=new RegExp("[~\\*/\\[\\]]");function rI(t,e,n){if(e.search(u8)>=0)throw Ag(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new er(...e.split("."))._internalPath}catch{throw Ag(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ag(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new x(y.INVALID_ARGUMENT,a+t+c)}function GP(t,e){return t.some(n=>n.isEqual(e))}var so=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Re(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new vE(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(Ug("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},vE=class extends so{data(){return super.data()}};function Ug(t,e){return typeof e=="string"?rI(t,e):e instanceof er?e._internalPath:e._delegate._internalPath}function zP(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new x(y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Hl=class{},oo=class extends Hl{};function si(t,e,...n){let r=[];e instanceof Hl&&r.push(e),r=r.concat(n),function(s){let o=s.filter(c=>c instanceof xE).length,a=s.filter(c=>c instanceof Mg).length;if(o>1||o>0&&a>0)throw new x(y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var Mg=class t extends oo{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return nk(e._query,n),new St(e.firestore,e.converter,Zx(e._query,n))}_parse(e){let n=co(e.firestore);return function(s,o,a,c,u,l,d){let h;if(u.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new x(y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){YR(d,l);let f=[];for(let p of d)f.push(QR(c,s,p));h={arrayValue:{values:f}}}else h=QR(c,s,d)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||YR(d,l),h=$P(a,o,d,l==="in"||l==="not-in");return fe.create(u,l,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function WP(t,e,n){let r=e,i=Ug("where",t);return Mg._create(i,r,n)}var xE=class t extends Hl{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ce.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)nk(o,c),o=Zx(o,c)}(e._query,n),new St(e.firestore,e.converter,Zx(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var wE=class t extends oo{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t(e,n)}_apply(e){let n=function(i,s,o){if(i.startAt!==null)throw new x(y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new x(y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Xs(s,o)}(e._query,this._field,this._direction);return new St(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new Xn(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}};function KP(t,e="asc"){let n=e,r=Ug("orderBy",t);return wE._create(r,n)}var Rg=class t extends oo{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){return new St(e.firestore,e.converter,Yp(e._query,this._limit,this._limitType))}};function QP(t){return bP("limit",t),Rg._create("limit",t,"F")}function YP(t){return bP("limitToLast",t),Rg._create("limitToLast",t,"L")}var Ng=class t extends oo{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=tk(e,this.type,this._docOrFields,this._inclusive);return new St(e.firestore,e.converter,function(i,s){return new Xn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function ZP(...t){return Ng._create("startAt",t,!0)}function XP(...t){return Ng._create("startAfter",t,!1)}var Pg=class t extends oo{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=tk(e,this.type,this._docOrFields,this._inclusive);return new St(e.firestore,e.converter,function(i,s){return new Xn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function JP(...t){return Pg._create("endBefore",t,!1)}function ek(...t){return Pg._create("endAt",t,!0)}function tk(t,e,n,r){if(n[0]=le(n[0]),n[0]instanceof so)return function(s,o,a,c,u){if(!c)throw new x(y.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let l=[];for(let d of La(s))if(d.field.isKeyField())l.push(Zs(o,c.key));else{let h=c.data.field(d.field);if(Og(h))throw new x(y.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){let f=d.field.canonicalString();throw new x(y.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}l.push(h)}return new Tr(l,u)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{let i=co(t.firestore);return function(o,a,c,u,l,d){let h=o.explicitOrderBy;if(l.length>h.length)throw new x(y.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let f=[];for(let p=0;p<l.length;p++){let m=l[p];if(h[p].field.isKeyField()){if(typeof m!="string")throw new x(y.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof m}`);if(!AE(o)&&m.indexOf("/")!==-1)throw new x(y.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${m}' contains a slash.`);let v=o.path.child(me.fromString(m));if(!M.isDocumentKey(v))throw new x(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${v}' is not because it contains an odd number of segments.`);let C=new M(v);f.push(Zs(a,C))}else{let v=$P(c,u,m);f.push(v)}}return new Tr(f,d)}(t._query,t.firestore._databaseId,i,e,n,r)}}function QR(t,e,n){if(typeof(n=le(n))=="string"){if(n==="")throw new x(y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!AE(e)&&n.indexOf("/")!==-1)throw new x(y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(me.fromString(n));if(!M.isDocumentKey(r))throw new x(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Zs(t,new M(r))}if(n instanceof Re)return Zs(t,n._key);throw new x(y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${jg(n)}.`)}function YR(t,e){if(!Array.isArray(t)||t.length===0)throw new x(y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function nk(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new x(y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new x(y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var nc=class{convertValue(e,n="none"){switch(Ys(e)){case 0:return null;case 1:return e.booleanValue;case 2:return He(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ui(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw k()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return ao(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new io(He(e.latitude),He(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=TE(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(bl(e));default:return null}}convertTimestamp(e){let n=Bi(e);return new je(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=me.fromString(e);L(WN(r));let i=new $i(r.get(1),r.get(3)),s=new M(r.popFirst(5));return i.isEqual(n)||We(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function $g(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var EE=class extends nc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ar(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Re(this.firestore,null,n)}};var Xr=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},kn=class extends so{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new Li(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(Ug("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},Li=class extends kn{data(e={}){return super.data(e)}},tr=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Xr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Li(this._firestore,this._userDataWriter,r.key,r,new Xr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new x(y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new Li(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Xr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new Li(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Xr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),u=-1,l=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),l=o.indexOf(a.doc.key)),{type:l8(a.type),doc:c,oldIndex:u,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function l8(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return k()}}function iI(t,e){return t instanceof kn&&e instanceof kn?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof tr&&e instanceof tr&&t._firestore===e._firestore&&JE(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function rk(t){t=_e(t,Re);let e=_e(t.firestore,Ve);return EP(dt(e),t._key).then(n=>cI(e,t,n))}var ri=class extends nc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ar(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Re(this.firestore,null,n)}};function ik(t){t=_e(t,Re);let e=_e(t.firestore,Ve),n=dt(e),r=new ri(e);return r8(n,t._key).then(i=>new kn(e,r,t._key,i,new Xr(i!==null&&i.hasLocalMutations,!0),t.converter))}function sk(t){t=_e(t,Re);let e=_e(t.firestore,Ve);return EP(dt(e),t._key,{source:"server"}).then(n=>cI(e,t,n))}function ok(t){t=_e(t,St);let e=_e(t.firestore,Ve),n=dt(e),r=new ri(e);return zP(t._query),IP(n,t._query).then(i=>new tr(e,r,t,i))}function ak(t){t=_e(t,St);let e=_e(t.firestore,Ve),n=dt(e),r=new ri(e);return i8(n,t._query).then(i=>new tr(e,r,t,i))}function ck(t){t=_e(t,St);let e=_e(t.firestore,Ve),n=dt(e),r=new ri(e);return IP(n,t._query,{source:"server"}).then(i=>new tr(e,r,t,i))}function sI(t,e,n){t=_e(t,Re);let r=_e(t.firestore,Ve),i=$g(t.converter,e,n);return uc(r,[Bg(co(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,qe.none())])}function oI(t,e,n,...r){t=_e(t,Re);let i=_e(t.firestore,Ve),s=co(i),o;return o=typeof(e=le(e))=="string"||e instanceof er?tI(s,"updateDoc",t._key,e,n,r):eI(s,"updateDoc",t._key,e),uc(i,[o.toMutation(t._key,qe.exists(!0))])}function uk(t){return uc(_e(t.firestore,Ve),[new Wi(t._key,qe.none())])}function lk(t,e){let n=_e(t.firestore,Ve),r=Yl(t),i=$g(t.converter,e);return uc(n,[Bg(co(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,qe.exists(!1))]).then(()=>r)}function aI(t,...e){var n,r,i;t=le(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||lE(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(lE(e[o])){let d=e[o];e[o]=(n=d.next)===null||n===void 0?void 0:n.bind(d),e[o+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let c,u,l;if(t instanceof Re)u=_e(t.firestore,Ve),l=ic(t._key.path),c={next:d=>{e[o]&&e[o](cI(u,t,d))},error:e[o+1],complete:e[o+2]};else{let d=_e(t,St);u=_e(d.firestore,Ve),l=d._query;let h=new ri(u);c={next:f=>{e[o]&&e[o](new tr(u,h,d,f))},error:e[o+1],complete:e[o+2]},zP(t._query)}return function(h,f,p,m){let v=new ec(m),C=new jl(f,v,p);return h.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return LE(yield tc(h),C)})),()=>{v.Qa(),h.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return jE(yield tc(h),C)}))}}(dt(u),l,a,c)}function dk(t,e){return s8(dt(t=_e(t,Ve)),lE(e)?e:{next:e})}function uc(t,e){return function(r,i){let s=new st;return r.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return L$(yield KE(r),i,s)})),s.promise}(dt(t),e)}function cI(t,e,n){let r=n.docs.get(e._key),i=new ri(t);return new kn(t,i,e._key,r,new Xr(n.hasPendingWrites,n.fromCache),e.converter)}var d8={maxAttempts:5};var kg=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=co(e)}set(e,n,r){this._verifyNotCommitted();let i=Fi(e,this._firestore),s=$g(i.converter,n,r),o=Bg(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,qe.none())),this}update(e,n,r,...i){this._verifyNotCommitted();let s=Fi(e,this._firestore),o;return o=typeof(n=le(n))=="string"||n instanceof er?tI(this._dataReader,"WriteBatch.update",s._key,n,r,i):eI(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,qe.exists(!0))),this}delete(e){this._verifyNotCommitted();let n=Fi(e,this._firestore);return this._mutations=this._mutations.concat(new Wi(n._key,qe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new x(y.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Fi(t,e){if((t=le(t)).firestore!==e)throw new x(y.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var IE=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=co(n)}get(n){let r=Fi(n,this._firestore),i=new EE(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return k();let o=s[0];if(o.isFoundDocument())return new so(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new so(this._firestore,i,r._key,null,r.converter);throw k()})}set(n,r,i){let s=Fi(n,this._firestore),o=$g(s.converter,r,i),a=Bg(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){let o=Fi(n,this._firestore),a;return a=typeof(r=le(r))=="string"||r instanceof er?tI(this._dataReader,"Transaction.update",o._key,r,i,s):eI(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){let r=Fi(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){let n=Fi(e,this._firestore),r=new ri(this._firestore);return super.get(e).then(i=>new kn(this._firestore,r,n._key,i._document,new Xr(!1,!1),n.converter))}};function hk(t,e,n){t=_e(t,Ve);let r=Object.assign(Object.assign({},d8),n);return function(s){if(s.maxAttempts<1)throw new x(y.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new st;return s.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let u=yield e8(s);new oE(s.asyncQueue,u,a,o,c).Ya()})),c.promise}(dt(t),i=>e(new IE(t,i)),r)}function fk(){return new $l("deleteField")}function pk(){return new pE("serverTimestamp")}function gk(...t){return new gE("arrayUnion",t)}function mk(...t){return new mE("arrayRemove",t)}function _k(t){return new _E("increment",t)}(function(e,n=!0){(function(i){rc=i})(Gd),as(new cn("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Ve(new Sx(r.getProvider("auth-internal")),new Nx(r.getProvider("app-check-internal")),function(u,l){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new x(y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $i(u.options.projectId,l)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Ln(ZM,"4.5.1",e),Ln(ZM,"4.5.1","esm2017")})();var h8="@firebase/firestore-compat",f8="0.3.28";function pI(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new x("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function yk(){if(typeof Uint8Array>"u")throw new x("unimplemented","Uint8Arrays are not available in this environment.")}function vk(){if(!uN())throw new x("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Hg=class t{constructor(e){this._delegate=e}static fromBase64String(e){return vk(),new t(Ar.fromBase64String(e))}static fromUint8Array(e){return yk(),new t(Ar.fromUint8Array(e))}toBase64(){return vk(),this._delegate.toBase64()}toUint8Array(){return yk(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function uI(t){return p8(t,["next","error","complete"])}function p8(t,e){if(typeof t!="object"||t===null)return!1;let n=t;for(let r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}var lI=class{enableIndexedDbPersistence(e,n){return MP(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return RP(e._delegate)}clearIndexedDbPersistence(e){return PP(e._delegate)}},qg=class{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof $i||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Nn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){DP(this._delegate,e,n,r)}enableNetwork(){return OP(this._delegate)}disableNetwork(){return FP(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,YE("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return kP(this._delegate)}onSnapshotsInSync(e){return dk(this._delegate,e)}get app(){if(!this._appCompat)throw new x("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new hc(this,ZE(this._delegate,e))}catch(n){throw Kt(n,"collection()","Firestore.collection()")}}doc(e){try{return new Mr(this,Yl(this._delegate,e))}catch(n){throw Kt(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new po(this,TP(this._delegate,e))}catch(n){throw Kt(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return hk(this._delegate,n=>e(new Gg(this,n)))}batch(){return dt(this._delegate),new zg(new kg(this._delegate,e=>uc(this._delegate,e)))}loadBundle(e){return VP(this._delegate,e)}namedQuery(e){return LP(this._delegate,e).then(n=>n?new po(this,n):null)}},lc=class extends nc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Hg(new Ar(e))}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return Mr.forKey(n,this.firestore,null)}};function g8(t){ZR(t)}var Gg=class{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new lc(e)}get(e){let n=lo(e);return this._delegate.get(n).then(r=>new ho(this._firestore,new kn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){let i=lo(e);return r?(pI("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=lo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=lo(e);return this._delegate.delete(n),this}},zg=class{constructor(e){this._delegate=e}set(e,n,r){let i=lo(e);return r?(pI("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=lo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=lo(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}},dc=class t{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){let r=new Li(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new fo(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){let r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new t(e,new lc(e),n),i.set(n,s)),s}};dc.INSTANCES=new WeakMap;var Mr=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new lc(e)}static forPath(e,n,r){if(e.length%2!==0)throw new x("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new t(n,new Re(n._delegate,r,new M(e)))}static forKey(e,n,r){return new t(n,new Re(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new hc(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new hc(this.firestore,ZE(this._delegate,e))}catch(n){throw Kt(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=le(e),e instanceof Re?XE(this._delegate,e):!1}set(e,n){n=pI("DocumentReference.set",n);try{return n?sI(this._delegate,e,n):sI(this._delegate,e)}catch(r){throw Kt(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?oI(this._delegate,e):oI(this._delegate,e,n,...r)}catch(i){throw Kt(i,"updateDoc()","DocumentReference.update()")}}delete(){return uk(this._delegate)}onSnapshot(...e){let n=xk(e),r=wk(e,i=>new ho(this.firestore,new kn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return aI(this._delegate,n,r)}get(e){let n;return e?.source==="cache"?n=ik(this._delegate):e?.source==="server"?n=sk(this._delegate):n=rk(this._delegate),n.then(r=>new ho(this.firestore,new kn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(dc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Kt(t,e,n){return t.message=t.message.replace(e,n),t}function xk(t){for(let e of t)if(typeof e=="object"&&!uI(e))return e;return{}}function wk(t,e){var n,r;let i;return uI(t[0])?i=t[0]:uI(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var ho=class{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new Mr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return iI(this._delegate,e._delegate)}},fo=class extends ho{data(e){let n=this._delegate.data(e);return this._delegate._converter||XR(n!==void 0,"Document in a QueryDocumentSnapshot should exist"),n}},po=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new lc(e)}where(e,n,r){try{return new t(this.firestore,si(this._delegate,WP(e,n,r)))}catch(i){throw Kt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new t(this.firestore,si(this._delegate,KP(e,n)))}catch(r){throw Kt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new t(this.firestore,si(this._delegate,QP(e)))}catch(n){throw Kt(n,"limit()","Query.limit()")}}limitToLast(e){try{return new t(this.firestore,si(this._delegate,YP(e)))}catch(n){throw Kt(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new t(this.firestore,si(this._delegate,ZP(...e)))}catch(n){throw Kt(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new t(this.firestore,si(this._delegate,XP(...e)))}catch(n){throw Kt(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new t(this.firestore,si(this._delegate,JP(...e)))}catch(n){throw Kt(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new t(this.firestore,si(this._delegate,ek(...e)))}catch(n){throw Kt(n,"endAt()","Query.endAt()")}}isEqual(e){return JE(this._delegate,e._delegate)}get(e){let n;return e?.source==="cache"?n=ak(this._delegate):e?.source==="server"?n=ck(this._delegate):n=ok(this._delegate),n.then(r=>new Zl(this.firestore,new tr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let n=xk(e),r=wk(e,i=>new Zl(this.firestore,new tr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return aI(this._delegate,n,r)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(dc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},dI=class{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new fo(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Zl=class{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new po(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new fo(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new dI(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new fo(this._firestore,r))})}isEqual(e){return iI(this._delegate,e._delegate)}},hc=class t extends po{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Mr(this.firestore,e):null}doc(e){try{return e===void 0?new Mr(this.firestore,Yl(this._delegate)):new Mr(this.firestore,Yl(this._delegate,e))}catch(n){throw Kt(n,"doc()","CollectionReference.doc()")}}add(e){return lk(this._delegate,e).then(n=>new Mr(this.firestore,n))}isEqual(e){return XE(this._delegate,e._delegate)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(dc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function lo(t){return _e(t,Re)}var hI=class t{constructor(...e){this._delegate=new er(...e)}static documentId(){return new t(Ke.keyField().canonicalString())}isEqual(e){return e=le(e),e instanceof er?this._delegate._internalPath.isEqual(e._internalPath):!1}};var fI=class t{constructor(e){this._delegate=e}static serverTimestamp(){let e=pk();return e._methodName="FieldValue.serverTimestamp",new t(e)}static delete(){let e=fk();return e._methodName="FieldValue.delete",new t(e)}static arrayUnion(...e){let n=gk(...e);return n._methodName="FieldValue.arrayUnion",new t(n)}static arrayRemove(...e){let n=mk(...e);return n._methodName="FieldValue.arrayRemove",new t(n)}static increment(e){let n=_k(e);return n._methodName="FieldValue.increment",new t(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var m8={Firestore:qg,GeoPoint:io,Timestamp:je,Blob:Hg,Transaction:Gg,WriteBatch:zg,DocumentReference:Mr,DocumentSnapshot:ho,Query:po,QueryDocumentSnapshot:fo,QuerySnapshot:Zl,CollectionReference:hc,FieldPath:hI,FieldValue:fI,setLogLevel:g8,CACHE_SIZE_UNLIMITED:SP};function _8(t,e){t.INTERNAL.registerComponent(new cn("firestore-compat",n=>{let r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},m8)))}function y8(t){_8(t,(e,n)=>new qg(e,n,new lI)),t.registerVersion(h8,f8)}y8(xt);function v8(t,e=hs){return new ie(n=>{let r;return e!=null?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}function Ek(t,e){return v8(t,e)}function x8(t,e){return Ek(t,e).pipe(ps(void 0),Hc(),j(n=>{let[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function _I(t,e){return Ek(t,e).pipe(j(n=>({payload:n,type:"query"})))}var Wg=class{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){let r=this.ref.collection(e),{ref:i,query:s}=bk(r,n);return new Qg(i,s,this.afs)}snapshotChanges(){return x8(this.ref,this.afs.schedulers.outsideAngular).pipe(ze)}valueChanges(e={}){return this.snapshotChanges().pipe(j(({payload:n})=>e.idField?ue(A({},n.data()),{[e.idField]:n.id}):n.data()))}get(e){return ye(this.ref.get(e)).pipe(ze)}};function Kg(t,e){return _I(t,e).pipe(ps(void 0),Hc(),j(n=>{let[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,c)=>{let u=s.find(d=>d.doc.ref.isEqual(a.ref)),l=r?.payload.docs.find(d=>d.ref.isEqual(a.ref));u&&JSON.stringify(u.doc.metadata)===JSON.stringify(a.metadata)||!u&&l&&JSON.stringify(l.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),o}))}function Ik(t,e,n){return Kg(t,n).pipe(or((r,i)=>w8(r,i.map(s=>s.payload),e),[]),Uc(),j(r=>r.map(i=>({type:i.type,payload:i}))))}function w8(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=E8(t,r))}),t}function gI(t,e,n,...r){let i=t.slice();return i.splice(e,n,...r),i}function E8(t,e){switch(e.type){case"added":if(!(t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)))return gI(t,e.newIndex,0,e);break;case"modified":if(t[e.oldIndex]==null||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}else return gI(t,e.newIndex,1,e);break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return gI(t,e.oldIndex,1);break}return t}function Ck(t){return(!t||t.length===0)&&(t=["added","removed","modified"]),t}var Qg=class{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=Kg(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(j(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(ps(void 0),Hc(),It(([r,i])=>i.length>0||!r),j(([,r])=>r),ze)}auditTrail(e){return this.stateChanges(e).pipe(or((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=Ck(e);return Ik(this.query,n,this.afs.schedulers.outsideAngular).pipe(ze)}valueChanges(e={}){return _I(this.query,this.afs.schedulers.outsideAngular).pipe(j(n=>n.payload.docs.map(r=>e.idField?ue(A({},r.data()),{[e.idField]:r.id}):r.data())),ze)}get(e){return ye(this.query.get(e)).pipe(ze)}add(e){return this.ref.add(e)}doc(e){return new Wg(this.ref.doc(e),this.afs)}},mI=class{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return!e||e.length===0?Kg(this.query,this.afs.schedulers.outsideAngular).pipe(ze):Kg(this.query,this.afs.schedulers.outsideAngular).pipe(j(n=>n.filter(r=>e.indexOf(r.type)>-1)),It(n=>n.length>0),ze)}auditTrail(e){return this.stateChanges(e).pipe(or((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=Ck(e);return Ik(this.query,n,this.afs.schedulers.outsideAngular).pipe(ze)}valueChanges(e={}){return _I(this.query,this.afs.schedulers.outsideAngular).pipe(j(r=>r.payload.docs.map(i=>e.idField?A({[e.idField]:i.id},i.data()):i.data())),ze)}get(e){return ye(this.query.get(e)).pipe(ze)}},I8=new O("angularfire2.enableFirestorePersistence"),C8=new O("angularfire2.firestore.persistenceSettings"),b8=new O("angularfire2.firestore.settings"),D8=new O("angularfire2.firestore.use-emulator");function bk(t,e=n=>n){return{query:e(t),ref:t}}var fc=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,c,u,l,d,h,f,p,m,v,C,F){this.schedulers=c;let T=Fs(n,a,r),H=l;d&&Uu(T,a,h,p,m,v,f,C),[this.firestore,this.persistenceEnabled$]=xa(`${T.name}.firestore`,"AngularFirestore",T.name,()=>{let z=a.runOutsideAngular(()=>T.firestore());if(s&&z.settings(s),H&&z.useEmulator(...H),i&&!Ms(o)){let Y=()=>{try{return ye(z.enablePersistence(u||void 0).then(()=>!0,()=>!1))}catch(be){return typeof console<"u"&&console.warn(be),B(!1)}};return[z,a.runOutsideAngular(Y)]}else return[z,B(!1)]},[s,H,i])}collection(n,r){let i;typeof n=="string"?i=this.firestore.collection(n):i=n;let{ref:s,query:o}=bk(i,r),a=this.schedulers.ngZone.run(()=>s);return new Qg(a,o,this)}collectionGroup(n,r){let i=r||(o=>o),s=this.firestore.collectionGroup(n);return new mI(i(s),this)}doc(n){let r;typeof n=="string"?r=this.firestore.doc(n):r=n;let i=this.schedulers.ngZone.run(()=>r);return new Wg(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(w(Ai),w(Mi,8),w(I8,8),w(b8,8),w(Mt),w(de),w(va),w(C8,8),w(D8,8),w(Jf,8),w(Ou,8),w(Fu,8),w(Vu,8),w(Lu,8),w(ju,8),w(Bu,8),w(Kr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var Yg=(()=>{let e=class e{constructor(r){this.firestore=r}getTransacciones(){return g(this,null,function*(){return yield this.parseData(this.firestore.collection("transacciones").snapshotChanges())})}getTransaccionById(r){return g(this,null,function*(){return(yield this.parseData(this.firestore.collection("transacciones",s=>s.where("id","==",r)).snapshotChanges()))[0]})}parseData(r){let i=[];return new Promise(s=>{r.subscribe(o=>{i=o.map(a=>ue(A({},a.payload.doc.data()),{id:a.payload.doc.id})),s(i)})})}createTransaccion(r){return g(this,null,function*(){return yield this.firestore.collection("transacciones").add(Object.assign({},r))})}updateTransaccion(r){return g(this,null,function*(){yield this.firestore.doc("transacciones/"+r.id).update(r)})}deleteTransaccion(r){return g(this,null,function*(){yield this.firestore.doc("transacciones/"+r).delete()})}};e.\u0275fac=function(i){return new(i||e)(w(fc))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Tk=(()=>{let e=class e{constructor(r,i){this.firestore=r,this.transaccionService=i}getCoches(){return g(this,null,function*(){return yield this.parseData(this.firestore.collection("coches").snapshotChanges())})}getCocheById(r){return g(this,null,function*(){return new Promise(i=>{this.firestore.doc("coches/"+r).valueChanges().subscribe(s=>{i(s)})})})}parseData(r){let i=[];return new Promise(s=>{r.subscribe(o=>{i=o.map(a=>ue(A({},a.payload.doc.data()),{id:a.payload.doc.id})),s(i)})})}addTransaccion(r,i){return g(this,null,function*(){let s=yield this.getCocheById(r);s.transacciones.push(i),yield this.updateCoche(s)})}sellCoche(r,i,s,o){return g(this,null,function*(){let a=yield this.getCocheById(r);a.vendido=!0;let c=yield this.transaccionService.createTransaccion(new ks({fecha:new Date().toLocaleString(),precio:a.precio,metodoPago:o,coche:r,cliente:i,tipo:"venta"})),{id:u}=yield c.get();yield this.addTransaccion(r,u),yield this.updateCoche(a)})}createCoche(r){return g(this,null,function*(){return yield this.firestore.collection("coches").add(Object.assign({},r))})}updateCoche(r){return g(this,null,function*(){yield this.firestore.doc("coches/"+r.id).update(r)})}deleteCoche(r){return g(this,null,function*(){console.log(...S8("1694024615_130_4_130_24_4",r)),yield this.firestore.doc("coches/"+r).delete()})}};e.\u0275fac=function(i){return new(i||e)(w(fc),w(Yg))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function T8(){try{return(0,eval)("globalThis._console_ninja")||(0,eval)(`/* https://github.com/wallabyjs/console-ninja#how-does-it-work */'use strict';var _0x24ae32=_0xe1a3;function _0x47ba(){var _0x4d9a5e=['bind','_isSet','autoExpandMaxDepth','_type','ws/index.js','data','_inNextEdge','null','location','Set','_processTreeNodeResult','autoExpandPropertyCount','Console\\x20Ninja\\x20failed\\x20to\\x20send\\x20logs,\\x20refreshing\\x20the\\x20page\\x20may\\x20help;\\x20also\\x20see\\x20','method','test','symbol','elapsed','unknown','next.js','_objectToString','_Symbol','getOwnPropertyDescriptor','onclose','global','setter','totalStrLength','send','prototype','edge','_getOwnPropertyNames','hasOwnProperty','includes','readyState','NEXT_RUNTIME','disabledTrace','_quotedRegExp','get','timeStamp','_webSocketErrorDocsLink','_disposeWebsocket','_addProperty','_setNodeId','_addObjectProperty','_console_ninja','_connectAttemptCount','angular','_setNodePermissions','_isNegativeZero','gateway.docker.internal','203717gUxSbO','_setNodeLabel','onopen','_WebSocketClass','disabledLog','_connectToHostNow','join','_HTMLAllCollection','_allowedToConnectOnSend','hrtime','negativeZero',"c:\\\\Users\\\\gatit\\\\.vscode\\\\extensions\\\\wallabyjs.console-ninja-1.0.297\\\\node_modules",'','negativeInfinity','unshift','count','_treeNodePropertiesBeforeFullValue','[object\\x20Map]','port','_sendErrorMessage','type','4682442WbbGyT','current','_reconnectTimeout','287NLwPsb','parent','120968WxcRNU','hostname','_isMap','capped','valueOf','log','function','_addFunctionsNode','dockerizedApp','array','_getOwnPropertySymbols','funcName','process','name','stack','reload','angular','logger\\x20failed\\x20to\\x20connect\\x20to\\x20host','defineProperty','_sortProps','astro','getter','trace','bigint','pathToFileURL','_inBrowser','_connected','stringify','_propertyName','resolveGetters','replace','serialize','NEGATIVE_INFINITY','\\x20server','value','_isPrimitiveType','_dateToString','path','message','_ws','_setNodeExpandableState','_p_length','POSITIVE_INFINITY','allStrLength','_hasMapOnItsPath','error','call','env','toString','Map','_attemptToReconnectShortly','coverage','hits','14326697OpwenA','_isPrimitiveWrapperType','autoExpandLimit','nuxt','ws://','autoExpand','sortProps','now','node','_cleanNode','set','_socket','_blacklistedProperty','perf_hooks','6290InhSfe','autoExpandPreviousObjects','sort','time','substr','Number','timeEnd','WebSocket','strLength','length','props','1.0.0','cappedElements','_console_ninja_session','getOwnPropertyNames','forEach','getWebSocketClass','_treeNodePropertiesAfterFullValue','_isUndefined','1046TxPxjD','toLowerCase','then','_p_name','date','undefined','_addLoadNode','string','push','6404eXURFg','split','1395iTYYhf','HTMLAllCollection','Console\\x20Ninja\\x20failed\\x20to\\x20send\\x20logs,\\x20restarting\\x20the\\x20process\\x20may\\x20help;\\x20also\\x20see\\x20','_allowedToSend','performance','_undefined','_additionalMetadata','object','RegExp','versions','_maxConnectAttemptCount','nan','logger\\x20failed\\x20to\\x20connect\\x20to\\x20host,\\x20see\\x20','warn','Error','getPrototypeOf','match','5109sYAtuQ','expressionsToEvaluate','_capIfString','_connecting','console','catch','number','_consoleNinjaAllowedToStart','slice','indexOf','constructor','noFunctions','level','unref','_property','','_setNodeExpressionPath','15048JnNmqV','127.0.0.1','concat','elements','_hasSymbolPropertyOnItsPath','__es'+'Module','depth','host','nodeModules','create','getOwnPropertySymbols','_numberRegExp','stackTraceLimit','boolean','_regExpToString','onerror','60394','_setNodeQueryPath','expId','logger\\x20websocket\\x20error','[object\\x20Array]','default','reduceLimits','index','String','isExpressionToEvaluate','_p_'];_0x47ba=function(){return _0x4d9a5e;};return _0x47ba();}(function(_0x13cea9,_0x4bbe7e){var _0x52657b=_0xe1a3,_0x4ab941=_0x13cea9();while(!![]){try{var _0x565148=parseInt(_0x52657b(0x112))/0x1+parseInt(_0x52657b(0x182))/0x2*(parseInt(_0x52657b(0x19e))/0x3)+parseInt(_0x52657b(0x18b))/0x4*(-parseInt(_0x52657b(0x18d))/0x5)+parseInt(_0x52657b(0x127))/0x6+-parseInt(_0x52657b(0x12a))/0x7*(parseInt(_0x52657b(0x12c))/0x8)+parseInt(_0x52657b(0x1af))/0x9*(parseInt(_0x52657b(0x16f))/0xa)+-parseInt(_0x52657b(0x161))/0xb;if(_0x565148===_0x4bbe7e)break;else _0x4ab941['push'](_0x4ab941['shift']());}catch(_0x421755){_0x4ab941['push'](_0x4ab941['shift']());}}}(_0x47ba,0x88166));var j=Object[_0x24ae32(0xcf)],H=Object[_0x24ae32(0x13e)],G=Object[_0x24ae32(0xf6)],ee=Object['getOwnPropertyNames'],te=Object[_0x24ae32(0x19c)],ne=Object[_0x24ae32(0xfc)][_0x24ae32(0xff)],re=(_0x4d3738,_0x236e14,_0x3098ae,_0x375e86)=>{var _0x2e9e42=_0x24ae32;if(_0x236e14&&typeof _0x236e14=='object'||typeof _0x236e14==_0x2e9e42(0x132)){for(let _0x20a893 of ee(_0x236e14))!ne['call'](_0x4d3738,_0x20a893)&&_0x20a893!==_0x3098ae&&H(_0x4d3738,_0x20a893,{'get':()=>_0x236e14[_0x20a893],'enumerable':!(_0x375e86=G(_0x236e14,_0x20a893))||_0x375e86['enumerable']});}return _0x4d3738;},x=(_0x4ceb6e,_0x1d4c6c,_0x157aca)=>(_0x157aca=_0x4ceb6e!=null?j(te(_0x4ceb6e)):{},re(_0x1d4c6c||!_0x4ceb6e||!_0x4ceb6e[_0x24ae32(0xcb)]?H(_0x157aca,_0x24ae32(0xdb),{'value':_0x4ceb6e,'enumerable':!0x0}):_0x157aca,_0x4ceb6e)),X=class{constructor(_0x259cec,_0x17e41c,_0x5f15f2,_0x5d1b89,_0x319187){var _0x2640a4=_0x24ae32;this[_0x2640a4(0xf8)]=_0x259cec,this[_0x2640a4(0xcd)]=_0x17e41c,this[_0x2640a4(0x124)]=_0x5f15f2,this[_0x2640a4(0xce)]=_0x5d1b89,this['dockerizedApp']=_0x319187,this[_0x2640a4(0x190)]=!0x0,this[_0x2640a4(0x11a)]=!0x0,this[_0x2640a4(0x146)]=!0x1,this[_0x2640a4(0x1a1)]=!0x1,this[_0x2640a4(0xe7)]=_0x259cec[_0x2640a4(0x138)]?.[_0x2640a4(0x15b)]?.[_0x2640a4(0x102)]==='edge',this['_inBrowser']=!this[_0x2640a4(0xf8)]['process']?.['versions']?.['node']&&!this['_inNextEdge'],this[_0x2640a4(0x115)]=null,this[_0x2640a4(0x10d)]=0x0,this[_0x2640a4(0x197)]=0x14,this[_0x2640a4(0x107)]='https://tinyurl.com/37x8b79t',this['_sendErrorMessage']=(this[_0x2640a4(0x145)]?_0x2640a4(0xed):_0x2640a4(0x18f))+this[_0x2640a4(0x107)];}async[_0x24ae32(0x17f)](){var _0x513466=_0x24ae32;if(this['_WebSocketClass'])return this[_0x513466(0x115)];let _0x547a9b;if(this['_inBrowser']||this[_0x513466(0xe7)])_0x547a9b=this[_0x513466(0xf8)][_0x513466(0x176)];else{if(this[_0x513466(0xf8)][_0x513466(0x138)]?.['_WebSocket'])_0x547a9b=this['global'][_0x513466(0x138)]?.['_WebSocket'];else try{let _0x133a32=await import(_0x513466(0x151));_0x547a9b=(await import((await import('url'))[_0x513466(0x144)](_0x133a32[_0x513466(0x118)](this['nodeModules'],_0x513466(0xe5)))['toString']()))[_0x513466(0xdb)];}catch{try{_0x547a9b=require(require(_0x513466(0x151))['join'](this['nodeModules'],'ws'));}catch{throw new Error('failed\\x20to\\x20find\\x20and\\x20load\\x20WebSocket');}}}return this[_0x513466(0x115)]=_0x547a9b,_0x547a9b;}[_0x24ae32(0x117)](){var _0x2c0ef5=_0x24ae32;this[_0x2c0ef5(0x1a1)]||this[_0x2c0ef5(0x146)]||this[_0x2c0ef5(0x10d)]>=this[_0x2c0ef5(0x197)]||(this[_0x2c0ef5(0x11a)]=!0x1,this[_0x2c0ef5(0x1a1)]=!0x0,this[_0x2c0ef5(0x10d)]++,this[_0x2c0ef5(0x153)]=new Promise((_0x44c1c5,_0x4c50ec)=>{var _0x4e7a9e=_0x2c0ef5;this['getWebSocketClass']()[_0x4e7a9e(0x184)](_0x1c0d89=>{var _0x18e890=_0x4e7a9e;let _0x534f30=new _0x1c0d89(_0x18e890(0x165)+(!this[_0x18e890(0x145)]&&this[_0x18e890(0x134)]?_0x18e890(0x111):this[_0x18e890(0xcd)])+':'+this['port']);_0x534f30['onerror']=()=>{var _0x29bc9f=_0x18e890;this['_allowedToSend']=!0x1,this[_0x29bc9f(0x108)](_0x534f30),this[_0x29bc9f(0x15e)](),_0x4c50ec(new Error(_0x29bc9f(0xd9)));},_0x534f30['onopen']=()=>{var _0x58424d=_0x18e890;this[_0x58424d(0x145)]||_0x534f30[_0x58424d(0x16c)]&&_0x534f30[_0x58424d(0x16c)][_0x58424d(0x1ab)]&&_0x534f30[_0x58424d(0x16c)][_0x58424d(0x1ab)](),_0x44c1c5(_0x534f30);},_0x534f30[_0x18e890(0xf7)]=()=>{var _0x136633=_0x18e890;this[_0x136633(0x11a)]=!0x0,this[_0x136633(0x108)](_0x534f30),this[_0x136633(0x15e)]();},_0x534f30['onmessage']=_0x1ca84d=>{var _0x397b0c=_0x18e890;try{_0x1ca84d&&_0x1ca84d[_0x397b0c(0xe6)]&&this[_0x397b0c(0x145)]&&JSON['parse'](_0x1ca84d[_0x397b0c(0xe6)])[_0x397b0c(0xee)]===_0x397b0c(0x13b)&&this[_0x397b0c(0xf8)][_0x397b0c(0xe9)][_0x397b0c(0x13b)]();}catch{}};})[_0x4e7a9e(0x184)](_0x481d4f=>(this['_connected']=!0x0,this[_0x4e7a9e(0x1a1)]=!0x1,this[_0x4e7a9e(0x11a)]=!0x1,this[_0x4e7a9e(0x190)]=!0x0,this[_0x4e7a9e(0x10d)]=0x0,_0x481d4f))[_0x4e7a9e(0x1a3)](_0x404cdc=>(this[_0x4e7a9e(0x146)]=!0x1,this['_connecting']=!0x1,console[_0x4e7a9e(0x19a)](_0x4e7a9e(0x199)+this[_0x4e7a9e(0x107)]),_0x4c50ec(new Error('failed\\x20to\\x20connect\\x20to\\x20host:\\x20'+(_0x404cdc&&_0x404cdc['message'])))));}));}[_0x24ae32(0x108)](_0x2e3168){var _0x17cffd=_0x24ae32;this['_connected']=!0x1,this[_0x17cffd(0x1a1)]=!0x1;try{_0x2e3168[_0x17cffd(0xf7)]=null,_0x2e3168[_0x17cffd(0xd5)]=null,_0x2e3168[_0x17cffd(0x114)]=null;}catch{}try{_0x2e3168[_0x17cffd(0x101)]<0x2&&_0x2e3168['close']();}catch{}}[_0x24ae32(0x15e)](){var _0xcfd15=_0x24ae32;clearTimeout(this['_reconnectTimeout']),!(this[_0xcfd15(0x10d)]>=this[_0xcfd15(0x197)])&&(this[_0xcfd15(0x129)]=setTimeout(()=>{var _0x6ff8c5=_0xcfd15;this['_connected']||this[_0x6ff8c5(0x1a1)]||(this['_connectToHostNow'](),this[_0x6ff8c5(0x153)]?.[_0x6ff8c5(0x1a3)](()=>this[_0x6ff8c5(0x15e)]()));},0x1f4),this['_reconnectTimeout'][_0xcfd15(0x1ab)]&&this[_0xcfd15(0x129)][_0xcfd15(0x1ab)]());}async[_0x24ae32(0xfb)](_0x51551d){var _0xe92bc5=_0x24ae32;try{if(!this[_0xe92bc5(0x190)])return;this[_0xe92bc5(0x11a)]&&this[_0xe92bc5(0x117)](),(await this[_0xe92bc5(0x153)])[_0xe92bc5(0xfb)](JSON[_0xe92bc5(0x147)](_0x51551d));}catch(_0x3b4c8c){console[_0xe92bc5(0x19a)](this[_0xe92bc5(0x125)]+':\\x20'+(_0x3b4c8c&&_0x3b4c8c['message'])),this[_0xe92bc5(0x190)]=!0x1,this[_0xe92bc5(0x15e)]();}}};function b(_0x2dcc3d,_0x1258f7,_0x28783a,_0x47a70c,_0x49f016,_0x585b74){var _0x4feb5e=_0x24ae32;let _0x4094ff=_0x28783a[_0x4feb5e(0x18c)](',')['map'](_0x398903=>{var _0x4ef02e=_0x4feb5e;try{_0x2dcc3d[_0x4ef02e(0x17c)]||((_0x49f016===_0x4ef02e(0xf3)||_0x49f016==='remix'||_0x49f016===_0x4ef02e(0x140)||_0x49f016===_0x4ef02e(0x13c))&&(_0x49f016+=!_0x2dcc3d[_0x4ef02e(0x138)]?.[_0x4ef02e(0x196)]?.[_0x4ef02e(0x169)]&&_0x2dcc3d[_0x4ef02e(0x138)]?.['env']?.['NEXT_RUNTIME']!==_0x4ef02e(0xfd)?'\\x20browser':_0x4ef02e(0x14d)),_0x2dcc3d[_0x4ef02e(0x17c)]={'id':+new Date(),'tool':_0x49f016});let _0x53ac87=new X(_0x2dcc3d,_0x1258f7,_0x398903,_0x47a70c,_0x585b74);return _0x53ac87[_0x4ef02e(0xfb)][_0x4ef02e(0xe1)](_0x53ac87);}catch(_0x3f7983){return console['warn'](_0x4ef02e(0x13d),_0x3f7983&&_0x3f7983[_0x4ef02e(0x152)]),()=>{};}});return _0x3f96b9=>_0x4094ff[_0x4feb5e(0x17e)](_0x537d76=>_0x537d76(_0x3f96b9));}function _0xe1a3(_0xab75e0,_0x53896b){var _0x47bab1=_0x47ba();return _0xe1a3=function(_0xe1a3e7,_0xd8e4f){_0xe1a3e7=_0xe1a3e7-0xca;var _0xf783d=_0x47bab1[_0xe1a3e7];return _0xf783d;},_0xe1a3(_0xab75e0,_0x53896b);}function W(_0x51ea05){var _0x292973=_0x24ae32;let _0x4c170d=function(_0x215ce1,_0xe9963b){return _0xe9963b-_0x215ce1;},_0x3e5eb9;if(_0x51ea05[_0x292973(0x191)])_0x3e5eb9=function(){var _0x4fd952=_0x292973;return _0x51ea05[_0x4fd952(0x191)][_0x4fd952(0x168)]();};else{if(_0x51ea05[_0x292973(0x138)]&&_0x51ea05[_0x292973(0x138)][_0x292973(0x11b)]&&_0x51ea05['process']?.['env']?.[_0x292973(0x102)]!==_0x292973(0xfd))_0x3e5eb9=function(){var _0x39f8d9=_0x292973;return _0x51ea05['process'][_0x39f8d9(0x11b)]();},_0x4c170d=function(_0x2273d6,_0x1c1932){return 0x3e8*(_0x1c1932[0x0]-_0x2273d6[0x0])+(_0x1c1932[0x1]-_0x2273d6[0x1])/0xf4240;};else try{let {performance:_0x10dace}=require(_0x292973(0x16e));_0x3e5eb9=function(){var _0xb586d7=_0x292973;return _0x10dace[_0xb586d7(0x168)]();};}catch{_0x3e5eb9=function(){return+new Date();};}}return{'elapsed':_0x4c170d,'timeStamp':_0x3e5eb9,'now':()=>Date['now']()};}function J(_0x4cdc41,_0x1eb45c,_0x32e2ae){var _0x2d39c3=_0x24ae32;if(_0x4cdc41[_0x2d39c3(0x1a5)]!==void 0x0)return _0x4cdc41[_0x2d39c3(0x1a5)];let _0x59979b=_0x4cdc41[_0x2d39c3(0x138)]?.[_0x2d39c3(0x196)]?.['node']||_0x4cdc41['process']?.[_0x2d39c3(0x15b)]?.[_0x2d39c3(0x102)]===_0x2d39c3(0xfd);return _0x59979b&&_0x32e2ae===_0x2d39c3(0x164)?_0x4cdc41[_0x2d39c3(0x1a5)]=!0x1:_0x4cdc41[_0x2d39c3(0x1a5)]=_0x59979b||!_0x1eb45c||_0x4cdc41[_0x2d39c3(0xe9)]?.[_0x2d39c3(0x12d)]&&_0x1eb45c[_0x2d39c3(0x100)](_0x4cdc41[_0x2d39c3(0xe9)][_0x2d39c3(0x12d)]),_0x4cdc41[_0x2d39c3(0x1a5)];}function Y(_0x269569,_0xb6c728,_0x309406,_0x583925){var _0x4ff05d=_0x24ae32;_0x269569=_0x269569,_0xb6c728=_0xb6c728,_0x309406=_0x309406,_0x583925=_0x583925;let _0x37f334=W(_0x269569),_0x50d7d1=_0x37f334[_0x4ff05d(0xf1)],_0x41cee5=_0x37f334[_0x4ff05d(0x106)];class _0x4bec75{constructor(){var _0x3f8b65=_0x4ff05d;this['_keyStrRegExp']=/^(?!(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$)[_$a-zA-Z\\xA0-\\uFFFF][_$a-zA-Z0-9\\xA0-\\uFFFF]*$/,this[_0x3f8b65(0xd1)]=/^(0|[1-9][0-9]*)$/,this[_0x3f8b65(0x104)]=/'([^\\\\']|\\\\')*'/,this[_0x3f8b65(0x192)]=_0x269569[_0x3f8b65(0x187)],this[_0x3f8b65(0x119)]=_0x269569[_0x3f8b65(0x18e)],this['_getOwnPropertyDescriptor']=Object[_0x3f8b65(0xf6)],this[_0x3f8b65(0xfe)]=Object[_0x3f8b65(0x17d)],this['_Symbol']=_0x269569['Symbol'],this['_regExpToString']=RegExp[_0x3f8b65(0xfc)]['toString'],this[_0x3f8b65(0x150)]=Date[_0x3f8b65(0xfc)]['toString'];}[_0x4ff05d(0x14b)](_0x3ac2d4,_0x4a4d37,_0x51a527,_0x3adf91){var _0xb164cb=_0x4ff05d,_0x3ebdcd=this,_0x9246a9=_0x51a527[_0xb164cb(0x166)];function _0x3b1f57(_0x4f1712,_0x3b8cad,_0x2f1b1c){var _0x494e5a=_0xb164cb;_0x3b8cad[_0x494e5a(0x126)]='unknown',_0x3b8cad['error']=_0x4f1712[_0x494e5a(0x152)],_0x21d03e=_0x2f1b1c[_0x494e5a(0x169)][_0x494e5a(0x128)],_0x2f1b1c['node']['current']=_0x3b8cad,_0x3ebdcd[_0x494e5a(0x122)](_0x3b8cad,_0x2f1b1c);}try{_0x51a527[_0xb164cb(0x1aa)]++,_0x51a527[_0xb164cb(0x166)]&&_0x51a527['autoExpandPreviousObjects']['push'](_0x4a4d37);var _0x24d749,_0x78e3cb,_0x5ccb05,_0x2e0a3c,_0x3d1eb8=[],_0x4f51de=[],_0x4cabfa,_0x22bc10=this[_0xb164cb(0xe4)](_0x4a4d37),_0x5420bc=_0x22bc10===_0xb164cb(0x135),_0x5dfa74=!0x1,_0x2ee57e=_0x22bc10===_0xb164cb(0x132),_0x4ab493=this[_0xb164cb(0x14f)](_0x22bc10),_0x3cb7f6=this[_0xb164cb(0x162)](_0x22bc10),_0x4a8e0f=_0x4ab493||_0x3cb7f6,_0x42d6f6={},_0xfab32f=0x0,_0x3830ac=!0x1,_0x21d03e,_0x36c761=/^(([1-9]{1}[0-9]*)|0)$/;if(_0x51a527[_0xb164cb(0xcc)]){if(_0x5420bc){if(_0x78e3cb=_0x4a4d37[_0xb164cb(0x178)],_0x78e3cb>_0x51a527[_0xb164cb(0x1b2)]){for(_0x5ccb05=0x0,_0x2e0a3c=_0x51a527[_0xb164cb(0x1b2)],_0x24d749=_0x5ccb05;_0x24d749<_0x2e0a3c;_0x24d749++)_0x4f51de['push'](_0x3ebdcd['_addProperty'](_0x3d1eb8,_0x4a4d37,_0x22bc10,_0x24d749,_0x51a527));_0x3ac2d4[_0xb164cb(0x17b)]=!0x0;}else{for(_0x5ccb05=0x0,_0x2e0a3c=_0x78e3cb,_0x24d749=_0x5ccb05;_0x24d749<_0x2e0a3c;_0x24d749++)_0x4f51de[_0xb164cb(0x18a)](_0x3ebdcd['_addProperty'](_0x3d1eb8,_0x4a4d37,_0x22bc10,_0x24d749,_0x51a527));}_0x51a527[_0xb164cb(0xec)]+=_0x4f51de[_0xb164cb(0x178)];}if(!(_0x22bc10===_0xb164cb(0xe8)||_0x22bc10===_0xb164cb(0x187))&&!_0x4ab493&&_0x22bc10!==_0xb164cb(0xde)&&_0x22bc10!=='Buffer'&&_0x22bc10!=='bigint'){var _0x8450a5=_0x3adf91[_0xb164cb(0x179)]||_0x51a527[_0xb164cb(0x179)];if(this['_isSet'](_0x4a4d37)?(_0x24d749=0x0,_0x4a4d37[_0xb164cb(0x17e)](function(_0x368387){var _0x265c23=_0xb164cb;if(_0xfab32f++,_0x51a527['autoExpandPropertyCount']++,_0xfab32f>_0x8450a5){_0x3830ac=!0x0;return;}if(!_0x51a527[_0x265c23(0xdf)]&&_0x51a527[_0x265c23(0x166)]&&_0x51a527[_0x265c23(0xec)]>_0x51a527[_0x265c23(0x163)]){_0x3830ac=!0x0;return;}_0x4f51de[_0x265c23(0x18a)](_0x3ebdcd['_addProperty'](_0x3d1eb8,_0x4a4d37,_0x265c23(0xea),_0x24d749++,_0x51a527,function(_0x473455){return function(){return _0x473455;};}(_0x368387)));})):this[_0xb164cb(0x12e)](_0x4a4d37)&&_0x4a4d37[_0xb164cb(0x17e)](function(_0x26888d,_0x1fb8b2){var _0x53b543=_0xb164cb;if(_0xfab32f++,_0x51a527[_0x53b543(0xec)]++,_0xfab32f>_0x8450a5){_0x3830ac=!0x0;return;}if(!_0x51a527[_0x53b543(0xdf)]&&_0x51a527[_0x53b543(0x166)]&&_0x51a527[_0x53b543(0xec)]>_0x51a527[_0x53b543(0x163)]){_0x3830ac=!0x0;return;}var _0x41288f=_0x1fb8b2[_0x53b543(0x15c)]();_0x41288f[_0x53b543(0x178)]>0x64&&(_0x41288f=_0x41288f[_0x53b543(0x1a6)](0x0,0x64)+'...'),_0x4f51de[_0x53b543(0x18a)](_0x3ebdcd['_addProperty'](_0x3d1eb8,_0x4a4d37,_0x53b543(0x15d),_0x41288f,_0x51a527,function(_0x9d4cd6){return function(){return _0x9d4cd6;};}(_0x26888d)));}),!_0x5dfa74){try{for(_0x4cabfa in _0x4a4d37)if(!(_0x5420bc&&_0x36c761[_0xb164cb(0xef)](_0x4cabfa))&&!this[_0xb164cb(0x16d)](_0x4a4d37,_0x4cabfa,_0x51a527)){if(_0xfab32f++,_0x51a527[_0xb164cb(0xec)]++,_0xfab32f>_0x8450a5){_0x3830ac=!0x0;break;}if(!_0x51a527[_0xb164cb(0xdf)]&&_0x51a527[_0xb164cb(0x166)]&&_0x51a527[_0xb164cb(0xec)]>_0x51a527[_0xb164cb(0x163)]){_0x3830ac=!0x0;break;}_0x4f51de['push'](_0x3ebdcd['_addObjectProperty'](_0x3d1eb8,_0x42d6f6,_0x4a4d37,_0x22bc10,_0x4cabfa,_0x51a527));}}catch{}if(_0x42d6f6[_0xb164cb(0x155)]=!0x0,_0x2ee57e&&(_0x42d6f6[_0xb164cb(0x185)]=!0x0),!_0x3830ac){var _0x3a6f04=[][_0xb164cb(0x1b1)](this[_0xb164cb(0xfe)](_0x4a4d37))['concat'](this[_0xb164cb(0x136)](_0x4a4d37));for(_0x24d749=0x0,_0x78e3cb=_0x3a6f04[_0xb164cb(0x178)];_0x24d749<_0x78e3cb;_0x24d749++)if(_0x4cabfa=_0x3a6f04[_0x24d749],!(_0x5420bc&&_0x36c761[_0xb164cb(0xef)](_0x4cabfa[_0xb164cb(0x15c)]()))&&!this[_0xb164cb(0x16d)](_0x4a4d37,_0x4cabfa,_0x51a527)&&!_0x42d6f6['_p_'+_0x4cabfa[_0xb164cb(0x15c)]()]){if(_0xfab32f++,_0x51a527['autoExpandPropertyCount']++,_0xfab32f>_0x8450a5){_0x3830ac=!0x0;break;}if(!_0x51a527['isExpressionToEvaluate']&&_0x51a527[_0xb164cb(0x166)]&&_0x51a527[_0xb164cb(0xec)]>_0x51a527[_0xb164cb(0x163)]){_0x3830ac=!0x0;break;}_0x4f51de[_0xb164cb(0x18a)](_0x3ebdcd['_addObjectProperty'](_0x3d1eb8,_0x42d6f6,_0x4a4d37,_0x22bc10,_0x4cabfa,_0x51a527));}}}}}if(_0x3ac2d4[_0xb164cb(0x126)]=_0x22bc10,_0x4a8e0f?(_0x3ac2d4[_0xb164cb(0x14e)]=_0x4a4d37['valueOf'](),this[_0xb164cb(0x1a0)](_0x22bc10,_0x3ac2d4,_0x51a527,_0x3adf91)):_0x22bc10===_0xb164cb(0x186)?_0x3ac2d4[_0xb164cb(0x14e)]=this[_0xb164cb(0x150)][_0xb164cb(0x15a)](_0x4a4d37):_0x22bc10===_0xb164cb(0x143)?_0x3ac2d4[_0xb164cb(0x14e)]=_0x4a4d37['toString']():_0x22bc10===_0xb164cb(0x195)?_0x3ac2d4[_0xb164cb(0x14e)]=this[_0xb164cb(0xd4)][_0xb164cb(0x15a)](_0x4a4d37):_0x22bc10===_0xb164cb(0xf0)&&this[_0xb164cb(0xf5)]?_0x3ac2d4[_0xb164cb(0x14e)]=this['_Symbol'][_0xb164cb(0xfc)][_0xb164cb(0x15c)][_0xb164cb(0x15a)](_0x4a4d37):!_0x51a527[_0xb164cb(0xcc)]&&!(_0x22bc10==='null'||_0x22bc10===_0xb164cb(0x187))&&(delete _0x3ac2d4[_0xb164cb(0x14e)],_0x3ac2d4[_0xb164cb(0x12f)]=!0x0),_0x3830ac&&(_0x3ac2d4['cappedProps']=!0x0),_0x21d03e=_0x51a527['node'][_0xb164cb(0x128)],_0x51a527[_0xb164cb(0x169)][_0xb164cb(0x128)]=_0x3ac2d4,this[_0xb164cb(0x122)](_0x3ac2d4,_0x51a527),_0x4f51de[_0xb164cb(0x178)]){for(_0x24d749=0x0,_0x78e3cb=_0x4f51de[_0xb164cb(0x178)];_0x24d749<_0x78e3cb;_0x24d749++)_0x4f51de[_0x24d749](_0x24d749);}_0x3d1eb8[_0xb164cb(0x178)]&&(_0x3ac2d4[_0xb164cb(0x179)]=_0x3d1eb8);}catch(_0x29e7fc){_0x3b1f57(_0x29e7fc,_0x3ac2d4,_0x51a527);}return this[_0xb164cb(0x193)](_0x4a4d37,_0x3ac2d4),this[_0xb164cb(0x180)](_0x3ac2d4,_0x51a527),_0x51a527[_0xb164cb(0x169)][_0xb164cb(0x128)]=_0x21d03e,_0x51a527[_0xb164cb(0x1aa)]--,_0x51a527['autoExpand']=_0x9246a9,_0x51a527[_0xb164cb(0x166)]&&_0x51a527[_0xb164cb(0x170)]['pop'](),_0x3ac2d4;}['_getOwnPropertySymbols'](_0x1d7ad1){var _0x16fe03=_0x4ff05d;return Object['getOwnPropertySymbols']?Object[_0x16fe03(0xd0)](_0x1d7ad1):[];}[_0x4ff05d(0xe2)](_0x44560b){var _0x4e04b3=_0x4ff05d;return!!(_0x44560b&&_0x269569['Set']&&this['_objectToString'](_0x44560b)==='[object\\x20Set]'&&_0x44560b[_0x4e04b3(0x17e)]);}['_blacklistedProperty'](_0x36f520,_0x132978,_0x152c3c){var _0x16ccd1=_0x4ff05d;return _0x152c3c[_0x16ccd1(0x1a9)]?typeof _0x36f520[_0x132978]==_0x16ccd1(0x132):!0x1;}[_0x4ff05d(0xe4)](_0x50500e){var _0x842566=_0x4ff05d,_0x37f656='';return _0x37f656=typeof _0x50500e,_0x37f656===_0x842566(0x194)?this[_0x842566(0xf4)](_0x50500e)==='[object\\x20Array]'?_0x37f656=_0x842566(0x135):this[_0x842566(0xf4)](_0x50500e)==='[object\\x20Date]'?_0x37f656=_0x842566(0x186):this[_0x842566(0xf4)](_0x50500e)==='[object\\x20BigInt]'?_0x37f656=_0x842566(0x143):_0x50500e===null?_0x37f656=_0x842566(0xe8):_0x50500e[_0x842566(0x1a8)]&&(_0x37f656=_0x50500e[_0x842566(0x1a8)]['name']||_0x37f656):_0x37f656===_0x842566(0x187)&&this['_HTMLAllCollection']&&_0x50500e instanceof this[_0x842566(0x119)]&&(_0x37f656=_0x842566(0x18e)),_0x37f656;}['_objectToString'](_0x45dc58){var _0x41ebef=_0x4ff05d;return Object['prototype'][_0x41ebef(0x15c)]['call'](_0x45dc58);}[_0x4ff05d(0x14f)](_0xcfc0be){var _0x2a8ca4=_0x4ff05d;return _0xcfc0be===_0x2a8ca4(0xd3)||_0xcfc0be===_0x2a8ca4(0x189)||_0xcfc0be==='number';}['_isPrimitiveWrapperType'](_0x10c5f5){var _0x44359b=_0x4ff05d;return _0x10c5f5==='Boolean'||_0x10c5f5===_0x44359b(0xde)||_0x10c5f5===_0x44359b(0x174);}[_0x4ff05d(0x109)](_0x1dd1f9,_0x38aa69,_0x5f01b6,_0x255f5c,_0x2760ad,_0x562ad8){var _0x53308e=this;return function(_0xb79a60){var _0x9980df=_0xe1a3,_0x339b50=_0x2760ad[_0x9980df(0x169)][_0x9980df(0x128)],_0x4a5b55=_0x2760ad[_0x9980df(0x169)][_0x9980df(0xdd)],_0x28a58e=_0x2760ad[_0x9980df(0x169)][_0x9980df(0x12b)];_0x2760ad[_0x9980df(0x169)][_0x9980df(0x12b)]=_0x339b50,_0x2760ad['node'][_0x9980df(0xdd)]=typeof _0x255f5c=='number'?_0x255f5c:_0xb79a60,_0x1dd1f9[_0x9980df(0x18a)](_0x53308e[_0x9980df(0x1ac)](_0x38aa69,_0x5f01b6,_0x255f5c,_0x2760ad,_0x562ad8)),_0x2760ad[_0x9980df(0x169)][_0x9980df(0x12b)]=_0x28a58e,_0x2760ad['node'][_0x9980df(0xdd)]=_0x4a5b55;};}[_0x4ff05d(0x10b)](_0x4fc405,_0x8cf334,_0x56595e,_0x14108a,_0xbed4a,_0x459da6,_0x4c58e7){var _0x376bbd=_0x4ff05d,_0x22da77=this;return _0x8cf334[_0x376bbd(0xe0)+_0xbed4a[_0x376bbd(0x15c)]()]=!0x0,function(_0x2fef76){var _0x437d6a=_0x376bbd,_0x8e1756=_0x459da6[_0x437d6a(0x169)][_0x437d6a(0x128)],_0x1da2e3=_0x459da6[_0x437d6a(0x169)][_0x437d6a(0xdd)],_0x2e3aed=_0x459da6[_0x437d6a(0x169)][_0x437d6a(0x12b)];_0x459da6[_0x437d6a(0x169)][_0x437d6a(0x12b)]=_0x8e1756,_0x459da6[_0x437d6a(0x169)][_0x437d6a(0xdd)]=_0x2fef76,_0x4fc405['push'](_0x22da77[_0x437d6a(0x1ac)](_0x56595e,_0x14108a,_0xbed4a,_0x459da6,_0x4c58e7)),_0x459da6[_0x437d6a(0x169)][_0x437d6a(0x12b)]=_0x2e3aed,_0x459da6['node'][_0x437d6a(0xdd)]=_0x1da2e3;};}[_0x4ff05d(0x1ac)](_0x1da41f,_0x5119e8,_0x3ce2bc,_0x322d92,_0x15fd3a){var _0x49306f=_0x4ff05d,_0x187f22=this;_0x15fd3a||(_0x15fd3a=function(_0x2acb8d,_0x3b5007){return _0x2acb8d[_0x3b5007];});var _0x1c5a8b=_0x3ce2bc[_0x49306f(0x15c)](),_0x2059df=_0x322d92['expressionsToEvaluate']||{},_0x1cddee=_0x322d92[_0x49306f(0xcc)],_0x2f4613=_0x322d92[_0x49306f(0xdf)];try{var _0x256760=this[_0x49306f(0x12e)](_0x1da41f),_0x5464e8=_0x1c5a8b;_0x256760&&_0x5464e8[0x0]==='\\x27'&&(_0x5464e8=_0x5464e8[_0x49306f(0x173)](0x1,_0x5464e8['length']-0x2));var _0x21ea7f=_0x322d92[_0x49306f(0x19f)]=_0x2059df[_0x49306f(0xe0)+_0x5464e8];_0x21ea7f&&(_0x322d92[_0x49306f(0xcc)]=_0x322d92[_0x49306f(0xcc)]+0x1),_0x322d92[_0x49306f(0xdf)]=!!_0x21ea7f;var _0x57543e=typeof _0x3ce2bc==_0x49306f(0xf0),_0x3da362={'name':_0x57543e||_0x256760?_0x1c5a8b:this[_0x49306f(0x148)](_0x1c5a8b)};if(_0x57543e&&(_0x3da362[_0x49306f(0xf0)]=!0x0),!(_0x5119e8===_0x49306f(0x135)||_0x5119e8===_0x49306f(0x19b))){var _0x1a4702=this['_getOwnPropertyDescriptor'](_0x1da41f,_0x3ce2bc);if(_0x1a4702&&(_0x1a4702[_0x49306f(0x16b)]&&(_0x3da362[_0x49306f(0xf9)]=!0x0),_0x1a4702[_0x49306f(0x105)]&&!_0x21ea7f&&!_0x322d92[_0x49306f(0x149)]))return _0x3da362[_0x49306f(0x141)]=!0x0,this[_0x49306f(0xeb)](_0x3da362,_0x322d92),_0x3da362;}var _0x508291;try{_0x508291=_0x15fd3a(_0x1da41f,_0x3ce2bc);}catch(_0x290d66){return _0x3da362={'name':_0x1c5a8b,'type':'unknown','error':_0x290d66['message']},this[_0x49306f(0xeb)](_0x3da362,_0x322d92),_0x3da362;}var _0x1aa7dc=this[_0x49306f(0xe4)](_0x508291),_0x5bdfaa=this[_0x49306f(0x14f)](_0x1aa7dc);if(_0x3da362[_0x49306f(0x126)]=_0x1aa7dc,_0x5bdfaa)this[_0x49306f(0xeb)](_0x3da362,_0x322d92,_0x508291,function(){var _0x5e824a=_0x49306f;_0x3da362['value']=_0x508291[_0x5e824a(0x130)](),!_0x21ea7f&&_0x187f22[_0x5e824a(0x1a0)](_0x1aa7dc,_0x3da362,_0x322d92,{});});else{var _0x32c361=_0x322d92[_0x49306f(0x166)]&&_0x322d92[_0x49306f(0x1aa)]<_0x322d92[_0x49306f(0xe3)]&&_0x322d92[_0x49306f(0x170)][_0x49306f(0x1a7)](_0x508291)<0x0&&_0x1aa7dc!==_0x49306f(0x132)&&_0x322d92[_0x49306f(0xec)]<_0x322d92[_0x49306f(0x163)];_0x32c361||_0x322d92[_0x49306f(0x1aa)]<_0x1cddee||_0x21ea7f?(this[_0x49306f(0x14b)](_0x3da362,_0x508291,_0x322d92,_0x21ea7f||{}),this['_additionalMetadata'](_0x508291,_0x3da362)):this['_processTreeNodeResult'](_0x3da362,_0x322d92,_0x508291,function(){var _0x57c377=_0x49306f;_0x1aa7dc==='null'||_0x1aa7dc===_0x57c377(0x187)||(delete _0x3da362[_0x57c377(0x14e)],_0x3da362[_0x57c377(0x12f)]=!0x0);});}return _0x3da362;}finally{_0x322d92['expressionsToEvaluate']=_0x2059df,_0x322d92[_0x49306f(0xcc)]=_0x1cddee,_0x322d92[_0x49306f(0xdf)]=_0x2f4613;}}[_0x4ff05d(0x1a0)](_0x1f840b,_0x47afb5,_0x1bd95a,_0x411db7){var _0x3d88c7=_0x4ff05d,_0x5d3807=_0x411db7['strLength']||_0x1bd95a['strLength'];if((_0x1f840b===_0x3d88c7(0x189)||_0x1f840b==='String')&&_0x47afb5[_0x3d88c7(0x14e)]){let _0x9cbb4=_0x47afb5['value'][_0x3d88c7(0x178)];_0x1bd95a[_0x3d88c7(0x157)]+=_0x9cbb4,_0x1bd95a[_0x3d88c7(0x157)]>_0x1bd95a['totalStrLength']?(_0x47afb5[_0x3d88c7(0x12f)]='',delete _0x47afb5[_0x3d88c7(0x14e)]):_0x9cbb4>_0x5d3807&&(_0x47afb5[_0x3d88c7(0x12f)]=_0x47afb5[_0x3d88c7(0x14e)]['substr'](0x0,_0x5d3807),delete _0x47afb5['value']);}}['_isMap'](_0x22eda0){var _0x228921=_0x4ff05d;return!!(_0x22eda0&&_0x269569[_0x228921(0x15d)]&&this[_0x228921(0xf4)](_0x22eda0)===_0x228921(0x123)&&_0x22eda0[_0x228921(0x17e)]);}[_0x4ff05d(0x148)](_0x3ecb1a){var _0x3146de=_0x4ff05d;if(_0x3ecb1a[_0x3146de(0x19d)](/^\\d+$/))return _0x3ecb1a;var _0x28e676;try{_0x28e676=JSON[_0x3146de(0x147)](''+_0x3ecb1a);}catch{_0x28e676='\\x22'+this[_0x3146de(0xf4)](_0x3ecb1a)+'\\x22';}return _0x28e676[_0x3146de(0x19d)](/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?_0x28e676=_0x28e676[_0x3146de(0x173)](0x1,_0x28e676[_0x3146de(0x178)]-0x2):_0x28e676=_0x28e676['replace'](/'/g,'\\x5c\\x27')[_0x3146de(0x14a)](/\\\\"/g,'\\x22')[_0x3146de(0x14a)](/(^"|"$)/g,'\\x27'),_0x28e676;}[_0x4ff05d(0xeb)](_0x4ce195,_0x4122a6,_0x1d510f,_0x18ed5f){var _0x2ee252=_0x4ff05d;this['_treeNodePropertiesBeforeFullValue'](_0x4ce195,_0x4122a6),_0x18ed5f&&_0x18ed5f(),this['_additionalMetadata'](_0x1d510f,_0x4ce195),this[_0x2ee252(0x180)](_0x4ce195,_0x4122a6);}[_0x4ff05d(0x122)](_0x4309aa,_0x43ca8b){var _0x317ae6=_0x4ff05d;this[_0x317ae6(0x10a)](_0x4309aa,_0x43ca8b),this[_0x317ae6(0xd7)](_0x4309aa,_0x43ca8b),this[_0x317ae6(0x1ae)](_0x4309aa,_0x43ca8b),this[_0x317ae6(0x10f)](_0x4309aa,_0x43ca8b);}[_0x4ff05d(0x10a)](_0xa533dd,_0x4418e6){}[_0x4ff05d(0xd7)](_0x2f284d,_0xbe983c){}[_0x4ff05d(0x113)](_0x25f09c,_0x2a92c3){}[_0x4ff05d(0x181)](_0x54d912){var _0x1a4d36=_0x4ff05d;return _0x54d912===this[_0x1a4d36(0x192)];}[_0x4ff05d(0x180)](_0x401b38,_0x3bcc58){var _0x3e560b=_0x4ff05d;this[_0x3e560b(0x113)](_0x401b38,_0x3bcc58),this[_0x3e560b(0x154)](_0x401b38),_0x3bcc58[_0x3e560b(0x167)]&&this[_0x3e560b(0x13f)](_0x401b38),this['_addFunctionsNode'](_0x401b38,_0x3bcc58),this['_addLoadNode'](_0x401b38,_0x3bcc58),this[_0x3e560b(0x16a)](_0x401b38);}[_0x4ff05d(0x193)](_0x1a9892,_0x4eb3ac){var _0x445444=_0x4ff05d;let _0x1eac7b;try{_0x269569[_0x445444(0x1a2)]&&(_0x1eac7b=_0x269569[_0x445444(0x1a2)][_0x445444(0x159)],_0x269569[_0x445444(0x1a2)][_0x445444(0x159)]=function(){}),_0x1a9892&&typeof _0x1a9892[_0x445444(0x178)]==_0x445444(0x1a4)&&(_0x4eb3ac[_0x445444(0x178)]=_0x1a9892[_0x445444(0x178)]);}catch{}finally{_0x1eac7b&&(_0x269569[_0x445444(0x1a2)][_0x445444(0x159)]=_0x1eac7b);}if(_0x4eb3ac['type']===_0x445444(0x1a4)||_0x4eb3ac['type']==='Number'){if(isNaN(_0x4eb3ac['value']))_0x4eb3ac[_0x445444(0x198)]=!0x0,delete _0x4eb3ac[_0x445444(0x14e)];else switch(_0x4eb3ac[_0x445444(0x14e)]){case Number[_0x445444(0x156)]:_0x4eb3ac['positiveInfinity']=!0x0,delete _0x4eb3ac[_0x445444(0x14e)];break;case Number[_0x445444(0x14c)]:_0x4eb3ac[_0x445444(0x11f)]=!0x0,delete _0x4eb3ac['value'];break;case 0x0:this['_isNegativeZero'](_0x4eb3ac[_0x445444(0x14e)])&&(_0x4eb3ac[_0x445444(0x11c)]=!0x0);break;}}else _0x4eb3ac[_0x445444(0x126)]===_0x445444(0x132)&&typeof _0x1a9892[_0x445444(0x139)]==_0x445444(0x189)&&_0x1a9892['name']&&_0x4eb3ac[_0x445444(0x139)]&&_0x1a9892[_0x445444(0x139)]!==_0x4eb3ac[_0x445444(0x139)]&&(_0x4eb3ac[_0x445444(0x137)]=_0x1a9892['name']);}[_0x4ff05d(0x110)](_0x35fc99){var _0x2cdb7d=_0x4ff05d;return 0x1/_0x35fc99===Number[_0x2cdb7d(0x14c)];}[_0x4ff05d(0x13f)](_0x36a950){var _0x369f6e=_0x4ff05d;!_0x36a950['props']||!_0x36a950['props'][_0x369f6e(0x178)]||_0x36a950[_0x369f6e(0x126)]===_0x369f6e(0x135)||_0x36a950[_0x369f6e(0x126)]==='Map'||_0x36a950[_0x369f6e(0x126)]===_0x369f6e(0xea)||_0x36a950['props'][_0x369f6e(0x171)](function(_0x3f86f5,_0x311f76){var _0x236385=_0x369f6e,_0x35b404=_0x3f86f5[_0x236385(0x139)][_0x236385(0x183)](),_0x650156=_0x311f76[_0x236385(0x139)]['toLowerCase']();return _0x35b404<_0x650156?-0x1:_0x35b404>_0x650156?0x1:0x0;});}[_0x4ff05d(0x133)](_0x2f1ebc,_0x50105a){var _0xbfcd7d=_0x4ff05d;if(!(_0x50105a[_0xbfcd7d(0x1a9)]||!_0x2f1ebc[_0xbfcd7d(0x179)]||!_0x2f1ebc[_0xbfcd7d(0x179)]['length'])){for(var _0x253a6a=[],_0x2102b6=[],_0x2bb908=0x0,_0x546f89=_0x2f1ebc[_0xbfcd7d(0x179)][_0xbfcd7d(0x178)];_0x2bb908<_0x546f89;_0x2bb908++){var _0x1cbd3e=_0x2f1ebc['props'][_0x2bb908];_0x1cbd3e['type']==='function'?_0x253a6a[_0xbfcd7d(0x18a)](_0x1cbd3e):_0x2102b6[_0xbfcd7d(0x18a)](_0x1cbd3e);}if(!(!_0x2102b6['length']||_0x253a6a[_0xbfcd7d(0x178)]<=0x1)){_0x2f1ebc[_0xbfcd7d(0x179)]=_0x2102b6;var _0x1a40f3={'functionsNode':!0x0,'props':_0x253a6a};this['_setNodeId'](_0x1a40f3,_0x50105a),this[_0xbfcd7d(0x113)](_0x1a40f3,_0x50105a),this[_0xbfcd7d(0x154)](_0x1a40f3),this[_0xbfcd7d(0x10f)](_0x1a40f3,_0x50105a),_0x1a40f3['id']+='\\x20f',_0x2f1ebc[_0xbfcd7d(0x179)][_0xbfcd7d(0x120)](_0x1a40f3);}}}[_0x4ff05d(0x188)](_0x46e259,_0x47f4eb){}[_0x4ff05d(0x154)](_0x1d9f64){}['_isArray'](_0xda35a3){var _0x2a28dd=_0x4ff05d;return Array['isArray'](_0xda35a3)||typeof _0xda35a3=='object'&&this[_0x2a28dd(0xf4)](_0xda35a3)===_0x2a28dd(0xda);}[_0x4ff05d(0x10f)](_0x2ad62b,_0x3d8b5c){}['_cleanNode'](_0x125644){var _0x1573c2=_0x4ff05d;delete _0x125644[_0x1573c2(0xca)],delete _0x125644['_hasSetOnItsPath'],delete _0x125644[_0x1573c2(0x158)];}['_setNodeExpressionPath'](_0x23066f,_0x31c14e){}}let _0x530de9=new _0x4bec75(),_0x5bb14b={'props':0x64,'elements':0x64,'strLength':0x400*0x32,'totalStrLength':0x400*0x32,'autoExpandLimit':0x1388,'autoExpandMaxDepth':0xa},_0x462f4d={'props':0x5,'elements':0x5,'strLength':0x100,'totalStrLength':0x100*0x3,'autoExpandLimit':0x1e,'autoExpandMaxDepth':0x2};function _0x5439d6(_0x453dfa,_0x415706,_0x2d7675,_0x22037c,_0x43ea92,_0x50f5f6){var _0x27b06c=_0x4ff05d;let _0x4f017d,_0x4782f7;try{_0x4782f7=_0x41cee5(),_0x4f017d=_0x309406[_0x415706],!_0x4f017d||_0x4782f7-_0x4f017d['ts']>0x1f4&&_0x4f017d[_0x27b06c(0x121)]&&_0x4f017d['time']/_0x4f017d[_0x27b06c(0x121)]<0x64?(_0x309406[_0x415706]=_0x4f017d={'count':0x0,'time':0x0,'ts':_0x4782f7},_0x309406['hits']={}):_0x4782f7-_0x309406['hits']['ts']>0x32&&_0x309406[_0x27b06c(0x160)][_0x27b06c(0x121)]&&_0x309406['hits']['time']/_0x309406['hits'][_0x27b06c(0x121)]<0x64&&(_0x309406[_0x27b06c(0x160)]={});let _0xe784a6=[],_0x375cac=_0x4f017d[_0x27b06c(0xdc)]||_0x309406['hits']['reduceLimits']?_0x462f4d:_0x5bb14b,_0x351b28=_0x59669e=>{var _0x5be152=_0x27b06c;let _0x21cc5c={};return _0x21cc5c['props']=_0x59669e[_0x5be152(0x179)],_0x21cc5c[_0x5be152(0x1b2)]=_0x59669e[_0x5be152(0x1b2)],_0x21cc5c['strLength']=_0x59669e[_0x5be152(0x177)],_0x21cc5c['totalStrLength']=_0x59669e[_0x5be152(0xfa)],_0x21cc5c[_0x5be152(0x163)]=_0x59669e[_0x5be152(0x163)],_0x21cc5c[_0x5be152(0xe3)]=_0x59669e[_0x5be152(0xe3)],_0x21cc5c[_0x5be152(0x167)]=!0x1,_0x21cc5c[_0x5be152(0x1a9)]=!_0xb6c728,_0x21cc5c[_0x5be152(0xcc)]=0x1,_0x21cc5c[_0x5be152(0x1aa)]=0x0,_0x21cc5c[_0x5be152(0xd8)]='root_exp_id',_0x21cc5c['rootExpression']='root_exp',_0x21cc5c[_0x5be152(0x166)]=!0x0,_0x21cc5c['autoExpandPreviousObjects']=[],_0x21cc5c[_0x5be152(0xec)]=0x0,_0x21cc5c['resolveGetters']=!0x0,_0x21cc5c[_0x5be152(0x157)]=0x0,_0x21cc5c[_0x5be152(0x169)]={'current':void 0x0,'parent':void 0x0,'index':0x0},_0x21cc5c;};for(var _0x5659d5=0x0;_0x5659d5<_0x43ea92[_0x27b06c(0x178)];_0x5659d5++)_0xe784a6[_0x27b06c(0x18a)](_0x530de9[_0x27b06c(0x14b)]({'timeNode':_0x453dfa===_0x27b06c(0x172)||void 0x0},_0x43ea92[_0x5659d5],_0x351b28(_0x375cac),{}));if(_0x453dfa===_0x27b06c(0x142)){let _0x3d506b=Error[_0x27b06c(0xd2)];try{Error[_0x27b06c(0xd2)]=0x1/0x0,_0xe784a6['push'](_0x530de9['serialize']({'stackNode':!0x0},new Error()[_0x27b06c(0x13a)],_0x351b28(_0x375cac),{'strLength':0x1/0x0}));}finally{Error[_0x27b06c(0xd2)]=_0x3d506b;}}return{'method':_0x27b06c(0x131),'version':_0x583925,'args':[{'ts':_0x2d7675,'session':_0x22037c,'args':_0xe784a6,'id':_0x415706,'context':_0x50f5f6}]};}catch(_0x50b21c){return{'method':_0x27b06c(0x131),'version':_0x583925,'args':[{'ts':_0x2d7675,'session':_0x22037c,'args':[{'type':_0x27b06c(0xf2),'error':_0x50b21c&&_0x50b21c[_0x27b06c(0x152)]}],'id':_0x415706,'context':_0x50f5f6}]};}finally{try{if(_0x4f017d&&_0x4782f7){let _0x6e3f50=_0x41cee5();_0x4f017d[_0x27b06c(0x121)]++,_0x4f017d[_0x27b06c(0x172)]+=_0x50d7d1(_0x4782f7,_0x6e3f50),_0x4f017d['ts']=_0x6e3f50,_0x309406[_0x27b06c(0x160)][_0x27b06c(0x121)]++,_0x309406['hits'][_0x27b06c(0x172)]+=_0x50d7d1(_0x4782f7,_0x6e3f50),_0x309406[_0x27b06c(0x160)]['ts']=_0x6e3f50,(_0x4f017d[_0x27b06c(0x121)]>0x32||_0x4f017d[_0x27b06c(0x172)]>0x64)&&(_0x4f017d[_0x27b06c(0xdc)]=!0x0),(_0x309406['hits']['count']>0x3e8||_0x309406[_0x27b06c(0x160)][_0x27b06c(0x172)]>0x12c)&&(_0x309406[_0x27b06c(0x160)][_0x27b06c(0xdc)]=!0x0);}}catch{}}}return _0x5439d6;}((_0x436b2f,_0x5e9e68,_0x739f51,_0x200859,_0x5ade45,_0x3c0c4a,_0x2e9ef4,_0x52f7b9,_0x489bcc,_0x4b0904)=>{var _0x3eb34b=_0x24ae32;if(_0x436b2f['_console_ninja'])return _0x436b2f[_0x3eb34b(0x10c)];if(!J(_0x436b2f,_0x52f7b9,_0x5ade45))return _0x436b2f['_console_ninja']={'consoleLog':()=>{},'consoleTrace':()=>{},'consoleTime':()=>{},'consoleTimeEnd':()=>{},'autoLog':()=>{},'autoLogMany':()=>{},'autoTraceMany':()=>{},'coverage':()=>{},'autoTrace':()=>{},'autoTime':()=>{},'autoTimeEnd':()=>{}},_0x436b2f['_console_ninja'];let _0x17ed1e=W(_0x436b2f),_0x5b8aae=_0x17ed1e[_0x3eb34b(0xf1)],_0x358f86=_0x17ed1e[_0x3eb34b(0x106)],_0x1db0c7=_0x17ed1e[_0x3eb34b(0x168)],_0x5edab2={'hits':{},'ts':{}},_0x2306a6=Y(_0x436b2f,_0x489bcc,_0x5edab2,_0x3c0c4a),_0x5c2099=_0x39c657=>{_0x5edab2['ts'][_0x39c657]=_0x358f86();},_0x3a97e3=(_0x231603,_0x32531e)=>{var _0x2a1511=_0x3eb34b;let _0x5019aa=_0x5edab2['ts'][_0x32531e];if(delete _0x5edab2['ts'][_0x32531e],_0x5019aa){let _0x26ffff=_0x5b8aae(_0x5019aa,_0x358f86());_0x482728(_0x2306a6(_0x2a1511(0x172),_0x231603,_0x1db0c7(),_0x109c4f,[_0x26ffff],_0x32531e));}},_0x160f42=_0x40a389=>_0x174f3e=>{var _0x581236=_0x3eb34b;try{_0x5c2099(_0x174f3e),_0x40a389(_0x174f3e);}finally{_0x436b2f[_0x581236(0x1a2)][_0x581236(0x172)]=_0x40a389;}},_0x46bc9a=_0x8b78e8=>_0x4c80fe=>{var _0x44e4b4=_0x3eb34b;try{let [_0x285c7c,_0x16c463]=_0x4c80fe[_0x44e4b4(0x18c)](':logPointId:');_0x3a97e3(_0x16c463,_0x285c7c),_0x8b78e8(_0x285c7c);}finally{_0x436b2f[_0x44e4b4(0x1a2)]['timeEnd']=_0x8b78e8;}};_0x436b2f[_0x3eb34b(0x10c)]={'consoleLog':(_0x1bc2ea,_0x3f3e00)=>{var _0x4b6724=_0x3eb34b;_0x436b2f['console'][_0x4b6724(0x131)]['name']!==_0x4b6724(0x116)&&_0x482728(_0x2306a6('log',_0x1bc2ea,_0x1db0c7(),_0x109c4f,_0x3f3e00));},'consoleTrace':(_0x1fa5f1,_0x122566)=>{var _0x122607=_0x3eb34b;_0x436b2f[_0x122607(0x1a2)][_0x122607(0x131)]['name']!==_0x122607(0x103)&&_0x482728(_0x2306a6(_0x122607(0x142),_0x1fa5f1,_0x1db0c7(),_0x109c4f,_0x122566));},'consoleTime':()=>{var _0x4d68d2=_0x3eb34b;_0x436b2f[_0x4d68d2(0x1a2)][_0x4d68d2(0x172)]=_0x160f42(_0x436b2f['console']['time']);},'consoleTimeEnd':()=>{var _0x3453b4=_0x3eb34b;_0x436b2f[_0x3453b4(0x1a2)][_0x3453b4(0x175)]=_0x46bc9a(_0x436b2f[_0x3453b4(0x1a2)][_0x3453b4(0x175)]);},'autoLog':(_0x449076,_0x2e7866)=>{var _0x5828ec=_0x3eb34b;_0x482728(_0x2306a6(_0x5828ec(0x131),_0x2e7866,_0x1db0c7(),_0x109c4f,[_0x449076]));},'autoLogMany':(_0x53314b,_0x42a9f5)=>{var _0x13e6ec=_0x3eb34b;_0x482728(_0x2306a6(_0x13e6ec(0x131),_0x53314b,_0x1db0c7(),_0x109c4f,_0x42a9f5));},'autoTrace':(_0x564590,_0x101283)=>{var _0x223bdf=_0x3eb34b;_0x482728(_0x2306a6(_0x223bdf(0x142),_0x101283,_0x1db0c7(),_0x109c4f,[_0x564590]));},'autoTraceMany':(_0x553423,_0x3690e0)=>{var _0x35ab7e=_0x3eb34b;_0x482728(_0x2306a6(_0x35ab7e(0x142),_0x553423,_0x1db0c7(),_0x109c4f,_0x3690e0));},'autoTime':(_0x2540cc,_0x2ad40f,_0x2cc138)=>{_0x5c2099(_0x2cc138);},'autoTimeEnd':(_0x30e6d3,_0x4c710,_0x38d515)=>{_0x3a97e3(_0x4c710,_0x38d515);},'coverage':_0x6611fa=>{var _0x55a654=_0x3eb34b;_0x482728({'method':_0x55a654(0x15f),'version':_0x3c0c4a,'args':[{'id':_0x6611fa}]});}};let _0x482728=b(_0x436b2f,_0x5e9e68,_0x739f51,_0x200859,_0x5ade45,_0x4b0904),_0x109c4f=_0x436b2f[_0x3eb34b(0x17c)];return _0x436b2f['_console_ninja'];})(globalThis,_0x24ae32(0x1b0),_0x24ae32(0xd6),_0x24ae32(0x11d),_0x24ae32(0x10e),_0x24ae32(0x17a),'1712619493202',["localhost","127.0.0.1","example.cypress.io","LAPTOP-1V5HLGOD","172.27.80.1","192.168.56.1","10.0.0.16"],_0x24ae32(0x1ad),_0x24ae32(0x11e));`)}catch{}}function S8(t,...e){try{T8().consoleLog(t,e)}catch{}return e}var Fk=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(re(qr),re(fr))},e.\u0275dir=Ct({type:e});let t=e;return t})(),em=(()=>{let e=class e extends Fk{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=wi(e)))(s||e)}})(),e.\u0275dir=Ct({type:e,features:[Gr]});let t=e;return t})(),td=new O("");var M8={provide:td,useExisting:vi(()=>gc),multi:!0};function R8(){let t=pr()?pr().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var N8=new O(""),gc=(()=>{let e=class e extends Fk{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!R8())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(re(qr),re(fr),re(N8,8))},e.\u0275dir=Ct({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&Fe("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[sa([M8]),Gr]});let t=e;return t})();var P8=new O(""),k8=new O("");function Vk(t){return t!=null}function Lk(t){return Ts(t)?ye(t):t}function jk(t){let e={};return t.forEach(n=>{e=n!=null?A(A({},e),n):e}),Object.keys(e).length===0?null:e}function Bk(t,e){return e.map(n=>n(t))}function O8(t){return!t.validate}function Uk(t){return t.map(e=>O8(e)?e:n=>e.validate(n))}function F8(t){if(!t)return null;let e=t.filter(Vk);return e.length==0?null:function(n){return jk(Bk(n,e))}}function $k(t){return t!=null?F8(Uk(t)):null}function V8(t){if(!t)return null;let e=t.filter(Vk);return e.length==0?null:function(n){let r=Bk(n,e).map(Lk);return x_(r).pipe(j(jk))}}function Hk(t){return t!=null?V8(Uk(t)):null}function Sk(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function L8(t){return t._rawValidators}function j8(t){return t._rawAsyncValidators}function vI(t){return t?Array.isArray(t)?t:[t]:[]}function Xg(t,e){return Array.isArray(t)?t.includes(e):t===e}function Ak(t,e){let n=vI(e);return vI(t).forEach(i=>{Xg(n,i)||n.push(i)}),n}function Mk(t,e){return vI(e).filter(n=>!Xg(t,n))}var Jg=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=$k(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Hk(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},xI=class extends Jg{get formDirective(){return null}get path(){return null}},ed=class extends Jg{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},wI=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},B8={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},one=ue(A({},B8),{"[class.ng-submitted]":"isSubmitted"}),mc=(()=>{let e=class e extends wI{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(re(ed,2))},e.\u0275dir=Ct({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&dy("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Gr]});let t=e;return t})();var Xl="VALID",Zg="INVALID",pc="PENDING",Jl="DISABLED";function U8(t){return(tm(t)?t.validators:t)||null}function $8(t){return Array.isArray(t)?$k(t):t||null}function H8(t,e){return(tm(e)?e.asyncValidators:t)||null}function q8(t){return Array.isArray(t)?Hk(t):t||null}function tm(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}var EI=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Xl}get invalid(){return this.status===Zg}get pending(){return this.status==pc}get disabled(){return this.status===Jl}get enabled(){return this.status!==Jl}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Ak(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Ak(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Mk(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Mk(e,this._rawAsyncValidators))}hasValidator(e){return Xg(this._rawValidators,e)}hasAsyncValidator(e){return Xg(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=pc,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Jl,this.errors=null,this._forEachChild(r=>{r.disable(ue(A({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ue(A({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Xl,this._forEachChild(r=>{r.enable(ue(A({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ue(A({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Xl||this.status===pc)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Jl:Xl}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=pc,this._hasOwnPendingAsyncValidator=!0;let n=Lk(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new ut,this.statusChanges=new ut}_calculateStatus(){return this._allControlsDisabled()?Jl:this.errors?Zg:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(pc)?pc:this._anyControlsHaveStatus(Zg)?Zg:Xl}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){tm(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=$8(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=q8(this._rawAsyncValidators)}};var qk=new O("CallSetDisabledState",{providedIn:"root",factory:()=>II}),II="always";function G8(t,e){return[...e.path,t]}function z8(t,e,n=II){K8(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),Q8(t,e),Z8(t,e),Y8(t,e),W8(t,e)}function Rk(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function W8(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function K8(t,e){let n=L8(t);e.validator!==null?t.setValidators(Sk(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=j8(t);e.asyncValidator!==null?t.setAsyncValidators(Sk(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();Rk(e._rawValidators,i),Rk(e._rawAsyncValidators,i)}function Q8(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&Gk(t,e)})}function Y8(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&Gk(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function Gk(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function Z8(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function X8(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function J8(t){return Object.getPrototypeOf(t.constructor)===em}function e7(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(s=>{s.constructor===gc?n=s:J8(s)?r=s:i=s}),i||r||n||null}function Nk(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function Pk(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var t7=class extends EI{constructor(e=null,n,r){super(U8(n),H8(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),tm(n)&&(n.nonNullable||n.initialValueIsDefault)&&(Pk(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Nk(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Nk(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Pk(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var n7={provide:ed,useExisting:vi(()=>go)},kk=Promise.resolve(),go=(()=>{let e=class e extends ed{constructor(r,i,s,o,a,c){super(),this._changeDetectorRef=a,this.callSetDisabledState=c,this.control=new t7,this._registered=!1,this.name="",this.update=new ut,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=e7(this,o)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),X8(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){z8(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){kk.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,s=i!==0&&As(i);kk.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?G8(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(re(xI,9),re(P8,10),re(k8,10),re(td,10),re(Ss,8),re(qk,8))},e.\u0275dir=Ct({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[Bt.None,"disabled","isDisabled"],model:[Bt.None,"ngModel","model"],options:[Bt.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[sa([n7]),Gr,Cs]});let t=e;return t})();var r7={provide:td,useExisting:vi(()=>nd),multi:!0},nd=(()=>{let e=class e extends em{writeValue(r){let i=r??"";this.setProperty("value",i)}registerOnChange(r){this.onChange=i=>{r(i==""?null:parseFloat(i))}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=wi(e)))(s||e)}})(),e.\u0275dir=Ct({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,s){i&1&&Fe("input",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},features:[sa([r7]),Gr]});let t=e;return t})();var i7={provide:td,useExisting:vi(()=>_c),multi:!0};function zk(t,e){return t==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function s7(t){return t.split(":")[0]}var _c=(()=>{let e=class e extends em{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i=this._getOptionId(r),s=zk(i,r);this.setProperty("value",s)}registerOnChange(r){this.onChange=i=>{this.value=this._getOptionValue(i),r(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),r))return i;return null}_getOptionValue(r){let i=s7(r);return this._optionMap.has(i)?this._optionMap.get(i):r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=wi(e)))(s||e)}})(),e.\u0275dir=Ct({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,s){i&1&&Fe("change",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[sa([i7]),Gr]});let t=e;return t})(),nm=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(r){this._select!=null&&(this._select._optionMap.set(this.id,r),this._setElementValue(zk(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._setElementValue(r),this._select&&this._select.writeValue(this._select.value)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(re(fr),re(qr),re(_c,9))},e.\u0275dir=Ct({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})(),o7={provide:td,useExisting:vi(()=>Wk),multi:!0};function Ok(t,e){return t==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function a7(t){return t.split(":")[0]}var Wk=(()=>{let e=class e extends em{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i;if(Array.isArray(r)){let s=r.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(r){this.onChange=i=>{let s=[],o=i.selectedOptions;if(o!==void 0){let a=o;for(let c=0;c<a.length;c++){let u=a[c],l=this._getOptionValue(u.value);s.push(l)}}else{let a=i.options;for(let c=0;c<a.length;c++){let u=a[c];if(u.selected){let l=this._getOptionValue(u.value);s.push(l)}}}this.value=s,r(s)}}_registerOption(r){let i=(this._idCounter++).toString();return this._optionMap.set(i,r),i}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,r))return i;return null}_getOptionValue(r){let i=a7(r);return this._optionMap.has(i)?this._optionMap.get(i)._value:r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=wi(e)))(s||e)}})(),e.\u0275dir=Ct({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,s){i&1&&Fe("change",function(a){return s.onChange(a.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[sa([o7]),Gr]});let t=e;return t})(),rm=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(r){this._select!=null&&(this._value=r,this._setElementValue(Ok(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._select?(this._value=r,this._setElementValue(Ok(this.id,r)),this._select.writeValue(this._select.value)):this._setElementValue(r)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}_setSelected(r){this._renderer.setProperty(this._element.nativeElement,"selected",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(re(fr),re(qr),re(Wk,9))},e.\u0275dir=Ct({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})();var c7=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=et({type:e}),e.\u0275inj=Je({});let t=e;return t})();var Kk=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:qk,useValue:r.callSetDisabledState??II}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=et({type:e}),e.\u0275inj=Je({imports:[c7]});let t=e;return t})();function u7(t,e){t&1&&(E(0,"h2"),S(1,"A\xF1adir coche"),b())}function l7(t,e){t&1&&(E(0,"h2"),S(1,"Modificar coche"),b())}function d7(t,e){if(t&1){let n=Ht();E(0,"div")(1,"button",15),Fe("click",function(){Ut(n);let i=qt();return $t(i.createCoche())}),S(2,"A\xF1adir"),b()()}}function h7(t,e){if(t&1){let n=Ht();E(0,"div")(1,"button",16),Fe("click",function(){Ut(n);let i=qt();return $t(i.updateCoche())}),S(2,"Modificar"),b()()}}function f7(t,e){if(t&1){let n=Ht();E(0,"div")(1,"button",17),Fe("click",function(){Ut(n);let i=qt();return $t(i.deleteCoche())}),S(2,"Eliminar"),b()()}}function p7(t,e){if(t&1){let n=Ht();E(0,"div")(1,"button",18),Fe("click",function(){Ut(n);let i=qt();return $t(i.sellCoche())}),S(2,"Vender"),b()()}}function g7(t,e){if(t&1){let n=Ht();E(0,"div")(1,"button",15),Fe("click",function(){Ut(n);let i=qt();return $t(i.resetCurrentCoche())}),S(2," A\xF1adir nuevo "),b()()}}function m7(t,e){if(t&1){let n=Ht();E(0,"tr",19)(1,"td"),S(2),b(),E(3,"td"),S(4),b(),E(5,"td"),S(6),b(),E(7,"td"),S(8),b(),E(9,"td"),S(10),b(),E(11,"td"),S(12),b(),E(13,"td")(14,"button",20),Fe("click",function(){let i=Ut(n).$implicit,s=qt();return $t(s.setCurrentCoche(i))}),S(15," Seleccionar "),b()()()}if(t&2){let n=e.$implicit;Ds("id",n.id),X(2),bt(n.marca),X(2),bt(n.modelo),X(2),cu("",n.kilometros," KM"),X(2),bt(n.transmision),X(2),cu("",n.precio," $"),X(2),bt(n.vendido)}}var Qk=(()=>{let e=class e{constructor(r){this.cocheService=r,this.state=Kn.create,this.MODES=Kn,this.coches=[],this.currentCoche=new ya({marca:"",modelo:"",precio:0,kilometros:0,vendido:!1,transmision:"",due\u00F1oActual:""})}ngOnInit(){this.updateCoches()}updateCoches(){return g(this,null,function*(){this.coches=yield this.cocheService.getCoches()})}createCoche(){return g(this,null,function*(){let r=new ya({marca:this.currentCoche.marca,modelo:this.currentCoche.modelo,precio:this.currentCoche.precio,kilometros:this.currentCoche.kilometros,vendido:!1,transmision:this.currentCoche.transmision,due\u00F1oActual:""});yield this.cocheService.createCoche(r),yield this.updateCoches(),this.resetCurrentCoche()})}updateCoche(){return g(this,null,function*(){yield this.cocheService.updateCoche(this.currentCoche),yield this.updateCoches(),this.resetCurrentCoche()})}deleteCoche(){return g(this,null,function*(){yield this.cocheService.deleteCoche(this.currentCoche.id),yield this.updateCoches(),this.resetCurrentCoche()})}setCurrentCoche(r){this.currentCoche=r,this.state=Kn.select}resetCurrentCoche(){this.currentCoche=new ya({marca:"",modelo:"",precio:0,kilometros:0,vendido:!1,transmision:"",due\u00F1oActual:""}),this.state=Kn.create}sellCoche(){return g(this,null,function*(){let r=this.currentCoche;yield this.cocheService.sellCoche(r.id,"123123",r.precio,"efectivo"),this.resetCurrentCoche(),yield this.updateCoches()})}};e.\u0275fac=function(i){return new(i||e)(re(Tk))},e.\u0275cmp=Tn({type:e,selectors:[["app-coches"]],decls:59,vars:13,consts:[[1,"page"],[1,"container-title"],[4,"ngIf"],[1,"row"],[1,"column"],[1,"container"],[1,"input-row"],["type","text",3,"ngModelChange","ngModel"],["type","number",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],["value","manual"],["value","automatica"],[1,"container","botones"],[1,"table"],[3,"id",4,"ngFor","ngForOf"],[1,"btn","add",3,"click"],[1,"btn","mod",3,"click"],[1,"btn","del",3,"click"],[1,"btn","sell",3,"click"],[3,"id"],[1,"btn","btn-primary",3,"click"]],template:function(i,s){i&1&&(E(0,"div",0)(1,"div",1),Wn(2,u7,2,0,"h2",2)(3,l7,2,0,"h2",2),b(),E(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"label"),S(9," Marca "),E(10,"input",7),sn("ngModelChange",function(a){return ln(s.currentCoche.marca,a)||(s.currentCoche.marca=a),a}),b()()(),E(11,"div",6)(12,"label"),S(13," Modelo "),E(14,"input",7),sn("ngModelChange",function(a){return ln(s.currentCoche.modelo,a)||(s.currentCoche.modelo=a),a}),b()()(),E(15,"div",6)(16,"label"),S(17," Kilometros "),E(18,"input",8),sn("ngModelChange",function(a){return ln(s.currentCoche.kilometros,a)||(s.currentCoche.kilometros=a),a}),b()()(),E(19,"div",6)(20,"label"),S(21," Transmision "),E(22,"select",9),sn("ngModelChange",function(a){return ln(s.currentCoche.transmision,a)||(s.currentCoche.transmision=a),a}),E(23,"option",10),S(24,"Manual"),b(),E(25,"option",11),S(26,"Automatica"),b()()()(),E(27,"div",6)(28,"label"),S(29," Precio "),E(30,"input",8),sn("ngModelChange",function(a){return ln(s.currentCoche.precio,a)||(s.currentCoche.precio=a),a}),b()()()(),E(31,"div",12),Wn(32,d7,3,0,"div",2)(33,h7,3,0,"div",2)(34,f7,3,0,"div",2)(35,p7,3,0,"div",2)(36,g7,3,0,"div",2),b()(),E(37,"div")(38,"h2"),S(39,"Coches"),b(),E(40,"table",13)(41,"thead")(42,"tr")(43,"th"),S(44,"Marca"),b(),E(45,"th"),S(46,"Modelo"),b(),E(47,"th"),S(48,"Kilometros"),b(),E(49,"th"),S(50,"Transmision"),b(),E(51,"th"),S(52,"Precio"),b(),E(53,"th"),S(54,"Vendido"),b(),E(55,"th"),S(56,"Acciones"),b()()(),E(57,"tbody"),Wn(58,m7,16,7,"tr",14),b()()()()()),i&2&&(X(2),tt("ngIf",s.state===s.MODES.create),X(),tt("ngIf",s.state===s.MODES.select),X(7),rn("ngModel",s.currentCoche.marca),X(4),rn("ngModel",s.currentCoche.modelo),X(4),rn("ngModel",s.currentCoche.kilometros),X(4),rn("ngModel",s.currentCoche.transmision),X(8),rn("ngModel",s.currentCoche.precio),X(2),tt("ngIf",s.state===s.MODES.create),X(),tt("ngIf",s.state===s.MODES.select),X(),tt("ngIf",s.state===s.MODES.select),X(),tt("ngIf",s.state===s.MODES.select&&!s.currentCoche.vendido),X(),tt("ngIf",s.state===s.MODES.select),X(22),tt("ngForOf",s.coches))},dependencies:[ca,Tf,nm,rm,gc,nd,_c,mc,go]});let t=e;return t})();function _7(t,e){if(t&1){let n=Ht();E(0,"tr",13)(1,"td"),S(2),b(),E(3,"td"),S(4),b(),E(5,"td"),S(6),b(),E(7,"td"),S(8),b(),E(9,"td"),S(10),b(),E(11,"td")(12,"button",14),Fe("click",function(){let i=Ut(n).$implicit,s=qt();return $t(s.setCurrentTransaccion(i))}),S(13,"Seleccionar"),b()()()}if(t&2){let n=e.$implicit;Ds("id",n.id),X(2),bt(n.fecha),X(2),bt(n.precio),X(2),bt(n.metodoPago),X(2),bt(n.coche),X(2),bt(n.cliente)}}var Yk=(()=>{let e=class e{constructor(r){this.transaccionService=r,this.transacciones=[],this.currentTransaccion=new ks({fecha:new Date().toLocaleString(),precio:0,metodoPago:"",coche:"",cliente:"",tipo:""})}ngOnInit(){this.updateTransacciones()}updateTransacciones(){return g(this,null,function*(){this.transacciones=yield this.transaccionService.getTransacciones()})}updateTransaccion(){return g(this,null,function*(){yield this.transaccionService.updateTransaccion(this.currentTransaccion),this.resetCurrentTransaccion(),yield this.updateTransacciones()})}setCurrentTransaccion(r){this.currentTransaccion=r}resetCurrentTransaccion(){this.currentTransaccion=new ks({fecha:new Date().toLocaleString(),precio:0,metodoPago:"",coche:"",cliente:"",tipo:""})}};e.\u0275fac=function(i){return new(i||e)(re(Yg))},e.\u0275cmp=Tn({type:e,selectors:[["app-transacciones"]],decls:39,vars:2,consts:[[1,"page"],[1,"container-title"],[1,"row-reverse"],[1,"column"],[1,"container"],[1,"input-row"],[3,"ngModelChange","ngModel"],["value","efectivo"],["value","credito"],["value","debito"],[1,"btn","upd",3,"click"],[1,"table"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],[1,"btn","btn-primary",3,"click"]],template:function(i,s){i&1&&(E(0,"div",0)(1,"div")(2,"div",1)(3,"h2"),S(4,"Actualizar transaccion"),b()(),E(5,"div",2)(6,"div",3)(7,"div",4)(8,"div",5)(9,"label"),S(10," M\xE9todo de pago "),E(11,"select",6),sn("ngModelChange",function(a){return ln(s.currentTransaccion.metodoPago,a)||(s.currentTransaccion.metodoPago=a),a}),E(12,"option",7),S(13,"Efectivo"),b(),E(14,"option",8),S(15,"Credito"),b(),E(16,"option",9),S(17,"Debito"),b()()()(),E(18,"div")(19,"button",10),Fe("click",function(){return s.updateTransaccion()}),S(20,"Actualizar"),b()()()(),E(21,"div")(22,"h2"),S(23,"Transacciones"),b(),E(24,"table",11)(25,"thead")(26,"tr")(27,"th"),S(28,"Fecha"),b(),E(29,"th"),S(30,"Precio"),b(),E(31,"th"),S(32,"Metodo de Pago"),b(),E(33,"th"),S(34,"Coche"),b(),E(35,"th"),S(36,"Cliente"),b()()(),E(37,"tbody"),Wn(38,_7,14,6,"tr",12),b()()()()()()),i&2&&(X(11),rn("ngModel",s.currentTransaccion.metodoPago),X(27),tt("ngForOf",s.transacciones))},dependencies:[ca,nm,rm,_c,mc,go]});let t=e;return t})();var rd=class{constructor(e){this.id="",this.nombre="",this.apellidos="",this.email="",this.telefono="",this.coches=[],this.transacciones=[],this.nombre=e.nombre,this.apellidos=e.apellidos,this.email=e.email,this.telefono=e.telefono}};var Zk=(()=>{let e=class e{constructor(r){this.firestore=r}getClientes(){return g(this,null,function*(){return yield this.parseData(this.firestore.collection("clientes").snapshotChanges())})}getClienteById(r){return g(this,null,function*(){return(yield this.parseData(this.firestore.collection("clientes",s=>s.where("id","==",r)).snapshotChanges()))[0]})}parseData(r){let i=[];return new Promise(s=>{r.subscribe(o=>{i=o.map(a=>ue(A({},a.payload.doc.data()),{id:a.payload.doc.id})),s(i)})})}createCliente(r){return g(this,null,function*(){return yield this.firestore.collection("clientes").add(Object.assign({},r))})}updateCliente(r){return g(this,null,function*(){yield this.firestore.doc("clientes/"+r.id).update(r)})}deleteCliente(r){return g(this,null,function*(){yield this.firestore.doc("clientes/"+r).delete()})}addCoche(r,i){return g(this,null,function*(){let s=yield this.getClienteById(r);s.coches.push(i),yield this.updateCliente(s)})}removeCoche(r,i){return g(this,null,function*(){let s=yield this.getClienteById(r);s.coches=s.coches.filter(o=>o!==i),yield this.updateCliente(s)})}addTransaccion(r,i){return g(this,null,function*(){let s=yield this.getClienteById(r);s.transacciones.push(i),yield this.updateCliente(s)})}};e.\u0275fac=function(i){return new(i||e)(w(fc))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function v7(t,e){t&1&&(E(0,"h2"),S(1,"A\xF1adir cliente"),b())}function x7(t,e){t&1&&(E(0,"h2"),S(1,"Modificar cliente"),b())}function w7(t,e){if(t&1){let n=Ht();E(0,"div")(1,"button",12),Fe("click",function(){Ut(n);let i=qt();return $t(i.createCliente())}),S(2,"A\xF1adir"),b()()}}function E7(t,e){if(t&1){let n=Ht();E(0,"div")(1,"button",13),Fe("click",function(){Ut(n);let i=qt();return $t(i.updateCliente())}),S(2," Modificar "),b()()}}function I7(t,e){if(t&1){let n=Ht();E(0,"div")(1,"button",14),Fe("click",function(){Ut(n);let i=qt();return $t(i.deleteCliente())}),S(2," Eliminar "),b()()}}function C7(t,e){if(t&1){let n=Ht();E(0,"div")(1,"button",12),Fe("click",function(){Ut(n);let i=qt();return $t(i.resetCurrentCliente())}),S(2," A\xF1adir nuevo "),b()()}}function b7(t,e){if(t&1){let n=Ht();E(0,"tr",15)(1,"td"),S(2),b(),E(3,"td"),S(4),b(),E(5,"td"),S(6),b(),E(7,"td"),S(8),b(),E(9,"td")(10,"button",16),Fe("click",function(){let i=Ut(n).$implicit,s=qt();return $t(s.setCurrentCliente(i))}),S(11," Editar "),b()()()}if(t&2){let n=e.$implicit;Ds("id",n.id),X(2),bt(n.nombre),X(2),bt(n.apellidos),X(2),bt(n.email),X(2),bt(n.telefono)}}var Xk=(()=>{let e=class e{constructor(r){this.clienteService=r,this.state=Kn.create,this.MODES=Kn,this.clientes=[],this.currentCliente=new rd({nombre:"",apellidos:"",email:"",telefono:""})}ngOnInit(){this.updateClientes()}updateClientes(){return g(this,null,function*(){this.clientes=yield this.clienteService.getClientes()})}createCliente(){return g(this,null,function*(){yield this.clienteService.createCliente(this.currentCliente),this.resetCurrentCliente(),yield this.updateClientes()})}updateCliente(){return g(this,null,function*(){yield this.clienteService.updateCliente(this.currentCliente),this.resetCurrentCliente(),yield this.updateClientes()})}deleteCliente(){return g(this,null,function*(){yield this.clienteService.deleteCliente(this.currentCliente.id),yield this.updateClientes()})}setCurrentCliente(r){this.currentCliente=r,this.state=Kn.select}resetCurrentCliente(){this.currentCliente=new rd({nombre:"",apellidos:"",email:"",telefono:""}),this.state=Kn.create}};e.\u0275fac=function(i){return new(i||e)(re(Zk))},e.\u0275cmp=Tn({type:e,selectors:[["app-clientes"]],decls:47,vars:11,consts:[[1,"page"],[1,"container-title"],[4,"ngIf"],[1,"row"],[1,"column"],[1,"container"],[1,"input-row"],["type","text",3,"ngModelChange","ngModel"],["type","number",3,"ngModelChange","ngModel"],[1,"container","botones"],[1,"table"],[3,"id",4,"ngFor","ngForOf"],[1,"btn","add",3,"click"],[1,"btn","mod",3,"click"],[1,"btn","del",3,"click"],[3,"id"],[1,"btn","btn-primary",3,"click"]],template:function(i,s){i&1&&(E(0,"div",0)(1,"div")(2,"div",1),Wn(3,v7,2,0,"h2",2)(4,x7,2,0,"h2",2),b(),E(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"label"),S(10," Nombre "),E(11,"input",7),sn("ngModelChange",function(a){return ln(s.currentCliente.nombre,a)||(s.currentCliente.nombre=a),a}),b()()(),E(12,"div",6)(13,"label"),S(14," Apellidos "),E(15,"input",7),sn("ngModelChange",function(a){return ln(s.currentCliente.apellidos,a)||(s.currentCliente.apellidos=a),a}),b()()(),E(16,"div",6)(17,"label"),S(18," Email "),E(19,"input",7),sn("ngModelChange",function(a){return ln(s.currentCliente.email,a)||(s.currentCliente.email=a),a}),b()()(),E(20,"div",6)(21,"label"),S(22," Telefono "),E(23,"input",8),sn("ngModelChange",function(a){return ln(s.currentCliente.telefono,a)||(s.currentCliente.telefono=a),a}),b()()(),E(24,"div",9),Wn(25,w7,3,0,"div",2)(26,E7,3,0,"div",2)(27,I7,3,0,"div",2)(28,C7,3,0,"div",2),b()()(),E(29,"div")(30,"h2"),S(31,"Clientes"),b(),E(32,"table",10)(33,"thead")(34,"tr")(35,"th"),S(36,"Nombre"),b(),E(37,"th"),S(38,"Apellidos"),b(),E(39,"th"),S(40,"Email"),b(),E(41,"th"),S(42,"Telefono"),b(),E(43,"th"),S(44,"Acciones"),b()()(),E(45,"tbody"),Wn(46,b7,12,5,"tr",11),b()()()()()()),i&2&&(X(3),tt("ngIf",s.state===s.MODES.create),X(),tt("ngIf",s.state===s.MODES.select),X(7),rn("ngModel",s.currentCliente.nombre),X(4),rn("ngModel",s.currentCliente.apellidos),X(4),rn("ngModel",s.currentCliente.email),X(4),rn("ngModel",s.currentCliente.telefono),X(2),tt("ngIf",s.state===s.MODES.create),X(),tt("ngIf",s.state===s.MODES.select),X(),tt("ngIf",s.state===s.MODES.select),X(),tt("ngIf",s.state===s.MODES.select),X(18),tt("ngForOf",s.clientes))},dependencies:[ca,Tf,gc,nd,mc,go]});let t=e;return t})();var D7=[{path:"home",component:wv},{path:"coches",component:Qk},{path:"transacciones",component:Yk},{path:"clientes",component:Xk},{path:"**",component:wv}],Jk=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=et({type:e}),e.\u0275inj=Je({imports:[xv.forRoot(D7),xv]});let t=e;return t})();var eO={production:!1,firebaseConfig:{apiKey:"AIzaSyAMKh_kgg0H6tNsbFMzG6bnrUO_GXcEPZU",authDomain:"car-b8820.firebaseapp.com",projectId:"car-b8820",storageBucket:"car-b8820.appspot.com",messagingSenderId:"312572004386",appId:"1:312572004386:web:78a5bf3d16d316157b227b"}};var tO="@firebase/database",nO="1.0.4";var FC="";function VC(t){FC=t}var NI=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ye(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:$d(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var PI=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return xn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var PO=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new NI(e)}}catch{}return new PI},_o=PO("localStorage"),kI=PO("sessionStorage");var wc=new ui("@firebase/database"),kO=function(){let t=1;return function(){return t++}}(),OO=function(t){let e=Rb(t),n=new Mb;n.update(e);let r=n.digest();return jd.encodeByteArray(r)},Td=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Td.apply(null,r):typeof r=="object"?e+=Ye(r):e+=r,e+=" "}return e},yo=null,rO=!0,FO=function(t,e){D(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(wc.logLevel=wn.VERBOSE,yo=wc.log.bind(wc),e&&kI.set("logging_enabled",!0)):typeof t=="function"?yo=t:(yo=null,kI.remove("logging_enabled"))},yt=function(...t){if(rO===!0&&(rO=!1,yo===null&&kI.get("logging_enabled")===!0&&FO(!0)),yo){let e=Td.apply(null,t);yo(e)}},Sd=function(t){return function(...e){yt(t,...e)}},OI=function(...t){let e="FIREBASE INTERNAL ERROR: "+Td(...t);wc.error(e)},Pr=function(...t){let e=`FIREBASE FATAL ERROR: ${Td(...t)}`;throw wc.error(e),new Error(e)},Ot=function(...t){let e="FIREBASE WARNING: "+Td(...t);wc.warn(e)},T7=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Ot("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Rm=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},S7=function(t){if(ir()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},ts="[MIN_NAME]",oi="[MAX_NAME]",xo=function(t,e){if(t===e)return 0;if(t===ts||e===oi)return-1;if(e===ts||t===oi)return 1;{let n=iO(t),r=iO(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},A7=function(t,e){return t===e?0:t<e?-1:1},id=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Ye(e))},LC=function(t){if(typeof t!="object"||t===null)return Ye(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=Ye(e[r]),n+=":",n+=LC(t[e[r]]);return n+="}",n},VO=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function vt(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var LO=function(t){D(!Rm(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,c;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let u=[];for(c=n;c;c-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(i?1:0),u.reverse();let l=u.join(""),d="";for(c=0;c<64;c+=8){let h=parseInt(l.substr(c,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},M7=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},R7=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function N7(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var P7=new RegExp("^-?(0*)\\d{1,10}$"),k7=-2147483648,O7=2147483647,iO=function(t){if(P7.test(t)){let e=Number(t);if(e>=k7&&e<=O7)return e}return null},Mc=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw Ot("Exception was thrown by user callback.",n),e},Math.floor(0))}},F7=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},cd=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var FI=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Ot(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var VI=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(yt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ot(e)}},ud=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),sm="5",jO="v",BO="s",UO="r",$O="f",HO=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,qO="ls",GO="p",LI="ac",zO="websocket",WO="long_polling";var om=class{constructor(e,n,r,i,s=!1,o="",a=!1,c=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=_o.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&_o.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function V7(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function KO(t,e,n){D(typeof e=="string","typeof type must == string"),D(typeof n=="object","typeof params must == object");let r;if(e===zO)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===WO)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);V7(t)&&(n.ns=t.namespace);let i=[];return vt(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var jI=class{constructor(){this.counters_={}}incrementCounter(e,n=1){xn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return Ib(this.counters_)}};var bI={},DI={};function jC(t){let e=t.toString();return bI[e]||(bI[e]=new jI),bI[e]}function L7(t,e){let n=t.toString();return DI[n]||(DI[n]=e()),DI[n]}var BI=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Mc(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var sO="start",j7="close",B7="pLPCommand",U7="pRTLPCB",QO="id",YO="pw",ZO="ser",$7="cb",H7="seg",q7="ts",G7="d",z7="dframe",XO=1870,JO=30,W7=XO-JO,K7=25e3,Q7=3e4,fd=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Sd(e),this.stats_=jC(n),this.urlFn=c=>(this.appCheckToken&&(c[LI]=this.appCheckToken),KO(n,WO,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new BI(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Q7)),S7(()=>{if(this.isClosed_)return;this.scriptTagHolder=new UI((...s)=>{let[o,a,c,u,l]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===sO)this.id=a,this.password=c;else if(o===j7)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[sO]="t",r[ZO]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[$7]=this.scriptTagHolder.uniqueCallbackIdentifier),r[jO]=sm,this.transportSessionId&&(r[BO]=this.transportSessionId),this.lastSessionId&&(r[qO]=this.lastSessionId),this.applicationId&&(r[GO]=this.applicationId),this.appCheckToken&&(r[LI]=this.appCheckToken),typeof location<"u"&&location.hostname&&HO.test(location.hostname)&&(r[UO]=$O);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return ir()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!M7()&&!R7()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=Ye(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=Eb(n),i=VO(r,W7);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(ir())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[z7]="t",r[QO]=e,r[YO]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=Ye(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},UI=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,ir())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=kO(),window[B7+this.uniqueCallbackIdentifier]=e,window[U7+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){yt("frame writing exception"),a.stack&&yt(a.stack),yt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||yt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[QO]=this.myID,e[YO]=this.myPW,e[ZO]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+JO+r.length<=XO;){let o=this.pendingSegs.shift();r=r+"&"+H7+i+"="+o.seg+"&"+q7+i+"="+o.ts+"&"+G7+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(K7)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){ir()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{yt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var Y7=16384,Z7=45e3,am=null;typeof MozWebSocket<"u"?am=MozWebSocket:typeof WebSocket<"u"&&(am=WebSocket);var vc=(()=>{class t{constructor(n,r,i,s,o,a,c){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Sd(this.connId),this.stats_=jC(r),this.connURL=t.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[jO]=sm,!ir()&&typeof location<"u"&&location.hostname&&HO.test(location.hostname)&&(a[UO]=$O),r&&(a[BO]=r),i&&(a[qO]=i),s&&(a[LI]=s),o&&(a[GO]=o),KO(n,zO,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,_o.set("previous_websocket_failure",!0);try{let i;if(ir()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${sm}/${FC}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new am(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&am!==null&&!t.forceDisallow_}static previouslyFailed(){return _o.isInMemoryStorage||_o.get("previous_websocket_failure")===!0}markConnectionHealthy(){_o.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=$d(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(D(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=Ye(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=VO(r,Y7);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Z7))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),eF=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[fd,vc]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=vc&&vc.isAvailable(),i=r&&!vc.previouslyFailed();if(n.webSocketOnly&&(r||Ot("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[vc];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),X7=6e4,J7=5e3,eH=10*1024,tH=100*1024,TI="t",oO="d",nH="s",aO="r",rH="e",cO="o",uO="a",lO="n",dO="p",iH="h",$I=class{constructor(e,n,r,i,s,o,a,c,u,l){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Sd("c:"+this.id+":"),this.transportManager_=new eF(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=cd(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>tH?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>eH?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(TI in e){let n=e[TI];n===uO?this.upgradeIfSecondaryHealthy_():n===aO?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===cO&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=id("t",e),r=id("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:dO,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:uO,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:lO,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=id("t",e),r=id("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=id(TI,e);if(oO in e){let r=e[oO];if(n===iH){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===lO){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===nH?this.onConnectionShutdown_(r):n===aO?this.onReset_(r):n===rH?OI("Server Error: "+r):n===cO?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):OI("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),sm!==r&&Ot("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),cd(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(X7))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):cd(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(J7))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:dO,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(_o.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var cm=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var um=class{constructor(e){this.allowedEvents_=e,this.listeners_={},D(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){D(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var lm=class t extends um{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Xm()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return D(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var hO=32,fO=768,xe=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function ve(){return new xe("")}function se(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function ns(t){return t.pieces_.length-t.pieceNum_}function Ae(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new xe(t.pieces_,e)}function BC(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function sH(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function pd(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function tF(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new xe(e,0)}function Le(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof xe)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new xe(n,0)}function oe(t){return t.pieceNum_>=t.pieces_.length}function Qt(t,e){let n=se(t),r=se(e);if(n===null)return e;if(n===r)return Qt(Ae(t),Ae(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function oH(t,e){let n=pd(t,0),r=pd(e,0);for(let i=0;i<n.length&&i<r.length;i++){let s=xo(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function UC(t,e){if(ns(t)!==ns(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function On(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(ns(t)>ns(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var HI=class{constructor(e,n){this.errorPrefix_=n,this.parts_=pd(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Vc(this.parts_[r]);nF(this)}};function aH(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Vc(e),nF(t)}function cH(t){let e=t.parts_.pop();t.byteLength_-=Vc(e),t.parts_.length>0&&(t.byteLength_-=1)}function nF(t){if(t.byteLength_>fO)throw new Error(t.errorPrefix_+"has a key path longer than "+fO+" bytes ("+t.byteLength_+").");if(t.parts_.length>hO)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+hO+") or object contains a cycle "+mo(t))}function mo(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var qI=class t extends um{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return D(e==="visible","Unknown event type: "+e),[this.visible_]}};var sd=1e3,uH=60*5*1e3,pO=30*1e3,lH=1.3,dH=3e4,hH="server_kill",gO=3,$C=(()=>{class t extends cm{constructor(n,r,i,s,o,a,c,u){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=u,this.id=t.nextPersistentConnectionId_++,this.log_=Sd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=sd,this.maxReconnectDelay_=uH,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!ir())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");qI.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&lm.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(Ye(o)),D(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new ht,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),D(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),D(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,c=>{let u=c.d,l=c.s;t.warnOnListenWarnings_(u,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",c),l!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(l,u))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&xn(n,"w")){let i=ci(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Ot(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||Sb(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=pO)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=Tb(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),D(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+Ye(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):OI("Unrecognized action received from server: "+Ye(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){D(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=sd,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=sd,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>dH&&(this.reconnectDelay_=sd),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*lH)}this.onConnectStatus_(!1)}establishConnection_(){return g(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,u=function(){c?c.close():(a=!0,i())},l=function(h){D(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(h)};this.realtime_={close:u,sendRequest:l};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?yt("getToken() completed but was canceled"):(yt("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,c=new $I(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,p=>{Ot(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(hH)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&Ot(h),u())}}})}interrupt(n){yt("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){yt("Resuming connection for reason: "+n),delete this.interruptReasons_[n],Hd(this.interruptReasons_)&&(this.reconnectDelay_=sd,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>LC(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new xe(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){yt("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=gO&&(this.reconnectDelay_=pO,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){yt("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=gO&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";ir()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+FC.replace(/\./g,"-")]=1,Xm()?n["framework.cordova"]=1:Cb()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=lm.getInstance().currentlyOnline();return Hd(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),ce=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var Ec=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new ce(ts,e),i=new ce(ts,n);return this.compare(r,i)!==0}minPost(){return ce.MIN}};var im,dm=class extends Ec{static get __EMPTY_NODE(){return im}static set __EMPTY_NODE(e){im=e}compare(e,n){return xo(e.name,n.name)}isDefinedOn(e){throw bo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ce.MIN}maxPost(){return new ce(oi,im)}makePost(e,n){return D(typeof e=="string","KeyIndex indexValue must always be a string."),new ce(e,im)}toString(){return".key"}},Nr=new dm;var xc=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},nr=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??Fn.EMPTY_NODE,this.right=o??Fn.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Fn.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return Fn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),GI=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new nr(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Fn=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,nr.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,nr.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new xc(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new xc(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new xc(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new xc(this.root_,null,this.comparator_,!0,e)}};Fn.EMPTY_NODE=new GI;function fH(t,e){return xo(t.name,e.name)}function HC(t,e){return xo(t,e)}var zI;function pH(t){zI=t}var rF=function(t){return typeof t=="number"?"number:"+LO(t):"string:"+t},iF=function(t){if(t.isLeafNode()){let e=t.val();D(typeof e=="string"||typeof e=="number"||typeof e=="object"&&xn(e,".sv"),"Priority must be a string or number.")}else D(t===zI||t.isEmpty(),"priority of unexpected type.");D(t===zI||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var mO,Ic=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,D(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),iF(this.priorityNode_)}static set __childrenNodeConstructor(n){mO=n}static get __childrenNodeConstructor(){return mO}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return oe(n)?this:se(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=se(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(D(i!==".priority"||ns(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ae(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+rF(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=LO(this.value_):n+=this.value_,this.lazyHash_=OO(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(D(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return D(s>=0,"Unknown leaf type: "+r),D(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),sF,oF;function gH(t){sF=t}function mH(t){oF=t}var WI=class extends Ec{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?xo(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ce.MIN}maxPost(){return new ce(oi,new Ic("[PRIORITY-POST]",oF))}makePost(e,n){let r=sF(e);return new ce(n,new Ic("[PRIORITY-POST]",r))}toString(){return".priority"}},Ne=new WI;var _H=Math.log(2),KI=class{constructor(e){let n=s=>parseInt(Math.log(s)/_H,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},hm=function(t,e,n,r){t.sort(e);let i=function(c,u){let l=u-c,d,h;if(l===0)return null;if(l===1)return d=t[c],h=n?n(d):d,new nr(h,d.node,nr.BLACK,null,null);{let f=parseInt(l/2,10)+c,p=i(c,f),m=i(f+1,u);return d=t[f],h=n?n(d):d,new nr(h,d.node,nr.BLACK,p,m)}},s=function(c){let u=null,l=null,d=t.length,h=function(p,m){let v=d-p,C=d;d-=p;let F=i(v+1,C),T=t[v],H=n?n(T):T;f(new nr(H,T.node,m,null,F))},f=function(p){u?(u.left=p,u=p):(l=p,u=p)};for(let p=0;p<c.count;++p){let m=c.nextBitIsOne(),v=Math.pow(2,c.count-(p+1));m?h(v,nr.BLACK):(h(v,nr.BLACK),h(v,nr.RED))}return l},o=new KI(t.length),a=s(o);return new Fn(r||e,a)};var SI,yc={},Cc=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return D(yc&&Ne,"ChildrenNode.ts has not been loaded"),SI=SI||new t({".priority":yc},{".priority":Ne}),SI}get(e){let n=ci(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Fn?n:null}hasIndex(e){return xn(this.indexSet_,e.toString())}addIndex(e,n){D(e!==Nr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(ce.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=hm(r,e.getCompare()):a=yc;let c=e.toString(),u=Object.assign({},this.indexSet_);u[c]=e;let l=Object.assign({},this.indexes_);return l[c]=a,new t(l,u)}addToIndexes(e,n){let r=Fc(this.indexes_,(i,s)=>{let o=ci(this.indexSet_,s);if(D(o,"Missing index implementation for "+s),i===yc)if(o.isDefinedOn(e.node)){let a=[],c=n.getIterator(ce.Wrap),u=c.getNext();for(;u;)u.name!==e.name&&a.push(u),u=c.getNext();return a.push(e),hm(a,o.getCompare())}else return yc;else{let a=n.get(e.name),c=i;return a&&(c=c.remove(new ce(e.name,a))),c.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=Fc(this.indexes_,i=>{if(i===yc)return i;{let s=n.get(e.name);return s?i.remove(new ce(e.name,s)):i}});return new t(r,this.indexSet_)}};var od,ee=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&iF(this.priorityNode_),this.children_.isEmpty()&&D(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return od||(od=new t(new Fn(HC),null,Cc.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||od}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?od:r}}getChild(n){let r=se(n);return r===null?this:this.getImmediateChild(r).getChild(Ae(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(D(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new ce(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?od:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=se(n);if(i===null)return r;{D(se(n)!==".priority"||ns(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Ae(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Ne,(a,c)=>{r[a]=c.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+rF(this.getPriority().val())+":"),this.forEachChild(Ne,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":OO(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new ce(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new ce(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new ce(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,ce.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,ce.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===Ad?-1:0}withIndex(n){if(n===Nr||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===Nr||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Ne),s=r.getIterator(Ne),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===Nr?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),QI=class extends ee{constructor(){super(new Fn(HC),ee.EMPTY_NODE,Cc.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ee.EMPTY_NODE}isEmpty(){return!1}},Ad=new QI;Object.defineProperties(ce,{MIN:{value:new ce(ts,ee.EMPTY_NODE)},MAX:{value:new ce(oi,Ad)}});dm.__EMPTY_NODE=ee.EMPTY_NODE;Ic.__childrenNodeConstructor=ee;pH(Ad);mH(Ad);var yH=!0;function Be(t,e=null){if(t===null)return ee.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),D(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new Ic(n,Be(e))}if(!(t instanceof Array)&&yH){let n=[],r=!1;if(vt(t,(o,a)=>{if(o.substring(0,1)!=="."){let c=Be(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),n.push(new ce(o,c)))}}),n.length===0)return ee.EMPTY_NODE;let s=hm(n,fH,o=>o.name,HC);if(r){let o=hm(n,Ne.getCompare());return new ee(s,Be(e),new Cc({".priority":o},{".priority":Ne}))}else return new ee(s,Be(e),Cc.Default)}else{let n=ee.EMPTY_NODE;return vt(t,(r,i)=>{if(xn(t,r)&&r.substring(0,1)!=="."){let s=Be(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(Be(e))}}gH(Be);var gd=class extends Ec{constructor(e){super(),this.indexPath_=e,D(!oe(e)&&se(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?xo(e.name,n.name):s}makePost(e,n){let r=Be(e),i=ee.EMPTY_NODE.updateChild(this.indexPath_,r);return new ce(n,i)}maxPost(){let e=ee.EMPTY_NODE.updateChild(this.indexPath_,Ad);return new ce(oi,e)}toString(){return pd(this.indexPath_,0).join("/")}};var YI=class extends Ec{compare(e,n){let r=e.node.compareTo(n.node);return r===0?xo(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ce.MIN}maxPost(){return ce.MAX}makePost(e,n){let r=Be(e);return new ce(n,r)}toString(){return".value"}},qC=new YI;function aF(t){return{type:"value",snapshotNode:t}}function bc(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function md(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function _d(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function vH(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var yd=class{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){D(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(md(n,a)):D(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(bc(n,r)):o.trackChildChange(_d(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Ne,(i,s)=>{n.hasChild(i)||r.trackChildChange(md(i,s))}),n.isLeafNode()||n.forEachChild(Ne,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(_d(i,s,o))}else r.trackChildChange(bc(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?ee.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var fm=class t{constructor(e){this.indexedFilter_=new yd(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new ce(n,r))||(r=ee.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=ee.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(ee.EMPTY_NODE);let s=this;return n.forEachChild(Ne,(o,a)=>{s.matches(new ce(o,a))||(i=i.updateImmediateChild(o,ee.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var ZI=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{let r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new fm(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new ce(n,r))||(r=ee.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=ee.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=ee.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(ee.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,ee.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();let a=e;D(a.numChildren()===this.limit_,"");let c=new ce(n,r),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),l=this.rangedFilter_.matches(c);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=i.getChildAfterChild(this.index_,u,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);let f=h==null?1:o(h,c);if(l&&!r.isEmpty()&&f>=0)return s?.trackChildChange(_d(n,r,d)),a.updateImmediateChild(n,r);{s?.trackChildChange(md(n,d));let m=a.updateImmediateChild(n,ee.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(bc(h.name,h.node)),m.updateImmediateChild(h.name,h.node)):m}}else return r.isEmpty()?e:l&&o(u,c)>=0?(s!=null&&(s.trackChildChange(md(u.name,u.node)),s.trackChildChange(bc(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(u.name,ee.EMPTY_NODE)):e}};var vd=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ne}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return D(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return D(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ts}hasEnd(){return this.endSet_}getIndexEndValue(){return D(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return D(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:oi}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return D(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ne}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function xH(t){return t.loadsAllData()?new yd(t.getIndex()):t.hasLimit()?new ZI(t):new fm(t)}function wH(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function EH(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function XI(t,e,n){let r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function IH(t,e,n){let r;return t.index_===Nr||n?r=XI(t,e,n):r=XI(t,e,oi),r.startAfterSet_=!0,r}function JI(t,e,n){let r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function CH(t,e,n){let r;return t.index_===Nr||n?r=JI(t,e,n):r=JI(t,e,ts),r.endBeforeSet_=!0,r}function Nm(t,e){let n=t.copy();return n.index_=e,n}function _O(t){let e={};if(t.isDefault())return e;let n;if(t.index_===Ne?n="$priority":t.index_===qC?n="$value":t.index_===Nr?n="$key":(D(t.index_ instanceof gd,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Ye(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=Ye(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+Ye(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=Ye(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+Ye(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function yO(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Ne&&(e.i=t.index_.toString()),e}var eC=class t extends cm{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Sd("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(D(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let c=_O(e._queryParams);this.restRequest_(s+".json",c,(u,l)=>{let d=l;if(u===404&&(d=null,u=null),u===null&&this.onDataUpdate_(s,d,!1,r),ci(this.listens_,o)===a){let h;u?u===401?h="permission_denied":h="rest_error:"+u:h="ok",i(h,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=_O(e._queryParams),r=e._path.toString(),i=new ht;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Ab(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=$d(a.responseText)}catch{Ot("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&Ot("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var tC=class{constructor(){this.rootNode_=ee.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function pm(){return{value:null,children:new Map}}function Rc(t,e,n){if(oe(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=se(e);t.children.has(r)||t.children.set(r,pm());let i=t.children.get(r);e=Ae(e),Rc(i,e,n)}}function nC(t,e){if(oe(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(Ne,(r,i)=>{Rc(t,new xe(r),i)}),nC(t,e)}}else if(t.children.size>0){let n=se(e);return e=Ae(e),t.children.has(n)&&nC(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function rC(t,e,n){t.value!==null?n(e,t.value):bH(t,(r,i)=>{let s=new xe(e.toString()+"/"+r);rC(i,s,n)})}function bH(t,e){t.children.forEach((n,r)=>{e(r,n)})}var iC=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&vt(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var vO=10*1e3,DH=30*1e3,TH=5*60*1e3,sC=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new iC(e);let r=vO+(DH-vO)*Math.random();cd(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;vt(e,(i,s)=>{s>0&&xn(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),cd(this.reportStats_.bind(this),Math.floor(Math.random()*2*TH))}};var Rr=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(Rr||{});function GC(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function zC(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function WC(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var oC=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Rr.ACK_USER_WRITE,this.source=GC()}operationForChild(e){if(oe(this.path)){if(this.affectedTree.value!=null)return D(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new xe(e));return new t(ve(),n,this.revert)}}else return D(se(this.path)===e,"operationForChild called for unrelated child."),new t(Ae(this.path),this.affectedTree,this.revert)}};var gm=class t{constructor(e,n){this.source=e,this.path=n,this.type=Rr.LISTEN_COMPLETE}operationForChild(e){return oe(this.path)?new t(this.source,ve()):new t(this.source,Ae(this.path))}};var Dc=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Rr.OVERWRITE}operationForChild(e){return oe(this.path)?new t(this.source,ve(),this.snap.getImmediateChild(e)):new t(this.source,Ae(this.path),this.snap)}};var xd=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Rr.MERGE}operationForChild(e){if(oe(this.path)){let n=this.children.subtree(new xe(e));return n.isEmpty()?null:n.value?new Dc(this.source,ve(),n.value):new t(this.source,ve(),n)}else return D(se(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,Ae(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var kr=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(oe(e))return this.isFullyInitialized()&&!this.filtered_;let n=se(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var aC=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function SH(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(vH(o.childName,o.snapshotNode))}),ad(t,i,"child_removed",e,r,n),ad(t,i,"child_added",e,r,n),ad(t,i,"child_moved",s,r,n),ad(t,i,"child_changed",e,r,n),ad(t,i,"value",e,r,n),i}function ad(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,c)=>MH(t,a,c)),o.forEach(a=>{let c=AH(t,a,s);i.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(c,t.query_))})})}function AH(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function MH(t,e,n){if(e.childName==null||n.childName==null)throw bo("Should only compare child_ events.");let r=new ce(e.childName,e.snapshotNode),i=new ce(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function Pm(t,e){return{eventCache:t,serverCache:e}}function ld(t,e,n,r){return Pm(new kr(e,n,r),t.serverCache)}function cF(t,e,n,r){return Pm(t.eventCache,new kr(e,n,r))}function mm(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function vo(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var AI,RH=()=>(AI||(AI=new Fn(A7)),AI),Yt=class t{constructor(e,n=RH()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return vt(e,(r,i)=>{n=n.set(new xe(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:ve(),value:this.value};if(oe(e))return null;{let r=se(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Ae(e),n);return s!=null?{path:Le(new xe(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(oe(e))return this;{let n=se(e),r=this.children.get(n);return r!==null?r.subtree(Ae(e)):new t(null)}}set(e,n){if(oe(e))return new t(n,this.children);{let r=se(e),s=(this.children.get(r)||new t(null)).set(Ae(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(oe(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=se(e),r=this.children.get(n);if(r){let i=r.remove(Ae(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(oe(e))return this.value;{let n=se(e),r=this.children.get(n);return r?r.get(Ae(e)):null}}setTree(e,n){if(oe(e))return n;{let r=se(e),s=(this.children.get(r)||new t(null)).setTree(Ae(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(ve(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Le(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,ve(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(oe(e))return null;{let s=se(e),o=this.children.get(s);return o?o.findOnPath_(Ae(e),Le(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,ve(),n)}foreachOnPath_(e,n,r){if(oe(e))return this;{this.value&&r(n,this.value);let i=se(e),s=this.children.get(i);return s?s.foreachOnPath_(Ae(e),Le(n,i),r):new t(null)}}foreach(e){this.foreach_(ve(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(Le(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var rr=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new Yt(null))}};function dd(t,e,n){if(oe(e))return new rr(new Yt(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=Qt(i,e);return s=s.updateChild(o,n),new rr(t.writeTree_.set(i,s))}else{let i=new Yt(n),s=t.writeTree_.setTree(e,i);return new rr(s)}}}function cC(t,e,n){let r=t;return vt(n,(i,s)=>{r=dd(r,Le(e,i),s)}),r}function xO(t,e){if(oe(e))return rr.empty();{let n=t.writeTree_.setTree(e,new Yt(null));return new rr(n)}}function uC(t,e){return wo(t,e)!=null}function wo(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Qt(n.path,e)):null}function wO(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Ne,(r,i)=>{e.push(new ce(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ce(r,i.value))}),e}function Ji(t,e){if(oe(e))return t;{let n=wo(t,e);return n!=null?new rr(new Yt(n)):new rr(t.writeTree_.subtree(e))}}function lC(t){return t.writeTree_.isEmpty()}function Tc(t,e){return uF(ve(),t.writeTree_,e)}function uF(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(D(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=uF(Le(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Le(t,".priority"),r)),n}}function km(t,e){return fF(e,t)}function NH(t,e,n,r,i){D(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=dd(t.visibleWrites,e,n)),t.lastWriteId=r}function PH(t,e,n,r){D(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=cC(t.visibleWrites,e,n),t.lastWriteId=r}function kH(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function OH(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);D(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&FH(a,r.path)?i=!1:On(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return VH(t),!0;if(r.snap)t.visibleWrites=xO(t.visibleWrites,r.path);else{let a=r.children;vt(a,c=>{t.visibleWrites=xO(t.visibleWrites,Le(r.path,c))})}return!0}else return!1}function FH(t,e){if(t.snap)return On(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&On(Le(t.path,n),e))return!0;return!1}function VH(t){t.visibleWrites=lF(t.allWrites,LH,ve()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function LH(t){return t.visible}function lF(t,e,n){let r=rr.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)On(n,o)?(a=Qt(n,o),r=dd(r,a,s.snap)):On(o,n)&&(a=Qt(o,n),r=dd(r,ve(),s.snap.getChild(a)));else if(s.children){if(On(n,o))a=Qt(n,o),r=cC(r,a,s.children);else if(On(o,n))if(a=Qt(o,n),oe(a))r=cC(r,ve(),s.children);else{let c=ci(s.children,se(a));if(c){let u=c.getChild(Ae(a));r=dd(r,ve(),u)}}}else throw bo("WriteRecord should have .snap or .children")}}return r}function dF(t,e,n,r,i){if(!r&&!i){let s=wo(t.visibleWrites,e);if(s!=null)return s;{let o=Ji(t.visibleWrites,e);if(lC(o))return n;if(n==null&&!uC(o,ve()))return null;{let a=n||ee.EMPTY_NODE;return Tc(o,a)}}}else{let s=Ji(t.visibleWrites,e);if(!i&&lC(s))return n;if(!i&&n==null&&!uC(s,ve()))return null;{let o=function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&(On(u.path,e)||On(e,u.path))},a=lF(t.allWrites,o,e),c=n||ee.EMPTY_NODE;return Tc(a,c)}}}function jH(t,e,n){let r=ee.EMPTY_NODE,i=wo(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ne,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=Ji(t.visibleWrites,e);return n.forEachChild(Ne,(o,a)=>{let c=Tc(Ji(s,new xe(o)),a);r=r.updateImmediateChild(o,c)}),wO(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=Ji(t.visibleWrites,e);return wO(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function BH(t,e,n,r,i){D(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=Le(e,n);if(uC(t.visibleWrites,s))return null;{let o=Ji(t.visibleWrites,s);return lC(o)?i.getChild(n):Tc(o,i.getChild(n))}}function UH(t,e,n,r){let i=Le(e,n),s=wo(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=Ji(t.visibleWrites,i);return Tc(o,r.getNode().getImmediateChild(n))}else return null}function $H(t,e){return wo(t.visibleWrites,e)}function HH(t,e,n,r,i,s,o){let a,c=Ji(t.visibleWrites,e),u=wo(c,ve());if(u!=null)a=u;else if(n!=null)a=Tc(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let l=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),f=h.getNext();for(;f&&l.length<i;)d(f,r)!==0&&l.push(f),f=h.getNext();return l}else return[]}function qH(){return{visibleWrites:rr.empty(),allWrites:[],lastWriteId:-1}}function _m(t,e,n,r){return dF(t.writeTree,t.treePath,e,n,r)}function KC(t,e){return jH(t.writeTree,t.treePath,e)}function EO(t,e,n,r){return BH(t.writeTree,t.treePath,e,n,r)}function ym(t,e){return $H(t.writeTree,Le(t.treePath,e))}function GH(t,e,n,r,i,s){return HH(t.writeTree,t.treePath,e,n,r,i,s)}function QC(t,e,n){return UH(t.writeTree,t.treePath,e,n)}function hF(t,e){return fF(Le(t.treePath,e),t.writeTree)}function fF(t,e){return{treePath:t,writeTree:e}}var dC=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;D(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),D(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,_d(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,md(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,bc(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,_d(r,e.snapshotNode,i.oldSnap));else throw bo("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var hC=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},pF=new hC,wd=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new kr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return QC(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:vo(this.viewCache_),s=GH(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function zH(t){return{filter:t}}function WH(t,e){D(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),D(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function KH(t,e,n,r,i){let s=new dC,o,a;if(n.type===Rr.OVERWRITE){let u=n;u.source.fromUser?o=fC(t,e,u.path,u.snap,r,i,s):(D(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!oe(u.path),o=vm(t,e,u.path,u.snap,r,i,a,s))}else if(n.type===Rr.MERGE){let u=n;u.source.fromUser?o=YH(t,e,u.path,u.children,r,i,s):(D(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=pC(t,e,u.path,u.children,r,i,a,s))}else if(n.type===Rr.ACK_USER_WRITE){let u=n;u.revert?o=JH(t,e,u.path,r,i,s):o=ZH(t,e,u.path,u.affectedTree,r,i,s)}else if(n.type===Rr.LISTEN_COMPLETE)o=XH(t,e,n.path,r,s);else throw bo("Unknown operation type: "+n.type);let c=s.getChanges();return QH(e,o,c),{viewCache:o,changes:c}}function QH(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=mm(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(aF(mm(e)))}}function gF(t,e,n,r,i,s){let o=e.eventCache;if(ym(r,n)!=null)return e;{let a,c;if(oe(n))if(D(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let u=vo(e),l=u instanceof ee?u:ee.EMPTY_NODE,d=KC(r,l);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let u=_m(r,vo(e));a=t.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{let u=se(n);if(u===".priority"){D(ns(n)===1,"Can't have a priority with additional path components");let l=o.getNode();c=e.serverCache.getNode();let d=EO(r,n,l,c);d!=null?a=t.filter.updatePriority(l,d):a=o.getNode()}else{let l=Ae(n),d;if(o.isCompleteForChild(u)){c=e.serverCache.getNode();let h=EO(r,n,o.getNode(),c);h!=null?d=o.getNode().getImmediateChild(u).updateChild(l,h):d=o.getNode().getImmediateChild(u)}else d=QC(r,u,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),u,d,l,i,s):a=o.getNode()}}return ld(e,a,o.isFullyInitialized()||oe(n),t.filter.filtersNodes())}}function vm(t,e,n,r,i,s,o,a){let c=e.serverCache,u,l=o?t.filter:t.filter.getIndexedFilter();if(oe(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){let f=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),f,null)}else{let f=se(n);if(!c.isCompleteForPath(n)&&ns(n)>1)return e;let p=Ae(n),v=c.getNode().getImmediateChild(f).updateChild(p,r);f===".priority"?u=l.updatePriority(c.getNode(),v):u=l.updateChild(c.getNode(),f,v,p,pF,null)}let d=cF(e,u,c.isFullyInitialized()||oe(n),l.filtersNodes()),h=new wd(i,d,s);return gF(t,d,n,i,h,a)}function fC(t,e,n,r,i,s,o){let a=e.eventCache,c,u,l=new wd(i,e,s);if(oe(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,o),c=ld(e,u,!0,t.filter.filtersNodes());else{let d=se(n);if(d===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),r),c=ld(e,u,a.isFullyInitialized(),a.isFiltered());else{let h=Ae(n),f=a.getNode().getImmediateChild(d),p;if(oe(h))p=r;else{let m=l.getCompleteChild(d);m!=null?BC(h)===".priority"&&m.getChild(tF(h)).isEmpty()?p=m:p=m.updateChild(h,r):p=ee.EMPTY_NODE}if(f.equals(p))c=e;else{let m=t.filter.updateChild(a.getNode(),d,p,h,l,o);c=ld(e,m,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function IO(t,e){return t.eventCache.isCompleteForChild(e)}function YH(t,e,n,r,i,s,o){let a=e;return r.foreach((c,u)=>{let l=Le(n,c);IO(e,se(l))&&(a=fC(t,a,l,u,i,s,o))}),r.foreach((c,u)=>{let l=Le(n,c);IO(e,se(l))||(a=fC(t,a,l,u,i,s,o))}),a}function CO(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function pC(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;oe(n)?u=r:u=new Yt(null).setTree(n,r);let l=e.serverCache.getNode();return u.children.inorderTraversal((d,h)=>{if(l.hasChild(d)){let f=e.serverCache.getNode().getImmediateChild(d),p=CO(t,f,h);c=vm(t,c,new xe(d),p,i,s,o,a)}}),u.children.inorderTraversal((d,h)=>{let f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!l.hasChild(d)&&!f){let p=e.serverCache.getNode().getImmediateChild(d),m=CO(t,p,h);c=vm(t,c,new xe(d),m,i,s,o,a)}}),c}function ZH(t,e,n,r,i,s,o){if(ym(i,n)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(oe(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return vm(t,e,n,c.getNode().getChild(n),i,s,a,o);if(oe(n)){let u=new Yt(null);return c.getNode().forEachChild(Nr,(l,d)=>{u=u.set(new xe(l),d)}),pC(t,e,n,u,i,s,a,o)}else return e}else{let u=new Yt(null);return r.foreach((l,d)=>{let h=Le(n,l);c.isCompleteForPath(h)&&(u=u.set(l,c.getNode().getChild(h)))}),pC(t,e,n,u,i,s,a,o)}}function XH(t,e,n,r,i){let s=e.serverCache,o=cF(e,s.getNode(),s.isFullyInitialized()||oe(n),s.isFiltered());return gF(t,o,n,r,pF,i)}function JH(t,e,n,r,i,s){let o;if(ym(r,n)!=null)return e;{let a=new wd(r,e,i),c=e.eventCache.getNode(),u;if(oe(n)||se(n)===".priority"){let l;if(e.serverCache.isFullyInitialized())l=_m(r,vo(e));else{let d=e.serverCache.getNode();D(d instanceof ee,"serverChildren would be complete if leaf node"),l=KC(r,d)}l=l,u=t.filter.updateFullNode(c,l,s)}else{let l=se(n),d=QC(r,l,e.serverCache);d==null&&e.serverCache.isCompleteForChild(l)&&(d=c.getImmediateChild(l)),d!=null?u=t.filter.updateChild(c,l,d,Ae(n),a,s):e.eventCache.getNode().hasChild(l)?u=t.filter.updateChild(c,l,ee.EMPTY_NODE,Ae(n),a,s):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=_m(r,vo(e)),o.isLeafNode()&&(u=t.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||ym(r,ve())!=null,ld(e,u,o,t.filter.filtersNodes())}}var gC=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new yd(r.getIndex()),s=xH(r);this.processor_=zH(s);let o=n.serverCache,a=n.eventCache,c=i.updateFullNode(ee.EMPTY_NODE,o.getNode(),null),u=s.updateFullNode(ee.EMPTY_NODE,a.getNode(),null),l=new kr(c,o.isFullyInitialized(),i.filtersNodes()),d=new kr(u,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Pm(d,l),this.eventGenerator_=new aC(this.query_)}get query(){return this.query_}};function eq(t){return t.viewCache_.serverCache.getNode()}function tq(t){return mm(t.viewCache_)}function nq(t,e){let n=vo(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!oe(e)&&!n.getImmediateChild(se(e)).isEmpty())?n.getChild(e):null}function bO(t){return t.eventRegistrations_.length===0}function rq(t,e){t.eventRegistrations_.push(e)}function DO(t,e,n){let r=[];if(n){D(e==null,"A cancel should cancel all event registrations.");let i=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function TO(t,e,n,r){e.type===Rr.MERGE&&e.source.queryId!==null&&(D(vo(t.viewCache_),"We should always have a full cache before handling merges"),D(mm(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=KH(t.processor_,i,e,n,r);return WH(t.processor_,s.viewCache),D(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,mF(t,s.changes,s.viewCache.eventCache.getNode(),null)}function iq(t,e){let n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ne,(s,o)=>{r.push(bc(s,o))}),n.isFullyInitialized()&&r.push(aF(n.getNode())),mF(t,r,n.getNode(),e)}function mF(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return SH(t.eventGenerator_,e,n,i)}var xm,wm=class{constructor(){this.views=new Map}};function sq(t){D(!xm,"__referenceConstructor has already been defined"),xm=t}function oq(){return D(xm,"Reference.ts has not been loaded"),xm}function aq(t){return t.views.size===0}function YC(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return D(s!=null,"SyncTree gave us an op for an invalid query."),TO(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat(TO(o,e,n,r));return s}}function _F(t,e,n,r,i){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=_m(n,i?r:null),c=!1;a?c=!0:r instanceof ee?(a=KC(n,r),c=!1):(a=ee.EMPTY_NODE,c=!1);let u=Pm(new kr(a,c,!1),new kr(r,i,!1));return new gC(e,u)}return o}function cq(t,e,n,r,i,s){let o=_F(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),rq(o,n),iq(o,n)}function uq(t,e,n,r){let i=e._queryIdentifier,s=[],o=[],a=rs(t);if(i==="default")for(let[c,u]of t.views.entries())o=o.concat(DO(u,n,r)),bO(u)&&(t.views.delete(c),u.query._queryParams.loadsAllData()||s.push(u.query));else{let c=t.views.get(i);c&&(o=o.concat(DO(c,n,r)),bO(c)&&(t.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!rs(t)&&s.push(new(oq())(e._repo,e._path)),{removed:s,events:o}}function yF(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function es(t,e){let n=null;for(let r of t.views.values())n=n||nq(r,e);return n}function vF(t,e){if(e._queryParams.loadsAllData())return Om(t);{let r=e._queryIdentifier;return t.views.get(r)}}function xF(t,e){return vF(t,e)!=null}function rs(t){return Om(t)!=null}function Om(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Em;function lq(t){D(!Em,"__referenceConstructor has already been defined"),Em=t}function dq(){return D(Em,"Reference.ts has not been loaded"),Em}var hq=1,Im=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Yt(null),this.pendingWriteTree_=qH(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function ZC(t,e,n,r,i){return NH(t.pendingWriteTree_,e,n,r,i),i?Nc(t,new Dc(GC(),e,n)):[]}function fq(t,e,n,r){PH(t.pendingWriteTree_,e,n,r);let i=Yt.fromObject(n);return Nc(t,new xd(GC(),e,i))}function Xi(t,e,n=!1){let r=kH(t.pendingWriteTree_,e);if(OH(t.pendingWriteTree_,e)){let s=new Yt(null);return r.snap!=null?s=s.set(ve(),!0):vt(r.children,o=>{s=s.set(new xe(o),!0)}),Nc(t,new oC(r.path,s,n))}else return[]}function Md(t,e,n){return Nc(t,new Dc(zC(),e,n))}function pq(t,e,n){let r=Yt.fromObject(n);return Nc(t,new xd(zC(),e,r))}function gq(t,e){return Nc(t,new gm(zC(),e))}function mq(t,e,n){let r=XC(t,n);if(r){let i=JC(r),s=i.path,o=i.queryId,a=Qt(s,e),c=new gm(WC(o),a);return eb(t,s,c)}else return[]}function Cm(t,e,n,r,i=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||xF(o,e))){let c=uq(o,e,n,r);aq(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let u=c.removed;if(a=c.events,!i){let l=u.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,f)=>rs(f));if(l&&!d){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let f=vq(h);for(let p=0;p<f.length;++p){let m=f[p],v=m.query,C=CF(t,m);t.listenProvider_.startListening(hd(v),Ed(t,v),C.hashFn,C.onComplete)}}}!d&&u.length>0&&!r&&(l?t.listenProvider_.stopListening(hd(e),null):u.forEach(h=>{let f=t.queryToTagMap.get(Vm(h));t.listenProvider_.stopListening(hd(h),f)}))}xq(t,u)}return a}function wF(t,e,n,r){let i=XC(t,r);if(i!=null){let s=JC(i),o=s.path,a=s.queryId,c=Qt(o,e),u=new Dc(WC(a),c,n);return eb(t,o,u)}else return[]}function _q(t,e,n,r){let i=XC(t,r);if(i){let s=JC(i),o=s.path,a=s.queryId,c=Qt(o,e),u=Yt.fromObject(n),l=new xd(WC(a),c,u);return eb(t,o,l)}else return[]}function mC(t,e,n,r=!1){let i=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(h,f)=>{let p=Qt(h,i);s=s||es(f,p),o=o||rs(f)});let a=t.syncPointTree_.get(i);a?(o=o||rs(a),s=s||es(a,ve())):(a=new wm,t.syncPointTree_=t.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=ee.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((f,p)=>{let m=es(p,ve());m&&(s=s.updateImmediateChild(f,m))}));let u=xF(a,e);if(!u&&!e._queryParams.loadsAllData()){let h=Vm(e);D(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let f=wq();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}let l=km(t.pendingWriteTree_,i),d=cq(a,e,n,l,s,c);if(!u&&!o&&!r){let h=vF(a,e);d=d.concat(Eq(t,e,h))}return d}function Fm(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let c=Qt(o,e),u=es(a,c);if(u)return u});return dF(i,e,s,n,!0)}function yq(t,e){let n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(u,l)=>{let d=Qt(u,n);r=r||es(l,d)});let i=t.syncPointTree_.get(n);i?r=r||es(i,ve()):(i=new wm,t.syncPointTree_=t.syncPointTree_.set(n,i));let s=r!=null,o=s?new kr(r,!0,!1):null,a=km(t.pendingWriteTree_,e._path),c=_F(i,e,a,s?o.getNode():ee.EMPTY_NODE,s);return tq(c)}function Nc(t,e){return EF(e,t.syncPointTree_,null,km(t.pendingWriteTree_,ve()))}function EF(t,e,n,r){if(oe(t.path))return IF(t,e,n,r);{let i=e.get(ve());n==null&&i!=null&&(n=es(i,ve()));let s=[],o=se(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){let u=n?n.getImmediateChild(o):null,l=hF(r,o);s=s.concat(EF(a,c,u,l))}return i&&(s=s.concat(YC(i,t,r,n))),s}}function IF(t,e,n,r){let i=e.get(ve());n==null&&i!=null&&(n=es(i,ve()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=n?n.getImmediateChild(o):null,u=hF(r,o),l=t.operationForChild(o);l&&(s=s.concat(IF(l,a,c,u)))}),i&&(s=s.concat(YC(i,t,r,n))),s}function CF(t,e){let n=e.query,r=Ed(t,n);return{hashFn:()=>(eq(e)||ee.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?mq(t,n._path,r):gq(t,n._path);{let s=N7(i,n);return Cm(t,n,null,s)}}}}function Ed(t,e){let n=Vm(e);return t.queryToTagMap.get(n)}function Vm(t){return t._path.toString()+"$"+t._queryIdentifier}function XC(t,e){return t.tagToQueryMap.get(e)}function JC(t){let e=t.indexOf("$");return D(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new xe(t.substr(0,e))}}function eb(t,e,n){let r=t.syncPointTree_.get(e);D(r,"Missing sync point for query tag that we're tracking");let i=km(t.pendingWriteTree_,e);return YC(r,n,i,null)}function vq(t){return t.fold((e,n,r)=>{if(n&&rs(n))return[Om(n)];{let i=[];return n&&(i=yF(n)),vt(r,(s,o)=>{i=i.concat(o)}),i}})}function hd(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(dq())(t._repo,t._path):t}function xq(t,e){for(let n=0;n<e.length;++n){let r=e[n];if(!r._queryParams.loadsAllData()){let i=Vm(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function wq(){return hq++}function Eq(t,e,n){let r=e._path,i=Ed(t,e),s=CF(t,n),o=t.listenProvider_.startListening(hd(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)D(!rs(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((u,l,d)=>{if(!oe(u)&&l&&rs(l))return[Om(l).query];{let h=[];return l&&(h=h.concat(yF(l).map(f=>f.query))),vt(d,(f,p)=>{h=h.concat(p)}),h}});for(let u=0;u<c.length;++u){let l=c[u];t.listenProvider_.stopListening(hd(l),Ed(t,l))}}return o}var _C=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},yC=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=Le(this.path_,e);return new t(this.syncTree_,n)}node(){return Fm(this.syncTree_,this.path_)}},Iq=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},SO=function(t,e,n){if(!t||typeof t!="object")return t;if(D(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return Cq(t[".sv"],e,n);if(typeof t[".sv"]=="object")return bq(t[".sv"],e);D(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},Cq=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:D(!1,"Unexpected server value: "+t)}},bq=function(t,e,n){t.hasOwnProperty("increment")||D(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&D(!1,"Unexpected increment value: "+r);let i=e.node();if(D(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},bF=function(t,e,n,r){return nb(e,new yC(n,t),r)},tb=function(t,e,n){return nb(t,new _C(e),n)};function nb(t,e,n){let r=t.getPriority().val(),i=SO(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=SO(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new Ic(a,Be(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Ic(i))),o.forEachChild(Ne,(a,c)=>{let u=nb(c,e.getImmediateChild(a),n);u!==c&&(s=s.updateImmediateChild(a,u))}),s}}var Id=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function Lm(t,e){let n=e instanceof xe?e:new xe(e),r=t,i=se(n);for(;i!==null;){let s=ci(r.node.children,i)||{children:{},childCount:0};r=new Id(i,r,s),n=Ae(n),i=se(n)}return r}function Eo(t){return t.node.value}function rb(t,e){t.node.value=e,vC(t)}function DF(t){return t.node.childCount>0}function Dq(t){return Eo(t)===void 0&&!DF(t)}function jm(t,e){vt(t.node.children,(n,r)=>{e(new Id(n,t,r))})}function TF(t,e,n,r){n&&!r&&e(t),jm(t,i=>{TF(i,e,!0,r)}),n&&r&&e(t)}function Tq(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Rd(t){return new xe(t.parent===null?t.name:Rd(t.parent)+"/"+t.name)}function vC(t){t.parent!==null&&Sq(t.parent,t.name,t)}function Sq(t,e,n){let r=Dq(n),i=xn(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,vC(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,vC(t))}var Aq=/[\[\].#$\/\u0000-\u001F\u007F]/,Mq=/[\[\].#$\u0000-\u001F\u007F]/,MI=10*1024*1024,Bm=function(t){return typeof t=="string"&&t.length!==0&&!Aq.test(t)},SF=function(t){return typeof t=="string"&&t.length!==0&&!Mq.test(t)},Rq=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),SF(t)},Cd=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Rm(t)||t&&typeof t=="object"&&xn(t,".sv")},Or=function(t,e,n,r){r&&e===void 0||Nd(Jt(t,"value"),e,n)},Nd=function(t,e,n){let r=n instanceof xe?new HI(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+mo(r));if(typeof e=="function")throw new Error(t+"contains a function "+mo(r)+" with contents = "+e.toString());if(Rm(e))throw new Error(t+"contains "+e.toString()+" "+mo(r));if(typeof e=="string"&&e.length>MI/3&&Vc(e)>MI)throw new Error(t+"contains a string greater than "+MI+" utf8 bytes "+mo(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(vt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Bm(o)))throw new Error(t+" contains an invalid key ("+o+") "+mo(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);aH(r,o),Nd(t,a,r),cH(r)}),i&&s)throw new Error(t+' contains ".value" child '+mo(r)+" in addition to actual children.")}},Nq=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];let s=pd(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!Bm(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(oH);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&On(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},AF=function(t,e,n,r){if(r&&e===void 0)return;let i=Jt(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];vt(e,(o,a)=>{let c=new xe(o);if(Nd(i,a,Le(n,c)),BC(c)===".priority"&&!Cd(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),Nq(i,s)},ib=function(t,e,n){if(!(n&&e===void 0)){if(Rm(e))throw new Error(Jt(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Cd(e))throw new Error(Jt(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Pd=function(t,e,n,r){if(!(r&&n===void 0)&&!Bm(n))throw new Error(Jt(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Pc=function(t,e,n,r){if(!(r&&n===void 0)&&!SF(n))throw new Error(Jt(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Pq=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Pc(t,e,n,r)},mn=function(t,e){if(se(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},MF=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Bm(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!Rq(n))throw new Error(Jt(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var xC=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Um(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!UC(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function RF(t,e,n){Um(t,n),NF(t,r=>UC(r,e))}function _n(t,e,n){Um(t,n),NF(t,r=>On(r,e)||On(e,r))}function NF(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?(kq(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function kq(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();yo&&yt("event: "+n.toString()),Mc(r)}}}var PF="repo_interrupt",Oq=25,wC=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new xC,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=pm(),this.transactionQueueTree_=new Id,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function Fq(t,e,n){if(t.stats_=jC(t.repoInfo_),t.forceRestClient_||F7())t.server_=new eC(t.repoInfo_,(r,i,s,o)=>{AO(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>MO(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ye(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new $C(t.repoInfo_,e,(r,i,s,o)=>{AO(t,r,i,s,o)},r=>{MO(t,r)},r=>{Vq(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=L7(t.repoInfo_,()=>new sC(t.stats_,t.server_)),t.infoData_=new tC,t.infoSyncTree_=new Im({startListening:(r,i,s,o)=>{let a=[],c=t.infoData_.getNode(r._path);return c.isEmpty()||(a=Md(t.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),sb(t,"connected",!1),t.serverSyncTree_=new Im({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,c)=>{let u=o(a,c);_n(t.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function kF(t){let n=t.infoData_.getNode(new xe(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function kd(t){return Iq({timestamp:kF(t)})}function AO(t,e,n,r,i){t.dataUpdateCount++;let s=new xe(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let c=Fc(n,u=>Be(u));o=_q(t.serverSyncTree_,s,c,i)}else{let c=Be(n);o=wF(t.serverSyncTree_,s,c,i)}else if(r){let c=Fc(n,u=>Be(u));o=pq(t.serverSyncTree_,s,c)}else{let c=Be(n);o=Md(t.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=Sc(t,s)),_n(t.eventQueue_,a,o)}function MO(t,e){sb(t,"connected",e),e===!1&&Bq(t)}function Vq(t,e){vt(e,(n,r)=>{sb(t,n,r)})}function sb(t,e,n){let r=new xe("/.info/"+e),i=Be(n);t.infoData_.updateSnapshot(r,i);let s=Md(t.infoSyncTree_,r,i);_n(t.eventQueue_,r,s)}function $m(t){return t.nextWriteId_++}function Lq(t,e,n){let r=yq(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{let s=Be(i).withIndex(e._queryParams.getIndex());mC(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Md(t.serverSyncTree_,e._path,s);else{let a=Ed(t.serverSyncTree_,e);o=wF(t.serverSyncTree_,e._path,s,a)}return _n(t.eventQueue_,e._path,o),Cm(t.serverSyncTree_,e,n,null,!0),s},i=>(kc(t,"get for query "+Ye(e)+" failed: "+i),Promise.reject(new Error(i))))}function ob(t,e,n,r,i){kc(t,"set",{path:e.toString(),value:n,priority:r});let s=kd(t),o=Be(n,r),a=Fm(t.serverSyncTree_,e),c=tb(o,a,s),u=$m(t),l=ZC(t.serverSyncTree_,e,c,u,!0);Um(t.eventQueue_,l),t.server_.put(e.toString(),o.val(!0),(h,f)=>{let p=h==="ok";p||Ot("set at "+e+" failed: "+h);let m=Xi(t.serverSyncTree_,u,!p);_n(t.eventQueue_,e,m),is(t,i,h,f)});let d=cb(t,e);Sc(t,d),_n(t.eventQueue_,d,[])}function jq(t,e,n,r){kc(t,"update",{path:e.toString(),value:n});let i=!0,s=kd(t),o={};if(vt(n,(a,c)=>{i=!1,o[a]=bF(Le(e,a),Be(c),t.serverSyncTree_,s)}),i)yt("update() called with empty data.  Don't do anything."),is(t,r,"ok",void 0);else{let a=$m(t),c=fq(t.serverSyncTree_,e,o,a);Um(t.eventQueue_,c),t.server_.merge(e.toString(),n,(u,l)=>{let d=u==="ok";d||Ot("update at "+e+" failed: "+u);let h=Xi(t.serverSyncTree_,a,!d),f=h.length>0?Sc(t,e):e;_n(t.eventQueue_,f,h),is(t,r,u,l)}),vt(n,u=>{let l=cb(t,Le(e,u));Sc(t,l)}),_n(t.eventQueue_,e,[])}}function Bq(t){kc(t,"onDisconnectEvents");let e=kd(t),n=pm();rC(t.onDisconnect_,ve(),(i,s)=>{let o=bF(i,s,t.serverSyncTree_,e);Rc(n,i,o)});let r=[];rC(n,ve(),(i,s)=>{r=r.concat(Md(t.serverSyncTree_,i,s));let o=cb(t,i);Sc(t,o)}),t.onDisconnect_=pm(),_n(t.eventQueue_,ve(),r)}function Uq(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&nC(t.onDisconnect_,e),is(t,n,r,i)})}function RO(t,e,n,r){let i=Be(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Rc(t.onDisconnect_,e,i),is(t,r,s,o)})}function $q(t,e,n,r,i){let s=Be(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&Rc(t.onDisconnect_,e,s),is(t,i,o,a)})}function Hq(t,e,n,r){if(Hd(n)){yt("onDisconnect().update() called with empty data.  Don't do anything."),is(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&vt(n,(o,a)=>{let c=Be(a);Rc(t.onDisconnect_,Le(e,o),c)}),is(t,r,i,s)})}function qq(t,e,n){let r;se(e._path)===".info"?r=mC(t.infoSyncTree_,e,n):r=mC(t.serverSyncTree_,e,n),RF(t.eventQueue_,e._path,r)}function EC(t,e,n){let r;se(e._path)===".info"?r=Cm(t.infoSyncTree_,e,n):r=Cm(t.serverSyncTree_,e,n),RF(t.eventQueue_,e._path,r)}function OF(t){t.persistentConnection_&&t.persistentConnection_.interrupt(PF)}function Gq(t){t.persistentConnection_&&t.persistentConnection_.resume(PF)}function kc(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),yt(n,...e)}function is(t,e,n,r){e&&Mc(()=>{if(n==="ok")e(null);else{let i=(n||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function zq(t,e,n,r,i,s){kc(t,"transaction on "+e);let o={path:e,update:n,onComplete:r,status:null,order:kO(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=ab(t,e,void 0);o.currentInputSnapshot=a;let c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Nd("transaction failed: Data returned ",c,o.path),o.status=0;let u=Lm(t.transactionQueueTree_,e),l=Eo(u)||[];l.push(o),rb(u,l);let d;typeof c=="object"&&c!==null&&xn(c,".priority")?(d=ci(c,".priority"),D(Cd(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(Fm(t.serverSyncTree_,e)||ee.EMPTY_NODE).getPriority().val();let h=kd(t),f=Be(c,d),p=tb(f,a,h);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=$m(t);let m=ZC(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);_n(t.eventQueue_,e,m),Hm(t,t.transactionQueueTree_)}}function ab(t,e,n){return Fm(t.serverSyncTree_,e,n)||ee.EMPTY_NODE}function Hm(t,e=t.transactionQueueTree_){if(e||qm(t,e),Eo(e)){let n=VF(t,e);D(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&Wq(t,Rd(e),n)}else DF(e)&&jm(e,n=>{Hm(t,n)})}function Wq(t,e,n){let r=n.map(u=>u.currentWriteId),i=ab(t,e,r),s=i,o=i.hash();for(let u=0;u<n.length;u++){let l=n[u];D(l.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),l.status=1,l.retryCount++;let d=Qt(e,l.path);s=s.updateChild(d,l.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;t.server_.put(c.toString(),a,u=>{kc(t,"transaction put response",{path:c.toString(),status:u});let l=[];if(u==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,l=l.concat(Xi(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();qm(t,Lm(t.transactionQueueTree_,e)),Hm(t,t.transactionQueueTree_),_n(t.eventQueue_,e,l);for(let h=0;h<d.length;h++)Mc(d[h])}else{if(u==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{Ot("transaction at "+c.toString()+" failed: "+u);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=u}Sc(t,e)}},o)}function Sc(t,e){let n=FF(t,e),r=Rd(n),i=VF(t,n);return Kq(t,i,r),r}function Kq(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],u=Qt(n,c.path),l=!1,d;if(D(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)l=!0,d=c.abortReason,i=i.concat(Xi(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=Oq)l=!0,d="maxretry",i=i.concat(Xi(t.serverSyncTree_,c.currentWriteId,!0));else{let h=ab(t,c.path,o);c.currentInputSnapshot=h;let f=e[a].update(h.val());if(f!==void 0){Nd("transaction failed: Data returned ",f,c.path);let p=Be(f);typeof f=="object"&&f!=null&&xn(f,".priority")||(p=p.updatePriority(h.getPriority()));let v=c.currentWriteId,C=kd(t),F=tb(p,h,C);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=F,c.currentWriteId=$m(t),o.splice(o.indexOf(v),1),i=i.concat(ZC(t.serverSyncTree_,c.path,F,c.currentWriteId,c.applyLocally)),i=i.concat(Xi(t.serverSyncTree_,v,!0))}else l=!0,d="nodata",i=i.concat(Xi(t.serverSyncTree_,c.currentWriteId,!0))}_n(t.eventQueue_,n,i),i=[],l&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}qm(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Mc(r[a]);Hm(t,t.transactionQueueTree_)}function FF(t,e){let n,r=t.transactionQueueTree_;for(n=se(e);n!==null&&Eo(r)===void 0;)r=Lm(r,n),e=Ae(e),n=se(e);return r}function VF(t,e){let n=[];return LF(t,e,n),n.sort((r,i)=>r.order-i.order),n}function LF(t,e,n){let r=Eo(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);jm(e,i=>{LF(t,i,n)})}function qm(t,e){let n=Eo(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,rb(e,n.length>0?n:void 0)}jm(e,r=>{qm(t,r)})}function cb(t,e){let n=Rd(FF(t,e)),r=Lm(t.transactionQueueTree_,e);return Tq(r,i=>{RI(t,i)}),RI(t,r),TF(r,i=>{RI(t,i)}),n}function RI(t,e){let n=Eo(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(D(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(D(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(Xi(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?rb(e,void 0):n.length=s+1,_n(t.eventQueue_,Rd(e),i);for(let o=0;o<r.length;o++)Mc(r[o])}}function Qq(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function Yq(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Ot(`Invalid query segment '${n}' in query '${t}'`)}return e}var IC=function(t,e){let n=Zq(t),r=n.namespace;n.domain==="firebase.com"&&Pr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Pr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||T7();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new om(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new xe(n.pathString)}},Zq=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",c=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));let l=t.indexOf("/");l===-1&&(l=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(l,d)),l<d&&(i=Qq(t.substring(l,d)));let h=Yq(t.substring(Math.min(t.length,d)));u=e.indexOf(":"),u>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;let f=e.slice(0,u);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=r}"ns"in h&&(s=h.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var NO="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Xq=function(){let t=0,e=[];return function(n){let r=n===t;t=n;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=NO.charAt(n%64),n=Math.floor(n/64);D(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=NO.charAt(e[i]);return D(o.length===20,"nextPushId: Length should be 20."),o}}();var bm=class{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Ye(this.snapshot.exportVal())}},Dm=class{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var bd=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return D(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var Tm=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new ht;return Uq(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){mn("OnDisconnect.remove",this._path);let e=new ht;return RO(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){mn("OnDisconnect.set",this._path),Or("OnDisconnect.set",e,this._path,!1);let n=new ht;return RO(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){mn("OnDisconnect.setWithPriority",this._path),Or("OnDisconnect.setWithPriority",e,this._path,!1),ib("OnDisconnect.setWithPriority",n,!1);let r=new ht;return $q(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){mn("OnDisconnect.update",this._path),AF("OnDisconnect.update",e,this._path,!1);let n=new ht;return Hq(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var Zt=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return oe(this._path)?null:BC(this._path)}get ref(){return new yn(this._repo,this._path)}get _queryIdentifier(){let e=yO(this._queryParams),n=LC(e);return n==="{}"?"default":n}get _queryObject(){return yO(this._queryParams)}isEqual(e){if(e=le(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=UC(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+sH(this._path)}};function Gm(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function os(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Nr){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==ts)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==oi)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Ne){if(e!=null&&!Cd(e)||n!=null&&!Cd(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(D(t.getIndex()instanceof gd||t.getIndex()===qC,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function zm(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var yn=class t extends Zt{constructor(e,n){super(e,n,new vd,!1)}get parent(){let e=tF(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Ac=class t{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new xe(e),r=ss(this.ref,e);return new t(this._node.getChild(n),r,Ne)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new t(i,ss(this.ref,r),Ne)))}hasChild(e){let n=new xe(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function ub(t,e){return t=le(t),t._checkNotDeleted("ref"),e!==void 0?ss(t._root,e):t._root}function lb(t,e){t=le(t),t._checkNotDeleted("refFromURL");let n=IC(e,t._repo.repoInfo_.nodeAdmin);MF("refFromURL",n);let r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&Pr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),ub(t,n.path.toString())}function ss(t,e){return t=le(t),se(t._path)===null?Pq("child","path",e,!1):Pc("child","path",e,!1),new yn(t._repo,Le(t._path,e))}function jF(t,e){t=le(t),mn("push",t._path),Or("push",e,t._path,!0);let n=kF(t._repo),r=Xq(n),i=ss(t,r),s=ss(t,r),o;return e!=null?o=Wm(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function BF(t){return mn("remove",t._path),Wm(t,null)}function Wm(t,e){t=le(t),mn("set",t._path),Or("set",e,t._path,!1);let n=new ht;return ob(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function UF(t,e){t=le(t),mn("setPriority",t._path),ib("setPriority",e,!1);let n=new ht;return ob(t._repo,Le(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function $F(t,e,n){if(mn("setWithPriority",t._path),Or("setWithPriority",e,t._path,!1),ib("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let r=new ht;return ob(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function HF(t,e){AF("update",e,t._path,!1);let n=new ht;return jq(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function qF(t){t=le(t);let e=new bd(()=>{}),n=new Dd(e);return Lq(t._repo,t,n).then(r=>new Ac(r,new yn(t._repo,t._path),t._queryParams.getIndex()))}var Dd=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let r=n._queryParams.getIndex();return new bm("value",this,new Ac(e.snapshotNode,new yn(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Dm(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},Sm=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Dm(this,e,n):null}createEvent(e,n){D(e.childName!=null,"Child events should have a childName.");let r=ss(new yn(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new bm(e.type,this,new Ac(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Od(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=n,u=(l,d)=>{EC(t._repo,t,a),c(l,d)};u.userCallback=n.userCallback,u.context=n.context,n=u}let o=new bd(n,s||void 0),a=e==="value"?new Dd(o):new Sm(e,o);return qq(t._repo,t,a),()=>EC(t._repo,t,a)}function Km(t,e,n,r){return Od(t,"value",e,n,r)}function db(t,e,n,r){return Od(t,"child_added",e,n,r)}function hb(t,e,n,r){return Od(t,"child_changed",e,n,r)}function fb(t,e,n,r){return Od(t,"child_moved",e,n,r)}function pb(t,e,n,r){return Od(t,"child_removed",e,n,r)}function gb(t,e,n){let r=null,i=n?new bd(n):null;e==="value"?r=new Dd(i):e&&(r=new Sm(e,i)),EC(t._repo,t,r)}var vn=class{},Am=class extends vn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){Or("endAt",this._value,e._path,!0);let n=JI(e._queryParams,this._value,this._key);if(zm(n),os(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Zt(e._repo,e._path,n,e._orderByCalled)}};function GF(t,e){return Pd("endAt","key",e,!0),new Am(t,e)}var CC=class extends vn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){Or("endBefore",this._value,e._path,!1);let n=CH(e._queryParams,this._value,this._key);if(zm(n),os(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Zt(e._repo,e._path,n,e._orderByCalled)}};function zF(t,e){return Pd("endBefore","key",e,!0),new CC(t,e)}var Mm=class extends vn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){Or("startAt",this._value,e._path,!0);let n=XI(e._queryParams,this._value,this._key);if(zm(n),os(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Zt(e._repo,e._path,n,e._orderByCalled)}};function WF(t=null,e){return Pd("startAt","key",e,!0),new Mm(t,e)}var bC=class extends vn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){Or("startAfter",this._value,e._path,!1);let n=IH(e._queryParams,this._value,this._key);if(zm(n),os(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Zt(e._repo,e._path,n,e._orderByCalled)}};function KF(t,e){return Pd("startAfter","key",e,!0),new bC(t,e)}var DC=class extends vn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Zt(e._repo,e._path,wH(e._queryParams,this._limit),e._orderByCalled)}};function QF(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new DC(t)}var TC=class extends vn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Zt(e._repo,e._path,EH(e._queryParams,this._limit),e._orderByCalled)}};function YF(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new TC(t)}var SC=class extends vn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Gm(e,"orderByChild");let n=new xe(this._path);if(oe(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new gd(n),i=Nm(e._queryParams,r);return os(i),new Zt(e._repo,e._path,i,!0)}};function ZF(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Pc("orderByChild","path",t,!1),new SC(t)}var AC=class extends vn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Gm(e,"orderByKey");let n=Nm(e._queryParams,Nr);return os(n),new Zt(e._repo,e._path,n,!0)}};function XF(){return new AC}var MC=class extends vn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Gm(e,"orderByPriority");let n=Nm(e._queryParams,Ne);return os(n),new Zt(e._repo,e._path,n,!0)}};function JF(){return new MC}var RC=class extends vn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Gm(e,"orderByValue");let n=Nm(e._queryParams,qC);return os(n),new Zt(e._repo,e._path,n,!0)}};function e2(){return new RC}var NC=class extends vn{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(Or("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Am(this._value,this._key)._apply(new Mm(this._value,this._key)._apply(e))}};function t2(t,e){return Pd("equalTo","key",e,!0),new NC(t,e)}function Vn(t,...e){let n=le(t);for(let r of e)n=r._apply(n);return n}sq(yn);lq(yn);var Jq="FIREBASE_DATABASE_EMULATOR_HOST",PC={},eG=!1;function tG(t,e,n,r){t.repoInfo_=new om(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function mb(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||Pr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),yt("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=IC(s,i),a=o.repoInfo,c,u;typeof process<"u"&&process.env&&(u=process.env[Jq]),u?(c=!0,s=`http://${u}?ns=${a.namespace}`,o=IC(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let l=i&&c?new ud(ud.OWNER):new VI(t.name,t.options,e);MF("Invalid Firebase Database URL",o),oe(o.path)||Pr("Database URL must point to the root of a Firebase Database (not including a child path).");let d=rG(a,t,l,new FI(t.name,n));return new kC(d,t)}function nG(t,e){let n=PC[e];(!n||n[t.key]!==t)&&Pr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),OF(t),delete n[t.key]}function rG(t,e,n,r){let i=PC[e.name];i||(i={},PC[e.name]=i);let s=i[t.toURLString()];return s&&Pr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new wC(t,eG,n,r),i[t.toURLString()]=s,s}var kC=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Fq(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new yn(this._repo,ve())),this._rootInternal}_delete(){return this._rootInternal!==null&&(nG(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Pr("Cannot call "+e+" on a deleted database.")}};function n2(){eF.IS_TRANSPORT_INITIALIZED&&Ot("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function r2(){n2(),fd.forceDisallow()}function i2(){n2(),vc.forceDisallow(),fd.forceAllow()}function s2(t,e,n,r={}){t=le(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Pr("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Pr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new ud(ud.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:Bd(r.mockUserToken,t.app.options.projectId);s=new ud(o)}tG(i,e,n,s)}function o2(t){t=le(t),t._checkNotDeleted("goOffline"),OF(t._repo)}function a2(t){t=le(t),t._checkNotDeleted("goOnline"),Gq(t._repo)}function c2(t,e){FO(t,e)}function iG(t){VC(Gd),as(new cn("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return mb(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),Ln(tO,nO,t),Ln(tO,nO,"esm2017")}var sG={".sv":"timestamp"};function u2(){return sG}function l2(t){return{".sv":{increment:t}}}var OC=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function d2(t,e,n){var r;if(t=le(t),mn("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let i=(r=n?.applyLocally)!==null&&r!==void 0?r:!0,s=new ht,o=(c,u,l)=>{let d=null;c?s.reject(c):(d=new Ac(l,new yn(t._repo,t._path),Ne),s.resolve(new OC(u,d)))},a=Km(t,()=>{});return zq(t._repo,t._path,e,o,a,i),s.promise}$C.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};$C.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};iG();var oG="@firebase/database-compat",aG="1.0.4";var cG=new ui("@firebase/database-compat"),h2=function(t){let e="FIREBASE WARNING: "+t;cG.warn(e)};var uG=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(Jt(t,e)+"must be a boolean.")},lG=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Jt(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var _b=class{constructor(e){this._delegate=e}cancel(e){q("OnDisconnect.cancel",0,1,arguments.length),at("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){q("OnDisconnect.remove",0,1,arguments.length),at("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){q("OnDisconnect.set",1,2,arguments.length),at("OnDisconnect.set","onComplete",n,!0);let r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){q("OnDisconnect.setWithPriority",2,3,arguments.length),at("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(q("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,h2("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}at("OnDisconnect.update","onComplete",n,!0);let r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}};var yb=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return q("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var Io=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return q("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return q("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return q("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return q("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return q("DataSnapshot.child",0,1,arguments.length),e=String(e),Pc("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return q("DataSnapshot.hasChild",1,1,arguments.length),Pc("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return q("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return q("DataSnapshot.forEach",1,1,arguments.length),at("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return q("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return q("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return q("DataSnapshot.ref",0,0,arguments.length),new ai(this._database,this._delegate.ref)}get ref(){return this.getRef()}},Qm=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;q("Query.on",2,4,arguments.length),at("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",r,i),a=(u,l)=>{n.call(o.context,new Io(this.database,u),l)};a.userCallback=n,a.context=o.context;let c=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return Km(this._delegate,a,c),n;case"child_added":return db(this._delegate,a,c),n;case"child_removed":return pb(this._delegate,a,c),n;case"child_changed":return hb(this._delegate,a,c),n;case"child_moved":return fb(this._delegate,a,c),n;default:throw new Error(Jt("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(q("Query.off",0,3,arguments.length),lG("Query.off",e,!0),at("Query.off","callback",n,!0),t_("Query.off","context",r,!0),n){let i=()=>{};i.userCallback=n,i.context=r,gb(this._delegate,e,i)}else gb(this._delegate,e)}get(){return qF(this._delegate).then(e=>new Io(this.database,e))}once(e,n,r,i){q("Query.once",1,4,arguments.length),at("Query.once","callback",n,!0);let s=t.getCancelAndContextArgs_("Query.once",r,i),o=new ht,a=(u,l)=>{let d=new Io(this.database,u);n&&n.call(s.context,d,l),o.resolve(d)};a.userCallback=n,a.context=s.context;let c=u=>{s.cancel&&s.cancel.call(s.context,u),o.reject(u)};switch(e){case"value":Km(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":db(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":pb(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":hb(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":fb(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(Jt("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return q("Query.limitToFirst",1,1,arguments.length),new t(this.database,Vn(this._delegate,QF(e)))}limitToLast(e){return q("Query.limitToLast",1,1,arguments.length),new t(this.database,Vn(this._delegate,YF(e)))}orderByChild(e){return q("Query.orderByChild",1,1,arguments.length),new t(this.database,Vn(this._delegate,ZF(e)))}orderByKey(){return q("Query.orderByKey",0,0,arguments.length),new t(this.database,Vn(this._delegate,XF()))}orderByPriority(){return q("Query.orderByPriority",0,0,arguments.length),new t(this.database,Vn(this._delegate,JF()))}orderByValue(){return q("Query.orderByValue",0,0,arguments.length),new t(this.database,Vn(this._delegate,e2()))}startAt(e=null,n){return q("Query.startAt",0,2,arguments.length),new t(this.database,Vn(this._delegate,WF(e,n)))}startAfter(e=null,n){return q("Query.startAfter",0,2,arguments.length),new t(this.database,Vn(this._delegate,KF(e,n)))}endAt(e=null,n){return q("Query.endAt",0,2,arguments.length),new t(this.database,Vn(this._delegate,GF(e,n)))}endBefore(e=null,n){return q("Query.endBefore",0,2,arguments.length),new t(this.database,Vn(this._delegate,zF(e,n)))}equalTo(e,n){return q("Query.equalTo",1,2,arguments.length),new t(this.database,Vn(this._delegate,t2(e,n)))}toString(){return q("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return q("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(q("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){let i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,at(e,"cancel",i.cancel,!0),i.context=r,t_(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(Jt(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new ai(this.database,new yn(this._delegate._repo,this._delegate._path))}},ai=class t extends Qm{constructor(e,n){super(e,new Zt(n._repo,n._path,new vd,!1)),this.database=e,this._delegate=n}getKey(){return q("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return q("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,ss(this._delegate,e))}getParent(){q("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return q("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){q("Reference.set",1,2,arguments.length),at("Reference.set","onComplete",n,!0);let r=Wm(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(q("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,h2("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}mn("Reference.update",this._delegate._path),at("Reference.update","onComplete",n,!0);let r=HF(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){q("Reference.setWithPriority",2,3,arguments.length),at("Reference.setWithPriority","onComplete",r,!0);let i=$F(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){q("Reference.remove",0,1,arguments.length),at("Reference.remove","onComplete",e,!0);let n=BF(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){q("Reference.transaction",1,3,arguments.length),at("Reference.transaction","transactionUpdate",e,!1),at("Reference.transaction","onComplete",n,!0),uG("Reference.transaction","applyLocally",r,!0);let i=d2(this._delegate,e,{applyLocally:r}).then(s=>new yb(s.committed,new Io(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){q("Reference.setPriority",1,2,arguments.length),at("Reference.setPriority","onComplete",n,!0);let r=UF(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){q("Reference.push",0,2,arguments.length),at("Reference.push","onComplete",n,!0);let r=jF(this._delegate,e),i=r.then(o=>new t(this.database,o));n&&i.then(()=>n(null),o=>n(o));let s=new t(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return mn("Reference.onDisconnect",this._delegate._path),new _b(new Tm(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var Co=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:r2,forceLongPolling:i2}}useEmulator(e,n,r={}){s2(this._delegate,e,n,r)}ref(e){if(q("database.ref",0,1,arguments.length),e instanceof ai){let n=lb(this._delegate,e.toString());return new ai(this,n)}else{let n=ub(this._delegate,e);return new ai(this,n)}}refFromURL(e){q("database.refFromURL",1,1,arguments.length);let r=lb(this._delegate,e);return new ai(this,r)}goOffline(){return q("database.goOffline",0,0,arguments.length),o2(this._delegate)}goOnline(){return q("database.goOnline",0,0,arguments.length),a2(this._delegate)}};Co.ServerValue={TIMESTAMP:u2(),increment:t=>l2(t)};function dG({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){VC(n);let a=new n_("database-standalone"),c=new qd("auth-internal",a);c.setComponent(new cn("auth-internal",()=>r,"PRIVATE"));let u;return i&&(u=new qd("app-check-internal",a),u.setComponent(new cn("app-check-internal",()=>i,"PRIVATE"))),{instance:new Co(mb(t,c,u,e,o),t),namespace:s}}var hG=Object.freeze({__proto__:null,initStandalone:dG});var fG=Co.ServerValue;function pG(t){t.INTERNAL.registerComponent(new cn("database-compat",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new Co(i,r)},"PUBLIC").setServiceProps({Reference:ai,Query:Qm,Database:Co,DataSnapshot:Io,enableLogging:c2,INTERNAL:hG,ServerValue:fG}).setMultipleInstances(!0)),t.registerVersion(oG,aG)}pG(xt);function Fd(t,e,n="on",r=hs){return new ie(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),n==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),n==="on"?{unsubscribe(){s!=null&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(j(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),qc())}function gG(t){return typeof t=="string"}function mG(t){return typeof t.exportVal=="function"}function _2(t){return t==null}function y2(t){return typeof t.set=="function"}function f2(t,e){return y2(e)?e:t.ref(e)}function v2(t,e){if(gG(t))return e.stringCase();if(y2(t))return e.firebaseCase();if(mG(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function x2(t){return(_2(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function w2(t,e,n){e=x2(e);let r=e.map(i=>Fd(t,i,"on",n));return Lo(...r)}function _G(t,e,n){let r=w2(t,e).pipe(or((i,s)=>[...i,s],[]));return vG(t,r,n)}function yG(t,e){return Fd(t,"value","on",e).pipe(j(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}function vG(t,e,n){return yG(t,n).pipe(D_(e),j(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(c=>c.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),C_(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),j(i=>i.actions))}function p2(t,e){return function(r,i){return v2(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function xG(t){return function(n){return n?v2(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function wG(t,e,n){return Fd(t,"value","once",n).pipe(Oe(r=>{let i=[B(r)];return e.forEach(s=>i.push(Fd(t,s,"on",n))),Lo(...i).pipe(or(IG,[]))}),Uc())}function E2(t,e){let n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function EG(t,e){if(_2(e))return 0;{let n=E2(t,e);return n===-1?t.length:n+1}}function IG(t,e){let{payload:n,prevKey:r,key:i}=e,s=E2(t,i),o=EG(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(c=>{let u={payload:c,type:"value",prevKey:a,key:c.key};return a=c.key,t=[...t,u],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(c=>c.payload.key!==n.key),t.splice(o,0,e));else{if(r==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=t.splice(s,1)[0];return t=t.slice(),t.splice(o,0,a),t}return t;default:return t}}function g2(t,e,n){return e=x2(e),wG(t,e,n)}function CG(t,e){let n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:p2(r,"update"),set:p2(r,"set"),push:i=>r.push(i),remove:xG(r),snapshotChanges(i){return g2(t,i,n).pipe(ze)},stateChanges(i){return w2(t,i,n).pipe(ze)},auditTrail(i){return _G(t,i,n).pipe(ze)},valueChanges(i,s){return g2(t,i,n).pipe(j(a=>a.map(c=>s&&s.idField?ue(A({},c.payload.val()),{[s.idField]:c.key}):c.payload.val())),ze)}}}function m2(t,e){return function(){return Fd(t,"value","on",e)}}function bG(t,e){return{query:t,snapshotChanges(){return m2(t,e.schedulers.outsideAngular)().pipe(ze)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return m2(t,e.schedulers.outsideAngular)().pipe(ze,j(r=>r.payload.exists()?r.payload.val():null))}}}var DG=new O("angularfire2.realtimeDatabaseURL"),TG=new O("angularfire2.database.use-emulator"),SG=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,c,u,l,d,h,f,p,m,v){this.schedulers=a;let C=c,F=Fs(n,o,r);u&&Uu(F,o,l,h,f,p,d,m),this.database=xa(`${F.name}.database.${i}`,"AngularFireDatabase",F.name,()=>{let T=o.runOutsideAngular(()=>F.database(i||void 0));return C&&T.useEmulator(...C),T},[C])}list(n,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>f2(this.database,n)),s=i;return r&&(s=r(i)),CG(s,this)}object(n){let r=this.schedulers.ngZone.runOutsideAngular(()=>f2(this.database,n));return bG(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(w(Ai),w(Mi,8),w(DG,8),w(Mt),w(de),w(va),w(TG,8),w(Jf,8),w(Ou,8),w(Fu,8),w(Vu,8),w(Lu,8),w(ju,8),w(Bu,8),w(Kr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),I2=(()=>{class t{constructor(){xt.registerVersion("angularfire",Os.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=et({type:t});static \u0275inj=Je({providers:[SG]})}return t})();var C2=(()=>{let e=class e{constructor(){this.title="360Car"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Tn({type:e,selectors:[["app-root"]],decls:21,vars:0,consts:[[1,"navbar"],["href","#",1,"navbar-brand"],["src","../assets/images/OIG_WB_white.png","alt","logo",1,"logo"],["routerLink","/home"],["routerLink","/coches"],["routerLink","/transacciones"],["routerLink","/clientes"],[1,"container"]],template:function(i,s){i&1&&(E(0,"header")(1,"nav",0)(2,"a",1),Ei(3,"img",2),E(4,"span"),S(5,"360Car"),b()(),E(6,"ul")(7,"li")(8,"a",3),S(9,"Home"),b()(),E(10,"li")(11,"a",4),S(12,"Coches"),b()(),E(13,"li")(14,"a",5),S(15,"Transacciones"),b()(),E(16,"li")(17,"a",6),S(18,"Clientes"),b()()()()(),E(19,"div",7),Ei(20,"router-outlet"),b())},dependencies:[fv,u1],styles:[".navbar[_ngcontent-%COMP%]{padding:0 2rem;display:flex;justify-content:space-between;align-items:center;background-color:var(--black)}.navbar-brand[_ngcontent-%COMP%]{display:flex;align-items:center}img[_ngcontent-%COMP%]{height:6rem}ul[_ngcontent-%COMP%]{display:flex;flex-direction:row}li[_ngcontent-%COMP%]{list-style:none;list-style-type:none;margin-left:3rem}a[_ngcontent-%COMP%]{text-decoration:none;color:var(--white);font-weight:700;font-size:1rem;transition:color ease .6s;padding:1rem}a[_ngcontent-%COMP%]:hover{color:var(--yellow)}"]});let t=e;return t})();var b2=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=et({type:e,bootstrap:[C2]}),e.\u0275inj=Je({imports:[wA,Jk,Kk,S1.initializeApp(eO.firebaseConfig),I2]});let t=e;return t})();xA().bootstrapModule(b2).catch(t=>console.error(t));
