import{A as Lb,B as bn,C as hi,D as Qd,E as Uc,F as s_,G as jb,H as Bb,I as G,J as nn,K as ut,L as o_,M as Ub,N as $c,O as de,P as fn,Q as Yd,R as a_,S as Dn,T as fi,U as us,V as Zd,W as $b,X as $n,Y as bt,a as A,b as se,c as n_,d as g,e as Ab,f as qd,g as Mb,h as Nb,i as D,j as To,k as Gd,l as Rb,m as Pb,n as pt,o as zd,p as Bc,q as r_,r as kb,s as ar,t as i_,u as Wd,v as Ob,w as Fb,x as Kd,y as Xe,z as Vb}from"./chunk-44ZLHZR4.js";var Hb=null;var c_=1,l_=Symbol("SIGNAL");function Ce(t){let e=Hb;return Hb=t,e}var qb={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function qF(t){if(!(h_(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===c_)){if(!t.producerMustRecompute(t)&&!u_(t)){t.dirty=!1,t.lastCleanEpoch=c_;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=c_}}function Gb(t){return t&&(t.nextProducerIndex=0),Ce(t)}function zb(t,e){if(Ce(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(h_(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)d_(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function u_(t){Xd(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(qF(n),r!==n.version))return!0}return!1}function Wb(t){if(Xd(t),h_(t))for(let e=0;e<t.producerNode.length;e++)d_(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function d_(t,e){if(GF(t),Xd(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)d_(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];Xd(i),i.producerIndexOfThis[r]=e}}function h_(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function Xd(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function GF(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function zF(){throw new Error}var WF=zF;function Kb(t){WF=t}function K(t){return typeof t=="function"}function So(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Jd=So(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function ds(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var We=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(K(r))try{r()}catch(s){e=s instanceof Jd?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{Qb(s)}catch(o){e=e??[],o instanceof Jd?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Jd(e)}}add(e){var n;if(e&&e!==this)if(this.closed)Qb(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&ds(n,e)}remove(e){let{_finalizers:n}=this;n&&ds(n,e),e instanceof t&&e._removeParent(this)}};We.EMPTY=(()=>{let t=new We;return t.closed=!0,t})();var f_=We.EMPTY;function eh(t){return t instanceof We||t&&"closed"in t&&K(t.remove)&&K(t.add)&&K(t.unsubscribe)}function Qb(t){K(t)?t():t.unsubscribe()}var Hn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Ao={setTimeout(t,e,...n){let{delegate:r}=Ao;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=Ao;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function th(t){Ao.setTimeout(()=>{let{onUnhandledError:e}=Hn;if(e)e(t);else throw t})}function hs(){}var Yb=p_("C",void 0,void 0);function Zb(t){return p_("E",void 0,t)}function Xb(t){return p_("N",t,void 0)}function p_(t,e,n){return{kind:t,value:e,error:n}}var fs=null;function Mo(t){if(Hn.useDeprecatedSynchronousErrorHandling){let e=!fs;if(e&&(fs={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=fs;if(fs=null,n)throw r}}else t()}function Jb(t){Hn.useDeprecatedSynchronousErrorHandling&&fs&&(fs.errorThrown=!0,fs.error=t)}var ps=class extends We{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,eh(e)&&e.add(this)):this.destination=YF}static create(e,n,r){return new Br(e,n,r)}next(e){this.isStopped?m_(Xb(e),this):this._next(e)}error(e){this.isStopped?m_(Zb(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?m_(Yb,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},KF=Function.prototype.bind;function g_(t,e){return KF.call(t,e)}var __=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){nh(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){nh(r)}else nh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){nh(n)}}},Br=class extends ps{constructor(e,n,r){super();let i;if(K(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&Hn.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&g_(e.next,s),error:e.error&&g_(e.error,s),complete:e.complete&&g_(e.complete,s)}):i=e}this.destination=new __(i)}};function nh(t){Hn.useDeprecatedSynchronousErrorHandling?Jb(t):th(t)}function QF(t){throw t}function m_(t,e){let{onStoppedNotification:n}=Hn;n&&Ao.setTimeout(()=>n(t,e))}var YF={closed:!0,next:hs,error:QF,complete:hs};var No=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Dt(t){return t}function y_(...t){return v_(t)}function v_(t){return t.length===0?Dt:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var oe=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=XF(n)?n:new Br(n,r,i);return Mo(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=eD(r),new r((i,s)=>{let o=new Br({next:a=>{try{n(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[No](){return this}pipe(...n){return v_(n)(this)}toPromise(n){return n=eD(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function eD(t){var e;return(e=t??Hn.Promise)!==null&&e!==void 0?e:Promise}function ZF(t){return t&&K(t.next)&&K(t.error)&&K(t.complete)}function XF(t){return t&&t instanceof ps||ZF(t)&&eh(t)}function x_(t){return K(t?.lift)}function X(t){return e=>{if(x_(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Q(t,e,n,r,i){return new w_(t,e,n,r,i)}var w_=class extends ps{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Ro(){return X((t,e)=>{let n=null;t._refCount++;let r=Q(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var Po=class extends oe{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,x_(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new We;let n=this.getSubject();e.add(this.source.subscribe(Q(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=We.EMPTY)}return e}refCount(){return Ro()(this)}};var tD=So(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var He=(()=>{class t extends oe{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new rh(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new tD}next(n){Mo(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){Mo(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){Mo(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?f_:(this.currentObservers=null,s.push(n),new We(()=>{this.currentObservers=null,ds(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new oe;return n.source=this,n}}return t.create=(e,n)=>new rh(e,n),t})(),rh=class extends He{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:f_}};var Tt=class extends He{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Hc={now(){return(Hc.delegate||Date).now()},delegate:void 0};var ih=class extends He{constructor(e=1/0,n=1/0,r=Hc){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=n.now(),a=0;for(let c=1;c<r.length&&r[c]<=o;c+=2)a=c;a&&r.splice(0,a+1)}}};var sh=class extends We{constructor(e,n){super()}schedule(e,n=0){return this}};var qc={setInterval(t,e,...n){let{delegate:r}=qc;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=qc;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var ko=class extends sh{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return qc.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&qc.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,ds(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var Oo=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};Oo.now=Hc.now;var Fo=class extends Oo{constructor(e,n=Oo.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var gs=new Fo(ko);var oh=class extends ko{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var ah=class extends Fo{};var E_=new ah(oh);var Ht=new oe(t=>t.complete());function nD(t){return t&&K(t.schedule)}function C_(t){return t[t.length-1]}function Vo(t){return K(C_(t))?t.pop():void 0}function cr(t){return nD(C_(t))?t.pop():void 0}function rD(t,e){return typeof C_(t)=="number"?t.pop():e}var ch=t=>t&&typeof t.length=="number"&&typeof t!="function";function lh(t){return K(t?.then)}function uh(t){return K(t[No])}function dh(t){return Symbol.asyncIterator&&K(t?.[Symbol.asyncIterator])}function hh(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function JF(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var fh=JF();function ph(t){return K(t?.[fh])}function gh(t){return Mb(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield qd(n.read());if(i)return yield qd(void 0);yield yield qd(r)}}finally{n.releaseLock()}})}function mh(t){return K(t?.getReader)}function Se(t){if(t instanceof oe)return t;if(t!=null){if(uh(t))return eV(t);if(ch(t))return tV(t);if(lh(t))return nV(t);if(dh(t))return iD(t);if(ph(t))return rV(t);if(mh(t))return iV(t)}throw hh(t)}function eV(t){return new oe(e=>{let n=t[No]();if(K(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function tV(t){return new oe(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function nV(t){return new oe(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,th)})}function rV(t){return new oe(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function iD(t){return new oe(e=>{sV(t,e).catch(n=>e.error(n))})}function iV(t){return iD(gh(t))}function sV(t,e){var n,r,i,s;return Ab(this,void 0,void 0,function*(){try{for(n=Nb(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function rn(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function Tn(t,e=0){return X((n,r)=>{n.subscribe(Q(r,i=>rn(r,t,()=>r.next(i),e),()=>rn(r,t,()=>r.complete(),e),i=>rn(r,t,()=>r.error(i),e)))})}function qn(t,e=0){return X((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function sD(t,e){return Se(t).pipe(qn(e),Tn(e))}function oD(t,e){return Se(t).pipe(qn(e),Tn(e))}function aD(t,e){return new oe(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function cD(t,e){return new oe(n=>{let r;return rn(n,e,()=>{r=t[fh](),rn(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>K(r?.return)&&r.return()})}function _h(t,e){if(!t)throw new Error("Iterable cannot be null");return new oe(n=>{rn(n,e,()=>{let r=t[Symbol.asyncIterator]();rn(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function lD(t,e){return _h(gh(t),e)}function uD(t,e){if(t!=null){if(uh(t))return sD(t,e);if(ch(t))return aD(t,e);if(lh(t))return oD(t,e);if(dh(t))return _h(t,e);if(ph(t))return cD(t,e);if(mh(t))return lD(t,e)}throw hh(t)}function xe(t,e){return e?uD(t,e):Se(t)}function B(...t){let e=cr(t);return xe(t,e)}function Lo(t,e){let n=K(t)?t:()=>t,r=i=>i.error(n());return new oe(e?i=>e.schedule(r,0,i):r)}function I_(t){return!!t&&(t instanceof oe||K(t.lift)&&K(t.subscribe))}var Ur=So(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function j(t,e){return X((n,r)=>{let i=0;n.subscribe(Q(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:oV}=Array;function aV(t,e){return oV(e)?t(...e):t(e)}function yh(t){return j(e=>aV(t,e))}var{isArray:cV}=Array,{getPrototypeOf:lV,prototype:uV,keys:dV}=Object;function vh(t){if(t.length===1){let e=t[0];if(cV(e))return{args:e,keys:null};if(hV(e)){let n=dV(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function hV(t){return t&&typeof t=="object"&&lV(t)===uV}function xh(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function Gc(...t){let e=cr(t),n=Vo(t),{args:r,keys:i}=vh(t);if(r.length===0)return xe([],e);let s=new oe(fV(r,e,i?o=>xh(i,o):Dt));return n?s.pipe(yh(n)):s}function fV(t,e,n=Dt){return r=>{dD(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)dD(e,()=>{let l=xe(t[c],e),u=!1;l.subscribe(Q(r,d=>{s[c]=d,u||(u=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function dD(t,e,n){t?rn(n,t,e):e()}function hD(t,e,n,r,i,s,o,a){let c=[],l=0,u=0,d=!1,h=()=>{d&&!c.length&&!l&&e.complete()},f=m=>l<r?p(m):c.push(m),p=m=>{s&&e.next(m),l++;let v=!1;Se(n(m,u++)).subscribe(Q(e,b=>{i?.(b),s?f(b):e.next(b)},()=>{v=!0},void 0,()=>{if(v)try{for(l--;c.length&&l<r;){let b=c.shift();o?rn(e,o,()=>p(b)):p(b)}h()}catch(b){e.error(b)}}))};return t.subscribe(Q(e,f,()=>{d=!0,h()})),()=>{a?.()}}function Je(t,e,n=1/0){return K(e)?Je((r,i)=>j((s,o)=>e(r,s,i,o))(Se(t(r,i))),n):(typeof e=="number"&&(n=e),X((r,i)=>hD(r,i,t,n)))}function pi(t=1/0){return Je(Dt,t)}function fD(){return pi(1)}function jo(...t){return fD()(xe(t,cr(t)))}function wh(t){return new oe(e=>{Se(t()).subscribe(e)})}function b_(...t){let e=Vo(t),{args:n,keys:r}=vh(t),i=new oe(s=>{let{length:o}=n;if(!o){s.complete();return}let a=new Array(o),c=o,l=o;for(let u=0;u<o;u++){let d=!1;Se(n[u]).subscribe(Q(s,h=>{d||(d=!0,l--),a[u]=h},()=>c--,void 0,()=>{(!c||!d)&&(l||s.next(r?xh(r,a):a),s.complete())}))}});return e?i.pipe(yh(e)):i}function Bo(...t){let e=cr(t),n=rD(t,1/0),r=t;return r.length?r.length===1?Se(r[0]):pi(n)(xe(r,e)):Ht}function St(t,e){return X((n,r)=>{let i=0;n.subscribe(Q(r,s=>t.call(e,s,i++)&&r.next(s)))})}function gi(t){return X((e,n)=>{let r=null,i=!1,s;r=e.subscribe(Q(n,void 0,void 0,o=>{s=Se(t(o,gi(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function pD(t,e,n,r,i){return(s,o)=>{let a=n,c=e,l=0;s.subscribe(Q(o,u=>{let d=l++;c=a?t(c,u,d):(a=!0,u),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function ms(t,e){return K(e)?Je(t,e,1):Je(t,1)}function mi(t){return X((e,n)=>{let r=!1;e.subscribe(Q(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function $r(t){return t<=0?()=>Ht:X((e,n)=>{let r=0;e.subscribe(Q(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function D_(t){return j(()=>t)}function zc(t,e=Dt){return t=t??pV,X((n,r)=>{let i,s=!0;n.subscribe(Q(r,o=>{let a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function pV(t,e){return t===e}function Eh(t=gV){return X((e,n)=>{let r=!1;e.subscribe(Q(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function gV(){return new Ur}function Wc(t){return X((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function Sn(t,e){let n=arguments.length>=2;return r=>r.pipe(t?St((i,s)=>t(i,s,r)):Dt,$r(1),n?mi(e):Eh(()=>new Ur))}function Uo(t){return t<=0?()=>Ht:X((e,n)=>{let r=[];e.subscribe(Q(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function T_(t,e){let n=arguments.length>=2;return r=>r.pipe(t?St((i,s)=>t(i,s,r)):Dt,Uo(1),n?mi(e):Eh(()=>new Ur))}function Kc(){return X((t,e)=>{let n,r=!1;t.subscribe(Q(e,i=>{let s=n;n=i,r&&e.next([s,i]),r=!0}))})}function lr(t,e){return X(pD(t,e,arguments.length>=2,!0))}function Qc(t={}){let{connector:e=()=>new He,resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,c,l=0,u=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=c=void 0,u=d=!1},p=()=>{let m=o;f(),m?.unsubscribe()};return X((m,v)=>{l++,!d&&!u&&h();let b=c=c??e();v.add(()=>{l--,l===0&&!d&&!u&&(a=S_(p,i))}),b.subscribe(v),!o&&l>0&&(o=new Br({next:F=>b.next(F),error:F=>{d=!0,h(),a=S_(f,n,F),b.error(F)},complete:()=>{u=!0,h(),a=S_(f,r),b.complete()}}),Se(m).subscribe(o))})(s)}}function S_(t,e,...n){if(e===!0){t();return}if(e===!1)return;let r=new Br({next:()=>{r.unsubscribe(),t()}});return Se(e(...n)).subscribe(r)}function Ch(t,e,n){let r,i=!1;return t&&typeof t=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t:r=t??1/0,Qc({connector:()=>new ih(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function A_(t){return X((e,n)=>{let r=!1,i=0;e.subscribe(Q(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}function _s(...t){let e=cr(t);return X((n,r)=>{(e?jo(t,n,e):jo(t,n)).subscribe(r)})}function Le(t,e){return X((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(Q(r,c=>{i?.unsubscribe();let l=0,u=s++;Se(t(c,u)).subscribe(i=Q(r,d=>r.next(e?e(c,d,u,l++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Ih(t,e){return K(e)?Le(()=>t,e):Le(()=>t)}function M_(t){return X((e,n)=>{Se(t).subscribe(Q(n,()=>n.complete(),hs)),!n.closed&&e.subscribe(n)})}function dt(t,e,n){let r=K(t)||e||n?{next:t,error:e,complete:n}:t;return r?X((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(Q(s,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),s.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):Dt}function N_(...t){let e=Vo(t);return X((n,r)=>{let i=t.length,s=new Array(i),o=t.map(()=>!1),a=!1;for(let c=0;c<i;c++)Se(t[c]).subscribe(Q(r,l=>{s[c]=l,!a&&!o[c]&&(o[c]=!0,(a=o.every(Dt))&&(o=null))},hs));n.subscribe(Q(r,c=>{if(a){let l=[c,...s];r.next(e?e(...l):l)}}))})}var eT="https://g.co/ng/security#xss",H=class extends Error{constructor(e,n){super(P0(e,n)),this.code=e}};function P0(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}function cl(t){return{toString:t}.toString()}var bh="__parameters__";function mV(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function tT(t,e,n){return cl(()=>{let r=mV(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,l,u){let d=c.hasOwnProperty(bh)?c[bh]:Object.defineProperty(c,bh,{value:[]})[bh];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),c}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}var Gt=globalThis;function Ae(t){for(let e in t)if(t[e]===Ae)return e;throw Error("Could not find renamed property on target object.")}function _V(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function zt(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(zt).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function gD(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var yV=Ae({__forward_ref__:Ae});function Gr(t){return t.__forward_ref__=Gr,t.toString=function(){return zt(this())},t}function qt(t){return nT(t)?t():t}function nT(t){return typeof t=="function"&&t.hasOwnProperty(yV)&&t.__forward_ref__===Gr}function V(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function tt(t){return{providers:t.providers||[],imports:t.imports||[]}}function sf(t){return mD(t,iT)||mD(t,sT)}function rT(t){return sf(t)!==null}function mD(t,e){return t.hasOwnProperty(e)?t[e]:null}function vV(t){let e=t&&(t[iT]||t[sT]);return e||null}function _D(t){return t&&(t.hasOwnProperty(yD)||t.hasOwnProperty(xV))?t[yD]:null}var iT=Ae({\u0275prov:Ae}),yD=Ae({\u0275inj:Ae}),sT=Ae({ngInjectableDef:Ae}),xV=Ae({ngInjectorDef:Ae}),O=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=V({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function oT(t){return t&&!!t.\u0275providers}var wV=Ae({\u0275cmp:Ae}),EV=Ae({\u0275dir:Ae}),CV=Ae({\u0275pipe:Ae}),IV=Ae({\u0275mod:Ae}),Oh=Ae({\u0275fac:Ae}),Yc=Ae({__NG_ELEMENT_ID__:Ae}),vD=Ae({__NG_ENV_ID__:Ae});function of(t){return typeof t=="string"?t:t==null?"":String(t)}function bV(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():of(t)}function DV(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new H(-200,t)}function k0(t,e){throw new H(-201,!1)}var le=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(le||{}),z_;function aT(){return z_}function An(t){let e=z_;return z_=t,e}function cT(t,e,n){let r=sf(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&le.Optional)return null;if(e!==void 0)return e;k0(t,"Injector")}var TV={},Xc=TV,W_="__NG_DI_FLAG__",Fh="ngTempTokenPath",SV="ngTokenPath",AV=/\n/gm,MV="\u0275",xD="__source",zo;function NV(){return zo}function _i(t){let e=zo;return zo=t,e}function RV(t,e=le.Default){if(zo===void 0)throw new H(-203,!1);return zo===null?cT(t,void 0,e):zo.get(t,e&le.Optional?null:void 0,e)}function E(t,e=le.Default){return(aT()||RV)(qt(t),e)}function P(t,e=le.Default){return E(t,af(e))}function af(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function K_(t){let e=[];for(let n=0;n<t.length;n++){let r=qt(t[n]);if(Array.isArray(r)){if(r.length===0)throw new H(900,!1);let i,s=le.Default;for(let o=0;o<r.length;o++){let a=r[o],c=PV(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(E(i,s))}else e.push(E(r))}return e}function lT(t,e){return t[W_]=e,t.prototype[W_]=e,t}function PV(t){return t[W_]}function kV(t,e,n,r){let i=t[Fh];throw e[xD]&&i.unshift(e[xD]),t.message=OV(`
`+t.message,i,n,r),t[SV]=i,t[Fh]=null,t}function OV(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==MV?t.slice(2):t;let i=zt(e);if(Array.isArray(e))i=e.map(zt).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):zt(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(AV,`
  `)}`}var ra=lT(tT("Optional"),8);var O0=lT(tT("SkipSelf"),4);function Ko(t,e){let n=t.hasOwnProperty(Oh);return n?t[Oh]:null}function F0(t,e){t.forEach(n=>Array.isArray(n)?F0(n,e):e(n))}function uT(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Vh(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function FV(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let s=i-2;t[i]=t[s],i--}t[e]=n,t[e+1]=r}}function VV(t,e,n){let r=ll(t,e);return r>=0?t[r|1]=n:(r=~r,FV(t,r,e,n)),r}function R_(t,e){let n=ll(t,e);if(n>=0)return t[n|1]}function ll(t,e){return LV(t,e,1)}function LV(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}var Qo={},Mn=[],Yo=new O(""),dT=new O("",-1),hT=new O(""),Lh=class{get(e,n=Xc){if(n===Xc){let r=new Error(`NullInjectorError: No provider for ${zt(e)}!`);throw r.name="NullInjectorError",r}return n}},fT=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(fT||{}),hr=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(hr||{}),Pt=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(Pt||{});function jV(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function Q_(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];BV(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function pT(t){return t===3||t===4||t===6}function BV(t){return t.charCodeAt(0)===64}function Jc(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?wD(t,n,i,null,e[++r]):wD(t,n,i,null,null))}}return t}function wD(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var gT="ng-template";function UV(t,e,n,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&jV(e[i+1].toLowerCase(),n,0)!==-1)return!0}else if(V0(t))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===n)return!0}return!1}function V0(t){return t.type===4&&t.value!==gT}function $V(t,e,n){let r=t.type===4&&!n?gT:t.value;return e===r}function HV(t,e,n){let r=4,i=t.attrs,s=i!==null?zV(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!Gn(r)&&!Gn(c))return!1;if(o&&Gn(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!$V(t,c,n)||c===""&&e.length===1){if(Gn(r))return!1;o=!0}}else if(r&8){if(i===null||!UV(t,i,c,n)){if(Gn(r))return!1;o=!0}}else{let l=e[++a],u=qV(c,i,V0(t),n);if(u===-1){if(Gn(r))return!1;o=!0;continue}if(l!==""){let d;if(u>s?d="":d=i[u+1].toLowerCase(),r&2&&l!==d){if(Gn(r))return!1;o=!0}}}}return Gn(r)||o}function Gn(t){return(t&1)===0}function qV(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return WV(e,t)}function GV(t,e,n=!1){for(let r=0;r<e.length;r++)if(HV(t,e[r],n))return!0;return!1}function zV(t){for(let e=0;e<t.length;e++){let n=t[e];if(pT(n))return e}return t.length}function WV(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function ED(t,e){return t?":not("+e.trim()+")":e}function KV(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Gn(o)&&(e+=ED(s,i),i=""),r=o,s=s||!Gn(r);n++}return i!==""&&(e+=ED(s,i)),e}function QV(t){return t.map(KV).join(",")}function YV(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!Gn(i))break;i=s}r++}return{attrs:e,classes:n}}function sn(t){return cl(()=>{let e=xT(t),n=se(A({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===fT.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||hr.Emulated,styles:t.styles||Mn,_:null,schemas:t.schemas||null,tView:null,id:""});wT(n);let r=t.dependencies;return n.directiveDefs=ID(r,!1),n.pipeDefs=ID(r,!0),n.id=JV(n),n})}function ZV(t){return vi(t)||mT(t)}function XV(t){return t!==null}function nt(t){return cl(()=>({type:t.type,bootstrap:t.bootstrap||Mn,declarations:t.declarations||Mn,imports:t.imports||Mn,exports:t.exports||Mn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function CD(t,e){if(t==null)return Qo;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s,o,a=Pt.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(n[s]=a!==Pt.None?[r,a]:r,e[s]=o):n[s]=r}return n}function rt(t){return cl(()=>{let e=xT(t);return wT(e),e})}function vi(t){return t[wV]||null}function mT(t){return t[EV]||null}function _T(t){return t[CV]||null}function yT(t){let e=vi(t)||mT(t)||_T(t);return e!==null?e.standalone:!1}function vT(t,e){let n=t[IV]||null;if(!n&&e===!0)throw new Error(`Type ${zt(t)} does not have '\u0275mod' property.`);return n}function xT(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||Qo,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||Mn,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:CD(t.inputs,e),outputs:CD(t.outputs),debugInfo:null}}function wT(t){t.features?.forEach(e=>e(t))}function ID(t,e){if(!t)return null;let n=e?_T:ZV;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(XV)}function JV(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function eL(...t){return{\u0275providers:ET(!0,t),\u0275fromNgModule:!0}}function ET(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return F0(e,o=>{let a=o;Y_(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&CT(i,s),n}function CT(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];L0(i,s=>{e(s,r)})}}function Y_(t,e,n,r){if(t=qt(t),!t)return!1;let i=null,s=_D(t),o=!s&&vi(t);if(!s&&!o){let c=t.ngModule;if(s=_D(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)Y_(l,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{F0(s.imports,u=>{Y_(u,e,n,r)&&(l||=[],l.push(u))})}finally{}l!==void 0&&CT(l,e)}if(!a){let l=Ko(i)||(()=>new i);e({provide:i,useFactory:l,deps:Mn},i),e({provide:hT,useValue:i,multi:!0},i),e({provide:Yo,useValue:()=>E(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let l=t;L0(c,u=>{e(u,l)})}}else return!1;return i!==t&&t.providers!==void 0}function L0(t,e){for(let n of t)oT(n)&&(n=n.\u0275providers),Array.isArray(n)?L0(n,e):e(n)}var tL=Ae({provide:String,useValue:Ae});function IT(t){return t!==null&&typeof t=="object"&&tL in t}function nL(t){return!!(t&&t.useExisting)}function rL(t){return!!(t&&t.useFactory)}function Zo(t){return typeof t=="function"}function iL(t){return!!t.useClass}var cf=new O(""),Mh={},sL={},P_;function j0(){return P_===void 0&&(P_=new Lh),P_}var pn=class{},el=class extends pn{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,X_(e,o=>this.processProvider(o)),this.records.set(dT,$o(void 0,this)),i.has("environment")&&this.records.set(pn,$o(void 0,this));let s=this.records.get(cf);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(hT,Mn,le.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=Ce(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ce(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=_i(this),r=An(void 0),i;try{return e()}finally{_i(n),An(r)}}get(e,n=Xc,r=le.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(vD))return e[vD](this);r=af(r);let i,s=_i(this),o=An(void 0);try{if(!(r&le.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=uL(e)&&sf(e);l&&this.injectableDefInScope(l)?c=$o(Z_(e),Mh):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&le.Self?j0():this.parent;return n=r&le.Optional&&n===Xc?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[Fh]=a[Fh]||[]).unshift(zt(e)),s)throw a;return kV(a,e,"R3InjectorError",this.source)}else throw a}finally{An(o),_i(s)}}resolveInjectorInitializers(){let e=Ce(null),n=_i(this),r=An(void 0),i;try{let s=this.get(Yo,Mn,le.Self);for(let o of s)o()}finally{_i(n),An(r),Ce(e)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(zt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new H(205,!1)}processProvider(e){e=qt(e);let n=Zo(e)?e:qt(e&&e.provide),r=aL(e);if(!Zo(e)&&e.multi===!0){let i=this.records.get(n);i||(i=$o(void 0,Mh,!0),i.factory=()=>K_(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){let r=Ce(null);try{return n.value===Mh&&(n.value=sL,n.value=n.factory()),typeof n.value=="object"&&n.value&&lL(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{Ce(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let n=qt(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function Z_(t){let e=sf(t),n=e!==null?e.factory:Ko(t);if(n!==null)return n;if(t instanceof O)throw new H(204,!1);if(t instanceof Function)return oL(t);throw new H(204,!1)}function oL(t){if(t.length>0)throw new H(204,!1);let n=vV(t);return n!==null?()=>n.factory(t):()=>new t}function aL(t){if(IT(t))return $o(void 0,t.useValue);{let e=bT(t);return $o(e,Mh)}}function bT(t,e,n){let r;if(Zo(t)){let i=qt(t);return Ko(i)||Z_(i)}else if(IT(t))r=()=>qt(t.useValue);else if(rL(t))r=()=>t.useFactory(...K_(t.deps||[]));else if(nL(t))r=()=>E(qt(t.useExisting));else{let i=qt(t&&(t.useClass||t.provide));if(cL(t))r=()=>new i(...K_(t.deps));else return Ko(i)||Z_(i)}return r}function $o(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function cL(t){return!!t.deps}function lL(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function uL(t){return typeof t=="function"||typeof t=="object"&&t instanceof O}function X_(t,e){for(let n of t)Array.isArray(n)?X_(n,e):n&&oT(n)?X_(n.\u0275providers,e):e(n)}function zr(t,e){t instanceof el&&t.assertNotDestroyed();let n,r=_i(t),i=An(void 0);try{return e()}finally{_i(r),An(i)}}function DT(){return aT()!==void 0||NV()!=null}function dL(t){if(!DT())throw new H(-203,!1)}function hL(t){let e=Gt.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function fL(t){return typeof t=="function"}var Wr=0,ge=1,z=2,kt=3,zn=4,Qn=5,jh=6,tl=7,Wn=8,Xo=9,Kn=10,et=11,nl=12,bD=13,ia=14,fr=15,lf=16,Ho=17,Jo=18,uf=19,TT=20,yi=21,k_=22,xs=23,xi=25,ST=1;var ws=7,Bh=8,Uh=9,Nn=10,B0=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(B0||{});function ys(t){return Array.isArray(t)&&typeof t[ST]=="object"}function Kr(t){return Array.isArray(t)&&t[ST]===!0}function AT(t){return(t.flags&4)!==0}function df(t){return t.componentOffset>-1}function U0(t){return(t.flags&1)===1}function wi(t){return!!t.template}function pL(t){return(t[z]&512)!==0}var J_=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function MT(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}function Ci(){return NT}function NT(t){return t.type.prototype.ngOnChanges&&(t.setInput=mL),gL}Ci.ngInherit=!0;function gL(){let t=PT(this),e=t?.current;if(e){let n=t.previous;if(n===Qo)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function mL(t,e,n,r,i){let s=this.declaredInputs[r],o=PT(t)||_L(t,{previous:Qo,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new J_(l&&l.currentValue,n,c===Qo),MT(t,e,i,n)}var RT="__ngSimpleChanges__";function PT(t){return t[RT]||null}function _L(t,e){return t[RT]=e}var DD=null;var ur=function(t,e,n){DD?.(t,e,n)},yL="svg",vL="math",xL=!1;function wL(){return xL}function pr(t){for(;Array.isArray(t);)t=t[Wr];return t}function kT(t,e){return pr(e[t])}function Rn(t,e){return pr(e[t.index])}function OT(t,e){return t.data[e]}function Ii(t,e){let n=e[t];return ys(n)?n:n[Wr]}function $0(t){return(t[z]&128)===128}function EL(t){return Kr(t[kt])}function $h(t,e){return e==null?null:t[e]}function FT(t){t[Ho]=0}function CL(t){t[z]&1024||(t[z]|=1024,$0(t)&&rl(t))}function IL(t,e){for(;t>0;)e=e[ia],t--;return e}function H0(t){return!!(t[z]&9216||t[xs]?.dirty)}function e0(t){t[Kn].changeDetectionScheduler?.notify(1),H0(t)?rl(t):t[z]&64&&(wL()?(t[z]|=1024,rl(t)):t[Kn].changeDetectionScheduler?.notify())}function rl(t){t[Kn].changeDetectionScheduler?.notify();let e=il(t);for(;e!==null&&!(e[z]&8192||(e[z]|=8192,!$0(e)));)e=il(e)}function VT(t,e){if((t[z]&256)===256)throw new H(911,!1);t[yi]===null&&(t[yi]=[]),t[yi].push(e)}function bL(t,e){if(t[yi]===null)return;let n=t[yi].indexOf(e);n!==-1&&t[yi].splice(n,1)}function il(t){let e=t[kt];return Kr(e)?e[kt]:e}var he={lFrame:qT(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function DL(){return he.lFrame.elementDepthCount}function TL(){he.lFrame.elementDepthCount++}function SL(){he.lFrame.elementDepthCount--}function LT(){return he.bindingsEnabled}function AL(){return he.skipHydrationRootTNode!==null}function ML(t){return he.skipHydrationRootTNode===t}function NL(){he.skipHydrationRootTNode=null}function Me(){return he.lFrame.lView}function on(){return he.lFrame.tView}function gt(t){return he.lFrame.contextLView=t,t[Wn]}function mt(t){return he.lFrame.contextLView=null,t}function an(){let t=jT();for(;t!==null&&t.type===64;)t=t.parent;return t}function jT(){return he.lFrame.currentTNode}function RL(){let t=he.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function ul(t,e){let n=he.lFrame;n.currentTNode=t,n.isParent=e}function BT(){return he.lFrame.isParent}function PL(){he.lFrame.isParent=!1}function kL(){let t=he.lFrame,e=t.bindingRootIndex;return e===-1&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function OL(t){return he.lFrame.bindingIndex=t}function hf(){return he.lFrame.bindingIndex++}function FL(t){let e=he.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function VL(){return he.lFrame.inI18n}function LL(t,e){let n=he.lFrame;n.bindingIndex=n.bindingRootIndex=t,t0(e)}function jL(){return he.lFrame.currentDirectiveIndex}function t0(t){he.lFrame.currentDirectiveIndex=t}function BL(t){let e=he.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function UT(t){he.lFrame.currentQueryIndex=t}function UL(t){let e=t[ge];return e.type===2?e.declTNode:e.type===1?t[Qn]:null}function $T(t,e,n){if(n&le.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&le.Host);)if(i=UL(s),i===null||(s=s[ia],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=he.lFrame=HT();return r.currentTNode=e,r.lView=t,!0}function q0(t){let e=HT(),n=t[ge];he.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function HT(){let t=he.lFrame,e=t===null?null:t.child;return e===null?qT(t):e}function qT(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function GT(){let t=he.lFrame;return he.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var zT=GT;function G0(){let t=GT();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function $L(t){return(he.lFrame.contextLView=IL(t,he.lFrame.contextLView))[Wn]}function sa(){return he.lFrame.selectedIndex}function Es(t){he.lFrame.selectedIndex=t}function ff(){let t=he.lFrame;return OT(t.tView,t.selectedIndex)}function HL(){return he.lFrame.currentNamespace}var WT=!0;function z0(){return WT}function W0(t){WT=t}function qL(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=NT(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function K0(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),c&&(t.viewHooks??=[]).push(-n,c),l&&((t.viewHooks??=[]).push(n,l),(t.viewCheckHooks??=[]).push(n,l)),u!=null&&(t.destroyHooks??=[]).push(n,u)}}function Nh(t,e,n){KT(t,e,3,n)}function Rh(t,e,n,r){(t[z]&3)===n&&KT(t,e,n,r)}function O_(t,e){let n=t[z];(n&3)===e&&(n&=16383,n+=1,t[z]=n)}function KT(t,e,n,r){let i=r!==void 0?t[Ho]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(t[Ho]+=65536),(a<s||s==-1)&&(GL(t,n,e,c),t[Ho]=(t[Ho]&4294901760)+c+2),c++}function TD(t,e){ur(4,t,e);let n=Ce(null);try{e.call(t)}finally{Ce(n),ur(5,t,e)}}function GL(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[z]>>14<t[Ho]>>16&&(t[z]&3)===e&&(t[z]+=16384,TD(a,s)):TD(a,s)}var Wo=-1,Cs=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function zL(t){return t instanceof Cs}function WL(t){return(t.flags&8)!==0}function KL(t){return(t.flags&16)!==0}function QT(t){return t!==Wo}function Hh(t){return t&32767}function QL(t){return t>>16}function qh(t,e){let n=QL(t),r=e;for(;n>0;)r=r[ia],n--;return r}var n0=!0;function SD(t){let e=n0;return n0=t,e}var YL=256,YT=YL-1,ZT=5,ZL=0,dr={};function XL(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(Yc)&&(r=n[Yc]),r==null&&(r=n[Yc]=ZL++);let i=r&YT,s=1<<i;e.data[t+(i>>ZT)]|=s}function Gh(t,e){let n=XT(t,e);if(n!==-1)return n;let r=e[ge];r.firstCreatePass&&(t.injectorIndex=e.length,F_(r.data,t),F_(e,null),F_(r.blueprint,null));let i=Q0(t,e),s=t.injectorIndex;if(QT(i)){let o=Hh(i),a=qh(i,e),c=a[ge].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function F_(t,e){t.push(0,0,0,0,0,0,0,0,e)}function XT(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function Q0(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=rS(i),r===null)return Wo;if(n++,i=i[ia],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return Wo}function r0(t,e,n){XL(t,e,n)}function JL(t,e){if(e==="class")return t.classes;if(e==="style")return t.styles;let n=t.attrs;if(n){let r=n.length,i=0;for(;i<r;){let s=n[i];if(pT(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof n[i]=="string";)i++;else{if(s===e)return n[i+1];i=i+2}}}return null}function JT(t,e,n){if(n&le.Optional||t!==void 0)return t;k0(e,"NodeInjector")}function eS(t,e,n,r){if(n&le.Optional&&r===void 0&&(r=null),!(n&(le.Self|le.Host))){let i=t[Xo],s=An(void 0);try{return i?i.get(e,r,n&le.Optional):cT(e,r,n&le.Optional)}finally{An(s)}}return JT(r,e,n)}function tS(t,e,n,r=le.Default,i){if(t!==null){if(e[z]&2048&&!(r&le.Self)){let o=i4(t,e,n,r,dr);if(o!==dr)return o}let s=nS(t,e,n,r,dr);if(s!==dr)return s}return eS(e,n,r,i)}function nS(t,e,n,r,i){let s=n4(n);if(typeof s=="function"){if(!$T(e,t,r))return r&le.Host?JT(i,n,r):eS(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&le.Optional))k0(n);else return o}finally{zT()}}else if(typeof s=="number"){let o=null,a=XT(t,e),c=Wo,l=r&le.Host?e[fr][Qn]:null;for((a===-1||r&le.SkipSelf)&&(c=a===-1?Q0(t,e):e[a+8],c===Wo||!MD(r,!1)?a=-1:(o=e[ge],a=Hh(c),e=qh(c,e)));a!==-1;){let u=e[ge];if(AD(s,a,u.data)){let d=e4(a,e,n,o,r,l);if(d!==dr)return d}c=e[a+8],c!==Wo&&MD(r,e[ge].data[a+8]===l)&&AD(s,a,e)?(o=u,a=Hh(c),e=qh(c,e)):a=-1}}return i}function e4(t,e,n,r,i,s){let o=e[ge],a=o.data[t+8],c=r==null?df(a)&&n0:r!=o&&(a.type&3)!==0,l=i&le.Host&&s===a,u=t4(a,o,n,c,l);return u!==null?ea(e,o,u,a):dr}function t4(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,c=t.directiveStart,l=t.directiveEnd,u=s>>20,d=r?a:a+u,h=i?a+u:l;for(let f=d;f<h;f++){let p=o[f];if(f<c&&n===p||f>=c&&p.type===n)return f}if(i){let f=o[c];if(f&&wi(f)&&f.type===n)return c}return null}function ea(t,e,n,r){let i=t[n],s=e.data;if(zL(i)){let o=i;o.resolving&&DV(bV(s[n]));let a=SD(o.canSeeViewProviders);o.resolving=!0;let c,l=o.injectImpl?An(o.injectImpl):null,u=$T(t,r,le.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&qL(n,s[n],e)}finally{l!==null&&An(l),SD(a),o.resolving=!1,zT()}}return i}function n4(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(Yc)?t[Yc]:void 0;return typeof e=="number"?e>=0?e&YT:r4:e}function AD(t,e,n){let r=1<<t;return!!(n[e+(t>>ZT)]&r)}function MD(t,e){return!(t&le.Self)&&!(t&le.Host&&e)}var vs=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return tS(this._tNode,this._lView,e,af(r),n)}};function r4(){return new vs(an(),Me())}function Qr(t){return cl(()=>{let e=t.prototype.constructor,n=e[Oh]||i0(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[Oh]||i0(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function i0(t){return nT(t)?()=>{let e=i0(qt(t));return e&&e()}:Ko(t)}function i4(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[z]&2048&&!(o[z]&512);){let a=nS(s,o,n,r|le.Self,dr);if(a!==dr)return a;let c=s.parent;if(!c){let l=o[TT];if(l){let u=l.get(n,dr,r);if(u!==dr)return u}c=rS(o),o=o[ia]}s=c}return i}function rS(t){let e=t[ge],n=e.type;return n===2?e.declTNode:n===1?t[Qn]:null}function Y0(t){return JL(an(),t)}function ND(t,e=null,n=null,r){let i=iS(t,e,n,r);return i.resolveInjectorInitializers(),i}function iS(t,e=null,n=null,r,i=new Set){let s=[n||Mn,eL(t)];return r=r||(typeof t=="object"?void 0:zt(t)),new el(s,e||j0(),r||null,i)}var Yn=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return ND({name:""},i,r,"");{let s=r.name??"";return ND({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=Xc,e.NULL=new Lh,e.\u0275prov=V({token:e,providedIn:"any",factory:()=>E(dT)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})();var s4="ngOriginalError";function V_(t){return t[s4]}var gr=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&V_(e);for(;n&&V_(n);)n=V_(n);return n||null}},sS=new O("",{providedIn:"root",factory:()=>P(gr).handleError.bind(void 0)}),Z0=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=o4,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),s0=class extends Z0{constructor(e){super(),this._lView=e}onDestroy(e){return VT(this._lView,e),()=>bL(this._lView,e)}};function o4(){return new s0(Me())}function a4(){return pf(an(),Me())}function pf(t,e){return new Zn(Rn(t,e))}var Zn=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=a4;let t=e;return t})();var o0=class extends He{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,DT()&&(this.destroyRef=P(Z0,{optional:!0})??void 0)}emit(e){let n=Ce(null);try{super.next(e)}finally{Ce(n)}}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=L_(s),i&&(i=L_(i)),o&&(o=L_(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof We&&e.add(a),a}};function L_(t){return e=>{setTimeout(t,void 0,e)}}var ht=o0;function oS(t){return(t.flags&128)===128}var a0;function aS(t){a0=t}function c4(){if(a0!==void 0)return a0;if(typeof document<"u")return document;throw new H(210,!1)}var gf=new O("",{providedIn:"root",factory:()=>l4}),l4="ng",X0=new O(""),Ot=new O("",{providedIn:"platform",factory:()=>"unknown"});var J0=new O("",{providedIn:"root",factory:()=>c4().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var u4="h",d4="b";var h4=()=>null;function ey(t,e,n=!1){return h4(t,e,n)}var cS=!1,f4=new O("",{providedIn:"root",factory:()=>cS});var Dh;function p4(){if(Dh===void 0&&(Dh=null,Gt.trustedTypes))try{Dh=Gt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Dh}function RD(t){return p4()?.createScriptURL(t)||t}var zh=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${eT})`}};function dl(t){return t instanceof zh?t.changingThisBreaksApplicationSecurity:t}function ty(t,e){let n=g4(t);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${eT})`)}return n===e}function g4(t){return t instanceof zh&&t.getTypeName()||null}var m4=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function lS(t){return t=String(t),t.match(m4)?t:"unsafe:"+t}var mf=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(mf||{});function _4(t){let e=dS();return e?e.sanitize(mf.URL,t)||"":ty(t,"URL")?dl(t):lS(of(t))}function y4(t){let e=dS();if(e)return RD(e.sanitize(mf.RESOURCE_URL,t)||"");if(ty(t,"ResourceURL"))return RD(dl(t));throw new H(904,!1)}function v4(t,e){return e==="src"&&(t==="embed"||t==="frame"||t==="iframe"||t==="media"||t==="script")||e==="href"&&(t==="base"||t==="link")?y4:_4}function uS(t,e,n){return v4(e,n)(t)}function dS(){let t=Me();return t&&t[Kn].sanitizer}var hS=new Map,x4=0;function w4(){return x4++}function E4(t){hS.set(t[uf],t)}function C4(t){hS.delete(t[uf])}var PD="__ngContext__";function Is(t,e){ys(e)?(t[PD]=e[uf],E4(e)):t[PD]=e}function fS(t){return t instanceof Function?t():t}function I4(t){return(t??P(Yn)).get(Ot)==="browser"}var Hr=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Hr||{}),b4;function ny(t,e){return b4(t,e)}function qo(t,e,n,r,i){if(r!=null){let s,o=!1;Kr(r)?s=r:ys(r)&&(o=!0,r=r[Wr]);let a=pr(r);t===0&&n!==null?i==null?yS(e,n,a):Wh(e,n,a,i||null,!0):t===1&&n!==null?Wh(e,n,a,i||null,!0):t===2?$4(e,a,o):t===3&&e.destroyNode(a),s!=null&&q4(e,t,s,n,i)}}function D4(t,e){return t.createText(e)}function T4(t,e,n){t.setValue(e,n)}function pS(t,e,n){return t.createElement(e,n)}function S4(t,e){gS(t,e),e[Wr]=null,e[Qn]=null}function A4(t,e,n,r,i,s){r[Wr]=i,r[Qn]=e,_f(t,r,n,1,i,s)}function gS(t,e){e[Kn].changeDetectionScheduler?.notify(1),_f(t,e,e[et],2,null,null)}function M4(t){let e=t[nl];if(!e)return j_(t[ge],t);for(;e;){let n=null;if(ys(e))n=e[nl];else{let r=e[Nn];r&&(n=r)}if(!n){for(;e&&!e[zn]&&e!==t;)ys(e)&&j_(e[ge],e),e=e[kt];e===null&&(e=t),ys(e)&&j_(e[ge],e),n=e&&e[zn]}e=n}}function N4(t,e,n,r){let i=Nn+r,s=n.length;r>0&&(n[i-1][zn]=e),r<s-Nn?(e[zn]=n[i],uT(n,Nn+r,e)):(n.push(e),e[zn]=null),e[kt]=n;let o=e[lf];o!==null&&n!==o&&R4(o,e);let a=e[Jo];a!==null&&a.insertView(t),e0(e),e[z]|=128}function R4(t,e){let n=t[Uh],i=e[kt][kt][fr];e[fr]!==i&&(t[z]|=B0.HasTransplantedViews),n===null?t[Uh]=[e]:n.push(e)}function mS(t,e){let n=t[Uh],r=n.indexOf(e);n.splice(r,1)}function c0(t,e){if(t.length<=Nn)return;let n=Nn+e,r=t[n];if(r){let i=r[lf];i!==null&&i!==t&&mS(i,r),e>0&&(t[n-1][zn]=r[zn]);let s=Vh(t,Nn+e);S4(r[ge],r);let o=s[Jo];o!==null&&o.detachView(s[ge]),r[kt]=null,r[zn]=null,r[z]&=-129}return r}function _S(t,e){if(!(e[z]&256)){let n=e[et];n.destroyNode&&_f(t,e,n,3,null,null),M4(e)}}function j_(t,e){if(e[z]&256)return;let n=Ce(null);try{e[z]&=-129,e[z]|=256,e[xs]&&Wb(e[xs]),k4(t,e),P4(t,e),e[ge].type===1&&e[et].destroy();let r=e[lf];if(r!==null&&Kr(e[kt])){r!==e[kt]&&mS(r,e);let i=e[Jo];i!==null&&i.detachView(t)}C4(e)}finally{Ce(n)}}function P4(t,e){let n=t.cleanup,r=e[tl];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[tl]=null);let i=e[yi];if(i!==null){e[yi]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function k4(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof Cs)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];ur(4,a,c);try{c.call(a)}finally{ur(5,a,c)}}else{ur(4,i,s);try{s.call(i)}finally{ur(5,i,s)}}}}}function O4(t,e,n){return F4(t,e.parent,n)}function F4(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[Wr];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===hr.None||s===hr.Emulated)return null}return Rn(r,n)}}function Wh(t,e,n,r,i){t.insertBefore(e,n,r,i)}function yS(t,e,n){t.appendChild(e,n)}function kD(t,e,n,r,i){r!==null?Wh(t,e,n,r,i):yS(t,e,n)}function V4(t,e,n,r){t.removeChild(e,n,r)}function ry(t,e){return t.parentNode(e)}function L4(t,e){return t.nextSibling(e)}function j4(t,e,n){return U4(t,e,n)}function B4(t,e,n){return t.type&40?Rn(t,n):null}var U4=B4,OD;function iy(t,e,n,r){let i=O4(t,r,e),s=e[et],o=r.parent||e[Qn],a=j4(o,r,e);if(i!=null)if(Array.isArray(n))for(let c=0;c<n.length;c++)kD(s,i,n[c],a,!1);else kD(s,i,n,a,!1);OD!==void 0&&OD(s,r,e,n,i)}function Ph(t,e){if(e!==null){let n=e.type;if(n&3)return Rn(e,t);if(n&4)return l0(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return Ph(t,r);{let i=t[e.index];return Kr(i)?l0(-1,i):pr(i)}}else{if(n&32)return ny(e,t)()||pr(t[e.index]);{let r=vS(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=il(t[fr]);return Ph(i,r)}else return Ph(t,e.next)}}}return null}function vS(t,e){if(e!==null){let r=t[fr][Qn],i=e.projection;return r.projection[i]}return null}function l0(t,e){let n=Nn+t+1;if(n<e.length){let r=e[n],i=r[ge].firstChild;if(i!==null)return Ph(r,i)}return e[ws]}function $4(t,e,n){let r=ry(t,e);r&&V4(t,r,e,n)}function sy(t,e,n,r,i,s,o){for(;n!=null;){let a=r[n.index],c=n.type;if(o&&e===0&&(a&&Is(pr(a),r),n.flags|=2),(n.flags&32)!==32)if(c&8)sy(t,e,n.child,r,i,s,!1),qo(e,t,i,a,s);else if(c&32){let l=ny(n,r),u;for(;u=l();)qo(e,t,i,u,s);qo(e,t,i,a,s)}else c&16?H4(t,e,r,n,i,s):qo(e,t,i,a,s);n=o?n.projectionNext:n.next}}function _f(t,e,n,r,i,s){sy(n,r,t.firstChild,e,i,s,!1)}function H4(t,e,n,r,i,s){let o=n[fr],c=o[Qn].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let u=c[l];qo(e,t,i,u,s)}else{let l=c,u=o[kt];oS(r)&&(l.flags|=128),sy(t,e,l,u,i,s,!0)}}function q4(t,e,n,r,i){let s=n[ws],o=pr(n);s!==o&&qo(e,t,r,s,i);for(let a=Nn;a<n.length;a++){let c=n[a];_f(c[ge],c,t,e,r,s)}}function G4(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=r.indexOf("-")===-1?void 0:Hr.DashCase;i==null?t.removeStyle(n,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Hr.Important),t.setStyle(n,r,i,s))}}function z4(t,e,n){t.setAttribute(e,"style",n)}function xS(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function wS(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&Q_(t,e,r),i!==null&&xS(t,e,i),s!==null&&z4(t,e,s)}var bi={};function U(t=1){ES(on(),Me(),sa()+t,!1)}function ES(t,e,n,r){if(!r)if((e[z]&3)===3){let s=t.preOrderCheckHooks;s!==null&&Nh(e,s,n)}else{let s=t.preOrderHooks;s!==null&&Rh(e,s,0,n)}Es(n)}function te(t,e=le.Default){let n=Me();if(n===null)return E(t,e);let r=an();return tS(r,n,qt(t),e)}function CS(){let t="invalid";throw new Error(t)}function IS(t,e,n,r,i,s){let o=Ce(null);try{let a=null;i&Pt.SignalBased&&(a=e[r][l_]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&Pt.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,r):MT(e,a,r,s)}finally{Ce(o)}}function W4(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)Es(~i);else{let s=i,o=n[++r],a=n[++r];LL(o,s);let c=e[s];a(2,c)}}}finally{Es(-1)}}function yf(t,e,n,r,i,s,o,a,c,l,u){let d=e.blueprint.slice();return d[Wr]=i,d[z]=r|4|128|8|64,(l!==null||t&&t[z]&2048)&&(d[z]|=2048),FT(d),d[kt]=d[ia]=t,d[Wn]=n,d[Kn]=o||t&&t[Kn],d[et]=a||t&&t[et],d[Xo]=c||t&&t[Xo]||null,d[Qn]=s,d[uf]=w4(),d[jh]=u,d[TT]=l,d[fr]=e.type==2?t[fr]:d,d}function vf(t,e,n,r,i){let s=t.data[e];if(s===null)s=K4(t,e,n,r,i),VL()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=RL();s.injectorIndex=o===null?-1:o.injectorIndex}return ul(s,!0),s}function K4(t,e,n,r,i){let s=jT(),o=BT(),a=o?s:s&&s.parent,c=t.data[e]=J4(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function bS(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function DS(t,e,n,r,i){let s=sa(),o=r&2;try{Es(-1),o&&e.length>xi&&ES(t,e,xi,!1),ur(o?2:0,i),n(r,i)}finally{Es(s),ur(o?3:1,i)}}function TS(t,e,n){if(AT(e)){let r=Ce(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];if(a.contentQueries){let c=n[o];a.contentQueries(1,c,o)}}}finally{Ce(r)}}}function SS(t,e,n){LT()&&(s5(t,e,n,Rn(n,e)),(n.flags&64)===64&&PS(t,e,n))}function AS(t,e,n=Rn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function MS(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=oy(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function oy(t,e,n,r,i,s,o,a,c,l,u){let d=xi+r,h=d+i,f=Q4(d,h),p=typeof l=="function"?l():l;return f[ge]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:u}}function Q4(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:bi);return n}function Y4(t,e,n,r){let s=r.get(f4,cS)||n===hr.ShadowDom,o=t.selectRootElement(e,s);return Z4(o),o}function Z4(t){X4(t)}var X4=()=>null;function J4(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return AL()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function FD(t,e,n,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=Pt.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let l=s;if(i!==null){if(!i.hasOwnProperty(s))continue;l=i[s]}t===0?VD(r,n,l,a,c):VD(r,n,l,a)}return r}function VD(t,e,n,r,i){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,r):s=t[n]=[e,r],i!==void 0&&s.push(i)}function e5(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],c=null,l=null;for(let u=r;u<i;u++){let d=s[u],h=n?n.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;c=FD(0,d.inputs,u,c,f),l=FD(1,d.outputs,u,l,p);let m=c!==null&&o!==null&&!V0(e)?m5(c,u,o):null;a.push(m)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function t5(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function ay(t,e,n,r,i,s,o,a){let c=Rn(e,n),l=e.inputs,u;!a&&l!=null&&(u=l[r])?(cy(t,n,u,r,i),df(e)&&n5(n,e.index)):e.type&3?(r=t5(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(c,r,i)):e.type&12}function n5(t,e){let n=Ii(e,t);n[z]&16||(n[z]|=64)}function NS(t,e,n,r){if(LT()){let i=r===null?null:{"":-1},s=a5(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&RS(t,e,n,o,i,a),i&&c5(n,r,i)}n.mergedAttrs=Jc(n.mergedAttrs,n.attrs)}function RS(t,e,n,r,i,s){for(let l=0;l<r.length;l++)r0(Gh(n,e),t,r[l].type);u5(n,t.data.length,r.length);for(let l=0;l<r.length;l++){let u=r[l];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,c=bS(t,e,r.length,null);for(let l=0;l<r.length;l++){let u=r[l];n.mergedAttrs=Jc(n.mergedAttrs,u.hostAttrs),d5(t,n,e,c,u),l5(c,u,i),u.contentQueries!==null&&(n.flags|=4),(u.hostBindings!==null||u.hostAttrs!==null||u.hostVars!==0)&&(n.flags|=64);let d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),c++}e5(t,n,s)}function r5(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;i5(o)!=a&&o.push(a),o.push(n,r,s)}}function i5(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function s5(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;df(n)&&h5(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||Gh(n,e),Is(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let c=t.data[a],l=ea(e,t,a,n);if(Is(l,e),o!==null&&g5(e,a-i,l,c,n,o),wi(c)){let u=Ii(n.index,e);u[Wn]=ea(e,t,a,n)}}}function PS(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=jL();try{Es(s);for(let a=r;a<i;a++){let c=t.data[a],l=e[a];t0(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&o5(c,l)}}finally{Es(-1),t0(o)}}function o5(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function a5(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(GV(e,o.selectors,!1))if(r||(r=[]),wi(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;u0(t,e,c)}else r.unshift(o),u0(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function u0(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function c5(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new H(-301,!1);r.push(e[i],s)}}}function l5(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;wi(e)&&(n[""]=t)}}function u5(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function d5(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=Ko(i.type,!0)),o=new Cs(s,wi(i),te);t.blueprint[r]=o,n[r]=o,r5(t,e,r,bS(t,n,i.hostVars,bi),i)}function h5(t,e,n){let r=Rn(e,t),i=MS(n),s=t[Kn].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=xf(t,yf(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function f5(t,e,n,r,i,s){let o=Rn(t,e);p5(e[et],o,s,t.value,n,r,i)}function p5(t,e,n,r,i,s,o){if(s==null)t.removeAttribute(e,i,n);else{let a=o==null?of(s):o(s,r||"",i);t.setAttribute(e,i,a,n)}}function g5(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],l=o[a++],u=o[a++],d=o[a++];IS(r,n,c,l,u,d)}}function m5(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],n[i+1]);break}}i+=2}return r}function kS(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function OS(t,e){let n=t.contentQueries;if(n!==null){let r=Ce(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];UT(s),a.contentQueries(2,e[o],o)}}}finally{Ce(r)}}}function xf(t,e){return t[nl]?t[bD][zn]=e:t[nl]=e,t[bD]=e,e}function d0(t,e,n){UT(0);let r=Ce(null);try{e(t,n)}finally{Ce(r)}}function _5(t){return t[tl]||(t[tl]=[])}function y5(t){return t.cleanup||(t.cleanup=[])}function FS(t,e){let n=t[Xo],r=n?n.get(gr,null):null;r&&r.handleError(e)}function cy(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],c=n[s++],l=e[o],u=t.data[o];IS(u,l,r,a,c,i)}}function v5(t,e,n){let r=kT(e,t);T4(t[et],r,n)}function x5(t,e){let n=Ii(e,t),r=n[ge];w5(r,n);let i=n[Wr];i!==null&&n[jh]===null&&(n[jh]=ey(i,n[Xo])),ly(r,n,n[Wn])}function w5(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function ly(t,e,n){q0(e);try{let r=t.viewQuery;r!==null&&d0(1,r,n);let i=t.template;i!==null&&DS(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[Jo]?.finishViewCreation(t),t.staticContentQueries&&OS(t,e),t.staticViewQueries&&d0(2,t.viewQuery,n);let s=t.components;s!==null&&E5(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[z]&=-5,G0()}}function E5(t,e){for(let n=0;n<e.length;n++)x5(t,e[n])}function C5(t,e,n,r){let i=Ce(null);try{let s=e.tView,a=t[z]&4096?4096:16,c=yf(t,s,n,a,null,e,null,null,null,r?.injector??null,r?.dehydratedView??null),l=t[e.index];c[lf]=l;let u=t[Jo];return u!==null&&(c[Jo]=u.createEmbeddedView(s)),ly(s,c,n),c}finally{Ce(i)}}function LD(t,e){return!e||e.firstChild===null||oS(t)}function I5(t,e,n,r=!0){let i=e[ge];if(N4(i,e,t,n),r){let o=l0(n,t),a=e[et],c=ry(a,t[ws]);c!==null&&A4(i,t[Qn],a,e,c,o)}let s=e[jh];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function Kh(t,e,n,r,i=!1){for(;n!==null;){let s=e[n.index];s!==null&&r.push(pr(s)),Kr(s)&&b5(s,r);let o=n.type;if(o&8)Kh(t,e,n.child,r);else if(o&32){let a=ny(n,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=vS(e,n);if(Array.isArray(a))r.push(...a);else{let c=il(e[fr]);Kh(c[ge],c,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function b5(t,e){for(let n=Nn;n<t.length;n++){let r=t[n],i=r[ge].firstChild;i!==null&&Kh(r[ge],r,i,e)}t[ws]!==t[Wr]&&e.push(t[ws])}var VS=[];function D5(t){return t[xs]??T5(t)}function T5(t){let e=VS.pop()??Object.create(A5);return e.lView=t,e}function S5(t){t.lView[xs]!==t&&(t.lView=null,VS.push(t))}var A5=se(A({},qb),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{rl(t.lView)},consumerOnSignalRead(){this.lView[xs]=this}});function LS(t){return BS(t[nl])}function jS(t){return BS(t[zn])}function BS(t){for(;t!==null&&!Kr(t);)t=t[zn];return t}var US=100;function $S(t,e=!0,n=0){let r=t[Kn],i=r.rendererFactory,s=!1;s||i.begin?.();try{M5(t,n)}catch(o){throw e&&FS(t,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function M5(t,e){h0(t,e);let n=0;for(;H0(t);){if(n===US)throw new H(103,!1);n++,h0(t,1)}}function N5(t,e,n,r){let i=e[z];if((i&256)===256)return;let s=!1;!s&&e[Kn].inlineEffectRunner?.flush(),q0(e);let o=null,a=null;!s&&R5(t)&&(a=D5(e),o=Gb(a));try{FT(e),OL(t.bindingStartIndex),n!==null&&DS(t,e,n,2,r);let c=(i&3)===3;if(!s)if(c){let d=t.preOrderCheckHooks;d!==null&&Nh(e,d,null)}else{let d=t.preOrderHooks;d!==null&&Rh(e,d,0,null),O_(e,0)}if(P5(e),HS(e,0),t.contentQueries!==null&&OS(t,e),!s)if(c){let d=t.contentCheckHooks;d!==null&&Nh(e,d)}else{let d=t.contentHooks;d!==null&&Rh(e,d,1),O_(e,1)}W4(t,e);let l=t.components;l!==null&&GS(e,l,0);let u=t.viewQuery;if(u!==null&&d0(2,u,r),!s)if(c){let d=t.viewCheckHooks;d!==null&&Nh(e,d)}else{let d=t.viewHooks;d!==null&&Rh(e,d,2),O_(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[k_]){for(let d of e[k_])d();e[k_]=null}s||(e[z]&=-73)}catch(c){throw rl(e),c}finally{a!==null&&(zb(a,o),S5(a)),G0()}}function R5(t){return t.type!==2}function HS(t,e){for(let n=LS(t);n!==null;n=jS(n))for(let r=Nn;r<n.length;r++){let i=n[r];qS(i,e)}}function P5(t){for(let e=LS(t);e!==null;e=jS(e)){if(!(e[z]&B0.HasTransplantedViews))continue;let n=e[Uh];for(let r=0;r<n.length;r++){let i=n[r],s=i[kt];CL(i)}}}function k5(t,e,n){let r=Ii(e,t);qS(r,n)}function qS(t,e){$0(t)&&h0(t,e)}function h0(t,e){let r=t[ge],i=t[z],s=t[xs],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&u_(s)),s&&(s.dirty=!1),t[z]&=-9217,o)N5(r,t,r.template,t[Wn]);else if(i&8192){HS(t,1);let a=r.components;a!==null&&GS(t,a,1)}}function GS(t,e,n){for(let r=0;r<e.length;r++)k5(t,e[r],n)}function uy(t){for(t[Kn].changeDetectionScheduler?.notify();t;){t[z]|=64;let e=il(t);if(pL(t)&&!e)return t;t=e}return null}var bs=class{get rootNodes(){let e=this._lView,n=e[ge];return Kh(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Wn]}set context(e){this._lView[Wn]=e}get destroyed(){return(this._lView[z]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[kt];if(Kr(e)){let n=e[Bh],r=n?n.indexOf(this):-1;r>-1&&(c0(e,r),Vh(n,r))}this._attachedToViewContainer=!1}_S(this._lView[ge],this._lView)}onDestroy(e){VT(this._lView,e)}markForCheck(){uy(this._cdRefInjectingView||this._lView)}detach(){this._lView[z]&=-129}reattach(){e0(this._lView),this._lView[z]|=128}detectChanges(){this._lView[z]|=1024,$S(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new H(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,gS(this._lView[ge],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new H(902,!1);this._appRef=e,e0(this._lView)}},wf=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=V5;let t=e;return t})(),O5=wf,F5=class extends O5{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=C5(this._declarationLView,this._declarationTContainer,e,{injector:n,dehydratedView:r});return new bs(i)}};function V5(){return L5(an(),Me())}function L5(t,e){return t.type&4?new F5(e,t,pf(t,e)):null}var IJ=new RegExp(`^(\\d+)*(${d4}|${u4})*(.*)`);var j5=()=>null;function jD(t,e){return j5(t,e)}var Qh=class{},f0=class{},Yh=class{};function B5(t){let e=Error(`No component factory found for ${zt(t)}.`);return e[U5]=t,e}var U5="ngComponent";var p0=class{resolveComponentFactory(e){throw B5(e)}},Ef=(()=>{let e=class e{};e.NULL=new p0;let t=e;return t})(),sl=class{},mr=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>$5();let t=e;return t})();function $5(){let t=Me(),e=an(),n=Ii(e.index,t);return(ys(n)?n:t)[et]}var H5=(()=>{let e=class e{};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),B_={};var BD=new Set;function dy(t){BD.has(t)||(BD.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function UD(...t){}function q5(){let t=typeof Gt.requestAnimationFrame=="function",e=Gt[t?"requestAnimationFrame":"setTimeout"],n=Gt[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var fe=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ht(!1),this.onMicrotaskEmpty=new ht(!1),this.onStable=new ht(!1),this.onError=new ht(!1),typeof Zone>"u")throw new H(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=q5().nativeRequestAnimationFrame,W5(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new H(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new H(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,G5,UD,UD);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},G5={};function hy(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function z5(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Gt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,g0(t),t.isCheckStableRunning=!0,hy(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),g0(t))}function W5(t){let e=()=>{z5(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(K5(a))return n.invokeTask(i,s,o,a);try{return $D(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),HD(t)}},onInvoke:(n,r,i,s,o,a,c)=>{try{return $D(t),n.invoke(i,s,o,a,c)}finally{t.shouldCoalesceRunChangeDetection&&e(),HD(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,g0(t),hy(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function g0(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function $D(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function HD(t){t._nesting--,hy(t)}var m0=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ht,this.onMicrotaskEmpty=new ht,this.onStable=new ht,this.onError=new ht}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}};function K5(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}function Q5(t="zone.js",e){return t==="noop"?new m0:t==="zone.js"?new fe(e):t}var Go=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(Go||{}),Y5={destroy(){}};function fy(t,e){!e&&dL(fy);let n=e?.injector??P(Yn);if(!I4(n))return Y5;dy("NgAfterNextRender");let r=n.get(py),i=r.handler??=new y0,s=e?.phase??Go.MixedReadWrite,o=()=>{i.unregister(c),a()},a=n.get(Z0).onDestroy(o),c=zr(n,()=>new _0(s,()=>{o(),t()}));return i.register(c),{destroy:o}}var _0=class{constructor(e,n){this.phase=e,this.callbackFn=n,this.zone=P(fe),this.errorHandler=P(gr,{optional:!0}),P(Qh,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},y0=class{constructor(){this.executingCallbacks=!1,this.buckets={[Go.EarlyRead]:new Set,[Go.Write]:new Set,[Go.MixedReadWrite]:new Set,[Go.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let n of e)n.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},py=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function v0(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=gD(i,a);else if(s==2){let c=a,l=e[++o];r=gD(r,c+": "+l+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var Zh=class extends Ef{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=vi(e);return new ta(n,this.ngModule)}};function qD(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let r=t[n];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:n})}return e}function Z5(t){let e=t.toLowerCase();return e==="svg"?yL:e==="math"?vL:null}var x0=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=af(r);let i=this.injector.get(e,B_,r);return i!==B_||n===B_?i:this.parentInjector.get(e,n,r)}},ta=class extends Yh{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=qD(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return qD(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=QV(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){let s=Ce(null);try{i=i||this.ngModule;let o=i instanceof pn?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new x0(e,o):e,c=a.get(sl,null);if(c===null)throw new H(407,!1);let l=a.get(H5,null),u=a.get(py,null),d=a.get(Qh,null),h={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:u,changeDetectionScheduler:d},f=c.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",m=r?Y4(f,r,this.componentDef.encapsulation,a):pS(f,p,Z5(p)),v=512;this.componentDef.signals?v|=4096:this.componentDef.onPush||(v|=16);let b=null;m!==null&&(b=ey(m,a,!0));let F=oy(0,null,null,1,0,null,null,null,null,null,null),T=yf(null,F,null,v,null,null,h,f,a,null,b);q0(T);let q,W;try{let Z=this.componentDef,Te,tn=null;Z.findHostDirectiveDefs?(Te=[],tn=new Map,Z.findHostDirectiveDefs(Z,Te,tn),Te.push(Z)):Te=[Z];let t_=X5(T,m),Hd=J5(t_,m,Z,Te,T,h,f);W=OT(F,xi),m&&n3(f,Z,m,r),n!==void 0&&r3(W,this.ngContentSelectors,n),q=t3(Hd,Z,Te,tn,T,[i3]),ly(F,T,null)}finally{G0()}return new w0(this.componentType,q,pf(W,T),T,W)}finally{Ce(s)}}},w0=class extends f0{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new bs(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;cy(s[ge],s,i,e,n),this.previousInputValues.set(e,n);let o=Ii(this._tNode.index,s);uy(o)}}get injector(){return new vs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function X5(t,e){let n=t[ge],r=xi;return t[r]=e,vf(n,r,2,"#host",null)}function J5(t,e,n,r,i,s,o){let a=i[ge];e3(r,t,e,o);let c=null;e!==null&&(c=ey(e,i[Xo]));let l=s.rendererFactory.createRenderer(e,n),u=16;n.signals?u=4096:n.onPush&&(u=64);let d=yf(i,MS(n),null,u,i[t.index],t,s,l,null,null,c);return a.firstCreatePass&&u0(a,t,r.length-1),xf(i,d),i[t.index]=d}function e3(t,e,n,r){for(let i of t)e.mergedAttrs=Jc(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(v0(e,e.mergedAttrs,!0),n!==null&&wS(r,n,e))}function t3(t,e,n,r,i,s){let o=an(),a=i[ge],c=Rn(o,i);RS(a,i,o,n,null,r);for(let u=0;u<n.length;u++){let d=o.directiveStart+u,h=ea(i,a,d,o);Is(h,i)}PS(a,i,o),c&&Is(c,i);let l=ea(i,a,o.directiveStart+o.componentOffset,o);if(t[Wn]=i[Wn]=l,s!==null)for(let u of s)u(l,e);return TS(a,o,i),l}function n3(t,e,n,r){if(r)Q_(t,n,["ng-version","17.3.0"]);else{let{attrs:i,classes:s}=YV(e.selectors[0]);i&&Q_(t,n,i),s&&s.length>0&&xS(t,n,s.join(" "))}}function r3(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function i3(){let t=an();K0(Me()[ge],t)}var oa=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=s3;let t=e;return t})();function s3(){let t=an();return a3(t,Me())}var o3=oa,zS=class extends o3{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return pf(this._hostTNode,this._hostLView)}get injector(){return new vs(this._hostTNode,this._hostLView)}get parentInjector(){let e=Q0(this._hostTNode,this._hostLView);if(QT(e)){let n=qh(e,this._hostLView),r=Hh(e),i=n[ge].data[r+8];return new vs(i,n)}else return new vs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=GD(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-Nn}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=jD(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,LD(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!fL(e),a;if(o)a=n;else{let p=n||{};a=p.index,r=p.injector,i=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let c=o?e:new ta(vi(e)),l=r||this.parentInjector;if(!s&&c.ngModule==null){let m=(o?l:this.parentInjector).get(pn,null);m&&(s=m)}let u=vi(c.componentType??{}),d=jD(this._lContainer,u?.id??null),h=d?.firstChild??null,f=c.create(l,i,h,s);return this.insertImpl(f.hostView,a,LD(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(EL(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[kt],l=new zS(c,c[Qn],c[kt]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return I5(o,i,s,r),e.attachToViewContainerRef(),uT(U_(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=GD(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=c0(this._lContainer,n);r&&(Vh(U_(this._lContainer),n),_S(r[ge],r))}detach(e){let n=this._adjustIndex(e,-1),r=c0(this._lContainer,n);return r&&Vh(U_(this._lContainer),n)!=null?new bs(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function GD(t){return t[Bh]}function U_(t){return t[Bh]||(t[Bh]=[])}function a3(t,e){let n,r=e[t.index];return Kr(r)?n=r:(n=kS(r,e,null,t),e[t.index]=n,xf(e,n)),l3(n,e,t,r),new zS(n,t,e)}function c3(t,e){let n=t[et],r=n.createComment(""),i=Rn(e,t),s=ry(n,i);return Wh(n,s,r,L4(n,i),!1),r}var l3=h3,u3=()=>!1;function d3(t,e,n){return u3(t,e,n)}function h3(t,e,n,r){if(t[ws])return;let i;n.type&8?i=pr(r):i=c3(e,n),t[ws]=i}function f3(t){return typeof t=="function"&&t[l_]!==void 0}function WS(t){return f3(t)&&typeof t.set=="function"}function p3(t){let e=[],n=new Map;function r(i){let s=n.get(i);if(!s){let o=t(i);n.set(i,s=o.then(y3))}return s}return Xh.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(l=>{i.template=l}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let l=i.styles.length,u=i.styleUrls;i.styleUrls.forEach((d,h)=>{a.push(""),o.push(r(d).then(f=>{a[l+h]=f,u.splice(u.indexOf(d),1),u.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(l=>{a.push(l),i.styleUrl=void 0}));let c=Promise.all(o).then(()=>v3(s));e.push(c)}),m3(),Promise.all(e).then(()=>{})}var Xh=new Map,g3=new Set;function m3(){let t=Xh;return Xh=new Map,t}function _3(){return Xh.size===0}function y3(t){return typeof t=="string"?t:t.text()}function v3(t){g3.delete(t)}function x3(t){return Object.getPrototypeOf(t.prototype).constructor}function _r(t){let e=x3(t.type),n=!0,r=[t];for(;e;){let i;if(wi(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new H(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let o=t;o.inputs=Th(t.inputs),o.inputTransforms=Th(t.inputTransforms),o.declaredInputs=Th(t.declaredInputs),o.outputs=Th(t.outputs);let a=i.hostBindings;a&&b3(t,a);let c=i.viewQuery,l=i.contentQueries;if(c&&C3(t,c),l&&I3(t,l),w3(t,i),_V(t.outputs,i.outputs),wi(i)&&i.data.animation){let u=t.data;u.animation=(u.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(t),a===_r&&(n=!1)}}e=Object.getPrototypeOf(e)}E3(r)}function w3(t,e){for(let n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;let r=e.inputs[n];if(r!==void 0&&(t.inputs[n]=r,t.declaredInputs[n]=e.declaredInputs[n],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;t.inputTransforms??={},t.inputTransforms[i]=e.inputTransforms[i]}}}function E3(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Jc(i.hostAttrs,n=Jc(n,i.hostAttrs))}}function Th(t){return t===Qo?{}:t===Mn?[]:t}function C3(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function I3(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,s)=>{e(r,i,s),n(r,i,s)}:t.contentQueries=e}function b3(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}function gy(t){let e=t.inputConfig,n={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(n[r]=i[3])}t.inputTransforms=n}var Ei=class{},ol=class{};var Jh=class extends Ei{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Zh(this);let i=vT(e);this._bootstrapComponents=fS(i.bootstrap),this._r3Injector=iS(e,n,[{provide:Ei,useValue:this},{provide:Ef,useValue:this.componentFactoryResolver},...r],zt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},ef=class extends ol{constructor(e){super(),this.moduleType=e}create(e){return new Jh(this.moduleType,e,[])}};function D3(t,e,n){return new Jh(t,e,n)}var E0=class extends Ei{constructor(e){super(),this.componentFactoryResolver=new Zh(this),this.instance=null;let n=new el([...e.providers,{provide:Ei,useValue:this},{provide:Ef,useValue:this.componentFactoryResolver}],e.parent||j0(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Cf(t,e,n=null){return new E0({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var If=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Tt(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function KS(t){return S3(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function T3(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{let n=t[Symbol.iterator](),r;for(;!(r=n.next()).done;)e(r.value)}}function S3(t){return t!==null&&(typeof t=="function"||typeof t=="object")}function A3(t,e,n){return t[e]=n}function aa(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function M3(t){return(t.flags&32)===32}function N3(t,e,n,r,i,s,o,a,c){let l=e.consts,u=vf(e,t,4,o||null,$h(l,a));NS(e,n,u,$h(l,c)),K0(e,u);let d=u.tView=oy(2,u,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}function Wt(t,e,n,r,i,s,o,a){let c=Me(),l=on(),u=t+xi,d=l.firstCreatePass?N3(u,l,c,e,n,r,i,s,o):l.data[u];ul(d,!1);let h=R3(l,c,d,t);z0()&&iy(l,c,h,d),Is(h,c);let f=kS(h,c,h,d);return c[u]=f,xf(c,f),d3(f,d,c),U0(d)&&SS(l,c,d),o!=null&&AS(c,d,a),Wt}var R3=P3;function P3(t,e,n,r){return W0(!0),e[et].createComment("")}function hl(t,e,n,r){let i=Me(),s=hf();if(aa(i,s,e)){let o=on(),a=ff();f5(a,i,t,e,n,r)}return hl}function QS(t,e,n,r){return aa(t,hf(),n)?e+of(n)+r:bi}function Sh(t,e){return t<<17|e<<2}function Ds(t){return t>>17&32767}function k3(t){return(t&2)==2}function O3(t,e){return t&131071|e<<17}function C0(t){return t|2}function na(t){return(t&131068)>>2}function $_(t,e){return t&-131069|e<<2}function F3(t){return(t&1)===1}function I0(t){return t|1}function V3(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=Ds(o),c=na(o);t[r]=n;let l=!1,u;if(Array.isArray(n)){let d=n;u=d[1],(u===null||ll(d,u)>0)&&(l=!0)}else u=n;if(i)if(c!==0){let h=Ds(t[a+1]);t[r+1]=Sh(h,a),h!==0&&(t[h+1]=$_(t[h+1],r)),t[a+1]=O3(t[a+1],r)}else t[r+1]=Sh(a,0),a!==0&&(t[a+1]=$_(t[a+1],r)),a=r;else t[r+1]=Sh(c,0),a===0?a=r:t[c+1]=$_(t[c+1],r),c=r;l&&(t[r+1]=C0(t[r+1])),zD(t,u,r,!0),zD(t,u,r,!1),L3(e,u,t,r,s),o=Sh(a,c),s?e.classBindings=o:e.styleBindings=o}function L3(t,e,n,r,i){let s=i?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&ll(s,e)>=0&&(n[r+1]=I0(n[r+1]))}function zD(t,e,n,r){let i=t[n+1],s=e===null,o=r?Ds(i):na(i),a=!1;for(;o!==0&&(a===!1||s);){let c=t[o],l=t[o+1];j3(c,e)&&(a=!0,t[o+1]=r?I0(l):C0(l)),o=r?Ds(l):na(l)}a&&(t[n+1]=r?C0(i):I0(i))}function j3(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?ll(t,e)>=0:!1}function ne(t,e,n){let r=Me(),i=hf();if(aa(r,i,e)){let s=on(),o=ff();ay(s,o,r,t,e,r[et],n,!1)}return ne}function WD(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";cy(t,n,s[o],o,r)}function my(t,e){return B3(t,e,null,!0),my}function B3(t,e,n,r){let i=Me(),s=on(),o=FL(2);if(s.firstUpdatePass&&$3(s,t,o,r),e!==bi&&aa(i,o,e)){let a=s.data[sa()];W3(s,a,i,i[et],t,i[o+1]=K3(e,n),r,o)}}function U3(t,e){return e>=t.expandoStartIndex}function $3(t,e,n,r){let i=t.data;if(i[n+1]===null){let s=i[sa()],o=U3(t,n);Q3(s,r)&&e===null&&!o&&(e=!1),e=H3(i,s,e,r),V3(i,s,e,n,o,r)}}function H3(t,e,n,r){let i=BL(t),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=H_(null,t,e,n,r),n=al(n,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==i)if(n=H_(i,t,e,n,r),s===null){let c=q3(t,e,r);c!==void 0&&Array.isArray(c)&&(c=H_(null,t,e,c[1],r),c=al(c,e.attrs,r),G3(t,e,r,c))}else s=z3(t,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),n}function q3(t,e,n){let r=n?e.classBindings:e.styleBindings;if(na(r)!==0)return t[Ds(r)]}function G3(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[Ds(i)]=r}function z3(t,e,n){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=t[s].hostAttrs;r=al(r,o,n)}return al(r,e.attrs,n)}function H_(t,e,n,r,i){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],r=al(r,s.hostAttrs,i),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function al(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),VV(t,o,n?!0:e[++s]))}return t===void 0?null:t}function W3(t,e,n,r,i,s,o,a){if(!(e.type&3))return;let c=t.data,l=c[a+1],u=F3(l)?KD(c,e,n,i,na(l),o):void 0;if(!tf(u)){tf(s)||k3(l)&&(s=KD(c,null,n,i,a,o));let d=kT(sa(),n);G4(r,o,d,i,s)}}function KD(t,e,n,r,i,s){let o=e===null,a;for(;i>0;){let c=t[i],l=Array.isArray(c),u=l?c[1]:c,d=u===null,h=n[i+1];h===bi&&(h=d?Mn:void 0);let f=d?R_(h,r):u===r?h:void 0;if(l&&!tf(f)&&(f=R_(c,r)),tf(f)&&(a=f,o))return a;let p=t[i+1];i=o?Ds(p):na(p)}if(e!==null){let c=s?e.residualClasses:e.residualStyles;c!=null&&(a=R_(c,r))}return a}function tf(t){return t!==void 0}function K3(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=zt(dl(t)))),t}function Q3(t,e){return(t.flags&(e?8:16))!==0}function Y3(t,e,n,r,i,s){let o=e.consts,a=$h(o,i),c=vf(e,t,2,r,a);return NS(e,n,c,$h(o,s)),c.attrs!==null&&v0(c,c.attrs,!1),c.mergedAttrs!==null&&v0(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function x(t,e,n,r){let i=Me(),s=on(),o=xi+t,a=i[et],c=s.firstCreatePass?Y3(o,s,i,e,n,r):s.data[o],l=Z3(s,i,c,a,e,t);i[o]=l;let u=U0(c);return ul(c,!0),wS(a,l,c),!M3(c)&&z0()&&iy(s,i,l,c),DL()===0&&Is(l,i),TL(),u&&(SS(s,i,c),TS(s,c,i)),r!==null&&AS(i,c),x}function I(){let t=an();BT()?PL():(t=t.parent,ul(t,!1));let e=t;ML(e)&&NL(),SL();let n=on();return n.firstCreatePass&&(K0(n,t),AT(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&WL(e)&&WD(n,e,Me(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&KL(e)&&WD(n,e,Me(),e.stylesWithoutHost,!1),I}function cn(t,e,n,r){return x(t,e,n,r),I(),cn}var Z3=(t,e,n,r,i,s)=>(W0(!0),pS(r,i,HL()));function Ft(){return Me()}var nf="en-US";var X3=nf;function J3(t){typeof t=="string"&&(X3=t.toLowerCase().replace(/_/g,"-"))}function me(t,e,n,r){let i=Me(),s=on(),o=an();return YS(s,i,i[et],o,t,e,r),me}function ej(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[tl],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function YS(t,e,n,r,i,s,o){let a=U0(r),l=t.firstCreatePass&&y5(t),u=e[Wn],d=_5(e),h=!0;if(r.type&3||o){let m=Rn(r,e),v=o?o(m):m,b=d.length,F=o?q=>o(pr(q[r.index])):r.index,T=null;if(!o&&a&&(T=ej(t,e,i,r.index)),T!==null){let q=T.__ngLastListenerFn__||T;q.__ngNextListenerFn__=s,T.__ngLastListenerFn__=s,h=!1}else{s=YD(r,e,u,s,!1);let q=n.listen(v,i,s);d.push(s,q),l&&l.push(i,F,b,b+1)}}else s=YD(r,e,u,s,!1);let f=r.outputs,p;if(h&&f!==null&&(p=f[i])){let m=p.length;if(m)for(let v=0;v<m;v+=2){let b=p[v],F=p[v+1],W=e[b][F].subscribe(s),Z=d.length;d.push(s,W),l&&l.push(i,r.index,Z,-(Z+1))}}}function QD(t,e,n,r){let i=Ce(null);try{return ur(6,e,n),n(r)!==!1}catch(s){return FS(t,s),!1}finally{ur(7,e,n),Ce(i)}}function YD(t,e,n,r,i){return function s(o){if(o===Function)return r;let a=t.componentOffset>-1?Ii(t.index,e):e;uy(a);let c=QD(e,n,r,o),l=s.__ngNextListenerFn__;for(;l;)c=QD(e,n,l,o)&&c,l=l.__ngNextListenerFn__;return i&&c===!1&&o.preventDefault(),c}}function Pe(t=1){return $L(t)}function Ts(t,e,n){return ZS(t,"",e,"",n),Ts}function ZS(t,e,n,r,i){let s=Me(),o=QS(s,e,n,r);if(o!==bi){let a=on(),c=ff();ay(a,c,s,t,o,s[et],i,!1)}return ZS}function S(t,e=""){let n=Me(),r=on(),i=t+xi,s=r.firstCreatePass?vf(r,i,1,e,null):r.data[i],o=tj(r,n,s,e,t);n[i]=o,z0()&&iy(r,n,o,s),ul(s,!1)}var tj=(t,e,n,r,i)=>(W0(!0),D4(e[et],r));function At(t){return fl("",t,""),At}function fl(t,e,n){let r=Me(),i=QS(r,t,e,n);return i!==bi&&v5(r,sa(),i),fl}function ln(t,e,n){WS(e)&&(e=e());let r=Me(),i=hf();if(aa(r,i,e)){let s=on(),o=ff();ay(s,o,r,t,e,r[et],n,!1)}return ln}function gn(t,e){let n=WS(t);return n&&t.set(e),n}function un(t,e){let n=Me(),r=on(),i=an();return YS(r,n,n[et],i,t,e),un}function nj(t,e,n){let r=on();if(r.firstCreatePass){let i=wi(t);b0(n,r.data,r.blueprint,i,!0),b0(e,r.data,r.blueprint,i,!1)}}function b0(t,e,n,r,i){if(t=qt(t),Array.isArray(t))for(let s=0;s<t.length;s++)b0(t[s],e,n,r,i);else{let s=on(),o=Me(),a=an(),c=Zo(t)?t:qt(t.provide),l=bT(t),u=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(Zo(t)||!t.multi){let f=new Cs(l,i,te),p=G_(c,e,i?u:u+h,d);p===-1?(r0(Gh(a,o),s,c),q_(s,t,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(f),o.push(f)):(n[p]=f,o[p]=f)}else{let f=G_(c,e,u+h,d),p=G_(c,e,u,u+h),m=f>=0&&n[f],v=p>=0&&n[p];if(i&&!v||!i&&!m){r0(Gh(a,o),s,c);let b=sj(i?ij:rj,n.length,i,r,l);!i&&v&&(n[p].providerFactory=b),q_(s,t,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(b),o.push(b)}else{let b=XS(n[i?p:f],l,!i&&r);q_(s,t,f>-1?f:p,b)}!i&&r&&v&&n[p].componentProviders++}}}function q_(t,e,n,r){let i=Zo(e),s=iL(e);if(i||s){let c=(s?qt(e.useClass):e).prototype.ngOnDestroy;if(c){let l=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let u=l.indexOf(n);u===-1?l.push(n,[r,c]):l[u+1].push(r,c)}else l.push(n,c)}}}function XS(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function G_(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function rj(t,e,n,r){return D0(this.multi,[])}function ij(t,e,n,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=ea(n,n[ge],this.providerFactory.index,r);s=a.slice(0,o),D0(i,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],D0(i,s);return s}function D0(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function sj(t,e,n,r,i){let s=new Cs(t,n,te);return s.multi=[],s.index=e,s.componentProviders=0,XS(s,i,r&&!n),s}function Ss(t,e=[]){return n=>{n.providersResolver=(r,i)=>nj(r,i?i(t):t,e)}}var oj=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=ET(!1,r.type),s=i.length>0?Cf([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=V({token:e,providedIn:"environment",factory:()=>new e(E(pn))});let t=e;return t})();function JS(t){dy("NgStandalone"),t.getStandaloneInjector=e=>e.get(oj).getOrCreateStandaloneInjector(t)}function _t(t,e,n,r){return cj(Me(),kL(),t,e,n,r)}function aj(t,e){let n=t[e];return n===bi?void 0:n}function cj(t,e,n,r,i,s){let o=e+n;return aa(t,o,i)?A3(t,o+1,s?r.call(s,i):r(i)):aj(t,o+1)}var Ah=null;function lj(t){Ah!==null&&(t.defaultEncapsulation!==Ah.defaultEncapsulation||t.preserveWhitespaces!==Ah.preserveWhitespaces)||(Ah=t)}var qr=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},eA=new qr("17.3.0"),bf=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();var _y=new O(""),pl=new O(""),Df=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,yy||(uj(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{fe.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(E(fe),E(Tf),E(pl))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),Tf=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return yy?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();function uj(t){yy=t}var yy;function As(t){return!!t&&typeof t.then=="function"}function tA(t){return!!t&&typeof t.subscribe=="function"}var Sf=new O(""),nA=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=P(Sf,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(As(o))r.push(o);else if(tA(o)){let a=new Promise((c,l)=>{o.subscribe({complete:c,error:l})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),vy=new O("");function dj(){Kb(()=>{throw new H(600,!1)})}function hj(t){return t.isBoundToModule}function fj(t,e,n){try{let r=n();return As(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}function rA(t,e){return Array.isArray(e)?e.reduce(rA,t):A(A({},t),e)}var ca=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=P(sS),this.afterRenderEffectManager=P(py),this.externalTestViews=new Set,this.beforeRender=new He,this.afterTick=new He,this.componentTypes=[],this.components=[],this.isStable=P(If).hasPendingTasks.pipe(j(r=>!r)),this._injector=P(pn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof Yh;if(!this._injector.get(nA).done){let f=!s&&yT(r),p=!1;throw new H(405,p)}let a;s?a=r:a=this._injector.get(Ef).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=hj(a)?void 0:this._injector.get(Ei),l=i||a.selector,u=a.create(Yn.NULL,[],l,c),d=u.location.nativeElement,h=u.injector.get(_y,null);return h?.registerApplication(d),u.onDestroy(()=>{this.detachView(u.hostView),kh(this.components,u),h?.unregisterApplication(d)}),this._loadComponent(u),u}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new H(101,!1);let i=Ce(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,Ce(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===US)throw new H(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:c}of this._views)pj(a,o,c)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>T0(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>T0(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;kh(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(vy,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>kh(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new H(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function kh(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function pj(t,e,n){!e&&!T0(t)||gj(t,n,e)}function T0(t){return H0(t)}function gj(t,e,n){let r;n?(r=0,t[z]|=1024):t[z]&64?r=0:r=1,$S(t,e,r)}var S0=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},Af=(()=>{let e=class e{compileModuleSync(r){return new ef(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=vT(r),o=fS(s.declarations).reduce((a,c)=>{let l=vi(c);return l&&a.push(new ta(l)),a},[]);return new S0(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),mj=new O("");function _j(t,e,n){let r=new ef(n);return Promise.resolve(r)}function ZD(t){for(let e=t.length-1;e>=0;e--)if(t[e]!==void 0)return t[e]}var yj=(()=>{let e=class e{constructor(){this.zone=P(fe),this.applicationRef=P(ca)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function vj(t){return[{provide:fe,useFactory:t},{provide:Yo,multi:!0,useFactory:()=>{let e=P(yj,{optional:!0});return()=>e.initialize()}},{provide:Yo,multi:!0,useFactory:()=>{let e=P(Ej);return()=>{e.initialize()}}},{provide:sS,useFactory:xj}]}function xj(){let t=P(fe),e=P(gr);return n=>t.runOutsideAngular(()=>e.handleError(n))}function wj(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var Ej=(()=>{let e=class e{constructor(){this.subscription=new We,this.initialized=!1,this.zone=P(fe),this.pendingTasks=P(If)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{fe.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{fe.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Cj(){return typeof $localize<"u"&&$localize.locale||nf}var xy=new O("",{providedIn:"root",factory:()=>P(xy,le.Optional|le.SkipSelf)||Cj()});var iA=new O(""),sA=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=Q5(i?.ngZone,wj({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=D3(r.moduleType,this.injector,vj(()=>s)),a=o.injector.get(gr,null);return s.runOutsideAngular(()=>{let c=s.onError.subscribe({next:l=>{a.handleError(l)}});o.onDestroy(()=>{kh(this._modules,o),c.unsubscribe()})}),fj(a,s,()=>{let c=o.injector.get(nA);return c.runInitializers(),c.donePromise.then(()=>{let l=o.injector.get(xy,nf);return J3(l||nf),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=rA({},i);return _j(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(ca);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new H(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new H(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(iA,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(E(Yn))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),Zc=null,oA=new O("");function Ij(t){if(Zc&&!Zc.get(oA,!1))throw new H(400,!1);dj(),Zc=t;let e=t.get(sA);return Tj(t),e}function wy(t,e,n=[]){let r=`Platform: ${e}`,i=new O(r);return(s=[])=>{let o=aA();if(!o||o.injector.get(oA,!1)){let a=[...n,...s,{provide:i,useValue:!0}];t?t(a):Ij(bj(a,r))}return Dj(i)}}function bj(t=[],e){return Yn.create({name:e,providers:[{provide:cf,useValue:"platform"},{provide:iA,useValue:new Set([()=>Zc=null])},...t]})}function Dj(t){let e=aA();if(!e)throw new H(401,!1);return e}function aA(){return Zc?.get(sA)??null}function Tj(t){t.get(X0,null)?.forEach(n=>n())}function Ey(){return!1}var Ms=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=Sj;let t=e;return t})();function Sj(t){return Aj(an(),Me(),(t&16)===16)}function Aj(t,e,n){if(df(t)&&!n){let r=Ii(t.index,e);return new bs(r,r)}else if(t.type&47){let r=e[fr];return new bs(r,e)}return null}var A0=class{constructor(){}supports(e){return KS(e)}create(e){return new M0(e)}},Mj=(t,e)=>e,M0=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Mj}forEachItem(e){let n;for(n=this._itHead;n!==null;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,s=null;for(;n||r;){let o=!r||n&&n.currentIndex<XD(r,i,s)?n:r,a=XD(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(n=n._next,o.previousIndex==null)i++;else{s||(s=[]);let l=a-i,u=c-i;if(l!=u){for(let h=0;h<l;h++){let f=h<s.length?s[h]:s[h]=0,p=f+h;u<=p&&p<l&&(s[h]=f+1)}let d=o.previousIndex;s[d]=u-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)e(n)}diff(e){if(e==null&&(e=[]),!KS(e))throw new H(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,s,o,a),r=!0):(r&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)),n=n._next}else i=0,T3(e,a=>{o=this._trackByFn(i,a),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,a,o,i),r=!0):(r&&(n=this._verifyReinsertion(n,a,o,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,i)):e=this._addAfter(new N0(n,r),s,i)),e}_verifyReinsertion(e,n,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let n=e._next;this._addToRemovals(this._unlink(e)),e=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){let i=n===null?this._itHead:n._next;return e._next=i,e._prev=n,i===null?this._itTail=e:i._prev=e,n===null?this._itHead=e:n._next=e,this._linkedRecords===null&&(this._linkedRecords=new rf),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let n=e._prev,r=e._next;return n===null?this._itHead=r:n._next=r,r===null?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new rf),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},N0=class{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},R0=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;r!==null;r=r._nextDup)if((n===null||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let n=e._prevDup,r=e._nextDup;return n===null?this._head=r:n._nextDup=r,r===null?this._tail=n:r._prevDup=n,this._head===null}},rf=class{constructor(){this.map=new Map}put(e){let n=e.trackById,r=this.map.get(n);r||(r=new R0,this.map.set(n,r)),r.add(e)}get(e,n){let r=e,i=this.map.get(r);return i?i.get(e,n):null}remove(e){let n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function XD(t,e,n){let r=t.previousIndex;if(r===null)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}function JD(){return new Cy([new A0])}var Cy=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||JD()),deps:[[e,new O0,new ra]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new H(901,!1)}};e.\u0275prov=V({token:e,providedIn:"root",factory:JD});let t=e;return t})();var cA=wy(null,"core",[]),lA=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(E(ca))},e.\u0275mod=nt({type:e}),e.\u0275inj=tt({});let t=e;return t})();function Ns(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function uA(t){let e=vi(t);if(!e)return null;let n=new ta(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var mA=null;function yr(){return mA}function _A(t){mA??=t}var Mf=class{};var dn=new O(""),Ay=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(Nj),providedIn:"platform"});let t=e;return t})(),yA=new O(""),Nj=(()=>{let e=class e extends Ay{constructor(){super(),this._doc=P(dn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return yr().getBaseHref(this._doc)}onPopState(r){let i=yr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=yr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>new e,providedIn:"platform"});let t=e;return t})();function My(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function dA(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function Yr(t){return t&&t[0]!=="?"?"?"+t:t}var Zr=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(Ny),providedIn:"root"});let t=e;return t})(),vA=new O(""),Ny=(()=>{let e=class e extends Zr{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??P(dn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return My(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+Yr(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Yr(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Yr(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(E(Ay),E(vA,8))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),xA=(()=>{let e=class e extends Zr{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=My(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Yr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Yr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(E(Ay),E(vA,8))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),la=(()=>{let e=class e{constructor(r){this._subject=new ht,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=kj(dA(hA(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+Yr(i))}normalize(r){return e.stripTrailingSlash(Pj(this._basePath,hA(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Yr(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Yr(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=Yr,e.joinWithSlash=My,e.stripTrailingSlash=dA,e.\u0275fac=function(i){return new(i||e)(E(Zr))},e.\u0275prov=V({token:e,factory:()=>Rj(),providedIn:"root"});let t=e;return t})();function Rj(){return new la(E(Zr))}function Pj(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function hA(t){return t.replace(/\/index.html$/,"")}function kj(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function wA(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var Iy=/\s+/,fA=[],ua=(()=>{let e=class e{constructor(r,i){this._ngEl=r,this._renderer=i,this.initialClasses=fA,this.stateMap=new Map}set klass(r){this.initialClasses=r!=null?r.trim().split(Iy):fA}set ngClass(r){this.rawClass=typeof r=="string"?r.trim().split(Iy):r}ngDoCheck(){for(let i of this.initialClasses)this._updateState(i,!0);let r=this.rawClass;if(Array.isArray(r)||r instanceof Set)for(let i of r)this._updateState(i,!0);else if(r!=null)for(let i of Object.keys(r))this._updateState(i,!!r[i]);this._applyStateDiff()}_updateState(r,i){let s=this.stateMap.get(r);s!==void 0?(s.enabled!==i&&(s.changed=!0,s.enabled=i),s.touched=!0):this.stateMap.set(r,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(let r of this.stateMap){let i=r[0],s=r[1];s.changed?(this._toggleClass(i,s.enabled),s.changed=!1):s.touched||(s.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),s.touched=!1}}_toggleClass(r,i){r=r.trim(),r.length>0&&r.split(Iy).forEach(s=>{i?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}};e.\u0275fac=function(i){return new(i||e)(te(Zn),te(mr))},e.\u0275dir=rt({type:e,selectors:[["","ngClass",""]],inputs:{klass:[Pt.None,"class","klass"],ngClass:"ngClass"},standalone:!0});let t=e;return t})();var by=class{constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},da=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new by(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let c=i.get(o);i.move(c,a),pA(c,s)}});for(let s=0,o=i.length;s<o;s++){let c=i.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);pA(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(te(oa),te(wf),te(Cy))},e.\u0275dir=rt({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let t=e;return t})();function pA(t,e){t.context.$implicit=e.item}var ha=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new Dy,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){gA("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){gA("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(te(oa),te(wf))},e.\u0275dir=rt({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let t=e;return t})(),Dy=class{constructor(){this.$implicit=null,this.ngIf=null}};function gA(t,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${t} must be a TemplateRef, but received '${zt(e)}'.`)}var EA=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=nt({type:e}),e.\u0275inj=tt({});let t=e;return t})(),Ry="browser",Oj="server";function Fj(t){return t===Ry}function Rs(t){return t===Oj}var CA=(()=>{let e=class e{};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>Fj(P(Ot))?new Ty(P(dn),window):new Sy});let t=e;return t})(),Ty=class{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let n=Vj(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function Vj(t,e){let n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var Sy=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},Nf=class{};var Oy=class extends Mf{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Fy=class t extends Oy{static makeCurrent(){_A(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=jj();return n==null?null:Bj(n)}resetBaseElement(){gl=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return wA(document.cookie,e)}},gl=null;function jj(){return gl=gl||document.querySelector("base"),gl?gl.getAttribute("href"):null}function Bj(t){return new URL(t,document.baseURI).pathname}var Vy=class{addToWindow(e){Gt.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new H(5103,!1);return s},Gt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Gt.getAllAngularRootElements=()=>e.getAllRootElements();let n=r=>{let i=Gt.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};Gt.frameworkStabilizers||(Gt.frameworkStabilizers=[]),Gt.frameworkStabilizers.push(n)}findTestabilityInTree(e,n,r){if(n==null)return null;let i=e.getTestability(n);return i??(r?yr().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},Uj=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),Ly=new O(""),TA=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new H(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(E(Ly),E(fe))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),Pf=class{constructor(e){this._doc=e}},Py="ng-app-id",SA=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Rs(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${Py}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(Py),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(Py,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(E(dn),E(gf),E(J0,8),E(Ot))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),ky={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},By=/%COMP%/g,AA="%COMP%",$j=`_nghost-${AA}`,Hj=`_ngcontent-${AA}`,qj=!0,Gj=new O("",{providedIn:"root",factory:()=>qj});function zj(t){return Hj.replace(By,t)}function Wj(t){return $j.replace(By,t)}function MA(t,e){return e.map(n=>n.replace(By,t))}var IA=(()=>{let e=class e{constructor(r,i,s,o,a,c,l,u=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=Rs(c),this.defaultRenderer=new ml(r,a,l,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===hr.ShadowDom&&(i=se(A({},i),{encapsulation:hr.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof kf?s.applyToHost(r):s instanceof _l&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,c=this.ngZone,l=this.eventManager,u=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case hr.Emulated:o=new kf(l,u,i,this.appId,d,a,c,h);break;case hr.ShadowDom:return new jy(l,u,r,i,a,c,this.nonce,h);default:o=new _l(l,u,i,d,a,c,h);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(E(TA),E(SA),E(gf),E(Gj),E(dn),E(Ot),E(fe),E(J0))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),ml=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(ky[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(bA(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(bA(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new H(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=ky[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=ky[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Hr.DashCase|Hr.Important)?e.style.setProperty(n,r,i&Hr.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Hr.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=yr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function bA(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var jy=class extends ml{constructor(e,n,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=MA(i.id,i.styles);for(let u of l){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=u,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},_l=class extends ml{constructor(e,n,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=c?MA(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},kf=class extends _l{constructor(e,n,r,i,s,o,a,c){let l=i+"-"+r.id;super(e,n,r,s,o,a,c,l),this.contentAttr=zj(l),this.hostAttr=Wj(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},Kj=(()=>{let e=class e extends Pf{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(E(dn))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),DA=["alt","control","meta","shift"],Qj={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Yj={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},Zj=(()=>{let e=class e extends Pf{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>yr().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),DA.forEach(u=>{let d=i.indexOf(u);d>-1&&(i.splice(d,1),a+=u+".")}),a+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(r,i){let s=Qj[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),DA.forEach(a=>{if(a!==s){let c=Yj[a];c(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(E(dn))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function Xj(){Fy.makeCurrent()}function Jj(){return new gr}function e9(){return aS(document),document}var t9=[{provide:Ot,useValue:Ry},{provide:X0,useValue:Xj,multi:!0},{provide:dn,useFactory:e9,deps:[]}],NA=wy(cA,"browser",t9),n9=new O(""),r9=[{provide:pl,useClass:Vy,deps:[]},{provide:_y,useClass:Df,deps:[fe,Tf,pl]},{provide:Df,useClass:Df,deps:[fe,Tf,pl]}],i9=[{provide:cf,useValue:"root"},{provide:gr,useFactory:Jj,deps:[]},{provide:Ly,useClass:Kj,multi:!0,deps:[dn,fe,Ot]},{provide:Ly,useClass:Zj,multi:!0,deps:[dn]},IA,SA,TA,{provide:sl,useExisting:IA},{provide:Nf,useClass:Uj,deps:[]},[]],RA=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:gf,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(E(n9,12))},e.\u0275mod=nt({type:e}),e.\u0275inj=tt({providers:[...i9,...r9],imports:[EA,lA]});let t=e;return t})();var PA=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(E(dn))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var ie="primary",Rl=Symbol("RouteTitle"),Gy=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function _a(t){return new Gy(t)}function s9(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function o9(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!vr(t[n],e[n]))return!1;return!0}function vr(t,e){let n=t?zy(t):void 0,r=e?zy(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!HA(t[i],e[i]))return!1;return!0}function zy(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function HA(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function qA(t){return t.length>0?t[t.length-1]:null}function Mi(t){return I_(t)?t:As(t)?xe(Promise.resolve(t)):B(t)}var a9={exact:zA,subset:WA},GA={exact:c9,subset:l9,ignored:()=>!0};function OA(t,e,n){return a9[n.paths](t.root,e.root,n.matrixParams)&&GA[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function c9(t,e){return vr(t,e)}function zA(t,e,n){if(!ks(t.segments,e.segments)||!Vf(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!zA(t.children[r],e.children[r],n))return!1;return!0}function l9(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>HA(t[n],e[n]))}function WA(t,e,n){return KA(t,e,e.segments,n)}function KA(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!ks(i,n)||e.hasChildren()||!Vf(i,n,r))}else if(t.segments.length===n.length){if(!ks(t.segments,n)||!Vf(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!WA(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!ks(t.segments,i)||!Vf(t.segments,i,r)||!t.children[ie]?!1:KA(t.children[ie],e,s,r)}}function Vf(t,e,n){return e.every((r,i)=>GA[n](t[i].parameters,r.parameters))}var Di=class{constructor(e=new Ie([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=_a(this.queryParams),this._queryParamMap}toString(){return h9.serialize(this)}},Ie=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Lf(this)}},Ps=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=_a(this.parameters),this._parameterMap}toString(){return YA(this)}};function u9(t,e){return ks(t,e)&&t.every((n,r)=>vr(n.parameters,e[r].parameters))}function ks(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function d9(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===ie&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==ie&&(n=n.concat(e(i,r)))}),n}var Pl=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>new Il,providedIn:"root"});let t=e;return t})(),Il=class{parse(e){let n=new Ky(e);return new Di(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${yl(e.root,!0)}`,r=g9(e.queryParams),i=typeof e.fragment=="string"?`#${f9(e.fragment)}`:"";return`${n}${r}${i}`}},h9=new Il;function Lf(t){return t.segments.map(e=>YA(e)).join("/")}function yl(t,e){if(!t.hasChildren())return Lf(t);if(e){let n=t.children[ie]?yl(t.children[ie],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==ie&&r.push(`${i}:${yl(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=d9(t,(r,i)=>i===ie?[yl(t.children[ie],!1)]:[`${i}:${yl(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[ie]!=null?`${Lf(t)}/${n[0]}`:`${Lf(t)}/(${n.join("//")})`}}function QA(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Of(t){return QA(t).replace(/%3B/gi,";")}function f9(t){return encodeURI(t)}function Wy(t){return QA(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function jf(t){return decodeURIComponent(t)}function FA(t){return jf(t.replace(/\+/g,"%20"))}function YA(t){return`${Wy(t.path)}${p9(t.parameters)}`}function p9(t){return Object.entries(t).map(([e,n])=>`;${Wy(e)}=${Wy(n)}`).join("")}function g9(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${Of(n)}=${Of(i)}`).join("&"):`${Of(n)}=${Of(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var m9=/^[^\/()?;#]+/;function Uy(t){let e=t.match(m9);return e?e[0]:""}var _9=/^[^\/()?;=#]+/;function y9(t){let e=t.match(_9);return e?e[0]:""}var v9=/^[^=?&#]+/;function x9(t){let e=t.match(v9);return e?e[0]:""}var w9=/^[^&#]+/;function E9(t){let e=t.match(w9);return e?e[0]:""}var Ky=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ie([],{}):new Ie([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[ie]=new Ie(e,n)),r}parseSegment(){let e=Uy(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new H(4009,!1);return this.capture(e),new Ps(jf(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=y9(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=Uy(this.remaining);i&&(r=i,this.capture(r))}e[jf(n)]=jf(r)}parseQueryParam(e){let n=x9(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=E9(this.remaining);o&&(r=o,this.capture(r))}let i=FA(n),s=FA(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Uy(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new H(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=ie);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[ie]:new Ie([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new H(4011,!1)}};function ZA(t){return t.segments.length>0?new Ie([],{[ie]:t}):t}function XA(t){let e={};for(let[r,i]of Object.entries(t.children)){let s=XA(i);if(r===ie&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new Ie(t.segments,e);return C9(n)}function C9(t){if(t.numberOfChildren===1&&t.children[ie]){let e=t.children[ie];return new Ie(t.segments.concat(e.segments),e.children)}return t}function ya(t){return t instanceof Di}function I9(t,e,n=null,r=null){let i=JA(t);return e1(i,e,n,r)}function JA(t){let e;function n(s){let o={};for(let c of s.children){let l=n(c);o[c.outlet]=l}let a=new Ie(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=ZA(r);return e??i}function e1(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return $y(i,i,i,n,r);let s=b9(e);if(s.toRoot())return $y(i,i,new Ie([],{}),n,r);let o=D9(s,i,t),a=o.processChildren?wl(o.segmentGroup,o.index,s.commands):n1(o.segmentGroup,o.index,s.commands);return $y(i,o.segmentGroup,a,n,r)}function Bf(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function bl(t){return typeof t=="object"&&t!=null&&t.outlets}function $y(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`});let o;t===e?o=n:o=t1(t,e,n);let a=ZA(XA(o));return new Di(a,s,i)}function t1(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=t1(s,e,n)}),new Ie(t.segments,r)}var Uf=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&Bf(r[0]))throw new H(4003,!1);let i=r.find(bl);if(i&&i!==qA(r))throw new H(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function b9(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new Uf(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Uf(n,e,r)}var ga=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function D9(t,e,n){if(t.isAbsolute)return new ga(e,!0,0);if(!n)return new ga(e,!1,NaN);if(n.parent===null)return new ga(n,!0,0);let r=Bf(t.commands[0])?0:1,i=n.segments.length-1+r;return T9(n,i,t.numberOfDoubleDots)}function T9(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new H(4005,!1);i=r.segments.length}return new ga(r,!1,i-s)}function S9(t){return bl(t[0])?t[0].outlets:{[ie]:t}}function n1(t,e,n){if(t??=new Ie([],{}),t.segments.length===0&&t.hasChildren())return wl(t,e,n);let r=A9(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new Ie(t.segments.slice(0,r.pathIndex),{});return s.children[ie]=new Ie(t.segments.slice(r.pathIndex),t.children),wl(s,0,i)}else return r.match&&i.length===0?new Ie(t.segments,{}):r.match&&!t.hasChildren()?Qy(t,e,n):r.match?wl(t,0,i):Qy(t,e,n)}function wl(t,e,n){if(n.length===0)return new Ie(t.segments,{});{let r=S9(n),i={};if(Object.keys(r).some(s=>s!==ie)&&t.children[ie]&&t.numberOfChildren===1&&t.children[ie].segments.length===0){let s=wl(t.children[ie],e,n);return new Ie(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=n1(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Ie(t.segments,i)}}function A9(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(bl(a))break;let c=`${a}`,l=r<n.length-1?n[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!LA(c,l,o))return s;r+=2}else{if(!LA(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Qy(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(bl(s)){let c=M9(s.outlets);return new Ie(r,c)}if(i===0&&Bf(n[0])){let c=t.segments[e];r.push(new Ps(c.path,VA(n[0]))),i++;continue}let o=bl(s)?s.outlets[ie]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&Bf(a)?(r.push(new Ps(o,VA(a))),i+=2):(r.push(new Ps(o,{})),i++)}return new Ie(r,{})}function M9(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=Qy(new Ie([],{}),0,r))}),e}function VA(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function LA(t,e,n){return t==n.path&&vr(e,n.parameters)}var El="imperative",yt=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(yt||{}),Pn=class{constructor(e,n){this.id=e,this.url=n}},va=class extends Pn{constructor(e,n,r="imperative",i=null){super(e,n),this.type=yt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},xr=class extends Pn{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=yt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},_n=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(_n||{}),$f=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}($f||{}),Ti=class extends Pn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=yt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Si=class extends Pn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=yt.NavigationSkipped}},Dl=class extends Pn{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=yt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Hf=class extends Pn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=yt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Yy=class extends Pn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=yt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Zy=class extends Pn{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=yt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Xy=class extends Pn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=yt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Jy=class extends Pn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=yt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ev=class{constructor(e){this.route=e,this.type=yt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},tv=class{constructor(e){this.route=e,this.type=yt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},nv=class{constructor(e){this.snapshot=e,this.type=yt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},rv=class{constructor(e){this.snapshot=e,this.type=yt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},iv=class{constructor(e){this.snapshot=e,this.type=yt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},sv=class{constructor(e){this.snapshot=e,this.type=yt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},qf=class{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=yt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Tl=class{},Sl=class{constructor(e){this.url=e}};var ov=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new kl,this.attachRef=null}},kl=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new ov,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Gf=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=av(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=av(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=cv(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return cv(e,this._root).map(n=>n.value)}};function av(t,e){if(t===e.value)return e;for(let n of e.children){let r=av(t,n);if(r)return r}return null}function cv(t,e){if(t===e.value)return[e];for(let n of e.children){let r=cv(t,n);if(r.length)return r.unshift(e),r}return[]}var mn=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function pa(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var zf=class extends Gf{constructor(e,n){super(e),this.snapshot=n,yv(this,e)}toString(){return this.snapshot.toString()}};function r1(t){let e=N9(t),n=new Tt([new Ps("",{})]),r=new Tt({}),i=new Tt({}),s=new Tt({}),o=new Tt(""),a=new Os(n,r,s,o,i,ie,t,e.root);return a.snapshot=e.root,new zf(new mn(a,[]),e)}function N9(t){let e={},n={},r={},i="",s=new Al([],e,r,i,n,ie,t,null,{});return new Wf("",new mn(s,[]))}var Os=class{constructor(e,n,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(j(l=>l[Rl]))??B(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(j(e=>_a(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(j(e=>_a(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function _v(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:A(A({},e.params),t.params),data:A(A({},e.data),t.data),resolve:A(A(A(A({},t.data),e.data),i?.data),t._resolvedData)}:r={params:A({},t.params),data:A({},t.data),resolve:A(A({},t.data),t._resolvedData??{})},i&&s1(i)&&(r.resolve[Rl]=i.title),r}var Al=class{get title(){return this.data?.[Rl]}constructor(e,n,r,i,s,o,a,c,l){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=_a(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=_a(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},Wf=class extends Gf{constructor(e,n){super(n),this.url=e,yv(this,n)}toString(){return i1(this._root)}};function yv(t,e){e.value._routerState=t,e.children.forEach(n=>yv(t,n))}function i1(t){let e=t.children.length>0?` { ${t.children.map(i1).join(", ")} } `:"";return`${t.value}${e}`}function Hy(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,vr(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),vr(e.params,n.params)||t.paramsSubject.next(n.params),o9(e.url,n.url)||t.urlSubject.next(n.url),vr(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function lv(t,e){let n=vr(t.params,e.params)&&u9(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||lv(t.parent,e.parent))}function s1(t){return typeof t.title=="string"||t.title===null}var vv=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=ie,this.activateEvents=new ht,this.deactivateEvents=new ht,this.attachEvents=new ht,this.detachEvents=new ht,this.parentContexts=P(kl),this.location=P(oa),this.changeDetector=P(Ms),this.environmentInjector=P(pn),this.inputBinder=P(Xf,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new H(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new H(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new H(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new H(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new uv(r,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=rt({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Ci]});let t=e;return t})(),uv=class{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===Os?this.route:e===kl?this.childContexts:this.parent.get(e,n)}},Xf=new O(""),jA=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=Gc([i.queryParams,i.params,i.data]).pipe(Le(([o,a,c],l)=>(c=A(A(A({},o),a),c),l===0?B(c):Promise.resolve(c)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=uA(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function R9(t,e,n){let r=Ml(t,e._root,n?n._root:void 0);return new zf(r,e)}function Ml(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=P9(t,e,n);return new mn(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Ml(t,a)),o}}let r=k9(e.value),i=e.children.map(s=>Ml(t,s));return new mn(r,i)}}function P9(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return Ml(t,r,i);return Ml(t,r)})}function k9(t){return new Os(new Tt(t.url),new Tt(t.params),new Tt(t.queryParams),new Tt(t.fragment),new Tt(t.data),t.outlet,t.component,t)}var o1="ngNavigationCancelingError";function a1(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=ya(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=c1(!1,_n.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function c1(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[o1]=!0,n.cancellationCode=e,n}function O9(t){return l1(t)&&ya(t.url)}function l1(t){return!!t&&t[o1]}var F9=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=sn({type:e,selectors:[["ng-component"]],standalone:!0,features:[JS],decls:1,vars:0,template:function(i,s){i&1&&cn(0,"router-outlet")},dependencies:[vv],encapsulation:2});let t=e;return t})();function V9(t,e){return t.providers&&!t._injector&&(t._injector=Cf(t.providers,e,`Route: ${t.path}`)),t._injector??e}function xv(t){let e=t.children&&t.children.map(xv),n=e?se(A({},t),{children:e}):A({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==ie&&(n.component=F9),n}function wr(t){return t.outlet||ie}function L9(t,e){let n=t.filter(r=>wr(r)===e);return n.push(...t.filter(r=>wr(r)!==e)),n}function Ol(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var j9=(t,e,n,r)=>j(i=>(new dv(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),dv=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),Hy(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=pa(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=pa(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=pa(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=pa(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new sv(s.value.snapshot))}),e.children.length&&this.forwardEvent(new rv(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(Hy(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Hy(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=Ol(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},Kf=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},ma=class{constructor(e,n){this.component=e,this.route=n}};function B9(t,e,n){let r=t._root,i=e?e._root:null;return vl(r,i,n,[r.value])}function U9(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function wa(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!rT(t)?t:e.get(t):r}function vl(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=pa(e);return t.children.forEach(o=>{$9(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Cl(a,n.getContext(o),i)),i}function $9(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=H9(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Kf(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?vl(t,e,a?a.children:null,r,i):vl(t,e,n,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new ma(a.outlet.component,o))}else o&&Cl(e,a,i),i.canActivateChecks.push(new Kf(r)),s.component?vl(t,null,a?a.children:null,r,i):vl(t,null,n,r,i);return i}function H9(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!ks(t.url,e.url);case"pathParamsOrQueryParamsChange":return!ks(t.url,e.url)||!vr(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!lv(t,e)||!vr(t.queryParams,e.queryParams);case"paramsChange":default:return!lv(t,e)}}function Cl(t,e,n){let r=pa(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Cl(o,e.children.getContext(s),n):Cl(o,null,n):Cl(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new ma(e.outlet.component,i)):n.canDeactivateChecks.push(new ma(null,i)):n.canDeactivateChecks.push(new ma(null,i))}function Fl(t){return typeof t=="function"}function q9(t){return typeof t=="boolean"}function G9(t){return t&&Fl(t.canLoad)}function z9(t){return t&&Fl(t.canActivate)}function W9(t){return t&&Fl(t.canActivateChild)}function K9(t){return t&&Fl(t.canDeactivate)}function Q9(t){return t&&Fl(t.canMatch)}function u1(t){return t instanceof Ur||t?.name==="EmptyError"}var Ff=Symbol("INITIAL_VALUE");function xa(){return Le(t=>Gc(t.map(e=>e.pipe($r(1),_s(Ff)))).pipe(j(e=>{for(let n of e)if(n!==!0){if(n===Ff)return Ff;if(n===!1||n instanceof Di)return n}return!0}),St(e=>e!==Ff),$r(1)))}function Y9(t,e){return Je(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?B(se(A({},n),{guardsResult:!0})):Z9(o,r,i,t).pipe(Je(a=>a&&q9(a)?X9(r,s,t,e):B(a)),j(a=>se(A({},n),{guardsResult:a})))})}function Z9(t,e,n,r){return xe(t).pipe(Je(i=>rB(i.component,i.route,n,e,r)),Sn(i=>i!==!0,!0))}function X9(t,e,n,r){return xe(e).pipe(ms(i=>jo(eB(i.route.parent,r),J9(i.route,r),nB(t,i.path,n),tB(t,i.route,n))),Sn(i=>i!==!0,!0))}function J9(t,e){return t!==null&&e&&e(new iv(t)),B(!0)}function eB(t,e){return t!==null&&e&&e(new nv(t)),B(!0)}function tB(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return B(!0);let i=r.map(s=>wh(()=>{let o=Ol(e)??n,a=wa(s,o),c=z9(a)?a.canActivate(e,t):zr(o,()=>a(e,t));return Mi(c).pipe(Sn())}));return B(i).pipe(xa())}function nB(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>U9(o)).filter(o=>o!==null).map(o=>wh(()=>{let a=o.guards.map(c=>{let l=Ol(o.node)??n,u=wa(c,l),d=W9(u)?u.canActivateChild(r,t):zr(l,()=>u(r,t));return Mi(d).pipe(Sn())});return B(a).pipe(xa())}));return B(s).pipe(xa())}function rB(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return B(!0);let o=s.map(a=>{let c=Ol(e)??i,l=wa(a,c),u=K9(l)?l.canDeactivate(t,e,n,r):zr(c,()=>l(t,e,n,r));return Mi(u).pipe(Sn())});return B(o).pipe(xa())}function iB(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return B(!0);let s=i.map(o=>{let a=wa(o,t),c=G9(a)?a.canLoad(e,n):zr(t,()=>a(e,n));return Mi(c)});return B(s).pipe(xa(),d1(r))}function d1(t){return y_(dt(e=>{if(ya(e))throw a1(t,e)}),j(e=>e===!0))}function sB(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return B(!0);let s=i.map(o=>{let a=wa(o,t),c=Q9(a)?a.canMatch(e,n):zr(t,()=>a(e,n));return Mi(c)});return B(s).pipe(xa(),d1(r))}var Nl=class{constructor(e){this.segmentGroup=e||null}},Qf=class extends Error{constructor(e){super(),this.urlTree=e}};function fa(t){return Lo(new Nl(t))}function oB(t){return Lo(new H(4e3,!1))}function aB(t){return Lo(c1(!1,_n.GuardRejected))}var hv=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return B(r);if(i.numberOfChildren>1||!i.children[ie])return oB(e.redirectTo);i=i.children[ie]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new Qf(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new Di(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new Ie(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new H(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},fv={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function cB(t,e,n,r,i){let s=wv(t,e,n);return s.matched?(r=V9(e,r),sB(r,e,n,i).pipe(j(o=>o===!0?s:A({},fv)))):B(s)}function wv(t,e,n){if(e.path==="**")return lB(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?A({},fv):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||s9)(n,t,e);if(!i)return A({},fv);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?A(A({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function lB(t){return{matched:!0,parameters:t.length>0?qA(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function BA(t,e,n,r){return n.length>0&&hB(t,n,r)?{segmentGroup:new Ie(e,dB(r,new Ie(n,t.children))),slicedSegments:[]}:n.length===0&&fB(t,n,r)?{segmentGroup:new Ie(t.segments,uB(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new Ie(t.segments,t.children),slicedSegments:n}}function uB(t,e,n,r){let i={};for(let s of n)if(Jf(t,e,s)&&!r[wr(s)]){let o=new Ie([],{});i[wr(s)]=o}return A(A({},r),i)}function dB(t,e){let n={};n[ie]=e;for(let r of t)if(r.path===""&&wr(r)!==ie){let i=new Ie([],{});n[wr(r)]=i}return n}function hB(t,e,n){return n.some(r=>Jf(t,e,r)&&wr(r)!==ie)}function fB(t,e,n){return n.some(r=>Jf(t,e,r))}function Jf(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function pB(t,e,n,r){return wr(t)!==r&&(r===ie||!Jf(e,n,t))?!1:wv(e,t,n).matched}function gB(t,e,n){return e.length===0&&!t.children[n]}var pv=class{};function mB(t,e,n,r,i,s,o="emptyOnly"){return new gv(t,e,n,r,i,o,s).recognize()}var _B=31,gv=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new hv(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new H(4002,`'${e.segmentGroup}'`)}recognize(){let e=BA(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(j(n=>{let r=new Al([],Object.freeze({}),Object.freeze(A({},this.urlTree.queryParams)),this.urlTree.fragment,{},ie,this.rootComponentType,null,{}),i=new mn(r,n),s=new Wf("",i),o=I9(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,ie).pipe(gi(r=>{if(r instanceof Qf)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Nl?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=_v(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(j(s=>s instanceof mn?[s]:[]))}processChildren(e,n,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return xe(i).pipe(ms(s=>{let o=r.children[s],a=L9(n,s);return this.processSegmentGroup(e,a,o,s)}),lr((s,o)=>(s.push(...o),s)),mi(null),T_(),Je(s=>{if(s===null)return fa(r);let o=h1(s);return yB(o),B(o)}))}processSegment(e,n,r,i,s,o){return xe(n).pipe(ms(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(gi(c=>{if(c instanceof Nl)return B(null);throw c}))),Sn(a=>!!a),gi(a=>{if(u1(a))return gB(r,i,s)?B(new pv):fa(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return pB(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):fa(i):fa(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:l,remainingSegments:u}=wv(n,i,s);if(!a)return fa(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>_B&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,d).pipe(Je(h=>this.processSegment(e,r,n,h.concat(u),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){let o=cB(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),o.pipe(Le(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Le(({routes:c})=>{let l=r._loadedInjector??e,{consumedSegments:u,remainingSegments:d,parameters:h}=a,f=new Al(u,h,Object.freeze(A({},this.urlTree.queryParams)),this.urlTree.fragment,xB(r),wr(r),r.component??r._loadedComponent??null,r,wB(r)),{segmentGroup:p,slicedSegments:m}=BA(n,u,d,c);if(m.length===0&&p.hasChildren())return this.processChildren(l,c,p).pipe(j(b=>b===null?null:new mn(f,b)));if(c.length===0&&m.length===0)return B(new mn(f,[]));let v=wr(r)===s;return this.processSegment(l,c,p,m,v?ie:s,!0).pipe(j(b=>new mn(f,b instanceof mn?[b]:[])))}))):fa(n)))}getChildConfig(e,n,r){return n.children?B({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?B({routes:n._loadedRoutes,injector:n._loadedInjector}):iB(e,n,r,this.urlSerializer).pipe(Je(i=>i?this.configLoader.loadChildren(e,n).pipe(dt(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):aB(n))):B({routes:[],injector:e})}};function yB(t){t.sort((e,n)=>e.value.outlet===ie?-1:n.value.outlet===ie?1:e.value.outlet.localeCompare(n.value.outlet))}function vB(t){let e=t.value.routeConfig;return e&&e.path===""}function h1(t){let e=[],n=new Set;for(let r of t){if(!vB(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=h1(r.children);e.push(new mn(r.value,i))}return e.filter(r=>!n.has(r))}function xB(t){return t.data||{}}function wB(t){return t.resolve||{}}function EB(t,e,n,r,i,s){return Je(o=>mB(t,e,n,r,o.extractedUrl,i,s).pipe(j(({state:a,tree:c})=>se(A({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function CB(t,e){return Je(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return B(n);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of f1(c))o.add(l);let a=0;return xe(o).pipe(ms(c=>s.has(c)?IB(c,r,t,e):(c.data=_v(c,c.parent,t).resolve,B(void 0))),dt(()=>a++),Uo(1),Je(c=>a===o.size?B(n):Ht))})}function f1(t){let e=t.children.map(n=>f1(n)).flat();return[t,...e]}function IB(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!s1(i)&&(s[Rl]=i.title),bB(s,t,e,r).pipe(j(o=>(t._resolvedData=o,t.data=_v(t,t.parent,n).resolve,null)))}function bB(t,e,n,r){let i=zy(t);if(i.length===0)return B({});let s={};return xe(i).pipe(Je(o=>DB(t[o],e,n,r).pipe(Sn(),dt(a=>{s[o]=a}))),Uo(1),D_(s),gi(o=>u1(o)?Ht:Lo(o)))}function DB(t,e,n,r){let i=Ol(e)??r,s=wa(t,i),o=s.resolve?s.resolve(e,n):zr(i,()=>s(e,n));return Mi(o)}function qy(t){return Le(e=>{let n=t(e);return n?xe(n).pipe(j(()=>e)):B(e)})}var p1=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===ie);return i}getResolvedTitleForRoute(r){return r.data[Rl]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(TB),providedIn:"root"});let t=e;return t})(),TB=(()=>{let e=class e extends p1{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(E(PA))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Vl=new O("",{providedIn:"root",factory:()=>({})}),Yf=new O(""),Ev=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=P(Af)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return B(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Mi(r.loadComponent()).pipe(j(g1),dt(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),Wc(()=>{this.componentLoaders.delete(r)})),s=new Po(i,()=>new He).pipe(Ro());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return B({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=SB(i,this.compiler,r,this.onLoadEndListener).pipe(Wc(()=>{this.childrenLoaders.delete(i)})),a=new Po(o,()=>new He).pipe(Ro());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function SB(t,e,n,r){return Mi(t.loadChildren()).pipe(j(g1),Je(i=>i instanceof ol||Array.isArray(i)?B(i):xe(e.compileModuleAsync(i))),j(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(Yf,[],{optional:!0,self:!0}).flat()),{routes:o.map(xv),injector:s}}))}function AB(t){return t&&typeof t=="object"&&"default"in t}function g1(t){return AB(t)?t.default:t}var Cv=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(MB),providedIn:"root"});let t=e;return t})(),MB=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),m1=new O(""),_1=new O("");function NB(t,e,n){let r=t.get(_1),i=t.get(dn);return t.get(fe).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,Promise.resolve();let s,o=new Promise(l=>{s=l}),a=i.startViewTransition(()=>(s(),RB(t))),{onViewTransitionCreated:c}=r;return c&&zr(t,()=>c({transition:a,from:e,to:n})),o})}function RB(t){return new Promise(e=>{fy(e,{injector:t})})}var Iv=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new He,this.transitionAbortSubject=new He,this.configLoader=P(Ev),this.environmentInjector=P(pn),this.urlSerializer=P(Pl),this.rootContexts=P(kl),this.location=P(la),this.inputBindingEnabled=P(Xf,{optional:!0})!==null,this.titleStrategy=P(p1),this.options=P(Vl,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=P(Cv),this.createViewTransition=P(m1,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>B(void 0),this.rootComponentType=null;let r=s=>this.events.next(new ev(s)),i=s=>this.events.next(new tv(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(se(A(A({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new Tt({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:El,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(St(o=>o.id!==0),j(o=>se(A({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Le(o=>{let a=!1,c=!1;return B(o).pipe(Le(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",_n.SupersededByNewNavigation),Ht;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?se(A({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let u=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=l.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!u&&d!=="reload"){let h="";return this.events.next(new Si(l.id,this.urlSerializer.serialize(l.rawUrl),h,$f.IgnoredSameUrlNavigation)),l.resolve(null),Ht}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return B(l).pipe(Le(h=>{let f=this.transitions?.getValue();return this.events.next(new va(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?Ht:Promise.resolve(h)}),EB(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),dt(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=se(A({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new Hf(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:h,extractedUrl:f,source:p,restoredState:m,extras:v}=l,b=new va(h,this.urlSerializer.serialize(f),p,m);this.events.next(b);let F=r1(this.rootComponentType).snapshot;return this.currentTransition=o=se(A({},l),{targetSnapshot:F,urlAfterRedirects:f,extras:se(A({},v),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,B(o)}else{let h="";return this.events.next(new Si(l.id,this.urlSerializer.serialize(l.extractedUrl),h,$f.IgnoredByUrlHandlingStrategy)),l.resolve(null),Ht}}),dt(l=>{let u=new Yy(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}),j(l=>(this.currentTransition=o=se(A({},l),{guards:B9(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),Y9(this.environmentInjector,l=>this.events.next(l)),dt(l=>{if(o.guardsResult=l.guardsResult,ya(l.guardsResult))throw a1(this.urlSerializer,l.guardsResult);let u=new Zy(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(u)}),St(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",_n.GuardRejected),!1)),qy(l=>{if(l.guards.canActivateChecks.length)return B(l).pipe(dt(u=>{let d=new Xy(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}),Le(u=>{let d=!1;return B(u).pipe(CB(this.paramsInheritanceStrategy,this.environmentInjector),dt({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(u,"",_n.NoDataFromResolver)}}))}),dt(u=>{let d=new Jy(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}))}),qy(l=>{let u=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(dt(f=>{d.component=f}),j(()=>{})));for(let f of d.children)h.push(...u(f));return h};return Gc(u(l.targetSnapshot.root)).pipe(mi(null),$r(1))}),qy(()=>this.afterPreactivation()),Le(()=>{let{currentSnapshot:l,targetSnapshot:u}=o,d=this.createViewTransition?.(this.environmentInjector,l.root,u.root);return d?xe(d).pipe(j(()=>o)):B(o)}),j(l=>{let u=R9(r.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=se(A({},l),{targetRouterState:u}),this.currentNavigation.targetRouterState=u,o}),dt(()=>{this.events.next(new Tl)}),j9(this.rootContexts,r.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),$r(1),dt({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new xr(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),M_(this.transitionAbortSubject.pipe(dt(l=>{throw l}))),Wc(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",_n.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),gi(l=>{if(c=!0,l1(l))this.events.next(new Ti(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),O9(l)?this.events.next(new Sl(l.url)):o.resolve(!1);else{this.events.next(new Dl(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(l))}catch(u){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(u)}}return Ht}))}))}cancelNavigationTransition(r,i,s){let o=new Ti(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function PB(t){return t!==El}var kB=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(OB),providedIn:"root"});let t=e;return t})(),mv=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},OB=(()=>{let e=class e extends mv{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Qr(e)))(s||e)}})(),e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),y1=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(FB),providedIn:"root"});let t=e;return t})(),FB=(()=>{let e=class e extends y1{constructor(){super(...arguments),this.location=P(la),this.urlSerializer=P(Pl),this.options=P(Vl,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=P(Cv),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Di,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=r1(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof va)this.stateMemento=this.createStateMemento();else if(r instanceof Si)this.rawUrlTree=i.initialUrl;else if(r instanceof Hf){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof Tl?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof Ti&&(r.code===_n.GuardRejected||r.code===_n.NoDataFromResolver)?this.restoreHistory(i):r instanceof Dl?this.restoreHistory(i,!0):r instanceof xr&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=A(A({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=A(A({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Qr(e)))(s||e)}})(),e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),xl=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(xl||{});function v1(t,e){t.events.pipe(St(n=>n instanceof xr||n instanceof Ti||n instanceof Dl||n instanceof Si),j(n=>n instanceof xr||n instanceof Si?xl.COMPLETE:(n instanceof Ti?n.code===_n.Redirect||n.code===_n.SupersededByNewNavigation:!1)?xl.REDIRECTING:xl.FAILED),St(n=>n!==xl.REDIRECTING),$r(1)).subscribe(()=>{e()})}function VB(t){throw t}var LB={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},jB={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Ai=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=P(bf),this.stateManager=P(y1),this.options=P(Vl,{optional:!0})||{},this.pendingTasks=P(If),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=P(Iv),this.urlSerializer=P(Pl),this.location=P(la),this.urlHandlingStrategy=P(Cv),this._events=new He,this.errorHandler=this.options.errorHandler||VB,this.navigated=!1,this.routeReuseStrategy=P(kB),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=P(Yf,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!P(Xf,{optional:!0}),this.eventsSubscription=new We,this.isNgZoneEnabled=P(fe)instanceof fe&&fe.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Ti&&i.code!==_n.Redirect&&i.code!==_n.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof xr)this.navigated=!0;else if(i instanceof Sl){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||PB(s.source)};this.scheduleNavigation(a,El,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}UB(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),El,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let l=A({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(xv),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=i,u=l?this.currentUrlTree.fragment:a,d=null;switch(c){case"merge":d=A(A({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=s?s.snapshot:this.routerState.snapshot.root;h=JA(f)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),h=this.currentUrlTree.root}return e1(h,r,d,u??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=ya(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,El,null,i)}navigate(r,i={skipLocationChange:!1}){return BB(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=A({},LB):i===!1?s=A({},jB):s=i,ya(r))return OA(this.currentUrlTree,r,s);let o=this.parseUrl(r);return OA(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,u;a?(c=a.resolve,l=a.reject,u=a.promise):u=new Promise((h,f)=>{c=h,l=f});let d=this.pendingTasks.add();return v1(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:c,reject:l,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(h=>Promise.reject(h))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function BB(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new H(4008,!1)}function UB(t){return!(t instanceof Tl)&&!(t instanceof Sl)}var x1=(()=>{let e=class e{constructor(r,i,s,o,a,c){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new He,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=r.events.subscribe(u=>{u instanceof xr&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:uS(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(te(Ai),te(Os),Y0("tabindex"),te(mr),te(Zn),te(Zr))},e.\u0275dir=rt({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&me("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&hl("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[Pt.HasDecoratorInputTransform,"preserveFragment","preserveFragment",Ns],skipLocationChange:[Pt.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",Ns],replaceUrl:[Pt.HasDecoratorInputTransform,"replaceUrl","replaceUrl",Ns],routerLink:"routerLink"},standalone:!0,features:[gy,Ci]});let t=e;return t})();var Zf=class{};var $B=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(St(r=>r instanceof xr),ms(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=Cf(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return xe(s).pipe(pi())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=B(null);let o=s.pipe(Je(a=>a===null?B(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return xe([o,a]).pipe(pi())}else return o})}};e.\u0275fac=function(i){return new(i||e)(E(Ai),E(Af),E(pn),E(Zf),E(Ev))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),w1=new O(""),HB=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof va?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof xr?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof Si&&r.code===$f.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof qf&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new qf(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){CS()},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function qB(t){return t.routerState.root}function Ll(t,e){return{\u0275kind:t,\u0275providers:e}}function GB(){let t=P(Yn);return e=>{let n=t.get(ca);if(e!==n.components[0])return;let r=t.get(Ai),i=t.get(E1);t.get(bv)===1&&r.initialNavigation(),t.get(C1,null,le.Optional)?.setUpPreloading(),t.get(w1,null,le.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var E1=new O("",{factory:()=>new He}),bv=new O("",{providedIn:"root",factory:()=>1});function zB(){return Ll(2,[{provide:bv,useValue:0},{provide:Sf,multi:!0,deps:[Yn],useFactory:e=>{let n=e.get(yA,Promise.resolve());return()=>n.then(()=>new Promise(r=>{let i=e.get(Ai),s=e.get(E1);v1(i,()=>{r(!0)}),e.get(Iv).afterPreactivation=()=>(r(!0),s.closed?B(void 0):s),i.initialNavigation()}))}}])}function WB(){return Ll(3,[{provide:Sf,multi:!0,useFactory:()=>{let e=P(Ai);return()=>{e.setUpLocationChangeListener()}}},{provide:bv,useValue:2}])}var C1=new O("");function KB(t){return Ll(0,[{provide:C1,useExisting:$B},{provide:Zf,useExisting:t}])}function QB(){return Ll(8,[jA,{provide:Xf,useExisting:jA}])}function YB(t){let e=[{provide:m1,useValue:NB},{provide:_1,useValue:A({skipNextTransition:!!t?.skipInitialTransition},t)}];return Ll(9,e)}var UA=new O("ROUTER_FORROOT_GUARD"),ZB=[la,{provide:Pl,useClass:Il},Ai,kl,{provide:Os,useFactory:qB,deps:[Ai]},Ev,[]],Dv=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[ZB,[],{provide:Yf,multi:!0,useValue:r},{provide:UA,useFactory:tU,deps:[[Ai,new ra,new O0]]},{provide:Vl,useValue:i||{}},i?.useHash?JB():eU(),XB(),i?.preloadingStrategy?KB(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?nU(i):[],i?.bindToComponentInputs?QB().\u0275providers:[],i?.enableViewTransitions?YB().\u0275providers:[],rU()]}}static forChild(r){return{ngModule:e,providers:[{provide:Yf,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(E(UA,8))},e.\u0275mod=nt({type:e}),e.\u0275inj=tt({});let t=e;return t})();function XB(){return{provide:w1,useFactory:()=>{let t=P(CA),e=P(fe),n=P(Vl),r=P(Iv),i=P(Pl);return n.scrollOffset&&t.setOffset(n.scrollOffset),new HB(i,r,t,e,n)}}}function JB(){return{provide:Zr,useClass:xA}}function eU(){return{provide:Zr,useClass:Ny}}function tU(t){return"guarded"}function nU(t){return[t.initialNavigation==="disabled"?WB().\u0275providers:[],t.initialNavigation==="enabledBlocking"?zB().\u0275providers:[]]}var $A=new O("");function rU(){return[{provide:$A,useFactory:GB},{provide:vy,multi:!0,useExisting:$A}]}var Tv=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=sn({type:e,selectors:[["app-home"]],decls:20,vars:0,consts:[[1,"page"],[2,"text-align","center","margin-bottom","2rem"],[1,"row",2,"align-items","start"],[1,"column"]],template:function(i,s){i&1&&(x(0,"div",0)(1,"h1",1),S(2,"Evaluaci\xF3n Tercer Parcial"),I(),x(3,"h2",1),S(4,"Desarrollo Web Profesional"),I(),x(5,"div",2)(6,"div",3)(7,"h3"),S(8,"Integrantes:"),I(),x(9,"p"),S(10,"Diosdado Rodr\xEDguez Miguel \xC1ngel"),I(),x(11,"p"),S(12,"Hern\xE1ndez \xC1vila Fernanda Montserrat"),I(),x(13,"p"),S(14,"Pinz\xF3n Huerta Erick"),I()(),x(15,"div",3)(16,"h3"),S(17,"Descripci\xF3n:"),I(),x(18,"p"),S(19,"Aplicaci\xF3n Web de venta de coches con CRUD de clientes y coches hecha con Angular."),I()()()())}});let t=e;return t})();var Ea=class{constructor(e){this.id="",this.marca="",this.modelo="",this.precio=0,this.kilometros=0,this.vendido=!1,this.transmision="",this.transacciones=[],this.due\u00F1oActual="",this.marca=e.marca,this.modelo=e.modelo,this.precio=e.precio,this.kilometros=e.kilometros,this.vendido=e.vendido,this.transmision=e.transmision,this.due\u00F1oActual=e.due\u00F1oActual}};var Vt=function(t){return t[t.create=0]="create",t[t.select=1]="select",t}(Vt||{});function jl(t){return/^[a-zA-ZÀ-ÖØ-öø-ÿ]+(?:\s+[a-zA-ZÀ-ÖØ-öø-ÿ]+)*$/.test(t)}function Sv(t){return/^[1-9][0-9]*$/.test(t)}function I1(t){return/^\d{10}$/.test(t)}function b1(t){return/^[a-zA-Z0-9À-ÖØ-öø-ÿ]+(?:\s*[a-zA-Z0-9À-ÖØ-öø-ÿ]+)*$/.test(t)}function D1(t){return/^\S[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}\S$/.test(t)}var Fs=class{constructor(e){this.id="",this.fecha="",this.precio=0,this.metodoPago="",this.coche="",this.cliente="",this.tipo="",this.fecha=e.fecha,this.precio=e.precio,this.metodoPago=e.metodoPago,this.coche=e.coche,this.cliente=e.cliente,this.tipo=e.tipo}};var sU="firebase",oU="10.10.0";$n(sU,oU,"app");var Vs=new qr("ANGULARFIRE2_VERSION");var aU=(t,e)=>{let n=e?[e]:$b(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Xr=class{constructor(){return aU(cU)}},cU="app-check";function Av(){}var ep=class{zone;delegate;constructor(e,n=E_){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},Mv=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Av,{},Av,Av)),n.pipe(dt({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Ca=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new ep(Zone.current)),this.insideAngular=n.run(()=>new ep(Zone.current,gs)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(E(fe))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function lU(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function Ke(t){return uU(lU())(t)}function uU(t){return function(n){return n=n.lift(new Mv(t.ngZone)),n.pipe(qn(t.outsideAngular),Tn(t.insideAngular))}}var dU=new Map,hU={activated:!1,tokenObservers:[]},fU={initialized:!1,enabled:!1};function Xn(t){return dU.get(t)||Object.assign({},hU)}function P1(){return fU}var pU="https://content-firebaseappcheck.googleapis.com/v1";var gU="exchangeDebugToken",T1={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},ite=24*60*60*1e3;var Pv=class{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return g(this,null,function*(){this.stop();try{this.pending=new pt,this.pending.promise.catch(n=>{}),yield mU(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new pt,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function mU(t){return new Promise(e=>{setTimeout(e,t)})}var _U={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Ni=new Fb("appCheck","AppCheck",_U);function k1(t){if(!Xn(t).activated)throw Ni.create("use-before-activation",{appName:t.name})}function O1(r,i){return g(this,arguments,function*({url:t,body:e},n){let s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let f=yield o.getHeartbeatsHeader();f&&(s["X-Firebase-Client"]=f)}let a={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(t,a)}catch(f){throw Ni.create("fetch-network-error",{originalErrorMessage:f?.message})}if(c.status!==200)throw Ni.create("fetch-status-error",{httpStatus:c.status});let l;try{l=yield c.json()}catch(f){throw Ni.create("fetch-parse-error",{originalErrorMessage:f?.message})}let u=l.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw Ni.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let d=Number(u[1])*1e3,h=Date.now();return{token:l.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function F1(t,e){let{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${pU}/projects/${n}/apps/${r}:${gU}?key=${i}`,body:{debug_token:e}}}var yU="firebase-app-check-database",vU=1,kv="firebase-app-check-store";var tp=null;function xU(){return tp||(tp=new Promise((t,e)=>{try{let n=indexedDB.open(yU,vU);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var i;e(Ni.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(kv,{keyPath:"compositeKey"})}}}catch(n){e(Ni.create("storage-open",{originalErrorMessage:n?.message}))}}),tp)}function wU(t,e){return EU(CU(t),e)}function EU(t,e){return g(this,null,function*(){let r=(yield xU()).transaction(kv,"readwrite"),s=r.objectStore(kv).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},r.onerror=c=>{var l;a(Ni.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})})}function CU(t){return`${t.options.appId}-${t.name}`}var Ov=new fi("@firebase/app-check");function Rv(t,e){return Wd()?wU(t,e).catch(n=>{Ov.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function V1(){return P1().enabled}function L1(){return g(this,null,function*(){let t=P1();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var IU={error:"UNKNOWN_ERROR"};function bU(t){return Gd.encodeString(JSON.stringify(t),!1)}function Fv(t,e=!1){return g(this,null,function*(){let n=t.app;k1(n);let r=Xn(n),i=r.token,s;if(i&&!Bl(i)&&(r.token=void 0,i=void 0),!i){let c=yield r.cachedTokenPromise;c&&(Bl(c)?i=c:yield Rv(n,void 0))}if(!e&&i&&Bl(i))return{token:i.token};let o=!1;if(V1()){r.exchangeTokenPromise||(r.exchangeTokenPromise=O1(F1(n,yield L1()),t.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let c=yield r.exchangeTokenPromise;return yield Rv(n,c),r.token=c,{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield Xn(n).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?Ov.warn(c.message):Ov.error(c),s=c}let a;return i?s?Bl(i)?a={token:i.token,internalError:s}:a=A1(s):(a={token:i.token},r.token=i,yield Rv(n,i)):a=A1(s),o&&AU(n,a),a})}function DU(t){return g(this,null,function*(){let e=t.app;k1(e);let{provider:n}=Xn(e);if(V1()){let r=yield L1(),{token:i}=yield O1(F1(e,r),t.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield n.getToken();return{token:r}}})}function TU(t,e,n,r){let{app:i}=t,s=Xn(i),o={next:n,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Bl(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),S1(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>S1(t))}function j1(t,e){let n=Xn(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function S1(t){let{app:e}=t,n=Xn(e),r=n.tokenRefresher;r||(r=SU(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function SU(t){let{app:e}=t;return new Pv(()=>g(this,null,function*(){let n=Xn(e),r;if(n.token?r=yield Fv(t,!0):r=yield Fv(t),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=Xn(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,i=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},T1.RETRIAL_MIN_WAIT,T1.RETRIAL_MAX_WAIT)}function AU(t,e){let n=Xn(t).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Bl(t){return t.expireTimeMillis-Date.now()>0}function A1(t){return{token:bU(IU),error:t}}var Vv=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=Xn(this.app);for(let n of e)j1(this.app,n.next);return Promise.resolve()}};function MU(t,e){return new Vv(t,e)}function NU(t){return{getToken:e=>Fv(t,e),getLimitedUseToken:()=>DU(t),addTokenListener:e=>TU(t,"INTERNAL",e),removeTokenListener:e=>j1(t.app,e)}}var RU="@firebase/app-check",PU="0.8.3";var kU="app-check",M1="app-check-internal";function OU(){us(new fn(kU,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return MU(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(M1).initialize()})),us(new fn(M1,t=>{let e=t.getProvider("app-check").getImmediate();return NU(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),$n(RU,PU)}OU();var FU=["localhost","0.0.0.0","127.0.0.1"],mte=typeof window<"u"&&FU.includes(window.location.hostname);var VU="firebase",LU="10.10.0";bt.registerVersion(VU,LU,"app-compat");var jU=["ngOnDestroy"],U1=(t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(jU.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let c=a?.[s];return typeof c=="function"?c.bind(a):c?.then?c.then(l=>n.run(()=>l)):n.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>o[c],apply:(a,c,l)=>o.then(u=>{let d=u?.(...l);return r?.spy?.apply&&r.spy.apply(s,l,d),d})})})});var np=class{constructor(e){return e}},Ri=new O("angularfire2.app.options"),Pi=new O("angularfire2.app.name");function Ls(t,e,n){let r=typeof n=="string"&&n||"[DEFAULT]",i=typeof n=="object"&&n||{};i.name=i.name||r;let o=bt.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>bt.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let a=!!module.hot;BU("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new np(o)}var BU=(t,...e)=>{Ey()&&typeof console<"u"&&console[t](...e)},UU={provide:np,useFactory:Ls,deps:[Ri,fe,[new ra,Pi]]},$1=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:Ri,useValue:n},{provide:Pi,useValue:r}]}}constructor(n){bt.registerVersion("angularfire",Vs.full,"core"),bt.registerVersion("angularfire",Vs.full,"app-compat"),bt.registerVersion("angular",eA.full,n.toString())}static \u0275fac=function(r){return new(r||t)(E(Ot))};static \u0275mod=nt({type:t});static \u0275inj=tt({providers:[UU]})}return t})();function Ia(t,e,n,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return $U(i,o)||(B1("error",`${e} was already initialized on the ${n} Firebase App with different settings.${HU?" You may need to reload as Firebase is not HMR aware.":""}`),B1("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}function $U(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var HU=typeof module<"u"&&!!module.hot,B1=(t,...e)=>{Ey()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var Ul=new O("angularfire2.auth.use-emulator"),$l=new O("angularfire2.auth.settings"),Hl=new O("angularfire2.auth.tenant-id"),ql=new O("angularfire2.auth.langugage-code"),Gl=new O("angularfire2.auth.use-device-language"),zl=new O("angularfire.auth.persistence"),Wl=(t,e,n,r,i,s,o,a)=>Ia(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let c=e.runOutsideAngular(()=>t.auth());if(n&&c.useEmulator(...n),r&&(c.tenantId=r),c.languageCode=i,s&&c.useDeviceLanguage(),o)for(let[l,u]of Object.entries(o))c.settings[l]=u;return a&&c.setPersistence(a),c},[n,r,i,s,o,a]),rp=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,c,l,u,d,h,f){let p=new He,m=B(void 0).pipe(Tn(o.outsideAngular),Le(()=>s.runOutsideAngular(()=>import("./chunk-EA5I5XF3.js"))),j(()=>Ls(n,s,r)),j(v=>Wl(v,s,a,l,u,d,c,h)),Ch({bufferSize:1,refCount:!1}));if(Rs(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=B(null);else{m.pipe(Sn()).subscribe();let v=m.pipe(Le(T=>T.getRedirectResult().then(q=>q,()=>null)),Ke,Ch({bufferSize:1,refCount:!1})),b=m.pipe(Le(T=>new oe(q=>({unsubscribe:s.runOutsideAngular(()=>T.onAuthStateChanged(W=>q.next(W),W=>q.error(W),()=>q.complete()))})))),F=m.pipe(Le(T=>new oe(q=>({unsubscribe:s.runOutsideAngular(()=>T.onIdTokenChanged(W=>q.next(W),W=>q.error(W),()=>q.complete()))}))));this.authState=v.pipe(Ih(b),qn(o.outsideAngular),Tn(o.insideAngular)),this.user=v.pipe(Ih(F),qn(o.outsideAngular),Tn(o.insideAngular)),this.idToken=this.user.pipe(Le(T=>T?xe(T.getIdToken()):B(null))),this.idTokenResult=this.user.pipe(Le(T=>T?xe(T.getIdTokenResult()):B(null))),this.credential=Bo(v,p,this.authState.pipe(St(T=>!T))).pipe(j(T=>T?.user?T:null),qn(o.outsideAngular),Tn(o.insideAngular))}return U1(this,m,s,{spy:{apply:(v,b,F)=>{(v.startsWith("signIn")||v.startsWith("createUser"))&&F.then(T=>p.next(T))}}})}static \u0275fac=function(r){return new(r||t)(E(Ri),E(Pi,8),E(Ot),E(fe),E(Ca),E(Ul,8),E($l,8),E(Hl,8),E(ql,8),E(Gl,8),E(zl,8),E(Xr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var qU=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},er={},R,ox=ox||{},Y=qU||self;function _p(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function au(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function GU(t){return Object.prototype.hasOwnProperty.call(t,jv)&&t[jv]||(t[jv]=++zU)}var jv="closure_uid_"+(1e9*Math.random()>>>0),zU=0;function WU(t,e,n){return t.call.apply(t.bind,arguments)}function KU(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Lt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Lt=WU:Lt=KU,Lt.apply(null,arguments)}function ip(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function xt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function ki(){this.s=this.s,this.o=this.o}var QU=0;ki.prototype.s=!1;ki.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),QU!=0)&&GU(this)};ki.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var nM=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function ax(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function q1(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(_p(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function jt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}jt.prototype.h=function(){this.defaultPrevented=!0};var YU=function(){if(!Y.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};Y.addEventListener("test",n,e),Y.removeEventListener("test",n,e)}catch{}return t}();function Jl(t){return/^[\s\xa0]*$/.test(t)}function yp(){var t=Y.navigator;return t&&(t=t.userAgent)?t:""}function Er(t){return yp().indexOf(t)!=-1}function cx(t){return cx[" "](t),t}cx[" "]=function(){};function ZU(t,e){var n=j6;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var XU=Er("Opera"),Sa=Er("Trident")||Er("MSIE"),rM=Er("Edge"),qv=rM||Sa,iM=Er("Gecko")&&!(yp().toLowerCase().indexOf("webkit")!=-1&&!Er("Edge"))&&!(Er("Trident")||Er("MSIE"))&&!Er("Edge"),JU=yp().toLowerCase().indexOf("webkit")!=-1&&!Er("Edge");function sM(){var t=Y.document;return t?t.documentMode:void 0}var Gv;e:{if(sp="",op=function(){var t=yp();if(iM)return/rv:([^\);]+)(\)|;)/.exec(t);if(rM)return/Edge\/([\d\.]+)/.exec(t);if(Sa)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(JU)return/WebKit\/(\S+)/.exec(t);if(XU)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),op&&(sp=op?op[1]:""),Sa&&(ap=sM(),ap!=null&&ap>parseFloat(sp))){Gv=String(ap);break e}Gv=sp}var sp,op,ap,zv;Y.document&&Sa?(Bv=sM(),zv=Bv||parseInt(Gv,10)||void 0):zv=void 0;var Bv,e6=zv;function eu(t,e){if(jt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(iM){e:{try{cx(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:t6[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&eu.$.h.call(this)}}xt(eu,jt);var t6={2:"touch",3:"pen",4:"mouse"};eu.prototype.h=function(){eu.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var cu="closure_listenable_"+(1e6*Math.random()|0),n6=0;function r6(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++n6,this.fa=this.ia=!1}function vp(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function lx(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function i6(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function oM(t){let e={};for(let n in t)e[n]=t[n];return e}var G1="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function aM(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<G1.length;s++)n=G1[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function xp(t){this.src=t,this.g={},this.h=0}xp.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=Kv(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new r6(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function Wv(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=nM(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(vp(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Kv(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var ux="closure_lm_"+(1e6*Math.random()|0),Uv={};function cM(t,e,n,r,i){if(r&&r.once)return uM(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)cM(t,e[s],n,r,i);return null}return n=fx(n),t&&t[cu]?t.O(e,n,au(r)?!!r.capture:!!r,i):lM(t,e,n,!1,r,i)}function lM(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=au(i)?!!i.capture:!!i,a=hx(t);if(a||(t[ux]=a=new xp(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=s6(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)YU||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(hM(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function s6(){function t(n){return e.call(t.src,t.listener,n)}let e=o6;return t}function uM(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)uM(t,e[s],n,r,i);return null}return n=fx(n),t&&t[cu]?t.P(e,n,au(r)?!!r.capture:!!r,i):lM(t,e,n,!0,r,i)}function dM(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)dM(t,e[s],n,r,i);else r=au(r)?!!r.capture:!!r,n=fx(n),t&&t[cu]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=Kv(s,n,r,i),-1<n&&(vp(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=hx(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Kv(e,n,r,i)),(n=-1<t?e[t]:null)&&dx(n))}function dx(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[cu])Wv(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(hM(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=hx(e))?(Wv(n,t),n.h==0&&(n.src=null,e[ux]=null)):vp(t)}}}function hM(t){return t in Uv?Uv[t]:Uv[t]="on"+t}function o6(t,e){if(t.fa)t=!0;else{e=new eu(e,this);var n=t.listener,r=t.la||t.src;t.ia&&dx(t),t=n.call(r,e)}return t}function hx(t){return t=t[ux],t instanceof xp?t:null}var $v="__closure_events_fn_"+(1e9*Math.random()>>>0);function fx(t){return typeof t=="function"?t:(t[$v]||(t[$v]=function(e){return t.handleEvent(e)}),t[$v])}function vt(){ki.call(this),this.i=new xp(this),this.S=this,this.J=null}xt(vt,ki);vt.prototype[cu]=!0;vt.prototype.removeEventListener=function(t,e,n,r){dM(this,t,e,n,r)};function Nt(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new jt(e,t);else if(e instanceof jt)e.target=e.target||t;else{var i=e;e=new jt(r,t),aM(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=cp(o,r,!0,e)&&i}if(o=e.g=t,i=cp(o,r,!0,e)&&i,i=cp(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=cp(o,r,!1,e)&&i}vt.prototype.N=function(){if(vt.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)vp(n[r]);delete t.g[e],t.h--}}this.J=null};vt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};vt.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function cp(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&Wv(t.i,o),i=a.call(c,r)!==!1&&i}}return i&&!r.defaultPrevented}var px=Y.JSON.stringify,Qv=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function a6(){var t=gx;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Yv=class{constructor(){this.h=this.g=null}add(e,n){let r=fM.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},fM=new Qv(()=>new Zv,t=>t.reset()),Zv=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function c6(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function l6(t){Y.setTimeout(()=>{throw t},0)}var tu,nu=!1,gx=new Yv,pM=()=>{let t=Y.Promise.resolve(void 0);tu=()=>{t.then(u6)}},u6=()=>{for(var t;t=a6();){try{t.h.call(t.g)}catch(n){l6(n)}var e=fM;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}nu=!1};function wp(t,e){vt.call(this),this.h=t||1,this.g=e||Y,this.j=Lt(this.qb,this),this.l=Date.now()}xt(wp,vt);R=wp.prototype;R.ga=!1;R.T=null;R.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Nt(this,"tick"),this.ga&&(mx(this),this.start()))}};R.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function mx(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}R.N=function(){wp.$.N.call(this),mx(this),delete this.g};function _x(t,e,n){if(typeof t=="function")n&&(t=Lt(t,n));else if(t&&typeof t.handleEvent=="function")t=Lt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Y.setTimeout(t,e||0)}function gM(t){t.g=_x(()=>{t.g=null,t.i&&(t.i=!1,gM(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var Xv=class extends ki{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:gM(this)}N(){super.N(),this.g&&(Y.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function ru(t){ki.call(this),this.h=t,this.g={}}xt(ru,ki);var z1=[];function mM(t,e,n,r){Array.isArray(n)||(n&&(z1[0]=n.toString()),n=z1);for(var i=0;i<n.length;i++){var s=cM(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function _M(t){lx(t.g,function(e,n){this.g.hasOwnProperty(n)&&dx(e)},t),t.g={}}ru.prototype.N=function(){ru.$.N.call(this),_M(this)};ru.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Ep(){this.g=!0}Ep.prototype.Ea=function(){this.g=!1};function d6(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var d=u.split("_");o=2<=d.length&&d[1]=="type"?o+(u+"="+l+"&"):o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function h6(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function Da(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+p6(t,n)+(r?" "+r:"")})}function f6(t,e){t.info(function(){return"TIMEOUT: "+e})}Ep.prototype.info=function(){};function p6(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return px(n)}catch{return e}}var $s={},W1=null;function Cp(){return W1=W1||new vt}$s.Ta="serverreachability";function yM(t){jt.call(this,$s.Ta,t)}xt(yM,jt);function iu(t){let e=Cp();Nt(e,new yM(e))}$s.STAT_EVENT="statevent";function vM(t,e){jt.call(this,$s.STAT_EVENT,t),this.stat=e}xt(vM,jt);function Kt(t){let e=Cp();Nt(e,new vM(e,t))}$s.Ua="timingevent";function xM(t,e){jt.call(this,$s.Ua,t),this.size=e}xt(xM,jt);function lu(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return Y.setTimeout(function(){t()},e)}var Ip={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},wM={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function yx(){}yx.prototype.h=null;function K1(t){return t.h||(t.h=t.i())}function EM(){}var uu={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function vx(){jt.call(this,"d")}xt(vx,jt);function xx(){jt.call(this,"c")}xt(xx,jt);var Jv;function bp(){}xt(bp,yx);bp.prototype.g=function(){return new XMLHttpRequest};bp.prototype.i=function(){return{}};Jv=new bp;function du(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new ru(this),this.P=g6,t=qv?125:void 0,this.V=new wp(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new CM}function CM(){this.i=null,this.g="",this.h=!1}var g6=45e3,IM={},ex={};R=du.prototype;R.setTimeout=function(t){this.P=t};function tx(t,e,n){t.L=1,t.A=Tp(ei(e)),t.u=n,t.S=!0,bM(t,null)}function bM(t,e){t.G=Date.now(),hu(t),t.B=ei(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),PM(n.i,"t",r),t.o=0,n=t.l.J,t.h=new CM,t.g=eN(t.l,n?e:null,!t.u),0<t.O&&(t.M=new Xv(Lt(t.Pa,t,t.g),t.O)),mM(t.U,t.g,"readystatechange",t.nb),e=t.I?oM(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),iu(),d6(t.j,t.v,t.B,t.m,t.W,t.u)}R.nb=function(t){t=t.target;let e=this.M;e&&Cr(t)==3?e.l():this.Pa(t)};R.Pa=function(t){try{if(t==this.g)e:{let u=Cr(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>u)&&(u!=3||qv||this.g&&(this.h.h||this.g.ja()||X1(this.g)))){this.J||u!=4||e==7||(e==8||0>=d?iu(3):iu(2)),Dp(this);var n=this.g.da();this.ca=n;t:if(DM(this)){var r=X1(this.g);t="";var i=r.length,s=Cr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){js(this),Xl(this);var o="";break t}this.h.i=new Y.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,h6(this.j,this.v,this.B,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Jl(a)){var l=a;break t}}l=null}if(n=l)Da(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,nx(this,n);else{this.i=!1,this.s=3,Kt(12),js(this),Xl(this);break e}}this.S?(TM(this,u,o),qv&&this.i&&u==3&&(mM(this.U,this.V,"tick",this.mb),this.V.start())):(Da(this.j,this.m,o,null),nx(this,o)),u==4&&js(this),this.i&&!this.J&&(u==4?YM(this.l,this):(this.i=!1,hu(this)))}else F6(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,Kt(12)):(this.s=0,Kt(13)),js(this),Xl(this)}}}catch{}finally{}};function DM(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function TM(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=m6(t,n),i==ex){e==4&&(t.s=4,Kt(14),r=!1),Da(t.j,t.m,null,"[Incomplete Response]");break}else if(i==IM){t.s=4,Kt(15),Da(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Da(t.j,t.m,i,null),nx(t,i);DM(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,Kt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Dx(e),e.M=!0,Kt(11))):(Da(t.j,t.m,n,"[Invalid Chunked Response]"),js(t),Xl(t))}R.mb=function(){if(this.g){var t=Cr(this.g),e=this.g.ja();this.o<e.length&&(Dp(this),TM(this,t,e),this.i&&t!=4&&hu(this))}};function m6(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?ex:(n=Number(e.substring(n,r)),isNaN(n)?IM:(r+=1,r+n>e.length?ex:(e=e.slice(r,r+n),t.o=r+n,e)))}R.cancel=function(){this.J=!0,js(this)};function hu(t){t.Y=Date.now()+t.P,SM(t,t.P)}function SM(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=lu(Lt(t.lb,t),e)}function Dp(t){t.C&&(Y.clearTimeout(t.C),t.C=null)}R.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(f6(this.j,this.B),this.L!=2&&(iu(),Kt(17)),js(this),this.s=2,Xl(this)):SM(this,this.Y-t)};function Xl(t){t.l.H==0||t.J||YM(t.l,t)}function js(t){Dp(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,mx(t.V),_M(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function nx(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||rx(n.i,t))){if(!t.K&&rx(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)fp(n),Mp(n);else break e;bx(n),Kt(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=lu(Lt(n.ib,n),6e3));if(1>=FM(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Bs(n,11)}else if((t.K||n.g==t)&&fp(n),!Jl(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(n.V=l[0],l=l[1],n.H==2)if(l[0]=="c"){n.K=l[1],n.pa=l[2];let u=l[3];u!=null&&(n.ra=u,n.l.info("VER="+n.ra));let d=l[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let h=l[5];h!=null&&typeof h=="number"&&0<h&&(r=1.5*h,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let f=t.g;if(f){let p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=r.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(wx(s,s.h),s.h=null))}if(r.F){let m=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;m&&(r.Da=m,Fe(r.I,r.F,m))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=JM(r,r.J?r.pa:null,r.Y),o.K){VM(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.C&&(Dp(a),hu(a)),r.g=o}else KM(r);0<n.j.length&&Np(n)}else l[0]!="stop"&&l[0]!="close"||Bs(n,7);else n.H==3&&(l[0]=="stop"||l[0]=="close"?l[0]=="stop"?Bs(n,7):Ix(n):l[0]!="noop"&&n.h&&n.h.Aa(l),n.A=0)}}iu(4)}catch{}}function _6(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(_p(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function y6(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(_p(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function AM(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(_p(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=y6(t),r=_6(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var MM=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function v6(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Us(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Us){this.h=t.h,dp(this,t.j),this.s=t.s,this.g=t.g,hp(this,t.m),this.l=t.l;var e=t.i,n=new su;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Q1(this,n),this.o=t.o}else t&&(e=String(t).match(MM))?(this.h=!1,dp(this,e[1]||"",!0),this.s=Yl(e[2]||""),this.g=Yl(e[3]||"",!0),hp(this,e[4]),this.l=Yl(e[5]||"",!0),Q1(this,e[6]||"",!0),this.o=Yl(e[7]||"")):(this.h=!1,this.i=new su(null,this.h))}Us.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Zl(e,Y1,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Zl(e,Y1,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Zl(n,n.charAt(0)=="/"?E6:w6,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Zl(n,I6)),t.join("")};function ei(t){return new Us(t)}function dp(t,e,n){t.j=n?Yl(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function hp(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Q1(t,e,n){e instanceof su?(t.i=e,b6(t.i,t.h)):(n||(e=Zl(e,C6)),t.i=new su(e,t.h))}function Fe(t,e,n){t.i.set(e,n)}function Tp(t){return Fe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Yl(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Zl(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,x6),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function x6(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Y1=/[#\/\?@]/g,w6=/[#\?:]/g,E6=/[#\?]/g,C6=/[#\?@]/g,I6=/#/g;function su(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Oi(t){t.g||(t.g=new Map,t.h=0,t.i&&v6(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}R=su.prototype;R.add=function(t,e){Oi(this),this.i=null,t=Aa(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function NM(t,e){Oi(t),e=Aa(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function RM(t,e){return Oi(t),e=Aa(t,e),t.g.has(e)}R.forEach=function(t,e){Oi(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};R.ta=function(){Oi(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};R.Z=function(t){Oi(this);let e=[];if(typeof t=="string")RM(this,t)&&(e=e.concat(this.g.get(Aa(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};R.set=function(t,e){return Oi(this),this.i=null,t=Aa(this,t),RM(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};R.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function PM(t,e,n){NM(t,e),0<n.length&&(t.i=null,t.g.set(Aa(t,e),ax(n)),t.h+=n.length)}R.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function Aa(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function b6(t,e){e&&!t.j&&(Oi(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(NM(this,r),PM(this,i,n))},t)),t.j=e}var D6=class{constructor(t,e){this.g=t,this.map=e}};function kM(t){this.l=t||T6,Y.PerformanceNavigationTiming?(t=Y.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(Y.g&&Y.g.Ka&&Y.g.Ka()&&Y.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var T6=10;function OM(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function FM(t){return t.h?1:t.g?t.g.size:0}function rx(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function wx(t,e){t.g?t.g.add(e):t.h=e}function VM(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}kM.prototype.cancel=function(){if(this.i=LM(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function LM(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return ax(t.i)}var S6=class{stringify(t){return Y.JSON.stringify(t,void 0)}parse(t){return Y.JSON.parse(t,void 0)}};function A6(){this.g=new S6}function M6(t,e,n){let r=n||"";try{AM(t,function(i,s){let o=i;au(i)&&(o=px(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function N6(t,e){let n=new Ep;if(Y.Image){let r=new Image;r.onload=ip(lp,n,r,"TestLoadImage: loaded",!0,e),r.onerror=ip(lp,n,r,"TestLoadImage: error",!1,e),r.onabort=ip(lp,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=ip(lp,n,r,"TestLoadImage: timeout",!1,e),Y.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function lp(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function fu(t){this.l=t.ec||null,this.j=t.ob||!1}xt(fu,yx);fu.prototype.g=function(){return new Sp(this.l,this.j)};fu.prototype.i=function(t){return function(){return t}}({});function Sp(t,e){vt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Ex,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}xt(Sp,vt);var Ex=0;R=Sp.prototype;R.open=function(t,e){if(this.readyState!=Ex)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,ou(this)};R.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Y).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};R.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,pu(this)),this.readyState=Ex};R.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,ou(this)),this.g&&(this.readyState=3,ou(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Y.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;jM(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function jM(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}R.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?pu(this):ou(this),this.readyState==3&&jM(this)}};R.Za=function(t){this.g&&(this.response=this.responseText=t,pu(this))};R.Ya=function(t){this.g&&(this.response=t,pu(this))};R.ka=function(){this.g&&pu(this)};function pu(t){t.readyState=4,t.l=null,t.j=null,t.A=null,ou(t)}R.setRequestHeader=function(t,e){this.v.append(t,e)};R.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};R.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function ou(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Sp.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var R6=Y.JSON.parse;function qe(t){vt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=BM,this.L=this.M=!1}xt(qe,vt);var BM="",P6=/^https?$/i,k6=["POST","PUT"];R=qe.prototype;R.Oa=function(t){this.M=t};R.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Jv.g(),this.C=this.u?K1(this.u):K1(Jv),this.g.onreadystatechange=Lt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){Z1(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=Y.FormData&&t instanceof Y.FormData,!(0<=nM(k6,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{HM(this),0<this.B&&((this.L=O6(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Lt(this.ua,this)):this.A=_x(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){Z1(this,s)}};function O6(t){return Sa&&typeof t.timeout=="number"&&t.ontimeout!==void 0}R.ua=function(){typeof ox<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Nt(this,"timeout"),this.abort(8))};function Z1(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,UM(t),Ap(t)}function UM(t){t.F||(t.F=!0,Nt(t,"complete"),Nt(t,"error"))}R.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Nt(this,"complete"),Nt(this,"abort"),Ap(this))};R.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ap(this,!0)),qe.$.N.call(this)};R.La=function(){this.s||(this.G||this.v||this.l?$M(this):this.kb())};R.kb=function(){$M(this)};function $M(t){if(t.h&&typeof ox<"u"&&(!t.C[1]||Cr(t)!=4||t.da()!=2)){if(t.v&&Cr(t)==4)_x(t.La,0,t);else if(Nt(t,"readystatechange"),Cr(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(MM)[1]||null;!i&&Y.self&&Y.self.location&&(i=Y.self.location.protocol.slice(0,-1)),r=!P6.test(i?i.toLowerCase():"")}n=r}if(n)Nt(t,"complete"),Nt(t,"success");else{t.m=6;try{var s=2<Cr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",UM(t)}}finally{Ap(t)}}}}function Ap(t,e){if(t.g){HM(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Nt(t,"ready");try{n.onreadystatechange=r}catch{}}}function HM(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Y.clearTimeout(t.A),t.A=null)}R.isActive=function(){return!!this.g};function Cr(t){return t.g?t.g.readyState:0}R.da=function(){try{return 2<Cr(this)?this.g.status:-1}catch{return-1}};R.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};R.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),R6(e)}};function X1(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case BM:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function F6(t){let e={};t=(t.g&&2<=Cr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(Jl(t[r]))continue;var n=c6(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}i6(e,function(r){return r.join(", ")})}R.Ia=function(){return this.m};R.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function qM(t){let e="";return lx(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function Cx(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=qM(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Fe(t,e,n))}function Kl(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function GM(t){this.Ga=0,this.j=[],this.l=new Ep,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Kl("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Kl("baseRetryDelayMs",5e3,t),this.hb=Kl("retryDelaySeedMs",1e4,t),this.eb=Kl("forwardChannelMaxRetries",2,t),this.xa=Kl("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new kM(t&&t.concurrentRequestLimit),this.Ja=new A6,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}R=GM.prototype;R.ra=8;R.H=1;function Ix(t){if(zM(t),t.H==3){var e=t.W++,n=ei(t.I);if(Fe(n,"SID",t.K),Fe(n,"RID",e),Fe(n,"TYPE","terminate"),gu(t,n),e=new du(t,t.l,e),e.L=2,e.A=Tp(ei(n)),n=!1,Y.navigator&&Y.navigator.sendBeacon)try{n=Y.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&Y.Image&&(new Image().src=e.A,n=!0),n||(e.g=eN(e.l,null),e.g.ha(e.A)),e.G=Date.now(),hu(e)}XM(t)}function Mp(t){t.g&&(Dx(t),t.g.cancel(),t.g=null)}function zM(t){Mp(t),t.u&&(Y.clearTimeout(t.u),t.u=null),fp(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&Y.clearTimeout(t.m),t.m=null)}function Np(t){if(!OM(t.i)&&!t.m){t.m=!0;var e=t.Na;tu||pM(),nu||(tu(),nu=!0),gx.add(e,t),t.C=0}}function V6(t,e){return FM(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=lu(Lt(t.Na,t,e),ZM(t,t.C)),t.C++,!0)}R.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new du(this,this.l,t),s=this.s;if(this.U&&(s?(s=oM(s),aM(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=WM(this,i,e),n=ei(this.I),Fe(n,"RID",t),Fe(n,"CVER",22),this.F&&Fe(n,"X-HTTP-Session-Id",this.F),gu(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(qM(s)))+"&"+e:this.o&&Cx(n,this.o,s)),wx(this.i,i),this.bb&&Fe(n,"TYPE","init"),this.P?(Fe(n,"$req",e),Fe(n,"SID","null"),i.aa=!0,tx(i,n,null)):tx(i,n,e),this.H=2}}else this.H==3&&(t?J1(this,t):this.j.length==0||OM(this.i)||J1(this))};function J1(t,e){var n;e?n=e.m:n=t.W++;let r=ei(t.I);Fe(r,"SID",t.K),Fe(r,"RID",n),Fe(r,"AID",t.V),gu(t,r),t.o&&t.s&&Cx(r,t.o,t.s),n=new du(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=WM(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),wx(t.i,n),tx(n,r,e)}function gu(t,e){t.na&&lx(t.na,function(n,r){Fe(e,r,n)}),t.h&&AM({},function(n,r){Fe(e,r,n)})}function WM(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Lt(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<n;c++){let l=i[c].g,u=i[c].map;if(l-=s,0>l)s=Math.max(0,i[c].g-100),a=!1;else try{M6(u,o,"req"+l+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function KM(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;tu||pM(),nu||(tu(),nu=!0),gx.add(e,t),t.A=0}}function bx(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=lu(Lt(t.Ma,t),ZM(t,t.A)),t.A++,!0)}R.Ma=function(){if(this.u=null,QM(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=lu(Lt(this.jb,this),t)}};R.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Kt(10),Mp(this),QM(this))};function Dx(t){t.B!=null&&(Y.clearTimeout(t.B),t.B=null)}function QM(t){t.g=new du(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=ei(t.wa);Fe(e,"RID","rpc"),Fe(e,"SID",t.K),Fe(e,"AID",t.V),Fe(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Fe(e,"TO",t.qa),Fe(e,"TYPE","xmlhttp"),gu(t,e),t.o&&t.s&&Cx(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=Tp(ei(e)),n.u=null,n.S=!0,bM(n,t)}R.ib=function(){this.v!=null&&(this.v=null,Mp(this),bx(this),Kt(19))};function fp(t){t.v!=null&&(Y.clearTimeout(t.v),t.v=null)}function YM(t,e){var n=null;if(t.g==e){fp(t),Dx(t),t.g=null;var r=2}else if(rx(t.i,e))n=e.F,VM(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=Cp(),Nt(r,new xM(r,n)),Np(t)}else KM(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&V6(t,e)||r==2&&bx(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Bs(t,5);break;case 4:Bs(t,10);break;case 3:Bs(t,6);break;default:Bs(t,2)}}}function ZM(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Bs(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Lt(t.pb,t);n||(n=new Us("//www.google.com/images/cleardot.gif"),Y.location&&Y.location.protocol=="http"||dp(n,"https"),Tp(n)),N6(n.toString(),r)}else Kt(2);t.H=0,t.h&&t.h.za(e),XM(t),zM(t)}R.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Kt(2)):(this.l.info("Failed to ping google.com"),Kt(1))};function XM(t){if(t.H=0,t.ma=[],t.h){let e=LM(t.i);(e.length!=0||t.j.length!=0)&&(q1(t.ma,e),q1(t.ma,t.j),t.i.i.length=0,ax(t.j),t.j.length=0),t.h.ya()}}function JM(t,e,n){var r=n instanceof Us?ei(n):new Us(n);if(r.g!="")e&&(r.g=e+"."+r.g),hp(r,r.m);else{var i=Y.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Us(null);r&&dp(s,r),e&&(s.g=e),i&&hp(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&Fe(r,n,e),Fe(r,"VER",t.ra),gu(t,r),r}function eN(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new qe(new fu({ob:n})):new qe(t.va),e.Oa(t.J),e}R.isActive=function(){return!!this.h&&this.h.isActive(this)};function tN(){}R=tN.prototype;R.Ba=function(){};R.Aa=function(){};R.za=function(){};R.ya=function(){};R.isActive=function(){return!0};R.Va=function(){};function pp(){if(Sa&&!(10<=Number(e6)))throw Error("Environmental error: no available transport.")}pp.prototype.g=function(t,e){return new yn(t,e)};function yn(t,e){vt.call(this),this.g=new GM(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Jl(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Jl(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Ma(this)}xt(yn,vt);yn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Kt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=JM(t,null,t.Y),Np(t)};yn.prototype.close=function(){Ix(this.g)};yn.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=px(t),t=n);e.j.push(new D6(e.fb++,t)),e.H==3&&Np(e)};yn.prototype.N=function(){this.g.h=null,delete this.j,Ix(this.g),delete this.g,yn.$.N.call(this)};function nN(t){vx.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}xt(nN,vx);function rN(){xx.call(this),this.status=1}xt(rN,xx);function Ma(t){this.g=t}xt(Ma,tN);Ma.prototype.Ba=function(){Nt(this.g,"a")};Ma.prototype.Aa=function(t){Nt(this.g,new nN(t))};Ma.prototype.za=function(t){Nt(this.g,new rN)};Ma.prototype.ya=function(){Nt(this.g,"b")};function L6(){this.blockSize=-1}function Jn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}xt(Jn,L6);Jn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Hv(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}Jn.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)Hv(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){Hv(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){Hv(this,r),i=0;break}}this.h=i,this.i+=e};Jn.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function be(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var j6={};function Tx(t){return-128<=t&&128>t?ZU(t,function(e){return new be([e|0],0>e?-1:0)}):new be([t|0],0>t?-1:0)}function Ir(t){if(isNaN(t)||!isFinite(t))return Ta;if(0>t)return Mt(Ir(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=ix;return new be(e,0)}function iN(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Mt(iN(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Ir(Math.pow(e,8)),r=Ta,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=Ir(Math.pow(e,s)),r=r.R(s).add(Ir(o))):(r=r.R(n),r=r.add(Ir(o)))}return r}var ix=4294967296,Ta=Tx(0),sx=Tx(1),eM=Tx(16777216);R=be.prototype;R.ea=function(){if(kn(this))return-Mt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:ix+r)*e,e*=ix}return t};R.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Jr(this))return"0";if(kn(this))return"-"+Mt(this).toString(t);for(var e=Ir(Math.pow(t,6)),n=this,r="";;){var i=mp(n,e).g;n=gp(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Jr(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};R.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Jr(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function kn(t){return t.h==-1}R.X=function(t){return t=gp(this,t),kn(t)?-1:Jr(t)?0:1};function Mt(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new be(n,~t.h).add(sx)}R.abs=function(){return kn(this)?Mt(this):this};R.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new be(n,n[n.length-1]&-2147483648?-1:0)};function gp(t,e){return t.add(Mt(e))}R.R=function(t){if(Jr(this)||Jr(t))return Ta;if(kn(this))return kn(t)?Mt(this).R(Mt(t)):Mt(Mt(this).R(t));if(kn(t))return Mt(this.R(Mt(t)));if(0>this.X(eM)&&0>t.X(eM))return Ir(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,c=t.D(i)&65535;n[2*r+2*i]+=o*c,up(n,2*r+2*i),n[2*r+2*i+1]+=s*c,up(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,up(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,up(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new be(n,0)};function up(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Ql(t,e){this.g=t,this.h=e}function mp(t,e){if(Jr(e))throw Error("division by zero");if(Jr(t))return new Ql(Ta,Ta);if(kn(t))return e=mp(Mt(t),e),new Ql(Mt(e.g),Mt(e.h));if(kn(e))return e=mp(t,Mt(e)),new Ql(Mt(e.g),e.h);if(30<t.g.length){if(kn(t)||kn(e))throw Error("slowDivide_ only works with positive integers.");for(var n=sx,r=e;0>=r.X(t);)n=tM(n),r=tM(r);var i=ba(n,1),s=ba(r,1);for(r=ba(r,2),n=ba(n,2);!Jr(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=ba(r,1),n=ba(n,1)}return e=gp(t,i.R(e)),new Ql(i,e)}for(i=Ta;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Ir(n),o=s.R(e);kn(o)||0<o.X(t);)n-=r,s=Ir(n),o=s.R(e);Jr(s)&&(s=sx),i=i.add(s),t=gp(t,o)}return new Ql(i,t)}R.gb=function(t){return mp(this,t).h};R.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new be(n,this.h&t.h)};R.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new be(n,this.h|t.h)};R.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new be(n,this.h^t.h)};function tM(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new be(n,t.h)}function ba(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new be(i,t.h)}pp.prototype.createWebChannel=pp.prototype.g;yn.prototype.send=yn.prototype.u;yn.prototype.open=yn.prototype.m;yn.prototype.close=yn.prototype.close;Ip.NO_ERROR=0;Ip.TIMEOUT=8;Ip.HTTP_ERROR=6;wM.COMPLETE="complete";EM.EventType=uu;uu.OPEN="a";uu.CLOSE="b";uu.ERROR="c";uu.MESSAGE="d";vt.prototype.listen=vt.prototype.O;qe.prototype.listenOnce=qe.prototype.P;qe.prototype.getLastError=qe.prototype.Sa;qe.prototype.getLastErrorCode=qe.prototype.Ia;qe.prototype.getStatus=qe.prototype.da;qe.prototype.getResponseJson=qe.prototype.Wa;qe.prototype.getResponseText=qe.prototype.ja;qe.prototype.send=qe.prototype.ha;qe.prototype.setWithCredentials=qe.prototype.Oa;Jn.prototype.digest=Jn.prototype.l;Jn.prototype.reset=Jn.prototype.reset;Jn.prototype.update=Jn.prototype.j;be.prototype.add=be.prototype.add;be.prototype.multiply=be.prototype.R;be.prototype.modulo=be.prototype.gb;be.prototype.compare=be.prototype.X;be.prototype.toNumber=be.prototype.ea;be.prototype.toString=be.prototype.toString;be.prototype.getBits=be.prototype.D;be.fromNumber=Ir;be.fromString=iN;var sN=er.createWebChannelTransport=function(){return new pp},oN=er.getStatEventTarget=function(){return Cp()},Rp=er.ErrorCode=Ip,aN=er.EventType=wM,cN=er.Event=$s,Sx=er.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Ute=er.FetchXmlHttpFactory=fu,mu=er.WebChannel=EM,lN=er.XhrIo=qe,uN=er.Md5=Jn,Hs=er.Integer=be;var dN="@firebase/firestore";var at=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};at.UNAUTHENTICATED=new at(null),at.GOOGLE_CREDENTIALS=new at("google-credentials-uid"),at.FIRST_PARTY=new at("first-party-uid"),at.MOCK_USER=new at("mock-user");var ac="10.10.0";var $i=new fi("@firebase/firestore");function Oa(){return $i.logLevel}function dR(t){$i.setLogLevel(t)}function C(t,...e){if($i.logLevel<=Dn.DEBUG){let n=e.map(NE);$i.debug(`Firestore (${ac}): ${t}`,...n)}}function Qe(t,...e){if($i.logLevel<=Dn.ERROR){let n=e.map(NE);$i.error(`Firestore (${ac}): ${t}`,...n)}}function Fn(t,...e){if($i.logLevel<=Dn.WARN){let n=e.map(NE);$i.warn(`Firestore (${ac}): ${t}`,...n)}}function NE(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function k(t="Unexpected state"){let e=`FIRESTORE (${ac}) INTERNAL ASSERTION FAILED: `+t;throw Qe(e),new Error(e)}function L(t,e){t||k()}function hR(t,e){t||k()}function N(t,e){return t}var y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},w=class extends Ob{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ct=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var Hp=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Px=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(at.UNAUTHENTICATED))}shutdown(){}},kx=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},Ox=class{constructor(e){this.t=e,this.currentUser=at.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve(),s=new ct;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ct,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>g(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{C("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(C("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ct)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(C("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(L(typeof r.accessToken=="string"),new Hp(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return L(e===null||typeof e=="string"),new at(e)}},Fx=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=at.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Vx=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new Fx(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(at.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Lx=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},jx=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&C("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,C("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{C("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):C("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(L(typeof n.token=="string"),this.R=n.token,new Lx(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function U6(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var qp=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=U6(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function J(t,e){return t<e?-1:t>e?1:0}function qa(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function fR(t){return t+"\0"}var Ue=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new w(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new w(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new w(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new w(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?J(this.nanoseconds,e.nanoseconds):J(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var $=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new Ue(0,0))}static max(){return new t(new Ue(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Gp=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&k(),r===void 0?r=e.length-n:r>e.length-n&&k(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},ye=class t extends Gp{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new w(y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},$6=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ye=class t extends Gp{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return $6.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new w(y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new w(y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new w(y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new w(y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var M=class t{constructor(e){this.path=e}static fromPath(e){return new t(ye.fromString(e))}static fromName(e){return new t(ye.fromString(e).popFirst(5))}static empty(){return new t(ye.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ye.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ye.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new ye(e.slice()))}};var Ga=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};function Bx(t){return t.fields.find(e=>e.kind===2)}function Gs(t){return t.fields.filter(e=>e.kind!==2)}Ga.UNKNOWN_ID=-1;var Ua=class{constructor(e,n){this.fieldPath=e,this.kind=n}};var Su=class t{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new t(0,Vn.min())}};function pR(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=$.fromTimestamp(r===1e9?new Ue(n+1,0):new Ue(n,r));return new Vn(i,M.empty(),e)}function gR(t){return new Vn(t.readTime,t.key,-1)}var Vn=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t($.min(),M.empty(),-1)}static max(){return new t($.max(),M.empty(),-1)}};function RE(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=M.comparator(t.documentKey,e.documentKey),n!==0?n:J(t.largestBatchId,e.largestBatchId))}var mR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",zp=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Xi(t){return g(this,null,function*(){if(t.code!==y.FAILED_PRECONDITION||t.message!==mR)throw t;C("LocalStore","Unexpectedly lost primary lease")})}var _=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&k(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;n(e[l]).next(u=>{o[l]=u,++a,a===s&&r(o)},u=>i(u))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};var Wp=class t{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new ct,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Zs(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=PE(r.target.error);this.V.reject(new Zs(e,i))}}static open(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(s){throw new Zs(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(C("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let n=this.transaction.objectStore(e);return new $x(n)}},ri=class t{constructor(e,n,r){this.name=e,this.version=n,this.p=r,t.S(Bc())===12.2&&Qe("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return C("SimpleDb","Removing database:",e),zs(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Wd())return!1;if(t.C())return!0;let e=Bc(),n=t.S(e),r=0<n&&n<10,i=t.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,n){return e.store(n)}static S(e){let n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){let n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){return g(this,null,function*(){return this.db||(C("SimpleDb","Opening database:",this.name),this.db=yield new Promise((n,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;n(o)},i.onblocked=()=>{r(new Zs(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new w(y.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new w(y.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Zs(e,o))},i.onupgradeneeded=s=>{C("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.N(o,i.transaction,s.oldVersion,this.version).next(()=>{C("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.L&&(this.db.onversionchange=n=>this.L(n)),this.db})}B(e){this.L=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){return g(this,null,function*(){let s=n==="readonly",o=0;for(;;){++o;try{this.db=yield this.O(e);let a=Wp.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),_.reject(l))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&o<3;if(C("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}},Ux=class{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return zs(this.k.delete())}},Zs=class extends w{constructor(e,n){super(y.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}};function Ji(t){return t.name==="IndexedDbTransactionError"}var $x=class{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(C("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(C("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),zs(r)}add(e){return C("SimpleDb","ADD",this.store.name,e,e),zs(this.store.add(e))}get(e){return zs(this.store.get(e)).next(n=>(n===void 0&&(n=null),C("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return C("SimpleDb","DELETE",this.store.name,e),zs(this.store.delete(e))}count(){return C("SimpleDb","COUNT",this.store.name),zs(this.store.count())}W(e,n){let r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new _((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.G(s,(a,c)=>{o.push(c)}).next(()=>o)}}j(e,n){let r=this.store.getAll(e,n===null?void 0:n);return new _((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,n){C("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,n);r.J=!1;let i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,n){let r;n?r=e:(r={},n=e);let i=this.cursor(r);return this.G(i,n)}Z(e){let n=this.cursor({});return new _((r,i)=>{n.onerror=s=>{let o=PE(s.target.error);i(o)},n.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){let r=[];return new _((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new Ux(a),l=n(a.primaryKey,a.value,c);if(l instanceof _){let u=l.catch(d=>(c.done(),_.reject(d)));r.push(u)}c.isDone?i():c.$===null?a.continue():a.continue(c.$)}}).next(()=>_.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){let r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}};function zs(t){return new _((e,n)=>{t.onsuccess=r=>{let i=r.target.result;e(i)},t.onerror=r=>{let i=PE(r.target.error);n(i)}})}var hN=!1;function PE(t){let e=ri.S(Bc());if(e>=12.2&&e<13){let n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){let r=new w("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return hN||(hN=!0,setTimeout(()=>{throw r},0)),r}}return t}var Hx=class{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){C("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>g(this,null,function*(){this.task=null;try{C("IndexBackfiller",`Documents written: ${yield this.X.te()}`)}catch(n){Ji(n)?C("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):yield Xi(n)}yield this.ee(6e4)}))}},qx=class{constructor(e,n){this.localStore=e,this.persistence=n}te(e=50){return g(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.ne(n,e))})}ne(e,n){let r=new Set,i=n,s=!0;return _.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return C("IndexBackfiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(C("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{let o=gR(s);RE(o,r)>0&&(r=o)}),new Vn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}};var vn=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function Yu(t){return t==null}function Au(t){return t===0&&1/t==-1/0}function _R(t){return typeof t=="number"&&Number.isInteger(t)&&!Au(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Qt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=fN(e)),e=H6(t.get(n),e);return fN(e)}function H6(t,e){let n=e,r=t.length;for(let i=0;i<r;i++){let s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function fN(t){return t+""}function br(t){let e=t.length;if(L(e>=2),e===2)return L(t.charAt(0)===""&&t.charAt(1)===""),ye.emptyPath();let n=e-2,r=[],i="";for(let s=0;s<e;){let o=t.indexOf("",s);switch((o<0||o>n)&&k(),t.charAt(o+1)){case"":let a=t.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:k()}s=o+2}return new ye(r)}var pN=["userId","batchId"];function Vp(t,e){return[t,Qt(e)]}function yR(t,e,n){return[t,Qt(e),n]}var q6={},G6=["prefixPath","collectionGroup","readTime","documentId"],z6=["prefixPath","collectionGroup","documentId"],W6=["collectionGroup","readTime","prefixPath","documentId"],K6=["canonicalId","targetId"],Q6=["targetId","path"],Y6=["path","targetId"],Z6=["collectionId","parent"],X6=["indexId","uid"],J6=["uid","sequenceNumber"],e8=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],t8=["indexId","uid","orderedDocumentKey"],n8=["userId","collectionPath","documentId"],r8=["userId","collectionPath","largestBatchId"],i8=["userId","collectionGroup","largestBatchId"],vR=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],s8=[...vR,"documentOverlays"],xR=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],wR=xR,o8=[...wR,"indexConfiguration","indexState","indexEntries"];var Mu=class extends zp{constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}};function Et(t,e){let n=N(t);return ri.M(n.ae,e)}function gN(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function lo(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ER(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ve=class t{constructor(e,n){this.comparator=e,this.root=n||Tr.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Tr.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Tr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ba(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ba(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ba(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ba(this.root,e,this.comparator,!0)}},Ba=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Tr=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw k();let e=this.left.check();if(e!==this.right.check())throw k();return e+(this.isRed()?0:1)}};Tr.EMPTY=null,Tr.RED=!0,Tr.BLACK=!1;Tr.EMPTY=new class{constructor(){this.size=0}get key(){throw k()}get value(){throw k()}get color(){throw k()}get left(){throw k()}get right(){throw k()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Tr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ne=class t{constructor(e){this.comparator=e,this.data=new Ve(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Kp(this.data.getIterator())}getIteratorFrom(e){return new Kp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},Kp=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Na(t){return t.hasNext()?t.getNext():void 0}var xn=class t{constructor(e){this.fields=e,e.sort(Ye.comparator)}static empty(){return new t([])}unionWith(e){let n=new Ne(Ye.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return qa(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var Qp=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function CR(){return typeof atob<"u"}var wt=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Qp("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return J(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};wt.EMPTY_BYTE_STRING=new wt("");var a8=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Hi(t){if(L(!!t),typeof t=="string"){let e=0,n=a8.exec(t);if(L(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ge(t.seconds),nanos:Ge(t.nanos)}}function Ge(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function qi(t){return typeof t=="string"?wt.fromBase64String(t):wt.fromUint8Array(t)}function jg(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function kE(t){let e=t.mapValue.fields.__previous_value__;return jg(e)?kE(e):e}function Nu(t){let e=Hi(t.mapValue.fields.__local_write_time__.timestampValue);return new Ue(e.seconds,e.nanos)}var Gx=class{constructor(e,n,r,i,s,o,a,c,l){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},Gi=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var Bi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Lp={nullValue:"NULL_VALUE"};function Xs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?jg(t)?4:IR(t)?9007199254740991:10:k()}function Mr(t,e){if(t===e)return!0;let n=Xs(t);if(n!==Xs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Nu(t).isEqual(Nu(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Hi(i.timestampValue),a=Hi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return qi(i.bytesValue).isEqual(qi(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Ge(i.geoPointValue.latitude)===Ge(s.geoPointValue.latitude)&&Ge(i.geoPointValue.longitude)===Ge(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Ge(i.integerValue)===Ge(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Ge(i.doubleValue),a=Ge(s.doubleValue);return o===a?Au(o)===Au(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return qa(t.arrayValue.values||[],e.arrayValue.values||[],Mr);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(gN(o)!==gN(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Mr(o[c],a[c])))return!1;return!0}(t,e);default:return k()}}function Ru(t,e){return(t.values||[]).find(n=>Mr(n,e))!==void 0}function zi(t,e){if(t===e)return 0;let n=Xs(t),r=Xs(e);if(n!==r)return J(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return J(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=Ge(s.integerValue||s.doubleValue),c=Ge(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return mN(t.timestampValue,e.timestampValue);case 4:return mN(Nu(t),Nu(e));case 5:return J(t.stringValue,e.stringValue);case 6:return function(s,o){let a=qi(s),c=qi(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){let u=J(a[l],c[l]);if(u!==0)return u}return J(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=J(Ge(s.latitude),Ge(o.latitude));return a!==0?a:J(Ge(s.longitude),Ge(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let l=0;l<a.length&&l<c.length;++l){let u=zi(a[l],c[l]);if(u)return u}return J(a.length,c.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Bi.mapValue&&o===Bi.mapValue)return 0;if(s===Bi.mapValue)return 1;if(o===Bi.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),l=o.fields||{},u=Object.keys(l);c.sort(),u.sort();for(let d=0;d<c.length&&d<u.length;++d){let h=J(c[d],u[d]);if(h!==0)return h;let f=zi(a[c[d]],l[u[d]]);if(f!==0)return f}return J(c.length,u.length)}(t.mapValue,e.mapValue);default:throw k()}}function mN(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return J(t,e);let n=Hi(t),r=Hi(e),i=J(n.seconds,r.seconds);return i!==0?i:J(n.nanos,r.nanos)}function za(t){return zx(t)}function zx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=Hi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return qi(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return M.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=zx(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${zx(n.fields[o])}`;return i+"}"}(t.mapValue):k()}function Js(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Wx(t){return!!t&&"integerValue"in t}function Pu(t){return!!t&&"arrayValue"in t}function _N(t){return!!t&&"nullValue"in t}function yN(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function jp(t){return!!t&&"mapValue"in t}function Cu(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return lo(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Cu(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Cu(t.arrayValue.values[n]);return e}return Object.assign({},t)}function IR(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function c8(t){return"nullValue"in t?Lp:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Js(Gi.empty(),M.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:k()}function l8(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Js(Gi.empty(),M.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Bi:k()}function vN(t,e){let n=zi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function xN(t,e){let n=zi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}var Ut=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!jp(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Cu(n)}setAll(e){let n=Ye.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Cu(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());jp(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Mr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];jp(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){lo(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(Cu(this.value))}};function bR(t){let e=[];return lo(t.fields,(n,r)=>{let i=new Ye([n]);if(jp(r)){let s=bR(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new xn(e)}var lt=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,$.min(),$.min(),$.min(),Ut.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,$.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,$.min(),$.min(),Ut.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,$.min(),$.min(),Ut.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual($.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ut.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ut.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=$.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Nr=class{constructor(e,n){this.position=e,this.inclusive=n}};function wN(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=M.comparator(M.fromName(o.referenceValue),n.key):r=zi(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function EN(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Mr(t.position[n],e.position[n]))return!1;return!0}var eo=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function u8(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Yp=class{},pe=class t extends Yp{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Yx(e,n,r):n==="array-contains"?new Jx(e,r):n==="in"?new Zp(e,r):n==="not-in"?new ew(e,r):n==="array-contains-any"?new tw(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new Zx(e,r):new Xx(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(zi(n,this.value)):n!==null&&Xs(this.value)===Xs(n)&&this.matchesComparison(zi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return k()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},De=class t extends Yp{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new t(e,n)}matches(e){return Wa(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}};function Wa(t){return t.op==="and"}function Kx(t){return t.op==="or"}function OE(t){return DR(t)&&Wa(t)}function DR(t){for(let e of t.filters)if(e instanceof De)return!1;return!0}function Qx(t){if(t instanceof pe)return t.field.canonicalString()+t.op.toString()+za(t.value);if(OE(t))return t.filters.map(e=>Qx(e)).join(",");{let e=t.filters.map(n=>Qx(n)).join(",");return`${t.op}(${e})`}}function TR(t,e){return t instanceof pe?function(r,i){return i instanceof pe&&r.op===i.op&&r.field.isEqual(i.field)&&Mr(r.value,i.value)}(t,e):t instanceof De?function(r,i){return i instanceof De&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&TR(o,i.filters[a]),!0):!1}(t,e):void k()}function SR(t,e){let n=t.filters.concat(e);return De.create(n,t.op)}function AR(t){return t instanceof pe?function(n){return`${n.field.canonicalString()} ${n.op} ${za(n.value)}`}(t):t instanceof De?function(n){return n.op.toString()+" {"+n.getFilters().map(AR).join(" ,")+"}"}(t):"Filter"}var Yx=class extends pe{constructor(e,n,r){super(e,n,r),this.key=M.fromName(r.referenceValue)}matches(e){let n=M.comparator(e.key,this.key);return this.matchesComparison(n)}},Zx=class extends pe{constructor(e,n){super(e,"in",n),this.keys=MR("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},Xx=class extends pe{constructor(e,n){super(e,"not-in",n),this.keys=MR("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function MR(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>M.fromName(r.referenceValue))}var Jx=class extends pe{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return Pu(n)&&Ru(n.arrayValue,this.value)}},Zp=class extends pe{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&Ru(this.value.arrayValue,n)}},ew=class extends pe{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ru(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!Ru(this.value.arrayValue,n)}},tw=class extends pe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!Pu(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ru(this.value.arrayValue,r))}};var nw=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}};function rw(t,e=null,n=[],r=[],i=null,s=null,o=null){return new nw(t,e,n,r,i,s,o)}function to(t){let e=N(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Qx(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Yu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>za(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>za(r)).join(",")),e.ce=n}return e.ce}function Zu(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!u8(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!TR(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!EN(t.startAt,e.startAt)&&EN(t.endAt,e.endAt)}function Xp(t){return M.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Jp(t,e){return t.filters.filter(n=>n instanceof pe&&n.field.isEqual(e))}function CN(t,e,n){let r=Lp,i=!0;for(let s of Jp(t,e)){let o=Lp,a=!0;switch(s.op){case"<":case"<=":o=c8(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Lp}vN({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];vN({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function IN(t,e,n){let r=Bi,i=!0;for(let s of Jp(t,e)){let o=Bi,a=!0;switch(s.op){case">=":case">":o=l8(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Bi}xN({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];xN({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}var tr=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}};function NR(t,e,n,r,i,s,o,a){return new tr(t,e,n,r,i,s,o,a)}function cc(t){return new tr(t)}function bN(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function FE(t){return t.collectionGroup!==null}function $a(t){let e=N(t);if(e.le===null){e.le=[];let n=new Set;for(let s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ne(Ye.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new eo(s,r))}),n.has(Ye.keyField().canonicalString())||e.le.push(new eo(Ye.keyField(),r))}return e.le}function Yt(t){let e=N(t);return e.he||(e.he=d8(e,$a(t))),e.he}function d8(t,e){if(t.limitType==="F")return rw(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new eo(i.field,s)});let n=t.endAt?new Nr(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Nr(t.startAt.position,t.startAt.inclusive):null;return rw(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function iw(t,e){let n=t.filters.concat([e]);return new tr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function eg(t,e,n){return new tr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Xu(t,e){return Zu(Yt(t),Yt(e))&&t.limitType===e.limitType}function RR(t){return`${to(Yt(t))}|lt:${t.limitType}`}function Fa(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>AR(i)).join(", ")}]`),Yu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>za(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>za(i)).join(",")),`Target(${r})`}(Yt(t))}; limitType=${t.limitType})`}function Ju(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):M.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of $a(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let l=wN(o,a,c);return o.inclusive?l<=0:l<0}(r.startAt,$a(r),i)||r.endAt&&!function(o,a,c){let l=wN(o,a,c);return o.inclusive?l>=0:l>0}(r.endAt,$a(r),i))}(t,e)}function PR(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function kR(t){return(e,n)=>{let r=!1;for(let i of $a(t)){let s=h8(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function h8(t,e,n){let r=t.field.isKeyField()?M.comparator(e.key,n.key):function(s,o,a){let c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?zi(c,l):k()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return k()}}var Rr=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){lo(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return ER(this.inner)}size(){return this.innerSize}};var f8=new Ve(M.comparator);function hn(){return f8}var OR=new Ve(M.comparator);function wu(...t){let e=OR;for(let n of t)e=e.insert(n.key,n);return e}function FR(t){let e=OR;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Dr(){return Iu()}function VR(){return Iu()}function Iu(){return new Rr(t=>t.toString(),(t,e)=>t.isEqual(e))}var p8=new Ve(M.comparator),g8=new Ne(M.comparator);function re(...t){let e=g8;for(let n of t)e=e.add(n);return e}var m8=new Ne(J);function VE(){return m8}function LR(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Au(e)?"-0":e}}function jR(t){return{integerValue:""+t}}function BR(t,e){return _R(e)?jR(e):LR(t,e)}var Ka=class{constructor(){this._=void 0}};function _8(t,e,n){return t instanceof Wi?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&jg(s)&&(s=kE(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof ii?$R(t,e):t instanceof si?HR(t,e):function(i,s){let o=UR(i,s),a=DN(o)+DN(i.Ie);return Wx(o)&&Wx(i.Ie)?jR(a):LR(i.serializer,a)}(t,e)}function y8(t,e,n){return t instanceof ii?$R(t,e):t instanceof si?HR(t,e):n}function UR(t,e){return t instanceof Ki?function(r){return Wx(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Wi=class extends Ka{},ii=class extends Ka{constructor(e){super(),this.elements=e}};function $R(t,e){let n=qR(e);for(let r of t.elements)n.some(i=>Mr(i,r))||n.push(r);return{arrayValue:{values:n}}}var si=class extends Ka{constructor(e){super(),this.elements=e}};function HR(t,e){let n=qR(e);for(let r of t.elements)n=n.filter(i=>!Mr(i,r));return{arrayValue:{values:n}}}var Ki=class extends Ka{constructor(e,n){super(),this.serializer=e,this.Ie=n}};function DN(t){return Ge(t.integerValue||t.doubleValue)}function qR(t){return Pu(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var no=class{constructor(e,n){this.field=e,this.transform=n}};function v8(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof ii&&i instanceof ii||r instanceof si&&i instanceof si?qa(r.elements,i.elements,Mr):r instanceof Ki&&i instanceof Ki?Mr(r.Ie,i.Ie):r instanceof Wi&&i instanceof Wi}(t.transform,e.transform)}var sw=class{constructor(e,n){this.version=e,this.transformResults=n}},ze=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Bp(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var Qa=class{};function GR(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Yi(t.key,ze.none()):new Qi(t.key,t.data,ze.none());{let n=t.data,r=Ut.empty(),i=new Ne(Ye.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new nr(t.key,r,new xn(i.toArray()),ze.none())}}function x8(t,e,n){t instanceof Qi?function(i,s,o){let a=i.value.clone(),c=SN(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof nr?function(i,s,o){if(!Bp(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=SN(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(zR(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function bu(t,e,n,r){return t instanceof Qi?function(s,o,a,c){if(!Bp(s.precondition,o))return a;let l=s.value.clone(),u=AN(s.fieldTransforms,c,o);return l.setAll(u),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(t,e,n,r):t instanceof nr?function(s,o,a,c){if(!Bp(s.precondition,o))return a;let l=AN(s.fieldTransforms,c,o),u=o.data;return u.setAll(zR(s)),u.setAll(l),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,o,a){return Bp(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function w8(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=UR(r.transform,i||null);s!=null&&(n===null&&(n=Ut.empty()),n.set(r.field,s))}return n||null}function TN(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&qa(r,i,(s,o)=>v8(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var Qi=class extends Qa{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},nr=class extends Qa{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function zR(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function SN(t,e,n){let r=new Map;L(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,y8(o,a,n[i]))}return r}function AN(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,_8(s,o,e))}return r}var Yi=class extends Qa{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},ku=class extends Qa{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Ou=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&x8(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=bu(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=bu(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=VR();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let c=GR(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument($.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),re())}isEqual(e){return this.batchId===e.batchId&&qa(this.mutations,e.mutations,(n,r)=>TN(n,r))&&qa(this.baseMutations,e.baseMutations,(n,r)=>TN(n,r))}},ow=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){L(e.mutations.length===r.length);let i=function(){return p8}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var Fu=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var aw=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var st,_e;function WR(t){switch(t){default:return k();case y.CANCELLED:case y.UNKNOWN:case y.DEADLINE_EXCEEDED:case y.RESOURCE_EXHAUSTED:case y.INTERNAL:case y.UNAVAILABLE:case y.UNAUTHENTICATED:return!1;case y.INVALID_ARGUMENT:case y.NOT_FOUND:case y.ALREADY_EXISTS:case y.PERMISSION_DENIED:case y.FAILED_PRECONDITION:case y.ABORTED:case y.OUT_OF_RANGE:case y.UNIMPLEMENTED:case y.DATA_LOSS:return!0}}function KR(t){if(t===void 0)return Qe("GRPC error has no .code"),y.UNKNOWN;switch(t){case st.OK:return y.OK;case st.CANCELLED:return y.CANCELLED;case st.UNKNOWN:return y.UNKNOWN;case st.DEADLINE_EXCEEDED:return y.DEADLINE_EXCEEDED;case st.RESOURCE_EXHAUSTED:return y.RESOURCE_EXHAUSTED;case st.INTERNAL:return y.INTERNAL;case st.UNAVAILABLE:return y.UNAVAILABLE;case st.UNAUTHENTICATED:return y.UNAUTHENTICATED;case st.INVALID_ARGUMENT:return y.INVALID_ARGUMENT;case st.NOT_FOUND:return y.NOT_FOUND;case st.ALREADY_EXISTS:return y.ALREADY_EXISTS;case st.PERMISSION_DENIED:return y.PERMISSION_DENIED;case st.FAILED_PRECONDITION:return y.FAILED_PRECONDITION;case st.ABORTED:return y.ABORTED;case st.OUT_OF_RANGE:return y.OUT_OF_RANGE;case st.UNIMPLEMENTED:return y.UNIMPLEMENTED;case st.DATA_LOSS:return y.DATA_LOSS;default:return k()}}(_e=st||(st={}))[_e.OK=0]="OK",_e[_e.CANCELLED=1]="CANCELLED",_e[_e.UNKNOWN=2]="UNKNOWN",_e[_e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_e[_e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_e[_e.NOT_FOUND=5]="NOT_FOUND",_e[_e.ALREADY_EXISTS=6]="ALREADY_EXISTS",_e[_e.PERMISSION_DENIED=7]="PERMISSION_DENIED",_e[_e.UNAUTHENTICATED=16]="UNAUTHENTICATED",_e[_e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_e[_e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_e[_e.ABORTED=10]="ABORTED",_e[_e.OUT_OF_RANGE=11]="OUT_OF_RANGE",_e[_e.UNIMPLEMENTED=12]="UNIMPLEMENTED",_e[_e.INTERNAL=13]="INTERNAL",_e[_e.UNAVAILABLE=14]="UNAVAILABLE",_e[_e.DATA_LOSS=15]="DATA_LOSS";var MN=null;function QR(){return new TextEncoder}var E8=new Hs([4294967295,4294967295],0);function NN(t){let e=QR().encode(t),n=new uN;return n.update(e),new Uint8Array(n.digest())}function RN(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Hs([n,r],0),new Hs([i,s],0)]}var cw=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ys(`Invalid padding: ${n}`);if(r<0)throw new Ys(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ys(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ys(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=Hs.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(Hs.fromNumber(r)));return i.compare(E8)===1&&(i=new Hs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let n=NN(e),[r,i]=RN(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;let n=NN(e),[r,i]=RN(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);this.Re(o)}}Re(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},Ys=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Vu=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,Lu.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t($.min(),i,new Ve(J),hn(),re())}},Lu=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,re(),re(),re())}};var Ha=class{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}},tg=class{constructor(e,n){this.targetId=e,this.fe=n}},ng=class{constructor(e,n,r=wt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},rg=class{constructor(){this.ge=0,this.pe=kN(),this.ye=wt.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=re(),n=re(),r=re();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:k()}}),new Lu(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=kN()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,L(this.ge>=0)}Le(){this.Se=!0,this.we=!0}},lw=class{constructor(e){this.Be=e,this.ke=new Map,this.qe=hn(),this.Qe=PN(),this.Ke=new Ve(J)}$e(e){for(let n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(let n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{let r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Le(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:k()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){let n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){let s=i.target;if(Xp(s))if(r===0){let o=new M(s.path);this.We(n,o,lt.newNoDocument(o,$.min()))}else L(r===1);else{let o=this.Ze(n);if(o!==r){let a=this.Xe(e),c=a?this.et(a,e,o):1;if(c!==0){this.He(n);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,l)}MN?.tt(function(u,d,h,f,p){var m,v,b,F,T,q;let W={localCacheCount:u,existenceFilterCount:d.count,databaseId:h.database,projectId:h.projectId},Z=d.unchangedNames;return Z&&(W.bloomFilter={applied:p===0,hashCount:(m=Z?.hashCount)!==null&&m!==void 0?m:0,bitmapLength:(F=(b=(v=Z?.bits)===null||v===void 0?void 0:v.bitmap)===null||b===void 0?void 0:b.length)!==null&&F!==void 0?F:0,padding:(q=(T=Z?.bits)===null||T===void 0?void 0:T.padding)!==null&&q!==void 0?q:0,mightContain:Te=>{var tn;return(tn=f?.mightContain(Te))!==null&&tn!==void 0&&tn}}),W}(o,e.fe,this.Be.nt(),a,c))}}}}Xe(e){let n=e.fe.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=qi(r).toUint8Array()}catch(c){if(c instanceof Qp)return Fn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new cw(o,i,s)}catch(c){return Fn(c instanceof Ys?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Te===0?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){let r=this.Be.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Be.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){let n=new Map;this.ke.forEach((s,o)=>{let a=this.Ye(o);if(a){if(s.current&&Xp(a.target)){let c=new M(a.target.path);this.qe.get(c)!==null||this.st(o,c)||this.We(o,c,lt.newNoDocument(c,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=re();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.Ye(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));let i=new Vu(e,n,this.Ke,this.qe,r);return this.qe=hn(),this.Qe=PN(),this.Ke=new Ve(J),i}Ue(e,n){if(!this.je(e))return;let r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;let i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){let n=this.ze(e).ve();return this.Be.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new rg,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new Ne(J),this.Qe=this.Qe.insert(e,n)),n}je(e){let n=this.Ye(e)!==null;return n||C("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){let n=this.ke.get(e);return n&&n.be?null:this.Be._t(e)}He(e){this.ke.set(e,new rg),this.Be.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Be.getRemoteKeysForTarget(e).has(n)}};function PN(){return new Ve(M.comparator)}function kN(){return new Ve(M.comparator)}var C8={asc:"ASCENDING",desc:"DESCENDING"},I8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},b8={and:"AND",or:"OR"},uw=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function dw(t,e){return t.useProto3Json||Yu(e)?e:{value:e}}function Ya(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function YR(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function D8(t,e){return Ya(t,e.toTimestamp())}function Ze(t){return L(!!t),$.fromTimestamp(function(n){let r=Hi(n);return new Ue(r.seconds,r.nanos)}(t))}function LE(t,e){return hw(t,e).canonicalString()}function hw(t,e){let n=function(i){return new ye(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function ZR(t){let e=ye.fromString(t);return L(aP(e)),e}function ju(t,e){return LE(t.databaseId,e.path)}function Sr(t,e){let n=ZR(e);if(n.get(1)!==t.databaseId.projectId)throw new w(y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new w(y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new M(eP(n))}function XR(t,e){return LE(t.databaseId,e)}function JR(t){let e=ZR(t);return e.length===4?ye.emptyPath():eP(e)}function fw(t){return new ye(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function eP(t){return L(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function ON(t,e,n){return{name:ju(t,e),fields:n.value.mapValue.fields}}function tP(t,e,n){let r=Sr(t,e.name),i=Ze(e.updateTime),s=e.createTime?Ze(e.createTime):$.min(),o=new Ut({mapValue:{fields:e.fields}}),a=lt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function T8(t,e){return"found"in e?function(r,i){L(!!i.found),i.found.name,i.found.updateTime;let s=Sr(r,i.found.name),o=Ze(i.found.updateTime),a=i.found.createTime?Ze(i.found.createTime):$.min(),c=new Ut({mapValue:{fields:i.found.fields}});return lt.newFoundDocument(s,o,a,c)}(t,e):"missing"in e?function(r,i){L(!!i.missing),L(!!i.readTime);let s=Sr(r,i.missing),o=Ze(i.readTime);return lt.newNoDocument(s,o)}(t,e):k()}function S8(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:k()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,u){return l.useProto3Json?(L(u===void 0||typeof u=="string"),wt.fromBase64String(u||"")):(L(u===void 0||u instanceof Uint8Array),wt.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){let u=l.code===void 0?y.UNKNOWN:KR(l.code);return new w(u,l.message||"")}(o);n=new ng(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Sr(t,r.document.name),s=Ze(r.document.updateTime),o=r.document.createTime?Ze(r.document.createTime):$.min(),a=new Ut({mapValue:{fields:r.document.fields}}),c=lt.newFoundDocument(i,s,o,a),l=r.targetIds||[],u=r.removedTargetIds||[];n=new Ha(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Sr(t,r.document),s=r.readTime?Ze(r.readTime):$.min(),o=lt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Ha([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Sr(t,r.document),s=r.removedTargetIds||[];n=new Ha([],s,i,null)}else{if(!("filter"in e))return k();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new aw(i,s),a=r.targetId;n=new tg(a,o)}}return n}function Bu(t,e){let n;if(e instanceof Qi)n={update:ON(t,e.key,e.value)};else if(e instanceof Yi)n={delete:ju(t,e.key)};else if(e instanceof nr)n={update:ON(t,e.key,e.data),updateMask:k8(e.fieldMask)};else{if(!(e instanceof ku))return k();n={verify:ju(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Wi)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ii)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof si)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ki)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw k()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:D8(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:k()}(t,e.precondition)),n}function pw(t,e){let n=e.currentDocument?function(s){return s.updateTime!==void 0?ze.updateTime(Ze(s.updateTime)):s.exists!==void 0?ze.exists(s.exists):ze.none()}(e.currentDocument):ze.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)L(a.setToServerValue==="REQUEST_TIME"),c=new Wi;else if("appendMissingElements"in a){let u=a.appendMissingElements.values||[];c=new ii(u)}else if("removeAllFromArray"in a){let u=a.removeAllFromArray.values||[];c=new si(u)}else"increment"in a?c=new Ki(o,a.increment):k();let l=Ye.fromServerFormat(a.fieldPath);return new no(l,c)}(t,i)):[];if(e.update){e.update.name;let i=Sr(t,e.update.name),s=new Ut({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let l=c.fieldPaths||[];return new xn(l.map(u=>Ye.fromServerFormat(u)))}(e.updateMask);return new nr(i,s,o,n,r)}return new Qi(i,s,n,r)}if(e.delete){let i=Sr(t,e.delete);return new Yi(i,n)}if(e.verify){let i=Sr(t,e.verify);return new ku(i,n)}return k()}function A8(t,e){return t&&t.length>0?(L(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?Ze(i.updateTime):Ze(s);return o.isEqual($.min())&&(o=Ze(s)),new sw(o,i.transformResults||[])}(n,e))):[]}function nP(t,e){return{documents:[XR(t,e.path)]}}function rP(t,e){let n={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=XR(t,i);let s=function(l){if(l.length!==0)return oP(De.create(l,"and"))}(e.filters);s&&(n.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(u=>function(h){return{field:Va(h.field),direction:N8(h.dir)}}(u))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);let a=dw(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{ut:n,parent:i}}function iP(t){let e=JR(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){L(r===1);let u=n.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];n.where&&(s=function(d){let h=sP(d);return h instanceof De&&OE(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(h=>function(p){return new eo(La(p.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,Yu(h)?null:h}(n.limit));let c=null;n.startAt&&(c=function(d){let h=!!d.before,f=d.values||[];return new Nr(f,h)}(n.startAt));let l=null;return n.endAt&&(l=function(d){let h=!d.before,f=d.values||[];return new Nr(f,h)}(n.endAt)),NR(e,i,o,s,a,"F",c,l)}function M8(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return k()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function sP(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=La(n.unaryFilter.field);return pe.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=La(n.unaryFilter.field);return pe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=La(n.unaryFilter.field);return pe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=La(n.unaryFilter.field);return pe.create(o,"!=",{nullValue:"NULL_VALUE"});default:return k()}}(t):t.fieldFilter!==void 0?function(n){return pe.create(La(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return k()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return De.create(n.compositeFilter.filters.map(r=>sP(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return k()}}(n.compositeFilter.op))}(t):k()}function N8(t){return C8[t]}function R8(t){return I8[t]}function P8(t){return b8[t]}function Va(t){return{fieldPath:t.canonicalString()}}function La(t){return Ye.fromServerFormat(t.fieldPath)}function oP(t){return t instanceof pe?function(n){if(n.op==="=="){if(yN(n.value))return{unaryFilter:{field:Va(n.field),op:"IS_NAN"}};if(_N(n.value))return{unaryFilter:{field:Va(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(yN(n.value))return{unaryFilter:{field:Va(n.field),op:"IS_NOT_NAN"}};if(_N(n.value))return{unaryFilter:{field:Va(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Va(n.field),op:R8(n.op),value:n.value}}}(t):t instanceof De?function(n){let r=n.getFilters().map(i=>oP(i));return r.length===1?r[0]:{compositeFilter:{op:P8(n.op),filters:r}}}(t):k()}function k8(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function aP(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var Za=class t{constructor(e,n,r,i,s=$.min(),o=$.min(),a=wt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var ig=class{constructor(e){this.ct=e}};function O8(t,e){let n;if(e.document)n=tP(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=M.fromSegments(e.noDocument.path),i=io(e.noDocument.readTime);n=lt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return k();{let r=M.fromSegments(e.unknownDocument.path),i=io(e.unknownDocument.version);n=lt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){let s=new Ue(i[0],i[1]);return $.fromTimestamp(s)}(e.readTime)),n}function FN(t,e){let n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:sg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:ju(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Ya(s,o.version.toTimestamp()),createTime:Ya(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ro(e.version)};else{if(!e.isUnknownDocument())return k();r.unknownDocument={path:n.path.toArray(),version:ro(e.version)}}return r}function sg(t){let e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ro(t){let e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function io(t){let e=new Ue(t.seconds,t.nanoseconds);return $.fromTimestamp(e)}function Ws(t,e){let n=(e.baseMutations||[]).map(s=>pw(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>pw(t.ct,s)),i=Ue.fromMillis(e.localWriteTimeMs);return new Ou(e.batchId,i,n,r)}function Eu(t){let e=io(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?io(t.lastLimboFreeSnapshotVersion):$.min(),r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return L(s.documents.length===1),Yt(cc(JR(s.documents[0])))}(t.query):function(s){return Yt(iP(s))}(t.query),new Za(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,wt.fromBase64String(t.resumeToken))}function cP(t,e){let n=ro(e.snapshotVersion),r=ro(e.lastLimboFreeSnapshotVersion),i;i=Xp(e.target)?nP(t.ct,e.target):rP(t.ct,e.target).ut;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:to(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function jE(t){let e=iP({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?eg(e,e.limit,"L"):e}function Ax(t,e){return new Fu(e.largestBatchId,pw(t.ct,e.overlayMutation))}function VN(t,e){let n=e.path.lastSegment();return[t,Qt(e.path.popLast()),n]}function LN(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:ro(r.readTime),documentKey:Qt(r.documentKey.path),largestBatchId:r.largestBatchId}}var gw=class{getBundleMetadata(e,n){return jN(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:io(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return jN(e).put(function(i){return{bundleId:i.id,createTime:ro(Ze(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return BN(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:jE(s.bundledQuery),readTime:io(s.readTime)}}(r)})}saveNamedQuery(e,n){return BN(e).put(function(i){return{name:i.name,readTime:ro(Ze(i.readTime)),bundledQuery:i.bundledQuery}}(n))}};function jN(t){return Et(t,"bundles")}function BN(t){return Et(t,"namedQueries")}var og=class t{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){let r=n.uid||"";return new t(e,r)}getOverlay(e,n){return _u(e).get(VN(this.userId,n)).next(r=>r?Ax(this.serializer,r):null)}getOverlays(e,n){let r=Dr();return _.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){let i=[];return r.forEach((s,o)=>{let a=new Fu(n,o);i.push(this.ht(e,a))}),_.waitFor(i)}removeOverlaysForBatchId(e,n,r){let i=new Set;n.forEach(o=>i.add(Qt(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(_u(e).H("collectionPathOverlayIndex",a))}),_.waitFor(s)}getOverlaysForCollection(e,n,r){let i=Dr(),s=Qt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return _u(e).W("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let l=Ax(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,n,r,i){let s=Dr(),o,a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return _u(e).Y({index:"collectionGroupOverlayIndex",range:a},(c,l,u)=>{let d=Ax(this.serializer,l);s.size()<i||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):u.done()}).next(()=>s)}ht(e,n){return _u(e).put(function(i,s,o){let[a,c,l]=VN(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Bu(i.ct,o.mutation)}}(this.serializer,this.userId,n))}};function _u(t){return Et(t,"documentOverlays")}var ti=class{constructor(){}Pt(e,n){this.It(e,n),n.Tt()}It(e,n){if("nullValue"in e)this.Et(n,5);else if("booleanValue"in e)this.Et(n,10),n.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(n,15),n.dt(Ge(e.integerValue));else if("doubleValue"in e){let r=Ge(e.doubleValue);isNaN(r)?this.Et(n,13):(this.Et(n,15),Au(r)?n.dt(0):n.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(n,20),typeof r=="string"?n.At(r):(n.At(`${r.seconds||""}`),n.dt(r.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,n),this.Vt(n);else if("bytesValue"in e)this.Et(n,30),n.ft(qi(e.bytesValue)),this.Vt(n);else if("referenceValue"in e)this.gt(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(n,45),n.dt(r.latitude||0),n.dt(r.longitude||0)}else"mapValue"in e?IR(e)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,n),this.Vt(n)):"arrayValue"in e?(this.wt(e.arrayValue,n),this.Vt(n)):k()}Rt(e,n){this.Et(n,25),this.St(e,n)}St(e,n){n.At(e)}yt(e,n){let r=e.fields||{};this.Et(n,55);for(let i of Object.keys(r))this.Rt(i,n),this.It(r[i],n)}wt(e,n){let r=e.values||[];this.Et(n,50);for(let i of r)this.It(i,n)}gt(e,n){this.Et(n,37),M.fromName(e).path.forEach(r=>{this.Et(n,60),this.St(r,n)})}Et(e,n){e.dt(n)}Vt(e){e.dt(2)}};ti.bt=new ti;function F8(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function UN(t){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=F8(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}var mw=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Ct(r.value),r=n.next();this.vt()}Ft(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Mt(r.value),r=n.next();this.xt()}Ot(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=n.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=n.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Lt(e){let n=this.Bt(e),r=UN(n);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}qt(e){let n=this.Bt(e),r=UN(n);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){let n=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ct(e){let n=255&e;n===0?(this.Kt(0),this.Kt(255)):n===255?(this.Kt(255),this.Kt(0)):this.Kt(n)}Mt(e){let n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},_w=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}},yw=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},Ks=class{constructor(){this.Gt=new mw,this.zt=new _w(this.Gt),this.jt=new yw(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var Qs=class t{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}};function Fi(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=$N(t.arrayValue,e.arrayValue),n!==0?n:(n=$N(t.directionalValue,e.directionalValue),n!==0?n:M.comparator(t.documentKey,e.documentKey)))}function $N(t,e){for(let n=0;n<t.length&&n<e.length;++n){let r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}var ag=class{constructor(e){this.Yt=new Ne((n,r)=>Ye.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let n of e.filters){let r=n;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(L(e.collectionGroup===this.collectionId),this.en)return!1;let n=Bx(e);if(n!==void 0&&!this.nn(n))return!1;let r=Gs(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.rn(a,c)||!this.sn(this.Zt[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new Ne(Ye.comparator),n=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Ua(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Ua(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Ua(r.field,r.dir==="asc"?0:1)));return new Ga(Ga.UNKNOWN_ID,this.collectionId,n,Su.empty())}nn(e){for(let n of this.Xt)if(this.rn(n,e))return!0;return!1}rn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}sn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}};function lP(t){var e,n;if(L(t instanceof pe||t instanceof De),t instanceof pe){if(t instanceof Zp){let i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>pe.create(t.field,"==",s)))||[];return De.create(i,"or")}return t}let r=t.filters.map(i=>lP(i));return De.create(r,t.op)}function V8(t){if(t.getFilters().length===0)return[];let e=ww(lP(t));return L(uP(e)),vw(e)||xw(e)?[e]:e.getFilters()}function vw(t){return t instanceof pe}function xw(t){return t instanceof De&&OE(t)}function uP(t){return vw(t)||xw(t)||function(n){if(n instanceof De&&Kx(n)){for(let r of n.getFilters())if(!vw(r)&&!xw(r))return!1;return!0}return!1}(t)}function ww(t){if(L(t instanceof pe||t instanceof De),t instanceof pe)return t;if(t.filters.length===1)return ww(t.filters[0]);let e=t.filters.map(r=>ww(r)),n=De.create(e,t.op);return n=cg(n),uP(n)?n:(L(n instanceof De),L(Wa(n)),L(n.filters.length>1),n.filters.reduce((r,i)=>BE(r,i)))}function BE(t,e){let n;return L(t instanceof pe||t instanceof De),L(e instanceof pe||e instanceof De),n=t instanceof pe?e instanceof pe?function(i,s){return De.create([i,s],"and")}(t,e):HN(t,e):e instanceof pe?HN(e,t):function(i,s){if(L(i.filters.length>0&&s.filters.length>0),Wa(i)&&Wa(s))return SR(i,s.getFilters());let o=Kx(i)?i:s,a=Kx(i)?s:i,c=o.filters.map(l=>BE(l,a));return De.create(c,"or")}(t,e),cg(n)}function HN(t,e){if(Wa(e))return SR(e,t.getFilters());{let n=e.filters.map(r=>BE(t,r));return De.create(n,"or")}}function cg(t){if(L(t instanceof pe||t instanceof De),t instanceof pe)return t;let e=t.getFilters();if(e.length===1)return cg(e[0]);if(DR(t))return t;let n=e.map(i=>cg(i)),r=[];return n.forEach(i=>{i instanceof pe?r.push(i):i instanceof De&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:De.create(r,t.op)}var Ew=class{constructor(){this._n=new Uu}addToCollectionParentIndex(e,n){return this._n.add(n),_.resolve()}getCollectionParents(e,n){return _.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return _.resolve()}deleteFieldIndex(e,n){return _.resolve()}deleteAllFieldIndexes(e){return _.resolve()}createTargetIndexes(e,n){return _.resolve()}getDocumentsMatchingTarget(e,n){return _.resolve(null)}getIndexType(e,n){return _.resolve(0)}getFieldIndexes(e,n){return _.resolve([])}getNextCollectionGroupToUpdate(e){return _.resolve(null)}getMinOffset(e,n){return _.resolve(Vn.min())}getMinOffsetFromCollectionGroup(e,n){return _.resolve(Vn.min())}updateCollectionGroup(e,n,r){return _.resolve()}updateIndexEntries(e,n){return _.resolve()}},Uu=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ne(ye.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ne(ye.comparator)).toArray()}};var Pp=new Uint8Array(0),Cw=class{constructor(e,n){this.databaseId=n,this.an=new Uu,this.un=new Rr(r=>to(r),(r,i)=>Zu(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.an.has(n)){let r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.an.add(n)});let s={collectionId:r,parent:Qt(i)};return qN(e).put(s)}return _.resolve()}getCollectionParents(e,n){let r=[],i=IDBKeyRange.bound([n,""],[fR(n),""],!1,!0);return qN(e).W(i).next(s=>{for(let o of s){if(o.collectionId!==n)break;r.push(br(o.parent))}return r})}addFieldIndex(e,n){let r=yu(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete i.indexId;let s=r.add(i);if(n.indexState){let o=Pa(e);return s.next(a=>{o.put(LN(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){let r=yu(e),i=Pa(e),s=Ra(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let n=yu(e),r=Ra(e),i=Pa(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return _.forEach(this.cn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new ag(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){let r=Ra(e),i=!0,s=new Map;return _.forEach(this.cn(n),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=re(),a=[];return _.forEach(s,(c,l)=>{C("IndexedDbIndexManager",`Using index ${function(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(q=>`${q.fieldPath}:${q.kind}`).join(",")}`}(c)} to execute ${to(n)}`);let u=function(T,q){let W=Bx(q);if(W===void 0)return null;for(let Z of Jp(T,W.fieldPath))switch(Z.op){case"array-contains-any":return Z.value.arrayValue.values||[];case"array-contains":return[Z.value]}return null}(l,c),d=function(T,q){let W=new Map;for(let Z of Gs(q))for(let Te of Jp(T,Z.fieldPath))switch(Te.op){case"==":case"in":W.set(Z.fieldPath.canonicalString(),Te.value);break;case"not-in":case"!=":return W.set(Z.fieldPath.canonicalString(),Te.value),Array.from(W.values())}return null}(l,c),h=function(T,q){let W=[],Z=!0;for(let Te of Gs(q)){let tn=Te.kind===0?CN(T,Te.fieldPath,T.startAt):IN(T,Te.fieldPath,T.startAt);W.push(tn.value),Z&&(Z=tn.inclusive)}return new Nr(W,Z)}(l,c),f=function(T,q){let W=[],Z=!0;for(let Te of Gs(q)){let tn=Te.kind===0?IN(T,Te.fieldPath,T.endAt):CN(T,Te.fieldPath,T.endAt);W.push(tn.value),Z&&(Z=tn.inclusive)}return new Nr(W,Z)}(l,c),p=this.hn(c,l,h),m=this.hn(c,l,f),v=this.Pn(c,l,d),b=this.In(c.indexId,u,p,h.inclusive,m,f.inclusive,v);return _.forEach(b,F=>r.j(F,n.limit).next(T=>{T.forEach(q=>{let W=M.fromSegments(q.documentKey);o.has(W)||(o=o.add(W),a.push(W))})}))}).next(()=>a)}return _.resolve(null)})}cn(e){let n=this.un.get(e);return n||(e.filters.length===0?n=[e]:n=V8(De.create(e.filters,"and")).map(r=>rw(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,n),n)}In(e,n,r,i,s,o,a){let c=(n!=null?n.length:1)*Math.max(r.length,s.length),l=c/(n!=null?n.length:1),u=[];for(let d=0;d<c;++d){let h=n?this.Tn(n[d/l]):Pp,f=this.En(e,h,r[d%l],i),p=this.dn(e,h,s[d%l],o),m=a.map(v=>this.En(e,h,v,!0));u.push(...this.createRange(f,p,m))}return u}En(e,n,r,i){let s=new Qs(e,M.empty(),n,r);return i?s:s.Jt()}dn(e,n,r,i){let s=new Qs(e,M.empty(),n,r);return i?s.Jt():s}ln(e,n){let r=new ag(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2,i=this.cn(n);return _.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let l=new Ne(Ye.comparator),u=!1;for(let d of c.filters)for(let h of d.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?u=!0:l=l.add(h.field));for(let d of c.orderBy)d.field.isKeyField()||(l=l.add(d.field));return l.size+(u?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}An(e,n){let r=new Ks;for(let i of Gs(e)){let s=n.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);ti.bt.Pt(s,o)}return r.Wt()}Tn(e){let n=new Ks;return ti.bt.Pt(e,n.Ht(0)),n.Wt()}Rn(e,n){let r=new Ks;return ti.bt.Pt(Js(this.databaseId,n),r.Ht(function(s){let o=Gs(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,n,r){if(r===null)return[];let i=[];i.push(new Ks);let s=0;for(let o of Gs(e)){let a=r[s++];for(let c of i)if(this.Vn(n,o.fieldPath)&&Pu(a))i=this.mn(i,o,a);else{let l=c.Ht(o.kind);ti.bt.Pt(a,l)}}return this.fn(i)}hn(e,n,r){return this.Pn(e,n,r.position)}fn(e){let n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Wt();return n}mn(e,n,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new Ks;c.seed(a.Wt()),ti.bt.Pt(o,c.Ht(n.kind)),s.push(c)}return s}Vn(e,n){return!!e.filters.find(r=>r instanceof pe&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){let r=yu(e),i=Pa(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{let o=[];return _.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(u,d){let h=d?new Su(d.sequenceNumber,new Vn(io(d.readTime),new M(br(d.documentKey)),d.largestBatchId)):Su.empty(),f=u.fields.map(([p,m])=>new Ua(Ye.fromServerFormat(p),m));return new Ga(u.indexId,u.collectionGroup,f,h)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:J(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){let i=yu(e),s=Pa(e);return this.gn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>_.forEach(a,c=>s.put(LN(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){let r=new Map;return _.forEach(n,(i,s)=>{let o=r.get(i.collectionGroup);return(o?_.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),_.forEach(a,c=>this.pn(e,i,c).next(l=>{let u=this.yn(s,c);return l.isEqual(u)?_.resolve():this.wn(e,s,c,l,u)}))))})}Sn(e,n,r,i){return Ra(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,n.key),documentKey:n.key.path.toArray()})}bn(e,n,r,i){return Ra(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,n.key),n.key.path.toArray()])}pn(e,n,r){let i=Ra(e),s=new Ne(Fi);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,n)])},(o,a)=>{s=s.add(new Qs(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,n){let r=new Ne(Fi),i=this.An(n,e);if(i==null)return r;let s=Bx(n);if(s!=null){let o=e.data.field(s.fieldPath);if(Pu(o))for(let a of o.arrayValue.values||[])r=r.add(new Qs(n.indexId,e.key,this.Tn(a),i))}else r=r.add(new Qs(n.indexId,e.key,Pp,i));return r}wn(e,n,r,i,s){C("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);let o=[];return function(c,l,u,d,h){let f=c.getIterator(),p=l.getIterator(),m=Na(f),v=Na(p);for(;m||v;){let b=!1,F=!1;if(m&&v){let T=u(m,v);T<0?F=!0:T>0&&(b=!0)}else m!=null?F=!0:b=!0;b?(d(v),v=Na(p)):F?(h(m),m=Na(f)):(m=Na(f),v=Na(p))}}(i,s,Fi,a=>{o.push(this.Sn(e,n,r,a))},a=>{o.push(this.bn(e,n,r,a))}),_.waitFor(o)}gn(e){let n=1;return Pa(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Fi(o,a)).filter((o,a,c)=>!a||Fi(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=Fi(o,e),c=Fi(o,n);if(a===0)i[0]=e.Jt();else if(a>0&&c<0)i.push(o),i.push(o.Jt());else if(c>0)break}i.push(n);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Pp,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Pp,[]];s.push(IDBKeyRange.bound(a,c))}return s}Dn(e,n){return Fi(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(GN)}getMinOffset(e,n){return _.mapArray(this.cn(n),r=>this.ln(e,r).next(i=>i||k())).next(GN)}};function qN(t){return Et(t,"collectionParents")}function Ra(t){return Et(t,"indexEntries")}function yu(t){return Et(t,"indexConfiguration")}function Pa(t){return Et(t,"indexState")}function GN(t){L(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){let i=t[r].indexState.offset;RE(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Vn(e.readTime,e.documentKey,n)}var zN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},On=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function dP(t,e,n){let r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId),a=0,c=r.Y({range:o},(u,d,h)=>(a++,h.delete()));s.push(c.next(()=>{L(a===1)}));let l=[];for(let u of n.mutations){let d=yR(e,u.key.path,n.batchId);s.push(i.delete(d)),l.push(u.key)}return _.waitFor(s).next(()=>l)}function lg(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw k();e=t.noDocument}return JSON.stringify(e).length}On.DEFAULT_COLLECTION_PERCENTILE=10,On.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,On.DEFAULT=new On(41943040,On.DEFAULT_COLLECTION_PERCENTILE,On.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),On.DISABLED=new On(-1,0,0);var ug=class t{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,n,r,i){L(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new t(s,n,r,i)}checkEmpty(e){let n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Vi(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){let s=ja(e),o=Vi(e);return o.add({}).next(a=>{L(typeof a=="number");let c=new Ou(a,n,r,i),l=function(f,p,m){let v=m.baseMutations.map(F=>Bu(f.ct,F)),b=m.mutations.map(F=>Bu(f.ct,F));return{userId:p,batchId:m.batchId,localWriteTimeMs:m.localWriteTime.toMillis(),baseMutations:v,mutations:b}}(this.serializer,this.userId,c),u=[],d=new Ne((h,f)=>J(h.canonicalString(),f.canonicalString()));for(let h of i){let f=yR(this.userId,h.key.path,a);d=d.add(h.key.path.popLast()),u.push(o.put(l)),u.push(s.put(f,q6))}return d.forEach(h=>{u.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Cn[a]=c.keys()}),_.waitFor(u).next(()=>c)})}lookupMutationBatch(e,n){return Vi(e).get(n).next(r=>r?(L(r.userId===this.userId),Ws(this.serializer,r)):null)}vn(e,n){return this.Cn[n]?_.resolve(this.Cn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){let i=r.keys();return this.Cn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return Vi(e).Y({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(L(a.batchId>=r),s=Ws(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Vi(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Vi(e).W("userMutationsIndex",n).next(r=>r.map(i=>Ws(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){let r=Vp(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return ja(e).Y({range:i},(o,a,c)=>{let[l,u,d]=o,h=br(u);if(l===this.userId&&n.path.isEqual(h))return Vi(e).get(d).next(f=>{if(!f)throw k();L(f.userId===this.userId),s.push(Ws(this.serializer,f))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ne(J),i=[];return n.forEach(s=>{let o=Vp(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=ja(e).Y({range:a},(l,u,d)=>{let[h,f,p]=l,m=br(f);h===this.userId&&s.path.isEqual(m)?r=r.add(p):d.done()});i.push(c)}),_.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=Vp(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new Ne(J);return ja(e).Y({range:o},(c,l,u)=>{let[d,h,f]=c,p=br(h);d===this.userId&&r.isPrefixOf(p)?p.length===i&&(a=a.add(f)):u.done()}).next(()=>this.Fn(e,a))}Fn(e,n){let r=[],i=[];return n.forEach(s=>{i.push(Vi(e).get(s).next(o=>{if(o===null)throw k();L(o.userId===this.userId),r.push(Ws(this.serializer,o))}))}),_.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return dP(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Mn(n.batchId)}),_.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return _.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return ja(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=br(s[1]);i.push(c)}else a.done()}).next(()=>{L(i.length===0)})})}containsKey(e,n){return hP(e,this.userId,n)}xn(e){return fP(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function hP(t,e,n){let r=Vp(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return ja(t).Y({range:s,J:!0},(a,c,l)=>{let[u,d,h]=a;u===e&&d===i&&(o=!0),l.done()}).next(()=>o)}function Vi(t){return Et(t,"mutations")}function ja(t){return Et(t,"documentMutations")}function fP(t){return Et(t,"mutationQueues")}var Xa=class t{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new t(0)}static Ln(){return new t(-1)}};var Iw=class{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Bn(e).next(n=>{let r=new Xa(n.highestTargetId);return n.highestTargetId=r.next(),this.kn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(n=>$.fromTimestamp(new Ue(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.kn(e,i)))}addTargetData(e,n){return this.qn(e,n).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.Qn(n,r),this.kn(e,r))))}updateTargetData(e,n){return this.qn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>ka(e).delete(n.targetId)).next(()=>this.Bn(e)).next(r=>(L(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,n,r){let i=0,s=[];return ka(e).Y((o,a)=>{let c=Eu(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>_.waitFor(s)).next(()=>i)}forEachTarget(e,n){return ka(e).Y((r,i)=>{let s=Eu(i);n(s)})}Bn(e){return WN(e).get("targetGlobalKey").next(n=>(L(n!==null),n))}kn(e,n){return WN(e).put("targetGlobalKey",n)}qn(e,n){return ka(e).put(cP(this.serializer,n))}Qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(n=>n.targetCount)}getTargetData(e,n){let r=to(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return ka(e).Y({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let l=Eu(a);Zu(n,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,n,r){let i=[],s=Li(e);return n.forEach(o=>{let a=Qt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),_.waitFor(i)}removeMatchingKeys(e,n,r){let i=Li(e);return _.forEach(n,s=>{let o=Qt(s.path);return _.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){let r=Li(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){let r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Li(e),s=re();return i.Y({range:r,J:!0},(o,a,c)=>{let l=br(o[1]),u=new M(l);s=s.add(u)}).next(()=>s)}containsKey(e,n){let r=Qt(n.path),i=IDBKeyRange.bound([r],[fR(r)],!1,!0),s=0;return Li(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}_t(e,n){return ka(e).get(n).next(r=>r?Eu(r):null)}};function ka(t){return Et(t,"targets")}function WN(t){return Et(t,"targetGlobal")}function Li(t){return Et(t,"targetDocuments")}function KN([t,e],[n,r]){let i=J(t,n);return i===0?J(e,r):i}var bw=class{constructor(e){this.Kn=e,this.buffer=new Ne(KN),this.$n=0}Un(){return++this.$n}Wn(e){let n=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();KN(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},Dw=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){C("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>g(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ji(n)?C("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield Xi(n)}yield this.zn(3e5)}))}},Tw=class{constructor(e,n){this.jn=e,this.params=n}calculateTargetCount(e,n){return this.jn.Hn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return _.resolve(vn._e);let r=new bw(n);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(C("LruGarbageCollector","Garbage collection skipped; disabled"),_.resolve(zN)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(C("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),zN):this.Yn(e,n))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,n){let r,i,s,o,a,c,l,u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(C("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(l=Date.now(),Oa()<=Dn.DEBUG&&C("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${d} documents in `+(l-c)+`ms
Total Duration: ${l-u}ms`),_.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}};function L8(t,e){return new Tw(t,e)}var Sw=class{constructor(e,n){this.db=e,this.garbageCollector=L8(this,n)}Hn(e){let n=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Zn(e){let n=0;return this.Jn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Jn(e,n){return this.Xn(e,(r,i)=>n(i))}addReference(e,n,r){return kp(e,r)}removeReference(e,n,r){return kp(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return kp(e,n)}er(e,n){return function(i,s){let o=!1;return fP(i).Z(a=>hP(i,a,s).next(c=>(c&&(o=!0),_.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=n){let c=this.er(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,$.min()),Li(e).delete(function(d){return[0,Qt(d.path)]}(o))))});i.push(c)}}).next(()=>_.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return kp(e,n)}Xn(e,n){let r=Li(e),i,s=vn._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(s!==vn._e&&n(new M(br(i)),s),s=l,i=c):s=vn._e}).next(()=>{s!==vn._e&&n(new M(br(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function kp(t,e){return Li(t).put(function(r,i){return{targetId:0,path:Qt(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}var dg=class{constructor(){this.changes=new Rr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,lt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?_.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Aw=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return qs(e).put(r)}removeEntry(e,n,r){return qs(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],sg(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.tr(e,r)))}getEntry(e,n){let r=lt.newInvalidDocument(n);return qs(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(vu(n))},(i,s)=>{r=this.nr(n,s)}).next(()=>r)}rr(e,n){let r={size:0,document:lt.newInvalidDocument(n)};return qs(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(vu(n))},(i,s)=>{r={document:this.nr(n,s),size:lg(s)}}).next(()=>r)}getEntries(e,n){let r=hn();return this.ir(e,n,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,n){let r=hn(),i=new Ve(M.comparator);return this.ir(e,n,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,lg(o))}).next(()=>({documents:r,_r:i}))}ir(e,n,r){if(n.isEmpty())return _.resolve();let i=new Ne(ZN);n.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(vu(i.first()),vu(i.last())),o=i.getIterator(),a=o.getNext();return qs(e).Y({index:"documentKeyIndex",range:s},(c,l,u)=>{let d=M.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&ZN(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?u.U(vu(a)):u.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){let o=n.path,a=[o.popLast().toArray(),o.lastSegment(),sg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return qs(e).W(IDBKeyRange.bound(a,c,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let u=hn();for(let d of l){let h=this.nr(M.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);h.isFoundDocument()&&(Ju(n,h)||i.has(h.key))&&(u=u.insert(h.key,h))}return u})}getAllFromCollectionGroup(e,n,r,i){let s=hn(),o=YN(n,r),a=YN(n,Vn.max());return qs(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,u)=>{let d=this.nr(M.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(d.key,d),s.size===i&&u.done()}).next(()=>s)}newChangeBuffer(e){return new Mw(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return QN(e).get("remoteDocumentGlobalKey").next(n=>(L(!!n),n))}tr(e,n){return QN(e).put("remoteDocumentGlobalKey",n)}nr(e,n){if(n){let r=O8(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual($.min())))return r}return lt.newInvalidDocument(e)}};function pP(t){return new Aw(t)}var Mw=class extends dg{constructor(e,n){super(),this.ar=e,this.trackRemovals=n,this.ur=new Rr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let n=[],r=0,i=new Ne((s,o)=>J(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(n.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=FN(this.ar.serializer,o);i=i.add(s.path.popLast());let l=lg(c);r+=l-a.size,n.push(this.ar.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=FN(this.ar.serializer,o.convertToNoDocument($.min()));n.push(this.ar.addEntry(e,s,c))}}),i.forEach(s=>{n.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.ar.updateMetadata(e,r)),_.waitFor(n)}getFromCache(e,n){return this.ar.rr(e,n).next(r=>(this.ur.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.ar.sr(e,n).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function QN(t){return Et(t,"remoteDocumentGlobal")}function qs(t){return Et(t,"remoteDocumentsV14")}function vu(t){let e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function YN(t,e){let n=e.documentKey.path.toArray();return[t,sg(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function ZN(t,e){let n=t.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=J(n[s],r[s]),i)return i;return i=J(n.length,r.length),i||(i=J(n[n.length-2],r[r.length-2]),i||J(n[n.length-1],r[r.length-1]))}var Nw=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var hg=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&bu(r.mutation,i,xn.empty(),Ue.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,re()).next(()=>r))}getLocalViewOfDocuments(e,n,r=re()){let i=Dr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=wu();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=Dr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,re()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=hn(),o=Iu(),a=function(){return Iu()}();return n.forEach((c,l)=>{let u=r.get(l.key);i.has(l.key)&&(u===void 0||u.mutation instanceof nr)?s=s.insert(l.key,l):u!==void 0?(o.set(l.key,u.mutation.getFieldMask()),bu(u.mutation,l,u.mutation.getFieldMask(),Ue.now())):o.set(l.key,xn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,u)=>o.set(l,u)),n.forEach((l,u)=>{var d;return a.set(l,new Nw(u,(d=o.get(l))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){let r=Iu(),i=new Ve((o,a)=>o-a),s=re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=n.get(c);if(l===null)return;let u=r.get(c)||xn.empty();u=a.applyToLocalView(l,u),r.set(c,u);let d=(i.get(a.batchId)||re()).add(c);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,u=c.value,d=VR();u.forEach(h=>{if(!s.has(h)){let f=GR(n.get(h),r.get(h));f!==null&&d.set(h,f),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,d))}return _.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return M.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):FE(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):_.resolve(Dr()),a=-1,c=s;return o.next(l=>_.forEach(l,(u,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(u)?_.resolve():this.remoteDocumentCache.getEntry(e,u).next(h=>{c=c.insert(u,h)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,re())).next(u=>({batchId:a,changes:FR(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new M(n)).next(r=>{let i=wu();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=wu();return this.indexManager.getCollectionParents(e,s).next(a=>_.forEach(a,c=>{let l=function(d,h){return new tr(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(u=>{u.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((c,l)=>{let u=l.getKey();o.get(u)===null&&(o=o.insert(u,lt.newInvalidDocument(u)))});let a=wu();return o.forEach((c,l)=>{let u=s.get(c);u!==void 0&&bu(u.mutation,l,xn.empty(),Ue.now()),Ju(n,l)&&(a=a.insert(c,l))}),a})}};var Rw=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return _.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Ze(i.createTime)}}(n)),_.resolve()}getNamedQuery(e,n){return _.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(i){return{name:i.name,query:jE(i.bundledQuery),readTime:Ze(i.readTime)}}(n)),_.resolve()}};var Pw=class{constructor(){this.overlays=new Ve(M.comparator),this.hr=new Map}getOverlay(e,n){return _.resolve(this.overlays.get(n))}getOverlays(e,n){let r=Dr();return _.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),_.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),_.resolve()}getOverlaysForCollection(e,n,r){let i=Dr(),s=n.length+1,o=new M(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return _.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Ve((l,u)=>l-u),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let u=s.get(l.largestBatchId);u===null&&(u=Dr(),s=s.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}let a=Dr(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=i)););return _.resolve(a)}ht(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Fu(n,r));let s=this.hr.get(n);s===void 0&&(s=re(),this.hr.set(n,s)),this.hr.set(n,s.add(r.key))}};var $u=class{constructor(){this.Pr=new Ne(ot.Ir),this.Tr=new Ne(ot.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){let r=new ot(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new ot(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){let n=new M(new ye([])),r=new ot(n,e),i=new ot(n,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let n=new M(new ye([])),r=new ot(n,e),i=new ot(n,e+1),s=re();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new ot(e,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},ot=class{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return M.comparator(e.key,n.key)||J(e.pr,n.pr)}static Er(e,n){return J(e.pr,n.pr)||M.comparator(e.key,n.key)}};var kw=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new Ne(ot.Ir)}checkEmpty(e){return _.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Ou(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new ot(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return _.resolve(o)}lookupMutationBatch(e,n){return _.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.br(r),s=i<0?0:i;return _.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return _.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return _.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new ot(n,0),i=new ot(n,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),_.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ne(J);return n.forEach(i=>{let s=new ot(i,0),o=new ot(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),_.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;M.isDocumentKey(s)||(s=s.child(""));let o=new ot(new M(s),0),a=new Ne(J);return this.wr.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.pr)),!0)},o),_.resolve(this.Dr(a))}Dr(e){let n=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){L(this.Cr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return _.forEach(n.mutations,i=>{let s=new ot(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){let r=new ot(n,0),i=this.wr.firstAfterOrEqual(r);return _.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,_.resolve()}Cr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var Ow=class{constructor(e){this.vr=e,this.docs=function(){return new Ve(M.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return _.resolve(r?r.document.mutableCopy():lt.newInvalidDocument(n))}getEntries(e,n){let r=hn();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():lt.newInvalidDocument(i))}),_.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=hn(),o=n.path,a=new M(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:u}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||RE(gR(u),r)<=0||(i.has(u.key)||Ju(n,u))&&(s=s.insert(u.key,u.mutableCopy()))}return _.resolve(s)}getAllFromCollectionGroup(e,n,r,i){k()}Fr(e,n){return _.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Fw(this)}getSize(e){return _.resolve(this.size)}},Fw=class extends dg{constructor(e){super(),this.ar=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),_.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}};var Vw=class{constructor(e){this.persistence=e,this.Mr=new Rr(n=>to(n),Zu),this.lastRemoteSnapshotVersion=$.min(),this.highestTargetId=0,this.Or=0,this.Nr=new $u,this.targetCount=0,this.Lr=Xa.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,i)=>n(i)),_.resolve()}getLastRemoteSnapshotVersion(e){return _.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return _.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),_.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),_.resolve()}qn(e){this.Mr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Lr=new Xa(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,_.resolve()}updateTargetData(e,n){return this.qn(n),_.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,_.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),_.waitFor(s).next(()=>i)}getTargetCount(e){return _.resolve(this.targetCount)}getTargetData(e,n){let r=this.Mr.get(n)||null;return _.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),_.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),_.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),_.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Nr.gr(n);return _.resolve(r)}containsKey(e,n){return _.resolve(this.Nr.containsKey(n))}};var fg=class{constructor(e,n){this.Br={},this.overlays={},this.kr=new vn(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new Vw(this),this.indexManager=new Ew,this.remoteDocumentCache=function(i){return new Ow(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new ig(n),this.$r=new Rw(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Pw,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new kw(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){C("MemoryPersistence","Starting transaction:",e);let i=new Lw(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,n){return _.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}},Lw=class extends zp{constructor(e){super(),this.currentSequenceNumber=e}},pg=class t{constructor(e){this.persistence=e,this.zr=new $u,this.jr=null}static Hr(e){return new t(e)}get Jr(){if(this.jr)return this.jr;throw k()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),_.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),_.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),_.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return _.forEach(this.Jr,r=>{let i=M.fromPath(r);return this.Yr(e,i).next(s=>{s||n.removeEntry(i,$.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return _.or([()=>_.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}};var jw=class{constructor(e){this.serializer=e}N(e,n,r,i){let s=new Wp("createOrUpgrade",n);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",pN,{unique:!0}),c.createObjectStore("documentMutations")}(e),XN(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=_.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),XN(e)),o=o.next(()=>function(c){let l=c.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:$.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",u)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,l){return l.store("mutations").W().next(u=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",pN,{unique:!0});let d=l.store("mutations"),h=u.map(f=>d.put(f));return _.waitFor(h)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let l=c.createObjectStore("documentOverlays",{keyPath:n8});l.createIndex("collectionPathOverlayIndex",r8,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",i8,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let l=c.createObjectStore("remoteDocumentsV14",{keyPath:G6});l.createIndex("documentKeyIndex",z6),l.createIndex("collectionGroupIndex",W6)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:X6}).createIndex("sequenceNumberIndex",J6,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:e8}).createIndex("documentKeyIndex",t8,{unique:!1})}(e))),o}ei(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=lg(i)}).next(()=>{let r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>_.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>_.forEach(a,c=>{L(c.userId===s.userId);let l=Ws(this.serializer,c);return dP(e,s.userId,l).next(()=>{})}))}))}ti(e){let n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.Y((o,a)=>{let c=new ye(o),l=function(d){return[0,Qt(d)]}(c);s.push(n.get(l).next(u=>u?_.resolve():(d=>n.put({targetId:0,path:Qt(d),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>_.waitFor(s))})}ni(e,n){e.createObjectStore("collectionParents",{keyPath:Z6});let r=n.store("collectionParents"),i=new Uu,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:Qt(c)})}};return n.store("remoteDocuments").Y({J:!0},(o,a)=>{let c=new ye(o);return s(c.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([o,a,c],l)=>{let u=br(a);return s(u.popLast())}))}ri(e){let n=e.store("targets");return n.Y((r,i)=>{let s=Eu(i),o=cP(this.serializer,s);return n.put(o)})}ii(e,n){let r=n.store("remoteDocuments"),i=[];return r.Y((s,o)=>{let a=n.store("remoteDocumentsV14"),c=function(d){return d.document?new M(ye.fromString(d.document.name).popFirst(5)):d.noDocument?M.fromSegments(d.noDocument.path):d.unknownDocument?M.fromSegments(d.unknownDocument.path):k()}(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(l))}).next(()=>_.waitFor(i))}si(e,n){let r=n.store("mutations"),i=pP(this.serializer),s=new fg(pg.Hr,this.serializer.ct);return r.W().next(o=>{let a=new Map;return o.forEach(c=>{var l;let u=(l=a.get(c.userId))!==null&&l!==void 0?l:re();Ws(this.serializer,c).keys().forEach(d=>u=u.add(d)),a.set(c.userId,u)}),_.forEach(a,(c,l)=>{let u=new at(l),d=og.lt(this.serializer,u),h=s.getIndexManager(u),f=ug.lt(u,this.serializer,h,s.referenceDelegate);return new hg(i,f,d,h).recalculateAndSaveOverlaysForDocumentKeys(new Mu(n,vn._e),c).next()})})}};function XN(t){t.createObjectStore("targetDocuments",{keyPath:Q6}).createIndex("documentTargetsIndex",Y6,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",K6,{unique:!0}),t.createObjectStore("targetGlobal")}var Mx="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Bw=class t{constructor(e,n,r,i,s,o,a,c,l,u,d=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=l,this.ai=u,this.ui=d,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=h=>Promise.resolve(),!t.D())throw new w(y.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Sw(this,i),this.Ti=n+"main",this.serializer=new ig(c),this.Ei=new ri(this.Ti,this.ui,new jw(this.serializer)),this.Qr=new Iw(this.referenceDelegate,this.serializer),this.remoteDocumentCache=pP(this.serializer),this.$r=new gw,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,u===!1&&Qe("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new w(y.FAILED_PRECONDITION,Mx);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new vn(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=n=>g(this,null,function*(){if(this.started)return e(n)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.B(n=>g(this,null,function*(){n.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>g(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Op(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(n=>{n||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(n=>this.isPrimary&&!n?this.yi(e).next(()=>!1):!!n&&this.wi(e).next(()=>!0))).catch(e=>{if(Ji(e))return C("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return C("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return xu(e).get("owner").next(n=>_.resolve(this.Si(n)))}bi(e){return Op(e).delete(this.clientId)}Di(){return g(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{let r=Et(n,"clientMetadata");return r.W().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return _.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let n of e)this.di.removeItem(this.Fi(n.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?_.resolve(!0):xu(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)){if(this.Si(n)&&this.networkEnabled)return!0;if(!this.Si(n)){if(!n.allowTabSynchronization)throw new w(y.FAILED_PRECONDITION,Mx);return!1}}return!(!this.networkEnabled||!this.inForeground)||Op(e).W().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&C("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return g(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let n=new Mu(e,vn._e);return this.yi(n).next(()=>this.bi(n))}),this.Ei.close(),this.Li()})}vi(e,n){return e.filter(r=>this.Ci(r.updateTimeMs,n)&&!this.Mi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>Op(e).W().next(n=>this.vi(n,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,n){return ug.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Cw(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return og.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,n,r){C("IndexedDbPersistence","Starting transaction:",e);let i=n==="readonly"?"readonly":"readwrite",s=function(c){return c===15?o8:c===14?wR:c===13?xR:c===12?s8:c===11?vR:void k()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new Mu(a,this.kr?this.kr.next():vn._e),n==="readwrite-primary"?this.gi(o).next(c=>!!c||this.pi(o)).next(c=>{if(!c)throw Qe(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new w(y.FAILED_PRECONDITION,mR);return r(o)}).next(c=>this.wi(o).next(()=>c)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return xu(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)&&!this.Si(n)&&!(this.ai||this.allowTabSynchronization&&n.allowTabSynchronization))throw new w(y.FAILED_PRECONDITION,Mx)})}wi(e){let n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return xu(e).put("owner",n)}static D(){return ri.D()}yi(e){let n=xu(e);return n.get("owner").next(r=>this.Si(r)?(C("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):_.resolve())}Ci(e,n){let r=Date.now();return!(e<r-n)&&(!(e>r)||(Qe(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let n=/(?:Version|Mobile)\/1[456]/;i_()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var n;try{let r=((n=this.di)===null||n===void 0?void 0:n.getItem(this.Fi(e)))!==null;return C("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Qe("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){Qe("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function xu(t){return Et(t,"owner")}function Op(t){return Et(t,"clientMetadata")}function UE(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Uw=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=i}static Ki(e,n){let r=re(),i=re();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var $w=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var gg=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return i_()?8:ri.v(Bc())>0?6:4}()}initialize(e,n){this.zi=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.ji(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new $w;return this.Ji(e,n,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,n,o,a.size)})}).next(()=>s.result)}Yi(e,n,r,i){return r.documentReadCount<this.Wi?(Oa()<=Dn.DEBUG&&C("QueryEngine","SDK will not create cache indexes for query:",Fa(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),_.resolve()):(Oa()<=Dn.DEBUG&&C("QueryEngine","Query:",Fa(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(Oa()<=Dn.DEBUG&&C("QueryEngine","The SDK decides to create cache indexes for query:",Fa(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Yt(n))):_.resolve())}ji(e,n){if(bN(n))return _.resolve(null);let r=Yt(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=eg(n,null,"F"),r=Yt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=re(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.Zi(n,a);return this.Xi(n,l,o,c.readTime)?this.ji(e,eg(n,null,"F")):this.es(e,l,n,c)}))})))}Hi(e,n,r,i){return bN(n)||i.isEqual($.min())?_.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(n,s);return this.Xi(n,o,r,i)?_.resolve(null):(Oa()<=Dn.DEBUG&&C("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Fa(n)),this.es(e,o,n,pR(i,-1)).next(a=>a))})}Zi(e,n){let r=new Ne(kR(e));return n.forEach((i,s)=>{Ju(e,s)&&(r=r.add(s))}),r}Xi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,n,r){return Oa()<=Dn.DEBUG&&C("QueryEngine","Using full collection scan to execute query:",Fa(n)),this.zi.getDocumentsMatchingQuery(e,n,Vn.min(),r)}es(e,n,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Hw=class{constructor(e,n,r,i){this.persistence=e,this.ts=n,this.serializer=i,this.ns=new Ve(J),this.rs=new Rr(s=>to(s),Zu),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new hg(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ns))}};function gP(t,e,n,r){return new Hw(t,e,n,r)}function mP(t,e){return g(this,null,function*(){let n=N(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n._s(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=re();for(let l of i){o.push(l.batchId);for(let u of l.mutations)c=c.add(u.key)}for(let l of s){a.push(l.batchId);for(let u of l.mutations)c=c.add(u.key)}return n.localDocuments.getDocuments(r,c).next(l=>({us:l,removedBatchIds:o,addedBatchIds:a}))})})})}function j8(t,e){let n=N(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(a,c,l,u){let d=l.batch,h=d.keys(),f=_.resolve();return h.forEach(p=>{f=f.next(()=>u.getEntry(c,p)).next(m=>{let v=l.docVersions.get(p);L(v!==null),m.version.compareTo(v)<0&&(d.applyToRemoteDocument(m,l),m.isValidDocument()&&(m.setReadTime(l.commitVersion),u.addEntry(m)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(c,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=re();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function _P(t){let e=N(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function B8(t,e){let n=N(t),r=e.snapshotVersion,i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;let a=[];e.targetChanges.forEach((u,d)=>{let h=i.get(d);if(!h)return;a.push(n.Qr.removeMatchingKeys(s,u.removedDocuments,d).next(()=>n.Qr.addMatchingKeys(s,u.addedDocuments,d)));let f=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(wt.EMPTY_BYTE_STRING,$.min()).withLastLimboFreeSnapshotVersion($.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,r)),i=i.insert(d,f),function(m,v,b){return m.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=3e8?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(h,f,u)&&a.push(n.Qr.updateTargetData(s,f))});let c=hn(),l=re();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(yP(s,o,e.documentUpdates).next(u=>{c=u.cs,l=u.ls})),!r.isEqual($.min())){let u=n.Qr.getLastRemoteSnapshotVersion(s).next(d=>n.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(u)}return _.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(n.ns=i,s))}function yP(t,e,n){let r=re(),i=re();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=hn();return n.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual($.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):C("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{cs:o,ls:i}})}function U8(t,e){let n=N(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Ja(t,e){let n=N(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Qr.getTargetData(r,e).next(s=>s?(i=s,_.resolve(i)):n.Qr.allocateTargetId(r).next(o=>(i=new Za(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(r.targetId,r),n.rs.set(e,r.targetId)),r})}function ec(t,e,n){return g(this,null,function*(){let r=N(t),i=r.ns.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Ji(o))throw o;C("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function mg(t,e,n){let r=N(t),i=$.min(),s=re();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,u){let d=N(c),h=d.rs.get(u);return h!==void 0?_.resolve(d.ns.get(h)):d.Qr.getTargetData(l,u)}(r,o,Yt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,n?i:$.min(),n?s:re())).next(a=>(wP(r,PR(e),a),{documents:a,hs:s})))}function vP(t,e){let n=N(t),r=N(n.Qr),i=n.ns.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function xP(t,e){let n=N(t),r=n.ss.get(e)||$.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.os.getAllFromCollectionGroup(i,e,pR(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(wP(n,e,i),i))}function wP(t,e,n){let r=t.ss.get(e)||$.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.ss.set(e,r)}function $8(t,e,n,r){return g(this,null,function*(){let i=N(t),s=re(),o=hn();for(let l of n){let u=e.Ps(l.metadata.name);l.document&&(s=s.add(u));let d=e.Is(l);d.setReadTime(e.Ts(l.metadata.readTime)),o=o.insert(u,d)}let a=i.os.newChangeBuffer({trackRemovals:!0}),c=yield Ja(i,function(u){return Yt(cc(ye.fromString(`__bundle__/docs/${u}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>yP(l,a,o).next(u=>(a.apply(l),u)).next(u=>i.Qr.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.Qr.addMatchingKeys(l,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,u.cs,u.ls)).next(()=>u.cs)))})}function H8(r,i){return g(this,arguments,function*(t,e,n=re()){let s=yield Ja(t,Yt(jE(e.bundledQuery))),o=N(t);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=Ze(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.$r.saveNamedQuery(a,e);let l=s.withResumeToken(wt.EMPTY_BYTE_STRING,c);return o.ns=o.ns.insert(l.targetId,l),o.Qr.updateTargetData(a,l).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,n,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function JN(t,e){return`firestore_clients_${t}_${e}`}function eR(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Nx(t,e){return`firestore_targets_${t}_${e}`}var _g=class t{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Es(e,n,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new w(i.error.code,i.error.message))),o?new t(e,n,i.state,s):(Qe("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Du=class t{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Es(e,n){let r=JSON.parse(n),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new w(r.error.code,r.error.message))),s?new t(e,r.state,i):(Qe("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},yg=class t{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Es(e,n){let r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=VE();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=_R(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new t(e,s):(Qe("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}},qw=class t{constructor(e,n){this.clientId=e,this.onlineState=n}static Es(e){let n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t(n.clientId,n.onlineState):(Qe("SharedClientState",`Failed to parse online state: ${e}`),null)}},Hu=class{constructor(){this.activeTargetIds=VE()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Tu=class{constructor(e,n,r,i,s){this.window=e,this.oi=n,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new Ve(J),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=JN(this.persistenceKey,this.Vs),this.Ss=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new Hu),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Fs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return g(this,null,function*(){let e=yield this.syncEngine.Bi();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(JN(this.persistenceKey,r));if(i){let s=yg.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let n=this.storage.getItem(this.vs);if(n){let r=this.xs(n);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let n=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,n,r){this.Ls(e,n,r),this.Bs(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(Nx(this.persistenceKey,e));if(r){let i=Du.Es(e,r);i&&(n=i.state)}}return this.ks.As(e),this.Ms(),n}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Nx(this.persistenceKey,e))}updateQueryState(e,n,r){this.qs(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let n=this.storage.getItem(e);return C("SharedClientState","READ",e,n),n}setItem(e,n){C("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){C("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let n=e;if(n.storageArea===this.storage){if(C("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ws)return void Qe("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>g(this,null,function*(){if(this.started){if(n.key!==null){if(this.bs.test(n.key)){if(n.newValue==null){let r=this.$s(n.key);return this.Us(r,null)}{let r=this.Ws(n.key,n.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){let r=this.Gs(n.key,n.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(n.key)){if(n.newValue!==null){let r=this.js(n.key,n.newValue);if(r)return this.Hs(r)}}else if(n.key===this.vs){if(n.newValue!==null){let r=this.xs(n.newValue);if(r)return this.Os(r)}}else if(n.key===this.Ss){let r=function(s){let o=vn._e;if(s!=null)try{let a=JSON.parse(s);L(typeof a=="number"),o=a}catch(a){Qe("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==vn._e&&this.sequenceNumberHandler(r)}else if(n.key===this.Fs){let r=this.Js(n.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(n)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,n,r){let i=new _g(this.currentUser,e,n,r),s=eR(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Bs(e){let n=eR(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Qs(e){let n={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(n))}qs(e,n,r){let i=Nx(this.persistenceKey,e),s=new Du(e,n,r);this.setItem(i,s.ds())}Ks(e){let n=JSON.stringify(Array.from(e));this.setItem(this.Fs,n)}$s(e){let n=this.bs.exec(e);return n?n[1]:null}Ws(e,n){let r=this.$s(e);return yg.Es(r,n)}Gs(e,n){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return _g.Es(new at(s),i,n)}js(e,n){let r=this.Cs.exec(e),i=Number(r[1]);return Du.Es(i,n)}xs(e){return qw.Es(e)}Js(e){return JSON.parse(e)}zs(e){return g(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);C("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,n){let r=n?this.ps.insert(e,n):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let n=VE();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}},vg=class{constructor(){this.no=new Hu,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,n,r){this.ro[e]=n}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Hu,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Gw=class{io(e){}shutdown(){}};var xg=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){C("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){C("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Fp=null;function Rx(){return Fp===null?Fp=function(){return 268435456+Math.round(2147483648*Math.random())}():Fp++,"0x"+Fp.toString(16)}var q8={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var zw=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}};var Bt="WebChannelConnection",Ww=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.fo=r+"://"+n.host,this.po=`projects/${i}/databases/${s}`,this.yo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get wo(){return!1}So(n,r,i,s,o){let a=Rx(),c=this.bo(n,r.toUriEncodedString());C("RestConnection",`Sending RPC '${n}' ${a}:`,c,i);let l={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(l,s,o),this.Co(n,c,l,i).then(u=>(C("RestConnection",`Received RPC '${n}' ${a}: `,u),u),u=>{throw Fn("RestConnection",`RPC '${n}' ${a} failed with error: `,u,"url: ",c,"request:",i),u})}vo(n,r,i,s,o,a){return this.So(n,r,i,s,o)}Do(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ac}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}bo(n,r){let i=q8[n];return`${this.fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,n,r,i){let s=Rx();return new Promise((o,a)=>{let c=new lN;c.setWithCredentials(!0),c.listenOnce(aN.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Rp.NO_ERROR:let u=c.getResponseJson();C(Bt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(u)),o(u);break;case Rp.TIMEOUT:C(Bt,`RPC '${e}' ${s} timed out`),a(new w(y.DEADLINE_EXCEEDED,"Request time out"));break;case Rp.HTTP_ERROR:let d=c.getStatus();if(C(Bt,`RPC '${e}' ${s} failed with status:`,d,"response text:",c.getResponseText()),d>0){let h=c.getResponseJson();Array.isArray(h)&&(h=h[0]);let f=h?.error;if(f&&f.status&&f.message){let p=function(v){let b=v.toLowerCase().replace(/_/g,"-");return Object.values(y).indexOf(b)>=0?b:y.UNKNOWN}(f.status);a(new w(p,f.message))}else a(new w(y.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new w(y.UNAVAILABLE,"Connection failed."));break;default:k()}}finally{C(Bt,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);C(Bt,`RPC '${e}' ${s} sending request:`,i),c.send(n,"POST",l,r,15)})}Fo(e,n,r){let i=Rx(),s=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=sN(),a=oN(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Do(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;let u=s.join("");C(Bt,`Creating RPC '${e}' stream ${i}: ${u}`,c);let d=o.createWebChannel(u,c),h=!1,f=!1,p=new zw({lo:v=>{f?C(Bt,`Not sending because RPC '${e}' stream ${i} is closed:`,v):(h||(C(Bt,`Opening RPC '${e}' stream ${i} transport.`),d.open(),h=!0),C(Bt,`RPC '${e}' stream ${i} sending:`,v),d.send(v))},ho:()=>d.close()}),m=(v,b,F)=>{v.listen(b,T=>{try{F(T)}catch(q){setTimeout(()=>{throw q},0)}})};return m(d,mu.EventType.OPEN,()=>{f||C(Bt,`RPC '${e}' stream ${i} transport opened.`)}),m(d,mu.EventType.CLOSE,()=>{f||(f=!0,C(Bt,`RPC '${e}' stream ${i} transport closed`),p.Vo())}),m(d,mu.EventType.ERROR,v=>{f||(f=!0,Fn(Bt,`RPC '${e}' stream ${i} transport errored:`,v),p.Vo(new w(y.UNAVAILABLE,"The operation could not be completed")))}),m(d,mu.EventType.MESSAGE,v=>{var b;if(!f){let F=v.data[0];L(!!F);let T=F,q=T.error||((b=T[0])===null||b===void 0?void 0:b.error);if(q){C(Bt,`RPC '${e}' stream ${i} received error:`,q);let W=q.status,Z=function(t_){let Hd=st[t_];if(Hd!==void 0)return KR(Hd)}(W),Te=q.message;Z===void 0&&(Z=y.INTERNAL,Te="Unknown error status: "+W+" with message "+q.message),f=!0,p.Vo(new w(Z,Te)),d.close()}else C(Bt,`RPC '${e}' stream ${i} received:`,F),p.mo(F)}}),m(a,cN.STAT_EVENT,v=>{v.stat===Sx.PROXY?C(Bt,`RPC '${e}' stream ${i} detected buffering proxy`):v.stat===Sx.NOPROXY&&C(Bt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.Ro()},0),p}};function EP(){return typeof window<"u"?window:null}function Up(){return typeof document<"u"?document:null}function ed(t){return new uw(t,!0)}var qu=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=n,this.Mo=r,this.xo=i,this.Oo=s,this.No=0,this.Lo=null,this.Bo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();let n=Math.floor(this.No+this.Qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,n-r);i>0&&C("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Lo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){this.Lo!==null&&(this.Lo.skipDelay(),this.Lo=null)}cancel(){this.Lo!==null&&(this.Lo.cancel(),this.Lo=null)}Qo(){return(Math.random()-.5)*this.No}};var wg=class{constructor(e,n,r,i,s,o,a,c){this.oi=e,this.$o=r,this.Uo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new qu(e,n)}Ho(){return this.state===1||this.state===5||this.Jo()}Jo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Yo()}stop(){return g(this,null,function*(){this.Ho()&&(yield this.close(0))})}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&this.Go===null&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,()=>this.e_()))}t_(e){this.n_(),this.stream.send(e)}e_(){return g(this,null,function*(){if(this.Jo())return this.close(0)})}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}close(e,n){return g(this,null,function*(){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,e!==4?this.jo.reset():n&&n.code===y.RESOURCE_EXHAUSTED?(Qe(n.toString()),Qe("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):n&&n.code===y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.To(n)})}i_(){}auth(){this.state=1;let e=this.s_(this.Wo),n=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Wo===n&&this.o_(r,i)},r=>{e(()=>{let i=new w(y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.__(i)})})}o_(e,n){let r=this.s_(this.Wo);this.stream=this.a_(e,n),this.stream.Po(()=>{r(()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,()=>(this.Jo()&&(this.state=3),Promise.resolve())),this.listener.Po()))}),this.stream.To(i=>{r(()=>this.__(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Yo(){this.state=5,this.jo.qo(()=>g(this,null,function*(){this.state=0,this.start()}))}__(e){return C("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return n=>{this.oi.enqueueAndForget(()=>this.Wo===e?n():(C("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Kw=class extends wg{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}a_(e,n){return this.connection.Fo("Listen",e,n)}onMessage(e){this.jo.reset();let n=S8(this.serializer,e),r=function(s){if(!("targetChange"in s))return $.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?$.min():o.readTime?Ze(o.readTime):$.min()}(e);return this.listener.u_(n,r)}c_(e){let n={};n.database=fw(this.serializer),n.addTarget=function(s,o){let a,c=o.target;if(a=Xp(c)?{documents:nP(s,c)}:{query:rP(s,c).ut},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=YR(s,o.resumeToken);let l=dw(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo($.min())>0){a.readTime=Ya(s,o.snapshotVersion.toTimestamp());let l=dw(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=M8(this.serializer,e);r&&(n.labels=r),this.t_(n)}l_(e){let n={};n.database=fw(this.serializer),n.removeTarget=e,this.t_(n)}},Qw=class extends wg{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,n){return this.connection.Fo("Write",e,n)}onMessage(e){if(L(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();let n=A8(e.writeResults,e.commitTime),r=Ze(e.commitTime);return this.listener.T_(r,n)}return L(!e.writeResults||e.writeResults.length===0),this.h_=!0,this.listener.E_()}d_(){let e={};e.database=fw(this.serializer),this.t_(e)}I_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>Bu(this.serializer,r))};this.t_(n)}};var Yw=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new w(y.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,hw(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new w(y.UNKNOWN,s.toString())})}vo(e,n,r,i,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.vo(e,hw(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new w(y.UNKNOWN,o.toString())})}terminate(){this.A_=!0,this.connection.terminate()}};var Zw=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){this.m_===0&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve())))}S_(e){this.state==="Online"?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,e==="Online"&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(Qe(n),this.g_=!1):C("OnlineStateTracker",n)}b_(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}};var Xw=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=s,this.M_.io(o=>{r.enqueueAndForget(()=>g(this,null,function*(){es(this)&&(C("RemoteStore","Restarting streams for network reachability change."),yield function(c){return g(this,null,function*(){let l=N(c);l.v_.add(4),yield lc(l),l.x_.set("Unknown"),l.v_.delete(4),yield td(l)})}(this))}))}),this.x_=new Zw(r,i)}};function td(t){return g(this,null,function*(){if(es(t))for(let e of t.F_)yield e(!0)})}function lc(t){return g(this,null,function*(){for(let e of t.F_)yield e(!1)})}function Bg(t,e){let n=N(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),qE(n)?HE(n):dc(n).Jo()&&$E(n,e))}function tc(t,e){let n=N(t),r=dc(n);n.C_.delete(e),r.Jo()&&CP(n,e),n.C_.size===0&&(r.Jo()?r.Xo():es(n)&&n.x_.set("Unknown"))}function $E(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo($.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}dc(t).c_(e)}function CP(t,e){t.O_.Oe(e),dc(t).l_(e)}function HE(t){t.O_=new lw({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),dc(t).start(),t.x_.p_()}function qE(t){return es(t)&&!dc(t).Ho()&&t.C_.size>0}function es(t){return N(t).v_.size===0}function IP(t){t.O_=void 0}function G8(t){return g(this,null,function*(){t.C_.forEach((e,n)=>{$E(t,e)})})}function z8(t,e){return g(this,null,function*(){IP(t),qE(t)?(t.x_.S_(e),HE(t)):t.x_.set("Unknown")})}function W8(t,e,n){return g(this,null,function*(){if(t.x_.set("Online"),e instanceof ng&&e.state===2&&e.cause)try{yield function(i,s){return g(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.C_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.C_.delete(a),i.O_.removeTarget(a))})}(t,e)}catch(r){C("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Eg(t,r)}else if(e instanceof Ha?t.O_.$e(e):e instanceof tg?t.O_.Je(e):t.O_.Ge(e),!n.isEqual($.min()))try{let r=yield _P(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.O_.it(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let u=s.C_.get(l);u&&s.C_.set(l,u.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{let u=s.C_.get(c);if(!u)return;s.C_.set(c,u.withResumeToken(wt.EMPTY_BYTE_STRING,u.snapshotVersion)),CP(s,c);let d=new Za(u.target,c,l,u.sequenceNumber);$E(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){C("RemoteStore","Failed to raise snapshot:",r),yield Eg(t,r)}})}function Eg(t,e,n){return g(this,null,function*(){if(!Ji(e))throw e;t.v_.add(1),yield lc(t),t.x_.set("Offline"),n||(n=()=>_P(t.localStore)),t.asyncQueue.enqueueRetryable(()=>g(this,null,function*(){C("RemoteStore","Retrying IndexedDB access"),yield n(),t.v_.delete(1),yield td(t)}))})}function bP(t,e){return e().catch(n=>Eg(t,n,e))}function uc(t){return g(this,null,function*(){let e=N(t),n=Zi(e),r=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;K8(e);)try{let i=yield U8(e.localStore,r);if(i===null){e.D_.length===0&&n.Xo();break}r=i.batchId,Q8(e,i)}catch(i){yield Eg(e,i)}DP(e)&&TP(e)})}function K8(t){return es(t)&&t.D_.length<10}function Q8(t,e){t.D_.push(e);let n=Zi(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function DP(t){return es(t)&&!Zi(t).Ho()&&t.D_.length>0}function TP(t){Zi(t).start()}function Y8(t){return g(this,null,function*(){Zi(t).d_()})}function Z8(t){return g(this,null,function*(){let e=Zi(t);for(let n of t.D_)e.I_(n.mutations)})}function X8(t,e,n){return g(this,null,function*(){let r=t.D_.shift(),i=ow.from(r,e,n);yield bP(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield uc(t)})}function J8(t,e){return g(this,null,function*(){e&&Zi(t).P_&&(yield function(r,i){return g(this,null,function*(){if(function(o){return WR(o)&&o!==y.ABORTED}(i.code)){let s=r.D_.shift();Zi(r).Zo(),yield bP(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield uc(r)}})}(t,e)),DP(t)&&TP(t)})}function tR(t,e){return g(this,null,function*(){let n=N(t);n.asyncQueue.verifyOperationInProgress(),C("RemoteStore","RemoteStore received new credentials");let r=es(n);n.v_.add(3),yield lc(n),r&&n.x_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),yield td(n)})}function Jw(t,e){return g(this,null,function*(){let n=N(t);e?(n.v_.delete(2),yield td(n)):e||(n.v_.add(2),yield lc(n),n.x_.set("Unknown"))})}function dc(t){return t.N_||(t.N_=function(n,r,i){let s=N(n);return s.R_(),new Kw(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:G8.bind(null,t),To:z8.bind(null,t),u_:W8.bind(null,t)}),t.F_.push(e=>g(this,null,function*(){e?(t.N_.Zo(),qE(t)?HE(t):t.x_.set("Unknown")):(yield t.N_.stop(),IP(t))}))),t.N_}function Zi(t){return t.L_||(t.L_=function(n,r,i){let s=N(n);return s.R_(),new Qw(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:Y8.bind(null,t),To:J8.bind(null,t),E_:Z8.bind(null,t),T_:X8.bind(null,t)}),t.F_.push(e=>g(this,null,function*(){e?(t.L_.Zo(),yield uc(t)):(yield t.L_.stop(),t.D_.length>0&&(C("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.L_}var eE=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ct,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new w(y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function hc(t,e){if(Qe("AsyncQueue",`${e}: ${t}`),Ji(t))return new w(y.UNAVAILABLE,`${e}: ${t}`);throw t}var Cg=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||M.comparator(n.key,r.key):(n,r)=>M.comparator(n.key,r.key),this.keyedMap=wu(),this.sortedSet=new Ve(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var Ig=class{constructor(){this.B_=new Ve(M.comparator)}track(e){let n=e.doc.key,r=this.B_.get(n);r?e.type!==0&&r.type===3?this.B_=this.B_.insert(n,e):e.type===3&&r.type!==1?this.B_=this.B_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.B_=this.B_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.B_=this.B_.remove(n):e.type===1&&r.type===2?this.B_=this.B_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):k():this.B_=this.B_.insert(n,e)}k_(){let e=[];return this.B_.inorderTraversal((n,r)=>{e.push(r)}),e}},nc=class t{constructor(e,n,r,i,s,o,a,c,l){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,Cg.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var tE=class{constructor(){this.q_=void 0,this.Q_=[]}K_(){return this.Q_.some(e=>e.U_())}},nE=class{constructor(){this.queries=new Rr(e=>RR(e),Xu),this.onlineState="Unknown",this.W_=new Set}};function GE(t,e){return g(this,null,function*(){let n=N(t),r=3,i=e.query,s=n.queries.get(i);s?!s.K_()&&e.U_()&&(r=2):(s=new tE,r=e.U_()?0:1);try{switch(r){case 0:s.q_=yield n.onListen(i,!0);break;case 1:s.q_=yield n.onListen(i,!1);break;case 2:yield n.onFirstRemoteStoreListen(i)}}catch(o){let a=hc(o,`Initialization of query '${Fa(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Q_.push(e),e.G_(n.onlineState),s.q_&&e.z_(s.q_)&&WE(n)})}function zE(t,e){return g(this,null,function*(){let n=N(t),r=e.query,i=3,s=n.queries.get(r);if(s){let o=s.Q_.indexOf(e);o>=0&&(s.Q_.splice(o,1),s.Q_.length===0?i=e.U_()?0:1:!s.K_()&&e.U_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}})}function e$(t,e){let n=N(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.Q_)a.z_(i)&&(r=!0);o.q_=i}}r&&WE(n)}function t$(t,e,n){let r=N(t),i=r.queries.get(e);if(i)for(let s of i.Q_)s.onError(n);r.queries.delete(e)}function WE(t){t.W_.forEach(e=>{e.next()})}var rE,nR;(nR=rE||(rE={})).j_="default",nR.Cache="cache";var Gu=class{constructor(e,n,r){this.query=e,this.H_=n,this.J_=!1,this.Y_=null,this.onlineState="Unknown",this.options=r||{}}z_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new nc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.J_?this.Z_(e)&&(this.H_.next(e),n=!0):this.X_(e,this.onlineState)&&(this.ea(e),n=!0),this.Y_=e,n}onError(e){this.H_.error(e)}G_(e){this.onlineState=e;let n=!1;return this.Y_&&!this.J_&&this.X_(this.Y_,e)&&(this.ea(this.Y_),n=!0),n}X_(e,n){if(!e.fromCache||!this.U_())return!0;let r=n!=="Offline";return(!this.options.ta||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Z_(e){if(e.docChanges.length>0)return!0;let n=this.Y_&&this.Y_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ea(e){e=nc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.J_=!0,this.H_.next(e)}U_(){return this.options.source!==rE.Cache}};var iE=class{constructor(e,n){this.na=e,this.byteLength=n}ra(){return"metadata"in this.na}};var bg=class{constructor(e){this.serializer=e}Ps(e){return Sr(this.serializer,e)}Is(e){return e.metadata.exists?tP(this.serializer,e.document,!1):lt.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return Ze(e)}},sE=class{constructor(e,n,r){this.ia=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=SP(e)}sa(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.na.namedQuery)this.queries.push(e.na.namedQuery);else if(e.na.documentMetadata){this.documents.push({metadata:e.na.documentMetadata}),e.na.documentMetadata.exists||++n;let r=ye.fromString(e.na.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.na.document&&(this.documents[this.documents.length-1].document=e.na.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}oa(e){let n=new Map,r=new bg(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(n.get(o)||re()).add(s);n.set(o,a)}}return n}complete(){return g(this,null,function*(){let e=yield $8(this.localStore,new bg(this.serializer),this.documents,this.ia.id),n=this.oa(this.documents);for(let r of this.queries)yield H8(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,_a:this.collectionGroups,aa:e}})}};function SP(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Dg=class{constructor(e){this.key=e}},Tg=class{constructor(e){this.key=e}},Sg=class{constructor(e,n){this.query=e,this.ua=n,this.ca=null,this.hasCachedResults=!1,this.current=!1,this.la=re(),this.mutatedKeys=re(),this.ha=kR(e),this.Pa=new Cg(this.ha)}get Ia(){return this.ua}Ta(e,n){let r=n?n.Ea:new Ig,i=n?n.Pa:this.Pa,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,d)=>{let h=i.get(u),f=Ju(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),m=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations),v=!1;h&&f?h.data.isEqual(f.data)?p!==m&&(r.track({type:3,doc:f}),v=!0):this.da(h,f)||(r.track({type:2,doc:f}),v=!0,(c&&this.ha(f,c)>0||l&&this.ha(f,l)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),v=!0):h&&!f&&(r.track({type:1,doc:h}),v=!0,(c||l)&&(a=!0)),v&&(f?(o=o.add(f),s=m?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),r.track({type:1,doc:u})}return{Pa:o,Ea:r,Xi:a,mutatedKeys:s}}da(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.Pa;this.Pa=e.Pa,this.mutatedKeys=e.mutatedKeys;let o=e.Ea.k_();o.sort((u,d)=>function(f,p){let m=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return k()}};return m(f)-m(p)}(u.type,d.type)||this.ha(u.doc,d.doc)),this.Aa(r),i=i!=null&&i;let a=n&&!i?this.Ra():[],c=this.la.size===0&&this.current&&!i?1:0,l=c!==this.ca;return this.ca=c,o.length!==0||l?{snapshot:new nc(this.query,e.Pa,s,o,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),Va:a}:{Va:a}}G_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Pa:this.Pa,Ea:new Ig,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{Va:[]}}ma(e){return!this.ua.has(e)&&!!this.Pa.has(e)&&!this.Pa.get(e).hasLocalMutations}Aa(e){e&&(e.addedDocuments.forEach(n=>this.ua=this.ua.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ua=this.ua.delete(n)),this.current=e.current)}Ra(){if(!this.current)return[];let e=this.la;this.la=re(),this.Pa.forEach(r=>{this.ma(r.key)&&(this.la=this.la.add(r.key))});let n=[];return e.forEach(r=>{this.la.has(r)||n.push(new Tg(r))}),this.la.forEach(r=>{e.has(r)||n.push(new Dg(r))}),n}fa(e){this.ua=e.hs,this.la=re();let n=this.Ta(e.documents);return this.applyChanges(n,!0)}ga(){return nc.fromInitialDocuments(this.query,this.Pa,this.mutatedKeys,this.ca===0,this.hasCachedResults)}},oE=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},aE=class{constructor(e){this.key=e,this.pa=!1}},cE=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.ya={},this.wa=new Rr(a=>RR(a),Xu),this.Sa=new Map,this.ba=new Set,this.Da=new Ve(M.comparator),this.Ca=new Map,this.va=new $u,this.Fa={},this.Ma=new Map,this.xa=Xa.Ln(),this.onlineState="Unknown",this.Oa=void 0}get isPrimaryClient(){return this.Oa===!0}};function n$(t,e,n=!0){return g(this,null,function*(){let r=Ug(t),i,s=r.wa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ga()):i=yield AP(r,e,n,!0),i})}function r$(t,e){return g(this,null,function*(){let n=Ug(t);yield AP(n,e,!0,!1)})}function AP(t,e,n,r){return g(this,null,function*(){let i=yield Ja(t.localStore,Yt(e)),s=i.targetId,o=n?t.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield KE(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&Bg(t.remoteStore,i),a})}function KE(t,e,n,r,i){return g(this,null,function*(){t.Na=(d,h,f)=>function(m,v,b,F){return g(this,null,function*(){let T=v.view.Ta(b);T.Xi&&(T=yield mg(m.localStore,v.query,!1).then(({documents:Te})=>v.view.Ta(Te,T)));let q=F&&F.targetChanges.get(v.targetId),W=F&&F.targetMismatches.get(v.targetId)!=null,Z=v.view.applyChanges(T,m.isPrimaryClient,q,W);return lE(m,v.targetId,Z.Va),Z.snapshot})}(t,d,h,f);let s=yield mg(t.localStore,e,!0),o=new Sg(e,s.hs),a=o.Ta(s.documents),c=Lu.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),l=o.applyChanges(a,t.isPrimaryClient,c);lE(t,n,l.Va);let u=new oE(e,n,o);return t.wa.set(e,u),t.Sa.has(n)?t.Sa.get(n).push(e):t.Sa.set(n,[e]),l.snapshot})}function i$(t,e,n){return g(this,null,function*(){let r=N(t),i=r.wa.get(e),s=r.Sa.get(i.targetId);if(s.length>1)return r.Sa.set(i.targetId,s.filter(o=>!Xu(o,e))),void r.wa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield ec(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&tc(r.remoteStore,i.targetId),rc(r,i.targetId)}).catch(Xi))):(rc(r,i.targetId),yield ec(r.localStore,i.targetId,!0))})}function s$(t,e){return g(this,null,function*(){let n=N(t),r=n.wa.get(e),i=n.Sa.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),tc(n.remoteStore,r.targetId))})}function o$(t,e,n){return g(this,null,function*(){let r=XE(t);try{let i=yield function(o,a){let c=N(o),l=Ue.now(),u=a.reduce((f,p)=>f.add(p.key),re()),d,h;return c.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=hn(),m=re();return c.os.getEntries(f,u).next(v=>{p=v,p.forEach((b,F)=>{F.isValidDocument()||(m=m.add(b))})}).next(()=>c.localDocuments.getOverlayedDocuments(f,p)).next(v=>{d=v;let b=[];for(let F of a){let T=w8(F,d.get(F.key).overlayedDocument);T!=null&&b.push(new nr(F.key,T,bR(T.value.mapValue),ze.exists(!0)))}return c.mutationQueue.addMutationBatch(f,l,b,a)}).next(v=>{h=v;let b=v.applyToLocalDocumentSet(d,m);return c.documentOverlayCache.saveOverlays(f,v.batchId,b)})}).then(()=>({batchId:h.batchId,changes:FR(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let l=o.Fa[o.currentUser.toKey()];l||(l=new Ve(J)),l=l.insert(a,c),o.Fa[o.currentUser.toKey()]=l}(r,i.batchId,n),yield ci(r,i.changes),yield uc(r.remoteStore)}catch(i){let s=hc(i,"Failed to persist write");n.reject(s)}})}function MP(t,e){return g(this,null,function*(){let n=N(t);try{let r=yield B8(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.Ca.get(s);o&&(L(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.pa=!0:i.modifiedDocuments.size>0?L(o.pa):i.removedDocuments.size>0&&(L(o.pa),o.pa=!1))}),yield ci(n,r,e)}catch(r){yield Xi(r)}})}function rR(t,e,n){let r=N(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.wa.forEach((s,o)=>{let a=o.view.G_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=N(o);c.onlineState=a;let l=!1;c.queries.forEach((u,d)=>{for(let h of d.Q_)h.G_(a)&&(l=!0)}),l&&WE(c)}(r.eventManager,e),i.length&&r.ya.u_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function a$(t,e,n){return g(this,null,function*(){let r=N(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.Ca.get(e),s=i&&i.key;if(s){let o=new Ve(M.comparator);o=o.insert(s,lt.newNoDocument(s,$.min()));let a=re().add(s),c=new Vu($.min(),new Map,new Ve(J),o,a);yield MP(r,c),r.Da=r.Da.remove(s),r.Ca.delete(e),ZE(r)}else yield ec(r.localStore,e,!1).then(()=>rc(r,e,n)).catch(Xi)})}function c$(t,e){return g(this,null,function*(){let n=N(t),r=e.batch.batchId;try{let i=yield j8(n.localStore,e);YE(n,r,null),QE(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield ci(n,i)}catch(i){yield Xi(i)}})}function l$(t,e,n){return g(this,null,function*(){let r=N(t);try{let i=yield function(o,a){let c=N(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let u;return c.mutationQueue.lookupMutationBatch(l,a).next(d=>(L(d!==null),u=d.keys(),c.mutationQueue.removeMutationBatch(l,d))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,u,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,u)).next(()=>c.localDocuments.getDocuments(l,u))})}(r.localStore,e);YE(r,e,n),QE(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield ci(r,i)}catch(i){yield Xi(i)}})}function u$(t,e){return g(this,null,function*(){let n=N(t);es(n.remoteStore)||C("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=N(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(n.localStore);if(r===-1)return void e.resolve();let i=n.Ma.get(r)||[];i.push(e),n.Ma.set(r,i)}catch(r){let i=hc(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function QE(t,e){(t.Ma.get(e)||[]).forEach(n=>{n.resolve()}),t.Ma.delete(e)}function YE(t,e,n){let r=N(t),i=r.Fa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Fa[r.currentUser.toKey()]=i}}function rc(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.Sa.get(e))t.wa.delete(r),n&&t.ya.La(r,n);t.Sa.delete(e),t.isPrimaryClient&&t.va.Vr(e).forEach(r=>{t.va.containsKey(r)||NP(t,r)})}function NP(t,e){t.ba.delete(e.path.canonicalString());let n=t.Da.get(e);n!==null&&(tc(t.remoteStore,n),t.Da=t.Da.remove(e),t.Ca.delete(n),ZE(t))}function lE(t,e,n){for(let r of n)r instanceof Dg?(t.va.addReference(r.key,e),d$(t,r)):r instanceof Tg?(C("SyncEngine","Document no longer in limbo: "+r.key),t.va.removeReference(r.key,e),t.va.containsKey(r.key)||NP(t,r.key)):k()}function d$(t,e){let n=e.key,r=n.path.canonicalString();t.Da.get(n)||t.ba.has(r)||(C("SyncEngine","New document in limbo: "+n),t.ba.add(r),ZE(t))}function ZE(t){for(;t.ba.size>0&&t.Da.size<t.maxConcurrentLimboResolutions;){let e=t.ba.values().next().value;t.ba.delete(e);let n=new M(ye.fromString(e)),r=t.xa.next();t.Ca.set(r,new aE(n)),t.Da=t.Da.insert(n,r),Bg(t.remoteStore,new Za(Yt(cc(n.path)),r,"TargetPurposeLimboResolution",vn._e))}}function ci(t,e,n){return g(this,null,function*(){let r=N(t),i=[],s=[],o=[];r.wa.isEmpty()||(r.wa.forEach((a,c)=>{o.push(r.Na(c,e,n).then(l=>{if((l||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,l?.fromCache?"not-current":"current"),l){i.push(l);let u=Uw.Ki(c.targetId,l);s.push(u)}}))}),yield Promise.all(o),r.ya.u_(i),yield function(c,l){return g(this,null,function*(){let u=N(c);try{yield u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>_.forEach(l,h=>_.forEach(h.qi,f=>u.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>_.forEach(h.Qi,f=>u.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!Ji(d))throw d;C("LocalStore","Failed to update sequence numbers: "+d)}for(let d of l){let h=d.targetId;if(!d.fromCache){let f=u.ns.get(h),p=f.snapshotVersion,m=f.withLastLimboFreeSnapshotVersion(p);u.ns=u.ns.insert(h,m)}}})}(r.localStore,s))})}function h$(t,e){return g(this,null,function*(){let n=N(t);if(!n.currentUser.isEqual(e)){C("SyncEngine","User change. New user:",e.toKey());let r=yield mP(n.localStore,e);n.currentUser=e,function(s,o){s.Ma.forEach(a=>{a.forEach(c=>{c.reject(new w(y.CANCELLED,o))})}),s.Ma.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ci(n,r.us)}})}function f$(t,e){let n=N(t),r=n.Ca.get(e);if(r&&r.pa)return re().add(r.key);{let i=re(),s=n.Sa.get(e);if(!s)return i;for(let o of s){let a=n.wa.get(o);i=i.unionWith(a.view.Ia)}return i}}function p$(t,e){return g(this,null,function*(){let n=N(t),r=yield mg(n.localStore,e.query,!0),i=e.view.fa(r);return n.isPrimaryClient&&lE(n,e.targetId,i.Va),i})}function g$(t,e){return g(this,null,function*(){let n=N(t);return xP(n.localStore,e).then(r=>ci(n,r))})}function m$(t,e,n,r){return g(this,null,function*(){let i=N(t),s=yield function(a,c){let l=N(a),u=N(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",d=>u.vn(d,c).next(h=>h?l.localDocuments.getDocuments(d,h):_.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?yield uc(i.remoteStore):n==="acknowledged"||n==="rejected"?(YE(i,e,r||null),QE(i,e),function(a,c){N(N(a).mutationQueue).Mn(c)}(i.localStore,e)):k(),yield ci(i,s)):C("SyncEngine","Cannot apply mutation batch with id: "+e)})}function _$(t,e){return g(this,null,function*(){let n=N(t);if(Ug(n),XE(n),e===!0&&n.Oa!==!0){let r=n.sharedClientState.getAllActiveQueryTargets(),i=yield iR(n,r.toArray());n.Oa=!0,yield Jw(n.remoteStore,!0);for(let s of i)Bg(n.remoteStore,s)}else if(e===!1&&n.Oa!==!1){let r=[],i=Promise.resolve();n.Sa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(rc(n,o),ec(n.localStore,o,!0))),tc(n.remoteStore,o)}),yield i,yield iR(n,r),function(o){let a=N(o);a.Ca.forEach((c,l)=>{tc(a.remoteStore,l)}),a.va.mr(),a.Ca=new Map,a.Da=new Ve(M.comparator)}(n),n.Oa=!1,yield Jw(n.remoteStore,!1)}})}function iR(t,e,n){return g(this,null,function*(){let r=N(t),i=[],s=[];for(let o of e){let a,c=r.Sa.get(o);if(c&&c.length!==0){a=yield Ja(r.localStore,Yt(c[0]));for(let l of c){let u=r.wa.get(l),d=yield p$(r,u);d.snapshot&&s.push(d.snapshot)}}else{let l=yield vP(r.localStore,o);a=yield Ja(r.localStore,l),yield KE(r,RP(l),o,!1,a.resumeToken)}i.push(a)}return r.ya.u_(s),i})}function RP(t){return NR(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function y$(t){return function(n){return N(N(n).persistence).Bi()}(N(t).localStore)}function v$(t,e,n,r){return g(this,null,function*(){let i=N(t);if(i.Oa)return void C("SyncEngine","Ignoring unexpected query state notification.");let s=i.Sa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{let o=yield xP(i.localStore,PR(s[0])),a=Vu.createSynthesizedRemoteEventForCurrentChange(e,n==="current",wt.EMPTY_BYTE_STRING);yield ci(i,o,a);break}case"rejected":yield ec(i.localStore,e,!0),rc(i,e,r);break;default:k()}})}function x$(t,e,n){return g(this,null,function*(){let r=Ug(t);if(r.Oa){for(let i of e){if(r.Sa.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){C("SyncEngine","Adding an already active target "+i);continue}let s=yield vP(r.localStore,i),o=yield Ja(r.localStore,s);yield KE(r,RP(s),o.targetId,!1,o.resumeToken),Bg(r.remoteStore,o)}for(let i of n)r.Sa.has(i)&&(yield ec(r.localStore,i,!1).then(()=>{tc(r.remoteStore,i),rc(r,i)}).catch(Xi))}})}function Ug(t){let e=N(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=MP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=f$.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=a$.bind(null,e),e.ya.u_=e$.bind(null,e.eventManager),e.ya.La=t$.bind(null,e.eventManager),e}function XE(t){let e=N(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=c$.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=l$.bind(null,e),e}function w$(t,e,n){let r=N(t);(function(s,o,a){return g(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(f,p){let m=N(f),v=Ze(p.createTime);return m.persistence.runTransaction("hasNewerBundle","readonly",b=>m.$r.getBundleMetadata(b,p.id)).then(b=>!!b&&b.createTime.compareTo(v)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(SP(c));let l=new sE(c,s.localStore,o.serializer),u=yield o.Ba();for(;u;){let h=yield l.sa(u);h&&a._updateProgress(h),u=yield o.Ba()}let d=yield l.complete();return yield ci(s,d.aa,void 0),yield function(f,p){let m=N(f);return m.persistence.runTransaction("Save bundle","readwrite",v=>m.$r.saveBundleMetadata(v,p))}(s.localStore,c),a._completeWith(d.progress),Promise.resolve(d._a)}catch(c){return Fn("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var zu=class{constructor(){this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){this.serializer=ed(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return gP(this.persistence,new gg,e.initialUser,this.serializer)}createPersistence(e){return new fg(pg.Hr,this.serializer)}createSharedClientState(e){return new vg}terminate(){return g(this,null,function*(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Ag=class t extends zu{constructor(e,n,r){super(),this.ka=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){yield n_(t.prototype,this,"initialize").call(this,e),yield this.ka.initialize(this,e),yield XE(this.ka.syncEngine),yield uc(this.ka.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return gP(this.persistence,new gg,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){let r=this.persistence.referenceDelegate.garbageCollector;return new Dw(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){let r=new qx(n,this.persistence);return new Hx(e.asyncQueue,r)}createPersistence(e){let n=UE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?On.withCacheSize(this.cacheSizeBytes):On.DEFAULT;return new Bw(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,EP(),Up(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new vg}},uE=class t extends Ag{constructor(e,n){super(e,n,!1),this.ka=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){return g(this,null,function*(){yield n_(t.prototype,this,"initialize").call(this,e);let n=this.ka.syncEngine;this.sharedClientState instanceof Tu&&(this.sharedClientState.syncEngine={Zs:m$.bind(null,n),Xs:v$.bind(null,n),eo:x$.bind(null,n),Bi:y$.bind(null,n),Ys:g$.bind(null,n)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>g(this,null,function*(){yield _$(this.ka.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let n=EP();if(!Tu.D(n))throw new w(y.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=UE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Tu(n,e.asyncQueue,r,e.clientId,e.initialUser)}},Wu=class{initialize(e,n){return g(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>rR(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=h$.bind(null,this.syncEngine),yield Jw(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new nE}()}createDatastore(e){let n=ed(e.databaseInfo.databaseId),r=function(s){return new Ww(s)}(e.databaseInfo);return function(s,o,a,c){return new Yw(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new Xw(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>rR(this.syncEngine,n,0),function(){return xg.D()?new xg:new Gw}())}createSyncEngine(e,n){return function(i,s,o,a,c,l,u){let d=new cE(i,s,o,a,c,l);return u&&(d.Oa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return g(this,null,function*(){var e;yield function(r){return g(this,null,function*(){let i=N(r);C("RemoteStore","RemoteStore shutting down."),i.v_.add(5),yield lc(i),i.M_.shutdown(),i.x_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function sR(t,e=10240){let n=0;return{read(){return g(this,null,function*(){if(n<t.byteLength){let i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}})},cancel(){return g(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var ic=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.qa(this.observer.next,e)}error(e){this.observer.error?this.qa(this.observer.error,e):Qe("Uncaught Error in snapshot listener:",e.toString())}Qa(){this.muted=!0}qa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var dE=class{constructor(e,n){this.Ka=e,this.serializer=n,this.metadata=new ct,this.buffer=new Uint8Array,this.$a=function(){return new TextDecoder("utf-8")}(),this.Ua().then(r=>{r&&r.ra()?this.metadata.resolve(r.na.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.na)}`))},r=>this.metadata.reject(r))}close(){return this.Ka.cancel()}getMetadata(){return g(this,null,function*(){return this.metadata.promise})}Ba(){return g(this,null,function*(){return yield this.getMetadata(),this.Ua()})}Ua(){return g(this,null,function*(){let e=yield this.Wa();if(e===null)return null;let n=this.$a.decode(e),r=Number(n);isNaN(r)&&this.Ga(`length string (${n}) is not valid number`);let i=yield this.za(r);return new iE(JSON.parse(i),e.length+r)})}ja(){return this.buffer.findIndex(e=>e===123)}Wa(){return g(this,null,function*(){for(;this.ja()<0&&!(yield this.Ha()););if(this.buffer.length===0)return null;let e=this.ja();e<0&&this.Ga("Reached the end of bundle when a length string is expected.");let n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n})}za(e){return g(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ha())&&this.Ga("Reached the end of bundle when more is expected.");let n=this.$a.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n})}Ga(e){throw this.Ka.cancel(),new Error(`Invalid bundle format: ${e}`)}Ha(){return g(this,null,function*(){let e=yield this.Ka.read();if(!e.done){let n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done})}};var hE=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new w(y.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let n=yield function(i,s){return g(this,null,function*(){let o=N(i),a={documents:s.map(d=>ju(o.serializer,d))},c=yield o.vo("BatchGetDocuments",o.serializer.databaseId,ye.emptyPath(),a,s.length),l=new Map;c.forEach(d=>{let h=T8(o.serializer,d);l.set(h.key.toString(),h)});let u=[];return s.forEach(d=>{let h=l.get(d.toString());L(!!h),u.push(h)}),u})}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n})}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Yi(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{let i=M.fromPath(r);this.mutations.push(new ku(i,this.precondition(i)))}),yield function(r,i){return g(this,null,function*(){let s=N(r),o={writes:i.map(a=>Bu(s.serializer,a))};yield s.So("Commit",s.serializer.databaseId,ye.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw k();n=$.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new w(y.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){let n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual($.min())?ze.exists(!1):ze.updateTime(n):ze.none()}preconditionForUpdate(e){let n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual($.min()))throw new w(y.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ze.updateTime(n)}return ze.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var fE=class{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Ja=r.maxAttempts,this.jo=new qu(this.asyncQueue,"transaction_retry")}Ya(){this.Ja-=1,this.Za()}Za(){this.jo.qo(()=>g(this,null,function*(){let e=new hE(this.datastore),n=this.Xa(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.eu(i)}))}).catch(r=>{this.eu(r)})}))}Xa(e){try{let n=this.updateFunction(e);return!Yu(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}eu(e){this.Ja>0&&this.tu(e)?(this.Ja-=1,this.asyncQueue.enqueueAndForget(()=>(this.Za(),Promise.resolve()))):this.deferred.reject(e)}tu(e){if(e.name==="FirebaseError"){let n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!WR(n)}return!1}};var pE=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=at.UNAUTHENTICATED,this.clientId=qp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>g(this,null,function*(){C("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(C("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new w(y.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ct;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=hc(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function $p(t,e){return g(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),C("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>g(this,null,function*(){r.isEqual(i)||(yield mP(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function gE(t,e){return g(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield JE(t);C("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>tR(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>tR(e.remoteStore,i)),t._onlineComponents=e})}function PP(t){return t.name==="FirebaseError"?t.code===y.FAILED_PRECONDITION||t.code===y.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function JE(t){return g(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){C("FirestoreClient","Using user provided OfflineComponentProvider");try{yield $p(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!PP(n))throw n;Fn("Error using user provided cache. Falling back to memory cache: "+n),yield $p(t,new zu)}}else C("FirestoreClient","Using default OfflineComponentProvider"),yield $p(t,new zu);return t._offlineComponents})}function $g(t){return g(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(C("FirestoreClient","Using user provided OnlineComponentProvider"),yield gE(t,t._uninitializedComponentsProvider._online)):(C("FirestoreClient","Using default OnlineComponentProvider"),yield gE(t,new Wu))),t._onlineComponents})}function kP(t){return JE(t).then(e=>e.persistence)}function eC(t){return JE(t).then(e=>e.localStore)}function OP(t){return $g(t).then(e=>e.remoteStore)}function tC(t){return $g(t).then(e=>e.syncEngine)}function E$(t){return $g(t).then(e=>e.datastore)}function sc(t){return g(this,null,function*(){let e=yield $g(t),n=e.eventManager;return n.onListen=n$.bind(null,e.syncEngine),n.onUnlisten=i$.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=r$.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=s$.bind(null,e.syncEngine),n})}function C$(t){return t.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield kP(t),n=yield OP(t);return e.setNetworkEnabled(!0),function(i){let s=N(i);return s.v_.delete(0),td(s)}(n)}))}function I$(t){return t.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield kP(t),n=yield OP(t);return e.setNetworkEnabled(!1),function(i){return g(this,null,function*(){let s=N(i);s.v_.add(0),yield lc(s),s.x_.set("Offline")})}(n)}))}function b$(t,e){let n=new ct;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield function(l,u){let d=N(l);return d.persistence.runTransaction("read document","readonly",h=>d.localDocuments.getDocument(h,u))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new w(y.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=hc(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield eC(t),e,n)})),n.promise}function FP(t,e,n={}){let r=new ct;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,l){let u=new ic({next:h=>{o.enqueueAndForget(()=>zE(s,d));let f=h.docs.has(a);!f&&h.fromCache?l.reject(new w(y.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&c&&c.source==="server"?l.reject(new w(y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(h)},error:h=>l.reject(h)}),d=new Gu(cc(a.path),u,{includeMetadataChanges:!0,ta:!0});return GE(s,d)}(yield sc(t),t.asyncQueue,e,n,r)})),r.promise}function D$(t,e){let n=new ct;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield mg(i,s,!0),c=new Sg(s,a.hs),l=c.Ta(a.documents),u=c.applyChanges(l,!1);o.resolve(u.snapshot)}catch(a){let c=hc(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield eC(t),e,n)})),n.promise}function VP(t,e,n={}){let r=new ct;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,l){let u=new ic({next:h=>{o.enqueueAndForget(()=>zE(s,d)),h.fromCache&&c.source==="server"?l.reject(new w(y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(h)},error:h=>l.reject(h)}),d=new Gu(a,u,{includeMetadataChanges:!0,ta:!0});return GE(s,d)}(yield sc(t),t.asyncQueue,e,n,r)})),r.promise}function T$(t,e){let n=new ic(e);return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){N(i).W_.add(s),s.next()}(yield sc(t),n)})),()=>{n.Qa(),t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){N(i).W_.delete(s)}(yield sc(t),n)}))}}function S$(t,e,n,r){let i=function(o,a){let c;return c=typeof o=="string"?QR().encode(o):o,function(u,d){return new dE(u,d)}(function(u,d){if(u instanceof Uint8Array)return sR(u,d);if(u instanceof ArrayBuffer)return sR(new Uint8Array(u),d);if(u instanceof ReadableStream)return u.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(n,ed(e));t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){w$(yield tC(t),i,r)}))}function A$(t,e){return t.asyncQueue.enqueue(()=>g(this,null,function*(){return function(r,i){let s=N(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield eC(t),e)}))}function LP(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var oR=new Map;function nC(t,e,n){if(!n)throw new w(y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function rC(t,e,n,r){if(e===!0&&r===!0)throw new w(y.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function aR(t){if(!M.isDocumentKey(t))throw new w(y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function cR(t){if(M.isDocumentKey(t))throw new w(y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Hg(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":k()}function ve(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new w(y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=Hg(t);throw new w(y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function jP(t,e){if(e<=0)throw new w(y.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}var Mg=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new w(y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new w(y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}rC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=LP((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new w(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new w(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new w(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},so=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Mg({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new w(y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new w(y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Mg(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Px;switch(r.type){case"firstParty":return new Vx(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new w(y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=oR.get(n);r&&(C("ComponentProvider","Removing Datastore"),oR.delete(n),r.terminate())}(this),Promise.resolve()}};function BP(t,e,n,r={}){var i;let s=(t=ve(t,so))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Fn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=at.MOCK_USER;else{a=zd(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new w(y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new at(l)}t._authCredentials=new kx(new Hp(a,c))}}var Rt=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},ke=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ar(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},Ar=class t extends Rt{constructor(e,n,r){super(e,n,cc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new ke(this.firestore,null,new M(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function iC(t,e,...n){if(t=de(t),nC("collection","path",e),t instanceof so){let r=ye.fromString(e,...n);return cR(r),new Ar(t,null,r)}{if(!(t instanceof ke||t instanceof Ar))throw new w(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(ye.fromString(e,...n));return cR(r),new Ar(t.firestore,null,r)}}function UP(t,e){if(t=ve(t,so),nC("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new w(y.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Rt(t,null,function(r){return new tr(ye.emptyPath(),r)}(e))}function nd(t,e,...n){if(t=de(t),arguments.length===1&&(e=qp.newId()),nC("doc","path",e),t instanceof so){let r=ye.fromString(e,...n);return aR(r),new ke(t,null,new M(r))}{if(!(t instanceof ke||t instanceof Ar))throw new w(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(ye.fromString(e,...n));return aR(r),new ke(t.firestore,t instanceof Ar?t.converter:null,new M(r))}}function sC(t,e){return t=de(t),e=de(e),(t instanceof ke||t instanceof Ar)&&(e instanceof ke||e instanceof Ar)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function oC(t,e){return t=de(t),e=de(e),t instanceof Rt&&e instanceof Rt&&t.firestore===e.firestore&&Xu(t._query,e._query)&&t.converter===e.converter}var mE=class{constructor(){this.nu=Promise.resolve(),this.ru=[],this.iu=!1,this.su=[],this.ou=null,this._u=!1,this.au=!1,this.uu=[],this.jo=new qu(this,"async_queue_retry"),this.cu=()=>{let n=Up();n&&C("AsyncQueue","Visibility state changed to "+n.visibilityState),this.jo.Ko()};let e=Up();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.cu)}get isShuttingDown(){return this.iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.lu(),this.hu(e)}enterRestrictedMode(e){if(!this.iu){this.iu=!0,this.au=e||!1;let n=Up();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.cu)}}enqueue(e){if(this.lu(),this.iu)return new Promise(()=>{});let n=new ct;return this.hu(()=>this.iu&&this.au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.ru.push(e),this.Pu()))}Pu(){return g(this,null,function*(){if(this.ru.length!==0){try{yield this.ru[0](),this.ru.shift(),this.jo.reset()}catch(e){if(!Ji(e))throw e;C("AsyncQueue","Operation failed with retryable error: "+e)}this.ru.length>0&&this.jo.qo(()=>this.Pu())}})}hu(e){let n=this.nu.then(()=>(this._u=!0,e().catch(r=>{this.ou=r,this._u=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Qe("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this._u=!1,r))));return this.nu=n,n}enqueueAfterDelay(e,n,r){this.lu(),this.uu.indexOf(e)>-1&&(n=0);let i=eE.createAndSchedule(this,e,n,r,s=>this.Iu(s));return this.su.push(i),i}lu(){this.ou&&k()}verifyOperationInProgress(){}Tu(){return g(this,null,function*(){let e;do e=this.nu,yield e;while(e!==this.nu)})}Eu(e){for(let n of this.su)if(n.timerId===e)return!0;return!1}du(e){return this.Tu().then(()=>{this.su.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.su)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tu()})}Au(e){this.uu.push(e)}Iu(e){let n=this.su.indexOf(e);this.su.splice(n,1)}};function _E(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var yE=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new ct,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var $P=-1,je=class extends so{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new mE}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||HP(this),this._firestoreClient.terminate()}};function ft(t){return t._firestoreClient||HP(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function HP(t){var e,n,r;let i=t._freezeSettings(),s=function(a,c,l,u){return new Gx(a,c,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,LP(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new pE(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function qP(t,e){JP(t=ve(t,je));let n=ft(t);if(n._uninitializedComponentsProvider)throw new w(y.FAILED_PRECONDITION,"SDK cache is already specified.");Fn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=t._freezeSettings(),i=new Wu;return zP(n,i,new Ag(i,r.cacheSizeBytes,e?.forceOwnership))}function GP(t){JP(t=ve(t,je));let e=ft(t);if(e._uninitializedComponentsProvider)throw new w(y.FAILED_PRECONDITION,"SDK cache is already specified.");Fn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=t._freezeSettings(),r=new Wu;return zP(e,r,new uE(r,n.cacheSizeBytes))}function zP(t,e,n){let r=new ct;return t.asyncQueue.enqueue(()=>g(this,null,function*(){try{yield $p(t,n),yield gE(t,e),r.resolve()}catch(i){let s=i;if(!PP(s))throw s;Fn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function WP(t){if(t._initialized&&!t._terminated)throw new w(y.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new ct;return t._queue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{yield function(r){return g(this,null,function*(){if(!ri.D())return Promise.resolve();let i=r+"main";yield ri.delete(i)})}(UE(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}})),e.promise}function KP(t){return function(n){let r=new ct;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return u$(yield tC(n),r)})),r.promise}(ft(t=ve(t,je)))}function QP(t){return C$(ft(t=ve(t,je)))}function YP(t){return I$(ft(t=ve(t,je)))}function ZP(t,e){let n=ft(t=ve(t,je)),r=new yE;return S$(n,t._databaseId,e,r),r}function XP(t,e){return A$(ft(t=ve(t,je)),e).then(n=>n?new Rt(t,null,n.query):null)}function JP(t){if(t._initialized||t._terminated)throw new w(y.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Pr=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(wt.fromBase64String(e))}catch(n){throw new w(y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(wt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var rr=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new w(y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ye(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var oi=class{constructor(e){this._methodName=e}};var oo=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new w(y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new w(y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return J(this._lat,e._lat)||J(this._long,e._long)}};var M$=/^__.*__$/,vE=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new nr(e,this.data,this.fieldMask,n,this.fieldTransforms):new Qi(e,this.data,n,this.fieldTransforms)}},Ng=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new nr(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function ek(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw k()}}var Rg=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ru(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Vu(){return this.settings.Vu}mu(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}fu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.mu({path:r,gu:!1});return i.pu(e),i}yu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.mu({path:r,gu:!1});return i.Ru(),i}wu(e){return this.mu({path:void 0,gu:!0})}Su(e){return Pg(e,this.settings.methodName,this.settings.bu||!1,this.path,this.settings.Du)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Ru(){if(this.path)for(let e=0;e<this.path.length;e++)this.pu(this.path.get(e))}pu(e){if(e.length===0)throw this.Su("Document fields must not be empty");if(ek(this.Vu)&&M$.test(e))throw this.Su('Document fields cannot begin and end with "__"')}},xE=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||ed(e)}Cu(e,n,r,i=!1){return new Rg({Vu:e,methodName:n,Du:r,path:Ye.emptyPath(),gu:!1,bu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function uo(t){let e=t._freezeSettings(),n=ed(t._databaseId);return new xE(t._databaseId,!!e.ignoreUndefinedProperties,n)}function qg(t,e,n,r,i,s={}){let o=t.Cu(s.merge||s.mergeFields?2:0,e,n,i);lC("Data must be an object, but it was:",o,r);let a=rk(r,o),c,l;if(s.merge)c=new xn(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let u=[];for(let d of s.mergeFields){let h=bE(e,d,n);if(!o.contains(h))throw new w(y.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);sk(u,h)||u.push(h)}c=new xn(u),l=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,l=o.fieldTransforms;return new vE(new Ut(a),c,l)}var Ku=class t extends oi{_toFieldTransform(e){if(e.Vu!==2)throw e.Vu===1?e.Su(`${this._methodName}() can only appear at the top level of your update data`):e.Su(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};function tk(t,e,n){return new Rg({Vu:3,Du:e.settings.Du,methodName:t._methodName,gu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var wE=class t extends oi{_toFieldTransform(e){return new no(e.path,new Wi)}isEqual(e){return e instanceof t}},EE=class t extends oi{constructor(e,n){super(e),this.vu=n}_toFieldTransform(e){let n=tk(this,e,!0),r=this.vu.map(s=>ho(s,n)),i=new ii(r);return new no(e.path,i)}isEqual(e){return e instanceof t&&s_(this.vu,e.vu)}},CE=class t extends oi{constructor(e,n){super(e),this.vu=n}_toFieldTransform(e){let n=tk(this,e,!0),r=this.vu.map(s=>ho(s,n)),i=new si(r);return new no(e.path,i)}isEqual(e){return e instanceof t&&s_(this.vu,e.vu)}},IE=class t extends oi{constructor(e,n){super(e),this.Fu=n}_toFieldTransform(e){let n=new Ki(e.serializer,BR(e.serializer,this.Fu));return new no(e.path,n)}isEqual(e){return e instanceof t&&this.Fu===e.Fu}};function aC(t,e,n,r){let i=t.Cu(1,e,n);lC("Data must be an object, but it was:",i,r);let s=[],o=Ut.empty();lo(r,(c,l)=>{let u=uC(e,c,n);l=de(l);let d=i.yu(u);if(l instanceof Ku)s.push(u);else{let h=ho(l,d);h!=null&&(s.push(u),o.set(u,h))}});let a=new xn(s);return new Ng(o,a,i.fieldTransforms)}function cC(t,e,n,r,i,s){let o=t.Cu(1,e,n),a=[bE(e,r,n)],c=[i];if(s.length%2!=0)throw new w(y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(bE(e,s[h])),c.push(s[h+1]);let l=[],u=Ut.empty();for(let h=a.length-1;h>=0;--h)if(!sk(l,a[h])){let f=a[h],p=c[h];p=de(p);let m=o.yu(f);if(p instanceof Ku)l.push(f);else{let v=ho(p,m);v!=null&&(l.push(f),u.set(f,v))}}let d=new xn(l);return new Ng(u,d,o.fieldTransforms)}function nk(t,e,n,r=!1){return ho(n,t.Cu(r?4:3,e))}function ho(t,e){if(ik(t=de(t)))return lC("Unsupported field value:",e,t),rk(t,e);if(t instanceof oi)return function(r,i){if(!ek(i.Vu))throw i.Su(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Su(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.gu&&e.Vu!==4)throw e.Su("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=ho(a,i.wu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=de(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return BR(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Ue.fromDate(r);return{timestampValue:Ya(i.serializer,s)}}if(r instanceof Ue){let s=new Ue(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ya(i.serializer,s)}}if(r instanceof oo)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Pr)return{bytesValue:YR(i.serializer,r._byteString)};if(r instanceof ke){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Su(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:LE(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Su(`Unsupported field value: ${Hg(r)}`)}(t,e)}function rk(t,e){let n={};return ER(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):lo(t,(r,i)=>{let s=ho(i,e.fu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function ik(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ue||t instanceof oo||t instanceof Pr||t instanceof ke||t instanceof oi)}function lC(t,e,n){if(!ik(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=Hg(n);throw r==="an object"?e.Su(t+" a custom object"):e.Su(t+" "+r)}}function bE(t,e,n){if((e=de(e))instanceof rr)return e._internalPath;if(typeof e=="string")return uC(t,e);throw Pg("Field path arguments must be of type string or ",t,!1,void 0,n)}var N$=new RegExp("[~\\*/\\[\\]]");function uC(t,e,n){if(e.search(N$)>=0)throw Pg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new rr(...e.split("."))._internalPath}catch{throw Pg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Pg(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new w(y.INVALID_ARGUMENT,a+t+c)}function sk(t,e){return t.some(n=>n.isEqual(e))}var ao=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ke(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new DE(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(Gg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},DE=class extends ao{data(){return super.data()}};function Gg(t,e){return typeof e=="string"?uC(t,e):e instanceof rr?e._internalPath:e._delegate._internalPath}function ok(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new w(y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Qu=class{},co=class extends Qu{};function li(t,e,...n){let r=[];e instanceof Qu&&r.push(e),r=r.concat(n),function(s){let o=s.filter(c=>c instanceof TE).length,a=s.filter(c=>c instanceof kg).length;if(o>1||o>0&&a>0)throw new w(y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var kg=class t extends co{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return mk(e._query,n),new Rt(e.firestore,e.converter,iw(e._query,n))}_parse(e){let n=uo(e.firestore);return function(s,o,a,c,l,u,d){let h;if(l.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new w(y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){uR(d,u);let f=[];for(let p of d)f.push(lR(c,s,p));h={arrayValue:{values:f}}}else h=lR(c,s,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||uR(d,u),h=nk(a,o,d,u==="in"||u==="not-in");return pe.create(l,u,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function ak(t,e,n){let r=e,i=Gg("where",t);return kg._create(i,r,n)}var TE=class t extends Qu{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:De.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)mk(o,c),o=iw(o,c)}(e._query,n),new Rt(e.firestore,e.converter,iw(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var SE=class t extends co{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t(e,n)}_apply(e){let n=function(i,s,o){if(i.startAt!==null)throw new w(y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new w(y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new eo(s,o)}(e._query,this._field,this._direction);return new Rt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new tr(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}};function ck(t,e="asc"){let n=e,r=Gg("orderBy",t);return SE._create(r,n)}var Og=class t extends co{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){return new Rt(e.firestore,e.converter,eg(e._query,this._limit,this._limitType))}};function lk(t){return jP("limit",t),Og._create("limit",t,"F")}function uk(t){return jP("limitToLast",t),Og._create("limitToLast",t,"L")}var Fg=class t extends co{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=gk(e,this.type,this._docOrFields,this._inclusive);return new Rt(e.firestore,e.converter,function(i,s){return new tr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function dk(...t){return Fg._create("startAt",t,!0)}function hk(...t){return Fg._create("startAfter",t,!1)}var Vg=class t extends co{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=gk(e,this.type,this._docOrFields,this._inclusive);return new Rt(e.firestore,e.converter,function(i,s){return new tr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function fk(...t){return Vg._create("endBefore",t,!1)}function pk(...t){return Vg._create("endAt",t,!0)}function gk(t,e,n,r){if(n[0]=de(n[0]),n[0]instanceof ao)return function(s,o,a,c,l){if(!c)throw new w(y.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let u=[];for(let d of $a(s))if(d.field.isKeyField())u.push(Js(o,c.key));else{let h=c.data.field(d.field);if(jg(h))throw new w(y.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){let f=d.field.canonicalString();throw new w(y.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}u.push(h)}return new Nr(u,l)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{let i=uo(t.firestore);return function(o,a,c,l,u,d){let h=o.explicitOrderBy;if(u.length>h.length)throw new w(y.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let f=[];for(let p=0;p<u.length;p++){let m=u[p];if(h[p].field.isKeyField()){if(typeof m!="string")throw new w(y.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof m}`);if(!FE(o)&&m.indexOf("/")!==-1)throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${m}' contains a slash.`);let v=o.path.child(ye.fromString(m));if(!M.isDocumentKey(v))throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${v}' is not because it contains an odd number of segments.`);let b=new M(v);f.push(Js(a,b))}else{let v=nk(c,l,m);f.push(v)}}return new Nr(f,d)}(t._query,t.firestore._databaseId,i,e,n,r)}}function lR(t,e,n){if(typeof(n=de(n))=="string"){if(n==="")throw new w(y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!FE(e)&&n.indexOf("/")!==-1)throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(ye.fromString(n));if(!M.isDocumentKey(r))throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Js(t,new M(r))}if(n instanceof ke)return Js(t,n._key);throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Hg(n)}.`)}function uR(t,e){if(!Array.isArray(t)||t.length===0)throw new w(y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function mk(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new w(y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new w(y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var oc=class{convertValue(e,n="none"){switch(Xs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ge(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(qi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw k()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return lo(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new oo(Ge(e.latitude),Ge(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=kE(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Nu(e));default:return null}}convertTimestamp(e){let n=Hi(e);return new Ue(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=ye.fromString(e);L(aP(r));let i=new Gi(r.get(1),r.get(3)),s=new M(r.popFirst(5));return i.isEqual(n)||Qe(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function zg(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var AE=class extends oc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new ke(this.firestore,null,n)}};var ni=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ln=class extends ao{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new Ui(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(Gg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},Ui=class extends Ln{data(e={}){return super.data(e)}},ir=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new ni(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ui(this._firestore,this._userDataWriter,r.key,r,new ni(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new w(y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new Ui(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ni(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new Ui(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ni(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,u=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:R$(a.type),doc:c,oldIndex:l,newIndex:u}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function R$(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return k()}}function dC(t,e){return t instanceof Ln&&e instanceof Ln?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof ir&&e instanceof ir&&t._firestore===e._firestore&&oC(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function _k(t){t=ve(t,ke);let e=ve(t.firestore,je);return FP(ft(e),t._key).then(n=>gC(e,t,n))}var ai=class extends oc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new ke(this.firestore,null,n)}};function yk(t){t=ve(t,ke);let e=ve(t.firestore,je),n=ft(e),r=new ai(e);return b$(n,t._key).then(i=>new Ln(e,r,t._key,i,new ni(i!==null&&i.hasLocalMutations,!0),t.converter))}function vk(t){t=ve(t,ke);let e=ve(t.firestore,je);return FP(ft(e),t._key,{source:"server"}).then(n=>gC(e,t,n))}function xk(t){t=ve(t,Rt);let e=ve(t.firestore,je),n=ft(e),r=new ai(e);return ok(t._query),VP(n,t._query).then(i=>new ir(e,r,t,i))}function wk(t){t=ve(t,Rt);let e=ve(t.firestore,je),n=ft(e),r=new ai(e);return D$(n,t._query).then(i=>new ir(e,r,t,i))}function Ek(t){t=ve(t,Rt);let e=ve(t.firestore,je),n=ft(e),r=new ai(e);return VP(n,t._query,{source:"server"}).then(i=>new ir(e,r,t,i))}function hC(t,e,n){t=ve(t,ke);let r=ve(t.firestore,je),i=zg(t.converter,e,n);return fc(r,[qg(uo(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,ze.none())])}function fC(t,e,n,...r){t=ve(t,ke);let i=ve(t.firestore,je),s=uo(i),o;return o=typeof(e=de(e))=="string"||e instanceof rr?cC(s,"updateDoc",t._key,e,n,r):aC(s,"updateDoc",t._key,e),fc(i,[o.toMutation(t._key,ze.exists(!0))])}function Ck(t){return fc(ve(t.firestore,je),[new Yi(t._key,ze.none())])}function Ik(t,e){let n=ve(t.firestore,je),r=nd(t),i=zg(t.converter,e);return fc(n,[qg(uo(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,ze.exists(!1))]).then(()=>r)}function pC(t,...e){var n,r,i;t=de(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||_E(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(_E(e[o])){let d=e[o];e[o]=(n=d.next)===null||n===void 0?void 0:n.bind(d),e[o+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let c,l,u;if(t instanceof ke)l=ve(t.firestore,je),u=cc(t._key.path),c={next:d=>{e[o]&&e[o](gC(l,t,d))},error:e[o+1],complete:e[o+2]};else{let d=ve(t,Rt);l=ve(d.firestore,je),u=d._query;let h=new ai(l);c={next:f=>{e[o]&&e[o](new ir(l,h,d,f))},error:e[o+1],complete:e[o+2]},ok(t._query)}return function(h,f,p,m){let v=new ic(m),b=new Gu(f,v,p);return h.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return GE(yield sc(h),b)})),()=>{v.Qa(),h.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return zE(yield sc(h),b)}))}}(ft(l),u,a,c)}function bk(t,e){return T$(ft(t=ve(t,je)),_E(e)?e:{next:e})}function fc(t,e){return function(r,i){let s=new ct;return r.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return o$(yield tC(r),i,s)})),s.promise}(ft(t),e)}function gC(t,e,n){let r=n.docs.get(e._key),i=new ai(t);return new Ln(t,i,e._key,r,new ni(n.hasPendingWrites,n.fromCache),e.converter)}var P$={maxAttempts:5};var Lg=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=uo(e)}set(e,n,r){this._verifyNotCommitted();let i=ji(e,this._firestore),s=zg(i.converter,n,r),o=qg(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,ze.none())),this}update(e,n,r,...i){this._verifyNotCommitted();let s=ji(e,this._firestore),o;return o=typeof(n=de(n))=="string"||n instanceof rr?cC(this._dataReader,"WriteBatch.update",s._key,n,r,i):aC(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,ze.exists(!0))),this}delete(e){this._verifyNotCommitted();let n=ji(e,this._firestore);return this._mutations=this._mutations.concat(new Yi(n._key,ze.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new w(y.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function ji(t,e){if((t=de(t)).firestore!==e)throw new w(y.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var ME=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=uo(n)}get(n){let r=ji(n,this._firestore),i=new AE(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return k();let o=s[0];if(o.isFoundDocument())return new ao(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new ao(this._firestore,i,r._key,null,r.converter);throw k()})}set(n,r,i){let s=ji(n,this._firestore),o=zg(s.converter,r,i),a=qg(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){let o=ji(n,this._firestore),a;return a=typeof(r=de(r))=="string"||r instanceof rr?cC(this._dataReader,"Transaction.update",o._key,r,i,s):aC(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){let r=ji(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){let n=ji(e,this._firestore),r=new ai(this._firestore);return super.get(e).then(i=>new Ln(this._firestore,r,n._key,i._document,new ni(!1,!1),n.converter))}};function Dk(t,e,n){t=ve(t,je);let r=Object.assign(Object.assign({},P$),n);return function(s){if(s.maxAttempts<1)throw new w(y.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new ct;return s.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let l=yield E$(s);new fE(s.asyncQueue,l,a,o,c).Ya()})),c.promise}(ft(t),i=>e(new ME(t,i)),r)}function Tk(){return new Ku("deleteField")}function Sk(){return new wE("serverTimestamp")}function Ak(...t){return new EE("arrayUnion",t)}function Mk(...t){return new CE("arrayRemove",t)}function Nk(t){return new IE("increment",t)}(function(e,n=!0){(function(i){ac=i})(Zd),us(new fn("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new je(new Ox(r.getProvider("auth-internal")),new jx(r.getProvider("app-check-internal")),function(l,u){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new w(y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Gi(l.options.projectId,u)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),$n(dN,"4.5.1",e),$n(dN,"4.5.1","esm2017")})();var k$="@firebase/firestore-compat",O$="0.3.28";function wC(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new w("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function Rk(){if(typeof Uint8Array>"u")throw new w("unimplemented","Uint8Arrays are not available in this environment.")}function Pk(){if(!CR())throw new w("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Wg=class t{constructor(e){this._delegate=e}static fromBase64String(e){return Pk(),new t(Pr.fromBase64String(e))}static fromUint8Array(e){return Rk(),new t(Pr.fromUint8Array(e))}toBase64(){return Pk(),this._delegate.toBase64()}toUint8Array(){return Rk(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function mC(t){return F$(t,["next","error","complete"])}function F$(t,e){if(typeof t!="object"||t===null)return!1;let n=t;for(let r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}var _C=class{enableIndexedDbPersistence(e,n){return qP(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return GP(e._delegate)}clearIndexedDbPersistence(e){return WP(e._delegate)}},Kg=class{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Gi||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Fn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){BP(this._delegate,e,n,r)}enableNetwork(){return QP(this._delegate)}disableNetwork(){return YP(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,rC("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return KP(this._delegate)}onSnapshotsInSync(e){return bk(this._delegate,e)}get app(){if(!this._appCompat)throw new w("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new mc(this,iC(this._delegate,e))}catch(n){throw Zt(n,"collection()","Firestore.collection()")}}doc(e){try{return new kr(this,nd(this._delegate,e))}catch(n){throw Zt(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new mo(this,UP(this._delegate,e))}catch(n){throw Zt(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Dk(this._delegate,n=>e(new Qg(this,n)))}batch(){return ft(this._delegate),new Yg(new Lg(this._delegate,e=>fc(this._delegate,e)))}loadBundle(e){return ZP(this._delegate,e)}namedQuery(e){return XP(this._delegate,e).then(n=>n?new mo(this,n):null)}},pc=class extends oc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wg(new Pr(e))}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return kr.forKey(n,this.firestore,null)}};function V$(t){dR(t)}var Qg=class{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new pc(e)}get(e){let n=fo(e);return this._delegate.get(n).then(r=>new po(this._firestore,new Ln(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){let i=fo(e);return r?(wC("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=fo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=fo(e);return this._delegate.delete(n),this}},Yg=class{constructor(e){this._delegate=e}set(e,n,r){let i=fo(e);return r?(wC("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=fo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=fo(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}},gc=class t{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){let r=new Ui(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new go(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){let r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new t(e,new pc(e),n),i.set(n,s)),s}};gc.INSTANCES=new WeakMap;var kr=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new pc(e)}static forPath(e,n,r){if(e.length%2!==0)throw new w("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new t(n,new ke(n._delegate,r,new M(e)))}static forKey(e,n,r){return new t(n,new ke(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new mc(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new mc(this.firestore,iC(this._delegate,e))}catch(n){throw Zt(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=de(e),e instanceof ke?sC(this._delegate,e):!1}set(e,n){n=wC("DocumentReference.set",n);try{return n?hC(this._delegate,e,n):hC(this._delegate,e)}catch(r){throw Zt(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?fC(this._delegate,e):fC(this._delegate,e,n,...r)}catch(i){throw Zt(i,"updateDoc()","DocumentReference.update()")}}delete(){return Ck(this._delegate)}onSnapshot(...e){let n=kk(e),r=Ok(e,i=>new po(this.firestore,new Ln(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return pC(this._delegate,n,r)}get(e){let n;return e?.source==="cache"?n=yk(this._delegate):e?.source==="server"?n=vk(this._delegate):n=_k(this._delegate),n.then(r=>new po(this.firestore,new Ln(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(gc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Zt(t,e,n){return t.message=t.message.replace(e,n),t}function kk(t){for(let e of t)if(typeof e=="object"&&!mC(e))return e;return{}}function Ok(t,e){var n,r;let i;return mC(t[0])?i=t[0]:mC(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var po=class{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new kr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return dC(this._delegate,e._delegate)}},go=class extends po{data(e){let n=this._delegate.data(e);return this._delegate._converter||hR(n!==void 0,"Document in a QueryDocumentSnapshot should exist"),n}},mo=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new pc(e)}where(e,n,r){try{return new t(this.firestore,li(this._delegate,ak(e,n,r)))}catch(i){throw Zt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new t(this.firestore,li(this._delegate,ck(e,n)))}catch(r){throw Zt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new t(this.firestore,li(this._delegate,lk(e)))}catch(n){throw Zt(n,"limit()","Query.limit()")}}limitToLast(e){try{return new t(this.firestore,li(this._delegate,uk(e)))}catch(n){throw Zt(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new t(this.firestore,li(this._delegate,dk(...e)))}catch(n){throw Zt(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new t(this.firestore,li(this._delegate,hk(...e)))}catch(n){throw Zt(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new t(this.firestore,li(this._delegate,fk(...e)))}catch(n){throw Zt(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new t(this.firestore,li(this._delegate,pk(...e)))}catch(n){throw Zt(n,"endAt()","Query.endAt()")}}isEqual(e){return oC(this._delegate,e._delegate)}get(e){let n;return e?.source==="cache"?n=wk(this._delegate):e?.source==="server"?n=Ek(this._delegate):n=xk(this._delegate),n.then(r=>new rd(this.firestore,new ir(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let n=kk(e),r=Ok(e,i=>new rd(this.firestore,new ir(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return pC(this._delegate,n,r)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(gc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},yC=class{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new go(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},rd=class{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new mo(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new go(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new yC(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new go(this._firestore,r))})}isEqual(e){return dC(this._delegate,e._delegate)}},mc=class t extends mo{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new kr(this.firestore,e):null}doc(e){try{return e===void 0?new kr(this.firestore,nd(this._delegate)):new kr(this.firestore,nd(this._delegate,e))}catch(n){throw Zt(n,"doc()","CollectionReference.doc()")}}add(e){return Ik(this._delegate,e).then(n=>new kr(this.firestore,n))}isEqual(e){return sC(this._delegate,e._delegate)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(gc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function fo(t){return ve(t,ke)}var vC=class t{constructor(...e){this._delegate=new rr(...e)}static documentId(){return new t(Ye.keyField().canonicalString())}isEqual(e){return e=de(e),e instanceof rr?this._delegate._internalPath.isEqual(e._internalPath):!1}};var xC=class t{constructor(e){this._delegate=e}static serverTimestamp(){let e=Sk();return e._methodName="FieldValue.serverTimestamp",new t(e)}static delete(){let e=Tk();return e._methodName="FieldValue.delete",new t(e)}static arrayUnion(...e){let n=Ak(...e);return n._methodName="FieldValue.arrayUnion",new t(n)}static arrayRemove(...e){let n=Mk(...e);return n._methodName="FieldValue.arrayRemove",new t(n)}static increment(e){let n=Nk(e);return n._methodName="FieldValue.increment",new t(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var L$={Firestore:Kg,GeoPoint:oo,Timestamp:Ue,Blob:Wg,Transaction:Qg,WriteBatch:Yg,DocumentReference:kr,DocumentSnapshot:po,Query:mo,QueryDocumentSnapshot:go,QuerySnapshot:rd,CollectionReference:mc,FieldPath:vC,FieldValue:xC,setLogLevel:V$,CACHE_SIZE_UNLIMITED:$P};function j$(t,e){t.INTERNAL.registerComponent(new fn("firestore-compat",n=>{let r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},L$)))}function B$(t){j$(t,(e,n)=>new Kg(e,n,new _C)),t.registerVersion(k$,O$)}B$(bt);function U$(t,e=gs){return new oe(n=>{let r;return e!=null?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}function Fk(t,e){return U$(t,e)}function $$(t,e){return Fk(t,e).pipe(_s(void 0),Kc(),j(n=>{let[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function IC(t,e){return Fk(t,e).pipe(j(n=>({payload:n,type:"query"})))}var Zg=class{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){let r=this.ref.collection(e),{ref:i,query:s}=jk(r,n);return new Jg(i,s,this.afs)}snapshotChanges(){return $$(this.ref,this.afs.schedulers.outsideAngular).pipe(Ke)}valueChanges(e={}){return this.snapshotChanges().pipe(j(({payload:n})=>e.idField?se(A({},n.data()),{[e.idField]:n.id}):n.data()))}get(e){return xe(this.ref.get(e)).pipe(Ke)}};function Xg(t,e){return IC(t,e).pipe(_s(void 0),Kc(),j(n=>{let[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,c)=>{let l=s.find(d=>d.doc.ref.isEqual(a.ref)),u=r?.payload.docs.find(d=>d.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&u&&JSON.stringify(u.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),o}))}function Vk(t,e,n){return Xg(t,n).pipe(lr((r,i)=>H$(r,i.map(s=>s.payload),e),[]),zc(),j(r=>r.map(i=>({type:i.type,payload:i}))))}function H$(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=q$(t,r))}),t}function EC(t,e,n,...r){let i=t.slice();return i.splice(e,n,...r),i}function q$(t,e){switch(e.type){case"added":if(!(t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)))return EC(t,e.newIndex,0,e);break;case"modified":if(t[e.oldIndex]==null||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}else return EC(t,e.newIndex,1,e);break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return EC(t,e.oldIndex,1);break}return t}function Lk(t){return(!t||t.length===0)&&(t=["added","removed","modified"]),t}var Jg=class{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=Xg(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(j(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(_s(void 0),Kc(),St(([r,i])=>i.length>0||!r),j(([,r])=>r),Ke)}auditTrail(e){return this.stateChanges(e).pipe(lr((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=Lk(e);return Vk(this.query,n,this.afs.schedulers.outsideAngular).pipe(Ke)}valueChanges(e={}){return IC(this.query,this.afs.schedulers.outsideAngular).pipe(j(n=>n.payload.docs.map(r=>e.idField?se(A({},r.data()),{[e.idField]:r.id}):r.data())),Ke)}get(e){return xe(this.query.get(e)).pipe(Ke)}add(e){return this.ref.add(e)}doc(e){return new Zg(this.ref.doc(e),this.afs)}},CC=class{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return!e||e.length===0?Xg(this.query,this.afs.schedulers.outsideAngular).pipe(Ke):Xg(this.query,this.afs.schedulers.outsideAngular).pipe(j(n=>n.filter(r=>e.indexOf(r.type)>-1)),St(n=>n.length>0),Ke)}auditTrail(e){return this.stateChanges(e).pipe(lr((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=Lk(e);return Vk(this.query,n,this.afs.schedulers.outsideAngular).pipe(Ke)}valueChanges(e={}){return IC(this.query,this.afs.schedulers.outsideAngular).pipe(j(r=>r.payload.docs.map(i=>e.idField?A({[e.idField]:i.id},i.data()):i.data())),Ke)}get(e){return xe(this.query.get(e)).pipe(Ke)}},G$=new O("angularfire2.enableFirestorePersistence"),z$=new O("angularfire2.firestore.persistenceSettings"),W$=new O("angularfire2.firestore.settings"),K$=new O("angularfire2.firestore.use-emulator");function jk(t,e=n=>n){return{query:e(t),ref:t}}var _c=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,c,l,u,d,h,f,p,m,v,b,F){this.schedulers=c;let T=Ls(n,a,r),q=u;d&&Wl(T,a,h,p,m,v,f,b),[this.firestore,this.persistenceEnabled$]=Ia(`${T.name}.firestore`,"AngularFirestore",T.name,()=>{let W=a.runOutsideAngular(()=>T.firestore());if(s&&W.settings(s),q&&W.useEmulator(...q),i&&!Rs(o)){let Z=()=>{try{return xe(W.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(Te){return typeof console<"u"&&console.warn(Te),B(!1)}};return[W,a.runOutsideAngular(Z)]}else return[W,B(!1)]},[s,q,i])}collection(n,r){let i;typeof n=="string"?i=this.firestore.collection(n):i=n;let{ref:s,query:o}=jk(i,r),a=this.schedulers.ngZone.run(()=>s);return new Jg(a,o,this)}collectionGroup(n,r){let i=r||(o=>o),s=this.firestore.collectionGroup(n);return new CC(i(s),this)}doc(n){let r;typeof n=="string"?r=this.firestore.doc(n):r=n;let i=this.schedulers.ngZone.run(()=>r);return new Zg(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(E(Ri),E(Pi,8),E(G$,8),E(W$,8),E(Ot),E(fe),E(Ca),E(z$,8),E(K$,8),E(rp,8),E(Ul,8),E($l,8),E(Hl,8),E(ql,8),E(Gl,8),E(zl,8),E(Xr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var em=(()=>{let e=class e{constructor(r){this.firestore=r}getTransacciones(){return g(this,null,function*(){return yield this.parseData(this.firestore.collection("transacciones").snapshotChanges())})}getTransaccionById(r){return g(this,null,function*(){return(yield this.parseData(this.firestore.collection("transacciones",s=>s.where("id","==",r)).snapshotChanges()))[0]})}parseData(r){let i=[];return new Promise(s=>{r.subscribe(o=>{i=o.map(a=>se(A({},a.payload.doc.data()),{id:a.payload.doc.id})),s(i)})})}createTransaccion(r){return g(this,null,function*(){return yield this.firestore.collection("transacciones").add(Object.assign({},r))})}updateTransaccion(r){return g(this,null,function*(){yield this.firestore.doc("transacciones/"+r.id).update(r)})}deleteTransaccion(r){return g(this,null,function*(){yield this.firestore.doc("transacciones/"+r).delete()})}};e.\u0275fac=function(i){return new(i||e)(E(_c))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Uk=(()=>{let e=class e{constructor(r,i){this.firestore=r,this.transaccionService=i}getCoches(){return g(this,null,function*(){return yield this.parseData(this.firestore.collection("coches").snapshotChanges())})}getCocheById(r){return g(this,null,function*(){return new Promise(i=>{this.firestore.doc("coches/"+r).valueChanges().subscribe(s=>{i(s)})})})}parseData(r){let i=[];return new Promise(s=>{r.subscribe(o=>{i=o.map(a=>se(A({},a.payload.doc.data()),{id:a.payload.doc.id})),s(i)})})}addTransaccion(r,i){return g(this,null,function*(){let s=yield this.getCocheById(r);s.transacciones.push(i),yield this.updateCoche(s)})}sellCoche(r,i,s,o){return g(this,null,function*(){let a=yield this.getCocheById(r);a.vendido=!0;let c=yield this.transaccionService.createTransaccion(new Fs({fecha:new Date().toLocaleString(),precio:a.precio,metodoPago:o,coche:r,cliente:i,tipo:"venta"})),{id:l}=yield c.get();yield this.addTransaccion(r,l),yield this.updateCoche(a)})}createCoche(r){return g(this,null,function*(){return yield this.firestore.collection("coches").add(Object.assign({},r))})}updateCoche(r){return g(this,null,function*(){yield this.firestore.doc("coches/"+r.id).update(r)})}deleteCoche(r){return g(this,null,function*(){console.log(...Y$("1694024615_130_4_130_24_4",r)),yield this.firestore.doc("coches/"+r).delete()})}};e.\u0275fac=function(i){return new(i||e)(E(_c),E(em))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Q$(){try{return(0,eval)("globalThis._console_ninja")||(0,eval)(`/* https://github.com/wallabyjs/console-ninja#how-does-it-work */'use strict';var _0x3e00e0=_0x4050;(function(_0x1495ec,_0x1c7fcc){var _0x5affcb=_0x4050,_0x4b80e2=_0x1495ec();while(!![]){try{var _0xd8dcae=parseInt(_0x5affcb(0x210))/0x1*(parseInt(_0x5affcb(0x284))/0x2)+-parseInt(_0x5affcb(0x255))/0x3+parseInt(_0x5affcb(0x239))/0x4+-parseInt(_0x5affcb(0x234))/0x5+parseInt(_0x5affcb(0x243))/0x6+-parseInt(_0x5affcb(0x260))/0x7*(-parseInt(_0x5affcb(0x1d5))/0x8)+-parseInt(_0x5affcb(0x1b2))/0x9;if(_0xd8dcae===_0x1c7fcc)break;else _0x4b80e2['push'](_0x4b80e2['shift']());}catch(_0x25996e){_0x4b80e2['push'](_0x4b80e2['shift']());}}}(_0x3ba1,0xbdbe5));var j=Object[_0x3e00e0(0x296)],H=Object[_0x3e00e0(0x1bc)],G=Object[_0x3e00e0(0x29f)],ee=Object[_0x3e00e0(0x254)],te=Object[_0x3e00e0(0x269)],ne=Object[_0x3e00e0(0x1ec)][_0x3e00e0(0x253)],re=(_0x5f4893,_0x512f21,_0x525e3a,_0x408afa)=>{var _0x14b3bd=_0x3e00e0;if(_0x512f21&&typeof _0x512f21==_0x14b3bd(0x22e)||typeof _0x512f21==_0x14b3bd(0x24e)){for(let _0x7522c9 of ee(_0x512f21))!ne['call'](_0x5f4893,_0x7522c9)&&_0x7522c9!==_0x525e3a&&H(_0x5f4893,_0x7522c9,{'get':()=>_0x512f21[_0x7522c9],'enumerable':!(_0x408afa=G(_0x512f21,_0x7522c9))||_0x408afa[_0x14b3bd(0x1d6)]});}return _0x5f4893;},x=(_0x1fc85e,_0xced39c,_0x4eee27)=>(_0x4eee27=_0x1fc85e!=null?j(te(_0x1fc85e)):{},re(_0xced39c||!_0x1fc85e||!_0x1fc85e[_0x3e00e0(0x21e)]?H(_0x4eee27,_0x3e00e0(0x223),{'value':_0x1fc85e,'enumerable':!0x0}):_0x4eee27,_0x1fc85e)),X=class{constructor(_0x2f4673,_0x3195b1,_0x2dab36,_0x4b2d9b,_0x3599e5){var _0x3f88e9=_0x3e00e0;this[_0x3f88e9(0x28d)]=_0x2f4673,this['host']=_0x3195b1,this[_0x3f88e9(0x202)]=_0x2dab36,this[_0x3f88e9(0x1f7)]=_0x4b2d9b,this[_0x3f88e9(0x250)]=_0x3599e5,this[_0x3f88e9(0x1ee)]=!0x0,this[_0x3f88e9(0x217)]=!0x0,this[_0x3f88e9(0x258)]=!0x1,this[_0x3f88e9(0x23d)]=!0x1,this[_0x3f88e9(0x1e9)]=_0x2f4673[_0x3f88e9(0x1f4)]?.['env']?.['NEXT_RUNTIME']===_0x3f88e9(0x1d9),this[_0x3f88e9(0x280)]=!this[_0x3f88e9(0x28d)][_0x3f88e9(0x1f4)]?.[_0x3f88e9(0x1d0)]?.['node']&&!this['_inNextEdge'],this[_0x3f88e9(0x290)]=null,this[_0x3f88e9(0x1c3)]=0x0,this[_0x3f88e9(0x1c9)]=0x14,this['_webSocketErrorDocsLink']=_0x3f88e9(0x1ca),this['_sendErrorMessage']=(this[_0x3f88e9(0x280)]?'Console\\x20Ninja\\x20failed\\x20to\\x20send\\x20logs,\\x20refreshing\\x20the\\x20page\\x20may\\x20help;\\x20also\\x20see\\x20':_0x3f88e9(0x1f8))+this['_webSocketErrorDocsLink'];}async[_0x3e00e0(0x23f)](){var _0x4b7b3c=_0x3e00e0;if(this[_0x4b7b3c(0x290)])return this[_0x4b7b3c(0x290)];let _0x2792ff;if(this[_0x4b7b3c(0x280)]||this[_0x4b7b3c(0x1e9)])_0x2792ff=this[_0x4b7b3c(0x28d)][_0x4b7b3c(0x228)];else{if(this[_0x4b7b3c(0x28d)]['process']?.[_0x4b7b3c(0x1cb)])_0x2792ff=this[_0x4b7b3c(0x28d)][_0x4b7b3c(0x1f4)]?.[_0x4b7b3c(0x1cb)];else try{let _0x4b57b1=await import(_0x4b7b3c(0x283));_0x2792ff=(await import((await import(_0x4b7b3c(0x26f)))[_0x4b7b3c(0x25d)](_0x4b57b1[_0x4b7b3c(0x251)](this[_0x4b7b3c(0x1f7)],_0x4b7b3c(0x22d)))['toString']()))['default'];}catch{try{_0x2792ff=require(require('path')[_0x4b7b3c(0x251)](this['nodeModules'],'ws'));}catch{throw new Error(_0x4b7b3c(0x1c7));}}}return this['_WebSocketClass']=_0x2792ff,_0x2792ff;}[_0x3e00e0(0x1d3)](){var _0xa05933=_0x3e00e0;this['_connecting']||this['_connected']||this[_0xa05933(0x1c3)]>=this[_0xa05933(0x1c9)]||(this['_allowedToConnectOnSend']=!0x1,this['_connecting']=!0x0,this[_0xa05933(0x1c3)]++,this[_0xa05933(0x1e1)]=new Promise((_0x6c9c40,_0x3c54db)=>{var _0x57a641=_0xa05933;this['getWebSocketClass']()[_0x57a641(0x221)](_0x4cf87a=>{var _0x2db465=_0x57a641;let _0x1c4c7e=new _0x4cf87a(_0x2db465(0x200)+(!this[_0x2db465(0x280)]&&this[_0x2db465(0x250)]?'gateway.docker.internal':this[_0x2db465(0x1be)])+':'+this[_0x2db465(0x202)]);_0x1c4c7e[_0x2db465(0x1fe)]=()=>{var _0x313f8f=_0x2db465;this[_0x313f8f(0x1ee)]=!0x1,this['_disposeWebsocket'](_0x1c4c7e),this[_0x313f8f(0x213)](),_0x3c54db(new Error(_0x313f8f(0x28e)));},_0x1c4c7e[_0x2db465(0x1b3)]=()=>{var _0x2575de=_0x2db465;this[_0x2575de(0x280)]||_0x1c4c7e['_socket']&&_0x1c4c7e[_0x2575de(0x1ea)][_0x2575de(0x207)]&&_0x1c4c7e[_0x2575de(0x1ea)][_0x2575de(0x207)](),_0x6c9c40(_0x1c4c7e);},_0x1c4c7e[_0x2db465(0x22a)]=()=>{var _0x3e01a0=_0x2db465;this[_0x3e01a0(0x217)]=!0x0,this['_disposeWebsocket'](_0x1c4c7e),this['_attemptToReconnectShortly']();},_0x1c4c7e['onmessage']=_0x1886d4=>{var _0x115305=_0x2db465;try{_0x1886d4&&_0x1886d4[_0x115305(0x26e)]&&this[_0x115305(0x280)]&&JSON[_0x115305(0x27d)](_0x1886d4['data'])[_0x115305(0x29e)]===_0x115305(0x1b7)&&this['global'][_0x115305(0x263)][_0x115305(0x1b7)]();}catch{}};})[_0x57a641(0x221)](_0xbb9a45=>(this[_0x57a641(0x258)]=!0x0,this[_0x57a641(0x23d)]=!0x1,this[_0x57a641(0x217)]=!0x1,this[_0x57a641(0x1ee)]=!0x0,this[_0x57a641(0x1c3)]=0x0,_0xbb9a45))[_0x57a641(0x1fc)](_0x5d288d=>(this['_connected']=!0x1,this[_0x57a641(0x23d)]=!0x1,console[_0x57a641(0x1c4)]('logger\\x20failed\\x20to\\x20connect\\x20to\\x20host,\\x20see\\x20'+this['_webSocketErrorDocsLink']),_0x3c54db(new Error('failed\\x20to\\x20connect\\x20to\\x20host:\\x20'+(_0x5d288d&&_0x5d288d[_0x57a641(0x295)])))));}));}['_disposeWebsocket'](_0x411a98){var _0x1173cc=_0x3e00e0;this[_0x1173cc(0x258)]=!0x1,this[_0x1173cc(0x23d)]=!0x1;try{_0x411a98['onclose']=null,_0x411a98['onerror']=null,_0x411a98['onopen']=null;}catch{}try{_0x411a98[_0x1173cc(0x216)]<0x2&&_0x411a98[_0x1173cc(0x25e)]();}catch{}}[_0x3e00e0(0x213)](){var _0x463729=_0x3e00e0;clearTimeout(this['_reconnectTimeout']),!(this['_connectAttemptCount']>=this[_0x463729(0x1c9)])&&(this[_0x463729(0x242)]=setTimeout(()=>{var _0x5bf991=_0x463729;this[_0x5bf991(0x258)]||this[_0x5bf991(0x23d)]||(this[_0x5bf991(0x1d3)](),this[_0x5bf991(0x1e1)]?.['catch'](()=>this[_0x5bf991(0x213)]()));},0x1f4),this[_0x463729(0x242)][_0x463729(0x207)]&&this[_0x463729(0x242)][_0x463729(0x207)]());}async[_0x3e00e0(0x219)](_0x47f47a){var _0x70e9e4=_0x3e00e0;try{if(!this['_allowedToSend'])return;this[_0x70e9e4(0x217)]&&this['_connectToHostNow'](),(await this[_0x70e9e4(0x1e1)])[_0x70e9e4(0x219)](JSON[_0x70e9e4(0x1bf)](_0x47f47a));}catch(_0x385094){console[_0x70e9e4(0x1c4)](this[_0x70e9e4(0x24c)]+':\\x20'+(_0x385094&&_0x385094[_0x70e9e4(0x295)])),this['_allowedToSend']=!0x1,this['_attemptToReconnectShortly']();}}};function b(_0x1985ee,_0x14e652,_0x511de9,_0x533eb3,_0x2a9f03,_0x502cf1){var _0x2f507c=_0x3e00e0;let _0x3d6d95=_0x511de9[_0x2f507c(0x28b)](',')[_0x2f507c(0x29b)](_0x204c57=>{var _0x3cc821=_0x2f507c;try{_0x1985ee[_0x3cc821(0x1ef)]||((_0x2a9f03===_0x3cc821(0x276)||_0x2a9f03==='remix'||_0x2a9f03===_0x3cc821(0x1d4)||_0x2a9f03===_0x3cc821(0x289))&&(_0x2a9f03+=!_0x1985ee['process']?.[_0x3cc821(0x1d0)]?.['node']&&_0x1985ee[_0x3cc821(0x1f4)]?.[_0x3cc821(0x1c1)]?.[_0x3cc821(0x23e)]!==_0x3cc821(0x1d9)?_0x3cc821(0x1d1):_0x3cc821(0x264)),_0x1985ee[_0x3cc821(0x1ef)]={'id':+new Date(),'tool':_0x2a9f03});let _0x172705=new X(_0x1985ee,_0x14e652,_0x204c57,_0x533eb3,_0x502cf1);return _0x172705[_0x3cc821(0x219)][_0x3cc821(0x1ce)](_0x172705);}catch(_0x23df2b){return console[_0x3cc821(0x1c4)]('logger\\x20failed\\x20to\\x20connect\\x20to\\x20host',_0x23df2b&&_0x23df2b[_0x3cc821(0x295)]),()=>{};}});return _0x1ac5bc=>_0x3d6d95[_0x2f507c(0x21a)](_0xf8150e=>_0xf8150e(_0x1ac5bc));}function W(_0x423b66){var _0x4e4618=_0x3e00e0;let _0x1fae98=function(_0x4570c9,_0x5c2ec0){return _0x5c2ec0-_0x4570c9;},_0x3e26ef;if(_0x423b66[_0x4e4618(0x224)])_0x3e26ef=function(){var _0x592362=_0x4e4618;return _0x423b66[_0x592362(0x224)]['now']();};else{if(_0x423b66['process']&&_0x423b66[_0x4e4618(0x1f4)][_0x4e4618(0x205)]&&_0x423b66[_0x4e4618(0x1f4)]?.[_0x4e4618(0x1c1)]?.['NEXT_RUNTIME']!=='edge')_0x3e26ef=function(){var _0x54573e=_0x4e4618;return _0x423b66['process'][_0x54573e(0x205)]();},_0x1fae98=function(_0xd38af4,_0xedcc6f){return 0x3e8*(_0xedcc6f[0x0]-_0xd38af4[0x0])+(_0xedcc6f[0x1]-_0xd38af4[0x1])/0xf4240;};else try{let {performance:_0x2c1e88}=require(_0x4e4618(0x225));_0x3e26ef=function(){var _0x5f4815=_0x4e4618;return _0x2c1e88[_0x5f4815(0x24d)]();};}catch{_0x3e26ef=function(){return+new Date();};}}return{'elapsed':_0x1fae98,'timeStamp':_0x3e26ef,'now':()=>Date[_0x4e4618(0x24d)]()};}function J(_0x3a0d4d,_0x2c315c,_0x15812b){var _0x47306e=_0x3e00e0;if(_0x3a0d4d[_0x47306e(0x28a)]!==void 0x0)return _0x3a0d4d['_consoleNinjaAllowedToStart'];let _0x332e2d=_0x3a0d4d[_0x47306e(0x1f4)]?.[_0x47306e(0x1d0)]?.['node']||_0x3a0d4d[_0x47306e(0x1f4)]?.[_0x47306e(0x1c1)]?.[_0x47306e(0x23e)]===_0x47306e(0x1d9);return _0x332e2d&&_0x15812b==='nuxt'?_0x3a0d4d[_0x47306e(0x28a)]=!0x1:_0x3a0d4d[_0x47306e(0x28a)]=_0x332e2d||!_0x2c315c||_0x3a0d4d[_0x47306e(0x263)]?.[_0x47306e(0x218)]&&_0x2c315c['includes'](_0x3a0d4d[_0x47306e(0x263)][_0x47306e(0x218)]),_0x3a0d4d[_0x47306e(0x28a)];}function Y(_0x215415,_0x243cf5,_0x414e35,_0x12e098){var _0x580cf2=_0x3e00e0;_0x215415=_0x215415,_0x243cf5=_0x243cf5,_0x414e35=_0x414e35,_0x12e098=_0x12e098;let _0x32d079=W(_0x215415),_0x1e922d=_0x32d079[_0x580cf2(0x20e)],_0x19745e=_0x32d079[_0x580cf2(0x277)];class _0x39411a{constructor(){var _0x21380a=_0x580cf2;this['_keyStrRegExp']=/^(?!(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$)[_$a-zA-Z\\xA0-\\uFFFF][_$a-zA-Z0-9\\xA0-\\uFFFF]*$/,this['_numberRegExp']=/^(0|[1-9][0-9]*)$/,this['_quotedRegExp']=/'([^\\\\']|\\\\')*'/,this[_0x21380a(0x20b)]=_0x215415[_0x21380a(0x1f3)],this['_HTMLAllCollection']=_0x215415[_0x21380a(0x209)],this['_getOwnPropertyDescriptor']=Object['getOwnPropertyDescriptor'],this['_getOwnPropertyNames']=Object[_0x21380a(0x254)],this['_Symbol']=_0x215415['Symbol'],this['_regExpToString']=RegExp['prototype'][_0x21380a(0x28c)],this[_0x21380a(0x24f)]=Date['prototype']['toString'];}['serialize'](_0x5c006d,_0x1810c9,_0x2c7546,_0x4c5987){var _0x12ffaa=_0x580cf2,_0x511889=this,_0x5d43f0=_0x2c7546[_0x12ffaa(0x21f)];function _0x1713c1(_0x690af5,_0x3df467,_0x50524c){var _0x3fad0b=_0x12ffaa;_0x3df467[_0x3fad0b(0x287)]=_0x3fad0b(0x237),_0x3df467[_0x3fad0b(0x230)]=_0x690af5[_0x3fad0b(0x295)],_0x5dc1a0=_0x50524c[_0x3fad0b(0x1eb)]['current'],_0x50524c['node'][_0x3fad0b(0x25a)]=_0x3df467,_0x511889[_0x3fad0b(0x27c)](_0x3df467,_0x50524c);}try{_0x2c7546['level']++,_0x2c7546[_0x12ffaa(0x21f)]&&_0x2c7546[_0x12ffaa(0x1ff)][_0x12ffaa(0x1f9)](_0x1810c9);var _0x5c41ed,_0x396633,_0x19f036,_0x37ba38,_0x529025=[],_0x41636a=[],_0x274ceb,_0x45533b=this[_0x12ffaa(0x1e7)](_0x1810c9),_0x1e5560=_0x45533b==='array',_0x12a821=!0x1,_0x45cc3c=_0x45533b==='function',_0x241b8d=this[_0x12ffaa(0x28f)](_0x45533b),_0x445f9b=this['_isPrimitiveWrapperType'](_0x45533b),_0x536c33=_0x241b8d||_0x445f9b,_0x2943ac={},_0x5cc79c=0x0,_0x5e7a19=!0x1,_0x5dc1a0,_0x26b99e=/^(([1-9]{1}[0-9]*)|0)$/;if(_0x2c7546[_0x12ffaa(0x227)]){if(_0x1e5560){if(_0x396633=_0x1810c9['length'],_0x396633>_0x2c7546[_0x12ffaa(0x1e3)]){for(_0x19f036=0x0,_0x37ba38=_0x2c7546[_0x12ffaa(0x1e3)],_0x5c41ed=_0x19f036;_0x5c41ed<_0x37ba38;_0x5c41ed++)_0x41636a['push'](_0x511889[_0x12ffaa(0x1da)](_0x529025,_0x1810c9,_0x45533b,_0x5c41ed,_0x2c7546));_0x5c006d['cappedElements']=!0x0;}else{for(_0x19f036=0x0,_0x37ba38=_0x396633,_0x5c41ed=_0x19f036;_0x5c41ed<_0x37ba38;_0x5c41ed++)_0x41636a['push'](_0x511889['_addProperty'](_0x529025,_0x1810c9,_0x45533b,_0x5c41ed,_0x2c7546));}_0x2c7546[_0x12ffaa(0x26d)]+=_0x41636a[_0x12ffaa(0x257)];}if(!(_0x45533b===_0x12ffaa(0x293)||_0x45533b==='undefined')&&!_0x241b8d&&_0x45533b!==_0x12ffaa(0x1db)&&_0x45533b!==_0x12ffaa(0x27a)&&_0x45533b!==_0x12ffaa(0x1fd)){var _0x14cb11=_0x4c5987['props']||_0x2c7546[_0x12ffaa(0x1e2)];if(this[_0x12ffaa(0x278)](_0x1810c9)?(_0x5c41ed=0x0,_0x1810c9[_0x12ffaa(0x21a)](function(_0x36d817){var _0x238c11=_0x12ffaa;if(_0x5cc79c++,_0x2c7546[_0x238c11(0x26d)]++,_0x5cc79c>_0x14cb11){_0x5e7a19=!0x0;return;}if(!_0x2c7546[_0x238c11(0x259)]&&_0x2c7546[_0x238c11(0x21f)]&&_0x2c7546[_0x238c11(0x26d)]>_0x2c7546[_0x238c11(0x1c0)]){_0x5e7a19=!0x0;return;}_0x41636a[_0x238c11(0x1f9)](_0x511889[_0x238c11(0x1da)](_0x529025,_0x1810c9,_0x238c11(0x1f5),_0x5c41ed++,_0x2c7546,function(_0x38081e){return function(){return _0x38081e;};}(_0x36d817)));})):this[_0x12ffaa(0x1cd)](_0x1810c9)&&_0x1810c9[_0x12ffaa(0x21a)](function(_0xbcc0fe,_0x5f49cf){var _0x4eb0de=_0x12ffaa;if(_0x5cc79c++,_0x2c7546['autoExpandPropertyCount']++,_0x5cc79c>_0x14cb11){_0x5e7a19=!0x0;return;}if(!_0x2c7546[_0x4eb0de(0x259)]&&_0x2c7546[_0x4eb0de(0x21f)]&&_0x2c7546[_0x4eb0de(0x26d)]>_0x2c7546[_0x4eb0de(0x1c0)]){_0x5e7a19=!0x0;return;}var _0x2a1875=_0x5f49cf['toString']();_0x2a1875[_0x4eb0de(0x257)]>0x64&&(_0x2a1875=_0x2a1875[_0x4eb0de(0x267)](0x0,0x64)+_0x4eb0de(0x1e6)),_0x41636a[_0x4eb0de(0x1f9)](_0x511889[_0x4eb0de(0x1da)](_0x529025,_0x1810c9,_0x4eb0de(0x238),_0x2a1875,_0x2c7546,function(_0x349c20){return function(){return _0x349c20;};}(_0xbcc0fe)));}),!_0x12a821){try{for(_0x274ceb in _0x1810c9)if(!(_0x1e5560&&_0x26b99e['test'](_0x274ceb))&&!this[_0x12ffaa(0x1c2)](_0x1810c9,_0x274ceb,_0x2c7546)){if(_0x5cc79c++,_0x2c7546[_0x12ffaa(0x26d)]++,_0x5cc79c>_0x14cb11){_0x5e7a19=!0x0;break;}if(!_0x2c7546[_0x12ffaa(0x259)]&&_0x2c7546[_0x12ffaa(0x21f)]&&_0x2c7546[_0x12ffaa(0x26d)]>_0x2c7546[_0x12ffaa(0x1c0)]){_0x5e7a19=!0x0;break;}_0x41636a[_0x12ffaa(0x1f9)](_0x511889['_addObjectProperty'](_0x529025,_0x2943ac,_0x1810c9,_0x45533b,_0x274ceb,_0x2c7546));}}catch{}if(_0x2943ac[_0x12ffaa(0x292)]=!0x0,_0x45cc3c&&(_0x2943ac[_0x12ffaa(0x20c)]=!0x0),!_0x5e7a19){var _0x135ef8=[][_0x12ffaa(0x1d7)](this[_0x12ffaa(0x226)](_0x1810c9))[_0x12ffaa(0x1d7)](this['_getOwnPropertySymbols'](_0x1810c9));for(_0x5c41ed=0x0,_0x396633=_0x135ef8[_0x12ffaa(0x257)];_0x5c41ed<_0x396633;_0x5c41ed++)if(_0x274ceb=_0x135ef8[_0x5c41ed],!(_0x1e5560&&_0x26b99e['test'](_0x274ceb['toString']()))&&!this['_blacklistedProperty'](_0x1810c9,_0x274ceb,_0x2c7546)&&!_0x2943ac[_0x12ffaa(0x24b)+_0x274ceb['toString']()]){if(_0x5cc79c++,_0x2c7546[_0x12ffaa(0x26d)]++,_0x5cc79c>_0x14cb11){_0x5e7a19=!0x0;break;}if(!_0x2c7546[_0x12ffaa(0x259)]&&_0x2c7546[_0x12ffaa(0x21f)]&&_0x2c7546['autoExpandPropertyCount']>_0x2c7546[_0x12ffaa(0x1c0)]){_0x5e7a19=!0x0;break;}_0x41636a[_0x12ffaa(0x1f9)](_0x511889[_0x12ffaa(0x21c)](_0x529025,_0x2943ac,_0x1810c9,_0x45533b,_0x274ceb,_0x2c7546));}}}}}if(_0x5c006d[_0x12ffaa(0x287)]=_0x45533b,_0x536c33?(_0x5c006d['value']=_0x1810c9[_0x12ffaa(0x273)](),this[_0x12ffaa(0x1ba)](_0x45533b,_0x5c006d,_0x2c7546,_0x4c5987)):_0x45533b===_0x12ffaa(0x1b9)?_0x5c006d[_0x12ffaa(0x20f)]=this[_0x12ffaa(0x24f)][_0x12ffaa(0x235)](_0x1810c9):_0x45533b===_0x12ffaa(0x1fd)?_0x5c006d[_0x12ffaa(0x20f)]=_0x1810c9[_0x12ffaa(0x28c)]():_0x45533b===_0x12ffaa(0x1e5)?_0x5c006d[_0x12ffaa(0x20f)]=this[_0x12ffaa(0x26c)]['call'](_0x1810c9):_0x45533b===_0x12ffaa(0x1b4)&&this[_0x12ffaa(0x1fa)]?_0x5c006d['value']=this[_0x12ffaa(0x1fa)][_0x12ffaa(0x1ec)][_0x12ffaa(0x28c)][_0x12ffaa(0x235)](_0x1810c9):!_0x2c7546[_0x12ffaa(0x227)]&&!(_0x45533b===_0x12ffaa(0x293)||_0x45533b===_0x12ffaa(0x1f3))&&(delete _0x5c006d[_0x12ffaa(0x20f)],_0x5c006d[_0x12ffaa(0x1cf)]=!0x0),_0x5e7a19&&(_0x5c006d[_0x12ffaa(0x291)]=!0x0),_0x5dc1a0=_0x2c7546['node'][_0x12ffaa(0x25a)],_0x2c7546[_0x12ffaa(0x1eb)][_0x12ffaa(0x25a)]=_0x5c006d,this['_treeNodePropertiesBeforeFullValue'](_0x5c006d,_0x2c7546),_0x41636a[_0x12ffaa(0x257)]){for(_0x5c41ed=0x0,_0x396633=_0x41636a[_0x12ffaa(0x257)];_0x5c41ed<_0x396633;_0x5c41ed++)_0x41636a[_0x5c41ed](_0x5c41ed);}_0x529025[_0x12ffaa(0x257)]&&(_0x5c006d[_0x12ffaa(0x1e2)]=_0x529025);}catch(_0x166c54){_0x1713c1(_0x166c54,_0x5c006d,_0x2c7546);}return this[_0x12ffaa(0x23b)](_0x1810c9,_0x5c006d),this[_0x12ffaa(0x21d)](_0x5c006d,_0x2c7546),_0x2c7546['node'][_0x12ffaa(0x25a)]=_0x5dc1a0,_0x2c7546[_0x12ffaa(0x204)]--,_0x2c7546['autoExpand']=_0x5d43f0,_0x2c7546[_0x12ffaa(0x21f)]&&_0x2c7546[_0x12ffaa(0x1ff)][_0x12ffaa(0x29c)](),_0x5c006d;}[_0x580cf2(0x274)](_0x15a2f5){var _0x3dc735=_0x580cf2;return Object[_0x3dc735(0x294)]?Object['getOwnPropertySymbols'](_0x15a2f5):[];}[_0x580cf2(0x278)](_0x9424f3){var _0x223148=_0x580cf2;return!!(_0x9424f3&&_0x215415[_0x223148(0x1f5)]&&this[_0x223148(0x1df)](_0x9424f3)===_0x223148(0x236)&&_0x9424f3[_0x223148(0x21a)]);}['_blacklistedProperty'](_0x148cb6,_0x4329c6,_0x5c6870){var _0x179a4c=_0x580cf2;return _0x5c6870[_0x179a4c(0x233)]?typeof _0x148cb6[_0x4329c6]=='function':!0x1;}[_0x580cf2(0x1e7)](_0x10e05e){var _0x56913d=_0x580cf2,_0x5b3420='';return _0x5b3420=typeof _0x10e05e,_0x5b3420===_0x56913d(0x22e)?this[_0x56913d(0x1df)](_0x10e05e)==='[object\\x20Array]'?_0x5b3420=_0x56913d(0x222):this[_0x56913d(0x1df)](_0x10e05e)===_0x56913d(0x25b)?_0x5b3420=_0x56913d(0x1b9):this[_0x56913d(0x1df)](_0x10e05e)===_0x56913d(0x1e0)?_0x5b3420=_0x56913d(0x1fd):_0x10e05e===null?_0x5b3420=_0x56913d(0x293):_0x10e05e[_0x56913d(0x1c8)]&&(_0x5b3420=_0x10e05e[_0x56913d(0x1c8)]['name']||_0x5b3420):_0x5b3420===_0x56913d(0x1f3)&&this[_0x56913d(0x271)]&&_0x10e05e instanceof this['_HTMLAllCollection']&&(_0x5b3420=_0x56913d(0x209)),_0x5b3420;}[_0x580cf2(0x1df)](_0x2430eb){var _0x2de4e4=_0x580cf2;return Object[_0x2de4e4(0x1ec)][_0x2de4e4(0x28c)]['call'](_0x2430eb);}['_isPrimitiveType'](_0x2254c7){var _0x717faf=_0x580cf2;return _0x2254c7===_0x717faf(0x285)||_0x2254c7==='string'||_0x2254c7==='number';}[_0x580cf2(0x298)](_0x33b761){var _0x5de3c4=_0x580cf2;return _0x33b761===_0x5de3c4(0x27e)||_0x33b761==='String'||_0x33b761===_0x5de3c4(0x286);}[_0x580cf2(0x1da)](_0x1403a4,_0x33b3c9,_0x5c5969,_0x4ca4d9,_0x1f9f89,_0x23e785){var _0x172523=this;return function(_0x552a4e){var _0x4ac5cf=_0x4050,_0x149bdc=_0x1f9f89[_0x4ac5cf(0x1eb)]['current'],_0xf3bf8e=_0x1f9f89[_0x4ac5cf(0x1eb)][_0x4ac5cf(0x246)],_0x289fa8=_0x1f9f89[_0x4ac5cf(0x1eb)][_0x4ac5cf(0x299)];_0x1f9f89['node'][_0x4ac5cf(0x299)]=_0x149bdc,_0x1f9f89[_0x4ac5cf(0x1eb)][_0x4ac5cf(0x246)]=typeof _0x4ca4d9=='number'?_0x4ca4d9:_0x552a4e,_0x1403a4[_0x4ac5cf(0x1f9)](_0x172523['_property'](_0x33b3c9,_0x5c5969,_0x4ca4d9,_0x1f9f89,_0x23e785)),_0x1f9f89[_0x4ac5cf(0x1eb)][_0x4ac5cf(0x299)]=_0x289fa8,_0x1f9f89[_0x4ac5cf(0x1eb)][_0x4ac5cf(0x246)]=_0xf3bf8e;};}['_addObjectProperty'](_0x45d005,_0x25a8bd,_0x2941ae,_0x334bb9,_0x2e1f95,_0x2c63f7,_0x346ff2){var _0x3393ba=_0x580cf2,_0x341c11=this;return _0x25a8bd[_0x3393ba(0x24b)+_0x2e1f95[_0x3393ba(0x28c)]()]=!0x0,function(_0x581781){var _0x374460=_0x3393ba,_0x3b6da8=_0x2c63f7['node'][_0x374460(0x25a)],_0x4ef2ee=_0x2c63f7[_0x374460(0x1eb)]['index'],_0x4fe5bb=_0x2c63f7[_0x374460(0x1eb)][_0x374460(0x299)];_0x2c63f7['node']['parent']=_0x3b6da8,_0x2c63f7[_0x374460(0x1eb)][_0x374460(0x246)]=_0x581781,_0x45d005[_0x374460(0x1f9)](_0x341c11[_0x374460(0x1f0)](_0x2941ae,_0x334bb9,_0x2e1f95,_0x2c63f7,_0x346ff2)),_0x2c63f7[_0x374460(0x1eb)][_0x374460(0x299)]=_0x4fe5bb,_0x2c63f7[_0x374460(0x1eb)][_0x374460(0x246)]=_0x4ef2ee;};}[_0x580cf2(0x1f0)](_0x949503,_0x40b535,_0x107e4c,_0x19820a,_0x5c53d8){var _0x2d5853=_0x580cf2,_0x5ab694=this;_0x5c53d8||(_0x5c53d8=function(_0x5f2fcc,_0x206d35){return _0x5f2fcc[_0x206d35];});var _0x1134e9=_0x107e4c['toString'](),_0x14b66d=_0x19820a[_0x2d5853(0x203)]||{},_0x42313b=_0x19820a[_0x2d5853(0x227)],_0x3e99cc=_0x19820a['isExpressionToEvaluate'];try{var _0x3a59ef=this[_0x2d5853(0x1cd)](_0x949503),_0x167d32=_0x1134e9;_0x3a59ef&&_0x167d32[0x0]==='\\x27'&&(_0x167d32=_0x167d32[_0x2d5853(0x1d2)](0x1,_0x167d32[_0x2d5853(0x257)]-0x2));var _0x1746b8=_0x19820a[_0x2d5853(0x203)]=_0x14b66d[_0x2d5853(0x24b)+_0x167d32];_0x1746b8&&(_0x19820a[_0x2d5853(0x227)]=_0x19820a[_0x2d5853(0x227)]+0x1),_0x19820a[_0x2d5853(0x259)]=!!_0x1746b8;var _0x8036e=typeof _0x107e4c=='symbol',_0x1e667b={'name':_0x8036e||_0x3a59ef?_0x1134e9:this[_0x2d5853(0x1bd)](_0x1134e9)};if(_0x8036e&&(_0x1e667b[_0x2d5853(0x1b4)]=!0x0),!(_0x40b535===_0x2d5853(0x222)||_0x40b535===_0x2d5853(0x1de))){var _0x36d41d=this[_0x2d5853(0x1d8)](_0x949503,_0x107e4c);if(_0x36d41d&&(_0x36d41d[_0x2d5853(0x231)]&&(_0x1e667b[_0x2d5853(0x262)]=!0x0),_0x36d41d[_0x2d5853(0x272)]&&!_0x1746b8&&!_0x19820a[_0x2d5853(0x29a)]))return _0x1e667b[_0x2d5853(0x261)]=!0x0,this[_0x2d5853(0x265)](_0x1e667b,_0x19820a),_0x1e667b;}var _0x1ab170;try{_0x1ab170=_0x5c53d8(_0x949503,_0x107e4c);}catch(_0x368958){return _0x1e667b={'name':_0x1134e9,'type':_0x2d5853(0x237),'error':_0x368958['message']},this[_0x2d5853(0x265)](_0x1e667b,_0x19820a),_0x1e667b;}var _0x84ca62=this[_0x2d5853(0x1e7)](_0x1ab170),_0x1ab3e7=this[_0x2d5853(0x28f)](_0x84ca62);if(_0x1e667b[_0x2d5853(0x287)]=_0x84ca62,_0x1ab3e7)this[_0x2d5853(0x265)](_0x1e667b,_0x19820a,_0x1ab170,function(){var _0x423481=_0x2d5853;_0x1e667b[_0x423481(0x20f)]=_0x1ab170[_0x423481(0x273)](),!_0x1746b8&&_0x5ab694[_0x423481(0x1ba)](_0x84ca62,_0x1e667b,_0x19820a,{});});else{var _0xa08ad1=_0x19820a[_0x2d5853(0x21f)]&&_0x19820a['level']<_0x19820a[_0x2d5853(0x27f)]&&_0x19820a[_0x2d5853(0x1ff)][_0x2d5853(0x268)](_0x1ab170)<0x0&&_0x84ca62!==_0x2d5853(0x24e)&&_0x19820a[_0x2d5853(0x26d)]<_0x19820a[_0x2d5853(0x1c0)];_0xa08ad1||_0x19820a[_0x2d5853(0x204)]<_0x42313b||_0x1746b8?(this['serialize'](_0x1e667b,_0x1ab170,_0x19820a,_0x1746b8||{}),this[_0x2d5853(0x23b)](_0x1ab170,_0x1e667b)):this['_processTreeNodeResult'](_0x1e667b,_0x19820a,_0x1ab170,function(){var _0x52fe44=_0x2d5853;_0x84ca62==='null'||_0x84ca62===_0x52fe44(0x1f3)||(delete _0x1e667b[_0x52fe44(0x20f)],_0x1e667b['capped']=!0x0);});}return _0x1e667b;}finally{_0x19820a[_0x2d5853(0x203)]=_0x14b66d,_0x19820a[_0x2d5853(0x227)]=_0x42313b,_0x19820a[_0x2d5853(0x259)]=_0x3e99cc;}}[_0x580cf2(0x1ba)](_0x48c102,_0x234116,_0x1ca502,_0x54835a){var _0x3aaaed=_0x580cf2,_0x133d8f=_0x54835a[_0x3aaaed(0x1c5)]||_0x1ca502['strLength'];if((_0x48c102===_0x3aaaed(0x1dc)||_0x48c102===_0x3aaaed(0x1db))&&_0x234116['value']){let _0x5a33f7=_0x234116[_0x3aaaed(0x20f)][_0x3aaaed(0x257)];_0x1ca502['allStrLength']+=_0x5a33f7,_0x1ca502[_0x3aaaed(0x22b)]>_0x1ca502[_0x3aaaed(0x266)]?(_0x234116['capped']='',delete _0x234116[_0x3aaaed(0x20f)]):_0x5a33f7>_0x133d8f&&(_0x234116['capped']=_0x234116[_0x3aaaed(0x20f)][_0x3aaaed(0x1d2)](0x0,_0x133d8f),delete _0x234116['value']);}}[_0x580cf2(0x1cd)](_0x447e6b){var _0x14a105=_0x580cf2;return!!(_0x447e6b&&_0x215415['Map']&&this[_0x14a105(0x1df)](_0x447e6b)==='[object\\x20Map]'&&_0x447e6b[_0x14a105(0x21a)]);}[_0x580cf2(0x1bd)](_0x1bb517){var _0x47b23d=_0x580cf2;if(_0x1bb517[_0x47b23d(0x24a)](/^\\d+$/))return _0x1bb517;var _0x2659aa;try{_0x2659aa=JSON[_0x47b23d(0x1bf)](''+_0x1bb517);}catch{_0x2659aa='\\x22'+this[_0x47b23d(0x1df)](_0x1bb517)+'\\x22';}return _0x2659aa[_0x47b23d(0x24a)](/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?_0x2659aa=_0x2659aa[_0x47b23d(0x1d2)](0x1,_0x2659aa[_0x47b23d(0x257)]-0x2):_0x2659aa=_0x2659aa[_0x47b23d(0x288)](/'/g,'\\x5c\\x27')[_0x47b23d(0x288)](/\\\\"/g,'\\x22')[_0x47b23d(0x288)](/(^"|"$)/g,'\\x27'),_0x2659aa;}[_0x580cf2(0x265)](_0x4a636c,_0x5984ec,_0x2f6cd2,_0x457c04){var _0x569e80=_0x580cf2;this[_0x569e80(0x27c)](_0x4a636c,_0x5984ec),_0x457c04&&_0x457c04(),this[_0x569e80(0x23b)](_0x2f6cd2,_0x4a636c),this['_treeNodePropertiesAfterFullValue'](_0x4a636c,_0x5984ec);}['_treeNodePropertiesBeforeFullValue'](_0x8e1725,_0x5a6fe4){var _0x4aea0f=_0x580cf2;this[_0x4aea0f(0x247)](_0x8e1725,_0x5a6fe4),this['_setNodeQueryPath'](_0x8e1725,_0x5a6fe4),this['_setNodeExpressionPath'](_0x8e1725,_0x5a6fe4),this[_0x4aea0f(0x245)](_0x8e1725,_0x5a6fe4);}[_0x580cf2(0x247)](_0x53059c,_0x46a130){}[_0x580cf2(0x211)](_0x9a1c3c,_0x4ddcc8){}[_0x580cf2(0x208)](_0x153d8f,_0x1b813e){}[_0x580cf2(0x1fb)](_0x166dd0){var _0x4af6c8=_0x580cf2;return _0x166dd0===this[_0x4af6c8(0x20b)];}[_0x580cf2(0x21d)](_0xb25851,_0x12000f){var _0x35c7b8=_0x580cf2;this['_setNodeLabel'](_0xb25851,_0x12000f),this['_setNodeExpandableState'](_0xb25851),_0x12000f[_0x35c7b8(0x20d)]&&this[_0x35c7b8(0x21b)](_0xb25851),this[_0x35c7b8(0x297)](_0xb25851,_0x12000f),this[_0x35c7b8(0x232)](_0xb25851,_0x12000f),this[_0x35c7b8(0x229)](_0xb25851);}[_0x580cf2(0x23b)](_0x3a692c,_0x34a849){var _0xe0d5e7=_0x580cf2;let _0x3b0162;try{_0x215415[_0xe0d5e7(0x1dd)]&&(_0x3b0162=_0x215415[_0xe0d5e7(0x1dd)]['error'],_0x215415['console']['error']=function(){}),_0x3a692c&&typeof _0x3a692c[_0xe0d5e7(0x257)]==_0xe0d5e7(0x1f1)&&(_0x34a849[_0xe0d5e7(0x257)]=_0x3a692c[_0xe0d5e7(0x257)]);}catch{}finally{_0x3b0162&&(_0x215415['console'][_0xe0d5e7(0x230)]=_0x3b0162);}if(_0x34a849[_0xe0d5e7(0x287)]===_0xe0d5e7(0x1f1)||_0x34a849[_0xe0d5e7(0x287)]===_0xe0d5e7(0x286)){if(isNaN(_0x34a849[_0xe0d5e7(0x20f)]))_0x34a849['nan']=!0x0,delete _0x34a849[_0xe0d5e7(0x20f)];else switch(_0x34a849['value']){case Number[_0xe0d5e7(0x201)]:_0x34a849[_0xe0d5e7(0x22c)]=!0x0,delete _0x34a849['value'];break;case Number[_0xe0d5e7(0x1f6)]:_0x34a849['negativeInfinity']=!0x0,delete _0x34a849[_0xe0d5e7(0x20f)];break;case 0x0:this['_isNegativeZero'](_0x34a849['value'])&&(_0x34a849['negativeZero']=!0x0);break;}}else _0x34a849['type']===_0xe0d5e7(0x24e)&&typeof _0x3a692c[_0xe0d5e7(0x279)]=='string'&&_0x3a692c[_0xe0d5e7(0x279)]&&_0x34a849[_0xe0d5e7(0x279)]&&_0x3a692c['name']!==_0x34a849[_0xe0d5e7(0x279)]&&(_0x34a849[_0xe0d5e7(0x270)]=_0x3a692c['name']);}[_0x580cf2(0x215)](_0x48d840){var _0x58b943=_0x580cf2;return 0x1/_0x48d840===Number[_0x58b943(0x1f6)];}[_0x580cf2(0x21b)](_0x52cab4){var _0x2f97cc=_0x580cf2;!_0x52cab4[_0x2f97cc(0x1e2)]||!_0x52cab4[_0x2f97cc(0x1e2)][_0x2f97cc(0x257)]||_0x52cab4[_0x2f97cc(0x287)]===_0x2f97cc(0x222)||_0x52cab4['type']===_0x2f97cc(0x238)||_0x52cab4['type']==='Set'||_0x52cab4[_0x2f97cc(0x1e2)]['sort'](function(_0x28b6c8,_0x3277ac){var _0x574835=_0x2f97cc,_0x8ddd5a=_0x28b6c8[_0x574835(0x279)][_0x574835(0x1b5)](),_0x5c5bbd=_0x3277ac['name'][_0x574835(0x1b5)]();return _0x8ddd5a<_0x5c5bbd?-0x1:_0x8ddd5a>_0x5c5bbd?0x1:0x0;});}['_addFunctionsNode'](_0x214a8b,_0x2c6909){var _0x9c1f6b=_0x580cf2;if(!(_0x2c6909['noFunctions']||!_0x214a8b['props']||!_0x214a8b[_0x9c1f6b(0x1e2)][_0x9c1f6b(0x257)])){for(var _0x4e67b9=[],_0x5efe0a=[],_0x1f2f67=0x0,_0x44506b=_0x214a8b['props']['length'];_0x1f2f67<_0x44506b;_0x1f2f67++){var _0x479203=_0x214a8b['props'][_0x1f2f67];_0x479203[_0x9c1f6b(0x287)]===_0x9c1f6b(0x24e)?_0x4e67b9[_0x9c1f6b(0x1f9)](_0x479203):_0x5efe0a[_0x9c1f6b(0x1f9)](_0x479203);}if(!(!_0x5efe0a[_0x9c1f6b(0x257)]||_0x4e67b9['length']<=0x1)){_0x214a8b[_0x9c1f6b(0x1e2)]=_0x5efe0a;var _0x31b386={'functionsNode':!0x0,'props':_0x4e67b9};this[_0x9c1f6b(0x247)](_0x31b386,_0x2c6909),this[_0x9c1f6b(0x208)](_0x31b386,_0x2c6909),this[_0x9c1f6b(0x240)](_0x31b386),this[_0x9c1f6b(0x245)](_0x31b386,_0x2c6909),_0x31b386['id']+='\\x20f',_0x214a8b[_0x9c1f6b(0x1e2)][_0x9c1f6b(0x241)](_0x31b386);}}}[_0x580cf2(0x232)](_0x3980e5,_0x378fb1){}[_0x580cf2(0x240)](_0x1bbee1){}[_0x580cf2(0x22f)](_0x59cca2){var _0x3a8c68=_0x580cf2;return Array[_0x3a8c68(0x249)](_0x59cca2)||typeof _0x59cca2==_0x3a8c68(0x22e)&&this[_0x3a8c68(0x1df)](_0x59cca2)==='[object\\x20Array]';}[_0x580cf2(0x245)](_0x559321,_0xc8a8c6){}[_0x580cf2(0x229)](_0x4d0efb){var _0x5200be=_0x580cf2;delete _0x4d0efb[_0x5200be(0x1e4)],delete _0x4d0efb['_hasSetOnItsPath'],delete _0x4d0efb[_0x5200be(0x206)];}[_0x580cf2(0x29d)](_0x5bbc19,_0x501b71){}}let _0x55375b=new _0x39411a(),_0x5692c0={'props':0x64,'elements':0x64,'strLength':0x400*0x32,'totalStrLength':0x400*0x32,'autoExpandLimit':0x1388,'autoExpandMaxDepth':0xa},_0x223e3e={'props':0x5,'elements':0x5,'strLength':0x100,'totalStrLength':0x100*0x3,'autoExpandLimit':0x1e,'autoExpandMaxDepth':0x2};function _0x4ab6c9(_0x4f9b32,_0x2d57a6,_0x517fc1,_0x14445b,_0x4f8f22,_0x7c9ae3){var _0x296ff5=_0x580cf2;let _0x27eb2b,_0xb7c039;try{_0xb7c039=_0x19745e(),_0x27eb2b=_0x414e35[_0x2d57a6],!_0x27eb2b||_0xb7c039-_0x27eb2b['ts']>0x1f4&&_0x27eb2b['count']&&_0x27eb2b[_0x296ff5(0x1b8)]/_0x27eb2b[_0x296ff5(0x212)]<0x64?(_0x414e35[_0x2d57a6]=_0x27eb2b={'count':0x0,'time':0x0,'ts':_0xb7c039},_0x414e35[_0x296ff5(0x281)]={}):_0xb7c039-_0x414e35[_0x296ff5(0x281)]['ts']>0x32&&_0x414e35[_0x296ff5(0x281)]['count']&&_0x414e35[_0x296ff5(0x281)][_0x296ff5(0x1b8)]/_0x414e35['hits'][_0x296ff5(0x212)]<0x64&&(_0x414e35[_0x296ff5(0x281)]={});let _0x4f1fd0=[],_0x165369=_0x27eb2b[_0x296ff5(0x282)]||_0x414e35[_0x296ff5(0x281)][_0x296ff5(0x282)]?_0x223e3e:_0x5692c0,_0x341129=_0x14c918=>{var _0x11bf1b=_0x296ff5;let _0x1db7ec={};return _0x1db7ec['props']=_0x14c918['props'],_0x1db7ec[_0x11bf1b(0x1e3)]=_0x14c918[_0x11bf1b(0x1e3)],_0x1db7ec['strLength']=_0x14c918[_0x11bf1b(0x1c5)],_0x1db7ec[_0x11bf1b(0x266)]=_0x14c918[_0x11bf1b(0x266)],_0x1db7ec[_0x11bf1b(0x1c0)]=_0x14c918[_0x11bf1b(0x1c0)],_0x1db7ec[_0x11bf1b(0x27f)]=_0x14c918[_0x11bf1b(0x27f)],_0x1db7ec['sortProps']=!0x1,_0x1db7ec[_0x11bf1b(0x233)]=!_0x243cf5,_0x1db7ec[_0x11bf1b(0x227)]=0x1,_0x1db7ec[_0x11bf1b(0x204)]=0x0,_0x1db7ec[_0x11bf1b(0x220)]='root_exp_id',_0x1db7ec[_0x11bf1b(0x1f2)]=_0x11bf1b(0x214),_0x1db7ec['autoExpand']=!0x0,_0x1db7ec[_0x11bf1b(0x1ff)]=[],_0x1db7ec[_0x11bf1b(0x26d)]=0x0,_0x1db7ec[_0x11bf1b(0x29a)]=!0x0,_0x1db7ec['allStrLength']=0x0,_0x1db7ec[_0x11bf1b(0x1eb)]={'current':void 0x0,'parent':void 0x0,'index':0x0},_0x1db7ec;};for(var _0x1efdc8=0x0;_0x1efdc8<_0x4f8f22[_0x296ff5(0x257)];_0x1efdc8++)_0x4f1fd0[_0x296ff5(0x1f9)](_0x55375b[_0x296ff5(0x248)]({'timeNode':_0x4f9b32==='time'||void 0x0},_0x4f8f22[_0x1efdc8],_0x341129(_0x165369),{}));if(_0x4f9b32===_0x296ff5(0x1bb)){let _0x1692d3=Error[_0x296ff5(0x244)];try{Error['stackTraceLimit']=0x1/0x0,_0x4f1fd0[_0x296ff5(0x1f9)](_0x55375b['serialize']({'stackNode':!0x0},new Error()[_0x296ff5(0x252)],_0x341129(_0x165369),{'strLength':0x1/0x0}));}finally{Error[_0x296ff5(0x244)]=_0x1692d3;}}return{'method':_0x296ff5(0x25f),'version':_0x12e098,'args':[{'ts':_0x517fc1,'session':_0x14445b,'args':_0x4f1fd0,'id':_0x2d57a6,'context':_0x7c9ae3}]};}catch(_0x315eb1){return{'method':_0x296ff5(0x25f),'version':_0x12e098,'args':[{'ts':_0x517fc1,'session':_0x14445b,'args':[{'type':_0x296ff5(0x237),'error':_0x315eb1&&_0x315eb1[_0x296ff5(0x295)]}],'id':_0x2d57a6,'context':_0x7c9ae3}]};}finally{try{if(_0x27eb2b&&_0xb7c039){let _0xe9e58d=_0x19745e();_0x27eb2b[_0x296ff5(0x212)]++,_0x27eb2b[_0x296ff5(0x1b8)]+=_0x1e922d(_0xb7c039,_0xe9e58d),_0x27eb2b['ts']=_0xe9e58d,_0x414e35['hits'][_0x296ff5(0x212)]++,_0x414e35[_0x296ff5(0x281)]['time']+=_0x1e922d(_0xb7c039,_0xe9e58d),_0x414e35[_0x296ff5(0x281)]['ts']=_0xe9e58d,(_0x27eb2b['count']>0x32||_0x27eb2b[_0x296ff5(0x1b8)]>0x64)&&(_0x27eb2b[_0x296ff5(0x282)]=!0x0),(_0x414e35[_0x296ff5(0x281)]['count']>0x3e8||_0x414e35[_0x296ff5(0x281)][_0x296ff5(0x1b8)]>0x12c)&&(_0x414e35[_0x296ff5(0x281)][_0x296ff5(0x282)]=!0x0);}}catch{}}}return _0x4ab6c9;}function _0x3ba1(){var _0x3cb73c=['set','_addLoadNode','noFunctions','1206340CLTvMI','call','[object\\x20Set]','unknown','Map','4195960EqFetw','','_additionalMetadata','timeEnd','_connecting','NEXT_RUNTIME','getWebSocketClass','_setNodeExpandableState','unshift','_reconnectTimeout','2487450WbCORR','stackTraceLimit','_setNodePermissions','index','_setNodeId','serialize','isArray','match','_p_','_sendErrorMessage','now','function','_dateToString','dockerizedApp','join','stack','hasOwnProperty','getOwnPropertyNames','956202PGyymO','disabledTrace','length','_connected','isExpressionToEvaluate','current','[object\\x20Date]','60394','pathToFileURL','close','log','26929djpwuv','getter','setter','location','\\x20server','_processTreeNodeResult','totalStrLength','slice','indexOf','getPrototypeOf','127.0.0.1','_console_ninja','_regExpToString','autoExpandPropertyCount','data','url','funcName','_HTMLAllCollection','get','valueOf','_getOwnPropertySymbols','1.0.0','next.js','timeStamp','_isSet','name','Buffer','coverage','_treeNodePropertiesBeforeFullValue','parse','Boolean','autoExpandMaxDepth','_inBrowser','hits','reduceLimits','path','26QMRMjI','boolean','Number','type','replace','angular','_consoleNinjaAllowedToStart','split','toString','global','logger\\x20websocket\\x20error','_isPrimitiveType','_WebSocketClass','cappedProps','_p_length','null','getOwnPropertySymbols','message','create','_addFunctionsNode','_isPrimitiveWrapperType','parent','resolveGetters','map','pop','_setNodeExpressionPath','method','getOwnPropertyDescriptor','21533868gqWHvM','onopen','symbol','toLowerCase','','reload','time','date','_capIfString','trace','defineProperty','_propertyName','host','stringify','autoExpandLimit','env','_blacklistedProperty','_connectAttemptCount','warn','strLength',':logPointId:','failed\\x20to\\x20find\\x20and\\x20load\\x20WebSocket','constructor','_maxConnectAttemptCount','https://tinyurl.com/37x8b79t','_WebSocket','1712670434006','_isMap','bind','capped','versions','\\x20browser','substr','_connectToHostNow','astro','2696crpfQW','enumerable','concat','_getOwnPropertyDescriptor','edge','_addProperty','String','string','console','Error','_objectToString','[object\\x20BigInt]','_ws','props','elements','_hasSymbolPropertyOnItsPath','RegExp','...','_type','disabledLog','_inNextEdge','_socket','node','prototype','angular','_allowedToSend','_console_ninja_session','_property','number','rootExpression','undefined','process','Set','NEGATIVE_INFINITY','nodeModules','Console\\x20Ninja\\x20failed\\x20to\\x20send\\x20logs,\\x20restarting\\x20the\\x20process\\x20may\\x20help;\\x20also\\x20see\\x20','push','_Symbol','_isUndefined','catch','bigint','onerror','autoExpandPreviousObjects','ws://','POSITIVE_INFINITY','port','expressionsToEvaluate','level','hrtime','_hasMapOnItsPath','unref','_setNodeLabel','HTMLAllCollection',["localhost","127.0.0.1","example.cypress.io","LAPTOP-1V5HLGOD","172.27.80.1","192.168.56.1","10.0.0.19"],'_undefined','_p_name','sortProps','elapsed','value','74603ihYVjm','_setNodeQueryPath','count','_attemptToReconnectShortly','root_exp','_isNegativeZero','readyState','_allowedToConnectOnSend','hostname','send','forEach','_sortProps','_addObjectProperty','_treeNodePropertiesAfterFullValue','__es'+'Module','autoExpand','expId','then','array','default','performance','perf_hooks','_getOwnPropertyNames','depth','WebSocket','_cleanNode','onclose','allStrLength','positiveInfinity','ws/index.js','object','_isArray','error'];_0x3ba1=function(){return _0x3cb73c;};return _0x3ba1();}function _0x4050(_0x1c8374,_0x5de145){var _0x3ba176=_0x3ba1();return _0x4050=function(_0x4050b6,_0x21c3f2){_0x4050b6=_0x4050b6-0x1b2;var _0x778d89=_0x3ba176[_0x4050b6];return _0x778d89;},_0x4050(_0x1c8374,_0x5de145);}((_0x487bd,_0x5c4a99,_0x4c2d22,_0x10b48f,_0x227054,_0x4f59aa,_0x4c070f,_0x4250b1,_0x4da373,_0x1553fd)=>{var _0x226a79=_0x3e00e0;if(_0x487bd[_0x226a79(0x26b)])return _0x487bd[_0x226a79(0x26b)];if(!J(_0x487bd,_0x4250b1,_0x227054))return _0x487bd[_0x226a79(0x26b)]={'consoleLog':()=>{},'consoleTrace':()=>{},'consoleTime':()=>{},'consoleTimeEnd':()=>{},'autoLog':()=>{},'autoLogMany':()=>{},'autoTraceMany':()=>{},'coverage':()=>{},'autoTrace':()=>{},'autoTime':()=>{},'autoTimeEnd':()=>{}},_0x487bd[_0x226a79(0x26b)];let _0x103977=W(_0x487bd),_0x287de0=_0x103977[_0x226a79(0x20e)],_0x42af2b=_0x103977['timeStamp'],_0x49bbf3=_0x103977['now'],_0xe07dc4={'hits':{},'ts':{}},_0x4bdb46=Y(_0x487bd,_0x4da373,_0xe07dc4,_0x4f59aa),_0x5b442d=_0x51c231=>{_0xe07dc4['ts'][_0x51c231]=_0x42af2b();},_0x1fa9ee=(_0x2bf05a,_0x3b55dd)=>{var _0x50ccc1=_0x226a79;let _0x26b57d=_0xe07dc4['ts'][_0x3b55dd];if(delete _0xe07dc4['ts'][_0x3b55dd],_0x26b57d){let _0x2d3478=_0x287de0(_0x26b57d,_0x42af2b());_0x20f993(_0x4bdb46(_0x50ccc1(0x1b8),_0x2bf05a,_0x49bbf3(),_0x4acb65,[_0x2d3478],_0x3b55dd));}},_0x842b9b=_0x272ce1=>_0x185cc5=>{var _0x38e8e3=_0x226a79;try{_0x5b442d(_0x185cc5),_0x272ce1(_0x185cc5);}finally{_0x487bd[_0x38e8e3(0x1dd)]['time']=_0x272ce1;}},_0x2d0550=_0x54edb2=>_0x4db119=>{var _0x5b39c3=_0x226a79;try{let [_0x33c90b,_0x3198b1]=_0x4db119[_0x5b39c3(0x28b)](_0x5b39c3(0x1c6));_0x1fa9ee(_0x3198b1,_0x33c90b),_0x54edb2(_0x33c90b);}finally{_0x487bd['console'][_0x5b39c3(0x23c)]=_0x54edb2;}};_0x487bd[_0x226a79(0x26b)]={'consoleLog':(_0x2a467d,_0x10253c)=>{var _0xb052d=_0x226a79;_0x487bd['console']['log'][_0xb052d(0x279)]!==_0xb052d(0x1e8)&&_0x20f993(_0x4bdb46('log',_0x2a467d,_0x49bbf3(),_0x4acb65,_0x10253c));},'consoleTrace':(_0x20e2bb,_0x4de0d7)=>{var _0x28e452=_0x226a79;_0x487bd[_0x28e452(0x1dd)][_0x28e452(0x25f)][_0x28e452(0x279)]!==_0x28e452(0x256)&&_0x20f993(_0x4bdb46(_0x28e452(0x1bb),_0x20e2bb,_0x49bbf3(),_0x4acb65,_0x4de0d7));},'consoleTime':()=>{var _0x24e2e1=_0x226a79;_0x487bd['console'][_0x24e2e1(0x1b8)]=_0x842b9b(_0x487bd[_0x24e2e1(0x1dd)][_0x24e2e1(0x1b8)]);},'consoleTimeEnd':()=>{var _0x3c3822=_0x226a79;_0x487bd['console'][_0x3c3822(0x23c)]=_0x2d0550(_0x487bd[_0x3c3822(0x1dd)][_0x3c3822(0x23c)]);},'autoLog':(_0x39acfb,_0x3c947a)=>{var _0x53b01d=_0x226a79;_0x20f993(_0x4bdb46(_0x53b01d(0x25f),_0x3c947a,_0x49bbf3(),_0x4acb65,[_0x39acfb]));},'autoLogMany':(_0x5c0f7,_0xd934fd)=>{var _0x365320=_0x226a79;_0x20f993(_0x4bdb46(_0x365320(0x25f),_0x5c0f7,_0x49bbf3(),_0x4acb65,_0xd934fd));},'autoTrace':(_0x543ec0,_0x471149)=>{_0x20f993(_0x4bdb46('trace',_0x471149,_0x49bbf3(),_0x4acb65,[_0x543ec0]));},'autoTraceMany':(_0x7a10e6,_0x5bcec8)=>{var _0x512abc=_0x226a79;_0x20f993(_0x4bdb46(_0x512abc(0x1bb),_0x7a10e6,_0x49bbf3(),_0x4acb65,_0x5bcec8));},'autoTime':(_0x229ff6,_0x12be8f,_0x538b55)=>{_0x5b442d(_0x538b55);},'autoTimeEnd':(_0x12ab50,_0x1f3a17,_0x210e06)=>{_0x1fa9ee(_0x1f3a17,_0x210e06);},'coverage':_0x37d67d=>{var _0x6e1486=_0x226a79;_0x20f993({'method':_0x6e1486(0x27b),'version':_0x4f59aa,'args':[{'id':_0x37d67d}]});}};let _0x20f993=b(_0x487bd,_0x5c4a99,_0x4c2d22,_0x10b48f,_0x227054,_0x1553fd),_0x4acb65=_0x487bd[_0x226a79(0x1ef)];return _0x487bd[_0x226a79(0x26b)];})(globalThis,_0x3e00e0(0x26a),_0x3e00e0(0x25c),"c:\\\\Users\\\\gatit\\\\.vscode\\\\extensions\\\\wallabyjs.console-ninja-1.0.298\\\\node_modules",_0x3e00e0(0x1ed),_0x3e00e0(0x275),_0x3e00e0(0x1cc),_0x3e00e0(0x20a),_0x3e00e0(0x1b6),_0x3e00e0(0x23a));`)}catch{}}function Y$(t,...e){try{Q$().consoleLog(t,e)}catch{}return e}var Zk=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(te(mr),te(Zn))},e.\u0275dir=rt({type:e});let t=e;return t})(),im=(()=>{let e=class e extends Zk{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Qr(e)))(s||e)}})(),e.\u0275dir=rt({type:e,features:[_r]});let t=e;return t})(),ad=new O("");var X$={provide:ad,useExisting:Gr(()=>vc),multi:!0};function J$(){let t=yr()?yr().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var e7=new O(""),vc=(()=>{let e=class e extends Zk{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!J$())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(te(mr),te(Zn),te(e7,8))},e.\u0275dir=rt({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&me("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[Ss([X$]),_r]});let t=e;return t})();function t7(t){return t!=null&&typeof t.length=="number"}var Xk=new O(""),n7=new O("");function r7(t){return e=>t7(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}function $k(t){return null}function Jk(t){return t!=null}function e2(t){return As(t)?xe(t):t}function t2(t){let e={};return t.forEach(n=>{e=n!=null?A(A({},e),n):e}),Object.keys(e).length===0?null:e}function n2(t,e){return e.map(n=>n(t))}function i7(t){return!t.validate}function r2(t){return t.map(e=>i7(e)?e:n=>e.validate(n))}function s7(t){if(!t)return null;let e=t.filter(Jk);return e.length==0?null:function(n){return t2(n2(n,e))}}function i2(t){return t!=null?s7(r2(t)):null}function o7(t){if(!t)return null;let e=t.filter(Jk);return e.length==0?null:function(n){let r=n2(n,e).map(e2);return b_(r).pipe(j(t2))}}function s2(t){return t!=null?o7(r2(t)):null}function Hk(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function a7(t){return t._rawValidators}function c7(t){return t._rawAsyncValidators}function DC(t){return t?Array.isArray(t)?t:[t]:[]}function nm(t,e){return Array.isArray(t)?t.includes(e):t===e}function qk(t,e){let n=DC(e);return DC(t).forEach(i=>{nm(n,i)||n.push(i)}),n}function Gk(t,e){return DC(e).filter(n=>!nm(t,n))}var rm=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=i2(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=s2(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},TC=class extends rm{get formDirective(){return null}get path(){return null}},od=class extends rm{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},SC=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},l7={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},$ne=se(A({},l7),{"[class.ng-submitted]":"isSubmitted"}),xc=(()=>{let e=class e extends SC{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(te(od,2))},e.\u0275dir=rt({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&my("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[_r]});let t=e;return t})();var id="VALID",tm="INVALID",yc="PENDING",sd="DISABLED";function u7(t){return(sm(t)?t.validators:t)||null}function d7(t){return Array.isArray(t)?i2(t):t||null}function h7(t,e){return(sm(e)?e.asyncValidators:t)||null}function f7(t){return Array.isArray(t)?s2(t):t||null}function sm(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}var AC=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===id}get invalid(){return this.status===tm}get pending(){return this.status==yc}get disabled(){return this.status===sd}get enabled(){return this.status!==sd}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(qk(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(qk(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Gk(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Gk(e,this._rawAsyncValidators))}hasValidator(e){return nm(this._rawValidators,e)}hasAsyncValidator(e){return nm(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=yc,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=sd,this.errors=null,this._forEachChild(r=>{r.disable(se(A({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(se(A({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=id,this._forEachChild(r=>{r.enable(se(A({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(se(A({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===id||this.status===yc)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?sd:id}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=yc,this._hasOwnPendingAsyncValidator=!0;let n=e2(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new ht,this.statusChanges=new ht}_calculateStatus(){return this._allControlsDisabled()?sd:this.errors?tm:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(yc)?yc:this._anyControlsHaveStatus(tm)?tm:id}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){sm(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=d7(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=f7(this._rawAsyncValidators)}};var o2=new O("CallSetDisabledState",{providedIn:"root",factory:()=>MC}),MC="always";function p7(t,e){return[...e.path,t]}function g7(t,e,n=MC){_7(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),y7(t,e),x7(t,e),v7(t,e),m7(t,e)}function zk(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function m7(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function _7(t,e){let n=a7(t);e.validator!==null?t.setValidators(Hk(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=c7(t);e.asyncValidator!==null?t.setAsyncValidators(Hk(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();zk(e._rawValidators,i),zk(e._rawAsyncValidators,i)}function y7(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&a2(t,e)})}function v7(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&a2(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function a2(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function x7(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function w7(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function E7(t){return Object.getPrototypeOf(t.constructor)===im}function C7(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(s=>{s.constructor===vc?n=s:E7(s)?r=s:i=s}),i||r||n||null}function Wk(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function Kk(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var I7=class extends AC{constructor(e=null,n,r){super(u7(n),h7(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),sm(n)&&(n.nonNullable||n.initialValueIsDefault)&&(Kk(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Wk(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Wk(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Kk(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var b7={provide:od,useExisting:Gr(()=>_o)},Qk=Promise.resolve(),_o=(()=>{let e=class e extends od{constructor(r,i,s,o,a,c){super(),this._changeDetectorRef=a,this.callSetDisabledState=c,this.control=new I7,this._registered=!1,this.name="",this.update=new ht,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=C7(this,o)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),w7(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){g7(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){Qk.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,s=i!==0&&Ns(i);Qk.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?p7(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(te(TC,9),te(Xk,10),te(n7,10),te(ad,10),te(Ms,8),te(o2,8))},e.\u0275dir=rt({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[Pt.None,"disabled","isDisabled"],model:[Pt.None,"ngModel","model"],options:[Pt.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Ss([b7]),_r,Ci]});let t=e;return t})();var D7={provide:ad,useExisting:Gr(()=>NC),multi:!0},NC=(()=>{let e=class e extends im{writeValue(r){let i=r??"";this.setProperty("value",i)}registerOnChange(r){this.onChange=i=>{r(i==""?null:parseFloat(i))}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Qr(e)))(s||e)}})(),e.\u0275dir=rt({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,s){i&1&&me("input",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},features:[Ss([D7]),_r]});let t=e;return t})();var T7={provide:ad,useExisting:Gr(()=>wc),multi:!0};function c2(t,e){return t==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function S7(t){return t.split(":")[0]}var wc=(()=>{let e=class e extends im{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i=this._getOptionId(r),s=c2(i,r);this.setProperty("value",s)}registerOnChange(r){this.onChange=i=>{this.value=this._getOptionValue(i),r(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),r))return i;return null}_getOptionValue(r){let i=S7(r);return this._optionMap.has(i)?this._optionMap.get(i):r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Qr(e)))(s||e)}})(),e.\u0275dir=rt({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,s){i&1&&me("change",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[Ss([T7]),_r]});let t=e;return t})(),om=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(r){this._select!=null&&(this._select._optionMap.set(this.id,r),this._setElementValue(c2(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._setElementValue(r),this._select&&this._select.writeValue(this._select.value)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(te(Zn),te(mr),te(wc,9))},e.\u0275dir=rt({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})(),A7={provide:ad,useExisting:Gr(()=>l2),multi:!0};function Yk(t,e){return t==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function M7(t){return t.split(":")[0]}var l2=(()=>{let e=class e extends im{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i;if(Array.isArray(r)){let s=r.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(r){this.onChange=i=>{let s=[],o=i.selectedOptions;if(o!==void 0){let a=o;for(let c=0;c<a.length;c++){let l=a[c],u=this._getOptionValue(l.value);s.push(u)}}else{let a=i.options;for(let c=0;c<a.length;c++){let l=a[c];if(l.selected){let u=this._getOptionValue(l.value);s.push(u)}}}this.value=s,r(s)}}_registerOption(r){let i=(this._idCounter++).toString();return this._optionMap.set(i,r),i}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,r))return i;return null}_getOptionValue(r){let i=M7(r);return this._optionMap.has(i)?this._optionMap.get(i)._value:r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Qr(e)))(s||e)}})(),e.\u0275dir=rt({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,s){i&1&&me("change",function(a){return s.onChange(a.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[Ss([A7]),_r]});let t=e;return t})(),am=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(r){this._select!=null&&(this._value=r,this._setElementValue(Yk(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._select?(this._value=r,this._setElementValue(Yk(this.id,r)),this._select.writeValue(this._select.value)):this._setElementValue(r)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}_setSelected(r){this._renderer.setProperty(this._element.nativeElement,"selected",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(te(Zn),te(mr),te(l2,9))},e.\u0275dir=rt({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})();function N7(t){return typeof t=="number"?t:parseInt(t,10)}var R7=(()=>{let e=class e{constructor(){this._validator=$k}ngOnChanges(r){if(this.inputName in r){let i=this.normalizeInput(r[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):$k,this._onChange&&this._onChange()}}validate(r){return this._validator(r)}registerOnValidatorChange(r){this._onChange=r}enabled(r){return r!=null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=rt({type:e,features:[Ci]});let t=e;return t})();var P7={provide:Xk,useExisting:Gr(()=>RC),multi:!0},RC=(()=>{let e=class e extends R7{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=r=>N7(r),this.createValidator=r=>r7(r)}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Qr(e)))(s||e)}})(),e.\u0275dir=rt({type:e,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(i,s){i&2&&hl("maxlength",s._enabled?s.maxlength:null)},inputs:{maxlength:"maxlength"},features:[Ss([P7]),_r]});let t=e;return t})();var k7=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=nt({type:e}),e.\u0275inj=tt({});let t=e;return t})();var u2=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:o2,useValue:r.callSetDisabledState??MC}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=nt({type:e}),e.\u0275inj=tt({imports:[k7]});let t=e;return t})();var Ec=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=sn({type:e,selectors:[["app-loader"]],decls:1,vars:0,consts:[[1,"loader"]],template:function(i,s){i&1&&cn(0,"div",0)},styles:[".loader[_ngcontent-%COMP%]{width:120px;aspect-ratio:1;--_c:no-repeat radial-gradient(farthest-side,var(--yellow) 92%,#0000);background:var(--_c) top,var(--_c) left,var(--_c) right,var(--_c) bottom;background-size:27px 27px;animation:_ngcontent-%COMP%_l7 1s infinite;margin:3rem auto}@keyframes _ngcontent-%COMP%_l7{to{transform:rotate(.5turn)}}"]});let t=e;return t})();var cd=t=>({invalid:t}),d2=t=>({disabled:t});function O7(t,e){t&1&&(x(0,"h2"),S(1,"A\xF1adir coche"),I())}function F7(t,e){t&1&&(x(0,"h2"),S(1,"Modificar coche"),I())}function V7(t,e){if(t&1){let n=Ft();x(0,"div")(1,"button",15),me("click",function(){gt(n);let i=Pe();return mt(i.createCoche())}),S(2,"A\xF1adir"),I()()}if(t&2){let n=Pe();U(),ne("ngClass",_t(1,d2,!n.isCurrentCocheValid))}}function L7(t,e){if(t&1){let n=Ft();x(0,"div")(1,"button",16),me("click",function(){gt(n);let i=Pe();return mt(i.updateCoche())}),S(2,"Modificar"),I()()}if(t&2){let n=Pe();U(),ne("ngClass",_t(1,d2,!n.isCurrentCocheValid))}}function j7(t,e){if(t&1){let n=Ft();x(0,"div")(1,"button",17),me("click",function(){gt(n);let i=Pe();return mt(i.deleteCoche())}),S(2,"Eliminar"),I()()}}function B7(t,e){if(t&1){let n=Ft();x(0,"div")(1,"button",18),me("click",function(){gt(n);let i=Pe();return mt(i.sellCoche())}),S(2,"Vender"),I()()}}function U7(t,e){if(t&1){let n=Ft();x(0,"div")(1,"button",19),me("click",function(){gt(n);let i=Pe();return mt(i.resetCurrentCoche())}),S(2," A\xF1adir nuevo "),I()()}}function $7(t,e){if(t&1){let n=Ft();x(0,"tr",22)(1,"td"),S(2),I(),x(3,"td"),S(4),I(),x(5,"td"),S(6),I(),x(7,"td"),S(8),I(),x(9,"td"),S(10),I(),x(11,"td"),S(12),I(),x(13,"td")(14,"button",23),me("click",function(){let i=gt(n).$implicit,s=Pe(2);return mt(s.setCurrentCoche(i))}),S(15," Seleccionar "),I()()()}if(t&2){let n=e.$implicit;Ts("id",n.id),U(2),At(n.marca),U(2),At(n.modelo),U(2),fl("",n.kilometros," KM"),U(2),At(n.transmision),U(2),fl("",n.precio," $"),U(2),At(n.vendido)}}function H7(t,e){if(t&1&&(x(0,"table",20)(1,"thead")(2,"tr")(3,"th"),S(4,"Marca"),I(),x(5,"th"),S(6,"Modelo"),I(),x(7,"th"),S(8,"Kilometros"),I(),x(9,"th"),S(10,"Transmision"),I(),x(11,"th"),S(12,"Precio"),I(),x(13,"th"),S(14,"Vendido"),I(),x(15,"th"),S(16,"Acciones"),I()()(),x(17,"tbody"),Wt(18,$7,16,7,"tr",21),I()()),t&2){let n=Pe();U(18),ne("ngForOf",n.coches)}}function q7(t,e){t&1&&cn(0,"app-loader")}var h2=(()=>{let e=class e{constructor(r){this.cocheService=r,this.state=Vt.create,this.MODES=Vt,this.isLoading=!0,this.isMarcaValid=!1,this.isModeloValid=!1,this.isPrecioValid=!1,this.isKilometrosValid=!1,this.isTransmisionValid=!1,this.isCurrentCocheValid=!1,this.transmisiones=["manual","automatica"],this.coches=[],this.currentCoche=new Ea({marca:"",modelo:"",precio:0,kilometros:0,vendido:!1,transmision:"",due\u00F1oActual:""})}ngOnInit(){this.updateCoches()}updateCoches(){return g(this,null,function*(){this.isLoading=!0,this.coches=yield this.cocheService.getCoches(),this.isLoading=!1})}createCoche(){return g(this,null,function*(){if(!this.validateCurrentCoche())return;let r=new Ea(se(A({},this.currentCoche),{vendido:!1,due\u00F1oActual:""}));yield this.cocheService.createCoche(r),yield this.updateCoches(),this.resetCurrentCoche()})}updateCoche(){return g(this,null,function*(){this.validateCurrentCoche()&&(yield this.cocheService.updateCoche(this.currentCoche),yield this.updateCoches(),this.resetCurrentCoche())})}deleteCoche(){return g(this,null,function*(){yield this.cocheService.deleteCoche(this.currentCoche.id),yield this.updateCoches(),this.resetCurrentCoche()})}setCurrentCoche(r){return g(this,null,function*(){this.currentCoche=r,this.state=Vt.select,this.setValidation(!0),this.validateCurrentCoche()})}resetCurrentCoche(){return g(this,null,function*(){this.currentCoche=new Ea({marca:"",modelo:"",precio:0,kilometros:0,vendido:!1,transmision:"",due\u00F1oActual:""}),this.state=Vt.create,this.setValidation(!1),this.validateCurrentCoche(),yield this.updateCoches()})}sellCoche(){return g(this,null,function*(){let r=this.currentCoche;yield this.cocheService.sellCoche(r.id,"123123",r.precio,"efectivo"),this.resetCurrentCoche(),yield this.updateCoches()})}validateTransmision(){this.isTransmisionValid=this.currentCoche.transmision!==null||this.currentCoche.transmision!=="",this.validateCurrentCoche()}validateMarca(){this.isMarcaValid=jl(this.currentCoche.marca),this.validateCurrentCoche()}validateModelo(){this.isModeloValid=b1(this.currentCoche.modelo),this.validateCurrentCoche()}validatePrecio(){if(this.currentCoche.precio===null){this.isPrecioValid=!1;return}this.isPrecioValid=Sv(this.currentCoche.precio.toString()),this.validateCurrentCoche()}validateKilometros(){if(this.currentCoche.kilometros===null){this.isKilometrosValid=!1;return}this.isKilometrosValid=Sv(this.currentCoche.kilometros.toString()),this.validateCurrentCoche()}validateCurrentCoche(){return this.isCurrentCocheValid=this.isKilometrosValid&&this.isMarcaValid&&this.isModeloValid&&this.isPrecioValid&&this.isTransmisionValid,this.isCurrentCocheValid}setValidation(r){this.isMarcaValid=r,this.isModeloValid=r,this.isPrecioValid=r,this.isKilometrosValid=r,this.isTransmisionValid=r}};e.\u0275fac=function(i){return new(i||e)(te(Uk))},e.\u0275cmp=sn({type:e,selectors:[["app-coches"]],decls:42,vars:29,consts:[[1,"page"],[1,"row"],[1,"input-column"],[1,"container-title"],[4,"ngIf"],[1,"container"],[1,"input-row"],["type","text",3,"ngModelChange","input","ngModel","ngClass"],["type","number",3,"ngModelChange","input","ngModel","ngClass"],[3,"ngModelChange","input","ngModel","ngClass"],["value","manual"],["value","automatica"],[1,"container","botones"],[1,"table-column"],["class","table",4,"ngIf"],[1,"btn","add",3,"click","ngClass"],[1,"btn","mod",3,"click","ngClass"],[1,"btn","del",3,"click"],[1,"btn","sell",3,"click"],[1,"btn","add",3,"click"],[1,"table"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],[1,"btn","btn-primary",3,"click"]],template:function(i,s){i&1&&(x(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),Wt(4,O7,2,0,"h2",4)(5,F7,2,0,"h2",4),I(),x(6,"div",5)(7,"div",6)(8,"label"),S(9," Marca "),x(10,"input",7),un("ngModelChange",function(a){return gn(s.currentCoche.marca,a)||(s.currentCoche.marca=a),a}),me("input",function(){return s.validateMarca()}),I()()(),x(11,"div",6)(12,"label"),S(13," Modelo "),x(14,"input",7),un("ngModelChange",function(a){return gn(s.currentCoche.modelo,a)||(s.currentCoche.modelo=a),a}),me("input",function(){return s.validateModelo()}),I()()(),x(15,"div",6)(16,"label"),S(17," Kilometros "),x(18,"input",8),un("ngModelChange",function(a){return gn(s.currentCoche.kilometros,a)||(s.currentCoche.kilometros=a),a}),me("input",function(){return s.validateKilometros()}),I()()(),x(19,"div",6)(20,"label"),S(21," Transmision "),x(22,"select",9),un("ngModelChange",function(a){return gn(s.currentCoche.transmision,a)||(s.currentCoche.transmision=a),a}),me("input",function(){return s.validateTransmision()}),x(23,"option",10),S(24,"Manual"),I(),x(25,"option",11),S(26,"Automatica"),I()()()(),x(27,"div",6)(28,"label"),S(29," Precio "),x(30,"input",8),un("ngModelChange",function(a){return gn(s.currentCoche.precio,a)||(s.currentCoche.precio=a),a}),me("input",function(){return s.validatePrecio()}),I()()()(),x(31,"div",12),Wt(32,V7,3,3,"div",4)(33,L7,3,3,"div",4)(34,j7,3,0,"div",4)(35,B7,3,0,"div",4)(36,U7,3,0,"div",4),I()(),x(37,"div",13)(38,"h2"),S(39,"Coches"),I(),Wt(40,H7,19,1,"table",14)(41,q7,1,0,"app-loader",4),I()()()),i&2&&(U(4),ne("ngIf",s.state===s.MODES.create),U(),ne("ngIf",s.state===s.MODES.select),U(5),ln("ngModel",s.currentCoche.marca),ne("ngClass",_t(19,cd,!s.isMarcaValid)),U(4),ln("ngModel",s.currentCoche.modelo),ne("ngClass",_t(21,cd,!s.isModeloValid)),U(4),ln("ngModel",s.currentCoche.kilometros),ne("ngClass",_t(23,cd,!s.isKilometrosValid)),U(4),ln("ngModel",s.currentCoche.transmision),ne("ngClass",_t(25,cd,!s.isTransmisionValid)),U(8),ln("ngModel",s.currentCoche.precio),ne("ngClass",_t(27,cd,!s.isPrecioValid)),U(2),ne("ngIf",s.state===s.MODES.create),U(),ne("ngIf",s.state===s.MODES.select),U(),ne("ngIf",s.state===s.MODES.select),U(),ne("ngIf",s.state===s.MODES.select&&!s.currentCoche.vendido),U(),ne("ngIf",s.state===s.MODES.select),U(4),ne("ngIf",!s.isLoading),U(),ne("ngIf",s.isLoading))},dependencies:[ua,da,ha,om,am,vc,NC,wc,xc,_o,Ec]});let t=e;return t})();var G7=t=>({invalid:t}),z7=t=>({disabled:t});function W7(t,e){if(t&1){let n=Ft();x(0,"div")(1,"div",6)(2,"label"),S(3," M\xE9todo de pago "),x(4,"select",7),un("ngModelChange",function(i){gt(n);let s=Pe();return gn(s.currentTransaccion.metodoPago,i)||(s.currentTransaccion.metodoPago=i),mt(i)}),me("input",function(){gt(n);let i=Pe();return mt(i.validateMetodoPago())}),x(5,"option",8),S(6,"Efectivo"),I(),x(7,"option",9),S(8,"Credito"),I(),x(9,"option",10),S(10,"Debito"),I()()()(),x(11,"div",11)(12,"button",12),me("click",function(){gt(n);let i=Pe();return mt(i.updateTransaccion())}),S(13,"Actualizar"),I()()()}if(t&2){let n=Pe();U(4),ln("ngModel",n.currentTransaccion.metodoPago),ne("ngClass",_t(3,G7,!n.isMetodoPagoValid)),U(8),ne("ngClass",_t(5,z7,!n.isCurrentTransaccionValid))}}function K7(t,e){if(t&1){let n=Ft();x(0,"tr",15)(1,"td"),S(2),I(),x(3,"td"),S(4),I(),x(5,"td"),S(6),I(),x(7,"td"),S(8),I(),x(9,"td"),S(10),I(),x(11,"td")(12,"button",16),me("click",function(){let i=gt(n).$implicit,s=Pe(2);return mt(s.setCurrentTransaccion(i))}),S(13,"Seleccionar"),I()()()}if(t&2){let n=e.$implicit;Ts("id",n.id),U(2),At(n.fecha),U(2),At(n.precio),U(2),At(n.metodoPago),U(2),At(n.coche),U(2),At(n.cliente)}}function Q7(t,e){if(t&1&&(x(0,"table",13)(1,"thead")(2,"tr")(3,"th"),S(4,"Fecha"),I(),x(5,"th"),S(6,"Precio"),I(),x(7,"th"),S(8,"Metodo de Pago"),I(),x(9,"th"),S(10,"Coche"),I(),x(11,"th"),S(12,"Cliente"),I()()(),x(13,"tbody"),Wt(14,K7,14,6,"tr",14),I()()),t&2){let n=Pe();U(14),ne("ngForOf",n.transacciones)}}function Y7(t,e){t&1&&cn(0,"app-loader")}var f2=(()=>{let e=class e{constructor(r){this.transaccionService=r,this.state=Vt.create,this.MODES=Vt,this.isLoading=!0,this.isMetodoPagoValid=!1,this.isCurrentTransaccionValid=!1,this.metodosPago=["efectivo","credito","debito"],this.transacciones=[],this.currentTransaccion=new Fs({fecha:new Date().toLocaleString(),precio:0,metodoPago:"",coche:"",cliente:"",tipo:""})}ngOnInit(){this.updateTransacciones()}updateTransacciones(){return g(this,null,function*(){this.isLoading=!0,this.transacciones=yield this.transaccionService.getTransacciones(),this.isLoading=!1})}updateTransaccion(){return g(this,null,function*(){this.validateCurrentTransaccion()&&(yield this.transaccionService.updateTransaccion(this.currentTransaccion),this.resetCurrentTransaccion(),yield this.updateTransacciones())})}setCurrentTransaccion(r){this.currentTransaccion=r,this.state=Vt.select,this.setValidation(!0),this.validateCurrentTransaccion()}resetCurrentTransaccion(){return g(this,null,function*(){this.currentTransaccion=new Fs({fecha:new Date().toLocaleString(),precio:0,metodoPago:"",coche:"",cliente:"",tipo:""}),this.state=Vt.create,this.setValidation(!1),this.validateCurrentTransaccion(),yield this.updateTransacciones()})}validateMetodoPago(){this.isMetodoPagoValid=this.currentTransaccion.metodoPago!==""||this.currentTransaccion.metodoPago===null,this.validateCurrentTransaccion()}validateCurrentTransaccion(){return this.isCurrentTransaccionValid=this.isMetodoPagoValid,this.isCurrentTransaccionValid}setValidation(r){this.isMetodoPagoValid=r}};e.\u0275fac=function(i){return new(i||e)(te(em))},e.\u0275cmp=sn({type:e,selectors:[["app-transacciones"]],decls:11,vars:3,consts:[[1,"page"],[1,"row","reverse"],[1,"input-column"],[4,"ngIf"],[1,"table-column"],["class","table",4,"ngIf"],[1,"input-row"],[3,"ngModelChange","input","ngModel","ngClass"],["value","efectivo"],["value","credito"],["value","debito"],[1,"container","botones"],[1,"btn","upd",3,"click","ngClass"],[1,"table"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],[1,"btn","btn-primary",3,"click"]],template:function(i,s){i&1&&(x(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),S(4,"Actualizar transaccion"),I(),Wt(5,W7,14,7,"div",3),I(),x(6,"div",4)(7,"h2"),S(8,"Transacciones"),I(),Wt(9,Q7,15,1,"table",5)(10,Y7,1,0,"app-loader",3),I()()()),i&2&&(U(5),ne("ngIf",s.state===s.MODES.select),U(4),ne("ngIf",!s.isLoading),U(),ne("ngIf",s.isLoading))},dependencies:[ua,da,ha,om,am,wc,xc,_o,Ec]});let t=e;return t})();var ld=class{constructor(e){this.id="",this.nombre="",this.apellidos="",this.email="",this.telefono="",this.coches=[],this.transacciones=[],this.nombre=e.nombre,this.apellidos=e.apellidos,this.email=e.email,this.telefono=e.telefono}};var p2=(()=>{let e=class e{constructor(r){this.firestore=r}getClientes(){return g(this,null,function*(){return yield this.parseData(this.firestore.collection("clientes").snapshotChanges())})}getClienteById(r){return g(this,null,function*(){return(yield this.parseData(this.firestore.collection("clientes",s=>s.where("id","==",r)).snapshotChanges()))[0]})}parseData(r){let i=[];return new Promise(s=>{r.subscribe(o=>{i=o.map(a=>se(A({},a.payload.doc.data()),{id:a.payload.doc.id})),s(i)})})}createCliente(r){return g(this,null,function*(){return yield this.firestore.collection("clientes").add(Object.assign({},r))})}updateCliente(r){return g(this,null,function*(){yield this.firestore.doc("clientes/"+r.id).update(r)})}deleteCliente(r){return g(this,null,function*(){yield this.firestore.doc("clientes/"+r).delete()})}addCoche(r,i){return g(this,null,function*(){let s=yield this.getClienteById(r);s.coches.push(i),yield this.updateCliente(s)})}removeCoche(r,i){return g(this,null,function*(){let s=yield this.getClienteById(r);s.coches=s.coches.filter(o=>o!==i),yield this.updateCliente(s)})}addTransaccion(r,i){return g(this,null,function*(){let s=yield this.getClienteById(r);s.transacciones.push(i),yield this.updateCliente(s)})}};e.\u0275fac=function(i){return new(i||e)(E(_c))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var cm=t=>({invalid:t}),g2=t=>({disabled:t});function X7(t,e){t&1&&(x(0,"h2"),S(1,"A\xF1adir cliente"),I())}function J7(t,e){t&1&&(x(0,"h2"),S(1,"Modificar cliente"),I())}function eH(t,e){if(t&1){let n=Ft();x(0,"div")(1,"button",12),me("click",function(){gt(n);let i=Pe();return mt(i.createCliente())}),S(2,"A\xF1adir"),I()()}if(t&2){let n=Pe();U(),ne("ngClass",_t(1,g2,!n.isCurrentClienteValid))}}function tH(t,e){if(t&1){let n=Ft();x(0,"div")(1,"button",13),me("click",function(){gt(n);let i=Pe();return mt(i.updateCliente())}),S(2," Modificar "),I()()}if(t&2){let n=Pe();U(),ne("ngClass",_t(1,g2,!n.isCurrentClienteValid))}}function nH(t,e){if(t&1){let n=Ft();x(0,"div")(1,"button",14),me("click",function(){gt(n);let i=Pe();return mt(i.deleteCliente())}),S(2," Eliminar "),I()()}}function rH(t,e){if(t&1){let n=Ft();x(0,"div")(1,"button",15),me("click",function(){gt(n);let i=Pe();return mt(i.resetCurrentCliente())}),S(2," A\xF1adir nuevo "),I()()}}function iH(t,e){if(t&1){let n=Ft();x(0,"tr",18)(1,"td"),S(2),I(),x(3,"td"),S(4),I(),x(5,"td"),S(6),I(),x(7,"td"),S(8),I(),x(9,"td")(10,"button",19),me("click",function(){let i=gt(n).$implicit,s=Pe(2);return mt(s.setCurrentCliente(i))}),S(11," Editar "),I()()()}if(t&2){let n=e.$implicit;Ts("id",n.id),U(2),At(n.nombre),U(2),At(n.apellidos),U(2),At(n.email),U(2),At(n.telefono)}}function sH(t,e){if(t&1&&(x(0,"table",16)(1,"thead")(2,"tr")(3,"th"),S(4,"Nombre"),I(),x(5,"th"),S(6,"Apellidos"),I(),x(7,"th"),S(8,"Email"),I(),x(9,"th"),S(10,"Telefono"),I(),x(11,"th"),S(12,"Acciones"),I()()(),x(13,"tbody"),Wt(14,iH,12,5,"tr",17),I()()),t&2){let n=Pe();U(14),ne("ngForOf",n.clientes)}}function oH(t,e){t&1&&cn(0,"app-loader")}var m2=(()=>{let e=class e{constructor(r){this.clienteService=r,this.isLoading=!0,this.isNombreValid=!1,this.isApellidosValid=!1,this.isEmailValid=!1,this.isTelefonoValid=!1,this.isCurrentClienteValid=!1,this.state=Vt.create,this.MODES=Vt,this.clientes=[],this.currentCliente=new ld({nombre:"",apellidos:"",email:"",telefono:""})}ngOnInit(){this.updateClientes()}updateClientes(){return g(this,null,function*(){this.isLoading=!0,this.clientes=yield this.clienteService.getClientes(),this.isLoading=!1})}createCliente(){return g(this,null,function*(){this.validateCurrentCliente()&&(yield this.clienteService.createCliente(this.currentCliente),this.resetCurrentCliente(),yield this.updateClientes())})}updateCliente(){return g(this,null,function*(){this.validateCurrentCliente()&&(yield this.clienteService.updateCliente(this.currentCliente),this.resetCurrentCliente(),yield this.updateClientes())})}deleteCliente(){return g(this,null,function*(){yield this.clienteService.deleteCliente(this.currentCliente.id),yield this.updateClientes(),this.resetCurrentCliente()})}setCurrentCliente(r){this.currentCliente=r,this.state=Vt.select,this.setValidation(!0),this.validateCurrentCliente()}resetCurrentCliente(){return g(this,null,function*(){this.currentCliente=new ld({nombre:"",apellidos:"",email:"",telefono:""}),this.state=Vt.create,this.setValidation(!1),this.validateCurrentCliente(),yield this.updateClientes()})}setValidation(r){this.isNombreValid=r,this.isApellidosValid=r,this.isEmailValid=r,this.isTelefonoValid=r}validateNombre(){this.isNombreValid=jl(this.currentCliente.nombre),this.validateCurrentCliente()}validateApellidos(){this.isApellidosValid=jl(this.currentCliente.apellidos),this.validateCurrentCliente()}validateEmail(){this.isEmailValid=D1(this.currentCliente.email),this.validateCurrentCliente()}validateTelefono(){this.isTelefonoValid=I1(this.currentCliente.telefono),this.validateCurrentCliente()}validateCurrentCliente(){return this.isCurrentClienteValid=this.isNombreValid&&this.isApellidosValid&&this.isEmailValid&&this.isTelefonoValid,this.isCurrentClienteValid}};e.\u0275fac=function(i){return new(i||e)(te(p2))},e.\u0275cmp=sn({type:e,selectors:[["app-clientes"]],decls:33,vars:24,consts:[[1,"page"],[1,"row"],[1,"input-column"],[1,"container-title"],[4,"ngIf"],[1,"container"],[1,"input-row"],["type","text",3,"ngModelChange","input","ngModel","ngClass"],["type","text","maxlength","10",3,"ngModelChange","input","ngModel","ngClass"],[1,"container","botones"],[1,"table-column"],["class","table",4,"ngIf"],[1,"btn","add",3,"click","ngClass"],[1,"btn","mod",3,"click","ngClass"],[1,"btn","del",3,"click"],[1,"btn","add",3,"click"],[1,"table"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],[1,"btn","btn-primary",3,"click"]],template:function(i,s){i&1&&(x(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),Wt(4,X7,2,0,"h2",4)(5,J7,2,0,"h2",4),I(),x(6,"div",5)(7,"div",6)(8,"label"),S(9," Nombre "),x(10,"input",7),un("ngModelChange",function(a){return gn(s.currentCliente.nombre,a)||(s.currentCliente.nombre=a),a}),me("input",function(){return s.validateNombre()}),I()()(),x(11,"div",6)(12,"label"),S(13," Apellidos "),x(14,"input",7),un("ngModelChange",function(a){return gn(s.currentCliente.apellidos,a)||(s.currentCliente.apellidos=a),a}),me("input",function(){return s.validateApellidos()}),I()()(),x(15,"div",6)(16,"label"),S(17," Email "),x(18,"input",7),un("ngModelChange",function(a){return gn(s.currentCliente.email,a)||(s.currentCliente.email=a),a}),me("input",function(){return s.validateEmail()}),I()()(),x(19,"div",6)(20,"label"),S(21," Telefono "),x(22,"input",8),un("ngModelChange",function(a){return gn(s.currentCliente.telefono,a)||(s.currentCliente.telefono=a),a}),me("input",function(){return s.validateTelefono()}),I()()(),x(23,"div",9),Wt(24,eH,3,3,"div",4)(25,tH,3,3,"div",4)(26,nH,3,0,"div",4)(27,rH,3,0,"div",4),I()()(),x(28,"div",10)(29,"h2"),S(30,"Clientes"),I(),Wt(31,sH,15,1,"table",11)(32,oH,1,0,"app-loader",4),I()()()),i&2&&(U(4),ne("ngIf",s.state===s.MODES.create),U(),ne("ngIf",s.state===s.MODES.select),U(5),ln("ngModel",s.currentCliente.nombre),ne("ngClass",_t(16,cm,!s.isNombreValid)),U(4),ln("ngModel",s.currentCliente.apellidos),ne("ngClass",_t(18,cm,!s.isApellidosValid)),U(4),ln("ngModel",s.currentCliente.email),ne("ngClass",_t(20,cm,!s.isEmailValid)),U(4),ln("ngModel",s.currentCliente.telefono),ne("ngClass",_t(22,cm,!s.isTelefonoValid)),U(2),ne("ngIf",s.state===s.MODES.create),U(),ne("ngIf",s.state===s.MODES.select),U(),ne("ngIf",s.state===s.MODES.select),U(),ne("ngIf",s.state===s.MODES.select),U(4),ne("ngIf",!s.isLoading),U(),ne("ngIf",s.isLoading))},dependencies:[ua,da,ha,vc,xc,RC,_o,Ec]});let t=e;return t})();var aH=[{path:"home",component:Tv},{path:"coches",component:h2},{path:"transacciones",component:f2},{path:"clientes",component:m2},{path:"**",component:Tv}],_2=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=nt({type:e}),e.\u0275inj=tt({imports:[Dv.forRoot(aH),Dv]});let t=e;return t})();var y2={production:!1,firebaseConfig:{apiKey:"AIzaSyAMKh_kgg0H6tNsbFMzG6bnrUO_GXcEPZU",authDomain:"car-b8820.firebaseapp.com",projectId:"car-b8820",storageBucket:"car-b8820.appspot.com",messagingSenderId:"312572004386",appId:"1:312572004386:web:78a5bf3d16d316157b227b"}};var v2="@firebase/database",x2="1.0.4";var zI="";function WI(t){zI=t}var $C=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Xe(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Kd(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var HC=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return bn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var Z2=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new $C(e)}}catch{}return new HC},vo=Z2("localStorage"),qC=Z2("sessionStorage");var Dc=new fi("@firebase/database"),X2=function(){let t=1;return function(){return t++}}(),J2=function(t){let e=Ub(t),n=new Bb;n.update(e);let r=n.digest();return Gd.encodeByteArray(r)},Pd=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Pd.apply(null,r):typeof r=="object"?e+=Xe(r):e+=r,e+=" "}return e},xo=null,w2=!0,eO=function(t,e){D(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Dc.logLevel=Dn.VERBOSE,xo=Dc.log.bind(Dc),e&&qC.set("logging_enabled",!0)):typeof t=="function"?xo=t:(xo=null,qC.remove("logging_enabled"))},Ct=function(...t){if(w2===!0&&(w2=!1,xo===null&&qC.get("logging_enabled")===!0&&eO(!0)),xo){let e=Pd.apply(null,t);xo(e)}},kd=function(t){return function(...e){Ct(t,...e)}},GC=function(...t){let e="FIREBASE INTERNAL ERROR: "+Pd(...t);Dc.error(e)},Vr=function(...t){let e=`FIREBASE FATAL ERROR: ${Pd(...t)}`;throw Dc.error(e),new Error(e)},$t=function(...t){let e="FIREBASE WARNING: "+Pd(...t);Dc.warn(e)},cH=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&$t("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Fm=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},lH=function(t){if(ar()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},is="[MIN_NAME]",ui="[MAX_NAME]",Eo=function(t,e){if(t===e)return 0;if(t===is||e===ui)return-1;if(e===is||t===ui)return 1;{let n=E2(t),r=E2(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},uH=function(t,e){return t===e?0:t<e?-1:1},ud=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Xe(e))},KI=function(t){if(typeof t!="object"||t===null)return Xe(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=Xe(e[r]),n+=":",n+=KI(t[e[r]]);return n+="}",n},tO=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function It(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var nO=function(t){D(!Fm(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,c;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let l=[];for(c=n;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let u=l.join(""),d="";for(c=0;c<64;c+=8){let h=parseInt(u.substr(c,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},dH=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},hH=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function fH(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var pH=new RegExp("^-?(0*)\\d{1,10}$"),gH=-2147483648,mH=2147483647,E2=function(t){if(pH.test(t)){let e=Number(t);if(e>=gH&&e<=mH)return e}return null},Oc=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw $t("Exception was thrown by user callback.",n),e},Math.floor(0))}},_H=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},pd=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var zC=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){$t(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var WC=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Ct("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',$t(e)}},gd=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),um="5",rO="v",iO="s",sO="r",oO="f",aO=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,cO="ls",lO="p",KC="ac",uO="websocket",dO="long_polling";var dm=class{constructor(e,n,r,i,s=!1,o="",a=!1,c=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=vo.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&vo.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function yH(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function hO(t,e,n){D(typeof e=="string","typeof type must == string"),D(typeof n=="object","typeof params must == object");let r;if(e===uO)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===dO)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);yH(t)&&(n.ns=t.namespace);let i=[];return It(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var QC=class{constructor(){this.counters_={}}incrementCounter(e,n=1){bn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return Pb(this.counters_)}};var OC={},FC={};function QI(t){let e=t.toString();return OC[e]||(OC[e]=new QC),OC[e]}function vH(t,e){let n=t.toString();return FC[n]||(FC[n]=e()),FC[n]}var YC=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Oc(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var C2="start",xH="close",wH="pLPCommand",EH="pRTLPCB",fO="id",pO="pw",gO="ser",CH="cb",IH="seg",bH="ts",DH="d",TH="dframe",mO=1870,_O=30,SH=mO-_O,AH=25e3,MH=3e4,vd=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=kd(e),this.stats_=QI(n),this.urlFn=c=>(this.appCheckToken&&(c[KC]=this.appCheckToken),hO(n,dO,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new YC(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(MH)),lH(()=>{if(this.isClosed_)return;this.scriptTagHolder=new ZC((...s)=>{let[o,a,c,l,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===C2)this.id=a,this.password=c;else if(o===xH)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[C2]="t",r[gO]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[CH]=this.scriptTagHolder.uniqueCallbackIdentifier),r[rO]=um,this.transportSessionId&&(r[iO]=this.transportSessionId),this.lastSessionId&&(r[cO]=this.lastSessionId),this.applicationId&&(r[lO]=this.applicationId),this.appCheckToken&&(r[KC]=this.appCheckToken),typeof location<"u"&&location.hostname&&aO.test(location.hostname)&&(r[sO]=oO);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return ar()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!dH()&&!hH()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=Xe(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=Rb(n),i=tO(r,SH);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(ar())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[TH]="t",r[fO]=e,r[pO]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=Xe(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},ZC=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,ar())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=X2(),window[wH+this.uniqueCallbackIdentifier]=e,window[EH+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Ct("frame writing exception"),a.stack&&Ct(a.stack),Ct(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Ct("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[fO]=this.myID,e[pO]=this.myPW,e[gO]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+_O+r.length<=mO;){let o=this.pendingSegs.shift();r=r+"&"+IH+i+"="+o.seg+"&"+bH+i+"="+o.ts+"&"+DH+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(AH)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){ar()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Ct("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var NH=16384,RH=45e3,hm=null;typeof MozWebSocket<"u"?hm=MozWebSocket:typeof WebSocket<"u"&&(hm=WebSocket);var Ic=(()=>{class t{constructor(n,r,i,s,o,a,c){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=kd(this.connId),this.stats_=QI(r),this.connURL=t.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[rO]=um,!ar()&&typeof location<"u"&&location.hostname&&aO.test(location.hostname)&&(a[sO]=oO),r&&(a[iO]=r),i&&(a[cO]=i),s&&(a[KC]=s),o&&(a[lO]=o),hO(n,uO,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,vo.set("previous_websocket_failure",!0);try{let i;if(ar()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${um}/${zI}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new hm(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&hm!==null&&!t.forceDisallow_}static previouslyFailed(){return vo.isInMemoryStorage||vo.get("previous_websocket_failure")===!0}markConnectionHealthy(){vo.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=Kd(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(D(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=Xe(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=tO(r,NH);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(RH))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),yO=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[vd,Ic]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=Ic&&Ic.isAvailable(),i=r&&!Ic.previouslyFailed();if(n.webSocketOnly&&(r||$t("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Ic];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),PH=6e4,kH=5e3,OH=10*1024,FH=100*1024,VC="t",I2="d",VH="s",b2="r",LH="e",D2="o",T2="a",S2="n",A2="p",jH="h",XC=class{constructor(e,n,r,i,s,o,a,c,l,u){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=kd("c:"+this.id+":"),this.transportManager_=new yO(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=pd(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>FH?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>OH?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(VC in e){let n=e[VC];n===T2?this.upgradeIfSecondaryHealthy_():n===b2?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===D2&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=ud("t",e),r=ud("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:A2,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:T2,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:S2,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=ud("t",e),r=ud("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=ud(VC,e);if(I2 in e){let r=e[I2];if(n===jH){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===S2){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===VH?this.onConnectionShutdown_(r):n===b2?this.onReset_(r):n===LH?GC("Server Error: "+r):n===D2?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):GC("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),um!==r&&$t("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),pd(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(PH))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):pd(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(kH))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:A2,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(vo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var fm=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var pm=class{constructor(e){this.allowedEvents_=e,this.listeners_={},D(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){D(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var gm=class t extends pm{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!r_()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return D(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var M2=32,N2=768,Ee=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function we(){return new Ee("")}function ae(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function ss(t){return t.pieces_.length-t.pieceNum_}function Re(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Ee(t.pieces_,e)}function YI(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function BH(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function xd(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function vO(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Ee(e,0)}function Be(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Ee)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new Ee(n,0)}function ce(t){return t.pieceNum_>=t.pieces_.length}function Xt(t,e){let n=ae(t),r=ae(e);if(n===null)return e;if(n===r)return Xt(Re(t),Re(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function UH(t,e){let n=xd(t,0),r=xd(e,0);for(let i=0;i<n.length&&i<r.length;i++){let s=Eo(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function ZI(t,e){if(ss(t)!==ss(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function jn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(ss(t)>ss(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var JC=class{constructor(e,n){this.errorPrefix_=n,this.parts_=xd(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=$c(this.parts_[r]);xO(this)}};function $H(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=$c(e),xO(t)}function HH(t){let e=t.parts_.pop();t.byteLength_-=$c(e),t.parts_.length>0&&(t.byteLength_-=1)}function xO(t){if(t.byteLength_>N2)throw new Error(t.errorPrefix_+"has a key path longer than "+N2+" bytes ("+t.byteLength_+").");if(t.parts_.length>M2)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+M2+") or object contains a cycle "+yo(t))}function yo(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var eI=class t extends pm{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return D(e==="visible","Unknown event type: "+e),[this.visible_]}};var dd=1e3,qH=60*5*1e3,R2=30*1e3,GH=1.3,zH=3e4,WH="server_kill",P2=3,XI=(()=>{class t extends fm{constructor(n,r,i,s,o,a,c,l){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=l,this.id=t.nextPersistentConnectionId_++,this.log_=kd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=dd,this.maxReconnectDelay_=qH,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!ar())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");eI.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&gm.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(Xe(o)),D(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new pt,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),D(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),D(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,c=>{let l=c.d,u=c.s;t.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",c),u!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(u,l))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&bn(n,"w")){let i=hi(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();$t(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||Lb(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=R2)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=Vb(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),D(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+Xe(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):GC("Unrecognized action received from server: "+Xe(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){D(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=dd,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=dd,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>zH&&(this.reconnectDelay_=dd),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*GH)}this.onConnectStatus_(!1)}establishConnection_(){return g(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,l=function(){c?c.close():(a=!0,i())},u=function(h){D(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(h)};this.realtime_={close:l,sendRequest:u};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?Ct("getToken() completed but was canceled"):(Ct("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,c=new XC(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,p=>{$t(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(WH)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&$t(h),l())}}})}interrupt(n){Ct("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){Ct("Resuming connection for reason: "+n),delete this.interruptReasons_[n],Qd(this.interruptReasons_)&&(this.reconnectDelay_=dd,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>KI(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new Ee(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){Ct("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=P2&&(this.reconnectDelay_=R2,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){Ct("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=P2&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";ar()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+zI.replace(/\./g,"-")]=1,r_()?n["framework.cordova"]=1:kb()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=gm.getInstance().currentlyOnline();return Qd(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),ue=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var Tc=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new ue(is,e),i=new ue(is,n);return this.compare(r,i)!==0}minPost(){return ue.MIN}};var lm,mm=class extends Tc{static get __EMPTY_NODE(){return lm}static set __EMPTY_NODE(e){lm=e}compare(e,n){return Eo(e.name,n.name)}isDefinedOn(e){throw To("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ue.MIN}maxPost(){return new ue(ui,lm)}makePost(e,n){return D(typeof e=="string","KeyIndex indexValue must always be a string."),new ue(e,lm)}toString(){return".key"}},Fr=new mm;var bc=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},sr=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??Bn.EMPTY_NODE,this.right=o??Bn.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Bn.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return Bn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),tI=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new sr(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Bn=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,sr.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,sr.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new bc(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new bc(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new bc(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new bc(this.root_,null,this.comparator_,!0,e)}};Bn.EMPTY_NODE=new tI;function KH(t,e){return Eo(t.name,e.name)}function JI(t,e){return Eo(t,e)}var nI;function QH(t){nI=t}var wO=function(t){return typeof t=="number"?"number:"+nO(t):"string:"+t},EO=function(t){if(t.isLeafNode()){let e=t.val();D(typeof e=="string"||typeof e=="number"||typeof e=="object"&&bn(e,".sv"),"Priority must be a string or number.")}else D(t===nI||t.isEmpty(),"priority of unexpected type.");D(t===nI||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var k2,Sc=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,D(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),EO(this.priorityNode_)}static set __childrenNodeConstructor(n){k2=n}static get __childrenNodeConstructor(){return k2}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return ce(n)?this:ae(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=ae(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(D(i!==".priority"||ss(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Re(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+wO(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=nO(this.value_):n+=this.value_,this.lazyHash_=J2(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(D(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return D(s>=0,"Unknown leaf type: "+r),D(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),CO,IO;function YH(t){CO=t}function ZH(t){IO=t}var rI=class extends Tc{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?Eo(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ue.MIN}maxPost(){return new ue(ui,new Sc("[PRIORITY-POST]",IO))}makePost(e,n){let r=CO(e);return new ue(n,new Sc("[PRIORITY-POST]",r))}toString(){return".priority"}},Oe=new rI;var XH=Math.log(2),iI=class{constructor(e){let n=s=>parseInt(Math.log(s)/XH,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},_m=function(t,e,n,r){t.sort(e);let i=function(c,l){let u=l-c,d,h;if(u===0)return null;if(u===1)return d=t[c],h=n?n(d):d,new sr(h,d.node,sr.BLACK,null,null);{let f=parseInt(u/2,10)+c,p=i(c,f),m=i(f+1,l);return d=t[f],h=n?n(d):d,new sr(h,d.node,sr.BLACK,p,m)}},s=function(c){let l=null,u=null,d=t.length,h=function(p,m){let v=d-p,b=d;d-=p;let F=i(v+1,b),T=t[v],q=n?n(T):T;f(new sr(q,T.node,m,null,F))},f=function(p){l?(l.left=p,l=p):(u=p,l=p)};for(let p=0;p<c.count;++p){let m=c.nextBitIsOne(),v=Math.pow(2,c.count-(p+1));m?h(v,sr.BLACK):(h(v,sr.BLACK),h(v,sr.RED))}return u},o=new iI(t.length),a=s(o);return new Bn(r||e,a)};var LC,Cc={},Ac=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return D(Cc&&Oe,"ChildrenNode.ts has not been loaded"),LC=LC||new t({".priority":Cc},{".priority":Oe}),LC}get(e){let n=hi(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Bn?n:null}hasIndex(e){return bn(this.indexSet_,e.toString())}addIndex(e,n){D(e!==Fr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(ue.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=_m(r,e.getCompare()):a=Cc;let c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;let u=Object.assign({},this.indexes_);return u[c]=a,new t(u,l)}addToIndexes(e,n){let r=Uc(this.indexes_,(i,s)=>{let o=hi(this.indexSet_,s);if(D(o,"Missing index implementation for "+s),i===Cc)if(o.isDefinedOn(e.node)){let a=[],c=n.getIterator(ue.Wrap),l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),_m(a,o.getCompare())}else return Cc;else{let a=n.get(e.name),c=i;return a&&(c=c.remove(new ue(e.name,a))),c.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=Uc(this.indexes_,i=>{if(i===Cc)return i;{let s=n.get(e.name);return s?i.remove(new ue(e.name,s)):i}});return new t(r,this.indexSet_)}};var hd,ee=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&EO(this.priorityNode_),this.children_.isEmpty()&&D(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return hd||(hd=new t(new Bn(JI),null,Ac.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||hd}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?hd:r}}getChild(n){let r=ae(n);return r===null?this:this.getImmediateChild(r).getChild(Re(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(D(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new ue(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?hd:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=ae(n);if(i===null)return r;{D(ae(n)!==".priority"||ss(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Re(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Oe,(a,c)=>{r[a]=c.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+wO(this.getPriority().val())+":"),this.forEachChild(Oe,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":J2(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new ue(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new ue(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new ue(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,ue.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,ue.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===Od?-1:0}withIndex(n){if(n===Fr||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===Fr||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Oe),s=r.getIterator(Oe),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===Fr?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),sI=class extends ee{constructor(){super(new Bn(JI),ee.EMPTY_NODE,Ac.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ee.EMPTY_NODE}isEmpty(){return!1}},Od=new sI;Object.defineProperties(ue,{MIN:{value:new ue(is,ee.EMPTY_NODE)},MAX:{value:new ue(ui,Od)}});mm.__EMPTY_NODE=ee.EMPTY_NODE;Sc.__childrenNodeConstructor=ee;QH(Od);ZH(Od);var JH=!0;function $e(t,e=null){if(t===null)return ee.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),D(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new Sc(n,$e(e))}if(!(t instanceof Array)&&JH){let n=[],r=!1;if(It(t,(o,a)=>{if(o.substring(0,1)!=="."){let c=$e(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),n.push(new ue(o,c)))}}),n.length===0)return ee.EMPTY_NODE;let s=_m(n,KH,o=>o.name,JI);if(r){let o=_m(n,Oe.getCompare());return new ee(s,$e(e),new Ac({".priority":o},{".priority":Oe}))}else return new ee(s,$e(e),Ac.Default)}else{let n=ee.EMPTY_NODE;return It(t,(r,i)=>{if(bn(t,r)&&r.substring(0,1)!=="."){let s=$e(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority($e(e))}}YH($e);var wd=class extends Tc{constructor(e){super(),this.indexPath_=e,D(!ce(e)&&ae(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?Eo(e.name,n.name):s}makePost(e,n){let r=$e(e),i=ee.EMPTY_NODE.updateChild(this.indexPath_,r);return new ue(n,i)}maxPost(){let e=ee.EMPTY_NODE.updateChild(this.indexPath_,Od);return new ue(ui,e)}toString(){return xd(this.indexPath_,0).join("/")}};var oI=class extends Tc{compare(e,n){let r=e.node.compareTo(n.node);return r===0?Eo(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ue.MIN}maxPost(){return ue.MAX}makePost(e,n){let r=$e(e);return new ue(n,r)}toString(){return".value"}},eb=new oI;function bO(t){return{type:"value",snapshotNode:t}}function Mc(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Ed(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Cd(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function eq(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var Id=class{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){D(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(Ed(n,a)):D(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Mc(n,r)):o.trackChildChange(Cd(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Oe,(i,s)=>{n.hasChild(i)||r.trackChildChange(Ed(i,s))}),n.isLeafNode()||n.forEachChild(Oe,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Cd(i,s,o))}else r.trackChildChange(Mc(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?ee.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var ym=class t{constructor(e){this.indexedFilter_=new Id(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new ue(n,r))||(r=ee.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=ee.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(ee.EMPTY_NODE);let s=this;return n.forEachChild(Oe,(o,a)=>{s.matches(new ue(o,a))||(i=i.updateImmediateChild(o,ee.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var aI=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{let r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new ym(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new ue(n,r))||(r=ee.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=ee.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=ee.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(ee.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,ee.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();let a=e;D(a.numChildren()===this.limit_,"");let c=new ue(n,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(c);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=i.getChildAfterChild(this.index_,l,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);let f=h==null?1:o(h,c);if(u&&!r.isEmpty()&&f>=0)return s?.trackChildChange(Cd(n,r,d)),a.updateImmediateChild(n,r);{s?.trackChildChange(Ed(n,d));let m=a.updateImmediateChild(n,ee.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(Mc(h.name,h.node)),m.updateImmediateChild(h.name,h.node)):m}}else return r.isEmpty()?e:u&&o(l,c)>=0?(s!=null&&(s.trackChildChange(Ed(l.name,l.node)),s.trackChildChange(Mc(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(l.name,ee.EMPTY_NODE)):e}};var bd=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Oe}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return D(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return D(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:is}hasEnd(){return this.endSet_}getIndexEndValue(){return D(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return D(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ui}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return D(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Oe}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function tq(t){return t.loadsAllData()?new Id(t.getIndex()):t.hasLimit()?new aI(t):new ym(t)}function nq(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function rq(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function cI(t,e,n){let r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function iq(t,e,n){let r;return t.index_===Fr||n?r=cI(t,e,n):r=cI(t,e,ui),r.startAfterSet_=!0,r}function lI(t,e,n){let r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function sq(t,e,n){let r;return t.index_===Fr||n?r=lI(t,e,n):r=lI(t,e,is),r.endBeforeSet_=!0,r}function Vm(t,e){let n=t.copy();return n.index_=e,n}function O2(t){let e={};if(t.isDefault())return e;let n;if(t.index_===Oe?n="$priority":t.index_===eb?n="$value":t.index_===Fr?n="$key":(D(t.index_ instanceof wd,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Xe(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=Xe(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+Xe(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=Xe(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+Xe(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function F2(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Oe&&(e.i=t.index_.toString()),e}var uI=class t extends fm{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=kd("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(D(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let c=O2(e._queryParams);this.restRequest_(s+".json",c,(l,u)=>{let d=u;if(l===404&&(d=null,l=null),l===null&&this.onDataUpdate_(s,d,!1,r),hi(this.listens_,o)===a){let h;l?l===401?h="permission_denied":h="rest_error:"+l:h="ok",i(h,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=O2(e._queryParams),r=e._path.toString(),i=new pt;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+jb(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=Kd(a.responseText)}catch{$t("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&$t("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var dI=class{constructor(){this.rootNode_=ee.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function vm(){return{value:null,children:new Map}}function Fc(t,e,n){if(ce(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=ae(e);t.children.has(r)||t.children.set(r,vm());let i=t.children.get(r);e=Re(e),Fc(i,e,n)}}function hI(t,e){if(ce(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(Oe,(r,i)=>{Fc(t,new Ee(r),i)}),hI(t,e)}}else if(t.children.size>0){let n=ae(e);return e=Re(e),t.children.has(n)&&hI(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function fI(t,e,n){t.value!==null?n(e,t.value):oq(t,(r,i)=>{let s=new Ee(e.toString()+"/"+r);fI(i,s,n)})}function oq(t,e){t.children.forEach((n,r)=>{e(r,n)})}var pI=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&It(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var V2=10*1e3,aq=30*1e3,cq=5*60*1e3,gI=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new pI(e);let r=V2+(aq-V2)*Math.random();pd(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;It(e,(i,s)=>{s>0&&bn(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),pd(this.reportStats_.bind(this),Math.floor(Math.random()*2*cq))}};var Or=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(Or||{});function tb(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function nb(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function rb(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var mI=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Or.ACK_USER_WRITE,this.source=tb()}operationForChild(e){if(ce(this.path)){if(this.affectedTree.value!=null)return D(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new Ee(e));return new t(we(),n,this.revert)}}else return D(ae(this.path)===e,"operationForChild called for unrelated child."),new t(Re(this.path),this.affectedTree,this.revert)}};var xm=class t{constructor(e,n){this.source=e,this.path=n,this.type=Or.LISTEN_COMPLETE}operationForChild(e){return ce(this.path)?new t(this.source,we()):new t(this.source,Re(this.path))}};var Nc=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Or.OVERWRITE}operationForChild(e){return ce(this.path)?new t(this.source,we(),this.snap.getImmediateChild(e)):new t(this.source,Re(this.path),this.snap)}};var Dd=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Or.MERGE}operationForChild(e){if(ce(this.path)){let n=this.children.subtree(new Ee(e));return n.isEmpty()?null:n.value?new Nc(this.source,we(),n.value):new t(this.source,we(),n)}else return D(ae(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,Re(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Lr=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ce(e))return this.isFullyInitialized()&&!this.filtered_;let n=ae(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var _I=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function lq(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(eq(o.childName,o.snapshotNode))}),fd(t,i,"child_removed",e,r,n),fd(t,i,"child_added",e,r,n),fd(t,i,"child_moved",s,r,n),fd(t,i,"child_changed",e,r,n),fd(t,i,"value",e,r,n),i}function fd(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,c)=>dq(t,a,c)),o.forEach(a=>{let c=uq(t,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,t.query_))})})}function uq(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function dq(t,e,n){if(e.childName==null||n.childName==null)throw To("Should only compare child_ events.");let r=new ue(e.childName,e.snapshotNode),i=new ue(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function Lm(t,e){return{eventCache:t,serverCache:e}}function md(t,e,n,r){return Lm(new Lr(e,n,r),t.serverCache)}function DO(t,e,n,r){return Lm(t.eventCache,new Lr(e,n,r))}function wm(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function wo(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var jC,hq=()=>(jC||(jC=new Bn(uH)),jC),Jt=class t{constructor(e,n=hq()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return It(e,(r,i)=>{n=n.set(new Ee(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:we(),value:this.value};if(ce(e))return null;{let r=ae(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Re(e),n);return s!=null?{path:Be(new Ee(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ce(e))return this;{let n=ae(e),r=this.children.get(n);return r!==null?r.subtree(Re(e)):new t(null)}}set(e,n){if(ce(e))return new t(n,this.children);{let r=ae(e),s=(this.children.get(r)||new t(null)).set(Re(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(ce(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=ae(e),r=this.children.get(n);if(r){let i=r.remove(Re(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(ce(e))return this.value;{let n=ae(e),r=this.children.get(n);return r?r.get(Re(e)):null}}setTree(e,n){if(ce(e))return n;{let r=ae(e),s=(this.children.get(r)||new t(null)).setTree(Re(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(we(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Be(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,we(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(ce(e))return null;{let s=ae(e),o=this.children.get(s);return o?o.findOnPath_(Re(e),Be(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,we(),n)}foreachOnPath_(e,n,r){if(ce(e))return this;{this.value&&r(n,this.value);let i=ae(e),s=this.children.get(i);return s?s.foreachOnPath_(Re(e),Be(n,i),r):new t(null)}}foreach(e){this.foreach_(we(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(Be(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var or=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new Jt(null))}};function _d(t,e,n){if(ce(e))return new or(new Jt(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=Xt(i,e);return s=s.updateChild(o,n),new or(t.writeTree_.set(i,s))}else{let i=new Jt(n),s=t.writeTree_.setTree(e,i);return new or(s)}}}function yI(t,e,n){let r=t;return It(n,(i,s)=>{r=_d(r,Be(e,i),s)}),r}function L2(t,e){if(ce(e))return or.empty();{let n=t.writeTree_.setTree(e,new Jt(null));return new or(n)}}function vI(t,e){return Co(t,e)!=null}function Co(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Xt(n.path,e)):null}function j2(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Oe,(r,i)=>{e.push(new ue(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ue(r,i.value))}),e}function ns(t,e){if(ce(e))return t;{let n=Co(t,e);return n!=null?new or(new Jt(n)):new or(t.writeTree_.subtree(e))}}function xI(t){return t.writeTree_.isEmpty()}function Rc(t,e){return TO(we(),t.writeTree_,e)}function TO(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(D(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=TO(Be(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Be(t,".priority"),r)),n}}function jm(t,e){return NO(e,t)}function fq(t,e,n,r,i){D(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=_d(t.visibleWrites,e,n)),t.lastWriteId=r}function pq(t,e,n,r){D(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=yI(t.visibleWrites,e,n),t.lastWriteId=r}function gq(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function mq(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);D(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&_q(a,r.path)?i=!1:jn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return yq(t),!0;if(r.snap)t.visibleWrites=L2(t.visibleWrites,r.path);else{let a=r.children;It(a,c=>{t.visibleWrites=L2(t.visibleWrites,Be(r.path,c))})}return!0}else return!1}function _q(t,e){if(t.snap)return jn(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&jn(Be(t.path,n),e))return!0;return!1}function yq(t){t.visibleWrites=SO(t.allWrites,vq,we()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function vq(t){return t.visible}function SO(t,e,n){let r=or.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)jn(n,o)?(a=Xt(n,o),r=_d(r,a,s.snap)):jn(o,n)&&(a=Xt(o,n),r=_d(r,we(),s.snap.getChild(a)));else if(s.children){if(jn(n,o))a=Xt(n,o),r=yI(r,a,s.children);else if(jn(o,n))if(a=Xt(o,n),ce(a))r=yI(r,we(),s.children);else{let c=hi(s.children,ae(a));if(c){let l=c.getChild(Re(a));r=_d(r,we(),l)}}}else throw To("WriteRecord should have .snap or .children")}}return r}function AO(t,e,n,r,i){if(!r&&!i){let s=Co(t.visibleWrites,e);if(s!=null)return s;{let o=ns(t.visibleWrites,e);if(xI(o))return n;if(n==null&&!vI(o,we()))return null;{let a=n||ee.EMPTY_NODE;return Rc(o,a)}}}else{let s=ns(t.visibleWrites,e);if(!i&&xI(s))return n;if(!i&&n==null&&!vI(s,we()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(jn(l.path,e)||jn(e,l.path))},a=SO(t.allWrites,o,e),c=n||ee.EMPTY_NODE;return Rc(a,c)}}}function xq(t,e,n){let r=ee.EMPTY_NODE,i=Co(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Oe,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=ns(t.visibleWrites,e);return n.forEachChild(Oe,(o,a)=>{let c=Rc(ns(s,new Ee(o)),a);r=r.updateImmediateChild(o,c)}),j2(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=ns(t.visibleWrites,e);return j2(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function wq(t,e,n,r,i){D(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=Be(e,n);if(vI(t.visibleWrites,s))return null;{let o=ns(t.visibleWrites,s);return xI(o)?i.getChild(n):Rc(o,i.getChild(n))}}function Eq(t,e,n,r){let i=Be(e,n),s=Co(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=ns(t.visibleWrites,i);return Rc(o,r.getNode().getImmediateChild(n))}else return null}function Cq(t,e){return Co(t.visibleWrites,e)}function Iq(t,e,n,r,i,s,o){let a,c=ns(t.visibleWrites,e),l=Co(c,we());if(l!=null)a=l;else if(n!=null)a=Rc(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let u=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),f=h.getNext();for(;f&&u.length<i;)d(f,r)!==0&&u.push(f),f=h.getNext();return u}else return[]}function bq(){return{visibleWrites:or.empty(),allWrites:[],lastWriteId:-1}}function Em(t,e,n,r){return AO(t.writeTree,t.treePath,e,n,r)}function ib(t,e){return xq(t.writeTree,t.treePath,e)}function B2(t,e,n,r){return wq(t.writeTree,t.treePath,e,n,r)}function Cm(t,e){return Cq(t.writeTree,Be(t.treePath,e))}function Dq(t,e,n,r,i,s){return Iq(t.writeTree,t.treePath,e,n,r,i,s)}function sb(t,e,n){return Eq(t.writeTree,t.treePath,e,n)}function MO(t,e){return NO(Be(t.treePath,e),t.writeTree)}function NO(t,e){return{treePath:t,writeTree:e}}var wI=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;D(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),D(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,Cd(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,Ed(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,Mc(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,Cd(r,e.snapshotNode,i.oldSnap));else throw To("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var EI=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},RO=new EI,Td=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new Lr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return sb(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:wo(this.viewCache_),s=Dq(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function Tq(t){return{filter:t}}function Sq(t,e){D(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),D(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function Aq(t,e,n,r,i){let s=new wI,o,a;if(n.type===Or.OVERWRITE){let l=n;l.source.fromUser?o=CI(t,e,l.path,l.snap,r,i,s):(D(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!ce(l.path),o=Im(t,e,l.path,l.snap,r,i,a,s))}else if(n.type===Or.MERGE){let l=n;l.source.fromUser?o=Nq(t,e,l.path,l.children,r,i,s):(D(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=II(t,e,l.path,l.children,r,i,a,s))}else if(n.type===Or.ACK_USER_WRITE){let l=n;l.revert?o=kq(t,e,l.path,r,i,s):o=Rq(t,e,l.path,l.affectedTree,r,i,s)}else if(n.type===Or.LISTEN_COMPLETE)o=Pq(t,e,n.path,r,s);else throw To("Unknown operation type: "+n.type);let c=s.getChanges();return Mq(e,o,c),{viewCache:o,changes:c}}function Mq(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=wm(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(bO(wm(e)))}}function PO(t,e,n,r,i,s){let o=e.eventCache;if(Cm(r,n)!=null)return e;{let a,c;if(ce(n))if(D(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=wo(e),u=l instanceof ee?l:ee.EMPTY_NODE,d=ib(r,u);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let l=Em(r,wo(e));a=t.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=ae(n);if(l===".priority"){D(ss(n)===1,"Can't have a priority with additional path components");let u=o.getNode();c=e.serverCache.getNode();let d=B2(r,n,u,c);d!=null?a=t.filter.updatePriority(u,d):a=o.getNode()}else{let u=Re(n),d;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();let h=B2(r,n,o.getNode(),c);h!=null?d=o.getNode().getImmediateChild(l).updateChild(u,h):d=o.getNode().getImmediateChild(l)}else d=sb(r,l,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),l,d,u,i,s):a=o.getNode()}}return md(e,a,o.isFullyInitialized()||ce(n),t.filter.filtersNodes())}}function Im(t,e,n,r,i,s,o,a){let c=e.serverCache,l,u=o?t.filter:t.filter.getIndexedFilter();if(ce(n))l=u.updateFullNode(c.getNode(),r,null);else if(u.filtersNodes()&&!c.isFiltered()){let f=c.getNode().updateChild(n,r);l=u.updateFullNode(c.getNode(),f,null)}else{let f=ae(n);if(!c.isCompleteForPath(n)&&ss(n)>1)return e;let p=Re(n),v=c.getNode().getImmediateChild(f).updateChild(p,r);f===".priority"?l=u.updatePriority(c.getNode(),v):l=u.updateChild(c.getNode(),f,v,p,RO,null)}let d=DO(e,l,c.isFullyInitialized()||ce(n),u.filtersNodes()),h=new Td(i,d,s);return PO(t,d,n,i,h,a)}function CI(t,e,n,r,i,s,o){let a=e.eventCache,c,l,u=new Td(i,e,s);if(ce(n))l=t.filter.updateFullNode(e.eventCache.getNode(),r,o),c=md(e,l,!0,t.filter.filtersNodes());else{let d=ae(n);if(d===".priority")l=t.filter.updatePriority(e.eventCache.getNode(),r),c=md(e,l,a.isFullyInitialized(),a.isFiltered());else{let h=Re(n),f=a.getNode().getImmediateChild(d),p;if(ce(h))p=r;else{let m=u.getCompleteChild(d);m!=null?YI(h)===".priority"&&m.getChild(vO(h)).isEmpty()?p=m:p=m.updateChild(h,r):p=ee.EMPTY_NODE}if(f.equals(p))c=e;else{let m=t.filter.updateChild(a.getNode(),d,p,h,u,o);c=md(e,m,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function U2(t,e){return t.eventCache.isCompleteForChild(e)}function Nq(t,e,n,r,i,s,o){let a=e;return r.foreach((c,l)=>{let u=Be(n,c);U2(e,ae(u))&&(a=CI(t,a,u,l,i,s,o))}),r.foreach((c,l)=>{let u=Be(n,c);U2(e,ae(u))||(a=CI(t,a,u,l,i,s,o))}),a}function $2(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function II(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;ce(n)?l=r:l=new Jt(null).setTree(n,r);let u=e.serverCache.getNode();return l.children.inorderTraversal((d,h)=>{if(u.hasChild(d)){let f=e.serverCache.getNode().getImmediateChild(d),p=$2(t,f,h);c=Im(t,c,new Ee(d),p,i,s,o,a)}}),l.children.inorderTraversal((d,h)=>{let f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!u.hasChild(d)&&!f){let p=e.serverCache.getNode().getImmediateChild(d),m=$2(t,p,h);c=Im(t,c,new Ee(d),m,i,s,o,a)}}),c}function Rq(t,e,n,r,i,s,o){if(Cm(i,n)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(ce(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return Im(t,e,n,c.getNode().getChild(n),i,s,a,o);if(ce(n)){let l=new Jt(null);return c.getNode().forEachChild(Fr,(u,d)=>{l=l.set(new Ee(u),d)}),II(t,e,n,l,i,s,a,o)}else return e}else{let l=new Jt(null);return r.foreach((u,d)=>{let h=Be(n,u);c.isCompleteForPath(h)&&(l=l.set(u,c.getNode().getChild(h)))}),II(t,e,n,l,i,s,a,o)}}function Pq(t,e,n,r,i){let s=e.serverCache,o=DO(e,s.getNode(),s.isFullyInitialized()||ce(n),s.isFiltered());return PO(t,o,n,r,RO,i)}function kq(t,e,n,r,i,s){let o;if(Cm(r,n)!=null)return e;{let a=new Td(r,e,i),c=e.eventCache.getNode(),l;if(ce(n)||ae(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=Em(r,wo(e));else{let d=e.serverCache.getNode();D(d instanceof ee,"serverChildren would be complete if leaf node"),u=ib(r,d)}u=u,l=t.filter.updateFullNode(c,u,s)}else{let u=ae(n),d=sb(r,u,e.serverCache);d==null&&e.serverCache.isCompleteForChild(u)&&(d=c.getImmediateChild(u)),d!=null?l=t.filter.updateChild(c,u,d,Re(n),a,s):e.eventCache.getNode().hasChild(u)?l=t.filter.updateChild(c,u,ee.EMPTY_NODE,Re(n),a,s):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Em(r,wo(e)),o.isLeafNode()&&(l=t.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||Cm(r,we())!=null,md(e,l,o,t.filter.filtersNodes())}}var bI=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new Id(r.getIndex()),s=tq(r);this.processor_=Tq(s);let o=n.serverCache,a=n.eventCache,c=i.updateFullNode(ee.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(ee.EMPTY_NODE,a.getNode(),null),u=new Lr(c,o.isFullyInitialized(),i.filtersNodes()),d=new Lr(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Lm(d,u),this.eventGenerator_=new _I(this.query_)}get query(){return this.query_}};function Oq(t){return t.viewCache_.serverCache.getNode()}function Fq(t){return wm(t.viewCache_)}function Vq(t,e){let n=wo(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ce(e)&&!n.getImmediateChild(ae(e)).isEmpty())?n.getChild(e):null}function H2(t){return t.eventRegistrations_.length===0}function Lq(t,e){t.eventRegistrations_.push(e)}function q2(t,e,n){let r=[];if(n){D(e==null,"A cancel should cancel all event registrations.");let i=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function G2(t,e,n,r){e.type===Or.MERGE&&e.source.queryId!==null&&(D(wo(t.viewCache_),"We should always have a full cache before handling merges"),D(wm(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=Aq(t.processor_,i,e,n,r);return Sq(t.processor_,s.viewCache),D(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,kO(t,s.changes,s.viewCache.eventCache.getNode(),null)}function jq(t,e){let n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Oe,(s,o)=>{r.push(Mc(s,o))}),n.isFullyInitialized()&&r.push(bO(n.getNode())),kO(t,r,n.getNode(),e)}function kO(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return lq(t.eventGenerator_,e,n,i)}var bm,Dm=class{constructor(){this.views=new Map}};function Bq(t){D(!bm,"__referenceConstructor has already been defined"),bm=t}function Uq(){return D(bm,"Reference.ts has not been loaded"),bm}function $q(t){return t.views.size===0}function ob(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return D(s!=null,"SyncTree gave us an op for an invalid query."),G2(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat(G2(o,e,n,r));return s}}function OO(t,e,n,r,i){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=Em(n,i?r:null),c=!1;a?c=!0:r instanceof ee?(a=ib(n,r),c=!1):(a=ee.EMPTY_NODE,c=!1);let l=Lm(new Lr(a,c,!1),new Lr(r,i,!1));return new bI(e,l)}return o}function Hq(t,e,n,r,i,s){let o=OO(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),Lq(o,n),jq(o,n)}function qq(t,e,n,r){let i=e._queryIdentifier,s=[],o=[],a=os(t);if(i==="default")for(let[c,l]of t.views.entries())o=o.concat(q2(l,n,r)),H2(l)&&(t.views.delete(c),l.query._queryParams.loadsAllData()||s.push(l.query));else{let c=t.views.get(i);c&&(o=o.concat(q2(c,n,r)),H2(c)&&(t.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!os(t)&&s.push(new(Uq())(e._repo,e._path)),{removed:s,events:o}}function FO(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function rs(t,e){let n=null;for(let r of t.views.values())n=n||Vq(r,e);return n}function VO(t,e){if(e._queryParams.loadsAllData())return Bm(t);{let r=e._queryIdentifier;return t.views.get(r)}}function LO(t,e){return VO(t,e)!=null}function os(t){return Bm(t)!=null}function Bm(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Tm;function Gq(t){D(!Tm,"__referenceConstructor has already been defined"),Tm=t}function zq(){return D(Tm,"Reference.ts has not been loaded"),Tm}var Wq=1,Sm=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Jt(null),this.pendingWriteTree_=bq(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function ab(t,e,n,r,i){return fq(t.pendingWriteTree_,e,n,r,i),i?Vc(t,new Nc(tb(),e,n)):[]}function Kq(t,e,n,r){pq(t.pendingWriteTree_,e,n,r);let i=Jt.fromObject(n);return Vc(t,new Dd(tb(),e,i))}function ts(t,e,n=!1){let r=gq(t.pendingWriteTree_,e);if(mq(t.pendingWriteTree_,e)){let s=new Jt(null);return r.snap!=null?s=s.set(we(),!0):It(r.children,o=>{s=s.set(new Ee(o),!0)}),Vc(t,new mI(r.path,s,n))}else return[]}function Fd(t,e,n){return Vc(t,new Nc(nb(),e,n))}function Qq(t,e,n){let r=Jt.fromObject(n);return Vc(t,new Dd(nb(),e,r))}function Yq(t,e){return Vc(t,new xm(nb(),e))}function Zq(t,e,n){let r=cb(t,n);if(r){let i=lb(r),s=i.path,o=i.queryId,a=Xt(s,e),c=new xm(rb(o),a);return ub(t,s,c)}else return[]}function Am(t,e,n,r,i=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||LO(o,e))){let c=qq(o,e,n,r);$q(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let l=c.removed;if(a=c.events,!i){let u=l.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,f)=>os(f));if(u&&!d){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let f=eG(h);for(let p=0;p<f.length;++p){let m=f[p],v=m.query,b=$O(t,m);t.listenProvider_.startListening(yd(v),Sd(t,v),b.hashFn,b.onComplete)}}}!d&&l.length>0&&!r&&(u?t.listenProvider_.stopListening(yd(e),null):l.forEach(h=>{let f=t.queryToTagMap.get($m(h));t.listenProvider_.stopListening(yd(h),f)}))}tG(t,l)}return a}function jO(t,e,n,r){let i=cb(t,r);if(i!=null){let s=lb(i),o=s.path,a=s.queryId,c=Xt(o,e),l=new Nc(rb(a),c,n);return ub(t,o,l)}else return[]}function Xq(t,e,n,r){let i=cb(t,r);if(i){let s=lb(i),o=s.path,a=s.queryId,c=Xt(o,e),l=Jt.fromObject(n),u=new Dd(rb(a),c,l);return ub(t,o,u)}else return[]}function DI(t,e,n,r=!1){let i=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(h,f)=>{let p=Xt(h,i);s=s||rs(f,p),o=o||os(f)});let a=t.syncPointTree_.get(i);a?(o=o||os(a),s=s||rs(a,we())):(a=new Dm,t.syncPointTree_=t.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=ee.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((f,p)=>{let m=rs(p,we());m&&(s=s.updateImmediateChild(f,m))}));let l=LO(a,e);if(!l&&!e._queryParams.loadsAllData()){let h=$m(e);D(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let f=nG();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}let u=jm(t.pendingWriteTree_,i),d=Hq(a,e,n,u,s,c);if(!l&&!o&&!r){let h=VO(a,e);d=d.concat(rG(t,e,h))}return d}function Um(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let c=Xt(o,e),l=rs(a,c);if(l)return l});return AO(i,e,s,n,!0)}function Jq(t,e){let n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(l,u)=>{let d=Xt(l,n);r=r||rs(u,d)});let i=t.syncPointTree_.get(n);i?r=r||rs(i,we()):(i=new Dm,t.syncPointTree_=t.syncPointTree_.set(n,i));let s=r!=null,o=s?new Lr(r,!0,!1):null,a=jm(t.pendingWriteTree_,e._path),c=OO(i,e,a,s?o.getNode():ee.EMPTY_NODE,s);return Fq(c)}function Vc(t,e){return BO(e,t.syncPointTree_,null,jm(t.pendingWriteTree_,we()))}function BO(t,e,n,r){if(ce(t.path))return UO(t,e,n,r);{let i=e.get(we());n==null&&i!=null&&(n=rs(i,we()));let s=[],o=ae(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){let l=n?n.getImmediateChild(o):null,u=MO(r,o);s=s.concat(BO(a,c,l,u))}return i&&(s=s.concat(ob(i,t,r,n))),s}}function UO(t,e,n,r){let i=e.get(we());n==null&&i!=null&&(n=rs(i,we()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=n?n.getImmediateChild(o):null,l=MO(r,o),u=t.operationForChild(o);u&&(s=s.concat(UO(u,a,c,l)))}),i&&(s=s.concat(ob(i,t,r,n))),s}function $O(t,e){let n=e.query,r=Sd(t,n);return{hashFn:()=>(Oq(e)||ee.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?Zq(t,n._path,r):Yq(t,n._path);{let s=fH(i,n);return Am(t,n,null,s)}}}}function Sd(t,e){let n=$m(e);return t.queryToTagMap.get(n)}function $m(t){return t._path.toString()+"$"+t._queryIdentifier}function cb(t,e){return t.tagToQueryMap.get(e)}function lb(t){let e=t.indexOf("$");return D(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Ee(t.substr(0,e))}}function ub(t,e,n){let r=t.syncPointTree_.get(e);D(r,"Missing sync point for query tag that we're tracking");let i=jm(t.pendingWriteTree_,e);return ob(r,n,i,null)}function eG(t){return t.fold((e,n,r)=>{if(n&&os(n))return[Bm(n)];{let i=[];return n&&(i=FO(n)),It(r,(s,o)=>{i=i.concat(o)}),i}})}function yd(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(zq())(t._repo,t._path):t}function tG(t,e){for(let n=0;n<e.length;++n){let r=e[n];if(!r._queryParams.loadsAllData()){let i=$m(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function nG(){return Wq++}function rG(t,e,n){let r=e._path,i=Sd(t,e),s=$O(t,n),o=t.listenProvider_.startListening(yd(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)D(!os(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((l,u,d)=>{if(!ce(l)&&u&&os(u))return[Bm(u).query];{let h=[];return u&&(h=h.concat(FO(u).map(f=>f.query))),It(d,(f,p)=>{h=h.concat(p)}),h}});for(let l=0;l<c.length;++l){let u=c[l];t.listenProvider_.stopListening(yd(u),Sd(t,u))}}return o}var TI=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},SI=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=Be(this.path_,e);return new t(this.syncTree_,n)}node(){return Um(this.syncTree_,this.path_)}},iG=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},z2=function(t,e,n){if(!t||typeof t!="object")return t;if(D(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return sG(t[".sv"],e,n);if(typeof t[".sv"]=="object")return oG(t[".sv"],e);D(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},sG=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:D(!1,"Unexpected server value: "+t)}},oG=function(t,e,n){t.hasOwnProperty("increment")||D(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&D(!1,"Unexpected increment value: "+r);let i=e.node();if(D(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},HO=function(t,e,n,r){return hb(e,new SI(n,t),r)},db=function(t,e,n){return hb(t,new TI(e),n)};function hb(t,e,n){let r=t.getPriority().val(),i=z2(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=z2(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new Sc(a,$e(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Sc(i))),o.forEachChild(Oe,(a,c)=>{let l=hb(c,e.getImmediateChild(a),n);l!==c&&(s=s.updateImmediateChild(a,l))}),s}}var Ad=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function Hm(t,e){let n=e instanceof Ee?e:new Ee(e),r=t,i=ae(n);for(;i!==null;){let s=hi(r.node.children,i)||{children:{},childCount:0};r=new Ad(i,r,s),n=Re(n),i=ae(n)}return r}function Io(t){return t.node.value}function fb(t,e){t.node.value=e,AI(t)}function qO(t){return t.node.childCount>0}function aG(t){return Io(t)===void 0&&!qO(t)}function qm(t,e){It(t.node.children,(n,r)=>{e(new Ad(n,t,r))})}function GO(t,e,n,r){n&&!r&&e(t),qm(t,i=>{GO(i,e,!0,r)}),n&&r&&e(t)}function cG(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Vd(t){return new Ee(t.parent===null?t.name:Vd(t.parent)+"/"+t.name)}function AI(t){t.parent!==null&&lG(t.parent,t.name,t)}function lG(t,e,n){let r=aG(n),i=bn(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,AI(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,AI(t))}var uG=/[\[\].#$\/\u0000-\u001F\u007F]/,dG=/[\[\].#$\u0000-\u001F\u007F]/,BC=10*1024*1024,Gm=function(t){return typeof t=="string"&&t.length!==0&&!uG.test(t)},zO=function(t){return typeof t=="string"&&t.length!==0&&!dG.test(t)},hG=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),zO(t)},Md=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Fm(t)||t&&typeof t=="object"&&bn(t,".sv")},jr=function(t,e,n,r){r&&e===void 0||Ld(nn(t,"value"),e,n)},Ld=function(t,e,n){let r=n instanceof Ee?new JC(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+yo(r));if(typeof e=="function")throw new Error(t+"contains a function "+yo(r)+" with contents = "+e.toString());if(Fm(e))throw new Error(t+"contains "+e.toString()+" "+yo(r));if(typeof e=="string"&&e.length>BC/3&&$c(e)>BC)throw new Error(t+"contains a string greater than "+BC+" utf8 bytes "+yo(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(It(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Gm(o)))throw new Error(t+" contains an invalid key ("+o+") "+yo(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);$H(r,o),Ld(t,a,r),HH(r)}),i&&s)throw new Error(t+' contains ".value" child '+yo(r)+" in addition to actual children.")}},fG=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];let s=xd(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!Gm(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(UH);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&jn(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},WO=function(t,e,n,r){if(r&&e===void 0)return;let i=nn(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];It(e,(o,a)=>{let c=new Ee(o);if(Ld(i,a,Be(n,c)),YI(c)===".priority"&&!Md(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),fG(i,s)},pb=function(t,e,n){if(!(n&&e===void 0)){if(Fm(e))throw new Error(nn(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Md(e))throw new Error(nn(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},jd=function(t,e,n,r){if(!(r&&n===void 0)&&!Gm(n))throw new Error(nn(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Lc=function(t,e,n,r){if(!(r&&n===void 0)&&!zO(n))throw new Error(nn(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},pG=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Lc(t,e,n,r)},wn=function(t,e){if(ae(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},KO=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Gm(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!hG(n))throw new Error(nn(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var MI=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function zm(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!ZI(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function QO(t,e,n){zm(t,n),YO(t,r=>ZI(r,e))}function En(t,e,n){zm(t,n),YO(t,r=>jn(r,e)||jn(e,r))}function YO(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?(gG(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function gG(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();xo&&Ct("event: "+n.toString()),Oc(r)}}}var ZO="repo_interrupt",mG=25,NI=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new MI,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=vm(),this.transactionQueueTree_=new Ad,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function _G(t,e,n){if(t.stats_=QI(t.repoInfo_),t.forceRestClient_||_H())t.server_=new uI(t.repoInfo_,(r,i,s,o)=>{W2(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>K2(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Xe(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new XI(t.repoInfo_,e,(r,i,s,o)=>{W2(t,r,i,s,o)},r=>{K2(t,r)},r=>{yG(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=vH(t.repoInfo_,()=>new gI(t.stats_,t.server_)),t.infoData_=new dI,t.infoSyncTree_=new Sm({startListening:(r,i,s,o)=>{let a=[],c=t.infoData_.getNode(r._path);return c.isEmpty()||(a=Fd(t.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),gb(t,"connected",!1),t.serverSyncTree_=new Sm({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,c)=>{let l=o(a,c);En(t.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function XO(t){let n=t.infoData_.getNode(new Ee(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Bd(t){return iG({timestamp:XO(t)})}function W2(t,e,n,r,i){t.dataUpdateCount++;let s=new Ee(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let c=Uc(n,l=>$e(l));o=Xq(t.serverSyncTree_,s,c,i)}else{let c=$e(n);o=jO(t.serverSyncTree_,s,c,i)}else if(r){let c=Uc(n,l=>$e(l));o=Qq(t.serverSyncTree_,s,c)}else{let c=$e(n);o=Fd(t.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=Pc(t,s)),En(t.eventQueue_,a,o)}function K2(t,e){gb(t,"connected",e),e===!1&&wG(t)}function yG(t,e){It(e,(n,r)=>{gb(t,n,r)})}function gb(t,e,n){let r=new Ee("/.info/"+e),i=$e(n);t.infoData_.updateSnapshot(r,i);let s=Fd(t.infoSyncTree_,r,i);En(t.eventQueue_,r,s)}function Wm(t){return t.nextWriteId_++}function vG(t,e,n){let r=Jq(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{let s=$e(i).withIndex(e._queryParams.getIndex());DI(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Fd(t.serverSyncTree_,e._path,s);else{let a=Sd(t.serverSyncTree_,e);o=jO(t.serverSyncTree_,e._path,s,a)}return En(t.eventQueue_,e._path,o),Am(t.serverSyncTree_,e,n,null,!0),s},i=>(jc(t,"get for query "+Xe(e)+" failed: "+i),Promise.reject(new Error(i))))}function mb(t,e,n,r,i){jc(t,"set",{path:e.toString(),value:n,priority:r});let s=Bd(t),o=$e(n,r),a=Um(t.serverSyncTree_,e),c=db(o,a,s),l=Wm(t),u=ab(t.serverSyncTree_,e,c,l,!0);zm(t.eventQueue_,u),t.server_.put(e.toString(),o.val(!0),(h,f)=>{let p=h==="ok";p||$t("set at "+e+" failed: "+h);let m=ts(t.serverSyncTree_,l,!p);En(t.eventQueue_,e,m),as(t,i,h,f)});let d=yb(t,e);Pc(t,d),En(t.eventQueue_,d,[])}function xG(t,e,n,r){jc(t,"update",{path:e.toString(),value:n});let i=!0,s=Bd(t),o={};if(It(n,(a,c)=>{i=!1,o[a]=HO(Be(e,a),$e(c),t.serverSyncTree_,s)}),i)Ct("update() called with empty data.  Don't do anything."),as(t,r,"ok",void 0);else{let a=Wm(t),c=Kq(t.serverSyncTree_,e,o,a);zm(t.eventQueue_,c),t.server_.merge(e.toString(),n,(l,u)=>{let d=l==="ok";d||$t("update at "+e+" failed: "+l);let h=ts(t.serverSyncTree_,a,!d),f=h.length>0?Pc(t,e):e;En(t.eventQueue_,f,h),as(t,r,l,u)}),It(n,l=>{let u=yb(t,Be(e,l));Pc(t,u)}),En(t.eventQueue_,e,[])}}function wG(t){jc(t,"onDisconnectEvents");let e=Bd(t),n=vm();fI(t.onDisconnect_,we(),(i,s)=>{let o=HO(i,s,t.serverSyncTree_,e);Fc(n,i,o)});let r=[];fI(n,we(),(i,s)=>{r=r.concat(Fd(t.serverSyncTree_,i,s));let o=yb(t,i);Pc(t,o)}),t.onDisconnect_=vm(),En(t.eventQueue_,we(),r)}function EG(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&hI(t.onDisconnect_,e),as(t,n,r,i)})}function Q2(t,e,n,r){let i=$e(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Fc(t.onDisconnect_,e,i),as(t,r,s,o)})}function CG(t,e,n,r,i){let s=$e(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&Fc(t.onDisconnect_,e,s),as(t,i,o,a)})}function IG(t,e,n,r){if(Qd(n)){Ct("onDisconnect().update() called with empty data.  Don't do anything."),as(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&It(n,(o,a)=>{let c=$e(a);Fc(t.onDisconnect_,Be(e,o),c)}),as(t,r,i,s)})}function bG(t,e,n){let r;ae(e._path)===".info"?r=DI(t.infoSyncTree_,e,n):r=DI(t.serverSyncTree_,e,n),QO(t.eventQueue_,e._path,r)}function RI(t,e,n){let r;ae(e._path)===".info"?r=Am(t.infoSyncTree_,e,n):r=Am(t.serverSyncTree_,e,n),QO(t.eventQueue_,e._path,r)}function JO(t){t.persistentConnection_&&t.persistentConnection_.interrupt(ZO)}function DG(t){t.persistentConnection_&&t.persistentConnection_.resume(ZO)}function jc(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Ct(n,...e)}function as(t,e,n,r){e&&Oc(()=>{if(n==="ok")e(null);else{let i=(n||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function TG(t,e,n,r,i,s){jc(t,"transaction on "+e);let o={path:e,update:n,onComplete:r,status:null,order:X2(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=_b(t,e,void 0);o.currentInputSnapshot=a;let c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Ld("transaction failed: Data returned ",c,o.path),o.status=0;let l=Hm(t.transactionQueueTree_,e),u=Io(l)||[];u.push(o),fb(l,u);let d;typeof c=="object"&&c!==null&&bn(c,".priority")?(d=hi(c,".priority"),D(Md(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(Um(t.serverSyncTree_,e)||ee.EMPTY_NODE).getPriority().val();let h=Bd(t),f=$e(c,d),p=db(f,a,h);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=Wm(t);let m=ab(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);En(t.eventQueue_,e,m),Km(t,t.transactionQueueTree_)}}function _b(t,e,n){return Um(t.serverSyncTree_,e,n)||ee.EMPTY_NODE}function Km(t,e=t.transactionQueueTree_){if(e||Qm(t,e),Io(e)){let n=tF(t,e);D(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&SG(t,Vd(e),n)}else qO(e)&&qm(e,n=>{Km(t,n)})}function SG(t,e,n){let r=n.map(l=>l.currentWriteId),i=_b(t,e,r),s=i,o=i.hash();for(let l=0;l<n.length;l++){let u=n[l];D(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;let d=Xt(e,u.path);s=s.updateChild(d,u.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;t.server_.put(c.toString(),a,l=>{jc(t,"transaction put response",{path:c.toString(),status:l});let u=[];if(l==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,u=u.concat(ts(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();Qm(t,Hm(t.transactionQueueTree_,e)),Km(t,t.transactionQueueTree_),En(t.eventQueue_,e,u);for(let h=0;h<d.length;h++)Oc(d[h])}else{if(l==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{$t("transaction at "+c.toString()+" failed: "+l);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=l}Pc(t,e)}},o)}function Pc(t,e){let n=eF(t,e),r=Vd(n),i=tF(t,n);return AG(t,i,r),r}function AG(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],l=Xt(n,c.path),u=!1,d;if(D(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)u=!0,d=c.abortReason,i=i.concat(ts(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=mG)u=!0,d="maxretry",i=i.concat(ts(t.serverSyncTree_,c.currentWriteId,!0));else{let h=_b(t,c.path,o);c.currentInputSnapshot=h;let f=e[a].update(h.val());if(f!==void 0){Ld("transaction failed: Data returned ",f,c.path);let p=$e(f);typeof f=="object"&&f!=null&&bn(f,".priority")||(p=p.updatePriority(h.getPriority()));let v=c.currentWriteId,b=Bd(t),F=db(p,h,b);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=F,c.currentWriteId=Wm(t),o.splice(o.indexOf(v),1),i=i.concat(ab(t.serverSyncTree_,c.path,F,c.currentWriteId,c.applyLocally)),i=i.concat(ts(t.serverSyncTree_,v,!0))}else u=!0,d="nodata",i=i.concat(ts(t.serverSyncTree_,c.currentWriteId,!0))}En(t.eventQueue_,n,i),i=[],u&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}Qm(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Oc(r[a]);Km(t,t.transactionQueueTree_)}function eF(t,e){let n,r=t.transactionQueueTree_;for(n=ae(e);n!==null&&Io(r)===void 0;)r=Hm(r,n),e=Re(e),n=ae(e);return r}function tF(t,e){let n=[];return nF(t,e,n),n.sort((r,i)=>r.order-i.order),n}function nF(t,e,n){let r=Io(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);qm(e,i=>{nF(t,i,n)})}function Qm(t,e){let n=Io(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,fb(e,n.length>0?n:void 0)}qm(e,r=>{Qm(t,r)})}function yb(t,e){let n=Vd(eF(t,e)),r=Hm(t.transactionQueueTree_,e);return cG(r,i=>{UC(t,i)}),UC(t,r),GO(r,i=>{UC(t,i)}),n}function UC(t,e){let n=Io(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(D(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(D(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(ts(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?fb(e,void 0):n.length=s+1,En(t.eventQueue_,Vd(e),i);for(let o=0;o<r.length;o++)Oc(r[o])}}function MG(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function NG(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):$t(`Invalid query segment '${n}' in query '${t}'`)}return e}var PI=function(t,e){let n=RG(t),r=n.namespace;n.domain==="firebase.com"&&Vr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Vr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||cH();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new dm(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new Ee(n.pathString)}},RG=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",c=443;if(typeof t=="string"){let l=t.indexOf("//");l>=0&&(a=t.substring(0,l-1),t=t.substring(l+2));let u=t.indexOf("/");u===-1&&(u=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(u,d)),u<d&&(i=MG(t.substring(u,d)));let h=NG(t.substring(Math.min(t.length,d)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;let f=e.slice(0,l);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=r}"ns"in h&&(s=h.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var Y2="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",PG=function(){let t=0,e=[];return function(n){let r=n===t;t=n;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=Y2.charAt(n%64),n=Math.floor(n/64);D(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=Y2.charAt(e[i]);return D(o.length===20,"nextPushId: Length should be 20."),o}}();var Mm=class{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Xe(this.snapshot.exportVal())}},Nm=class{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Nd=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return D(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var Rm=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new pt;return EG(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){wn("OnDisconnect.remove",this._path);let e=new pt;return Q2(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){wn("OnDisconnect.set",this._path),jr("OnDisconnect.set",e,this._path,!1);let n=new pt;return Q2(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){wn("OnDisconnect.setWithPriority",this._path),jr("OnDisconnect.setWithPriority",e,this._path,!1),pb("OnDisconnect.setWithPriority",n,!1);let r=new pt;return CG(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){wn("OnDisconnect.update",this._path),WO("OnDisconnect.update",e,this._path,!1);let n=new pt;return IG(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var en=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return ce(this._path)?null:YI(this._path)}get ref(){return new Cn(this._repo,this._path)}get _queryIdentifier(){let e=F2(this._queryParams),n=KI(e);return n==="{}"?"default":n}get _queryObject(){return F2(this._queryParams)}isEqual(e){if(e=de(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=ZI(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+BH(this._path)}};function Ym(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function ls(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Fr){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==is)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==ui)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Oe){if(e!=null&&!Md(e)||n!=null&&!Md(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(D(t.getIndex()instanceof wd||t.getIndex()===eb,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Zm(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Cn=class t extends en{constructor(e,n){super(e,n,new bd,!1)}get parent(){let e=vO(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},kc=class t{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new Ee(e),r=cs(this.ref,e);return new t(this._node.getChild(n),r,Oe)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new t(i,cs(this.ref,r),Oe)))}hasChild(e){let n=new Ee(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function vb(t,e){return t=de(t),t._checkNotDeleted("ref"),e!==void 0?cs(t._root,e):t._root}function xb(t,e){t=de(t),t._checkNotDeleted("refFromURL");let n=PI(e,t._repo.repoInfo_.nodeAdmin);KO("refFromURL",n);let r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&Vr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),vb(t,n.path.toString())}function cs(t,e){return t=de(t),ae(t._path)===null?pG("child","path",e,!1):Lc("child","path",e,!1),new Cn(t._repo,Be(t._path,e))}function rF(t,e){t=de(t),wn("push",t._path),jr("push",e,t._path,!0);let n=XO(t._repo),r=PG(n),i=cs(t,r),s=cs(t,r),o;return e!=null?o=Xm(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function iF(t){return wn("remove",t._path),Xm(t,null)}function Xm(t,e){t=de(t),wn("set",t._path),jr("set",e,t._path,!1);let n=new pt;return mb(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function sF(t,e){t=de(t),wn("setPriority",t._path),pb("setPriority",e,!1);let n=new pt;return mb(t._repo,Be(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function oF(t,e,n){if(wn("setWithPriority",t._path),jr("setWithPriority",e,t._path,!1),pb("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let r=new pt;return mb(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function aF(t,e){WO("update",e,t._path,!1);let n=new pt;return xG(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function cF(t){t=de(t);let e=new Nd(()=>{}),n=new Rd(e);return vG(t._repo,t,n).then(r=>new kc(r,new Cn(t._repo,t._path),t._queryParams.getIndex()))}var Rd=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let r=n._queryParams.getIndex();return new Mm("value",this,new kc(e.snapshotNode,new Cn(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Nm(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},Pm=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Nm(this,e,n):null}createEvent(e,n){D(e.childName!=null,"Child events should have a childName.");let r=cs(new Cn(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new Mm(e.type,this,new kc(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Ud(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=n,l=(u,d)=>{RI(t._repo,t,a),c(u,d)};l.userCallback=n.userCallback,l.context=n.context,n=l}let o=new Nd(n,s||void 0),a=e==="value"?new Rd(o):new Pm(e,o);return bG(t._repo,t,a),()=>RI(t._repo,t,a)}function Jm(t,e,n,r){return Ud(t,"value",e,n,r)}function wb(t,e,n,r){return Ud(t,"child_added",e,n,r)}function Eb(t,e,n,r){return Ud(t,"child_changed",e,n,r)}function Cb(t,e,n,r){return Ud(t,"child_moved",e,n,r)}function Ib(t,e,n,r){return Ud(t,"child_removed",e,n,r)}function bb(t,e,n){let r=null,i=n?new Nd(n):null;e==="value"?r=new Rd(i):e&&(r=new Pm(e,i)),RI(t._repo,t,r)}var In=class{},km=class extends In{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){jr("endAt",this._value,e._path,!0);let n=lI(e._queryParams,this._value,this._key);if(Zm(n),ls(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new en(e._repo,e._path,n,e._orderByCalled)}};function lF(t,e){return jd("endAt","key",e,!0),new km(t,e)}var kI=class extends In{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){jr("endBefore",this._value,e._path,!1);let n=sq(e._queryParams,this._value,this._key);if(Zm(n),ls(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new en(e._repo,e._path,n,e._orderByCalled)}};function uF(t,e){return jd("endBefore","key",e,!0),new kI(t,e)}var Om=class extends In{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){jr("startAt",this._value,e._path,!0);let n=cI(e._queryParams,this._value,this._key);if(Zm(n),ls(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new en(e._repo,e._path,n,e._orderByCalled)}};function dF(t=null,e){return jd("startAt","key",e,!0),new Om(t,e)}var OI=class extends In{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){jr("startAfter",this._value,e._path,!1);let n=iq(e._queryParams,this._value,this._key);if(Zm(n),ls(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new en(e._repo,e._path,n,e._orderByCalled)}};function hF(t,e){return jd("startAfter","key",e,!0),new OI(t,e)}var FI=class extends In{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new en(e._repo,e._path,nq(e._queryParams,this._limit),e._orderByCalled)}};function fF(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new FI(t)}var VI=class extends In{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new en(e._repo,e._path,rq(e._queryParams,this._limit),e._orderByCalled)}};function pF(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new VI(t)}var LI=class extends In{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Ym(e,"orderByChild");let n=new Ee(this._path);if(ce(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new wd(n),i=Vm(e._queryParams,r);return ls(i),new en(e._repo,e._path,i,!0)}};function gF(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Lc("orderByChild","path",t,!1),new LI(t)}var jI=class extends In{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Ym(e,"orderByKey");let n=Vm(e._queryParams,Fr);return ls(n),new en(e._repo,e._path,n,!0)}};function mF(){return new jI}var BI=class extends In{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Ym(e,"orderByPriority");let n=Vm(e._queryParams,Oe);return ls(n),new en(e._repo,e._path,n,!0)}};function _F(){return new BI}var UI=class extends In{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Ym(e,"orderByValue");let n=Vm(e._queryParams,eb);return ls(n),new en(e._repo,e._path,n,!0)}};function yF(){return new UI}var $I=class extends In{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(jr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new km(this._value,this._key)._apply(new Om(this._value,this._key)._apply(e))}};function vF(t,e){return jd("equalTo","key",e,!0),new $I(t,e)}function Un(t,...e){let n=de(t);for(let r of e)n=r._apply(n);return n}Bq(Cn);Gq(Cn);var kG="FIREBASE_DATABASE_EMULATOR_HOST",HI={},OG=!1;function FG(t,e,n,r){t.repoInfo_=new dm(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function Db(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||Vr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ct("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=PI(s,i),a=o.repoInfo,c,l;typeof process<"u"&&process.env&&(l=process.env[kG]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=PI(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let u=i&&c?new gd(gd.OWNER):new WC(t.name,t.options,e);KO("Invalid Firebase Database URL",o),ce(o.path)||Vr("Database URL must point to the root of a Firebase Database (not including a child path).");let d=LG(a,t,u,new zC(t.name,n));return new qI(d,t)}function VG(t,e){let n=HI[e];(!n||n[t.key]!==t)&&Vr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),JO(t),delete n[t.key]}function LG(t,e,n,r){let i=HI[e.name];i||(i={},HI[e.name]=i);let s=i[t.toURLString()];return s&&Vr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new NI(t,OG,n,r),i[t.toURLString()]=s,s}var qI=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(_G(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Cn(this._repo,we())),this._rootInternal}_delete(){return this._rootInternal!==null&&(VG(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Vr("Cannot call "+e+" on a deleted database.")}};function xF(){yO.IS_TRANSPORT_INITIALIZED&&$t("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function wF(){xF(),vd.forceDisallow()}function EF(){xF(),Ic.forceDisallow(),vd.forceAllow()}function CF(t,e,n,r={}){t=de(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Vr("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Vr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new gd(gd.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:zd(r.mockUserToken,t.app.options.projectId);s=new gd(o)}FG(i,e,n,s)}function IF(t){t=de(t),t._checkNotDeleted("goOffline"),JO(t._repo)}function bF(t){t=de(t),t._checkNotDeleted("goOnline"),DG(t._repo)}function DF(t,e){eO(t,e)}function jG(t){WI(Zd),us(new fn("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return Db(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),$n(v2,x2,t),$n(v2,x2,"esm2017")}var BG={".sv":"timestamp"};function TF(){return BG}function SF(t){return{".sv":{increment:t}}}var GI=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function AF(t,e,n){var r;if(t=de(t),wn("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let i=(r=n?.applyLocally)!==null&&r!==void 0?r:!0,s=new pt,o=(c,l,u)=>{let d=null;c?s.reject(c):(d=new kc(u,new Cn(t._repo,t._path),Oe),s.resolve(new GI(l,d)))},a=Jm(t,()=>{});return TG(t._repo,t._path,e,o,a,i),s.promise}XI.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};XI.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};jG();var UG="@firebase/database-compat",$G="1.0.4";var HG=new fi("@firebase/database-compat"),MF=function(t){let e="FIREBASE WARNING: "+t;HG.warn(e)};var qG=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(nn(t,e)+"must be a boolean.")},GG=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(nn(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var Tb=class{constructor(e){this._delegate=e}cancel(e){G("OnDisconnect.cancel",0,1,arguments.length),ut("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){G("OnDisconnect.remove",0,1,arguments.length),ut("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){G("OnDisconnect.set",1,2,arguments.length),ut("OnDisconnect.set","onComplete",n,!0);let r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){G("OnDisconnect.setWithPriority",2,3,arguments.length),ut("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(G("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,MF("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ut("OnDisconnect.update","onComplete",n,!0);let r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}};var Sb=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return G("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var bo=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return G("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return G("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return G("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return G("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return G("DataSnapshot.child",0,1,arguments.length),e=String(e),Lc("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return G("DataSnapshot.hasChild",1,1,arguments.length),Lc("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return G("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return G("DataSnapshot.forEach",1,1,arguments.length),ut("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return G("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return G("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return G("DataSnapshot.ref",0,0,arguments.length),new di(this._database,this._delegate.ref)}get ref(){return this.getRef()}},e_=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;G("Query.on",2,4,arguments.length),ut("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",r,i),a=(l,u)=>{n.call(o.context,new bo(this.database,l),u)};a.userCallback=n,a.context=o.context;let c=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return Jm(this._delegate,a,c),n;case"child_added":return wb(this._delegate,a,c),n;case"child_removed":return Ib(this._delegate,a,c),n;case"child_changed":return Eb(this._delegate,a,c),n;case"child_moved":return Cb(this._delegate,a,c),n;default:throw new Error(nn("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(G("Query.off",0,3,arguments.length),GG("Query.off",e,!0),ut("Query.off","callback",n,!0),o_("Query.off","context",r,!0),n){let i=()=>{};i.userCallback=n,i.context=r,bb(this._delegate,e,i)}else bb(this._delegate,e)}get(){return cF(this._delegate).then(e=>new bo(this.database,e))}once(e,n,r,i){G("Query.once",1,4,arguments.length),ut("Query.once","callback",n,!0);let s=t.getCancelAndContextArgs_("Query.once",r,i),o=new pt,a=(l,u)=>{let d=new bo(this.database,l);n&&n.call(s.context,d,u),o.resolve(d)};a.userCallback=n,a.context=s.context;let c=l=>{s.cancel&&s.cancel.call(s.context,l),o.reject(l)};switch(e){case"value":Jm(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":wb(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":Ib(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":Eb(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":Cb(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(nn("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return G("Query.limitToFirst",1,1,arguments.length),new t(this.database,Un(this._delegate,fF(e)))}limitToLast(e){return G("Query.limitToLast",1,1,arguments.length),new t(this.database,Un(this._delegate,pF(e)))}orderByChild(e){return G("Query.orderByChild",1,1,arguments.length),new t(this.database,Un(this._delegate,gF(e)))}orderByKey(){return G("Query.orderByKey",0,0,arguments.length),new t(this.database,Un(this._delegate,mF()))}orderByPriority(){return G("Query.orderByPriority",0,0,arguments.length),new t(this.database,Un(this._delegate,_F()))}orderByValue(){return G("Query.orderByValue",0,0,arguments.length),new t(this.database,Un(this._delegate,yF()))}startAt(e=null,n){return G("Query.startAt",0,2,arguments.length),new t(this.database,Un(this._delegate,dF(e,n)))}startAfter(e=null,n){return G("Query.startAfter",0,2,arguments.length),new t(this.database,Un(this._delegate,hF(e,n)))}endAt(e=null,n){return G("Query.endAt",0,2,arguments.length),new t(this.database,Un(this._delegate,lF(e,n)))}endBefore(e=null,n){return G("Query.endBefore",0,2,arguments.length),new t(this.database,Un(this._delegate,uF(e,n)))}equalTo(e,n){return G("Query.equalTo",1,2,arguments.length),new t(this.database,Un(this._delegate,vF(e,n)))}toString(){return G("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return G("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(G("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){let i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,ut(e,"cancel",i.cancel,!0),i.context=r,o_(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(nn(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new di(this.database,new Cn(this._delegate._repo,this._delegate._path))}},di=class t extends e_{constructor(e,n){super(e,new en(n._repo,n._path,new bd,!1)),this.database=e,this._delegate=n}getKey(){return G("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return G("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,cs(this._delegate,e))}getParent(){G("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return G("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){G("Reference.set",1,2,arguments.length),ut("Reference.set","onComplete",n,!0);let r=Xm(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(G("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,MF("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}wn("Reference.update",this._delegate._path),ut("Reference.update","onComplete",n,!0);let r=aF(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){G("Reference.setWithPriority",2,3,arguments.length),ut("Reference.setWithPriority","onComplete",r,!0);let i=oF(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){G("Reference.remove",0,1,arguments.length),ut("Reference.remove","onComplete",e,!0);let n=iF(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){G("Reference.transaction",1,3,arguments.length),ut("Reference.transaction","transactionUpdate",e,!1),ut("Reference.transaction","onComplete",n,!0),qG("Reference.transaction","applyLocally",r,!0);let i=AF(this._delegate,e,{applyLocally:r}).then(s=>new Sb(s.committed,new bo(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){G("Reference.setPriority",1,2,arguments.length),ut("Reference.setPriority","onComplete",n,!0);let r=sF(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){G("Reference.push",0,2,arguments.length),ut("Reference.push","onComplete",n,!0);let r=rF(this._delegate,e),i=r.then(o=>new t(this.database,o));n&&i.then(()=>n(null),o=>n(o));let s=new t(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return wn("Reference.onDisconnect",this._delegate._path),new Tb(new Rm(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var Do=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:wF,forceLongPolling:EF}}useEmulator(e,n,r={}){CF(this._delegate,e,n,r)}ref(e){if(G("database.ref",0,1,arguments.length),e instanceof di){let n=xb(this._delegate,e.toString());return new di(this,n)}else{let n=vb(this._delegate,e);return new di(this,n)}}refFromURL(e){G("database.refFromURL",1,1,arguments.length);let r=xb(this._delegate,e);return new di(this,r)}goOffline(){return G("database.goOffline",0,0,arguments.length),IF(this._delegate)}goOnline(){return G("database.goOnline",0,0,arguments.length),bF(this._delegate)}};Do.ServerValue={TIMESTAMP:TF(),increment:t=>SF(t)};function zG({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){WI(n);let a=new a_("database-standalone"),c=new Yd("auth-internal",a);c.setComponent(new fn("auth-internal",()=>r,"PRIVATE"));let l;return i&&(l=new Yd("app-check-internal",a),l.setComponent(new fn("app-check-internal",()=>i,"PRIVATE"))),{instance:new Do(Db(t,c,l,e,o),t),namespace:s}}var WG=Object.freeze({__proto__:null,initStandalone:zG});var KG=Do.ServerValue;function QG(t){t.INTERNAL.registerComponent(new fn("database-compat",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new Do(i,r)},"PUBLIC").setServiceProps({Reference:di,Query:e_,Database:Do,DataSnapshot:bo,enableLogging:DF,INTERNAL:WG,ServerValue:KG}).setMultipleInstances(!0)),t.registerVersion(UG,$G)}QG(bt);function $d(t,e,n="on",r=gs){return new oe(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),n==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),n==="on"?{unsubscribe(){s!=null&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(j(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),Qc())}function YG(t){return typeof t=="string"}function ZG(t){return typeof t.exportVal=="function"}function OF(t){return t==null}function FF(t){return typeof t.set=="function"}function NF(t,e){return FF(e)?e:t.ref(e)}function VF(t,e){if(YG(t))return e.stringCase();if(FF(t))return e.firebaseCase();if(ZG(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function LF(t){return(OF(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function jF(t,e,n){e=LF(e);let r=e.map(i=>$d(t,i,"on",n));return Bo(...r)}function XG(t,e,n){let r=jF(t,e).pipe(lr((i,s)=>[...i,s],[]));return ez(t,r,n)}function JG(t,e){return $d(t,"value","on",e).pipe(j(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}function ez(t,e,n){return JG(t,n).pipe(N_(e),j(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(c=>c.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),A_(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),j(i=>i.actions))}function RF(t,e){return function(r,i){return VF(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function tz(t){return function(n){return n?VF(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function nz(t,e,n){return $d(t,"value","once",n).pipe(Le(r=>{let i=[B(r)];return e.forEach(s=>i.push($d(t,s,"on",n))),Bo(...i).pipe(lr(iz,[]))}),zc())}function BF(t,e){let n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function rz(t,e){if(OF(e))return 0;{let n=BF(t,e);return n===-1?t.length:n+1}}function iz(t,e){let{payload:n,prevKey:r,key:i}=e,s=BF(t,i),o=rz(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(c=>{let l={payload:c,type:"value",prevKey:a,key:c.key};return a=c.key,t=[...t,l],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(c=>c.payload.key!==n.key),t.splice(o,0,e));else{if(r==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=t.splice(s,1)[0];return t=t.slice(),t.splice(o,0,a),t}return t;default:return t}}function PF(t,e,n){return e=LF(e),nz(t,e,n)}function sz(t,e){let n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:RF(r,"update"),set:RF(r,"set"),push:i=>r.push(i),remove:tz(r),snapshotChanges(i){return PF(t,i,n).pipe(Ke)},stateChanges(i){return jF(t,i,n).pipe(Ke)},auditTrail(i){return XG(t,i,n).pipe(Ke)},valueChanges(i,s){return PF(t,i,n).pipe(j(a=>a.map(c=>s&&s.idField?se(A({},c.payload.val()),{[s.idField]:c.key}):c.payload.val())),Ke)}}}function kF(t,e){return function(){return $d(t,"value","on",e)}}function oz(t,e){return{query:t,snapshotChanges(){return kF(t,e.schedulers.outsideAngular)().pipe(Ke)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return kF(t,e.schedulers.outsideAngular)().pipe(Ke,j(r=>r.payload.exists()?r.payload.val():null))}}}var az=new O("angularfire2.realtimeDatabaseURL"),cz=new O("angularfire2.database.use-emulator"),lz=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,c,l,u,d,h,f,p,m,v){this.schedulers=a;let b=c,F=Ls(n,o,r);l&&Wl(F,o,u,h,f,p,d,m),this.database=Ia(`${F.name}.database.${i}`,"AngularFireDatabase",F.name,()=>{let T=o.runOutsideAngular(()=>F.database(i||void 0));return b&&T.useEmulator(...b),T},[b])}list(n,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>NF(this.database,n)),s=i;return r&&(s=r(i)),sz(s,this)}object(n){let r=this.schedulers.ngZone.runOutsideAngular(()=>NF(this.database,n));return oz(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(E(Ri),E(Pi,8),E(az,8),E(Ot),E(fe),E(Ca),E(cz,8),E(rp,8),E(Ul,8),E($l,8),E(Hl,8),E(ql,8),E(Gl,8),E(zl,8),E(Xr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),UF=(()=>{class t{constructor(){bt.registerVersion("angularfire",Vs.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=nt({type:t});static \u0275inj=tt({providers:[lz]})}return t})();var $F=(()=>{let e=class e{constructor(){this.title="360Car"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=sn({type:e,selectors:[["app-root"]],decls:21,vars:0,consts:[[1,"navbar"],["routerLink","/home",1,"navbar-brand"],["src","./assets/images/OIG_WB_white.png","alt","logo",1,"logo"],["routerLink","/home"],["routerLink","/coches"],["routerLink","/transacciones"],["routerLink","/clientes"],[1,"container"]],template:function(i,s){i&1&&(x(0,"header")(1,"nav",0)(2,"a",1),cn(3,"img",2),x(4,"span"),S(5,"360Car"),I()(),x(6,"ul")(7,"li")(8,"a",3),S(9,"Home"),I()(),x(10,"li")(11,"a",4),S(12,"Coches"),I()(),x(13,"li")(14,"a",5),S(15,"Transacciones"),I()(),x(16,"li")(17,"a",6),S(18,"Clientes"),I()()()()(),x(19,"div",7),cn(20,"router-outlet"),I())},dependencies:[vv,x1],styles:[".navbar[_ngcontent-%COMP%]{padding:0 2rem;display:flex;justify-content:space-between;align-items:center;background-color:var(--black)}.navbar-brand[_ngcontent-%COMP%]{display:flex;align-items:center}img[_ngcontent-%COMP%]{height:6rem}ul[_ngcontent-%COMP%]{display:flex;flex-direction:row}li[_ngcontent-%COMP%]{list-style:none;list-style-type:none;margin-left:3rem}a[_ngcontent-%COMP%]{text-decoration:none;color:var(--white);font-weight:700;font-size:1rem;transition:color ease .6s;padding:1rem}a[_ngcontent-%COMP%]:hover{color:var(--yellow)}"]});let t=e;return t})();var HF=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=nt({type:e,bootstrap:[$F]}),e.\u0275inj=tt({imports:[RA,_2,u2,$1.initializeApp(y2.firebaseConfig),UF]});let t=e;return t})();NA().bootstrapModule(HF).catch(t=>console.error(t));
