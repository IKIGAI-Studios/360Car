import{A as Mb,B as In,C as ui,D as Gd,E as Lc,F as t_,G as Rb,H as Nb,I as q,J as Jt,K as ct,L as n_,M as Pb,N as jc,O as le,P as dn,Q as zd,R as r_,S as Cn,T as li,U as as,V as Wd,W as kb,X as Bn,Y as wt,a as A,b as ue,c as Xm,d as g,e as wb,f as Bd,g as Eb,h as Ib,i as D,j as bo,k as Ud,l as Cb,m as bb,n as ht,o as $d,p as Vc,q as Jm,r as Db,s as sr,t as e_,u as Hd,v as Tb,w as Sb,x as qd,y as Ze,z as Ab}from"./chunk-44ZLHZR4.js";var Ob=null;var i_=1,s_=Symbol("SIGNAL");function we(t){let e=Ob;return Ob=t,e}var Fb={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function SF(t){if(!(c_(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===i_)){if(!t.producerMustRecompute(t)&&!o_(t)){t.dirty=!1,t.lastCleanEpoch=i_;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=i_}}function Vb(t){return t&&(t.nextProducerIndex=0),we(t)}function Lb(t,e){if(we(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(c_(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)a_(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function o_(t){Kd(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(SF(n),r!==n.version))return!0}return!1}function jb(t){if(Kd(t),c_(t))for(let e=0;e<t.producerNode.length;e++)a_(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function a_(t,e){if(AF(t),Kd(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)a_(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];Kd(i),i.producerIndexOfThis[r]=e}}function c_(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function Kd(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function AF(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function MF(){throw new Error}var RF=MF;function Bb(t){RF=t}function K(t){return typeof t=="function"}function Do(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Qd=Do(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function cs(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var ze=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(K(r))try{r()}catch(s){e=s instanceof Qd?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{Ub(s)}catch(o){e=e??[],o instanceof Qd?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Qd(e)}}add(e){var n;if(e&&e!==this)if(this.closed)Ub(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&cs(n,e)}remove(e){let{_finalizers:n}=this;n&&cs(n,e),e instanceof t&&e._removeParent(this)}};ze.EMPTY=(()=>{let t=new ze;return t.closed=!0,t})();var u_=ze.EMPTY;function Yd(t){return t instanceof ze||t&&"closed"in t&&K(t.remove)&&K(t.add)&&K(t.unsubscribe)}function Ub(t){K(t)?t():t.unsubscribe()}var Un={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var To={setTimeout(t,e,...n){let{delegate:r}=To;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=To;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Zd(t){To.setTimeout(()=>{let{onUnhandledError:e}=Un;if(e)e(t);else throw t})}function us(){}var $b=l_("C",void 0,void 0);function Hb(t){return l_("E",void 0,t)}function qb(t){return l_("N",t,void 0)}function l_(t,e,n){return{kind:t,value:e,error:n}}var ls=null;function So(t){if(Un.useDeprecatedSynchronousErrorHandling){let e=!ls;if(e&&(ls={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=ls;if(ls=null,n)throw r}}else t()}function Gb(t){Un.useDeprecatedSynchronousErrorHandling&&ls&&(ls.errorThrown=!0,ls.error=t)}var ds=class extends ze{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Yd(e)&&e.add(this)):this.destination=kF}static create(e,n,r){return new Vr(e,n,r)}next(e){this.isStopped?h_(qb(e),this):this._next(e)}error(e){this.isStopped?h_(Hb(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?h_($b,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},NF=Function.prototype.bind;function d_(t,e){return NF.call(t,e)}var f_=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){Xd(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){Xd(r)}else Xd(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){Xd(n)}}},Vr=class extends ds{constructor(e,n,r){super();let i;if(K(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&Un.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&d_(e.next,s),error:e.error&&d_(e.error,s),complete:e.complete&&d_(e.complete,s)}):i=e}this.destination=new f_(i)}};function Xd(t){Un.useDeprecatedSynchronousErrorHandling?Gb(t):Zd(t)}function PF(t){throw t}function h_(t,e){let{onStoppedNotification:n}=Un;n&&To.setTimeout(()=>n(t,e))}var kF={closed:!0,next:us,error:PF,complete:us};var Ao=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Et(t){return t}function p_(...t){return g_(t)}function g_(t){return t.length===0?Et:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var ie=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=FF(n)?n:new Vr(n,r,i);return So(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=zb(r),new r((i,s)=>{let o=new Vr({next:a=>{try{n(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[Ao](){return this}pipe(...n){return g_(n)(this)}toPromise(n){return n=zb(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function zb(t){var e;return(e=t??Un.Promise)!==null&&e!==void 0?e:Promise}function OF(t){return t&&K(t.next)&&K(t.error)&&K(t.complete)}function FF(t){return t&&t instanceof ds||OF(t)&&Yd(t)}function m_(t){return K(t?.lift)}function X(t){return e=>{if(m_(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Q(t,e,n,r,i){return new __(t,e,n,r,i)}var __=class extends ds{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Mo(){return X((t,e)=>{let n=null;t._refCount++;let r=Q(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var Ro=class extends ie{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,m_(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new ze;let n=this.getSubject();e.add(this.source.subscribe(Q(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=ze.EMPTY)}return e}refCount(){return Mo()(this)}};var Wb=Do(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var $e=(()=>{class t extends ie{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new Jd(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new Wb}next(n){So(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){So(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){So(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?u_:(this.currentObservers=null,s.push(n),new ze(()=>{this.currentObservers=null,cs(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new ie;return n.source=this,n}}return t.create=(e,n)=>new Jd(e,n),t})(),Jd=class extends $e{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:u_}};var It=class extends $e{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Bc={now(){return(Bc.delegate||Date).now()},delegate:void 0};var eh=class extends $e{constructor(e=1/0,n=1/0,r=Bc){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=n.now(),a=0;for(let c=1;c<r.length&&r[c]<=o;c+=2)a=c;a&&r.splice(0,a+1)}}};var th=class extends ze{constructor(e,n){super()}schedule(e,n=0){return this}};var Uc={setInterval(t,e,...n){let{delegate:r}=Uc;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=Uc;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var No=class extends th{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return Uc.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&Uc.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,cs(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var Po=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};Po.now=Bc.now;var ko=class extends Po{constructor(e,n=Po.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var hs=new ko(No);var nh=class extends No{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var rh=class extends ko{};var y_=new rh(nh);var Vt=new ie(t=>t.complete());function Kb(t){return t&&K(t.schedule)}function v_(t){return t[t.length-1]}function Oo(t){return K(v_(t))?t.pop():void 0}function or(t){return Kb(v_(t))?t.pop():void 0}function Qb(t,e){return typeof v_(t)=="number"?t.pop():e}var ih=t=>t&&typeof t.length=="number"&&typeof t!="function";function sh(t){return K(t?.then)}function oh(t){return K(t[Ao])}function ah(t){return Symbol.asyncIterator&&K(t?.[Symbol.asyncIterator])}function ch(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function VF(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var uh=VF();function lh(t){return K(t?.[uh])}function dh(t){return Eb(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield Bd(n.read());if(i)return yield Bd(void 0);yield yield Bd(r)}}finally{n.releaseLock()}})}function hh(t){return K(t?.getReader)}function De(t){if(t instanceof ie)return t;if(t!=null){if(oh(t))return LF(t);if(ih(t))return jF(t);if(sh(t))return BF(t);if(ah(t))return Yb(t);if(lh(t))return UF(t);if(hh(t))return $F(t)}throw ch(t)}function LF(t){return new ie(e=>{let n=t[Ao]();if(K(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function jF(t){return new ie(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function BF(t){return new ie(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,Zd)})}function UF(t){return new ie(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function Yb(t){return new ie(e=>{HF(t,e).catch(n=>e.error(n))})}function $F(t){return Yb(dh(t))}function HF(t,e){var n,r,i,s;return wb(this,void 0,void 0,function*(){try{for(n=Ib(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function en(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function bn(t,e=0){return X((n,r)=>{n.subscribe(Q(r,i=>en(r,t,()=>r.next(i),e),()=>en(r,t,()=>r.complete(),e),i=>en(r,t,()=>r.error(i),e)))})}function $n(t,e=0){return X((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function Zb(t,e){return De(t).pipe($n(e),bn(e))}function Xb(t,e){return De(t).pipe($n(e),bn(e))}function Jb(t,e){return new ie(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function eD(t,e){return new ie(n=>{let r;return en(n,e,()=>{r=t[uh](),en(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>K(r?.return)&&r.return()})}function fh(t,e){if(!t)throw new Error("Iterable cannot be null");return new ie(n=>{en(n,e,()=>{let r=t[Symbol.asyncIterator]();en(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function tD(t,e){return fh(dh(t),e)}function nD(t,e){if(t!=null){if(oh(t))return Zb(t,e);if(ih(t))return Jb(t,e);if(sh(t))return Xb(t,e);if(ah(t))return fh(t,e);if(lh(t))return eD(t,e);if(hh(t))return tD(t,e)}throw ch(t)}function ye(t,e){return e?nD(t,e):De(t)}function B(...t){let e=or(t);return ye(t,e)}function Fo(t,e){let n=K(t)?t:()=>t,r=i=>i.error(n());return new ie(e?i=>e.schedule(r,0,i):r)}function x_(t){return!!t&&(t instanceof ie||K(t.lift)&&K(t.subscribe))}var Lr=Do(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function j(t,e){return X((n,r)=>{let i=0;n.subscribe(Q(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:qF}=Array;function GF(t,e){return qF(e)?t(...e):t(e)}function ph(t){return j(e=>GF(t,e))}var{isArray:zF}=Array,{getPrototypeOf:WF,prototype:KF,keys:QF}=Object;function gh(t){if(t.length===1){let e=t[0];if(zF(e))return{args:e,keys:null};if(YF(e)){let n=QF(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function YF(t){return t&&typeof t=="object"&&WF(t)===KF}function mh(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function $c(...t){let e=or(t),n=Oo(t),{args:r,keys:i}=gh(t);if(r.length===0)return ye([],e);let s=new ie(ZF(r,e,i?o=>mh(i,o):Et));return n?s.pipe(ph(n)):s}function ZF(t,e,n=Et){return r=>{rD(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)rD(e,()=>{let u=ye(t[c],e),l=!1;u.subscribe(Q(r,d=>{s[c]=d,l||(l=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function rD(t,e,n){t?en(n,t,e):e()}function iD(t,e,n,r,i,s,o,a){let c=[],u=0,l=0,d=!1,h=()=>{d&&!c.length&&!u&&e.complete()},f=m=>u<r?p(m):c.push(m),p=m=>{s&&e.next(m),u++;let v=!1;De(n(m,l++)).subscribe(Q(e,b=>{i?.(b),s?f(b):e.next(b)},()=>{v=!0},void 0,()=>{if(v)try{for(u--;c.length&&u<r;){let b=c.shift();o?en(e,o,()=>p(b)):p(b)}h()}catch(b){e.error(b)}}))};return t.subscribe(Q(e,f,()=>{d=!0,h()})),()=>{a?.()}}function Xe(t,e,n=1/0){return K(e)?Xe((r,i)=>j((s,o)=>e(r,s,i,o))(De(t(r,i))),n):(typeof e=="number"&&(n=e),X((r,i)=>iD(r,i,t,n)))}function di(t=1/0){return Xe(Et,t)}function sD(){return di(1)}function Vo(...t){return sD()(ye(t,or(t)))}function _h(t){return new ie(e=>{De(t()).subscribe(e)})}function w_(...t){let e=Oo(t),{args:n,keys:r}=gh(t),i=new ie(s=>{let{length:o}=n;if(!o){s.complete();return}let a=new Array(o),c=o,u=o;for(let l=0;l<o;l++){let d=!1;De(n[l]).subscribe(Q(s,h=>{d||(d=!0,u--),a[l]=h},()=>c--,void 0,()=>{(!c||!d)&&(u||s.next(r?mh(r,a):a),s.complete())}))}});return e?i.pipe(ph(e)):i}function Lo(...t){let e=or(t),n=Qb(t,1/0),r=t;return r.length?r.length===1?De(r[0]):di(n)(ye(r,e)):Vt}function Ct(t,e){return X((n,r)=>{let i=0;n.subscribe(Q(r,s=>t.call(e,s,i++)&&r.next(s)))})}function hi(t){return X((e,n)=>{let r=null,i=!1,s;r=e.subscribe(Q(n,void 0,void 0,o=>{s=De(t(o,hi(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function oD(t,e,n,r,i){return(s,o)=>{let a=n,c=e,u=0;s.subscribe(Q(o,l=>{let d=u++;c=a?t(c,l,d):(a=!0,l),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function fs(t,e){return K(e)?Xe(t,e,1):Xe(t,1)}function fi(t){return X((e,n)=>{let r=!1;e.subscribe(Q(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function jr(t){return t<=0?()=>Vt:X((e,n)=>{let r=0;e.subscribe(Q(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function E_(t){return j(()=>t)}function Hc(t,e=Et){return t=t??XF,X((n,r)=>{let i,s=!0;n.subscribe(Q(r,o=>{let a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function XF(t,e){return t===e}function yh(t=JF){return X((e,n)=>{let r=!1;e.subscribe(Q(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function JF(){return new Lr}function qc(t){return X((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function Dn(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Ct((i,s)=>t(i,s,r)):Et,jr(1),n?fi(e):yh(()=>new Lr))}function jo(t){return t<=0?()=>Vt:X((e,n)=>{let r=[];e.subscribe(Q(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function I_(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Ct((i,s)=>t(i,s,r)):Et,jo(1),n?fi(e):yh(()=>new Lr))}function Gc(){return X((t,e)=>{let n,r=!1;t.subscribe(Q(e,i=>{let s=n;n=i,r&&e.next([s,i]),r=!0}))})}function ar(t,e){return X(oD(t,e,arguments.length>=2,!0))}function zc(t={}){let{connector:e=()=>new $e,resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,c,u=0,l=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=c=void 0,l=d=!1},p=()=>{let m=o;f(),m?.unsubscribe()};return X((m,v)=>{u++,!d&&!l&&h();let b=c=c??e();v.add(()=>{u--,u===0&&!d&&!l&&(a=C_(p,i))}),b.subscribe(v),!o&&u>0&&(o=new Vr({next:F=>b.next(F),error:F=>{d=!0,h(),a=C_(f,n,F),b.error(F)},complete:()=>{l=!0,h(),a=C_(f,r),b.complete()}}),De(m).subscribe(o))})(s)}}function C_(t,e,...n){if(e===!0){t();return}if(e===!1)return;let r=new Vr({next:()=>{r.unsubscribe(),t()}});return De(e(...n)).subscribe(r)}function vh(t,e,n){let r,i=!1;return t&&typeof t=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t:r=t??1/0,zc({connector:()=>new eh(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function b_(t){return X((e,n)=>{let r=!1,i=0;e.subscribe(Q(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}function ps(...t){let e=or(t);return X((n,r)=>{(e?Vo(t,n,e):Vo(t,n)).subscribe(r)})}function Fe(t,e){return X((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(Q(r,c=>{i?.unsubscribe();let u=0,l=s++;De(t(c,l)).subscribe(i=Q(r,d=>r.next(e?e(c,d,l,u++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function xh(t,e){return K(e)?Fe(()=>t,e):Fe(()=>t)}function D_(t){return X((e,n)=>{De(t).subscribe(Q(n,()=>n.complete(),us)),!n.closed&&e.subscribe(n)})}function ut(t,e,n){let r=K(t)||e||n?{next:t,error:e,complete:n}:t;return r?X((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(Q(s,c=>{var u;(u=r.next)===null||u===void 0||u.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var u;a=!1,(u=r.error)===null||u===void 0||u.call(r,c),s.error(c)},()=>{var c,u;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):Et}function T_(...t){let e=Oo(t);return X((n,r)=>{let i=t.length,s=new Array(i),o=t.map(()=>!1),a=!1;for(let c=0;c<i;c++)De(t[c]).subscribe(Q(r,u=>{s[c]=u,!a&&!o[c]&&(o[c]=!0,(a=o.every(Et))&&(o=null))},us));n.subscribe(Q(r,c=>{if(a){let u=[c,...s];r.next(e?e(...u):u)}}))})}var zD="https://g.co/ng/security#xss",$=class extends Error{constructor(e,n){super(A0(e,n)),this.code=e}};function A0(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}function su(t){return{toString:t}.toString()}var wh="__parameters__";function eV(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function WD(t,e,n){return su(()=>{let r=eV(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,u,l){let d=c.hasOwnProperty(wh)?c[wh]:Object.defineProperty(c,wh,{value:[]})[wh];for(;d.length<=l;)d.push(null);return(d[l]=d[l]||[]).push(o),c}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}var jt=globalThis;function Te(t){for(let e in t)if(t[e]===Te)return e;throw Error("Could not find renamed property on target object.")}function tV(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function Bt(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(Bt).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function aD(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var nV=Te({__forward_ref__:Te});function xi(t){return t.__forward_ref__=xi,t.toString=function(){return Bt(this())},t}function Lt(t){return KD(t)?t():t}function KD(t){return typeof t=="function"&&t.hasOwnProperty(nV)&&t.__forward_ref__===xi}function V(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function et(t){return{providers:t.providers||[],imports:t.imports||[]}}function ef(t){return cD(t,YD)||cD(t,ZD)}function QD(t){return ef(t)!==null}function cD(t,e){return t.hasOwnProperty(e)?t[e]:null}function rV(t){let e=t&&(t[YD]||t[ZD]);return e||null}function uD(t){return t&&(t.hasOwnProperty(lD)||t.hasOwnProperty(iV))?t[lD]:null}var YD=Te({\u0275prov:Te}),lD=Te({\u0275inj:Te}),ZD=Te({ngInjectableDef:Te}),iV=Te({ngInjectorDef:Te}),O=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=V({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function XD(t){return t&&!!t.\u0275providers}var sV=Te({\u0275cmp:Te}),oV=Te({\u0275dir:Te}),aV=Te({\u0275pipe:Te}),cV=Te({\u0275mod:Te}),Rh=Te({\u0275fac:Te}),Wc=Te({__NG_ELEMENT_ID__:Te}),dD=Te({__NG_ENV_ID__:Te});function tf(t){return typeof t=="string"?t:t==null?"":String(t)}function uV(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():tf(t)}function lV(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new $(-200,t)}function M0(t,e){throw new $(-201,!1)}var ae=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(ae||{}),$_;function JD(){return $_}function Tn(t){let e=$_;return $_=t,e}function eT(t,e,n){let r=ef(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&ae.Optional)return null;if(e!==void 0)return e;M0(t,"Injector")}var dV={},Qc=dV,H_="__NG_DI_FLAG__",Nh="ngTempTokenPath",hV="ngTokenPath",fV=/\n/gm,pV="\u0275",hD="__source",qo;function gV(){return qo}function pi(t){let e=qo;return qo=t,e}function mV(t,e=ae.Default){if(qo===void 0)throw new $(-203,!1);return qo===null?eT(t,void 0,e):qo.get(t,e&ae.Optional?null:void 0,e)}function E(t,e=ae.Default){return(JD()||mV)(Lt(t),e)}function P(t,e=ae.Default){return E(t,nf(e))}function nf(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function q_(t){let e=[];for(let n=0;n<t.length;n++){let r=Lt(t[n]);if(Array.isArray(r)){if(r.length===0)throw new $(900,!1);let i,s=ae.Default;for(let o=0;o<r.length;o++){let a=r[o],c=_V(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(E(i,s))}else e.push(E(r))}return e}function tT(t,e){return t[H_]=e,t.prototype[H_]=e,t}function _V(t){return t[H_]}function yV(t,e,n,r){let i=t[Nh];throw e[hD]&&i.unshift(e[hD]),t.message=vV(`
`+t.message,i,n,r),t[hV]=i,t[Nh]=null,t}function vV(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==pV?t.slice(2):t;let i=Bt(e);if(Array.isArray(e))i=e.map(Bt).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Bt(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(fV,`
  `)}`}var ta=tT(WD("Optional"),8);var R0=tT(WD("SkipSelf"),4);function zo(t,e){let n=t.hasOwnProperty(Rh);return n?t[Rh]:null}function N0(t,e){t.forEach(n=>Array.isArray(n)?N0(n,e):e(n))}function nT(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Ph(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function xV(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let s=i-2;t[i]=t[s],i--}t[e]=n,t[e+1]=r}}function wV(t,e,n){let r=ou(t,e);return r>=0?t[r|1]=n:(r=~r,xV(t,r,e,n)),r}function S_(t,e){let n=ou(t,e);if(n>=0)return t[n|1]}function ou(t,e){return EV(t,e,1)}function EV(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}var Wo={},Sn=[],Ko=new O(""),rT=new O("",-1),iT=new O(""),kh=class{get(e,n=Qc){if(n===Qc){let r=new Error(`NullInjectorError: No provider for ${Bt(e)}!`);throw r.name="NullInjectorError",r}return n}},sT=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(sT||{}),lr=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(lr||{}),Ut=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(Ut||{});function IV(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function G_(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];CV(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function oT(t){return t===3||t===4||t===6}function CV(t){return t.charCodeAt(0)===64}function Yc(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?fD(t,n,i,null,e[++r]):fD(t,n,i,null,null))}}return t}function fD(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var aT="ng-template";function bV(t,e,n,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&IV(e[i+1].toLowerCase(),n,0)!==-1)return!0}else if(P0(t))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===n)return!0}return!1}function P0(t){return t.type===4&&t.value!==aT}function DV(t,e,n){let r=t.type===4&&!n?aT:t.value;return e===r}function TV(t,e,n){let r=4,i=t.attrs,s=i!==null?MV(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!Hn(r)&&!Hn(c))return!1;if(o&&Hn(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!DV(t,c,n)||c===""&&e.length===1){if(Hn(r))return!1;o=!0}}else if(r&8){if(i===null||!bV(t,i,c,n)){if(Hn(r))return!1;o=!0}}else{let u=e[++a],l=SV(c,i,P0(t),n);if(l===-1){if(Hn(r))return!1;o=!0;continue}if(u!==""){let d;if(l>s?d="":d=i[l+1].toLowerCase(),r&2&&u!==d){if(Hn(r))return!1;o=!0}}}}return Hn(r)||o}function Hn(t){return(t&1)===0}function SV(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return RV(e,t)}function AV(t,e,n=!1){for(let r=0;r<e.length;r++)if(TV(t,e[r],n))return!0;return!1}function MV(t){for(let e=0;e<t.length;e++){let n=t[e];if(oT(n))return e}return t.length}function RV(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function pD(t,e){return t?":not("+e.trim()+")":e}function NV(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Hn(o)&&(e+=pD(s,i),i=""),r=o,s=s||!Hn(r);n++}return i!==""&&(e+=pD(s,i)),e}function PV(t){return t.map(NV).join(",")}function kV(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!Hn(i))break;i=s}r++}return{attrs:e,classes:n}}function tn(t){return su(()=>{let e=hT(t),n=ue(A({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===sT.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||lr.Emulated,styles:t.styles||Sn,_:null,schemas:t.schemas||null,tView:null,id:""});fT(n);let r=t.dependencies;return n.directiveDefs=mD(r,!1),n.pipeDefs=mD(r,!0),n.id=VV(n),n})}function OV(t){return mi(t)||cT(t)}function FV(t){return t!==null}function tt(t){return su(()=>({type:t.type,bootstrap:t.bootstrap||Sn,declarations:t.declarations||Sn,imports:t.imports||Sn,exports:t.exports||Sn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function gD(t,e){if(t==null)return Wo;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s,o,a=Ut.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(n[s]=a!==Ut.None?[r,a]:r,e[s]=o):n[s]=r}return n}function bt(t){return su(()=>{let e=hT(t);return fT(e),e})}function mi(t){return t[sV]||null}function cT(t){return t[oV]||null}function uT(t){return t[aV]||null}function lT(t){let e=mi(t)||cT(t)||uT(t);return e!==null?e.standalone:!1}function dT(t,e){let n=t[cV]||null;if(!n&&e===!0)throw new Error(`Type ${Bt(t)} does not have '\u0275mod' property.`);return n}function hT(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||Wo,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||Sn,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:gD(t.inputs,e),outputs:gD(t.outputs),debugInfo:null}}function fT(t){t.features?.forEach(e=>e(t))}function mD(t,e){if(!t)return null;let n=e?uT:OV;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(FV)}function VV(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function LV(...t){return{\u0275providers:pT(!0,t),\u0275fromNgModule:!0}}function pT(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return N0(e,o=>{let a=o;z_(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&gT(i,s),n}function gT(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];k0(i,s=>{e(s,r)})}}function z_(t,e,n,r){if(t=Lt(t),!t)return!1;let i=null,s=uD(t),o=!s&&mi(t);if(!s&&!o){let c=t.ngModule;if(s=uD(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let u of c)z_(u,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let u;try{N0(s.imports,l=>{z_(l,e,n,r)&&(u||=[],u.push(l))})}finally{}u!==void 0&&gT(u,e)}if(!a){let u=zo(i)||(()=>new i);e({provide:i,useFactory:u,deps:Sn},i),e({provide:iT,useValue:i,multi:!0},i),e({provide:Ko,useValue:()=>E(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let u=t;k0(c,l=>{e(l,u)})}}else return!1;return i!==t&&t.providers!==void 0}function k0(t,e){for(let n of t)XD(n)&&(n=n.\u0275providers),Array.isArray(n)?k0(n,e):e(n)}var jV=Te({provide:String,useValue:Te});function mT(t){return t!==null&&typeof t=="object"&&jV in t}function BV(t){return!!(t&&t.useExisting)}function UV(t){return!!(t&&t.useFactory)}function Qo(t){return typeof t=="function"}function $V(t){return!!t.useClass}var rf=new O(""),Dh={},HV={},A_;function O0(){return A_===void 0&&(A_=new kh),A_}var hn=class{},Zc=class extends hn{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,K_(e,o=>this.processProvider(o)),this.records.set(rT,Bo(void 0,this)),i.has("environment")&&this.records.set(hn,Bo(void 0,this));let s=this.records.get(rf);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(iT,Sn,ae.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=we(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),we(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=pi(this),r=Tn(void 0),i;try{return e()}finally{pi(n),Tn(r)}}get(e,n=Qc,r=ae.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(dD))return e[dD](this);r=nf(r);let i,s=pi(this),o=Tn(void 0);try{if(!(r&ae.SkipSelf)){let c=this.records.get(e);if(c===void 0){let u=KV(e)&&ef(e);u&&this.injectableDefInScope(u)?c=Bo(W_(e),Dh):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&ae.Self?O0():this.parent;return n=r&ae.Optional&&n===Qc?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[Nh]=a[Nh]||[]).unshift(Bt(e)),s)throw a;return yV(a,e,"R3InjectorError",this.source)}else throw a}finally{Tn(o),pi(s)}}resolveInjectorInitializers(){let e=we(null),n=pi(this),r=Tn(void 0),i;try{let s=this.get(Ko,Sn,ae.Self);for(let o of s)o()}finally{pi(n),Tn(r),we(e)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(Bt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new $(205,!1)}processProvider(e){e=Lt(e);let n=Qo(e)?e:Lt(e&&e.provide),r=GV(e);if(!Qo(e)&&e.multi===!0){let i=this.records.get(n);i||(i=Bo(void 0,Dh,!0),i.factory=()=>q_(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){let r=we(null);try{return n.value===Dh&&(n.value=HV,n.value=n.factory()),typeof n.value=="object"&&n.value&&WV(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{we(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let n=Lt(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function W_(t){let e=ef(t),n=e!==null?e.factory:zo(t);if(n!==null)return n;if(t instanceof O)throw new $(204,!1);if(t instanceof Function)return qV(t);throw new $(204,!1)}function qV(t){if(t.length>0)throw new $(204,!1);let n=rV(t);return n!==null?()=>n.factory(t):()=>new t}function GV(t){if(mT(t))return Bo(void 0,t.useValue);{let e=_T(t);return Bo(e,Dh)}}function _T(t,e,n){let r;if(Qo(t)){let i=Lt(t);return zo(i)||W_(i)}else if(mT(t))r=()=>Lt(t.useValue);else if(UV(t))r=()=>t.useFactory(...q_(t.deps||[]));else if(BV(t))r=()=>E(Lt(t.useExisting));else{let i=Lt(t&&(t.useClass||t.provide));if(zV(t))r=()=>new i(...q_(t.deps));else return zo(i)||W_(i)}return r}function Bo(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function zV(t){return!!t.deps}function WV(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function KV(t){return typeof t=="function"||typeof t=="object"&&t instanceof O}function K_(t,e){for(let n of t)Array.isArray(n)?K_(n,e):n&&XD(n)?K_(n.\u0275providers,e):e(n)}function $r(t,e){t instanceof Zc&&t.assertNotDestroyed();let n,r=pi(t),i=Tn(void 0);try{return e()}finally{pi(r),Tn(i)}}function yT(){return JD()!==void 0||gV()!=null}function QV(t){if(!yT())throw new $(-203,!1)}function YV(t){let e=jt.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function ZV(t){return typeof t=="function"}var Hr=0,pe=1,z=2,Mt=3,qn=4,Wn=5,Oh=6,Xc=7,Gn=8,Yo=9,zn=10,Je=11,Jc=12,_D=13,na=14,dr=15,sf=16,Uo=17,Zo=18,of=19,vT=20,gi=21,M_=22,_s=23,_i=25,xT=1;var ys=7,Fh=8,Vh=9,An=10,F0=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(F0||{});function gs(t){return Array.isArray(t)&&typeof t[xT]=="object"}function qr(t){return Array.isArray(t)&&t[xT]===!0}function wT(t){return(t.flags&4)!==0}function af(t){return t.componentOffset>-1}function V0(t){return(t.flags&1)===1}function yi(t){return!!t.template}function XV(t){return(t[z]&512)!==0}var Q_=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function ET(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}function Cs(){return IT}function IT(t){return t.type.prototype.ngOnChanges&&(t.setInput=eL),JV}Cs.ngInherit=!0;function JV(){let t=bT(this),e=t?.current;if(e){let n=t.previous;if(n===Wo)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function eL(t,e,n,r,i){let s=this.declaredInputs[r],o=bT(t)||tL(t,{previous:Wo,current:null}),a=o.current||(o.current={}),c=o.previous,u=c[s];a[s]=new Q_(u&&u.currentValue,n,c===Wo),ET(t,e,i,n)}var CT="__ngSimpleChanges__";function bT(t){return t[CT]||null}function tL(t,e){return t[CT]=e}var yD=null;var cr=function(t,e,n){yD?.(t,e,n)},nL="svg",rL="math",iL=!1;function sL(){return iL}function hr(t){for(;Array.isArray(t);)t=t[Hr];return t}function DT(t,e){return hr(e[t])}function Mn(t,e){return hr(e[t.index])}function TT(t,e){return t.data[e]}function wi(t,e){let n=e[t];return gs(n)?n:n[Hr]}function L0(t){return(t[z]&128)===128}function oL(t){return qr(t[Mt])}function Lh(t,e){return e==null?null:t[e]}function ST(t){t[Uo]=0}function aL(t){t[z]&1024||(t[z]|=1024,L0(t)&&eu(t))}function cL(t,e){for(;t>0;)e=e[na],t--;return e}function j0(t){return!!(t[z]&9216||t[_s]?.dirty)}function Y_(t){t[zn].changeDetectionScheduler?.notify(1),j0(t)?eu(t):t[z]&64&&(sL()?(t[z]|=1024,eu(t)):t[zn].changeDetectionScheduler?.notify())}function eu(t){t[zn].changeDetectionScheduler?.notify();let e=tu(t);for(;e!==null&&!(e[z]&8192||(e[z]|=8192,!L0(e)));)e=tu(e)}function AT(t,e){if((t[z]&256)===256)throw new $(911,!1);t[gi]===null&&(t[gi]=[]),t[gi].push(e)}function uL(t,e){if(t[gi]===null)return;let n=t[gi].indexOf(e);n!==-1&&t[gi].splice(n,1)}function tu(t){let e=t[Mt];return qr(e)?e[Mt]:e}var he={lFrame:FT(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function lL(){return he.lFrame.elementDepthCount}function dL(){he.lFrame.elementDepthCount++}function hL(){he.lFrame.elementDepthCount--}function MT(){return he.bindingsEnabled}function fL(){return he.skipHydrationRootTNode!==null}function pL(t){return he.skipHydrationRootTNode===t}function gL(){he.skipHydrationRootTNode=null}function Me(){return he.lFrame.lView}function nn(){return he.lFrame.tView}function $t(t){return he.lFrame.contextLView=t,t[Gn]}function Ht(t){return he.lFrame.contextLView=null,t}function rn(){let t=RT();for(;t!==null&&t.type===64;)t=t.parent;return t}function RT(){return he.lFrame.currentTNode}function mL(){let t=he.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function au(t,e){let n=he.lFrame;n.currentTNode=t,n.isParent=e}function NT(){return he.lFrame.isParent}function _L(){he.lFrame.isParent=!1}function yL(t){return he.lFrame.bindingIndex=t}function cf(){return he.lFrame.bindingIndex++}function vL(t){let e=he.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function xL(){return he.lFrame.inI18n}function wL(t,e){let n=he.lFrame;n.bindingIndex=n.bindingRootIndex=t,Z_(e)}function EL(){return he.lFrame.currentDirectiveIndex}function Z_(t){he.lFrame.currentDirectiveIndex=t}function IL(t){let e=he.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function PT(t){he.lFrame.currentQueryIndex=t}function CL(t){let e=t[pe];return e.type===2?e.declTNode:e.type===1?t[Wn]:null}function kT(t,e,n){if(n&ae.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&ae.Host);)if(i=CL(s),i===null||(s=s[na],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=he.lFrame=OT();return r.currentTNode=e,r.lView=t,!0}function B0(t){let e=OT(),n=t[pe];he.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function OT(){let t=he.lFrame,e=t===null?null:t.child;return e===null?FT(t):e}function FT(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function VT(){let t=he.lFrame;return he.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var LT=VT;function U0(){let t=VT();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function bL(t){return(he.lFrame.contextLView=cL(t,he.lFrame.contextLView))[Gn]}function ra(){return he.lFrame.selectedIndex}function vs(t){he.lFrame.selectedIndex=t}function uf(){let t=he.lFrame;return TT(t.tView,t.selectedIndex)}function DL(){return he.lFrame.currentNamespace}var jT=!0;function $0(){return jT}function H0(t){jT=t}function TL(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=IT(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function q0(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:u,ngOnDestroy:l}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),c&&(t.viewHooks??=[]).push(-n,c),u&&((t.viewHooks??=[]).push(n,u),(t.viewCheckHooks??=[]).push(n,u)),l!=null&&(t.destroyHooks??=[]).push(n,l)}}function Th(t,e,n){BT(t,e,3,n)}function Sh(t,e,n,r){(t[z]&3)===n&&BT(t,e,n,r)}function R_(t,e){let n=t[z];(n&3)===e&&(n&=16383,n+=1,t[z]=n)}function BT(t,e,n,r){let i=r!==void 0?t[Uo]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(t[Uo]+=65536),(a<s||s==-1)&&(SL(t,n,e,c),t[Uo]=(t[Uo]&4294901760)+c+2),c++}function vD(t,e){cr(4,t,e);let n=we(null);try{e.call(t)}finally{we(n),cr(5,t,e)}}function SL(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[z]>>14<t[Uo]>>16&&(t[z]&3)===e&&(t[z]+=16384,vD(a,s)):vD(a,s)}var Go=-1,xs=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function AL(t){return t instanceof xs}function ML(t){return(t.flags&8)!==0}function RL(t){return(t.flags&16)!==0}function UT(t){return t!==Go}function jh(t){return t&32767}function NL(t){return t>>16}function Bh(t,e){let n=NL(t),r=e;for(;n>0;)r=r[na],n--;return r}var X_=!0;function xD(t){let e=X_;return X_=t,e}var PL=256,$T=PL-1,HT=5,kL=0,ur={};function OL(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(Wc)&&(r=n[Wc]),r==null&&(r=n[Wc]=kL++);let i=r&$T,s=1<<i;e.data[t+(i>>HT)]|=s}function Uh(t,e){let n=qT(t,e);if(n!==-1)return n;let r=e[pe];r.firstCreatePass&&(t.injectorIndex=e.length,N_(r.data,t),N_(e,null),N_(r.blueprint,null));let i=G0(t,e),s=t.injectorIndex;if(UT(i)){let o=jh(i),a=Bh(i,e),c=a[pe].data;for(let u=0;u<8;u++)e[s+u]=a[o+u]|c[o+u]}return e[s+8]=i,s}function N_(t,e){t.push(0,0,0,0,0,0,0,0,e)}function qT(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function G0(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=QT(i),r===null)return Go;if(n++,i=i[na],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return Go}function J_(t,e,n){OL(t,e,n)}function FL(t,e){if(e==="class")return t.classes;if(e==="style")return t.styles;let n=t.attrs;if(n){let r=n.length,i=0;for(;i<r;){let s=n[i];if(oT(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof n[i]=="string";)i++;else{if(s===e)return n[i+1];i=i+2}}}return null}function GT(t,e,n){if(n&ae.Optional||t!==void 0)return t;M0(e,"NodeInjector")}function zT(t,e,n,r){if(n&ae.Optional&&r===void 0&&(r=null),!(n&(ae.Self|ae.Host))){let i=t[Yo],s=Tn(void 0);try{return i?i.get(e,r,n&ae.Optional):eT(e,r,n&ae.Optional)}finally{Tn(s)}}return GT(r,e,n)}function WT(t,e,n,r=ae.Default,i){if(t!==null){if(e[z]&2048&&!(r&ae.Self)){let o=UL(t,e,n,r,ur);if(o!==ur)return o}let s=KT(t,e,n,r,ur);if(s!==ur)return s}return zT(e,n,r,i)}function KT(t,e,n,r,i){let s=jL(n);if(typeof s=="function"){if(!kT(e,t,r))return r&ae.Host?GT(i,n,r):zT(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&ae.Optional))M0(n);else return o}finally{LT()}}else if(typeof s=="number"){let o=null,a=qT(t,e),c=Go,u=r&ae.Host?e[dr][Wn]:null;for((a===-1||r&ae.SkipSelf)&&(c=a===-1?G0(t,e):e[a+8],c===Go||!ED(r,!1)?a=-1:(o=e[pe],a=jh(c),e=Bh(c,e)));a!==-1;){let l=e[pe];if(wD(s,a,l.data)){let d=VL(a,e,n,o,r,u);if(d!==ur)return d}c=e[a+8],c!==Go&&ED(r,e[pe].data[a+8]===u)&&wD(s,a,e)?(o=l,a=jh(c),e=Bh(c,e)):a=-1}}return i}function VL(t,e,n,r,i,s){let o=e[pe],a=o.data[t+8],c=r==null?af(a)&&X_:r!=o&&(a.type&3)!==0,u=i&ae.Host&&s===a,l=LL(a,o,n,c,u);return l!==null?Xo(e,o,l,a):ur}function LL(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,c=t.directiveStart,u=t.directiveEnd,l=s>>20,d=r?a:a+l,h=i?a+l:u;for(let f=d;f<h;f++){let p=o[f];if(f<c&&n===p||f>=c&&p.type===n)return f}if(i){let f=o[c];if(f&&yi(f)&&f.type===n)return c}return null}function Xo(t,e,n,r){let i=t[n],s=e.data;if(AL(i)){let o=i;o.resolving&&lV(uV(s[n]));let a=xD(o.canSeeViewProviders);o.resolving=!0;let c,u=o.injectImpl?Tn(o.injectImpl):null,l=kT(t,r,ae.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&TL(n,s[n],e)}finally{u!==null&&Tn(u),xD(a),o.resolving=!1,LT()}}return i}function jL(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(Wc)?t[Wc]:void 0;return typeof e=="number"?e>=0?e&$T:BL:e}function wD(t,e,n){let r=1<<t;return!!(n[e+(t>>HT)]&r)}function ED(t,e){return!(t&ae.Self)&&!(t&ae.Host&&e)}var ms=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return WT(this._tNode,this._lView,e,nf(r),n)}};function BL(){return new ms(rn(),Me())}function Ei(t){return su(()=>{let e=t.prototype.constructor,n=e[Rh]||e0(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[Rh]||e0(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function e0(t){return KD(t)?()=>{let e=e0(Lt(t));return e&&e()}:zo(t)}function UL(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[z]&2048&&!(o[z]&512);){let a=KT(s,o,n,r|ae.Self,ur);if(a!==ur)return a;let c=s.parent;if(!c){let u=o[vT];if(u){let l=u.get(n,ur,r);if(l!==ur)return l}c=QT(o),o=o[na]}s=c}return i}function QT(t){let e=t[pe],n=e.type;return n===2?e.declTNode:n===1?t[Wn]:null}function z0(t){return FL(rn(),t)}function ID(t,e=null,n=null,r){let i=YT(t,e,n,r);return i.resolveInjectorInitializers(),i}function YT(t,e=null,n=null,r,i=new Set){let s=[n||Sn,LV(t)];return r=r||(typeof t=="object"?void 0:Bt(t)),new Zc(s,e||O0(),r||null,i)}var Kn=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return ID({name:""},i,r,"");{let s=r.name??"";return ID({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=Qc,e.NULL=new kh,e.\u0275prov=V({token:e,providedIn:"any",factory:()=>E(rT)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})();var $L="ngOriginalError";function P_(t){return t[$L]}var fr=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&P_(e);for(;n&&P_(n);)n=P_(n);return n||null}},ZT=new O("",{providedIn:"root",factory:()=>P(fr).handleError.bind(void 0)}),W0=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=HL,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),t0=class extends W0{constructor(e){super(),this._lView=e}onDestroy(e){return AT(this._lView,e),()=>uL(this._lView,e)}};function HL(){return new t0(Me())}function qL(){return lf(rn(),Me())}function lf(t,e){return new pr(Mn(t,e))}var pr=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=qL;let t=e;return t})();var n0=class extends $e{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,yT()&&(this.destroyRef=P(W0,{optional:!0})??void 0)}emit(e){let n=we(null);try{super.next(e)}finally{we(n)}}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=k_(s),i&&(i=k_(i)),o&&(o=k_(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof ze&&e.add(a),a}};function k_(t){return e=>{setTimeout(t,void 0,e)}}var lt=n0;function XT(t){return(t.flags&128)===128}var r0;function JT(t){r0=t}function GL(){if(r0!==void 0)return r0;if(typeof document<"u")return document;throw new $(210,!1)}var df=new O("",{providedIn:"root",factory:()=>zL}),zL="ng",K0=new O(""),Rt=new O("",{providedIn:"platform",factory:()=>"unknown"});var Q0=new O("",{providedIn:"root",factory:()=>GL().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var WL="h",KL="b";var QL=()=>null;function Y0(t,e,n=!1){return QL(t,e,n)}var eS=!1,YL=new O("",{providedIn:"root",factory:()=>eS});var Eh;function ZL(){if(Eh===void 0&&(Eh=null,jt.trustedTypes))try{Eh=jt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Eh}function CD(t){return ZL()?.createScriptURL(t)||t}var $h=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${zD})`}};function cu(t){return t instanceof $h?t.changingThisBreaksApplicationSecurity:t}function Z0(t,e){let n=XL(t);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${zD})`)}return n===e}function XL(t){return t instanceof $h&&t.getTypeName()||null}var JL=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function tS(t){return t=String(t),t.match(JL)?t:"unsafe:"+t}var hf=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(hf||{});function e4(t){let e=rS();return e?e.sanitize(hf.URL,t)||"":Z0(t,"URL")?cu(t):tS(tf(t))}function t4(t){let e=rS();if(e)return CD(e.sanitize(hf.RESOURCE_URL,t)||"");if(Z0(t,"ResourceURL"))return CD(cu(t));throw new $(904,!1)}function n4(t,e){return e==="src"&&(t==="embed"||t==="frame"||t==="iframe"||t==="media"||t==="script")||e==="href"&&(t==="base"||t==="link")?t4:e4}function nS(t,e,n){return n4(e,n)(t)}function rS(){let t=Me();return t&&t[zn].sanitizer}var iS=new Map,r4=0;function i4(){return r4++}function s4(t){iS.set(t[of],t)}function o4(t){iS.delete(t[of])}var bD="__ngContext__";function ws(t,e){gs(e)?(t[bD]=e[of],s4(e)):t[bD]=e}function sS(t){return t instanceof Function?t():t}function a4(t){return(t??P(Kn)).get(Rt)==="browser"}var Br=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Br||{}),c4;function X0(t,e){return c4(t,e)}function $o(t,e,n,r,i){if(r!=null){let s,o=!1;qr(r)?s=r:gs(r)&&(o=!0,r=r[Hr]);let a=hr(r);t===0&&n!==null?i==null?lS(e,n,a):Hh(e,n,a,i||null,!0):t===1&&n!==null?Hh(e,n,a,i||null,!0):t===2?b4(e,a,o):t===3&&e.destroyNode(a),s!=null&&T4(e,t,s,n,i)}}function u4(t,e){return t.createText(e)}function l4(t,e,n){t.setValue(e,n)}function oS(t,e,n){return t.createElement(e,n)}function d4(t,e){aS(t,e),e[Hr]=null,e[Wn]=null}function h4(t,e,n,r,i,s){r[Hr]=i,r[Wn]=e,ff(t,r,n,1,i,s)}function aS(t,e){e[zn].changeDetectionScheduler?.notify(1),ff(t,e,e[Je],2,null,null)}function f4(t){let e=t[Jc];if(!e)return O_(t[pe],t);for(;e;){let n=null;if(gs(e))n=e[Jc];else{let r=e[An];r&&(n=r)}if(!n){for(;e&&!e[qn]&&e!==t;)gs(e)&&O_(e[pe],e),e=e[Mt];e===null&&(e=t),gs(e)&&O_(e[pe],e),n=e&&e[qn]}e=n}}function p4(t,e,n,r){let i=An+r,s=n.length;r>0&&(n[i-1][qn]=e),r<s-An?(e[qn]=n[i],nT(n,An+r,e)):(n.push(e),e[qn]=null),e[Mt]=n;let o=e[sf];o!==null&&n!==o&&g4(o,e);let a=e[Zo];a!==null&&a.insertView(t),Y_(e),e[z]|=128}function g4(t,e){let n=t[Vh],i=e[Mt][Mt][dr];e[dr]!==i&&(t[z]|=F0.HasTransplantedViews),n===null?t[Vh]=[e]:n.push(e)}function cS(t,e){let n=t[Vh],r=n.indexOf(e);n.splice(r,1)}function i0(t,e){if(t.length<=An)return;let n=An+e,r=t[n];if(r){let i=r[sf];i!==null&&i!==t&&cS(i,r),e>0&&(t[n-1][qn]=r[qn]);let s=Ph(t,An+e);d4(r[pe],r);let o=s[Zo];o!==null&&o.detachView(s[pe]),r[Mt]=null,r[qn]=null,r[z]&=-129}return r}function uS(t,e){if(!(e[z]&256)){let n=e[Je];n.destroyNode&&ff(t,e,n,3,null,null),f4(e)}}function O_(t,e){if(e[z]&256)return;let n=we(null);try{e[z]&=-129,e[z]|=256,e[_s]&&jb(e[_s]),_4(t,e),m4(t,e),e[pe].type===1&&e[Je].destroy();let r=e[sf];if(r!==null&&qr(e[Mt])){r!==e[Mt]&&cS(r,e);let i=e[Zo];i!==null&&i.detachView(t)}o4(e)}finally{we(n)}}function m4(t,e){let n=t.cleanup,r=e[Xc];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[Xc]=null);let i=e[gi];if(i!==null){e[gi]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function _4(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof xs)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];cr(4,a,c);try{c.call(a)}finally{cr(5,a,c)}}else{cr(4,i,s);try{s.call(i)}finally{cr(5,i,s)}}}}}function y4(t,e,n){return v4(t,e.parent,n)}function v4(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[Hr];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===lr.None||s===lr.Emulated)return null}return Mn(r,n)}}function Hh(t,e,n,r,i){t.insertBefore(e,n,r,i)}function lS(t,e,n){t.appendChild(e,n)}function DD(t,e,n,r,i){r!==null?Hh(t,e,n,r,i):lS(t,e,n)}function x4(t,e,n,r){t.removeChild(e,n,r)}function J0(t,e){return t.parentNode(e)}function w4(t,e){return t.nextSibling(e)}function E4(t,e,n){return C4(t,e,n)}function I4(t,e,n){return t.type&40?Mn(t,n):null}var C4=I4,TD;function ey(t,e,n,r){let i=y4(t,r,e),s=e[Je],o=r.parent||e[Wn],a=E4(o,r,e);if(i!=null)if(Array.isArray(n))for(let c=0;c<n.length;c++)DD(s,i,n[c],a,!1);else DD(s,i,n,a,!1);TD!==void 0&&TD(s,r,e,n,i)}function Ah(t,e){if(e!==null){let n=e.type;if(n&3)return Mn(e,t);if(n&4)return s0(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return Ah(t,r);{let i=t[e.index];return qr(i)?s0(-1,i):hr(i)}}else{if(n&32)return X0(e,t)()||hr(t[e.index]);{let r=dS(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=tu(t[dr]);return Ah(i,r)}else return Ah(t,e.next)}}}return null}function dS(t,e){if(e!==null){let r=t[dr][Wn],i=e.projection;return r.projection[i]}return null}function s0(t,e){let n=An+t+1;if(n<e.length){let r=e[n],i=r[pe].firstChild;if(i!==null)return Ah(r,i)}return e[ys]}function b4(t,e,n){let r=J0(t,e);r&&x4(t,r,e,n)}function ty(t,e,n,r,i,s,o){for(;n!=null;){let a=r[n.index],c=n.type;if(o&&e===0&&(a&&ws(hr(a),r),n.flags|=2),(n.flags&32)!==32)if(c&8)ty(t,e,n.child,r,i,s,!1),$o(e,t,i,a,s);else if(c&32){let u=X0(n,r),l;for(;l=u();)$o(e,t,i,l,s);$o(e,t,i,a,s)}else c&16?D4(t,e,r,n,i,s):$o(e,t,i,a,s);n=o?n.projectionNext:n.next}}function ff(t,e,n,r,i,s){ty(n,r,t.firstChild,e,i,s,!1)}function D4(t,e,n,r,i,s){let o=n[dr],c=o[Wn].projection[r.projection];if(Array.isArray(c))for(let u=0;u<c.length;u++){let l=c[u];$o(e,t,i,l,s)}else{let u=c,l=o[Mt];XT(r)&&(u.flags|=128),ty(t,e,u,l,i,s,!0)}}function T4(t,e,n,r,i){let s=n[ys],o=hr(n);s!==o&&$o(e,t,r,s,i);for(let a=An;a<n.length;a++){let c=n[a];ff(c[pe],c,t,e,r,s)}}function S4(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=r.indexOf("-")===-1?void 0:Br.DashCase;i==null?t.removeStyle(n,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Br.Important),t.setStyle(n,r,i,s))}}function A4(t,e,n){t.setAttribute(e,"style",n)}function hS(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function fS(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&G_(t,e,r),i!==null&&hS(t,e,i),s!==null&&A4(t,e,s)}var bs={};function G(t=1){pS(nn(),Me(),ra()+t,!1)}function pS(t,e,n,r){if(!r)if((e[z]&3)===3){let s=t.preOrderCheckHooks;s!==null&&Th(e,s,n)}else{let s=t.preOrderHooks;s!==null&&Sh(e,s,0,n)}vs(n)}function re(t,e=ae.Default){let n=Me();if(n===null)return E(t,e);let r=rn();return WT(r,n,Lt(t),e)}function gS(){let t="invalid";throw new Error(t)}function mS(t,e,n,r,i,s){let o=we(null);try{let a=null;i&Ut.SignalBased&&(a=e[r][s_]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&Ut.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,r):ET(e,a,r,s)}finally{we(o)}}function M4(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)vs(~i);else{let s=i,o=n[++r],a=n[++r];wL(o,s);let c=e[s];a(2,c)}}}finally{vs(-1)}}function pf(t,e,n,r,i,s,o,a,c,u,l){let d=e.blueprint.slice();return d[Hr]=i,d[z]=r|4|128|8|64,(u!==null||t&&t[z]&2048)&&(d[z]|=2048),ST(d),d[Mt]=d[na]=t,d[Gn]=n,d[zn]=o||t&&t[zn],d[Je]=a||t&&t[Je],d[Yo]=c||t&&t[Yo]||null,d[Wn]=s,d[of]=i4(),d[Oh]=l,d[vT]=u,d[dr]=e.type==2?t[dr]:d,d}function gf(t,e,n,r,i){let s=t.data[e];if(s===null)s=R4(t,e,n,r,i),xL()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=mL();s.injectorIndex=o===null?-1:o.injectorIndex}return au(s,!0),s}function R4(t,e,n,r,i){let s=RT(),o=NT(),a=o?s:s&&s.parent,c=t.data[e]=F4(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function _S(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function yS(t,e,n,r,i){let s=ra(),o=r&2;try{vs(-1),o&&e.length>_i&&pS(t,e,_i,!1),cr(o?2:0,i),n(r,i)}finally{vs(s),cr(o?3:1,i)}}function vS(t,e,n){if(wT(e)){let r=we(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];if(a.contentQueries){let c=n[o];a.contentQueries(1,c,o)}}}finally{we(r)}}}function xS(t,e,n){MT()&&($4(t,e,n,Mn(n,e)),(n.flags&64)===64&&bS(t,e,n))}function wS(t,e,n=Mn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function ES(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=ny(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function ny(t,e,n,r,i,s,o,a,c,u,l){let d=_i+r,h=d+i,f=N4(d,h),p=typeof u=="function"?u():u;return f[pe]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:l}}function N4(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:bs);return n}function P4(t,e,n,r){let s=r.get(YL,eS)||n===lr.ShadowDom,o=t.selectRootElement(e,s);return k4(o),o}function k4(t){O4(t)}var O4=()=>null;function F4(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return fL()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function SD(t,e,n,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=Ut.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let u=s;if(i!==null){if(!i.hasOwnProperty(s))continue;u=i[s]}t===0?AD(r,n,u,a,c):AD(r,n,u,a)}return r}function AD(t,e,n,r,i){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,r):s=t[n]=[e,r],i!==void 0&&s.push(i)}function V4(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],c=null,u=null;for(let l=r;l<i;l++){let d=s[l],h=n?n.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;c=SD(0,d.inputs,l,c,f),u=SD(1,d.outputs,l,u,p);let m=c!==null&&o!==null&&!P0(e)?J4(c,l,o):null;a.push(m)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=u}function L4(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function ry(t,e,n,r,i,s,o,a){let c=Mn(e,n),u=e.inputs,l;!a&&u!=null&&(l=u[r])?(iy(t,n,l,r,i),af(e)&&j4(n,e.index)):e.type&3?(r=L4(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(c,r,i)):e.type&12}function j4(t,e){let n=wi(e,t);n[z]&16||(n[z]|=64)}function IS(t,e,n,r){if(MT()){let i=r===null?null:{"":-1},s=q4(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&CS(t,e,n,o,i,a),i&&G4(n,r,i)}n.mergedAttrs=Yc(n.mergedAttrs,n.attrs)}function CS(t,e,n,r,i,s){for(let u=0;u<r.length;u++)J_(Uh(n,e),t,r[u].type);W4(n,t.data.length,r.length);for(let u=0;u<r.length;u++){let l=r[u];l.providersResolver&&l.providersResolver(l)}let o=!1,a=!1,c=_S(t,e,r.length,null);for(let u=0;u<r.length;u++){let l=r[u];n.mergedAttrs=Yc(n.mergedAttrs,l.hostAttrs),K4(t,n,e,c,l),z4(c,l,i),l.contentQueries!==null&&(n.flags|=4),(l.hostBindings!==null||l.hostAttrs!==null||l.hostVars!==0)&&(n.flags|=64);let d=l.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),c++}V4(t,n,s)}function B4(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;U4(o)!=a&&o.push(a),o.push(n,r,s)}}function U4(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function $4(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;af(n)&&Q4(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||Uh(n,e),ws(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let c=t.data[a],u=Xo(e,t,a,n);if(ws(u,e),o!==null&&X4(e,a-i,u,c,n,o),yi(c)){let l=wi(n.index,e);l[Gn]=Xo(e,t,a,n)}}}function bS(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=EL();try{vs(s);for(let a=r;a<i;a++){let c=t.data[a],u=e[a];Z_(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&H4(c,u)}}finally{vs(-1),Z_(o)}}function H4(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function q4(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(AV(e,o.selectors,!1))if(r||(r=[]),yi(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;o0(t,e,c)}else r.unshift(o),o0(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function o0(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function G4(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new $(-301,!1);r.push(e[i],s)}}}function z4(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;yi(e)&&(n[""]=t)}}function W4(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function K4(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=zo(i.type,!0)),o=new xs(s,yi(i),re);t.blueprint[r]=o,n[r]=o,B4(t,e,r,_S(t,n,i.hostVars,bs),i)}function Q4(t,e,n){let r=Mn(e,t),i=ES(n),s=t[zn].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=mf(t,pf(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function Y4(t,e,n,r,i,s){let o=Mn(t,e);Z4(e[Je],o,s,t.value,n,r,i)}function Z4(t,e,n,r,i,s,o){if(s==null)t.removeAttribute(e,i,n);else{let a=o==null?tf(s):o(s,r||"",i);t.setAttribute(e,i,a,n)}}function X4(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],u=o[a++],l=o[a++],d=o[a++];mS(r,n,c,u,l,d)}}function J4(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],n[i+1]);break}}i+=2}return r}function DS(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function TS(t,e){let n=t.contentQueries;if(n!==null){let r=we(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];PT(s),a.contentQueries(2,e[o],o)}}}finally{we(r)}}}function mf(t,e){return t[Jc]?t[_D][qn]=e:t[Jc]=e,t[_D]=e,e}function a0(t,e,n){PT(0);let r=we(null);try{e(t,n)}finally{we(r)}}function e5(t){return t[Xc]||(t[Xc]=[])}function t5(t){return t.cleanup||(t.cleanup=[])}function SS(t,e){let n=t[Yo],r=n?n.get(fr,null):null;r&&r.handleError(e)}function iy(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],c=n[s++],u=e[o],l=t.data[o];mS(l,u,r,a,c,i)}}function n5(t,e,n){let r=DT(e,t);l4(t[Je],r,n)}function r5(t,e){let n=wi(e,t),r=n[pe];i5(r,n);let i=n[Hr];i!==null&&n[Oh]===null&&(n[Oh]=Y0(i,n[Yo])),sy(r,n,n[Gn])}function i5(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function sy(t,e,n){B0(e);try{let r=t.viewQuery;r!==null&&a0(1,r,n);let i=t.template;i!==null&&yS(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[Zo]?.finishViewCreation(t),t.staticContentQueries&&TS(t,e),t.staticViewQueries&&a0(2,t.viewQuery,n);let s=t.components;s!==null&&s5(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[z]&=-5,U0()}}function s5(t,e){for(let n=0;n<e.length;n++)r5(t,e[n])}function o5(t,e,n,r){let i=we(null);try{let s=e.tView,a=t[z]&4096?4096:16,c=pf(t,s,n,a,null,e,null,null,null,r?.injector??null,r?.dehydratedView??null),u=t[e.index];c[sf]=u;let l=t[Zo];return l!==null&&(c[Zo]=l.createEmbeddedView(s)),sy(s,c,n),c}finally{we(i)}}function MD(t,e){return!e||e.firstChild===null||XT(t)}function a5(t,e,n,r=!0){let i=e[pe];if(p4(i,e,t,n),r){let o=s0(n,t),a=e[Je],c=J0(a,t[ys]);c!==null&&h4(i,t[Wn],a,e,c,o)}let s=e[Oh];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function qh(t,e,n,r,i=!1){for(;n!==null;){let s=e[n.index];s!==null&&r.push(hr(s)),qr(s)&&c5(s,r);let o=n.type;if(o&8)qh(t,e,n.child,r);else if(o&32){let a=X0(n,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=dS(e,n);if(Array.isArray(a))r.push(...a);else{let c=tu(e[dr]);qh(c[pe],c,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function c5(t,e){for(let n=An;n<t.length;n++){let r=t[n],i=r[pe].firstChild;i!==null&&qh(r[pe],r,i,e)}t[ys]!==t[Hr]&&e.push(t[ys])}var AS=[];function u5(t){return t[_s]??l5(t)}function l5(t){let e=AS.pop()??Object.create(h5);return e.lView=t,e}function d5(t){t.lView[_s]!==t&&(t.lView=null,AS.push(t))}var h5=ue(A({},Fb),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{eu(t.lView)},consumerOnSignalRead(){this.lView[_s]=this}});function MS(t){return NS(t[Jc])}function RS(t){return NS(t[qn])}function NS(t){for(;t!==null&&!qr(t);)t=t[qn];return t}var PS=100;function kS(t,e=!0,n=0){let r=t[zn],i=r.rendererFactory,s=!1;s||i.begin?.();try{f5(t,n)}catch(o){throw e&&SS(t,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function f5(t,e){c0(t,e);let n=0;for(;j0(t);){if(n===PS)throw new $(103,!1);n++,c0(t,1)}}function p5(t,e,n,r){let i=e[z];if((i&256)===256)return;let s=!1;!s&&e[zn].inlineEffectRunner?.flush(),B0(e);let o=null,a=null;!s&&g5(t)&&(a=u5(e),o=Vb(a));try{ST(e),yL(t.bindingStartIndex),n!==null&&yS(t,e,n,2,r);let c=(i&3)===3;if(!s)if(c){let d=t.preOrderCheckHooks;d!==null&&Th(e,d,null)}else{let d=t.preOrderHooks;d!==null&&Sh(e,d,0,null),R_(e,0)}if(m5(e),OS(e,0),t.contentQueries!==null&&TS(t,e),!s)if(c){let d=t.contentCheckHooks;d!==null&&Th(e,d)}else{let d=t.contentHooks;d!==null&&Sh(e,d,1),R_(e,1)}M4(t,e);let u=t.components;u!==null&&VS(e,u,0);let l=t.viewQuery;if(l!==null&&a0(2,l,r),!s)if(c){let d=t.viewCheckHooks;d!==null&&Th(e,d)}else{let d=t.viewHooks;d!==null&&Sh(e,d,2),R_(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[M_]){for(let d of e[M_])d();e[M_]=null}s||(e[z]&=-73)}catch(c){throw eu(e),c}finally{a!==null&&(Lb(a,o),d5(a)),U0()}}function g5(t){return t.type!==2}function OS(t,e){for(let n=MS(t);n!==null;n=RS(n))for(let r=An;r<n.length;r++){let i=n[r];FS(i,e)}}function m5(t){for(let e=MS(t);e!==null;e=RS(e)){if(!(e[z]&F0.HasTransplantedViews))continue;let n=e[Vh];for(let r=0;r<n.length;r++){let i=n[r],s=i[Mt];aL(i)}}}function _5(t,e,n){let r=wi(e,t);FS(r,n)}function FS(t,e){L0(t)&&c0(t,e)}function c0(t,e){let r=t[pe],i=t[z],s=t[_s],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&o_(s)),s&&(s.dirty=!1),t[z]&=-9217,o)p5(r,t,r.template,t[Gn]);else if(i&8192){OS(t,1);let a=r.components;a!==null&&VS(t,a,1)}}function VS(t,e,n){for(let r=0;r<e.length;r++)_5(t,e[r],n)}function oy(t){for(t[zn].changeDetectionScheduler?.notify();t;){t[z]|=64;let e=tu(t);if(XV(t)&&!e)return t;t=e}return null}var Es=class{get rootNodes(){let e=this._lView,n=e[pe];return qh(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Gn]}set context(e){this._lView[Gn]=e}get destroyed(){return(this._lView[z]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Mt];if(qr(e)){let n=e[Fh],r=n?n.indexOf(this):-1;r>-1&&(i0(e,r),Ph(n,r))}this._attachedToViewContainer=!1}uS(this._lView[pe],this._lView)}onDestroy(e){AT(this._lView,e)}markForCheck(){oy(this._cdRefInjectingView||this._lView)}detach(){this._lView[z]&=-129}reattach(){Y_(this._lView),this._lView[z]|=128}detectChanges(){this._lView[z]|=1024,kS(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new $(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,aS(this._lView[pe],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new $(902,!1);this._appRef=e,Y_(this._lView)}},_f=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=x5;let t=e;return t})(),y5=_f,v5=class extends y5{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=o5(this._declarationLView,this._declarationTContainer,e,{injector:n,dehydratedView:r});return new Es(i)}};function x5(){return w5(rn(),Me())}function w5(t,e){return t.type&4?new v5(e,t,lf(t,e)):null}var ZX=new RegExp(`^(\\d+)*(${KL}|${WL})*(.*)`);var E5=()=>null;function RD(t,e){return E5(t,e)}var Gh=class{},u0=class{},zh=class{};function I5(t){let e=Error(`No component factory found for ${Bt(t)}.`);return e[C5]=t,e}var C5="ngComponent";var l0=class{resolveComponentFactory(e){throw I5(e)}},yf=(()=>{let e=class e{};e.NULL=new l0;let t=e;return t})(),nu=class{},Gr=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>b5();let t=e;return t})();function b5(){let t=Me(),e=rn(),n=wi(e.index,t);return(gs(n)?n:t)[Je]}var D5=(()=>{let e=class e{};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),F_={};var ND=new Set;function ay(t){ND.has(t)||(ND.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function PD(...t){}function T5(){let t=typeof jt.requestAnimationFrame=="function",e=jt[t?"requestAnimationFrame":"setTimeout"],n=jt[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var de=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new lt(!1),this.onMicrotaskEmpty=new lt(!1),this.onStable=new lt(!1),this.onError=new lt(!1),typeof Zone>"u")throw new $(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=T5().nativeRequestAnimationFrame,M5(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new $(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new $(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,S5,PD,PD);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},S5={};function cy(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function A5(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(jt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,d0(t),t.isCheckStableRunning=!0,cy(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),d0(t))}function M5(t){let e=()=>{A5(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(R5(a))return n.invokeTask(i,s,o,a);try{return kD(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),OD(t)}},onInvoke:(n,r,i,s,o,a,c)=>{try{return kD(t),n.invoke(i,s,o,a,c)}finally{t.shouldCoalesceRunChangeDetection&&e(),OD(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,d0(t),cy(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function d0(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function kD(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function OD(t){t._nesting--,cy(t)}var h0=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new lt,this.onMicrotaskEmpty=new lt,this.onStable=new lt,this.onError=new lt}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}};function R5(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}function N5(t="zone.js",e){return t==="noop"?new h0:t==="zone.js"?new de(e):t}var Ho=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(Ho||{}),P5={destroy(){}};function uy(t,e){!e&&QV(uy);let n=e?.injector??P(Kn);if(!a4(n))return P5;ay("NgAfterNextRender");let r=n.get(ly),i=r.handler??=new p0,s=e?.phase??Ho.MixedReadWrite,o=()=>{i.unregister(c),a()},a=n.get(W0).onDestroy(o),c=$r(n,()=>new f0(s,()=>{o(),t()}));return i.register(c),{destroy:o}}var f0=class{constructor(e,n){this.phase=e,this.callbackFn=n,this.zone=P(de),this.errorHandler=P(fr,{optional:!0}),P(Gh,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},p0=class{constructor(){this.executingCallbacks=!1,this.buckets={[Ho.EarlyRead]:new Set,[Ho.Write]:new Set,[Ho.MixedReadWrite]:new Set,[Ho.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let n of e)n.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},ly=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function g0(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=aD(i,a);else if(s==2){let c=a,u=e[++o];r=aD(r,c+": "+u+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var Wh=class extends yf{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=mi(e);return new Jo(n,this.ngModule)}};function FD(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let r=t[n];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:n})}return e}function k5(t){let e=t.toLowerCase();return e==="svg"?nL:e==="math"?rL:null}var m0=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=nf(r);let i=this.injector.get(e,F_,r);return i!==F_||n===F_?i:this.parentInjector.get(e,n,r)}},Jo=class extends zh{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=FD(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return FD(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=PV(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){let s=we(null);try{i=i||this.ngModule;let o=i instanceof hn?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new m0(e,o):e,c=a.get(nu,null);if(c===null)throw new $(407,!1);let u=a.get(D5,null),l=a.get(ly,null),d=a.get(Gh,null),h={rendererFactory:c,sanitizer:u,inlineEffectRunner:null,afterRenderEventManager:l,changeDetectionScheduler:d},f=c.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",m=r?P4(f,r,this.componentDef.encapsulation,a):oS(f,p,k5(p)),v=512;this.componentDef.signals?v|=4096:this.componentDef.onPush||(v|=16);let b=null;m!==null&&(b=Y0(m,a,!0));let F=ny(0,null,null,1,0,null,null,null,null,null,null),T=pf(null,F,null,v,null,null,h,f,a,null,b);B0(T);let H,W;try{let Z=this.componentDef,be,Xt=null;Z.findHostDirectiveDefs?(be=[],Xt=new Map,Z.findHostDirectiveDefs(Z,be,Xt),be.push(Z)):be=[Z];let Zm=O5(T,m),jd=F5(Zm,m,Z,be,T,h,f);W=TT(F,_i),m&&j5(f,Z,m,r),n!==void 0&&B5(W,this.ngContentSelectors,n),H=L5(jd,Z,be,Xt,T,[U5]),sy(F,T,null)}finally{U0()}return new _0(this.componentType,H,lf(W,T),T,W)}finally{we(s)}}},_0=class extends u0{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new Es(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;iy(s[pe],s,i,e,n),this.previousInputValues.set(e,n);let o=wi(this._tNode.index,s);oy(o)}}get injector(){return new ms(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function O5(t,e){let n=t[pe],r=_i;return t[r]=e,gf(n,r,2,"#host",null)}function F5(t,e,n,r,i,s,o){let a=i[pe];V5(r,t,e,o);let c=null;e!==null&&(c=Y0(e,i[Yo]));let u=s.rendererFactory.createRenderer(e,n),l=16;n.signals?l=4096:n.onPush&&(l=64);let d=pf(i,ES(n),null,l,i[t.index],t,s,u,null,null,c);return a.firstCreatePass&&o0(a,t,r.length-1),mf(i,d),i[t.index]=d}function V5(t,e,n,r){for(let i of t)e.mergedAttrs=Yc(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(g0(e,e.mergedAttrs,!0),n!==null&&fS(r,n,e))}function L5(t,e,n,r,i,s){let o=rn(),a=i[pe],c=Mn(o,i);CS(a,i,o,n,null,r);for(let l=0;l<n.length;l++){let d=o.directiveStart+l,h=Xo(i,a,d,o);ws(h,i)}bS(a,i,o),c&&ws(c,i);let u=Xo(i,a,o.directiveStart+o.componentOffset,o);if(t[Gn]=i[Gn]=u,s!==null)for(let l of s)l(u,e);return vS(a,o,i),u}function j5(t,e,n,r){if(r)G_(t,n,["ng-version","17.3.0"]);else{let{attrs:i,classes:s}=kV(e.selectors[0]);i&&G_(t,n,i),s&&s.length>0&&hS(t,n,s.join(" "))}}function B5(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function U5(){let t=rn();q0(Me()[pe],t)}var ia=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=$5;let t=e;return t})();function $5(){let t=rn();return q5(t,Me())}var H5=ia,LS=class extends H5{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return lf(this._hostTNode,this._hostLView)}get injector(){return new ms(this._hostTNode,this._hostLView)}get parentInjector(){let e=G0(this._hostTNode,this._hostLView);if(UT(e)){let n=Bh(e,this._hostLView),r=jh(e),i=n[pe].data[r+8];return new ms(i,n)}else return new ms(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=VD(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-An}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=RD(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,MD(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!ZV(e),a;if(o)a=n;else{let p=n||{};a=p.index,r=p.injector,i=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let c=o?e:new Jo(mi(e)),u=r||this.parentInjector;if(!s&&c.ngModule==null){let m=(o?u:this.parentInjector).get(hn,null);m&&(s=m)}let l=mi(c.componentType??{}),d=RD(this._lContainer,l?.id??null),h=d?.firstChild??null,f=c.create(u,i,h,s);return this.insertImpl(f.hostView,a,MD(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(oL(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[Mt],u=new LS(c,c[Wn],c[Mt]);u.detach(u.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return a5(o,i,s,r),e.attachToViewContainerRef(),nT(V_(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=VD(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=i0(this._lContainer,n);r&&(Ph(V_(this._lContainer),n),uS(r[pe],r))}detach(e){let n=this._adjustIndex(e,-1),r=i0(this._lContainer,n);return r&&Ph(V_(this._lContainer),n)!=null?new Es(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function VD(t){return t[Fh]}function V_(t){return t[Fh]||(t[Fh]=[])}function q5(t,e){let n,r=e[t.index];return qr(r)?n=r:(n=DS(r,e,null,t),e[t.index]=n,mf(e,n)),z5(n,e,t,r),new LS(n,t,e)}function G5(t,e){let n=t[Je],r=n.createComment(""),i=Mn(e,t),s=J0(n,i);return Hh(n,s,r,w4(n,i),!1),r}var z5=Q5,W5=()=>!1;function K5(t,e,n){return W5(t,e,n)}function Q5(t,e,n,r){if(t[ys])return;let i;n.type&8?i=hr(r):i=G5(e,n),t[ys]=i}function Y5(t){return typeof t=="function"&&t[s_]!==void 0}function jS(t){return Y5(t)&&typeof t.set=="function"}function Z5(t){let e=[],n=new Map;function r(i){let s=n.get(i);if(!s){let o=t(i);n.set(i,s=o.then(t3))}return s}return Kh.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(u=>{i.template=u}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let u=i.styles.length,l=i.styleUrls;i.styleUrls.forEach((d,h)=>{a.push(""),o.push(r(d).then(f=>{a[u+h]=f,l.splice(l.indexOf(d),1),l.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(u=>{a.push(u),i.styleUrl=void 0}));let c=Promise.all(o).then(()=>n3(s));e.push(c)}),J5(),Promise.all(e).then(()=>{})}var Kh=new Map,X5=new Set;function J5(){let t=Kh;return Kh=new Map,t}function e3(){return Kh.size===0}function t3(t){return typeof t=="string"?t:t.text()}function n3(t){X5.delete(t)}function r3(t){return Object.getPrototypeOf(t.prototype).constructor}function zr(t){let e=r3(t.type),n=!0,r=[t];for(;e;){let i;if(yi(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new $(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let o=t;o.inputs=Ih(t.inputs),o.inputTransforms=Ih(t.inputTransforms),o.declaredInputs=Ih(t.declaredInputs),o.outputs=Ih(t.outputs);let a=i.hostBindings;a&&c3(t,a);let c=i.viewQuery,u=i.contentQueries;if(c&&o3(t,c),u&&a3(t,u),i3(t,i),tV(t.outputs,i.outputs),yi(i)&&i.data.animation){let l=t.data;l.animation=(l.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(t),a===zr&&(n=!1)}}e=Object.getPrototypeOf(e)}s3(r)}function i3(t,e){for(let n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;let r=e.inputs[n];if(r!==void 0&&(t.inputs[n]=r,t.declaredInputs[n]=e.declaredInputs[n],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;t.inputTransforms??={},t.inputTransforms[i]=e.inputTransforms[i]}}}function s3(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Yc(i.hostAttrs,n=Yc(n,i.hostAttrs))}}function Ih(t){return t===Wo?{}:t===Sn?[]:t}function o3(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function a3(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,s)=>{e(r,i,s),n(r,i,s)}:t.contentQueries=e}function c3(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}function dy(t){let e=t.inputConfig,n={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(n[r]=i[3])}t.inputTransforms=n}var vi=class{},ru=class{};var Qh=class extends vi{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Wh(this);let i=dT(e);this._bootstrapComponents=sS(i.bootstrap),this._r3Injector=YT(e,n,[{provide:vi,useValue:this},{provide:yf,useValue:this.componentFactoryResolver},...r],Bt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Yh=class extends ru{constructor(e){super(),this.moduleType=e}create(e){return new Qh(this.moduleType,e,[])}};function u3(t,e,n){return new Qh(t,e,n)}var y0=class extends vi{constructor(e){super(),this.componentFactoryResolver=new Wh(this),this.instance=null;let n=new Zc([...e.providers,{provide:vi,useValue:this},{provide:yf,useValue:this.componentFactoryResolver}],e.parent||O0(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function vf(t,e,n=null){return new y0({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var xf=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new It(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function BS(t){return d3(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function l3(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{let n=t[Symbol.iterator](),r;for(;!(r=n.next()).done;)e(r.value)}}function d3(t){return t!==null&&(typeof t=="function"||typeof t=="object")}function uu(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function h3(t){return(t.flags&32)===32}function f3(t,e,n,r,i,s,o,a,c){let u=e.consts,l=gf(e,t,4,o||null,Lh(u,a));IS(e,n,l,Lh(u,c)),q0(e,l);let d=l.tView=ny(2,l,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u,null);return e.queries!==null&&(e.queries.template(e,l),d.queries=e.queries.embeddedTView(l)),l}function sn(t,e,n,r,i,s,o,a){let c=Me(),u=nn(),l=t+_i,d=u.firstCreatePass?f3(l,u,c,e,n,r,i,s,o):u.data[l];au(d,!1);let h=p3(u,c,d,t);$0()&&ey(u,c,h,d),ws(h,c);let f=DS(h,c,h,d);return c[l]=f,mf(c,f),K5(f,d,c),V0(d)&&xS(u,c,d),o!=null&&wS(c,d,a),sn}var p3=g3;function g3(t,e,n,r){return H0(!0),e[Je].createComment("")}function wf(t,e,n,r){let i=Me(),s=cf();if(uu(i,s,e)){let o=nn(),a=uf();Y4(a,i,t,e,n,r)}return wf}function US(t,e,n,r){return uu(t,cf(),n)?e+tf(n)+r:bs}function Ch(t,e){return t<<17|e<<2}function Is(t){return t>>17&32767}function m3(t){return(t&2)==2}function _3(t,e){return t&131071|e<<17}function v0(t){return t|2}function ea(t){return(t&131068)>>2}function L_(t,e){return t&-131069|e<<2}function y3(t){return(t&1)===1}function x0(t){return t|1}function v3(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=Is(o),c=ea(o);t[r]=n;let u=!1,l;if(Array.isArray(n)){let d=n;l=d[1],(l===null||ou(d,l)>0)&&(u=!0)}else l=n;if(i)if(c!==0){let h=Is(t[a+1]);t[r+1]=Ch(h,a),h!==0&&(t[h+1]=L_(t[h+1],r)),t[a+1]=_3(t[a+1],r)}else t[r+1]=Ch(a,0),a!==0&&(t[a+1]=L_(t[a+1],r)),a=r;else t[r+1]=Ch(c,0),a===0?a=r:t[c+1]=L_(t[c+1],r),c=r;u&&(t[r+1]=v0(t[r+1])),LD(t,l,r,!0),LD(t,l,r,!1),x3(e,l,t,r,s),o=Ch(a,c),s?e.classBindings=o:e.styleBindings=o}function x3(t,e,n,r,i){let s=i?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&ou(s,e)>=0&&(n[r+1]=x0(n[r+1]))}function LD(t,e,n,r){let i=t[n+1],s=e===null,o=r?Is(i):ea(i),a=!1;for(;o!==0&&(a===!1||s);){let c=t[o],u=t[o+1];w3(c,e)&&(a=!0,t[o+1]=r?x0(u):v0(u)),o=r?Is(u):ea(u)}a&&(t[n+1]=r?v0(i):x0(i))}function w3(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?ou(t,e)>=0:!1}function Re(t,e,n){let r=Me(),i=cf();if(uu(r,i,e)){let s=nn(),o=uf();ry(s,o,r,t,e,r[Je],n,!1)}return Re}function jD(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";iy(t,n,s[o],o,r)}function hy(t,e){return E3(t,e,null,!0),hy}function E3(t,e,n,r){let i=Me(),s=nn(),o=vL(2);if(s.firstUpdatePass&&C3(s,t,o,r),e!==bs&&uu(i,o,e)){let a=s.data[ra()];A3(s,a,i,i[Je],t,i[o+1]=M3(e,n),r,o)}}function I3(t,e){return e>=t.expandoStartIndex}function C3(t,e,n,r){let i=t.data;if(i[n+1]===null){let s=i[ra()],o=I3(t,n);R3(s,r)&&e===null&&!o&&(e=!1),e=b3(i,s,e,r),v3(i,s,e,n,o,r)}}function b3(t,e,n,r){let i=IL(t),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=j_(null,t,e,n,r),n=iu(n,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==i)if(n=j_(i,t,e,n,r),s===null){let c=D3(t,e,r);c!==void 0&&Array.isArray(c)&&(c=j_(null,t,e,c[1],r),c=iu(c,e.attrs,r),T3(t,e,r,c))}else s=S3(t,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),n}function D3(t,e,n){let r=n?e.classBindings:e.styleBindings;if(ea(r)!==0)return t[Is(r)]}function T3(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[Is(i)]=r}function S3(t,e,n){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=t[s].hostAttrs;r=iu(r,o,n)}return iu(r,e.attrs,n)}function j_(t,e,n,r,i){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],r=iu(r,s.hostAttrs,i),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function iu(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),wV(t,o,n?!0:e[++s]))}return t===void 0?null:t}function A3(t,e,n,r,i,s,o,a){if(!(e.type&3))return;let c=t.data,u=c[a+1],l=y3(u)?BD(c,e,n,i,ea(u),o):void 0;if(!Zh(l)){Zh(s)||m3(u)&&(s=BD(c,null,n,i,a,o));let d=DT(ra(),n);S4(r,o,d,i,s)}}function BD(t,e,n,r,i,s){let o=e===null,a;for(;i>0;){let c=t[i],u=Array.isArray(c),l=u?c[1]:c,d=l===null,h=n[i+1];h===bs&&(h=d?Sn:void 0);let f=d?S_(h,r):l===r?h:void 0;if(u&&!Zh(f)&&(f=S_(c,r)),Zh(f)&&(a=f,o))return a;let p=t[i+1];i=o?Is(p):ea(p)}if(e!==null){let c=s?e.residualClasses:e.residualStyles;c!=null&&(a=S_(c,r))}return a}function Zh(t){return t!==void 0}function M3(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=Bt(cu(t)))),t}function R3(t,e){return(t.flags&(e?8:16))!==0}function N3(t,e,n,r,i,s){let o=e.consts,a=Lh(o,i),c=gf(e,t,2,r,a);return IS(e,n,c,Lh(o,s)),c.attrs!==null&&g0(c,c.attrs,!1),c.mergedAttrs!==null&&g0(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function x(t,e,n,r){let i=Me(),s=nn(),o=_i+t,a=i[Je],c=s.firstCreatePass?N3(o,s,i,e,n,r):s.data[o],u=P3(s,i,c,a,e,t);i[o]=u;let l=V0(c);return au(c,!0),fS(a,u,c),!h3(c)&&$0()&&ey(s,i,u,c),lL()===0&&ws(u,i),dL(),l&&(xS(s,i,c),vS(s,c,i)),r!==null&&wS(i,c),x}function C(){let t=rn();NT()?_L():(t=t.parent,au(t,!1));let e=t;pL(e)&&gL(),hL();let n=nn();return n.firstCreatePass&&(q0(n,t),wT(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&ML(e)&&jD(n,e,Me(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&RL(e)&&jD(n,e,Me(),e.stylesWithoutHost,!1),C}function on(t,e,n,r){return x(t,e,n,r),C(),on}var P3=(t,e,n,r,i,s)=>(H0(!0),oS(r,i,DL()));function qt(){return Me()}var Xh="en-US";var k3=Xh;function O3(t){typeof t=="string"&&(k3=t.toLowerCase().replace(/_/g,"-"))}function Ve(t,e,n,r){let i=Me(),s=nn(),o=rn();return $S(s,i,i[Je],o,t,e,r),Ve}function F3(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[Xc],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function $S(t,e,n,r,i,s,o){let a=V0(r),u=t.firstCreatePass&&t5(t),l=e[Gn],d=e5(e),h=!0;if(r.type&3||o){let m=Mn(r,e),v=o?o(m):m,b=d.length,F=o?H=>o(hr(H[r.index])):r.index,T=null;if(!o&&a&&(T=F3(t,e,i,r.index)),T!==null){let H=T.__ngLastListenerFn__||T;H.__ngNextListenerFn__=s,T.__ngLastListenerFn__=s,h=!1}else{s=$D(r,e,l,s,!1);let H=n.listen(v,i,s);d.push(s,H),u&&u.push(i,F,b,b+1)}}else s=$D(r,e,l,s,!1);let f=r.outputs,p;if(h&&f!==null&&(p=f[i])){let m=p.length;if(m)for(let v=0;v<m;v+=2){let b=p[v],F=p[v+1],W=e[b][F].subscribe(s),Z=d.length;d.push(s,W),u&&u.push(i,r.index,Z,-(Z+1))}}}function UD(t,e,n,r){let i=we(null);try{return cr(6,e,n),n(r)!==!1}catch(s){return SS(t,s),!1}finally{cr(7,e,n),we(i)}}function $D(t,e,n,r,i){return function s(o){if(o===Function)return r;let a=t.componentOffset>-1?wi(t.index,e):e;oy(a);let c=UD(e,n,r,o),u=s.__ngNextListenerFn__;for(;u;)c=UD(e,n,u,o)&&c,u=u.__ngNextListenerFn__;return i&&c===!1&&o.preventDefault(),c}}function ft(t=1){return bL(t)}function Ds(t,e,n){return HS(t,"",e,"",n),Ds}function HS(t,e,n,r,i){let s=Me(),o=US(s,e,n,r);if(o!==bs){let a=nn(),c=uf();ry(a,c,s,t,o,s[Je],i,!1)}return HS}function S(t,e=""){let n=Me(),r=nn(),i=t+_i,s=r.firstCreatePass?gf(r,i,1,e,null):r.data[i],o=V3(r,n,s,e,t);n[i]=o,$0()&&ey(r,n,o,s),au(s,!1)}var V3=(t,e,n,r,i)=>(H0(!0),u4(e[Je],r));function Dt(t){return lu("",t,""),Dt}function lu(t,e,n){let r=Me(),i=US(r,t,e,n);return i!==bs&&n5(r,ra(),i),lu}function an(t,e,n){jS(e)&&(e=e());let r=Me(),i=cf();if(uu(r,i,e)){let s=nn(),o=uf();ry(s,o,r,t,e,r[Je],n,!1)}return an}function fn(t,e){let n=jS(t);return n&&t.set(e),n}function cn(t,e){let n=Me(),r=nn(),i=rn();return $S(r,n,n[Je],i,t,e),cn}function L3(t,e,n){let r=nn();if(r.firstCreatePass){let i=yi(t);w0(n,r.data,r.blueprint,i,!0),w0(e,r.data,r.blueprint,i,!1)}}function w0(t,e,n,r,i){if(t=Lt(t),Array.isArray(t))for(let s=0;s<t.length;s++)w0(t[s],e,n,r,i);else{let s=nn(),o=Me(),a=rn(),c=Qo(t)?t:Lt(t.provide),u=_T(t),l=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(Qo(t)||!t.multi){let f=new xs(u,i,re),p=U_(c,e,i?l:l+h,d);p===-1?(J_(Uh(a,o),s,c),B_(s,t,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(f),o.push(f)):(n[p]=f,o[p]=f)}else{let f=U_(c,e,l+h,d),p=U_(c,e,l,l+h),m=f>=0&&n[f],v=p>=0&&n[p];if(i&&!v||!i&&!m){J_(Uh(a,o),s,c);let b=U3(i?B3:j3,n.length,i,r,u);!i&&v&&(n[p].providerFactory=b),B_(s,t,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(b),o.push(b)}else{let b=qS(n[i?p:f],u,!i&&r);B_(s,t,f>-1?f:p,b)}!i&&r&&v&&n[p].componentProviders++}}}function B_(t,e,n,r){let i=Qo(e),s=$V(e);if(i||s){let c=(s?Lt(e.useClass):e).prototype.ngOnDestroy;if(c){let u=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let l=u.indexOf(n);l===-1?u.push(n,[r,c]):u[l+1].push(r,c)}else u.push(n,c)}}}function qS(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function U_(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function j3(t,e,n,r){return E0(this.multi,[])}function B3(t,e,n,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=Xo(n,n[pe],this.providerFactory.index,r);s=a.slice(0,o),E0(i,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],E0(i,s);return s}function E0(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function U3(t,e,n,r,i){let s=new xs(t,n,re);return s.multi=[],s.index=e,s.componentProviders=0,qS(s,i,r&&!n),s}function sa(t,e=[]){return n=>{n.providersResolver=(r,i)=>L3(r,i?i(t):t,e)}}var $3=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=pT(!1,r.type),s=i.length>0?vf([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=V({token:e,providedIn:"environment",factory:()=>new e(E(hn))});let t=e;return t})();function GS(t){ay("NgStandalone"),t.getStandaloneInjector=e=>e.get($3).getOrCreateStandaloneInjector(t)}var bh=null;function H3(t){bh!==null&&(t.defaultEncapsulation!==bh.defaultEncapsulation||t.preserveWhitespaces!==bh.preserveWhitespaces)||(bh=t)}var Ur=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},zS=new Ur("17.3.0"),Ef=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();var fy=new O(""),du=new O(""),If=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,py||(q3(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{de.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(E(de),E(Cf),E(du))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),Cf=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return py?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();function q3(t){py=t}var py;function Ts(t){return!!t&&typeof t.then=="function"}function WS(t){return!!t&&typeof t.subscribe=="function"}var bf=new O(""),KS=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=P(bf,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(Ts(o))r.push(o);else if(WS(o)){let a=new Promise((c,u)=>{o.subscribe({complete:c,error:u})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),gy=new O("");function G3(){Bb(()=>{throw new $(600,!1)})}function z3(t){return t.isBoundToModule}function W3(t,e,n){try{let r=n();return Ts(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}function QS(t,e){return Array.isArray(e)?e.reduce(QS,t):A(A({},t),e)}var oa=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=P(ZT),this.afterRenderEffectManager=P(ly),this.externalTestViews=new Set,this.beforeRender=new $e,this.afterTick=new $e,this.componentTypes=[],this.components=[],this.isStable=P(xf).hasPendingTasks.pipe(j(r=>!r)),this._injector=P(hn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof zh;if(!this._injector.get(KS).done){let f=!s&&lT(r),p=!1;throw new $(405,p)}let a;s?a=r:a=this._injector.get(yf).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=z3(a)?void 0:this._injector.get(vi),u=i||a.selector,l=a.create(Kn.NULL,[],u,c),d=l.location.nativeElement,h=l.injector.get(fy,null);return h?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),Mh(this.components,l),h?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new $(101,!1);let i=we(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,we(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===PS)throw new $(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:c}of this._views)K3(a,o,c)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>I0(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>I0(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;Mh(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(gy,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>Mh(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new $(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Mh(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function K3(t,e,n){!e&&!I0(t)||Q3(t,n,e)}function I0(t){return j0(t)}function Q3(t,e,n){let r;n?(r=0,t[z]|=1024):t[z]&64?r=0:r=1,kS(t,e,r)}var C0=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},Df=(()=>{let e=class e{compileModuleSync(r){return new Yh(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=dT(r),o=sS(s.declarations).reduce((a,c)=>{let u=mi(c);return u&&a.push(new Jo(u)),a},[]);return new C0(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Y3=new O("");function Z3(t,e,n){let r=new Yh(n);return Promise.resolve(r)}function HD(t){for(let e=t.length-1;e>=0;e--)if(t[e]!==void 0)return t[e]}var X3=(()=>{let e=class e{constructor(){this.zone=P(de),this.applicationRef=P(oa)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function J3(t){return[{provide:de,useFactory:t},{provide:Ko,multi:!0,useFactory:()=>{let e=P(X3,{optional:!0});return()=>e.initialize()}},{provide:Ko,multi:!0,useFactory:()=>{let e=P(nj);return()=>{e.initialize()}}},{provide:ZT,useFactory:ej}]}function ej(){let t=P(de),e=P(fr);return n=>t.runOutsideAngular(()=>e.handleError(n))}function tj(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var nj=(()=>{let e=class e{constructor(){this.subscription=new ze,this.initialized=!1,this.zone=P(de),this.pendingTasks=P(xf)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{de.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{de.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function rj(){return typeof $localize<"u"&&$localize.locale||Xh}var my=new O("",{providedIn:"root",factory:()=>P(my,ae.Optional|ae.SkipSelf)||rj()});var YS=new O(""),ZS=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=N5(i?.ngZone,tj({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=u3(r.moduleType,this.injector,J3(()=>s)),a=o.injector.get(fr,null);return s.runOutsideAngular(()=>{let c=s.onError.subscribe({next:u=>{a.handleError(u)}});o.onDestroy(()=>{Mh(this._modules,o),c.unsubscribe()})}),W3(a,s,()=>{let c=o.injector.get(KS);return c.runInitializers(),c.donePromise.then(()=>{let u=o.injector.get(my,Xh);return O3(u||Xh),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=QS({},i);return Z3(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(oa);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new $(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new $(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(YS,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(E(Kn))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),Kc=null,XS=new O("");function ij(t){if(Kc&&!Kc.get(XS,!1))throw new $(400,!1);G3(),Kc=t;let e=t.get(ZS);return aj(t),e}function _y(t,e,n=[]){let r=`Platform: ${e}`,i=new O(r);return(s=[])=>{let o=JS();if(!o||o.injector.get(XS,!1)){let a=[...n,...s,{provide:i,useValue:!0}];t?t(a):ij(sj(a,r))}return oj(i)}}function sj(t=[],e){return Kn.create({name:e,providers:[{provide:rf,useValue:"platform"},{provide:YS,useValue:new Set([()=>Kc=null])},...t]})}function oj(t){let e=JS();if(!e)throw new $(401,!1);return e}function JS(){return Kc?.get(ZS)??null}function aj(t){t.get(K0,null)?.forEach(n=>n())}function yy(){return!1}var Ss=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=cj;let t=e;return t})();function cj(t){return uj(rn(),Me(),(t&16)===16)}function uj(t,e,n){if(af(t)&&!n){let r=wi(t.index,e);return new Es(r,r)}else if(t.type&47){let r=e[dr];return new Es(r,e)}return null}var b0=class{constructor(){}supports(e){return BS(e)}create(e){return new D0(e)}},lj=(t,e)=>e,D0=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||lj}forEachItem(e){let n;for(n=this._itHead;n!==null;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,s=null;for(;n||r;){let o=!r||n&&n.currentIndex<qD(r,i,s)?n:r,a=qD(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(n=n._next,o.previousIndex==null)i++;else{s||(s=[]);let u=a-i,l=c-i;if(u!=l){for(let h=0;h<u;h++){let f=h<s.length?s[h]:s[h]=0,p=f+h;l<=p&&p<u&&(s[h]=f+1)}let d=o.previousIndex;s[d]=l-u}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)e(n)}diff(e){if(e==null&&(e=[]),!BS(e))throw new $(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,s,o,a),r=!0):(r&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)),n=n._next}else i=0,l3(e,a=>{o=this._trackByFn(i,a),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,a,o,i),r=!0):(r&&(n=this._verifyReinsertion(n,a,o,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,i)):e=this._addAfter(new T0(n,r),s,i)),e}_verifyReinsertion(e,n,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let n=e._next;this._addToRemovals(this._unlink(e)),e=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){let i=n===null?this._itHead:n._next;return e._next=i,e._prev=n,i===null?this._itTail=e:i._prev=e,n===null?this._itHead=e:n._next=e,this._linkedRecords===null&&(this._linkedRecords=new Jh),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let n=e._prev,r=e._next;return n===null?this._itHead=r:n._next=r,r===null?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Jh),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},T0=class{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},S0=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;r!==null;r=r._nextDup)if((n===null||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let n=e._prevDup,r=e._nextDup;return n===null?this._head=r:n._nextDup=r,r===null?this._tail=n:r._prevDup=n,this._head===null}},Jh=class{constructor(){this.map=new Map}put(e){let n=e.trackById,r=this.map.get(n);r||(r=new S0,this.map.set(n,r)),r.add(e)}get(e,n){let r=e,i=this.map.get(r);return i?i.get(e,n):null}remove(e){let n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function qD(t,e,n){let r=t.previousIndex;if(r===null)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}function GD(){return new vy([new b0])}var vy=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||GD()),deps:[[e,new R0,new ta]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new $(901,!1)}};e.\u0275prov=V({token:e,providedIn:"root",factory:GD});let t=e;return t})();var eA=_y(null,"core",[]),tA=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(E(oa))},e.\u0275mod=tt({type:e}),e.\u0275inj=et({});let t=e;return t})();function As(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function nA(t){let e=mi(t);if(!e)return null;let n=new Jo(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var aA=null;function gr(){return aA}function cA(t){aA??=t}var Tf=class{};var un=new O(""),Cy=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(dj),providedIn:"platform"});let t=e;return t})(),uA=new O(""),dj=(()=>{let e=class e extends Cy{constructor(){super(),this._doc=P(un),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return gr().getBaseHref(this._doc)}onPopState(r){let i=gr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=gr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>new e,providedIn:"platform"});let t=e;return t})();function by(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function rA(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function Wr(t){return t&&t[0]!=="?"?"?"+t:t}var Kr=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(Dy),providedIn:"root"});let t=e;return t})(),lA=new O(""),Dy=(()=>{let e=class e extends Kr{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??P(un).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return by(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+Wr(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Wr(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Wr(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(E(Cy),E(lA,8))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),dA=(()=>{let e=class e extends Kr{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=by(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Wr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Wr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(E(Cy),E(lA,8))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),aa=(()=>{let e=class e{constructor(r){this._subject=new lt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=pj(rA(iA(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+Wr(i))}normalize(r){return e.stripTrailingSlash(fj(this._basePath,iA(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Wr(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Wr(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=Wr,e.joinWithSlash=by,e.stripTrailingSlash=rA,e.\u0275fac=function(i){return new(i||e)(E(Kr))},e.\u0275prov=V({token:e,factory:()=>hj(),providedIn:"root"});let t=e;return t})();function hj(){return new aa(E(Kr))}function fj(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function iA(t){return t.replace(/\/index.html$/,"")}function pj(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function hA(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var xy=class{constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},ca=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new xy(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let c=i.get(o);i.move(c,a),sA(c,s)}});for(let s=0,o=i.length;s<o;s++){let c=i.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);sA(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(re(ia),re(_f),re(vy))},e.\u0275dir=bt({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let t=e;return t})();function sA(t,e){t.context.$implicit=e.item}var ua=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new wy,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){oA("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){oA("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(re(ia),re(_f))},e.\u0275dir=bt({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let t=e;return t})(),wy=class{constructor(){this.$implicit=null,this.ngIf=null}};function oA(t,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${t} must be a TemplateRef, but received '${Bt(e)}'.`)}var fA=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=tt({type:e}),e.\u0275inj=et({});let t=e;return t})(),Ty="browser",gj="server";function mj(t){return t===Ty}function Ms(t){return t===gj}var pA=(()=>{let e=class e{};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>mj(P(Rt))?new Ey(P(un),window):new Iy});let t=e;return t})(),Ey=class{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let n=_j(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function _j(t,e){let n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var Iy=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},Sf=class{};var My=class extends Tf{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Ry=class t extends My{static makeCurrent(){cA(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=vj();return n==null?null:xj(n)}resetBaseElement(){hu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return hA(document.cookie,e)}},hu=null;function vj(){return hu=hu||document.querySelector("base"),hu?hu.getAttribute("href"):null}function xj(t){return new URL(t,document.baseURI).pathname}var Ny=class{addToWindow(e){jt.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new $(5103,!1);return s},jt.getAllAngularTestabilities=()=>e.getAllTestabilities(),jt.getAllAngularRootElements=()=>e.getAllRootElements();let n=r=>{let i=jt.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};jt.frameworkStabilizers||(jt.frameworkStabilizers=[]),jt.frameworkStabilizers.push(n)}findTestabilityInTree(e,n,r){if(n==null)return null;let i=e.getTestability(n);return i??(r?gr().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},wj=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),Py=new O(""),yA=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new $(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(E(Py),E(de))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),Mf=class{constructor(e){this._doc=e}},Sy="ng-app-id",vA=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Ms(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${Sy}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(Sy),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(Sy,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(E(un),E(df),E(Q0,8),E(Rt))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),Ay={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Oy=/%COMP%/g,xA="%COMP%",Ej=`_nghost-${xA}`,Ij=`_ngcontent-${xA}`,Cj=!0,bj=new O("",{providedIn:"root",factory:()=>Cj});function Dj(t){return Ij.replace(Oy,t)}function Tj(t){return Ej.replace(Oy,t)}function wA(t,e){return e.map(n=>n.replace(Oy,t))}var gA=(()=>{let e=class e{constructor(r,i,s,o,a,c,u,l=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=u,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=Ms(c),this.defaultRenderer=new fu(r,a,u,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===lr.ShadowDom&&(i=ue(A({},i),{encapsulation:lr.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof Rf?s.applyToHost(r):s instanceof pu&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,c=this.ngZone,u=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case lr.Emulated:o=new Rf(u,l,i,this.appId,d,a,c,h);break;case lr.ShadowDom:return new ky(u,l,r,i,a,c,this.nonce,h);default:o=new pu(u,l,i,d,a,c,h);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(E(yA),E(vA),E(df),E(bj),E(un),E(Rt),E(de),E(Q0))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),fu=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(Ay[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(mA(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(mA(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new $(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=Ay[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=Ay[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Br.DashCase|Br.Important)?e.style.setProperty(n,r,i&Br.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Br.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=gr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function mA(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var ky=class extends fu{constructor(e,n,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=wA(i.id,i.styles);for(let l of u){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=l,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},pu=class extends fu{constructor(e,n,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=c?wA(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Rf=class extends pu{constructor(e,n,r,i,s,o,a,c){let u=i+"-"+r.id;super(e,n,r,s,o,a,c,u),this.contentAttr=Dj(u),this.hostAttr=Tj(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},Sj=(()=>{let e=class e extends Mf{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(E(un))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),_A=["alt","control","meta","shift"],Aj={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Mj={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},Rj=(()=>{let e=class e extends Mf{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>gr().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),_A.forEach(l=>{let d=i.indexOf(l);d>-1&&(i.splice(d,1),a+=l+".")}),a+=o,i.length!=0||o.length===0)return null;let u={};return u.domEventName=s,u.fullKey=a,u}static matchEventFullKeyCode(r,i){let s=Aj[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),_A.forEach(a=>{if(a!==s){let c=Mj[a];c(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(E(un))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function Nj(){Ry.makeCurrent()}function Pj(){return new fr}function kj(){return JT(document),document}var Oj=[{provide:Rt,useValue:Ty},{provide:K0,useValue:Nj,multi:!0},{provide:un,useFactory:kj,deps:[]}],EA=_y(eA,"browser",Oj),Fj=new O(""),Vj=[{provide:du,useClass:Ny,deps:[]},{provide:fy,useClass:If,deps:[de,Cf,du]},{provide:If,useClass:If,deps:[de,Cf,du]}],Lj=[{provide:rf,useValue:"root"},{provide:fr,useFactory:Pj,deps:[]},{provide:Py,useClass:Sj,multi:!0,deps:[un,de,Rt]},{provide:Py,useClass:Rj,multi:!0,deps:[un]},gA,vA,yA,{provide:nu,useExisting:gA},{provide:Sf,useClass:wj,deps:[]},[]],IA=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:df,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(E(Fj,12))},e.\u0275mod=tt({type:e}),e.\u0275inj=et({providers:[...Lj,...Vj],imports:[fA,tA]});let t=e;return t})();var CA=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(E(un))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var ne="primary",Au=Symbol("RouteTitle"),By=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function pa(t){return new By(t)}function jj(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function Bj(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!mr(t[n],e[n]))return!1;return!0}function mr(t,e){let n=t?Uy(t):void 0,r=e?Uy(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!kA(t[i],e[i]))return!1;return!0}function Uy(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function kA(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function OA(t){return t.length>0?t[t.length-1]:null}function Ti(t){return x_(t)?t:Ts(t)?ye(Promise.resolve(t)):B(t)}var Uj={exact:VA,subset:LA},FA={exact:$j,subset:Hj,ignored:()=>!0};function DA(t,e,n){return Uj[n.paths](t.root,e.root,n.matrixParams)&&FA[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function $j(t,e){return mr(t,e)}function VA(t,e,n){if(!Ns(t.segments,e.segments)||!kf(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!VA(t.children[r],e.children[r],n))return!1;return!0}function Hj(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>kA(t[n],e[n]))}function LA(t,e,n){return jA(t,e,e.segments,n)}function jA(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!Ns(i,n)||e.hasChildren()||!kf(i,n,r))}else if(t.segments.length===n.length){if(!Ns(t.segments,n)||!kf(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!LA(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!Ns(t.segments,i)||!kf(t.segments,i,r)||!t.children[ne]?!1:jA(t.children[ne],e,s,r)}}function kf(t,e,n){return e.every((r,i)=>FA[n](t[i].parameters,r.parameters))}var Ii=class{constructor(e=new Ee([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=pa(this.queryParams),this._queryParamMap}toString(){return zj.serialize(this)}},Ee=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Of(this)}},Rs=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=pa(this.parameters),this._parameterMap}toString(){return UA(this)}};function qj(t,e){return Ns(t,e)&&t.every((n,r)=>mr(n.parameters,e[r].parameters))}function Ns(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function Gj(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===ne&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==ne&&(n=n.concat(e(i,r)))}),n}var Mu=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>new wu,providedIn:"root"});let t=e;return t})(),wu=class{parse(e){let n=new Hy(e);return new Ii(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${gu(e.root,!0)}`,r=Qj(e.queryParams),i=typeof e.fragment=="string"?`#${Wj(e.fragment)}`:"";return`${n}${r}${i}`}},zj=new wu;function Of(t){return t.segments.map(e=>UA(e)).join("/")}function gu(t,e){if(!t.hasChildren())return Of(t);if(e){let n=t.children[ne]?gu(t.children[ne],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==ne&&r.push(`${i}:${gu(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=Gj(t,(r,i)=>i===ne?[gu(t.children[ne],!1)]:[`${i}:${gu(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[ne]!=null?`${Of(t)}/${n[0]}`:`${Of(t)}/(${n.join("//")})`}}function BA(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Nf(t){return BA(t).replace(/%3B/gi,";")}function Wj(t){return encodeURI(t)}function $y(t){return BA(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ff(t){return decodeURIComponent(t)}function TA(t){return Ff(t.replace(/\+/g,"%20"))}function UA(t){return`${$y(t.path)}${Kj(t.parameters)}`}function Kj(t){return Object.entries(t).map(([e,n])=>`;${$y(e)}=${$y(n)}`).join("")}function Qj(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${Nf(n)}=${Nf(i)}`).join("&"):`${Nf(n)}=${Nf(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var Yj=/^[^\/()?;#]+/;function Fy(t){let e=t.match(Yj);return e?e[0]:""}var Zj=/^[^\/()?;=#]+/;function Xj(t){let e=t.match(Zj);return e?e[0]:""}var Jj=/^[^=?&#]+/;function e9(t){let e=t.match(Jj);return e?e[0]:""}var t9=/^[^&#]+/;function n9(t){let e=t.match(t9);return e?e[0]:""}var Hy=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ee([],{}):new Ee([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[ne]=new Ee(e,n)),r}parseSegment(){let e=Fy(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new $(4009,!1);return this.capture(e),new Rs(Ff(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=Xj(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=Fy(this.remaining);i&&(r=i,this.capture(r))}e[Ff(n)]=Ff(r)}parseQueryParam(e){let n=e9(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=n9(this.remaining);o&&(r=o,this.capture(r))}let i=TA(n),s=TA(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Fy(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new $(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=ne);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[ne]:new Ee([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new $(4011,!1)}};function $A(t){return t.segments.length>0?new Ee([],{[ne]:t}):t}function HA(t){let e={};for(let[r,i]of Object.entries(t.children)){let s=HA(i);if(r===ne&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new Ee(t.segments,e);return r9(n)}function r9(t){if(t.numberOfChildren===1&&t.children[ne]){let e=t.children[ne];return new Ee(t.segments.concat(e.segments),e.children)}return t}function ga(t){return t instanceof Ii}function i9(t,e,n=null,r=null){let i=qA(t);return GA(i,e,n,r)}function qA(t){let e;function n(s){let o={};for(let c of s.children){let u=n(c);o[c.outlet]=u}let a=new Ee(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=$A(r);return e??i}function GA(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return Vy(i,i,i,n,r);let s=s9(e);if(s.toRoot())return Vy(i,i,new Ee([],{}),n,r);let o=o9(s,i,t),a=o.processChildren?yu(o.segmentGroup,o.index,s.commands):WA(o.segmentGroup,o.index,s.commands);return Vy(i,o.segmentGroup,a,n,r)}function Vf(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function Eu(t){return typeof t=="object"&&t!=null&&t.outlets}function Vy(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([c,u])=>{s[c]=Array.isArray(u)?u.map(l=>`${l}`):`${u}`});let o;t===e?o=n:o=zA(t,e,n);let a=$A(HA(o));return new Ii(a,s,i)}function zA(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=zA(s,e,n)}),new Ee(t.segments,r)}var Lf=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&Vf(r[0]))throw new $(4003,!1);let i=r.find(Eu);if(i&&i!==OA(r))throw new $(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function s9(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new Lf(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,u])=>{a[c]=typeof u=="string"?u.split("/"):u}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Lf(n,e,r)}var ha=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function o9(t,e,n){if(t.isAbsolute)return new ha(e,!0,0);if(!n)return new ha(e,!1,NaN);if(n.parent===null)return new ha(n,!0,0);let r=Vf(t.commands[0])?0:1,i=n.segments.length-1+r;return a9(n,i,t.numberOfDoubleDots)}function a9(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new $(4005,!1);i=r.segments.length}return new ha(r,!1,i-s)}function c9(t){return Eu(t[0])?t[0].outlets:{[ne]:t}}function WA(t,e,n){if(t??=new Ee([],{}),t.segments.length===0&&t.hasChildren())return yu(t,e,n);let r=u9(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new Ee(t.segments.slice(0,r.pathIndex),{});return s.children[ne]=new Ee(t.segments.slice(r.pathIndex),t.children),yu(s,0,i)}else return r.match&&i.length===0?new Ee(t.segments,{}):r.match&&!t.hasChildren()?qy(t,e,n):r.match?yu(t,0,i):qy(t,e,n)}function yu(t,e,n){if(n.length===0)return new Ee(t.segments,{});{let r=c9(n),i={};if(Object.keys(r).some(s=>s!==ne)&&t.children[ne]&&t.numberOfChildren===1&&t.children[ne].segments.length===0){let s=yu(t.children[ne],e,n);return new Ee(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=WA(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Ee(t.segments,i)}}function u9(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(Eu(a))break;let c=`${a}`,u=r<n.length-1?n[r+1]:null;if(i>0&&c===void 0)break;if(c&&u&&typeof u=="object"&&u.outlets===void 0){if(!AA(c,u,o))return s;r+=2}else{if(!AA(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function qy(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(Eu(s)){let c=l9(s.outlets);return new Ee(r,c)}if(i===0&&Vf(n[0])){let c=t.segments[e];r.push(new Rs(c.path,SA(n[0]))),i++;continue}let o=Eu(s)?s.outlets[ne]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&Vf(a)?(r.push(new Rs(o,SA(a))),i+=2):(r.push(new Rs(o,{})),i++)}return new Ee(r,{})}function l9(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=qy(new Ee([],{}),0,r))}),e}function SA(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function AA(t,e,n){return t==n.path&&mr(e,n.parameters)}var vu="imperative",pt=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(pt||{}),Rn=class{constructor(e,n){this.id=e,this.url=n}},ma=class extends Rn{constructor(e,n,r="imperative",i=null){super(e,n),this.type=pt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},_r=class extends Rn{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=pt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},gn=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(gn||{}),jf=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(jf||{}),Ci=class extends Rn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=pt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},bi=class extends Rn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=pt.NavigationSkipped}},Iu=class extends Rn{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=pt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Bf=class extends Rn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=pt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Gy=class extends Rn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=pt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},zy=class extends Rn{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=pt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Wy=class extends Rn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=pt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ky=class extends Rn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=pt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Qy=class{constructor(e){this.route=e,this.type=pt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Yy=class{constructor(e){this.route=e,this.type=pt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Zy=class{constructor(e){this.snapshot=e,this.type=pt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Xy=class{constructor(e){this.snapshot=e,this.type=pt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Jy=class{constructor(e){this.snapshot=e,this.type=pt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ev=class{constructor(e){this.snapshot=e,this.type=pt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Uf=class{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=pt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Cu=class{},bu=class{constructor(e){this.url=e}};var tv=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Ru,this.attachRef=null}},Ru=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new tv,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),$f=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=nv(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=nv(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=rv(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return rv(e,this._root).map(n=>n.value)}};function nv(t,e){if(t===e.value)return e;for(let n of e.children){let r=nv(t,n);if(r)return r}return null}function rv(t,e){if(t===e.value)return[e];for(let n of e.children){let r=rv(t,n);if(r.length)return r.unshift(e),r}return[]}var pn=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function da(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var Hf=class extends $f{constructor(e,n){super(e),this.snapshot=n,fv(this,e)}toString(){return this.snapshot.toString()}};function KA(t){let e=d9(t),n=new It([new Rs("",{})]),r=new It({}),i=new It({}),s=new It({}),o=new It(""),a=new Ps(n,r,s,o,i,ne,t,e.root);return a.snapshot=e.root,new Hf(new pn(a,[]),e)}function d9(t){let e={},n={},r={},i="",s=new Du([],e,r,i,n,ne,t,null,{});return new qf("",new pn(s,[]))}var Ps=class{constructor(e,n,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(j(u=>u[Au]))??B(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(j(e=>pa(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(j(e=>pa(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function hv(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:A(A({},e.params),t.params),data:A(A({},e.data),t.data),resolve:A(A(A(A({},t.data),e.data),i?.data),t._resolvedData)}:r={params:A({},t.params),data:A({},t.data),resolve:A(A({},t.data),t._resolvedData??{})},i&&YA(i)&&(r.resolve[Au]=i.title),r}var Du=class{get title(){return this.data?.[Au]}constructor(e,n,r,i,s,o,a,c,u){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=pa(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=pa(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},qf=class extends $f{constructor(e,n){super(n),this.url=e,fv(this,n)}toString(){return QA(this._root)}};function fv(t,e){e.value._routerState=t,e.children.forEach(n=>fv(t,n))}function QA(t){let e=t.children.length>0?` { ${t.children.map(QA).join(", ")} } `:"";return`${t.value}${e}`}function Ly(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,mr(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),mr(e.params,n.params)||t.paramsSubject.next(n.params),Bj(e.url,n.url)||t.urlSubject.next(n.url),mr(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function iv(t,e){let n=mr(t.params,e.params)&&qj(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||iv(t.parent,e.parent))}function YA(t){return typeof t.title=="string"||t.title===null}var pv=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=ne,this.activateEvents=new lt,this.deactivateEvents=new lt,this.attachEvents=new lt,this.detachEvents=new lt,this.parentContexts=P(Ru),this.location=P(ia),this.changeDetector=P(Ss),this.environmentInjector=P(hn),this.inputBinder=P(Qf,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new $(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new $(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new $(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new $(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,u=new sv(r,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:u,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=bt({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Cs]});let t=e;return t})(),sv=class{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===Ps?this.route:e===Ru?this.childContexts:this.parent.get(e,n)}},Qf=new O(""),MA=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=$c([i.queryParams,i.params,i.data]).pipe(Fe(([o,a,c],u)=>(c=A(A(A({},o),a),c),u===0?B(c):Promise.resolve(c)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=nA(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function h9(t,e,n){let r=Tu(t,e._root,n?n._root:void 0);return new Hf(r,e)}function Tu(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=f9(t,e,n);return new pn(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Tu(t,a)),o}}let r=p9(e.value),i=e.children.map(s=>Tu(t,s));return new pn(r,i)}}function f9(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return Tu(t,r,i);return Tu(t,r)})}function p9(t){return new Ps(new It(t.url),new It(t.params),new It(t.queryParams),new It(t.fragment),new It(t.data),t.outlet,t.component,t)}var ZA="ngNavigationCancelingError";function XA(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=ga(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=JA(!1,gn.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function JA(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[ZA]=!0,n.cancellationCode=e,n}function g9(t){return e1(t)&&ga(t.url)}function e1(t){return!!t&&t[ZA]}var m9=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=tn({type:e,selectors:[["ng-component"]],standalone:!0,features:[GS],decls:1,vars:0,template:function(i,s){i&1&&on(0,"router-outlet")},dependencies:[pv],encapsulation:2});let t=e;return t})();function _9(t,e){return t.providers&&!t._injector&&(t._injector=vf(t.providers,e,`Route: ${t.path}`)),t._injector??e}function gv(t){let e=t.children&&t.children.map(gv),n=e?ue(A({},t),{children:e}):A({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==ne&&(n.component=m9),n}function yr(t){return t.outlet||ne}function y9(t,e){let n=t.filter(r=>yr(r)===e);return n.push(...t.filter(r=>yr(r)!==e)),n}function Nu(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var v9=(t,e,n,r)=>j(i=>(new ov(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),ov=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),Ly(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=da(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=da(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=da(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=da(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new ev(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Xy(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(Ly(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Ly(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=Nu(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},Gf=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},fa=class{constructor(e,n){this.component=e,this.route=n}};function x9(t,e,n){let r=t._root,i=e?e._root:null;return mu(r,i,n,[r.value])}function w9(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function ya(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!QD(t)?t:e.get(t):r}function mu(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=da(e);return t.children.forEach(o=>{E9(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>xu(a,n.getContext(o),i)),i}function E9(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=I9(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Gf(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?mu(t,e,a?a.children:null,r,i):mu(t,e,n,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new fa(a.outlet.component,o))}else o&&xu(e,a,i),i.canActivateChecks.push(new Gf(r)),s.component?mu(t,null,a?a.children:null,r,i):mu(t,null,n,r,i);return i}function I9(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!Ns(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Ns(t.url,e.url)||!mr(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!iv(t,e)||!mr(t.queryParams,e.queryParams);case"paramsChange":default:return!iv(t,e)}}function xu(t,e,n){let r=da(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?xu(o,e.children.getContext(s),n):xu(o,null,n):xu(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new fa(e.outlet.component,i)):n.canDeactivateChecks.push(new fa(null,i)):n.canDeactivateChecks.push(new fa(null,i))}function Pu(t){return typeof t=="function"}function C9(t){return typeof t=="boolean"}function b9(t){return t&&Pu(t.canLoad)}function D9(t){return t&&Pu(t.canActivate)}function T9(t){return t&&Pu(t.canActivateChild)}function S9(t){return t&&Pu(t.canDeactivate)}function A9(t){return t&&Pu(t.canMatch)}function t1(t){return t instanceof Lr||t?.name==="EmptyError"}var Pf=Symbol("INITIAL_VALUE");function _a(){return Fe(t=>$c(t.map(e=>e.pipe(jr(1),ps(Pf)))).pipe(j(e=>{for(let n of e)if(n!==!0){if(n===Pf)return Pf;if(n===!1||n instanceof Ii)return n}return!0}),Ct(e=>e!==Pf),jr(1)))}function M9(t,e){return Xe(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?B(ue(A({},n),{guardsResult:!0})):R9(o,r,i,t).pipe(Xe(a=>a&&C9(a)?N9(r,s,t,e):B(a)),j(a=>ue(A({},n),{guardsResult:a})))})}function R9(t,e,n,r){return ye(t).pipe(Xe(i=>V9(i.component,i.route,n,e,r)),Dn(i=>i!==!0,!0))}function N9(t,e,n,r){return ye(e).pipe(fs(i=>Vo(k9(i.route.parent,r),P9(i.route,r),F9(t,i.path,n),O9(t,i.route,n))),Dn(i=>i!==!0,!0))}function P9(t,e){return t!==null&&e&&e(new Jy(t)),B(!0)}function k9(t,e){return t!==null&&e&&e(new Zy(t)),B(!0)}function O9(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return B(!0);let i=r.map(s=>_h(()=>{let o=Nu(e)??n,a=ya(s,o),c=D9(a)?a.canActivate(e,t):$r(o,()=>a(e,t));return Ti(c).pipe(Dn())}));return B(i).pipe(_a())}function F9(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>w9(o)).filter(o=>o!==null).map(o=>_h(()=>{let a=o.guards.map(c=>{let u=Nu(o.node)??n,l=ya(c,u),d=T9(l)?l.canActivateChild(r,t):$r(u,()=>l(r,t));return Ti(d).pipe(Dn())});return B(a).pipe(_a())}));return B(s).pipe(_a())}function V9(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return B(!0);let o=s.map(a=>{let c=Nu(e)??i,u=ya(a,c),l=S9(u)?u.canDeactivate(t,e,n,r):$r(c,()=>u(t,e,n,r));return Ti(l).pipe(Dn())});return B(o).pipe(_a())}function L9(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return B(!0);let s=i.map(o=>{let a=ya(o,t),c=b9(a)?a.canLoad(e,n):$r(t,()=>a(e,n));return Ti(c)});return B(s).pipe(_a(),n1(r))}function n1(t){return p_(ut(e=>{if(ga(e))throw XA(t,e)}),j(e=>e===!0))}function j9(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return B(!0);let s=i.map(o=>{let a=ya(o,t),c=A9(a)?a.canMatch(e,n):$r(t,()=>a(e,n));return Ti(c)});return B(s).pipe(_a(),n1(r))}var Su=class{constructor(e){this.segmentGroup=e||null}},zf=class extends Error{constructor(e){super(),this.urlTree=e}};function la(t){return Fo(new Su(t))}function B9(t){return Fo(new $(4e3,!1))}function U9(t){return Fo(JA(!1,gn.GuardRejected))}var av=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return B(r);if(i.numberOfChildren>1||!i.children[ne])return B9(e.redirectTo);i=i.children[ne]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new zf(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new Ii(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new Ee(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new $(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},cv={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function $9(t,e,n,r,i){let s=mv(t,e,n);return s.matched?(r=_9(e,r),j9(r,e,n,i).pipe(j(o=>o===!0?s:A({},cv)))):B(s)}function mv(t,e,n){if(e.path==="**")return H9(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?A({},cv):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||jj)(n,t,e);if(!i)return A({},cv);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?A(A({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function H9(t){return{matched:!0,parameters:t.length>0?OA(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function RA(t,e,n,r){return n.length>0&&z9(t,n,r)?{segmentGroup:new Ee(e,G9(r,new Ee(n,t.children))),slicedSegments:[]}:n.length===0&&W9(t,n,r)?{segmentGroup:new Ee(t.segments,q9(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new Ee(t.segments,t.children),slicedSegments:n}}function q9(t,e,n,r){let i={};for(let s of n)if(Yf(t,e,s)&&!r[yr(s)]){let o=new Ee([],{});i[yr(s)]=o}return A(A({},r),i)}function G9(t,e){let n={};n[ne]=e;for(let r of t)if(r.path===""&&yr(r)!==ne){let i=new Ee([],{});n[yr(r)]=i}return n}function z9(t,e,n){return n.some(r=>Yf(t,e,r)&&yr(r)!==ne)}function W9(t,e,n){return n.some(r=>Yf(t,e,r))}function Yf(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function K9(t,e,n,r){return yr(t)!==r&&(r===ne||!Yf(e,n,t))?!1:mv(e,t,n).matched}function Q9(t,e,n){return e.length===0&&!t.children[n]}var uv=class{};function Y9(t,e,n,r,i,s,o="emptyOnly"){return new lv(t,e,n,r,i,o,s).recognize()}var Z9=31,lv=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new av(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new $(4002,`'${e.segmentGroup}'`)}recognize(){let e=RA(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(j(n=>{let r=new Du([],Object.freeze({}),Object.freeze(A({},this.urlTree.queryParams)),this.urlTree.fragment,{},ne,this.rootComponentType,null,{}),i=new pn(r,n),s=new qf("",i),o=i9(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,ne).pipe(hi(r=>{if(r instanceof zf)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Su?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=hv(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(j(s=>s instanceof pn?[s]:[]))}processChildren(e,n,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return ye(i).pipe(fs(s=>{let o=r.children[s],a=y9(n,s);return this.processSegmentGroup(e,a,o,s)}),ar((s,o)=>(s.push(...o),s)),fi(null),I_(),Xe(s=>{if(s===null)return la(r);let o=r1(s);return X9(o),B(o)}))}processSegment(e,n,r,i,s,o){return ye(n).pipe(fs(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(hi(c=>{if(c instanceof Su)return B(null);throw c}))),Dn(a=>!!a),hi(a=>{if(t1(a))return Q9(r,i,s)?B(new uv):la(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return K9(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):la(i):la(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:u,remainingSegments:l}=mv(n,i,s);if(!a)return la(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Z9&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,u);return this.applyRedirects.lineralizeSegments(i,d).pipe(Xe(h=>this.processSegment(e,r,n,h.concat(l),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){let o=$9(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),o.pipe(Fe(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Fe(({routes:c})=>{let u=r._loadedInjector??e,{consumedSegments:l,remainingSegments:d,parameters:h}=a,f=new Du(l,h,Object.freeze(A({},this.urlTree.queryParams)),this.urlTree.fragment,eB(r),yr(r),r.component??r._loadedComponent??null,r,tB(r)),{segmentGroup:p,slicedSegments:m}=RA(n,l,d,c);if(m.length===0&&p.hasChildren())return this.processChildren(u,c,p).pipe(j(b=>b===null?null:new pn(f,b)));if(c.length===0&&m.length===0)return B(new pn(f,[]));let v=yr(r)===s;return this.processSegment(u,c,p,m,v?ne:s,!0).pipe(j(b=>new pn(f,b instanceof pn?[b]:[])))}))):la(n)))}getChildConfig(e,n,r){return n.children?B({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?B({routes:n._loadedRoutes,injector:n._loadedInjector}):L9(e,n,r,this.urlSerializer).pipe(Xe(i=>i?this.configLoader.loadChildren(e,n).pipe(ut(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):U9(n))):B({routes:[],injector:e})}};function X9(t){t.sort((e,n)=>e.value.outlet===ne?-1:n.value.outlet===ne?1:e.value.outlet.localeCompare(n.value.outlet))}function J9(t){let e=t.value.routeConfig;return e&&e.path===""}function r1(t){let e=[],n=new Set;for(let r of t){if(!J9(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=r1(r.children);e.push(new pn(r.value,i))}return e.filter(r=>!n.has(r))}function eB(t){return t.data||{}}function tB(t){return t.resolve||{}}function nB(t,e,n,r,i,s){return Xe(o=>Y9(t,e,n,r,o.extractedUrl,i,s).pipe(j(({state:a,tree:c})=>ue(A({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function rB(t,e){return Xe(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return B(n);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let u of i1(c))o.add(u);let a=0;return ye(o).pipe(fs(c=>s.has(c)?iB(c,r,t,e):(c.data=hv(c,c.parent,t).resolve,B(void 0))),ut(()=>a++),jo(1),Xe(c=>a===o.size?B(n):Vt))})}function i1(t){let e=t.children.map(n=>i1(n)).flat();return[t,...e]}function iB(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!YA(i)&&(s[Au]=i.title),sB(s,t,e,r).pipe(j(o=>(t._resolvedData=o,t.data=hv(t,t.parent,n).resolve,null)))}function sB(t,e,n,r){let i=Uy(t);if(i.length===0)return B({});let s={};return ye(i).pipe(Xe(o=>oB(t[o],e,n,r).pipe(Dn(),ut(a=>{s[o]=a}))),jo(1),E_(s),hi(o=>t1(o)?Vt:Fo(o)))}function oB(t,e,n,r){let i=Nu(e)??r,s=ya(t,i),o=s.resolve?s.resolve(e,n):$r(i,()=>s(e,n));return Ti(o)}function jy(t){return Fe(e=>{let n=t(e);return n?ye(n).pipe(j(()=>e)):B(e)})}var s1=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===ne);return i}getResolvedTitleForRoute(r){return r.data[Au]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(aB),providedIn:"root"});let t=e;return t})(),aB=(()=>{let e=class e extends s1{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(E(CA))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),ku=new O("",{providedIn:"root",factory:()=>({})}),Wf=new O(""),_v=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=P(Df)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return B(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Ti(r.loadComponent()).pipe(j(o1),ut(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),qc(()=>{this.componentLoaders.delete(r)})),s=new Ro(i,()=>new $e).pipe(Mo());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return B({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=cB(i,this.compiler,r,this.onLoadEndListener).pipe(qc(()=>{this.childrenLoaders.delete(i)})),a=new Ro(o,()=>new $e).pipe(Mo());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function cB(t,e,n,r){return Ti(t.loadChildren()).pipe(j(o1),Xe(i=>i instanceof ru||Array.isArray(i)?B(i):ye(e.compileModuleAsync(i))),j(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(Wf,[],{optional:!0,self:!0}).flat()),{routes:o.map(gv),injector:s}}))}function uB(t){return t&&typeof t=="object"&&"default"in t}function o1(t){return uB(t)?t.default:t}var yv=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(lB),providedIn:"root"});let t=e;return t})(),lB=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),a1=new O(""),c1=new O("");function dB(t,e,n){let r=t.get(c1),i=t.get(un);return t.get(de).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,Promise.resolve();let s,o=new Promise(u=>{s=u}),a=i.startViewTransition(()=>(s(),hB(t))),{onViewTransitionCreated:c}=r;return c&&$r(t,()=>c({transition:a,from:e,to:n})),o})}function hB(t){return new Promise(e=>{uy(e,{injector:t})})}var vv=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new $e,this.transitionAbortSubject=new $e,this.configLoader=P(_v),this.environmentInjector=P(hn),this.urlSerializer=P(Mu),this.rootContexts=P(Ru),this.location=P(aa),this.inputBindingEnabled=P(Qf,{optional:!0})!==null,this.titleStrategy=P(s1),this.options=P(ku,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=P(yv),this.createViewTransition=P(a1,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>B(void 0),this.rootComponentType=null;let r=s=>this.events.next(new Qy(s)),i=s=>this.events.next(new Yy(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(ue(A(A({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new It({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:vu,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Ct(o=>o.id!==0),j(o=>ue(A({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Fe(o=>{let a=!1,c=!1;return B(o).pipe(Fe(u=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",gn.SupersededByNewNavigation),Vt;this.currentTransition=o,this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?ue(A({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let l=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=u.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!l&&d!=="reload"){let h="";return this.events.next(new bi(u.id,this.urlSerializer.serialize(u.rawUrl),h,jf.IgnoredSameUrlNavigation)),u.resolve(null),Vt}if(this.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return B(u).pipe(Fe(h=>{let f=this.transitions?.getValue();return this.events.next(new ma(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?Vt:Promise.resolve(h)}),nB(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),ut(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=ue(A({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new Bf(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){let{id:h,extractedUrl:f,source:p,restoredState:m,extras:v}=u,b=new ma(h,this.urlSerializer.serialize(f),p,m);this.events.next(b);let F=KA(this.rootComponentType).snapshot;return this.currentTransition=o=ue(A({},u),{targetSnapshot:F,urlAfterRedirects:f,extras:ue(A({},v),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,B(o)}else{let h="";return this.events.next(new bi(u.id,this.urlSerializer.serialize(u.extractedUrl),h,jf.IgnoredByUrlHandlingStrategy)),u.resolve(null),Vt}}),ut(u=>{let l=new Gy(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(l)}),j(u=>(this.currentTransition=o=ue(A({},u),{guards:x9(u.targetSnapshot,u.currentSnapshot,this.rootContexts)}),o)),M9(this.environmentInjector,u=>this.events.next(u)),ut(u=>{if(o.guardsResult=u.guardsResult,ga(u.guardsResult))throw XA(this.urlSerializer,u.guardsResult);let l=new zy(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(l)}),Ct(u=>u.guardsResult?!0:(this.cancelNavigationTransition(u,"",gn.GuardRejected),!1)),jy(u=>{if(u.guards.canActivateChecks.length)return B(u).pipe(ut(l=>{let d=new Wy(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Fe(l=>{let d=!1;return B(l).pipe(rB(this.paramsInheritanceStrategy,this.environmentInjector),ut({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",gn.NoDataFromResolver)}}))}),ut(l=>{let d=new Ky(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),jy(u=>{let l=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(ut(f=>{d.component=f}),j(()=>{})));for(let f of d.children)h.push(...l(f));return h};return $c(l(u.targetSnapshot.root)).pipe(fi(null),jr(1))}),jy(()=>this.afterPreactivation()),Fe(()=>{let{currentSnapshot:u,targetSnapshot:l}=o,d=this.createViewTransition?.(this.environmentInjector,u.root,l.root);return d?ye(d).pipe(j(()=>o)):B(o)}),j(u=>{let l=h9(r.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=o=ue(A({},u),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,o}),ut(()=>{this.events.next(new Cu)}),v9(this.rootContexts,r.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),jr(1),ut({next:u=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new _r(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),this.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{a=!0}}),D_(this.transitionAbortSubject.pipe(ut(u=>{throw u}))),qc(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",gn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),hi(u=>{if(c=!0,e1(u))this.events.next(new Ci(o.id,this.urlSerializer.serialize(o.extractedUrl),u.message,u.cancellationCode)),g9(u)?this.events.next(new bu(u.url)):o.resolve(!1);else{this.events.next(new Iu(o.id,this.urlSerializer.serialize(o.extractedUrl),u,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(u))}catch(l){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(l)}}return Vt}))}))}cancelNavigationTransition(r,i,s){let o=new Ci(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function fB(t){return t!==vu}var pB=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(gB),providedIn:"root"});let t=e;return t})(),dv=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},gB=(()=>{let e=class e extends dv{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ei(e)))(s||e)}})(),e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),u1=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(mB),providedIn:"root"});let t=e;return t})(),mB=(()=>{let e=class e extends u1{constructor(){super(...arguments),this.location=P(aa),this.urlSerializer=P(Mu),this.options=P(ku,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=P(yv),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Ii,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=KA(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof ma)this.stateMemento=this.createStateMemento();else if(r instanceof bi)this.rawUrlTree=i.initialUrl;else if(r instanceof Bf){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof Cu?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof Ci&&(r.code===gn.GuardRejected||r.code===gn.NoDataFromResolver)?this.restoreHistory(i):r instanceof Iu?this.restoreHistory(i,!0):r instanceof _r&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=A(A({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=A(A({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ei(e)))(s||e)}})(),e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),_u=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(_u||{});function l1(t,e){t.events.pipe(Ct(n=>n instanceof _r||n instanceof Ci||n instanceof Iu||n instanceof bi),j(n=>n instanceof _r||n instanceof bi?_u.COMPLETE:(n instanceof Ci?n.code===gn.Redirect||n.code===gn.SupersededByNewNavigation:!1)?_u.REDIRECTING:_u.FAILED),Ct(n=>n!==_u.REDIRECTING),jr(1)).subscribe(()=>{e()})}function _B(t){throw t}var yB={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},vB={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Di=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=P(Ef),this.stateManager=P(u1),this.options=P(ku,{optional:!0})||{},this.pendingTasks=P(xf),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=P(vv),this.urlSerializer=P(Mu),this.location=P(aa),this.urlHandlingStrategy=P(yv),this._events=new $e,this.errorHandler=this.options.errorHandler||_B,this.navigated=!1,this.routeReuseStrategy=P(pB),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=P(Wf,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!P(Qf,{optional:!0}),this.eventsSubscription=new ze,this.isNgZoneEnabled=P(de)instanceof de&&de.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Ci&&i.code!==gn.Redirect&&i.code!==gn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof _r)this.navigated=!0;else if(i instanceof bu){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||fB(s.source)};this.scheduleNavigation(a,vu,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}wB(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),vu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let u=A({},s);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(o.state=u)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(gv),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:u}=i,l=u?this.currentUrlTree.fragment:a,d=null;switch(c){case"merge":d=A(A({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=s?s.snapshot:this.routerState.snapshot.root;h=qA(f)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),h=this.currentUrlTree.root}return GA(h,r,d,l??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=ga(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,vu,null,i)}navigate(r,i={skipLocationChange:!1}){return xB(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=A({},yB):i===!1?s=A({},vB):s=i,ga(r))return DA(this.currentUrlTree,r,s);let o=this.parseUrl(r);return DA(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,u,l;a?(c=a.resolve,u=a.reject,l=a.promise):l=new Promise((h,f)=>{c=h,u=f});let d=this.pendingTasks.add();return l1(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:c,reject:u,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(h=>Promise.reject(h))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function xB(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new $(4008,!1)}function wB(t){return!(t instanceof Cu)&&!(t instanceof bu)}var d1=(()=>{let e=class e{constructor(r,i,s,o,a,c){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new $e,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let u=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=u==="a"||u==="area",this.isAnchorElement?this.subscription=r.events.subscribe(l=>{l instanceof _r&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let u={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,u),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:nS(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(re(Di),re(Ps),z0("tabindex"),re(Gr),re(pr),re(Kr))},e.\u0275dir=bt({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&Ve("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&wf("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[Ut.HasDecoratorInputTransform,"preserveFragment","preserveFragment",As],skipLocationChange:[Ut.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",As],replaceUrl:[Ut.HasDecoratorInputTransform,"replaceUrl","replaceUrl",As],routerLink:"routerLink"},standalone:!0,features:[dy,Cs]});let t=e;return t})();var Kf=class{};var EB=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(Ct(r=>r instanceof _r),fs(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=vf(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return ye(s).pipe(di())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=B(null);let o=s.pipe(Xe(a=>a===null?B(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return ye([o,a]).pipe(di())}else return o})}};e.\u0275fac=function(i){return new(i||e)(E(Di),E(Df),E(hn),E(Kf),E(_v))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),h1=new O(""),IB=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof ma?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof _r?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof bi&&r.code===jf.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Uf&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Uf(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){gS()},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function CB(t){return t.routerState.root}function Ou(t,e){return{\u0275kind:t,\u0275providers:e}}function bB(){let t=P(Kn);return e=>{let n=t.get(oa);if(e!==n.components[0])return;let r=t.get(Di),i=t.get(f1);t.get(xv)===1&&r.initialNavigation(),t.get(p1,null,ae.Optional)?.setUpPreloading(),t.get(h1,null,ae.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var f1=new O("",{factory:()=>new $e}),xv=new O("",{providedIn:"root",factory:()=>1});function DB(){return Ou(2,[{provide:xv,useValue:0},{provide:bf,multi:!0,deps:[Kn],useFactory:e=>{let n=e.get(uA,Promise.resolve());return()=>n.then(()=>new Promise(r=>{let i=e.get(Di),s=e.get(f1);l1(i,()=>{r(!0)}),e.get(vv).afterPreactivation=()=>(r(!0),s.closed?B(void 0):s),i.initialNavigation()}))}}])}function TB(){return Ou(3,[{provide:bf,multi:!0,useFactory:()=>{let e=P(Di);return()=>{e.setUpLocationChangeListener()}}},{provide:xv,useValue:2}])}var p1=new O("");function SB(t){return Ou(0,[{provide:p1,useExisting:EB},{provide:Kf,useExisting:t}])}function AB(){return Ou(8,[MA,{provide:Qf,useExisting:MA}])}function MB(t){let e=[{provide:a1,useValue:dB},{provide:c1,useValue:A({skipNextTransition:!!t?.skipInitialTransition},t)}];return Ou(9,e)}var NA=new O("ROUTER_FORROOT_GUARD"),RB=[aa,{provide:Mu,useClass:wu},Di,Ru,{provide:Ps,useFactory:CB,deps:[Di]},_v,[]],wv=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[RB,[],{provide:Wf,multi:!0,useValue:r},{provide:NA,useFactory:OB,deps:[[Di,new ta,new R0]]},{provide:ku,useValue:i||{}},i?.useHash?PB():kB(),NB(),i?.preloadingStrategy?SB(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?FB(i):[],i?.bindToComponentInputs?AB().\u0275providers:[],i?.enableViewTransitions?MB().\u0275providers:[],VB()]}}static forChild(r){return{ngModule:e,providers:[{provide:Wf,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(E(NA,8))},e.\u0275mod=tt({type:e}),e.\u0275inj=et({});let t=e;return t})();function NB(){return{provide:h1,useFactory:()=>{let t=P(pA),e=P(de),n=P(ku),r=P(vv),i=P(Mu);return n.scrollOffset&&t.setOffset(n.scrollOffset),new IB(i,r,t,e,n)}}}function PB(){return{provide:Kr,useClass:dA}}function kB(){return{provide:Kr,useClass:Dy}}function OB(t){return"guarded"}function FB(t){return[t.initialNavigation==="disabled"?TB().\u0275providers:[],t.initialNavigation==="enabledBlocking"?DB().\u0275providers:[]]}var PA=new O("");function VB(){return[{provide:PA,useFactory:bB},{provide:gy,multi:!0,useExisting:PA}]}var Ev=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=tn({type:e,selectors:[["app-home"]],decls:20,vars:0,consts:[[1,"page"],[2,"text-align","center","margin-bottom","2rem"],[1,"row",2,"align-items","start"],[1,"column"]],template:function(i,s){i&1&&(x(0,"div",0)(1,"h1",1),S(2,"Evaluaci\xF3n Tercer Parcial"),C(),x(3,"h2",1),S(4,"Desarrollo Web Profesional"),C(),x(5,"div",2)(6,"div",3)(7,"h3"),S(8,"Integrantes:"),C(),x(9,"p"),S(10,"Diosdado Rodr\xEDguez Miguel \xC1ngel"),C(),x(11,"p"),S(12,"Hern\xE1ndez \xC1vila Fernanda Montserrat"),C(),x(13,"p"),S(14,"Pinz\xF3n Huerta Erick"),C()(),x(15,"div",3)(16,"h3"),S(17,"Descripci\xF3n:"),C(),x(18,"p"),S(19,"Aplicaci\xF3n Web de venta de coches con CRUD de clientes y coches hecha con Angular."),C()()()())}});let t=e;return t})();var va=class{constructor(e){this.id="",this.marca="",this.modelo="",this.precio=0,this.kilometros=0,this.vendido=!1,this.transmision="",this.transacciones=[],this.due\u00F1oActual="",this.marca=e.marca,this.modelo=e.modelo,this.precio=e.precio,this.kilometros=e.kilometros,this.vendido=e.vendido,this.transmision=e.transmision,this.due\u00F1oActual=e.due\u00F1oActual}};var Qn=function(t){return t[t.create=0]="create",t[t.select=1]="select",t}(Qn||{});var ks=class{constructor(e){this.id="",this.fecha="",this.precio=0,this.metodoPago="",this.coche="",this.cliente="",this.tipo="",this.fecha=e.fecha,this.precio=e.precio,this.metodoPago=e.metodoPago,this.coche=e.coche,this.cliente=e.cliente,this.tipo=e.tipo}};var jB="firebase",BB="10.10.0";Bn(jB,BB,"app");var Os=new Ur("ANGULARFIRE2_VERSION");var UB=(t,e)=>{let n=e?[e]:kb(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Qr=class{constructor(){return UB($B)}},$B="app-check";function Iv(){}var Zf=class{zone;delegate;constructor(e,n=y_){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},Cv=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Iv,{},Iv,Iv)),n.pipe(ut({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},xa=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new Zf(Zone.current)),this.insideAngular=n.run(()=>new Zf(Zone.current,hs)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(E(de))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function HB(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function We(t){return qB(HB())(t)}function qB(t){return function(n){return n=n.lift(new Cv(t.ngZone)),n.pipe($n(t.outsideAngular),bn(t.insideAngular))}}var GB=new Map,zB={activated:!1,tokenObservers:[]},WB={initialized:!1,enabled:!1};function Yn(t){return GB.get(t)||Object.assign({},zB)}function w1(){return WB}var KB="https://content-firebaseappcheck.googleapis.com/v1";var QB="exchangeDebugToken",g1={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},Mee=24*60*60*1e3;var Tv=class{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return g(this,null,function*(){this.stop();try{this.pending=new ht,this.pending.promise.catch(n=>{}),yield YB(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new ht,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function YB(t){return new Promise(e=>{setTimeout(e,t)})}var ZB={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Si=new Sb("appCheck","AppCheck",ZB);function E1(t){if(!Yn(t).activated)throw Si.create("use-before-activation",{appName:t.name})}function I1(r,i){return g(this,arguments,function*({url:t,body:e},n){let s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let f=yield o.getHeartbeatsHeader();f&&(s["X-Firebase-Client"]=f)}let a={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(t,a)}catch(f){throw Si.create("fetch-network-error",{originalErrorMessage:f?.message})}if(c.status!==200)throw Si.create("fetch-status-error",{httpStatus:c.status});let u;try{u=yield c.json()}catch(f){throw Si.create("fetch-parse-error",{originalErrorMessage:f?.message})}let l=u.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw Si.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${u.ttl}`});let d=Number(l[1])*1e3,h=Date.now();return{token:u.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function C1(t,e){let{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${KB}/projects/${n}/apps/${r}:${QB}?key=${i}`,body:{debug_token:e}}}var XB="firebase-app-check-database",JB=1,Sv="firebase-app-check-store";var Xf=null;function eU(){return Xf||(Xf=new Promise((t,e)=>{try{let n=indexedDB.open(XB,JB);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var i;e(Si.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Sv,{keyPath:"compositeKey"})}}}catch(n){e(Si.create("storage-open",{originalErrorMessage:n?.message}))}}),Xf)}function tU(t,e){return nU(rU(t),e)}function nU(t,e){return g(this,null,function*(){let r=(yield eU()).transaction(Sv,"readwrite"),s=r.objectStore(Sv).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},r.onerror=c=>{var u;a(Si.create("storage-set",{originalErrorMessage:(u=c.target.error)===null||u===void 0?void 0:u.message}))}})})}function rU(t){return`${t.options.appId}-${t.name}`}var Av=new li("@firebase/app-check");function Dv(t,e){return Hd()?tU(t,e).catch(n=>{Av.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function b1(){return w1().enabled}function D1(){return g(this,null,function*(){let t=w1();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var iU={error:"UNKNOWN_ERROR"};function sU(t){return Ud.encodeString(JSON.stringify(t),!1)}function Mv(t,e=!1){return g(this,null,function*(){let n=t.app;E1(n);let r=Yn(n),i=r.token,s;if(i&&!Fu(i)&&(r.token=void 0,i=void 0),!i){let c=yield r.cachedTokenPromise;c&&(Fu(c)?i=c:yield Dv(n,void 0))}if(!e&&i&&Fu(i))return{token:i.token};let o=!1;if(b1()){r.exchangeTokenPromise||(r.exchangeTokenPromise=I1(C1(n,yield D1()),t.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let c=yield r.exchangeTokenPromise;return yield Dv(n,c),r.token=c,{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield Yn(n).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?Av.warn(c.message):Av.error(c),s=c}let a;return i?s?Fu(i)?a={token:i.token,internalError:s}:a=_1(s):(a={token:i.token},r.token=i,yield Dv(n,i)):a=_1(s),o&&uU(n,a),a})}function oU(t){return g(this,null,function*(){let e=t.app;E1(e);let{provider:n}=Yn(e);if(b1()){let r=yield D1(),{token:i}=yield I1(C1(e,r),t.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield n.getToken();return{token:r}}})}function aU(t,e,n,r){let{app:i}=t,s=Yn(i),o={next:n,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Fu(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),m1(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>m1(t))}function T1(t,e){let n=Yn(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function m1(t){let{app:e}=t,n=Yn(e),r=n.tokenRefresher;r||(r=cU(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function cU(t){let{app:e}=t;return new Tv(()=>g(this,null,function*(){let n=Yn(e),r;if(n.token?r=yield Mv(t,!0):r=yield Mv(t),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=Yn(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,i=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},g1.RETRIAL_MIN_WAIT,g1.RETRIAL_MAX_WAIT)}function uU(t,e){let n=Yn(t).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Fu(t){return t.expireTimeMillis-Date.now()>0}function _1(t){return{token:sU(iU),error:t}}var Rv=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=Yn(this.app);for(let n of e)T1(this.app,n.next);return Promise.resolve()}};function lU(t,e){return new Rv(t,e)}function dU(t){return{getToken:e=>Mv(t,e),getLimitedUseToken:()=>oU(t),addTokenListener:e=>aU(t,"INTERNAL",e),removeTokenListener:e=>T1(t.app,e)}}var hU="@firebase/app-check",fU="0.8.3";var pU="app-check",y1="app-check-internal";function gU(){as(new dn(pU,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return lU(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(y1).initialize()})),as(new dn(y1,t=>{let e=t.getProvider("app-check").getImmediate();return dU(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Bn(hU,fU)}gU();var mU=["localhost","0.0.0.0","127.0.0.1"],$ee=typeof window<"u"&&mU.includes(window.location.hostname);var _U="firebase",yU="10.10.0";wt.registerVersion(_U,yU,"app-compat");var vU=["ngOnDestroy"],A1=(t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(vU.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let c=a?.[s];return typeof c=="function"?c.bind(a):c?.then?c.then(u=>n.run(()=>u)):n.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>o[c],apply:(a,c,u)=>o.then(l=>{let d=l?.(...u);return r?.spy?.apply&&r.spy.apply(s,u,d),d})})})});var Jf=class{constructor(e){return e}},Ai=new O("angularfire2.app.options"),Mi=new O("angularfire2.app.name");function Fs(t,e,n){let r=typeof n=="string"&&n||"[DEFAULT]",i=typeof n=="object"&&n||{};i.name=i.name||r;let o=wt.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>wt.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let a=!!module.hot;xU("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Jf(o)}var xU=(t,...e)=>{yy()&&typeof console<"u"&&console[t](...e)},wU={provide:Jf,useFactory:Fs,deps:[Ai,de,[new ta,Mi]]},M1=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:Ai,useValue:n},{provide:Mi,useValue:r}]}}constructor(n){wt.registerVersion("angularfire",Os.full,"core"),wt.registerVersion("angularfire",Os.full,"app-compat"),wt.registerVersion("angular",zS.full,n.toString())}static \u0275fac=function(r){return new(r||t)(E(Rt))};static \u0275mod=tt({type:t});static \u0275inj=et({providers:[wU]})}return t})();function wa(t,e,n,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return EU(i,o)||(S1("error",`${e} was already initialized on the ${n} Firebase App with different settings.${IU?" You may need to reload as Firebase is not HMR aware.":""}`),S1("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}function EU(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var IU=typeof module<"u"&&!!module.hot,S1=(t,...e)=>{yy()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var Vu=new O("angularfire2.auth.use-emulator"),Lu=new O("angularfire2.auth.settings"),ju=new O("angularfire2.auth.tenant-id"),Bu=new O("angularfire2.auth.langugage-code"),Uu=new O("angularfire2.auth.use-device-language"),$u=new O("angularfire.auth.persistence"),Hu=(t,e,n,r,i,s,o,a)=>wa(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let c=e.runOutsideAngular(()=>t.auth());if(n&&c.useEmulator(...n),r&&(c.tenantId=r),c.languageCode=i,s&&c.useDeviceLanguage(),o)for(let[u,l]of Object.entries(o))c.settings[u]=l;return a&&c.setPersistence(a),c},[n,r,i,s,o,a]),ep=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,c,u,l,d,h,f){let p=new $e,m=B(void 0).pipe(bn(o.outsideAngular),Fe(()=>s.runOutsideAngular(()=>import("./chunk-EA5I5XF3.js"))),j(()=>Fs(n,s,r)),j(v=>Hu(v,s,a,u,l,d,c,h)),vh({bufferSize:1,refCount:!1}));if(Ms(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=B(null);else{m.pipe(Dn()).subscribe();let v=m.pipe(Fe(T=>T.getRedirectResult().then(H=>H,()=>null)),We,vh({bufferSize:1,refCount:!1})),b=m.pipe(Fe(T=>new ie(H=>({unsubscribe:s.runOutsideAngular(()=>T.onAuthStateChanged(W=>H.next(W),W=>H.error(W),()=>H.complete()))})))),F=m.pipe(Fe(T=>new ie(H=>({unsubscribe:s.runOutsideAngular(()=>T.onIdTokenChanged(W=>H.next(W),W=>H.error(W),()=>H.complete()))}))));this.authState=v.pipe(xh(b),$n(o.outsideAngular),bn(o.insideAngular)),this.user=v.pipe(xh(F),$n(o.outsideAngular),bn(o.insideAngular)),this.idToken=this.user.pipe(Fe(T=>T?ye(T.getIdToken()):B(null))),this.idTokenResult=this.user.pipe(Fe(T=>T?ye(T.getIdTokenResult()):B(null))),this.credential=Lo(v,p,this.authState.pipe(Ct(T=>!T))).pipe(j(T=>T?.user?T:null),$n(o.outsideAngular),bn(o.insideAngular))}return A1(this,m,s,{spy:{apply:(v,b,F)=>{(v.startsWith("signIn")||v.startsWith("createUser"))&&F.then(T=>p.next(T))}}})}static \u0275fac=function(r){return new(r||t)(E(Ai),E(Mi,8),E(Rt),E(de),E(xa),E(Vu,8),E(Lu,8),E(ju,8),E(Bu,8),E(Uu,8),E($u,8),E(Qr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var CU=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Xn={},N,ex=ex||{},Y=CU||self;function pp(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function rl(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function bU(t){return Object.prototype.hasOwnProperty.call(t,Pv)&&t[Pv]||(t[Pv]=++DU)}var Pv="closure_uid_"+(1e9*Math.random()>>>0),DU=0;function TU(t,e,n){return t.call.apply(t.bind,arguments)}function SU(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Nt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Nt=TU:Nt=SU,Nt.apply(null,arguments)}function tp(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function mt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function Ri(){this.s=this.s,this.o=this.o}var AU=0;Ri.prototype.s=!1;Ri.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),AU!=0)&&bU(this)};Ri.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var q1=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function tx(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function N1(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(pp(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function Pt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Pt.prototype.h=function(){this.defaultPrevented=!0};var MU=function(){if(!Y.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};Y.addEventListener("test",n,e),Y.removeEventListener("test",n,e)}catch{}return t}();function Qu(t){return/^[\s\xa0]*$/.test(t)}function gp(){var t=Y.navigator;return t&&(t=t.userAgent)?t:""}function vr(t){return gp().indexOf(t)!=-1}function nx(t){return nx[" "](t),t}nx[" "]=function(){};function RU(t,e){var n=v6;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var NU=vr("Opera"),ba=vr("Trident")||vr("MSIE"),G1=vr("Edge"),Lv=G1||ba,z1=vr("Gecko")&&!(gp().toLowerCase().indexOf("webkit")!=-1&&!vr("Edge"))&&!(vr("Trident")||vr("MSIE"))&&!vr("Edge"),PU=gp().toLowerCase().indexOf("webkit")!=-1&&!vr("Edge");function W1(){var t=Y.document;return t?t.documentMode:void 0}var jv;e:{if(np="",rp=function(){var t=gp();if(z1)return/rv:([^\);]+)(\)|;)/.exec(t);if(G1)return/Edge\/([\d\.]+)/.exec(t);if(ba)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(PU)return/WebKit\/(\S+)/.exec(t);if(NU)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),rp&&(np=rp?rp[1]:""),ba&&(ip=W1(),ip!=null&&ip>parseFloat(np))){jv=String(ip);break e}jv=np}var np,rp,ip,Bv;Y.document&&ba?(kv=W1(),Bv=kv||parseInt(jv,10)||void 0):Bv=void 0;var kv,kU=Bv;function Yu(t,e){if(Pt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(z1){e:{try{nx(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:OU[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Yu.$.h.call(this)}}mt(Yu,Pt);var OU={2:"touch",3:"pen",4:"mouse"};Yu.prototype.h=function(){Yu.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var il="closure_listenable_"+(1e6*Math.random()|0),FU=0;function VU(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++FU,this.fa=this.ia=!1}function mp(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function rx(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function LU(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function K1(t){let e={};for(let n in t)e[n]=t[n];return e}var P1="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Q1(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<P1.length;s++)n=P1[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function _p(t){this.src=t,this.g={},this.h=0}_p.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=$v(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new VU(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function Uv(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=q1(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(mp(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function $v(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var ix="closure_lm_"+(1e6*Math.random()|0),Ov={};function Y1(t,e,n,r,i){if(r&&r.once)return X1(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)Y1(t,e[s],n,r,i);return null}return n=ax(n),t&&t[il]?t.O(e,n,rl(r)?!!r.capture:!!r,i):Z1(t,e,n,!1,r,i)}function Z1(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=rl(i)?!!i.capture:!!i,a=ox(t);if(a||(t[ix]=a=new _p(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=jU(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)MU||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(eM(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function jU(){function t(n){return e.call(t.src,t.listener,n)}let e=BU;return t}function X1(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)X1(t,e[s],n,r,i);return null}return n=ax(n),t&&t[il]?t.P(e,n,rl(r)?!!r.capture:!!r,i):Z1(t,e,n,!0,r,i)}function J1(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)J1(t,e[s],n,r,i);else r=rl(r)?!!r.capture:!!r,n=ax(n),t&&t[il]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=$v(s,n,r,i),-1<n&&(mp(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=ox(t))&&(e=t.g[e.toString()],t=-1,e&&(t=$v(e,n,r,i)),(n=-1<t?e[t]:null)&&sx(n))}function sx(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[il])Uv(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(eM(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=ox(e))?(Uv(n,t),n.h==0&&(n.src=null,e[ix]=null)):mp(t)}}}function eM(t){return t in Ov?Ov[t]:Ov[t]="on"+t}function BU(t,e){if(t.fa)t=!0;else{e=new Yu(e,this);var n=t.listener,r=t.la||t.src;t.ia&&sx(t),t=n.call(r,e)}return t}function ox(t){return t=t[ix],t instanceof _p?t:null}var Fv="__closure_events_fn_"+(1e9*Math.random()>>>0);function ax(t){return typeof t=="function"?t:(t[Fv]||(t[Fv]=function(e){return t.handleEvent(e)}),t[Fv])}function gt(){Ri.call(this),this.i=new _p(this),this.S=this,this.J=null}mt(gt,Ri);gt.prototype[il]=!0;gt.prototype.removeEventListener=function(t,e,n,r){J1(this,t,e,n,r)};function St(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new Pt(e,t);else if(e instanceof Pt)e.target=e.target||t;else{var i=e;e=new Pt(r,t),Q1(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=sp(o,r,!0,e)&&i}if(o=e.g=t,i=sp(o,r,!0,e)&&i,i=sp(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=sp(o,r,!1,e)&&i}gt.prototype.N=function(){if(gt.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)mp(n[r]);delete t.g[e],t.h--}}this.J=null};gt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};gt.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function sp(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&Uv(t.i,o),i=a.call(c,r)!==!1&&i}}return i&&!r.defaultPrevented}var cx=Y.JSON.stringify,Hv=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function UU(){var t=ux;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var qv=class{constructor(){this.h=this.g=null}add(e,n){let r=tM.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},tM=new Hv(()=>new Gv,t=>t.reset()),Gv=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function $U(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function HU(t){Y.setTimeout(()=>{throw t},0)}var Zu,Xu=!1,ux=new qv,nM=()=>{let t=Y.Promise.resolve(void 0);Zu=()=>{t.then(qU)}},qU=()=>{for(var t;t=UU();){try{t.h.call(t.g)}catch(n){HU(n)}var e=tM;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Xu=!1};function yp(t,e){gt.call(this),this.h=t||1,this.g=e||Y,this.j=Nt(this.qb,this),this.l=Date.now()}mt(yp,gt);N=yp.prototype;N.ga=!1;N.T=null;N.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),St(this,"tick"),this.ga&&(lx(this),this.start()))}};N.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function lx(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}N.N=function(){yp.$.N.call(this),lx(this),delete this.g};function dx(t,e,n){if(typeof t=="function")n&&(t=Nt(t,n));else if(t&&typeof t.handleEvent=="function")t=Nt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Y.setTimeout(t,e||0)}function rM(t){t.g=dx(()=>{t.g=null,t.i&&(t.i=!1,rM(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var zv=class extends Ri{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:rM(this)}N(){super.N(),this.g&&(Y.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function Ju(t){Ri.call(this),this.h=t,this.g={}}mt(Ju,Ri);var k1=[];function iM(t,e,n,r){Array.isArray(n)||(n&&(k1[0]=n.toString()),n=k1);for(var i=0;i<n.length;i++){var s=Y1(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function sM(t){rx(t.g,function(e,n){this.g.hasOwnProperty(n)&&sx(e)},t),t.g={}}Ju.prototype.N=function(){Ju.$.N.call(this),sM(this)};Ju.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function vp(){this.g=!0}vp.prototype.Ea=function(){this.g=!1};function GU(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var d=l.split("_");o=2<=d.length&&d[1]=="type"?o+(l+"="+u+"&"):o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function zU(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function Ia(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+KU(t,n)+(r?" "+r:"")})}function WU(t,e){t.info(function(){return"TIMEOUT: "+e})}vp.prototype.info=function(){};function KU(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return cx(n)}catch{return e}}var Bs={},O1=null;function xp(){return O1=O1||new gt}Bs.Ta="serverreachability";function oM(t){Pt.call(this,Bs.Ta,t)}mt(oM,Pt);function el(t){let e=xp();St(e,new oM(e))}Bs.STAT_EVENT="statevent";function aM(t,e){Pt.call(this,Bs.STAT_EVENT,t),this.stat=e}mt(aM,Pt);function Gt(t){let e=xp();St(e,new aM(e,t))}Bs.Ua="timingevent";function cM(t,e){Pt.call(this,Bs.Ua,t),this.size=e}mt(cM,Pt);function sl(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return Y.setTimeout(function(){t()},e)}var wp={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},uM={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function hx(){}hx.prototype.h=null;function F1(t){return t.h||(t.h=t.i())}function lM(){}var ol={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function fx(){Pt.call(this,"d")}mt(fx,Pt);function px(){Pt.call(this,"c")}mt(px,Pt);var Wv;function Ep(){}mt(Ep,hx);Ep.prototype.g=function(){return new XMLHttpRequest};Ep.prototype.i=function(){return{}};Wv=new Ep;function al(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Ju(this),this.P=QU,t=Lv?125:void 0,this.V=new yp(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new dM}function dM(){this.i=null,this.g="",this.h=!1}var QU=45e3,hM={},Kv={};N=al.prototype;N.setTimeout=function(t){this.P=t};function Qv(t,e,n){t.L=1,t.A=Cp(Zr(e)),t.u=n,t.S=!0,fM(t,null)}function fM(t,e){t.G=Date.now(),cl(t),t.B=Zr(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),wM(n.i,"t",r),t.o=0,n=t.l.J,t.h=new dM,t.g=$M(t.l,n?e:null,!t.u),0<t.O&&(t.M=new zv(Nt(t.Pa,t,t.g),t.O)),iM(t.U,t.g,"readystatechange",t.nb),e=t.I?K1(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),el(),GU(t.j,t.v,t.B,t.m,t.W,t.u)}N.nb=function(t){t=t.target;let e=this.M;e&&xr(t)==3?e.l():this.Pa(t)};N.Pa=function(t){try{if(t==this.g)e:{let l=xr(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>l)&&(l!=3||Lv||this.g&&(this.h.h||this.g.ja()||B1(this.g)))){this.J||l!=4||e==7||(e==8||0>=d?el(3):el(2)),Ip(this);var n=this.g.da();this.ca=n;t:if(pM(this)){var r=B1(this.g);t="";var i=r.length,s=xr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Vs(this),Ku(this);var o="";break t}this.h.i=new Y.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,zU(this.j,this.v,this.B,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Qu(a)){var u=a;break t}}u=null}if(n=u)Ia(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Yv(this,n);else{this.i=!1,this.s=3,Gt(12),Vs(this),Ku(this);break e}}this.S?(gM(this,l,o),Lv&&this.i&&l==3&&(iM(this.U,this.V,"tick",this.mb),this.V.start())):(Ia(this.j,this.m,o,null),Yv(this,o)),l==4&&Vs(this),this.i&&!this.J&&(l==4?LM(this.l,this):(this.i=!1,cl(this)))}else m6(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,Gt(12)):(this.s=0,Gt(13)),Vs(this),Ku(this)}}}catch{}finally{}};function pM(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function gM(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=YU(t,n),i==Kv){e==4&&(t.s=4,Gt(14),r=!1),Ia(t.j,t.m,null,"[Incomplete Response]");break}else if(i==hM){t.s=4,Gt(15),Ia(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Ia(t.j,t.m,i,null),Yv(t,i);pM(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,Gt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),xx(e),e.M=!0,Gt(11))):(Ia(t.j,t.m,n,"[Invalid Chunked Response]"),Vs(t),Ku(t))}N.mb=function(){if(this.g){var t=xr(this.g),e=this.g.ja();this.o<e.length&&(Ip(this),gM(this,t,e),this.i&&t!=4&&cl(this))}};function YU(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?Kv:(n=Number(e.substring(n,r)),isNaN(n)?hM:(r+=1,r+n>e.length?Kv:(e=e.slice(r,r+n),t.o=r+n,e)))}N.cancel=function(){this.J=!0,Vs(this)};function cl(t){t.Y=Date.now()+t.P,mM(t,t.P)}function mM(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=sl(Nt(t.lb,t),e)}function Ip(t){t.C&&(Y.clearTimeout(t.C),t.C=null)}N.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(WU(this.j,this.B),this.L!=2&&(el(),Gt(17)),Vs(this),this.s=2,Ku(this)):mM(this,this.Y-t)};function Ku(t){t.l.H==0||t.J||LM(t.l,t)}function Vs(t){Ip(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,lx(t.V),sM(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Yv(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||Zv(n.i,t))){if(!t.K&&Zv(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)lp(n),Tp(n);else break e;vx(n),Gt(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=sl(Nt(n.ib,n),6e3));if(1>=CM(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Ls(n,11)}else if((t.K||n.g==t)&&lp(n),!Qu(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let u=i[e];if(n.V=u[0],u=u[1],n.H==2)if(u[0]=="c"){n.K=u[1],n.pa=u[2];let l=u[3];l!=null&&(n.ra=l,n.l.info("VER="+n.ra));let d=u[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let h=u[5];h!=null&&typeof h=="number"&&0<h&&(r=1.5*h,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let f=t.g;if(f){let p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=r.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(gx(s,s.h),s.h=null))}if(r.F){let m=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;m&&(r.Da=m,ke(r.I,r.F,m))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=UM(r,r.J?r.pa:null,r.Y),o.K){bM(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.C&&(Ip(a),cl(a)),r.g=o}else FM(r);0<n.j.length&&Sp(n)}else u[0]!="stop"&&u[0]!="close"||Ls(n,7);else n.H==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?Ls(n,7):yx(n):u[0]!="noop"&&n.h&&n.h.Aa(u),n.A=0)}}el(4)}catch{}}function ZU(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(pp(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function XU(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(pp(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function _M(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(pp(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=XU(t),r=ZU(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var yM=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function JU(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function js(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof js){this.h=t.h,cp(this,t.j),this.s=t.s,this.g=t.g,up(this,t.m),this.l=t.l;var e=t.i,n=new tl;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),V1(this,n),this.o=t.o}else t&&(e=String(t).match(yM))?(this.h=!1,cp(this,e[1]||"",!0),this.s=zu(e[2]||""),this.g=zu(e[3]||"",!0),up(this,e[4]),this.l=zu(e[5]||"",!0),V1(this,e[6]||"",!0),this.o=zu(e[7]||"")):(this.h=!1,this.i=new tl(null,this.h))}js.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Wu(e,L1,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Wu(e,L1,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Wu(n,n.charAt(0)=="/"?n6:t6,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Wu(n,i6)),t.join("")};function Zr(t){return new js(t)}function cp(t,e,n){t.j=n?zu(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function up(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function V1(t,e,n){e instanceof tl?(t.i=e,s6(t.i,t.h)):(n||(e=Wu(e,r6)),t.i=new tl(e,t.h))}function ke(t,e,n){t.i.set(e,n)}function Cp(t){return ke(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function zu(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Wu(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,e6),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function e6(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var L1=/[#\/\?@]/g,t6=/[#\?:]/g,n6=/[#\?]/g,r6=/[#\?@]/g,i6=/#/g;function tl(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ni(t){t.g||(t.g=new Map,t.h=0,t.i&&JU(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}N=tl.prototype;N.add=function(t,e){Ni(this),this.i=null,t=Da(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function vM(t,e){Ni(t),e=Da(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function xM(t,e){return Ni(t),e=Da(t,e),t.g.has(e)}N.forEach=function(t,e){Ni(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};N.ta=function(){Ni(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};N.Z=function(t){Ni(this);let e=[];if(typeof t=="string")xM(this,t)&&(e=e.concat(this.g.get(Da(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};N.set=function(t,e){return Ni(this),this.i=null,t=Da(this,t),xM(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};N.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function wM(t,e,n){vM(t,e),0<n.length&&(t.i=null,t.g.set(Da(t,e),tx(n)),t.h+=n.length)}N.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function Da(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function s6(t,e){e&&!t.j&&(Ni(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(vM(this,r),wM(this,i,n))},t)),t.j=e}var o6=class{constructor(t,e){this.g=t,this.map=e}};function EM(t){this.l=t||a6,Y.PerformanceNavigationTiming?(t=Y.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(Y.g&&Y.g.Ka&&Y.g.Ka()&&Y.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var a6=10;function IM(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function CM(t){return t.h?1:t.g?t.g.size:0}function Zv(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function gx(t,e){t.g?t.g.add(e):t.h=e}function bM(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}EM.prototype.cancel=function(){if(this.i=DM(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function DM(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return tx(t.i)}var c6=class{stringify(t){return Y.JSON.stringify(t,void 0)}parse(t){return Y.JSON.parse(t,void 0)}};function u6(){this.g=new c6}function l6(t,e,n){let r=n||"";try{_M(t,function(i,s){let o=i;rl(i)&&(o=cx(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function d6(t,e){let n=new vp;if(Y.Image){let r=new Image;r.onload=tp(op,n,r,"TestLoadImage: loaded",!0,e),r.onerror=tp(op,n,r,"TestLoadImage: error",!1,e),r.onabort=tp(op,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=tp(op,n,r,"TestLoadImage: timeout",!1,e),Y.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function op(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function ul(t){this.l=t.ec||null,this.j=t.ob||!1}mt(ul,hx);ul.prototype.g=function(){return new bp(this.l,this.j)};ul.prototype.i=function(t){return function(){return t}}({});function bp(t,e){gt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=mx,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}mt(bp,gt);var mx=0;N=bp.prototype;N.open=function(t,e){if(this.readyState!=mx)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,nl(this)};N.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Y).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};N.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ll(this)),this.readyState=mx};N.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,nl(this)),this.g&&(this.readyState=3,nl(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Y.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;TM(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function TM(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}N.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?ll(this):nl(this),this.readyState==3&&TM(this)}};N.Za=function(t){this.g&&(this.response=this.responseText=t,ll(this))};N.Ya=function(t){this.g&&(this.response=t,ll(this))};N.ka=function(){this.g&&ll(this)};function ll(t){t.readyState=4,t.l=null,t.j=null,t.A=null,nl(t)}N.setRequestHeader=function(t,e){this.v.append(t,e)};N.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};N.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function nl(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(bp.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var h6=Y.JSON.parse;function He(t){gt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=SM,this.L=this.M=!1}mt(He,gt);var SM="",f6=/^https?$/i,p6=["POST","PUT"];N=He.prototype;N.Oa=function(t){this.M=t};N.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Wv.g(),this.C=this.u?F1(this.u):F1(Wv),this.g.onreadystatechange=Nt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){j1(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=Y.FormData&&t instanceof Y.FormData,!(0<=q1(p6,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{RM(this),0<this.B&&((this.L=g6(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Nt(this.ua,this)):this.A=dx(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){j1(this,s)}};function g6(t){return ba&&typeof t.timeout=="number"&&t.ontimeout!==void 0}N.ua=function(){typeof ex<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,St(this,"timeout"),this.abort(8))};function j1(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,AM(t),Dp(t)}function AM(t){t.F||(t.F=!0,St(t,"complete"),St(t,"error"))}N.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,St(this,"complete"),St(this,"abort"),Dp(this))};N.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Dp(this,!0)),He.$.N.call(this)};N.La=function(){this.s||(this.G||this.v||this.l?MM(this):this.kb())};N.kb=function(){MM(this)};function MM(t){if(t.h&&typeof ex<"u"&&(!t.C[1]||xr(t)!=4||t.da()!=2)){if(t.v&&xr(t)==4)dx(t.La,0,t);else if(St(t,"readystatechange"),xr(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(yM)[1]||null;!i&&Y.self&&Y.self.location&&(i=Y.self.location.protocol.slice(0,-1)),r=!f6.test(i?i.toLowerCase():"")}n=r}if(n)St(t,"complete"),St(t,"success");else{t.m=6;try{var s=2<xr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",AM(t)}}finally{Dp(t)}}}}function Dp(t,e){if(t.g){RM(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||St(t,"ready");try{n.onreadystatechange=r}catch{}}}function RM(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Y.clearTimeout(t.A),t.A=null)}N.isActive=function(){return!!this.g};function xr(t){return t.g?t.g.readyState:0}N.da=function(){try{return 2<xr(this)?this.g.status:-1}catch{return-1}};N.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};N.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),h6(e)}};function B1(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case SM:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function m6(t){let e={};t=(t.g&&2<=xr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(Qu(t[r]))continue;var n=$U(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}LU(e,function(r){return r.join(", ")})}N.Ia=function(){return this.m};N.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function NM(t){let e="";return rx(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function _x(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=NM(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):ke(t,e,n))}function qu(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function PM(t){this.Ga=0,this.j=[],this.l=new vp,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=qu("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=qu("baseRetryDelayMs",5e3,t),this.hb=qu("retryDelaySeedMs",1e4,t),this.eb=qu("forwardChannelMaxRetries",2,t),this.xa=qu("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new EM(t&&t.concurrentRequestLimit),this.Ja=new u6,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}N=PM.prototype;N.ra=8;N.H=1;function yx(t){if(kM(t),t.H==3){var e=t.W++,n=Zr(t.I);if(ke(n,"SID",t.K),ke(n,"RID",e),ke(n,"TYPE","terminate"),dl(t,n),e=new al(t,t.l,e),e.L=2,e.A=Cp(Zr(n)),n=!1,Y.navigator&&Y.navigator.sendBeacon)try{n=Y.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&Y.Image&&(new Image().src=e.A,n=!0),n||(e.g=$M(e.l,null),e.g.ha(e.A)),e.G=Date.now(),cl(e)}BM(t)}function Tp(t){t.g&&(xx(t),t.g.cancel(),t.g=null)}function kM(t){Tp(t),t.u&&(Y.clearTimeout(t.u),t.u=null),lp(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&Y.clearTimeout(t.m),t.m=null)}function Sp(t){if(!IM(t.i)&&!t.m){t.m=!0;var e=t.Na;Zu||nM(),Xu||(Zu(),Xu=!0),ux.add(e,t),t.C=0}}function _6(t,e){return CM(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=sl(Nt(t.Na,t,e),jM(t,t.C)),t.C++,!0)}N.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new al(this,this.l,t),s=this.s;if(this.U&&(s?(s=K1(s),Q1(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=OM(this,i,e),n=Zr(this.I),ke(n,"RID",t),ke(n,"CVER",22),this.F&&ke(n,"X-HTTP-Session-Id",this.F),dl(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(NM(s)))+"&"+e:this.o&&_x(n,this.o,s)),gx(this.i,i),this.bb&&ke(n,"TYPE","init"),this.P?(ke(n,"$req",e),ke(n,"SID","null"),i.aa=!0,Qv(i,n,null)):Qv(i,n,e),this.H=2}}else this.H==3&&(t?U1(this,t):this.j.length==0||IM(this.i)||U1(this))};function U1(t,e){var n;e?n=e.m:n=t.W++;let r=Zr(t.I);ke(r,"SID",t.K),ke(r,"RID",n),ke(r,"AID",t.V),dl(t,r),t.o&&t.s&&_x(r,t.o,t.s),n=new al(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=OM(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),gx(t.i,n),Qv(n,r,e)}function dl(t,e){t.na&&rx(t.na,function(n,r){ke(e,r,n)}),t.h&&_M({},function(n,r){ke(e,r,n)})}function OM(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Nt(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<n;c++){let u=i[c].g,l=i[c].map;if(u-=s,0>u)s=Math.max(0,i[c].g-100),a=!1;else try{l6(l,o,"req"+u+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function FM(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Zu||nM(),Xu||(Zu(),Xu=!0),ux.add(e,t),t.A=0}}function vx(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=sl(Nt(t.Ma,t),jM(t,t.A)),t.A++,!0)}N.Ma=function(){if(this.u=null,VM(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=sl(Nt(this.jb,this),t)}};N.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Gt(10),Tp(this),VM(this))};function xx(t){t.B!=null&&(Y.clearTimeout(t.B),t.B=null)}function VM(t){t.g=new al(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Zr(t.wa);ke(e,"RID","rpc"),ke(e,"SID",t.K),ke(e,"AID",t.V),ke(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&ke(e,"TO",t.qa),ke(e,"TYPE","xmlhttp"),dl(t,e),t.o&&t.s&&_x(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=Cp(Zr(e)),n.u=null,n.S=!0,fM(n,t)}N.ib=function(){this.v!=null&&(this.v=null,Tp(this),vx(this),Gt(19))};function lp(t){t.v!=null&&(Y.clearTimeout(t.v),t.v=null)}function LM(t,e){var n=null;if(t.g==e){lp(t),xx(t),t.g=null;var r=2}else if(Zv(t.i,e))n=e.F,bM(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=xp(),St(r,new cM(r,n)),Sp(t)}else FM(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&_6(t,e)||r==2&&vx(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Ls(t,5);break;case 4:Ls(t,10);break;case 3:Ls(t,6);break;default:Ls(t,2)}}}function jM(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Ls(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Nt(t.pb,t);n||(n=new js("//www.google.com/images/cleardot.gif"),Y.location&&Y.location.protocol=="http"||cp(n,"https"),Cp(n)),d6(n.toString(),r)}else Gt(2);t.H=0,t.h&&t.h.za(e),BM(t),kM(t)}N.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Gt(2)):(this.l.info("Failed to ping google.com"),Gt(1))};function BM(t){if(t.H=0,t.ma=[],t.h){let e=DM(t.i);(e.length!=0||t.j.length!=0)&&(N1(t.ma,e),N1(t.ma,t.j),t.i.i.length=0,tx(t.j),t.j.length=0),t.h.ya()}}function UM(t,e,n){var r=n instanceof js?Zr(n):new js(n);if(r.g!="")e&&(r.g=e+"."+r.g),up(r,r.m);else{var i=Y.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new js(null);r&&cp(s,r),e&&(s.g=e),i&&up(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&ke(r,n,e),ke(r,"VER",t.ra),dl(t,r),r}function $M(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new He(new ul({ob:n})):new He(t.va),e.Oa(t.J),e}N.isActive=function(){return!!this.h&&this.h.isActive(this)};function HM(){}N=HM.prototype;N.Ba=function(){};N.Aa=function(){};N.za=function(){};N.ya=function(){};N.isActive=function(){return!0};N.Va=function(){};function dp(){if(ba&&!(10<=Number(kU)))throw Error("Environmental error: no available transport.")}dp.prototype.g=function(t,e){return new mn(t,e)};function mn(t,e){gt.call(this),this.g=new PM(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Qu(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Qu(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Ta(this)}mt(mn,gt);mn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Gt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=UM(t,null,t.Y),Sp(t)};mn.prototype.close=function(){yx(this.g)};mn.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=cx(t),t=n);e.j.push(new o6(e.fb++,t)),e.H==3&&Sp(e)};mn.prototype.N=function(){this.g.h=null,delete this.j,yx(this.g),delete this.g,mn.$.N.call(this)};function qM(t){fx.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}mt(qM,fx);function GM(){px.call(this),this.status=1}mt(GM,px);function Ta(t){this.g=t}mt(Ta,HM);Ta.prototype.Ba=function(){St(this.g,"a")};Ta.prototype.Aa=function(t){St(this.g,new qM(t))};Ta.prototype.za=function(t){St(this.g,new GM)};Ta.prototype.ya=function(){St(this.g,"b")};function y6(){this.blockSize=-1}function Zn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}mt(Zn,y6);Zn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Vv(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}Zn.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)Vv(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){Vv(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){Vv(this,r),i=0;break}}this.h=i,this.i+=e};Zn.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function Ie(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var v6={};function wx(t){return-128<=t&&128>t?RU(t,function(e){return new Ie([e|0],0>e?-1:0)}):new Ie([t|0],0>t?-1:0)}function wr(t){if(isNaN(t)||!isFinite(t))return Ca;if(0>t)return Tt(wr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=Xv;return new Ie(e,0)}function zM(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Tt(zM(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=wr(Math.pow(e,8)),r=Ca,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=wr(Math.pow(e,s)),r=r.R(s).add(wr(o))):(r=r.R(n),r=r.add(wr(o)))}return r}var Xv=4294967296,Ca=wx(0),Jv=wx(1),$1=wx(16777216);N=Ie.prototype;N.ea=function(){if(Nn(this))return-Tt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:Xv+r)*e,e*=Xv}return t};N.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Yr(this))return"0";if(Nn(this))return"-"+Tt(this).toString(t);for(var e=wr(Math.pow(t,6)),n=this,r="";;){var i=fp(n,e).g;n=hp(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Yr(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};N.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Yr(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Nn(t){return t.h==-1}N.X=function(t){return t=hp(this,t),Nn(t)?-1:Yr(t)?0:1};function Tt(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Ie(n,~t.h).add(Jv)}N.abs=function(){return Nn(this)?Tt(this):this};N.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new Ie(n,n[n.length-1]&-2147483648?-1:0)};function hp(t,e){return t.add(Tt(e))}N.R=function(t){if(Yr(this)||Yr(t))return Ca;if(Nn(this))return Nn(t)?Tt(this).R(Tt(t)):Tt(Tt(this).R(t));if(Nn(t))return Tt(this.R(Tt(t)));if(0>this.X($1)&&0>t.X($1))return wr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,c=t.D(i)&65535;n[2*r+2*i]+=o*c,ap(n,2*r+2*i),n[2*r+2*i+1]+=s*c,ap(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,ap(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,ap(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Ie(n,0)};function ap(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Gu(t,e){this.g=t,this.h=e}function fp(t,e){if(Yr(e))throw Error("division by zero");if(Yr(t))return new Gu(Ca,Ca);if(Nn(t))return e=fp(Tt(t),e),new Gu(Tt(e.g),Tt(e.h));if(Nn(e))return e=fp(t,Tt(e)),new Gu(Tt(e.g),e.h);if(30<t.g.length){if(Nn(t)||Nn(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Jv,r=e;0>=r.X(t);)n=H1(n),r=H1(r);var i=Ea(n,1),s=Ea(r,1);for(r=Ea(r,2),n=Ea(n,2);!Yr(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=Ea(r,1),n=Ea(n,1)}return e=hp(t,i.R(e)),new Gu(i,e)}for(i=Ca;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=wr(n),o=s.R(e);Nn(o)||0<o.X(t);)n-=r,s=wr(n),o=s.R(e);Yr(s)&&(s=Jv),i=i.add(s),t=hp(t,o)}return new Gu(i,t)}N.gb=function(t){return fp(this,t).h};N.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Ie(n,this.h&t.h)};N.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Ie(n,this.h|t.h)};N.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Ie(n,this.h^t.h)};function H1(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Ie(n,t.h)}function Ea(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new Ie(i,t.h)}dp.prototype.createWebChannel=dp.prototype.g;mn.prototype.send=mn.prototype.u;mn.prototype.open=mn.prototype.m;mn.prototype.close=mn.prototype.close;wp.NO_ERROR=0;wp.TIMEOUT=8;wp.HTTP_ERROR=6;uM.COMPLETE="complete";lM.EventType=ol;ol.OPEN="a";ol.CLOSE="b";ol.ERROR="c";ol.MESSAGE="d";gt.prototype.listen=gt.prototype.O;He.prototype.listenOnce=He.prototype.P;He.prototype.getLastError=He.prototype.Sa;He.prototype.getLastErrorCode=He.prototype.Ia;He.prototype.getStatus=He.prototype.da;He.prototype.getResponseJson=He.prototype.Wa;He.prototype.getResponseText=He.prototype.ja;He.prototype.send=He.prototype.ha;He.prototype.setWithCredentials=He.prototype.Oa;Zn.prototype.digest=Zn.prototype.l;Zn.prototype.reset=Zn.prototype.reset;Zn.prototype.update=Zn.prototype.j;Ie.prototype.add=Ie.prototype.add;Ie.prototype.multiply=Ie.prototype.R;Ie.prototype.modulo=Ie.prototype.gb;Ie.prototype.compare=Ie.prototype.X;Ie.prototype.toNumber=Ie.prototype.ea;Ie.prototype.toString=Ie.prototype.toString;Ie.prototype.getBits=Ie.prototype.D;Ie.fromNumber=wr;Ie.fromString=zM;var WM=Xn.createWebChannelTransport=function(){return new dp},KM=Xn.getStatEventTarget=function(){return xp()},Ap=Xn.ErrorCode=wp,QM=Xn.EventType=uM,YM=Xn.Event=Bs,Ex=Xn.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},fte=Xn.FetchXmlHttpFactory=ul,hl=Xn.WebChannel=lM,ZM=Xn.XhrIo=He,XM=Xn.Md5=Zn,Us=Xn.Integer=Ie;var JM="@firebase/firestore";var st=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};st.UNAUTHENTICATED=new st(null),st.GOOGLE_CREDENTIALS=new st("google-credentials-uid"),st.FIRST_PARTY=new st("first-party-uid"),st.MOCK_USER=new st("mock-user");var ic="10.10.0";var ji=new li("@firebase/firestore");function Na(){return ji.logLevel}function JR(t){ji.setLogLevel(t)}function I(t,...e){if(ji.logLevel<=Cn.DEBUG){let n=e.map(bE);ji.debug(`Firestore (${ic}): ${t}`,...n)}}function Ke(t,...e){if(ji.logLevel<=Cn.ERROR){let n=e.map(bE);ji.error(`Firestore (${ic}): ${t}`,...n)}}function kn(t,...e){if(ji.logLevel<=Cn.WARN){let n=e.map(bE);ji.warn(`Firestore (${ic}): ${t}`,...n)}}function bE(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function k(t="Unexpected state"){let e=`FIRESTORE (${ic}) INTERNAL ASSERTION FAILED: `+t;throw Ke(e),new Error(e)}function L(t,e){t||k()}function eN(t,e){t||k()}function R(t,e){return t}var y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},w=class extends Tb{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ot=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var Bp=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Tx=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(st.UNAUTHENTICATED))}shutdown(){}},Sx=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},Ax=class{constructor(e){this.t=e,this.currentUser=st.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve(),s=new ot;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ot,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>g(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{I("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(I("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ot)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(I("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(L(typeof r.accessToken=="string"),new Bp(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return L(e===null||typeof e=="string"),new st(e)}},Mx=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=st.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Rx=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new Mx(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(st.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Nx=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Px=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&I("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,I("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{I("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):I("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(L(typeof n.token=="string"),this.R=n.token,new Nx(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function w6(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Up=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=w6(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function J(t,e){return t<e?-1:t>e?1:0}function Ua(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function tN(t){return t+"\0"}var Be=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new w(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new w(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new w(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new w(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?J(this.nanoseconds,e.nanoseconds):J(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var U=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new Be(0,0))}static max(){return new t(new Be(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var $p=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&k(),r===void 0?r=e.length-n:r>e.length-n&&k(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},me=class t extends $p{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new w(y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},E6=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Qe=class t extends $p{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return E6.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new w(y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new w(y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new w(y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new w(y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var M=class t{constructor(e){this.path=e}static fromPath(e){return new t(me.fromString(e))}static fromName(e){return new t(me.fromString(e).popFirst(5))}static empty(){return new t(me.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&me.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return me.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new me(e.slice()))}};var $a=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};function kx(t){return t.fields.find(e=>e.kind===2)}function Hs(t){return t.fields.filter(e=>e.kind!==2)}$a.UNKNOWN_ID=-1;var La=class{constructor(e,n){this.fieldPath=e,this.kind=n}};var Cl=class t{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new t(0,On.min())}};function nN(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=U.fromTimestamp(r===1e9?new Be(n+1,0):new Be(n,r));return new On(i,M.empty(),e)}function rN(t){return new On(t.readTime,t.key,-1)}var On=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(U.min(),M.empty(),-1)}static max(){return new t(U.max(),M.empty(),-1)}};function DE(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=M.comparator(t.documentKey,e.documentKey),n!==0?n:J(t.largestBatchId,e.largestBatchId))}var iN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Hp=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Qi(t){return g(this,null,function*(){if(t.code!==y.FAILED_PRECONDITION||t.message!==iN)throw t;I("LocalStore","Unexpectedly lost primary lease")})}var _=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&k(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let u=c;n(e[u]).next(l=>{o[u]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};var qp=class t{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new ot,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Qs(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=TE(r.target.error);this.V.reject(new Qs(e,i))}}static open(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(s){throw new Qs(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(I("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let n=this.transaction.objectStore(e);return new Fx(n)}},ei=class t{constructor(e,n,r){this.name=e,this.version=n,this.p=r,t.S(Vc())===12.2&&Ke("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return I("SimpleDb","Removing database:",e),qs(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Hd())return!1;if(t.C())return!0;let e=Vc(),n=t.S(e),r=0<n&&n<10,i=t.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,n){return e.store(n)}static S(e){let n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){let n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){return g(this,null,function*(){return this.db||(I("SimpleDb","Opening database:",this.name),this.db=yield new Promise((n,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;n(o)},i.onblocked=()=>{r(new Qs(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new w(y.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new w(y.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Qs(e,o))},i.onupgradeneeded=s=>{I("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.N(o,i.transaction,s.oldVersion,this.version).next(()=>{I("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.L&&(this.db.onversionchange=n=>this.L(n)),this.db})}B(e){this.L=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){return g(this,null,function*(){let s=n==="readonly",o=0;for(;;){++o;try{this.db=yield this.O(e);let a=qp.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(u=>(a.g(),u)).catch(u=>(a.abort(u),_.reject(u))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,u=c.name!=="FirebaseError"&&o<3;if(I("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}},Ox=class{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return qs(this.k.delete())}},Qs=class extends w{constructor(e,n){super(y.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}};function Yi(t){return t.name==="IndexedDbTransactionError"}var Fx=class{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(I("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(I("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),qs(r)}add(e){return I("SimpleDb","ADD",this.store.name,e,e),qs(this.store.add(e))}get(e){return qs(this.store.get(e)).next(n=>(n===void 0&&(n=null),I("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return I("SimpleDb","DELETE",this.store.name,e),qs(this.store.delete(e))}count(){return I("SimpleDb","COUNT",this.store.name),qs(this.store.count())}W(e,n){let r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new _((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.G(s,(a,c)=>{o.push(c)}).next(()=>o)}}j(e,n){let r=this.store.getAll(e,n===null?void 0:n);return new _((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,n){I("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,n);r.J=!1;let i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,n){let r;n?r=e:(r={},n=e);let i=this.cursor(r);return this.G(i,n)}Z(e){let n=this.cursor({});return new _((r,i)=>{n.onerror=s=>{let o=TE(s.target.error);i(o)},n.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){let r=[];return new _((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new Ox(a),u=n(a.primaryKey,a.value,c);if(u instanceof _){let l=u.catch(d=>(c.done(),_.reject(d)));r.push(l)}c.isDone?i():c.$===null?a.continue():a.continue(c.$)}}).next(()=>_.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){let r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}};function qs(t){return new _((e,n)=>{t.onsuccess=r=>{let i=r.target.result;e(i)},t.onerror=r=>{let i=TE(r.target.error);n(i)}})}var eR=!1;function TE(t){let e=ei.S(Vc());if(e>=12.2&&e<13){let n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){let r=new w("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return eR||(eR=!0,setTimeout(()=>{throw r},0)),r}}return t}var Vx=class{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){I("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>g(this,null,function*(){this.task=null;try{I("IndexBackfiller",`Documents written: ${yield this.X.te()}`)}catch(n){Yi(n)?I("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):yield Qi(n)}yield this.ee(6e4)}))}},Lx=class{constructor(e,n){this.localStore=e,this.persistence=n}te(e=50){return g(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.ne(n,e))})}ne(e,n){let r=new Set,i=n,s=!0;return _.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return I("IndexBackfiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(I("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{let o=rN(s);DE(o,r)>0&&(r=o)}),new On(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}};var _n=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function zl(t){return t==null}function bl(t){return t===0&&1/t==-1/0}function sN(t){return typeof t=="number"&&Number.isInteger(t)&&!bl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function zt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=tR(e)),e=I6(t.get(n),e);return tR(e)}function I6(t,e){let n=e,r=t.length;for(let i=0;i<r;i++){let s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function tR(t){return t+""}function Er(t){let e=t.length;if(L(e>=2),e===2)return L(t.charAt(0)===""&&t.charAt(1)===""),me.emptyPath();let n=e-2,r=[],i="";for(let s=0;s<e;){let o=t.indexOf("",s);switch((o<0||o>n)&&k(),t.charAt(o+1)){case"":let a=t.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:k()}s=o+2}return new me(r)}var nR=["userId","batchId"];function kp(t,e){return[t,zt(e)]}function oN(t,e,n){return[t,zt(e),n]}var C6={},b6=["prefixPath","collectionGroup","readTime","documentId"],D6=["prefixPath","collectionGroup","documentId"],T6=["collectionGroup","readTime","prefixPath","documentId"],S6=["canonicalId","targetId"],A6=["targetId","path"],M6=["path","targetId"],R6=["collectionId","parent"],N6=["indexId","uid"],P6=["uid","sequenceNumber"],k6=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],O6=["indexId","uid","orderedDocumentKey"],F6=["userId","collectionPath","documentId"],V6=["userId","collectionPath","largestBatchId"],L6=["userId","collectionGroup","largestBatchId"],aN=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],j6=[...aN,"documentOverlays"],cN=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],uN=cN,B6=[...uN,"indexConfiguration","indexState","indexEntries"];var Dl=class extends Hp{constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}};function yt(t,e){let n=R(t);return ei.M(n.ae,e)}function rR(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ao(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function lN(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Oe=class t{constructor(e,n){this.comparator=e,this.root=n||Cr.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Cr.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Cr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Va(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Va(this.root,e,this.comparator,!1)}getReverseIterator(){return new Va(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Va(this.root,e,this.comparator,!0)}},Va=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Cr=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw k();let e=this.left.check();if(e!==this.right.check())throw k();return e+(this.isRed()?0:1)}};Cr.EMPTY=null,Cr.RED=!0,Cr.BLACK=!1;Cr.EMPTY=new class{constructor(){this.size=0}get key(){throw k()}get value(){throw k()}get color(){throw k()}get left(){throw k()}get right(){throw k()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Cr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Se=class t{constructor(e){this.comparator=e,this.data=new Oe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Gp(this.data.getIterator())}getIteratorFrom(e){return new Gp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},Gp=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Sa(t){return t.hasNext()?t.getNext():void 0}var yn=class t{constructor(e){this.fields=e,e.sort(Qe.comparator)}static empty(){return new t([])}unionWith(e){let n=new Se(Qe.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ua(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var zp=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function dN(){return typeof atob<"u"}var _t=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new zp("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return J(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};_t.EMPTY_BYTE_STRING=new _t("");var U6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bi(t){if(L(!!t),typeof t=="string"){let e=0,n=U6.exec(t);if(L(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:qe(t.seconds),nanos:qe(t.nanos)}}function qe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ui(t){return typeof t=="string"?_t.fromBase64String(t):_t.fromUint8Array(t)}function Fg(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function SE(t){let e=t.mapValue.fields.__previous_value__;return Fg(e)?SE(e):e}function Tl(t){let e=Bi(t.mapValue.fields.__local_write_time__.timestampValue);return new Be(e.seconds,e.nanos)}var jx=class{constructor(e,n,r,i,s,o,a,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}},$i=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var Vi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Op={nullValue:"NULL_VALUE"};function Ys(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Fg(t)?4:hN(t)?9007199254740991:10:k()}function Tr(t,e){if(t===e)return!0;let n=Ys(t);if(n!==Ys(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Tl(t).isEqual(Tl(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Bi(i.timestampValue),a=Bi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Ui(i.bytesValue).isEqual(Ui(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return qe(i.geoPointValue.latitude)===qe(s.geoPointValue.latitude)&&qe(i.geoPointValue.longitude)===qe(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return qe(i.integerValue)===qe(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=qe(i.doubleValue),a=qe(s.doubleValue);return o===a?bl(o)===bl(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Ua(t.arrayValue.values||[],e.arrayValue.values||[],Tr);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(rR(o)!==rR(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Tr(o[c],a[c])))return!1;return!0}(t,e);default:return k()}}function Sl(t,e){return(t.values||[]).find(n=>Tr(n,e))!==void 0}function Hi(t,e){if(t===e)return 0;let n=Ys(t),r=Ys(e);if(n!==r)return J(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return J(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=qe(s.integerValue||s.doubleValue),c=qe(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return iR(t.timestampValue,e.timestampValue);case 4:return iR(Tl(t),Tl(e));case 5:return J(t.stringValue,e.stringValue);case 6:return function(s,o){let a=Ui(s),c=Ui(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){let l=J(a[u],c[u]);if(l!==0)return l}return J(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=J(qe(s.latitude),qe(o.latitude));return a!==0?a:J(qe(s.longitude),qe(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let u=0;u<a.length&&u<c.length;++u){let l=Hi(a[u],c[u]);if(l)return l}return J(a.length,c.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Vi.mapValue&&o===Vi.mapValue)return 0;if(s===Vi.mapValue)return 1;if(o===Vi.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),u=o.fields||{},l=Object.keys(u);c.sort(),l.sort();for(let d=0;d<c.length&&d<l.length;++d){let h=J(c[d],l[d]);if(h!==0)return h;let f=Hi(a[c[d]],u[l[d]]);if(f!==0)return f}return J(c.length,l.length)}(t.mapValue,e.mapValue);default:throw k()}}function iR(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return J(t,e);let n=Bi(t),r=Bi(e),i=J(n.seconds,r.seconds);return i!==0?i:J(n.nanos,r.nanos)}function Ha(t){return Bx(t)}function Bx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=Bi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ui(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return M.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=Bx(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${Bx(n.fields[o])}`;return i+"}"}(t.mapValue):k()}function Zs(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Ux(t){return!!t&&"integerValue"in t}function Al(t){return!!t&&"arrayValue"in t}function sR(t){return!!t&&"nullValue"in t}function oR(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Fp(t){return!!t&&"mapValue"in t}function vl(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return ao(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=vl(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=vl(t.arrayValue.values[n]);return e}return Object.assign({},t)}function hN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function $6(t){return"nullValue"in t?Op:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Zs($i.empty(),M.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:k()}function H6(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Zs($i.empty(),M.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Vi:k()}function aR(t,e){let n=Hi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function cR(t,e){let n=Hi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}var Ot=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Fp(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=vl(n)}setAll(e){let n=Qe.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=vl(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());Fp(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Tr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Fp(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){ao(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(vl(this.value))}};function fN(t){let e=[];return ao(t.fields,(n,r)=>{let i=new Qe([n]);if(Fp(r)){let s=fN(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new yn(e)}var at=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,U.min(),U.min(),U.min(),Ot.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,U.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,U.min(),U.min(),Ot.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,U.min(),U.min(),Ot.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(U.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ot.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ot.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=U.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Sr=class{constructor(e,n){this.position=e,this.inclusive=n}};function uR(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=M.comparator(M.fromName(o.referenceValue),n.key):r=Hi(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function lR(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Tr(t.position[n],e.position[n]))return!1;return!0}var Xs=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function q6(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Wp=class{},fe=class t extends Wp{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new qx(e,n,r):n==="array-contains"?new Wx(e,r):n==="in"?new Kp(e,r):n==="not-in"?new Kx(e,r):n==="array-contains-any"?new Qx(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new Gx(e,r):new zx(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Hi(n,this.value)):n!==null&&Ys(this.value)===Ys(n)&&this.matchesComparison(Hi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return k()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ce=class t extends Wp{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new t(e,n)}matches(e){return qa(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}};function qa(t){return t.op==="and"}function $x(t){return t.op==="or"}function AE(t){return pN(t)&&qa(t)}function pN(t){for(let e of t.filters)if(e instanceof Ce)return!1;return!0}function Hx(t){if(t instanceof fe)return t.field.canonicalString()+t.op.toString()+Ha(t.value);if(AE(t))return t.filters.map(e=>Hx(e)).join(",");{let e=t.filters.map(n=>Hx(n)).join(",");return`${t.op}(${e})`}}function gN(t,e){return t instanceof fe?function(r,i){return i instanceof fe&&r.op===i.op&&r.field.isEqual(i.field)&&Tr(r.value,i.value)}(t,e):t instanceof Ce?function(r,i){return i instanceof Ce&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&gN(o,i.filters[a]),!0):!1}(t,e):void k()}function mN(t,e){let n=t.filters.concat(e);return Ce.create(n,t.op)}function _N(t){return t instanceof fe?function(n){return`${n.field.canonicalString()} ${n.op} ${Ha(n.value)}`}(t):t instanceof Ce?function(n){return n.op.toString()+" {"+n.getFilters().map(_N).join(" ,")+"}"}(t):"Filter"}var qx=class extends fe{constructor(e,n,r){super(e,n,r),this.key=M.fromName(r.referenceValue)}matches(e){let n=M.comparator(e.key,this.key);return this.matchesComparison(n)}},Gx=class extends fe{constructor(e,n){super(e,"in",n),this.keys=yN("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},zx=class extends fe{constructor(e,n){super(e,"not-in",n),this.keys=yN("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function yN(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>M.fromName(r.referenceValue))}var Wx=class extends fe{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return Al(n)&&Sl(n.arrayValue,this.value)}},Kp=class extends fe{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&Sl(this.value.arrayValue,n)}},Kx=class extends fe{constructor(e,n){super(e,"not-in",n)}matches(e){if(Sl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!Sl(this.value.arrayValue,n)}},Qx=class extends fe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!Al(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Sl(this.value.arrayValue,r))}};var Yx=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}};function Zx(t,e=null,n=[],r=[],i=null,s=null,o=null){return new Yx(t,e,n,r,i,s,o)}function Js(t){let e=R(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Hx(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),zl(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ha(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ha(r)).join(",")),e.ce=n}return e.ce}function Wl(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!q6(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!gN(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!lR(t.startAt,e.startAt)&&lR(t.endAt,e.endAt)}function Qp(t){return M.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Yp(t,e){return t.filters.filter(n=>n instanceof fe&&n.field.isEqual(e))}function dR(t,e,n){let r=Op,i=!0;for(let s of Yp(t,e)){let o=Op,a=!0;switch(s.op){case"<":case"<=":o=$6(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Op}aR({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];aR({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function hR(t,e,n){let r=Vi,i=!0;for(let s of Yp(t,e)){let o=Vi,a=!0;switch(s.op){case">=":case">":o=H6(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Vi}cR({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];cR({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}var Jn=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}};function vN(t,e,n,r,i,s,o,a){return new Jn(t,e,n,r,i,s,o,a)}function sc(t){return new Jn(t)}function fR(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function ME(t){return t.collectionGroup!==null}function ja(t){let e=R(t);if(e.le===null){e.le=[];let n=new Set;for(let s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Se(Qe.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new Xs(s,r))}),n.has(Qe.keyField().canonicalString())||e.le.push(new Xs(Qe.keyField(),r))}return e.le}function Wt(t){let e=R(t);return e.he||(e.he=G6(e,ja(t))),e.he}function G6(t,e){if(t.limitType==="F")return Zx(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Xs(i.field,s)});let n=t.endAt?new Sr(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Sr(t.startAt.position,t.startAt.inclusive):null;return Zx(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Xx(t,e){let n=t.filters.concat([e]);return new Jn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Zp(t,e,n){return new Jn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Kl(t,e){return Wl(Wt(t),Wt(e))&&t.limitType===e.limitType}function xN(t){return`${Js(Wt(t))}|lt:${t.limitType}`}function Pa(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>_N(i)).join(", ")}]`),zl(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Ha(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Ha(i)).join(",")),`Target(${r})`}(Wt(t))}; limitType=${t.limitType})`}function Ql(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):M.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of ja(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let u=uR(o,a,c);return o.inclusive?u<=0:u<0}(r.startAt,ja(r),i)||r.endAt&&!function(o,a,c){let u=uR(o,a,c);return o.inclusive?u>=0:u>0}(r.endAt,ja(r),i))}(t,e)}function wN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function EN(t){return(e,n)=>{let r=!1;for(let i of ja(t)){let s=z6(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function z6(t,e,n){let r=t.field.isKeyField()?M.comparator(e.key,n.key):function(s,o,a){let c=o.data.field(s),u=a.data.field(s);return c!==null&&u!==null?Hi(c,u):k()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return k()}}var Ar=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ao(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return lN(this.inner)}size(){return this.innerSize}};var W6=new Oe(M.comparator);function ln(){return W6}var IN=new Oe(M.comparator);function _l(...t){let e=IN;for(let n of t)e=e.insert(n.key,n);return e}function CN(t){let e=IN;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Ir(){return xl()}function bN(){return xl()}function xl(){return new Ar(t=>t.toString(),(t,e)=>t.isEqual(e))}var K6=new Oe(M.comparator),Q6=new Se(M.comparator);function te(...t){let e=Q6;for(let n of t)e=e.add(n);return e}var Y6=new Se(J);function RE(){return Y6}function DN(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:bl(e)?"-0":e}}function TN(t){return{integerValue:""+t}}function SN(t,e){return sN(e)?TN(e):DN(t,e)}var Ga=class{constructor(){this._=void 0}};function Z6(t,e,n){return t instanceof qi?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Fg(s)&&(s=SE(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof ti?MN(t,e):t instanceof ni?RN(t,e):function(i,s){let o=AN(i,s),a=pR(o)+pR(i.Ie);return Ux(o)&&Ux(i.Ie)?TN(a):DN(i.serializer,a)}(t,e)}function X6(t,e,n){return t instanceof ti?MN(t,e):t instanceof ni?RN(t,e):n}function AN(t,e){return t instanceof Gi?function(r){return Ux(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var qi=class extends Ga{},ti=class extends Ga{constructor(e){super(),this.elements=e}};function MN(t,e){let n=NN(e);for(let r of t.elements)n.some(i=>Tr(i,r))||n.push(r);return{arrayValue:{values:n}}}var ni=class extends Ga{constructor(e){super(),this.elements=e}};function RN(t,e){let n=NN(e);for(let r of t.elements)n=n.filter(i=>!Tr(i,r));return{arrayValue:{values:n}}}var Gi=class extends Ga{constructor(e,n){super(),this.serializer=e,this.Ie=n}};function pR(t){return qe(t.integerValue||t.doubleValue)}function NN(t){return Al(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var eo=class{constructor(e,n){this.field=e,this.transform=n}};function J6(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof ti&&i instanceof ti||r instanceof ni&&i instanceof ni?Ua(r.elements,i.elements,Tr):r instanceof Gi&&i instanceof Gi?Tr(r.Ie,i.Ie):r instanceof qi&&i instanceof qi}(t.transform,e.transform)}var Jx=class{constructor(e,n){this.version=e,this.transformResults=n}},Ge=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Vp(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var za=class{};function PN(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Wi(t.key,Ge.none()):new zi(t.key,t.data,Ge.none());{let n=t.data,r=Ot.empty(),i=new Se(Qe.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new er(t.key,r,new yn(i.toArray()),Ge.none())}}function e8(t,e,n){t instanceof zi?function(i,s,o){let a=i.value.clone(),c=mR(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof er?function(i,s,o){if(!Vp(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=mR(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(kN(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function wl(t,e,n,r){return t instanceof zi?function(s,o,a,c){if(!Vp(s.precondition,o))return a;let u=s.value.clone(),l=_R(s.fieldTransforms,c,o);return u.setAll(l),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof er?function(s,o,a,c){if(!Vp(s.precondition,o))return a;let u=_R(s.fieldTransforms,c,o),l=o.data;return l.setAll(kN(s)),l.setAll(u),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,o,a){return Vp(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function t8(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=AN(r.transform,i||null);s!=null&&(n===null&&(n=Ot.empty()),n.set(r.field,s))}return n||null}function gR(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ua(r,i,(s,o)=>J6(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var zi=class extends za{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},er=class extends za{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function kN(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function mR(t,e,n){let r=new Map;L(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,X6(o,a,n[i]))}return r}function _R(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,Z6(s,o,e))}return r}var Wi=class extends za{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Ml=class extends za{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Rl=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&e8(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=wl(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=wl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=bN();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let c=PN(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(U.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),te())}isEqual(e){return this.batchId===e.batchId&&Ua(this.mutations,e.mutations,(n,r)=>gR(n,r))&&Ua(this.baseMutations,e.baseMutations,(n,r)=>gR(n,r))}},ew=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){L(e.mutations.length===r.length);let i=function(){return K6}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var Nl=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var tw=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var rt,ge;function ON(t){switch(t){default:return k();case y.CANCELLED:case y.UNKNOWN:case y.DEADLINE_EXCEEDED:case y.RESOURCE_EXHAUSTED:case y.INTERNAL:case y.UNAVAILABLE:case y.UNAUTHENTICATED:return!1;case y.INVALID_ARGUMENT:case y.NOT_FOUND:case y.ALREADY_EXISTS:case y.PERMISSION_DENIED:case y.FAILED_PRECONDITION:case y.ABORTED:case y.OUT_OF_RANGE:case y.UNIMPLEMENTED:case y.DATA_LOSS:return!0}}function FN(t){if(t===void 0)return Ke("GRPC error has no .code"),y.UNKNOWN;switch(t){case rt.OK:return y.OK;case rt.CANCELLED:return y.CANCELLED;case rt.UNKNOWN:return y.UNKNOWN;case rt.DEADLINE_EXCEEDED:return y.DEADLINE_EXCEEDED;case rt.RESOURCE_EXHAUSTED:return y.RESOURCE_EXHAUSTED;case rt.INTERNAL:return y.INTERNAL;case rt.UNAVAILABLE:return y.UNAVAILABLE;case rt.UNAUTHENTICATED:return y.UNAUTHENTICATED;case rt.INVALID_ARGUMENT:return y.INVALID_ARGUMENT;case rt.NOT_FOUND:return y.NOT_FOUND;case rt.ALREADY_EXISTS:return y.ALREADY_EXISTS;case rt.PERMISSION_DENIED:return y.PERMISSION_DENIED;case rt.FAILED_PRECONDITION:return y.FAILED_PRECONDITION;case rt.ABORTED:return y.ABORTED;case rt.OUT_OF_RANGE:return y.OUT_OF_RANGE;case rt.UNIMPLEMENTED:return y.UNIMPLEMENTED;case rt.DATA_LOSS:return y.DATA_LOSS;default:return k()}}(ge=rt||(rt={}))[ge.OK=0]="OK",ge[ge.CANCELLED=1]="CANCELLED",ge[ge.UNKNOWN=2]="UNKNOWN",ge[ge.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ge[ge.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ge[ge.NOT_FOUND=5]="NOT_FOUND",ge[ge.ALREADY_EXISTS=6]="ALREADY_EXISTS",ge[ge.PERMISSION_DENIED=7]="PERMISSION_DENIED",ge[ge.UNAUTHENTICATED=16]="UNAUTHENTICATED",ge[ge.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ge[ge.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ge[ge.ABORTED=10]="ABORTED",ge[ge.OUT_OF_RANGE=11]="OUT_OF_RANGE",ge[ge.UNIMPLEMENTED=12]="UNIMPLEMENTED",ge[ge.INTERNAL=13]="INTERNAL",ge[ge.UNAVAILABLE=14]="UNAVAILABLE",ge[ge.DATA_LOSS=15]="DATA_LOSS";var yR=null;function VN(){return new TextEncoder}var n8=new Us([4294967295,4294967295],0);function vR(t){let e=VN().encode(t),n=new XM;return n.update(e),new Uint8Array(n.digest())}function xR(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Us([n,r],0),new Us([i,s],0)]}var nw=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ks(`Invalid padding: ${n}`);if(r<0)throw new Ks(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ks(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ks(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=Us.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(Us.fromNumber(r)));return i.compare(n8)===1&&(i=new Us([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let n=vR(e),[r,i]=xR(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;let n=vR(e),[r,i]=xR(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);this.Re(o)}}Re(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},Ks=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Pl=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,kl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(U.min(),i,new Oe(J),ln(),te())}},kl=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,te(),te(),te())}};var Ba=class{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}},Xp=class{constructor(e,n){this.targetId=e,this.fe=n}},Jp=class{constructor(e,n,r=_t.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},eg=class{constructor(){this.ge=0,this.pe=ER(),this.ye=_t.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=te(),n=te(),r=te();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:k()}}),new kl(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=ER()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,L(this.ge>=0)}Le(){this.Se=!0,this.we=!0}},rw=class{constructor(e){this.Be=e,this.ke=new Map,this.qe=ln(),this.Qe=wR(),this.Ke=new Oe(J)}$e(e){for(let n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(let n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{let r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Le(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:k()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){let n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){let s=i.target;if(Qp(s))if(r===0){let o=new M(s.path);this.We(n,o,at.newNoDocument(o,U.min()))}else L(r===1);else{let o=this.Ze(n);if(o!==r){let a=this.Xe(e),c=a?this.et(a,e,o):1;if(c!==0){this.He(n);let u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,u)}yR?.tt(function(l,d,h,f,p){var m,v,b,F,T,H;let W={localCacheCount:l,existenceFilterCount:d.count,databaseId:h.database,projectId:h.projectId},Z=d.unchangedNames;return Z&&(W.bloomFilter={applied:p===0,hashCount:(m=Z?.hashCount)!==null&&m!==void 0?m:0,bitmapLength:(F=(b=(v=Z?.bits)===null||v===void 0?void 0:v.bitmap)===null||b===void 0?void 0:b.length)!==null&&F!==void 0?F:0,padding:(H=(T=Z?.bits)===null||T===void 0?void 0:T.padding)!==null&&H!==void 0?H:0,mightContain:be=>{var Xt;return(Xt=f?.mightContain(be))!==null&&Xt!==void 0&&Xt}}),W}(o,e.fe,this.Be.nt(),a,c))}}}}Xe(e){let n=e.fe.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=Ui(r).toUint8Array()}catch(c){if(c instanceof zp)return kn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new nw(o,i,s)}catch(c){return kn(c instanceof Ks?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Te===0?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){let r=this.Be.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Be.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){let n=new Map;this.ke.forEach((s,o)=>{let a=this.Ye(o);if(a){if(s.current&&Qp(a.target)){let c=new M(a.target.path);this.qe.get(c)!==null||this.st(o,c)||this.We(o,c,at.newNoDocument(c,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=te();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let u=this.Ye(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));let i=new Pl(e,n,this.Ke,this.qe,r);return this.qe=ln(),this.Qe=wR(),this.Ke=new Oe(J),i}Ue(e,n){if(!this.je(e))return;let r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;let i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){let n=this.ze(e).ve();return this.Be.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new eg,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new Se(J),this.Qe=this.Qe.insert(e,n)),n}je(e){let n=this.Ye(e)!==null;return n||I("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){let n=this.ke.get(e);return n&&n.be?null:this.Be._t(e)}He(e){this.ke.set(e,new eg),this.Be.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Be.getRemoteKeysForTarget(e).has(n)}};function wR(){return new Oe(M.comparator)}function ER(){return new Oe(M.comparator)}var r8={asc:"ASCENDING",desc:"DESCENDING"},i8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},s8={and:"AND",or:"OR"},iw=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function sw(t,e){return t.useProto3Json||zl(e)?e:{value:e}}function Wa(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function LN(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function o8(t,e){return Wa(t,e.toTimestamp())}function Ye(t){return L(!!t),U.fromTimestamp(function(n){let r=Bi(n);return new Be(r.seconds,r.nanos)}(t))}function NE(t,e){return ow(t,e).canonicalString()}function ow(t,e){let n=function(i){return new me(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function jN(t){let e=me.fromString(t);return L(QN(e)),e}function Ol(t,e){return NE(t.databaseId,e.path)}function br(t,e){let n=jN(e);if(n.get(1)!==t.databaseId.projectId)throw new w(y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new w(y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new M($N(n))}function BN(t,e){return NE(t.databaseId,e)}function UN(t){let e=jN(t);return e.length===4?me.emptyPath():$N(e)}function aw(t){return new me(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function $N(t){return L(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function IR(t,e,n){return{name:Ol(t,e),fields:n.value.mapValue.fields}}function HN(t,e,n){let r=br(t,e.name),i=Ye(e.updateTime),s=e.createTime?Ye(e.createTime):U.min(),o=new Ot({mapValue:{fields:e.fields}}),a=at.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function a8(t,e){return"found"in e?function(r,i){L(!!i.found),i.found.name,i.found.updateTime;let s=br(r,i.found.name),o=Ye(i.found.updateTime),a=i.found.createTime?Ye(i.found.createTime):U.min(),c=new Ot({mapValue:{fields:i.found.fields}});return at.newFoundDocument(s,o,a,c)}(t,e):"missing"in e?function(r,i){L(!!i.missing),L(!!i.readTime);let s=br(r,i.missing),o=Ye(i.readTime);return at.newNoDocument(s,o)}(t,e):k()}function c8(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:k()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,l){return u.useProto3Json?(L(l===void 0||typeof l=="string"),_t.fromBase64String(l||"")):(L(l===void 0||l instanceof Uint8Array),_t.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){let l=u.code===void 0?y.UNKNOWN:FN(u.code);return new w(l,u.message||"")}(o);n=new Jp(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=br(t,r.document.name),s=Ye(r.document.updateTime),o=r.document.createTime?Ye(r.document.createTime):U.min(),a=new Ot({mapValue:{fields:r.document.fields}}),c=at.newFoundDocument(i,s,o,a),u=r.targetIds||[],l=r.removedTargetIds||[];n=new Ba(u,l,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=br(t,r.document),s=r.readTime?Ye(r.readTime):U.min(),o=at.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Ba([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=br(t,r.document),s=r.removedTargetIds||[];n=new Ba([],s,i,null)}else{if(!("filter"in e))return k();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new tw(i,s),a=r.targetId;n=new Xp(a,o)}}return n}function Fl(t,e){let n;if(e instanceof zi)n={update:IR(t,e.key,e.value)};else if(e instanceof Wi)n={delete:Ol(t,e.key)};else if(e instanceof er)n={update:IR(t,e.key,e.data),updateMask:p8(e.fieldMask)};else{if(!(e instanceof Ml))return k();n={verify:Ol(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof qi)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ti)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ni)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Gi)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw k()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:o8(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:k()}(t,e.precondition)),n}function cw(t,e){let n=e.currentDocument?function(s){return s.updateTime!==void 0?Ge.updateTime(Ye(s.updateTime)):s.exists!==void 0?Ge.exists(s.exists):Ge.none()}(e.currentDocument):Ge.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)L(a.setToServerValue==="REQUEST_TIME"),c=new qi;else if("appendMissingElements"in a){let l=a.appendMissingElements.values||[];c=new ti(l)}else if("removeAllFromArray"in a){let l=a.removeAllFromArray.values||[];c=new ni(l)}else"increment"in a?c=new Gi(o,a.increment):k();let u=Qe.fromServerFormat(a.fieldPath);return new eo(u,c)}(t,i)):[];if(e.update){e.update.name;let i=br(t,e.update.name),s=new Ot({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let u=c.fieldPaths||[];return new yn(u.map(l=>Qe.fromServerFormat(l)))}(e.updateMask);return new er(i,s,o,n,r)}return new zi(i,s,n,r)}if(e.delete){let i=br(t,e.delete);return new Wi(i,n)}if(e.verify){let i=br(t,e.verify);return new Ml(i,n)}return k()}function u8(t,e){return t&&t.length>0?(L(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?Ye(i.updateTime):Ye(s);return o.isEqual(U.min())&&(o=Ye(s)),new Jx(o,i.transformResults||[])}(n,e))):[]}function qN(t,e){return{documents:[BN(t,e.path)]}}function GN(t,e){let n={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=BN(t,i);let s=function(u){if(u.length!==0)return KN(Ce.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);let o=function(u){if(u.length!==0)return u.map(l=>function(h){return{field:ka(h.field),direction:d8(h.dir)}}(l))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);let a=sw(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ut:n,parent:i}}function zN(t){let e=UN(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){L(r===1);let l=n.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];n.where&&(s=function(d){let h=WN(d);return h instanceof Ce&&AE(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(h=>function(p){return new Xs(Oa(p.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,zl(h)?null:h}(n.limit));let c=null;n.startAt&&(c=function(d){let h=!!d.before,f=d.values||[];return new Sr(f,h)}(n.startAt));let u=null;return n.endAt&&(u=function(d){let h=!d.before,f=d.values||[];return new Sr(f,h)}(n.endAt)),vN(e,i,o,s,a,"F",c,u)}function l8(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return k()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function WN(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=Oa(n.unaryFilter.field);return fe.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Oa(n.unaryFilter.field);return fe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Oa(n.unaryFilter.field);return fe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Oa(n.unaryFilter.field);return fe.create(o,"!=",{nullValue:"NULL_VALUE"});default:return k()}}(t):t.fieldFilter!==void 0?function(n){return fe.create(Oa(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return k()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ce.create(n.compositeFilter.filters.map(r=>WN(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return k()}}(n.compositeFilter.op))}(t):k()}function d8(t){return r8[t]}function h8(t){return i8[t]}function f8(t){return s8[t]}function ka(t){return{fieldPath:t.canonicalString()}}function Oa(t){return Qe.fromServerFormat(t.fieldPath)}function KN(t){return t instanceof fe?function(n){if(n.op==="=="){if(oR(n.value))return{unaryFilter:{field:ka(n.field),op:"IS_NAN"}};if(sR(n.value))return{unaryFilter:{field:ka(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(oR(n.value))return{unaryFilter:{field:ka(n.field),op:"IS_NOT_NAN"}};if(sR(n.value))return{unaryFilter:{field:ka(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ka(n.field),op:h8(n.op),value:n.value}}}(t):t instanceof Ce?function(n){let r=n.getFilters().map(i=>KN(i));return r.length===1?r[0]:{compositeFilter:{op:f8(n.op),filters:r}}}(t):k()}function p8(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function QN(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var Ka=class t{constructor(e,n,r,i,s=U.min(),o=U.min(),a=_t.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var tg=class{constructor(e){this.ct=e}};function g8(t,e){let n;if(e.document)n=HN(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=M.fromSegments(e.noDocument.path),i=no(e.noDocument.readTime);n=at.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return k();{let r=M.fromSegments(e.unknownDocument.path),i=no(e.unknownDocument.version);n=at.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){let s=new Be(i[0],i[1]);return U.fromTimestamp(s)}(e.readTime)),n}function CR(t,e){let n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:ng(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Ol(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Wa(s,o.version.toTimestamp()),createTime:Wa(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:to(e.version)};else{if(!e.isUnknownDocument())return k();r.unknownDocument={path:n.path.toArray(),version:to(e.version)}}return r}function ng(t){let e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function to(t){let e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function no(t){let e=new Be(t.seconds,t.nanoseconds);return U.fromTimestamp(e)}function Gs(t,e){let n=(e.baseMutations||[]).map(s=>cw(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>cw(t.ct,s)),i=Be.fromMillis(e.localWriteTimeMs);return new Rl(e.batchId,i,n,r)}function yl(t){let e=no(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?no(t.lastLimboFreeSnapshotVersion):U.min(),r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return L(s.documents.length===1),Wt(sc(UN(s.documents[0])))}(t.query):function(s){return Wt(zN(s))}(t.query),new Ka(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,_t.fromBase64String(t.resumeToken))}function YN(t,e){let n=to(e.snapshotVersion),r=to(e.lastLimboFreeSnapshotVersion),i;i=Qp(e.target)?qN(t.ct,e.target):GN(t.ct,e.target).ut;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Js(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function PE(t){let e=zN({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Zp(e,e.limit,"L"):e}function Ix(t,e){return new Nl(e.largestBatchId,cw(t.ct,e.overlayMutation))}function bR(t,e){let n=e.path.lastSegment();return[t,zt(e.path.popLast()),n]}function DR(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:to(r.readTime),documentKey:zt(r.documentKey.path),largestBatchId:r.largestBatchId}}var uw=class{getBundleMetadata(e,n){return TR(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:no(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return TR(e).put(function(i){return{bundleId:i.id,createTime:to(Ye(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return SR(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:PE(s.bundledQuery),readTime:no(s.readTime)}}(r)})}saveNamedQuery(e,n){return SR(e).put(function(i){return{name:i.name,readTime:to(Ye(i.readTime)),bundledQuery:i.bundledQuery}}(n))}};function TR(t){return yt(t,"bundles")}function SR(t){return yt(t,"namedQueries")}var rg=class t{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){let r=n.uid||"";return new t(e,r)}getOverlay(e,n){return fl(e).get(bR(this.userId,n)).next(r=>r?Ix(this.serializer,r):null)}getOverlays(e,n){let r=Ir();return _.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){let i=[];return r.forEach((s,o)=>{let a=new Nl(n,o);i.push(this.ht(e,a))}),_.waitFor(i)}removeOverlaysForBatchId(e,n,r){let i=new Set;n.forEach(o=>i.add(zt(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(fl(e).H("collectionPathOverlayIndex",a))}),_.waitFor(s)}getOverlaysForCollection(e,n,r){let i=Ir(),s=zt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return fl(e).W("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let u=Ix(this.serializer,c);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){let s=Ir(),o,a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return fl(e).Y({index:"collectionGroupOverlayIndex",range:a},(c,u,l)=>{let d=Ix(this.serializer,u);s.size()<i||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):l.done()}).next(()=>s)}ht(e,n){return fl(e).put(function(i,s,o){let[a,c,u]=bR(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Fl(i.ct,o.mutation)}}(this.serializer,this.userId,n))}};function fl(t){return yt(t,"documentOverlays")}var Xr=class{constructor(){}Pt(e,n){this.It(e,n),n.Tt()}It(e,n){if("nullValue"in e)this.Et(n,5);else if("booleanValue"in e)this.Et(n,10),n.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(n,15),n.dt(qe(e.integerValue));else if("doubleValue"in e){let r=qe(e.doubleValue);isNaN(r)?this.Et(n,13):(this.Et(n,15),bl(r)?n.dt(0):n.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(n,20),typeof r=="string"?n.At(r):(n.At(`${r.seconds||""}`),n.dt(r.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,n),this.Vt(n);else if("bytesValue"in e)this.Et(n,30),n.ft(Ui(e.bytesValue)),this.Vt(n);else if("referenceValue"in e)this.gt(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(n,45),n.dt(r.latitude||0),n.dt(r.longitude||0)}else"mapValue"in e?hN(e)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,n),this.Vt(n)):"arrayValue"in e?(this.wt(e.arrayValue,n),this.Vt(n)):k()}Rt(e,n){this.Et(n,25),this.St(e,n)}St(e,n){n.At(e)}yt(e,n){let r=e.fields||{};this.Et(n,55);for(let i of Object.keys(r))this.Rt(i,n),this.It(r[i],n)}wt(e,n){let r=e.values||[];this.Et(n,50);for(let i of r)this.It(i,n)}gt(e,n){this.Et(n,37),M.fromName(e).path.forEach(r=>{this.Et(n,60),this.St(r,n)})}Et(e,n){e.dt(n)}Vt(e){e.dt(2)}};Xr.bt=new Xr;function m8(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function AR(t){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=m8(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}var lw=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Ct(r.value),r=n.next();this.vt()}Ft(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Mt(r.value),r=n.next();this.xt()}Ot(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=n.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=n.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Lt(e){let n=this.Bt(e),r=AR(n);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}qt(e){let n=this.Bt(e),r=AR(n);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){let n=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ct(e){let n=255&e;n===0?(this.Kt(0),this.Kt(255)):n===255?(this.Kt(255),this.Kt(0)):this.Kt(n)}Mt(e){let n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},dw=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}},hw=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},zs=class{constructor(){this.Gt=new lw,this.zt=new dw(this.Gt),this.jt=new hw(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var Ws=class t{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}};function Pi(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=MR(t.arrayValue,e.arrayValue),n!==0?n:(n=MR(t.directionalValue,e.directionalValue),n!==0?n:M.comparator(t.documentKey,e.documentKey)))}function MR(t,e){for(let n=0;n<t.length&&n<e.length;++n){let r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}var ig=class{constructor(e){this.Yt=new Se((n,r)=>Qe.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let n of e.filters){let r=n;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(L(e.collectionGroup===this.collectionId),this.en)return!1;let n=kx(e);if(n!==void 0&&!this.nn(n))return!1;let r=Hs(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.rn(a,c)||!this.sn(this.Zt[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new Se(Qe.comparator),n=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new La(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new La(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new La(r.field,r.dir==="asc"?0:1)));return new $a($a.UNKNOWN_ID,this.collectionId,n,Cl.empty())}nn(e){for(let n of this.Xt)if(this.rn(n,e))return!0;return!1}rn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}sn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}};function ZN(t){var e,n;if(L(t instanceof fe||t instanceof Ce),t instanceof fe){if(t instanceof Kp){let i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>fe.create(t.field,"==",s)))||[];return Ce.create(i,"or")}return t}let r=t.filters.map(i=>ZN(i));return Ce.create(r,t.op)}function _8(t){if(t.getFilters().length===0)return[];let e=gw(ZN(t));return L(XN(e)),fw(e)||pw(e)?[e]:e.getFilters()}function fw(t){return t instanceof fe}function pw(t){return t instanceof Ce&&AE(t)}function XN(t){return fw(t)||pw(t)||function(n){if(n instanceof Ce&&$x(n)){for(let r of n.getFilters())if(!fw(r)&&!pw(r))return!1;return!0}return!1}(t)}function gw(t){if(L(t instanceof fe||t instanceof Ce),t instanceof fe)return t;if(t.filters.length===1)return gw(t.filters[0]);let e=t.filters.map(r=>gw(r)),n=Ce.create(e,t.op);return n=sg(n),XN(n)?n:(L(n instanceof Ce),L(qa(n)),L(n.filters.length>1),n.filters.reduce((r,i)=>kE(r,i)))}function kE(t,e){let n;return L(t instanceof fe||t instanceof Ce),L(e instanceof fe||e instanceof Ce),n=t instanceof fe?e instanceof fe?function(i,s){return Ce.create([i,s],"and")}(t,e):RR(t,e):e instanceof fe?RR(e,t):function(i,s){if(L(i.filters.length>0&&s.filters.length>0),qa(i)&&qa(s))return mN(i,s.getFilters());let o=$x(i)?i:s,a=$x(i)?s:i,c=o.filters.map(u=>kE(u,a));return Ce.create(c,"or")}(t,e),sg(n)}function RR(t,e){if(qa(e))return mN(e,t.getFilters());{let n=e.filters.map(r=>kE(t,r));return Ce.create(n,"or")}}function sg(t){if(L(t instanceof fe||t instanceof Ce),t instanceof fe)return t;let e=t.getFilters();if(e.length===1)return sg(e[0]);if(pN(t))return t;let n=e.map(i=>sg(i)),r=[];return n.forEach(i=>{i instanceof fe?r.push(i):i instanceof Ce&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Ce.create(r,t.op)}var mw=class{constructor(){this._n=new Vl}addToCollectionParentIndex(e,n){return this._n.add(n),_.resolve()}getCollectionParents(e,n){return _.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return _.resolve()}deleteFieldIndex(e,n){return _.resolve()}deleteAllFieldIndexes(e){return _.resolve()}createTargetIndexes(e,n){return _.resolve()}getDocumentsMatchingTarget(e,n){return _.resolve(null)}getIndexType(e,n){return _.resolve(0)}getFieldIndexes(e,n){return _.resolve([])}getNextCollectionGroupToUpdate(e){return _.resolve(null)}getMinOffset(e,n){return _.resolve(On.min())}getMinOffsetFromCollectionGroup(e,n){return _.resolve(On.min())}updateCollectionGroup(e,n,r){return _.resolve()}updateIndexEntries(e,n){return _.resolve()}},Vl=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Se(me.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Se(me.comparator)).toArray()}};var Mp=new Uint8Array(0),_w=class{constructor(e,n){this.databaseId=n,this.an=new Vl,this.un=new Ar(r=>Js(r),(r,i)=>Wl(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.an.has(n)){let r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.an.add(n)});let s={collectionId:r,parent:zt(i)};return NR(e).put(s)}return _.resolve()}getCollectionParents(e,n){let r=[],i=IDBKeyRange.bound([n,""],[tN(n),""],!1,!0);return NR(e).W(i).next(s=>{for(let o of s){if(o.collectionId!==n)break;r.push(Er(o.parent))}return r})}addFieldIndex(e,n){let r=pl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete i.indexId;let s=r.add(i);if(n.indexState){let o=Ma(e);return s.next(a=>{o.put(DR(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){let r=pl(e),i=Ma(e),s=Aa(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let n=pl(e),r=Aa(e),i=Ma(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return _.forEach(this.cn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new ig(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){let r=Aa(e),i=!0,s=new Map;return _.forEach(this.cn(n),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=te(),a=[];return _.forEach(s,(c,u)=>{I("IndexedDbIndexManager",`Using index ${function(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(H=>`${H.fieldPath}:${H.kind}`).join(",")}`}(c)} to execute ${Js(n)}`);let l=function(T,H){let W=kx(H);if(W===void 0)return null;for(let Z of Yp(T,W.fieldPath))switch(Z.op){case"array-contains-any":return Z.value.arrayValue.values||[];case"array-contains":return[Z.value]}return null}(u,c),d=function(T,H){let W=new Map;for(let Z of Hs(H))for(let be of Yp(T,Z.fieldPath))switch(be.op){case"==":case"in":W.set(Z.fieldPath.canonicalString(),be.value);break;case"not-in":case"!=":return W.set(Z.fieldPath.canonicalString(),be.value),Array.from(W.values())}return null}(u,c),h=function(T,H){let W=[],Z=!0;for(let be of Hs(H)){let Xt=be.kind===0?dR(T,be.fieldPath,T.startAt):hR(T,be.fieldPath,T.startAt);W.push(Xt.value),Z&&(Z=Xt.inclusive)}return new Sr(W,Z)}(u,c),f=function(T,H){let W=[],Z=!0;for(let be of Hs(H)){let Xt=be.kind===0?hR(T,be.fieldPath,T.endAt):dR(T,be.fieldPath,T.endAt);W.push(Xt.value),Z&&(Z=Xt.inclusive)}return new Sr(W,Z)}(u,c),p=this.hn(c,u,h),m=this.hn(c,u,f),v=this.Pn(c,u,d),b=this.In(c.indexId,l,p,h.inclusive,m,f.inclusive,v);return _.forEach(b,F=>r.j(F,n.limit).next(T=>{T.forEach(H=>{let W=M.fromSegments(H.documentKey);o.has(W)||(o=o.add(W),a.push(W))})}))}).next(()=>a)}return _.resolve(null)})}cn(e){let n=this.un.get(e);return n||(e.filters.length===0?n=[e]:n=_8(Ce.create(e.filters,"and")).map(r=>Zx(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,n),n)}In(e,n,r,i,s,o,a){let c=(n!=null?n.length:1)*Math.max(r.length,s.length),u=c/(n!=null?n.length:1),l=[];for(let d=0;d<c;++d){let h=n?this.Tn(n[d/u]):Mp,f=this.En(e,h,r[d%u],i),p=this.dn(e,h,s[d%u],o),m=a.map(v=>this.En(e,h,v,!0));l.push(...this.createRange(f,p,m))}return l}En(e,n,r,i){let s=new Ws(e,M.empty(),n,r);return i?s:s.Jt()}dn(e,n,r,i){let s=new Ws(e,M.empty(),n,r);return i?s.Jt():s}ln(e,n){let r=new ig(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2,i=this.cn(n);return _.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let u=new Se(Qe.comparator),l=!1;for(let d of c.filters)for(let h of d.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?l=!0:u=u.add(h.field));for(let d of c.orderBy)d.field.isKeyField()||(u=u.add(d.field));return u.size+(l?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}An(e,n){let r=new zs;for(let i of Hs(e)){let s=n.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);Xr.bt.Pt(s,o)}return r.Wt()}Tn(e){let n=new zs;return Xr.bt.Pt(e,n.Ht(0)),n.Wt()}Rn(e,n){let r=new zs;return Xr.bt.Pt(Zs(this.databaseId,n),r.Ht(function(s){let o=Hs(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,n,r){if(r===null)return[];let i=[];i.push(new zs);let s=0;for(let o of Hs(e)){let a=r[s++];for(let c of i)if(this.Vn(n,o.fieldPath)&&Al(a))i=this.mn(i,o,a);else{let u=c.Ht(o.kind);Xr.bt.Pt(a,u)}}return this.fn(i)}hn(e,n,r){return this.Pn(e,n,r.position)}fn(e){let n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Wt();return n}mn(e,n,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new zs;c.seed(a.Wt()),Xr.bt.Pt(o,c.Ht(n.kind)),s.push(c)}return s}Vn(e,n){return!!e.filters.find(r=>r instanceof fe&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){let r=pl(e),i=Ma(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{let o=[];return _.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(l,d){let h=d?new Cl(d.sequenceNumber,new On(no(d.readTime),new M(Er(d.documentKey)),d.largestBatchId)):Cl.empty(),f=l.fields.map(([p,m])=>new La(Qe.fromServerFormat(p),m));return new $a(l.indexId,l.collectionGroup,f,h)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:J(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){let i=pl(e),s=Ma(e);return this.gn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>_.forEach(a,c=>s.put(DR(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){let r=new Map;return _.forEach(n,(i,s)=>{let o=r.get(i.collectionGroup);return(o?_.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),_.forEach(a,c=>this.pn(e,i,c).next(u=>{let l=this.yn(s,c);return u.isEqual(l)?_.resolve():this.wn(e,s,c,u,l)}))))})}Sn(e,n,r,i){return Aa(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,n.key),documentKey:n.key.path.toArray()})}bn(e,n,r,i){return Aa(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,n.key),n.key.path.toArray()])}pn(e,n,r){let i=Aa(e),s=new Se(Pi);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,n)])},(o,a)=>{s=s.add(new Ws(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,n){let r=new Se(Pi),i=this.An(n,e);if(i==null)return r;let s=kx(n);if(s!=null){let o=e.data.field(s.fieldPath);if(Al(o))for(let a of o.arrayValue.values||[])r=r.add(new Ws(n.indexId,e.key,this.Tn(a),i))}else r=r.add(new Ws(n.indexId,e.key,Mp,i));return r}wn(e,n,r,i,s){I("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);let o=[];return function(c,u,l,d,h){let f=c.getIterator(),p=u.getIterator(),m=Sa(f),v=Sa(p);for(;m||v;){let b=!1,F=!1;if(m&&v){let T=l(m,v);T<0?F=!0:T>0&&(b=!0)}else m!=null?F=!0:b=!0;b?(d(v),v=Sa(p)):F?(h(m),m=Sa(f)):(m=Sa(f),v=Sa(p))}}(i,s,Pi,a=>{o.push(this.Sn(e,n,r,a))},a=>{o.push(this.bn(e,n,r,a))}),_.waitFor(o)}gn(e){let n=1;return Ma(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Pi(o,a)).filter((o,a,c)=>!a||Pi(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=Pi(o,e),c=Pi(o,n);if(a===0)i[0]=e.Jt();else if(a>0&&c<0)i.push(o),i.push(o.Jt());else if(c>0)break}i.push(n);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Mp,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Mp,[]];s.push(IDBKeyRange.bound(a,c))}return s}Dn(e,n){return Pi(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(PR)}getMinOffset(e,n){return _.mapArray(this.cn(n),r=>this.ln(e,r).next(i=>i||k())).next(PR)}};function NR(t){return yt(t,"collectionParents")}function Aa(t){return yt(t,"indexEntries")}function pl(t){return yt(t,"indexConfiguration")}function Ma(t){return yt(t,"indexState")}function PR(t){L(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){let i=t[r].indexState.offset;DE(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new On(e.readTime,e.documentKey,n)}var kR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Pn=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function JN(t,e,n){let r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId),a=0,c=r.Y({range:o},(l,d,h)=>(a++,h.delete()));s.push(c.next(()=>{L(a===1)}));let u=[];for(let l of n.mutations){let d=oN(e,l.key.path,n.batchId);s.push(i.delete(d)),u.push(l.key)}return _.waitFor(s).next(()=>u)}function og(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw k();e=t.noDocument}return JSON.stringify(e).length}Pn.DEFAULT_COLLECTION_PERCENTILE=10,Pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Pn.DEFAULT=new Pn(41943040,Pn.DEFAULT_COLLECTION_PERCENTILE,Pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Pn.DISABLED=new Pn(-1,0,0);var ag=class t{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,n,r,i){L(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new t(s,n,r,i)}checkEmpty(e){let n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ki(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){let s=Fa(e),o=ki(e);return o.add({}).next(a=>{L(typeof a=="number");let c=new Rl(a,n,r,i),u=function(f,p,m){let v=m.baseMutations.map(F=>Fl(f.ct,F)),b=m.mutations.map(F=>Fl(f.ct,F));return{userId:p,batchId:m.batchId,localWriteTimeMs:m.localWriteTime.toMillis(),baseMutations:v,mutations:b}}(this.serializer,this.userId,c),l=[],d=new Se((h,f)=>J(h.canonicalString(),f.canonicalString()));for(let h of i){let f=oN(this.userId,h.key.path,a);d=d.add(h.key.path.popLast()),l.push(o.put(u)),l.push(s.put(f,C6))}return d.forEach(h=>{l.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Cn[a]=c.keys()}),_.waitFor(l).next(()=>c)})}lookupMutationBatch(e,n){return ki(e).get(n).next(r=>r?(L(r.userId===this.userId),Gs(this.serializer,r)):null)}vn(e,n){return this.Cn[n]?_.resolve(this.Cn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){let i=r.keys();return this.Cn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return ki(e).Y({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(L(a.batchId>=r),s=Gs(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return ki(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ki(e).W("userMutationsIndex",n).next(r=>r.map(i=>Gs(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){let r=kp(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Fa(e).Y({range:i},(o,a,c)=>{let[u,l,d]=o,h=Er(l);if(u===this.userId&&n.path.isEqual(h))return ki(e).get(d).next(f=>{if(!f)throw k();L(f.userId===this.userId),s.push(Gs(this.serializer,f))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Se(J),i=[];return n.forEach(s=>{let o=kp(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=Fa(e).Y({range:a},(u,l,d)=>{let[h,f,p]=u,m=Er(f);h===this.userId&&s.path.isEqual(m)?r=r.add(p):d.done()});i.push(c)}),_.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=kp(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new Se(J);return Fa(e).Y({range:o},(c,u,l)=>{let[d,h,f]=c,p=Er(h);d===this.userId&&r.isPrefixOf(p)?p.length===i&&(a=a.add(f)):l.done()}).next(()=>this.Fn(e,a))}Fn(e,n){let r=[],i=[];return n.forEach(s=>{i.push(ki(e).get(s).next(o=>{if(o===null)throw k();L(o.userId===this.userId),r.push(Gs(this.serializer,o))}))}),_.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return JN(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Mn(n.batchId)}),_.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return _.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Fa(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=Er(s[1]);i.push(c)}else a.done()}).next(()=>{L(i.length===0)})})}containsKey(e,n){return eP(e,this.userId,n)}xn(e){return tP(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function eP(t,e,n){let r=kp(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return Fa(t).Y({range:s,J:!0},(a,c,u)=>{let[l,d,h]=a;l===e&&d===i&&(o=!0),u.done()}).next(()=>o)}function ki(t){return yt(t,"mutations")}function Fa(t){return yt(t,"documentMutations")}function tP(t){return yt(t,"mutationQueues")}var Qa=class t{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new t(0)}static Ln(){return new t(-1)}};var yw=class{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Bn(e).next(n=>{let r=new Qa(n.highestTargetId);return n.highestTargetId=r.next(),this.kn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(n=>U.fromTimestamp(new Be(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.kn(e,i)))}addTargetData(e,n){return this.qn(e,n).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.Qn(n,r),this.kn(e,r))))}updateTargetData(e,n){return this.qn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Ra(e).delete(n.targetId)).next(()=>this.Bn(e)).next(r=>(L(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,n,r){let i=0,s=[];return Ra(e).Y((o,a)=>{let c=yl(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>_.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Ra(e).Y((r,i)=>{let s=yl(i);n(s)})}Bn(e){return OR(e).get("targetGlobalKey").next(n=>(L(n!==null),n))}kn(e,n){return OR(e).put("targetGlobalKey",n)}qn(e,n){return Ra(e).put(YN(this.serializer,n))}Qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(n=>n.targetCount)}getTargetData(e,n){let r=Js(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return Ra(e).Y({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let u=yl(a);Wl(n,u.target)&&(s=u,c.done())}).next(()=>s)}addMatchingKeys(e,n,r){let i=[],s=Oi(e);return n.forEach(o=>{let a=zt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),_.waitFor(i)}removeMatchingKeys(e,n,r){let i=Oi(e);return _.forEach(n,s=>{let o=zt(s.path);return _.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){let r=Oi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){let r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Oi(e),s=te();return i.Y({range:r,J:!0},(o,a,c)=>{let u=Er(o[1]),l=new M(u);s=s.add(l)}).next(()=>s)}containsKey(e,n){let r=zt(n.path),i=IDBKeyRange.bound([r],[tN(r)],!1,!0),s=0;return Oi(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],c,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}_t(e,n){return Ra(e).get(n).next(r=>r?yl(r):null)}};function Ra(t){return yt(t,"targets")}function OR(t){return yt(t,"targetGlobal")}function Oi(t){return yt(t,"targetDocuments")}function FR([t,e],[n,r]){let i=J(t,n);return i===0?J(e,r):i}var vw=class{constructor(e){this.Kn=e,this.buffer=new Se(FR),this.$n=0}Un(){return++this.$n}Wn(e){let n=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();FR(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},xw=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){I("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>g(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(n){Yi(n)?I("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield Qi(n)}yield this.zn(3e5)}))}},ww=class{constructor(e,n){this.jn=e,this.params=n}calculateTargetCount(e,n){return this.jn.Hn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return _.resolve(_n._e);let r=new vw(n);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(I("LruGarbageCollector","Garbage collection skipped; disabled"),_.resolve(kR)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(I("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),kR):this.Yn(e,n))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,n){let r,i,s,o,a,c,u,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(I("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(u=Date.now(),Na()<=Cn.DEBUG&&I("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-l}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${d} documents in `+(u-c)+`ms
Total Duration: ${u-l}ms`),_.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}};function y8(t,e){return new ww(t,e)}var Ew=class{constructor(e,n){this.db=e,this.garbageCollector=y8(this,n)}Hn(e){let n=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Zn(e){let n=0;return this.Jn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Jn(e,n){return this.Xn(e,(r,i)=>n(i))}addReference(e,n,r){return Rp(e,r)}removeReference(e,n,r){return Rp(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Rp(e,n)}er(e,n){return function(i,s){let o=!1;return tP(i).Z(a=>eP(i,a,s).next(c=>(c&&(o=!0),_.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=n){let c=this.er(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,U.min()),Oi(e).delete(function(d){return[0,zt(d.path)]}(o))))});i.push(c)}}).next(()=>_.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Rp(e,n)}Xn(e,n){let r=Oi(e),i,s=_n._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:u})=>{o===0?(s!==_n._e&&n(new M(Er(i)),s),s=u,i=c):s=_n._e}).next(()=>{s!==_n._e&&n(new M(Er(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Rp(t,e){return Oi(t).put(function(r,i){return{targetId:0,path:zt(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}var cg=class{constructor(){this.changes=new Ar(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,at.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?_.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Iw=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return $s(e).put(r)}removeEntry(e,n,r){return $s(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],ng(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.tr(e,r)))}getEntry(e,n){let r=at.newInvalidDocument(n);return $s(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(gl(n))},(i,s)=>{r=this.nr(n,s)}).next(()=>r)}rr(e,n){let r={size:0,document:at.newInvalidDocument(n)};return $s(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(gl(n))},(i,s)=>{r={document:this.nr(n,s),size:og(s)}}).next(()=>r)}getEntries(e,n){let r=ln();return this.ir(e,n,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,n){let r=ln(),i=new Oe(M.comparator);return this.ir(e,n,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,og(o))}).next(()=>({documents:r,_r:i}))}ir(e,n,r){if(n.isEmpty())return _.resolve();let i=new Se(jR);n.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(gl(i.first()),gl(i.last())),o=i.getIterator(),a=o.getNext();return $s(e).Y({index:"documentKeyIndex",range:s},(c,u,l)=>{let d=M.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&jR(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?l.U(gl(a)):l.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){let o=n.path,a=[o.popLast().toArray(),o.lastSegment(),ng(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return $s(e).W(IDBKeyRange.bound(a,c,!0)).next(u=>{s?.incrementDocumentReadCount(u.length);let l=ln();for(let d of u){let h=this.nr(M.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);h.isFoundDocument()&&(Ql(n,h)||i.has(h.key))&&(l=l.insert(h.key,h))}return l})}getAllFromCollectionGroup(e,n,r,i){let s=ln(),o=LR(n,r),a=LR(n,On.max());return $s(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,u,l)=>{let d=this.nr(M.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(d.key,d),s.size===i&&l.done()}).next(()=>s)}newChangeBuffer(e){return new Cw(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return VR(e).get("remoteDocumentGlobalKey").next(n=>(L(!!n),n))}tr(e,n){return VR(e).put("remoteDocumentGlobalKey",n)}nr(e,n){if(n){let r=g8(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(U.min())))return r}return at.newInvalidDocument(e)}};function nP(t){return new Iw(t)}var Cw=class extends cg{constructor(e,n){super(),this.ar=e,this.trackRemovals=n,this.ur=new Ar(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let n=[],r=0,i=new Se((s,o)=>J(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(n.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=CR(this.ar.serializer,o);i=i.add(s.path.popLast());let u=og(c);r+=u-a.size,n.push(this.ar.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=CR(this.ar.serializer,o.convertToNoDocument(U.min()));n.push(this.ar.addEntry(e,s,c))}}),i.forEach(s=>{n.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.ar.updateMetadata(e,r)),_.waitFor(n)}getFromCache(e,n){return this.ar.rr(e,n).next(r=>(this.ur.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.ar.sr(e,n).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function VR(t){return yt(t,"remoteDocumentGlobal")}function $s(t){return yt(t,"remoteDocumentsV14")}function gl(t){let e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function LR(t,e){let n=e.documentKey.path.toArray();return[t,ng(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function jR(t,e){let n=t.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=J(n[s],r[s]),i)return i;return i=J(n.length,r.length),i||(i=J(n[n.length-2],r[r.length-2]),i||J(n[n.length-1],r[r.length-1]))}var bw=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var ug=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&wl(r.mutation,i,yn.empty(),Be.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,te()).next(()=>r))}getLocalViewOfDocuments(e,n,r=te()){let i=Ir();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=_l();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=Ir();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,te()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=ln(),o=xl(),a=function(){return xl()}();return n.forEach((c,u)=>{let l=r.get(u.key);i.has(u.key)&&(l===void 0||l.mutation instanceof er)?s=s.insert(u.key,u):l!==void 0?(o.set(u.key,l.mutation.getFieldMask()),wl(l.mutation,u,l.mutation.getFieldMask(),Be.now())):o.set(u.key,yn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,l)=>o.set(u,l)),n.forEach((u,l)=>{var d;return a.set(u,new bw(l,(d=o.get(u))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){let r=xl(),i=new Oe((o,a)=>o-a),s=te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(c=>{let u=n.get(c);if(u===null)return;let l=r.get(c)||yn.empty();l=a.applyToLocalView(u,l),r.set(c,l);let d=(i.get(a.batchId)||te()).add(c);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),u=c.key,l=c.value,d=bN();l.forEach(h=>{if(!s.has(h)){let f=PN(n.get(h),r.get(h));f!==null&&d.set(h,f),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,d))}return _.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return M.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):ME(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):_.resolve(Ir()),a=-1,c=s;return o.next(u=>_.forEach(u,(l,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(l)?_.resolve():this.remoteDocumentCache.getEntry(e,l).next(h=>{c=c.insert(l,h)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,te())).next(l=>({batchId:a,changes:CN(l)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new M(n)).next(r=>{let i=_l();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=_l();return this.indexManager.getCollectionParents(e,s).next(a=>_.forEach(a,c=>{let u=function(d,h){return new Jn(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(l=>{l.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((c,u)=>{let l=u.getKey();o.get(l)===null&&(o=o.insert(l,at.newInvalidDocument(l)))});let a=_l();return o.forEach((c,u)=>{let l=s.get(c);l!==void 0&&wl(l.mutation,u,yn.empty(),Be.now()),Ql(n,u)&&(a=a.insert(c,u))}),a})}};var Dw=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return _.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Ye(i.createTime)}}(n)),_.resolve()}getNamedQuery(e,n){return _.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(i){return{name:i.name,query:PE(i.bundledQuery),readTime:Ye(i.readTime)}}(n)),_.resolve()}};var Tw=class{constructor(){this.overlays=new Oe(M.comparator),this.hr=new Map}getOverlay(e,n){return _.resolve(this.overlays.get(n))}getOverlays(e,n){let r=Ir();return _.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),_.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),_.resolve()}getOverlaysForCollection(e,n,r){let i=Ir(),s=n.length+1,o=new M(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return _.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Oe((u,l)=>u-l),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let l=s.get(u.largestBatchId);l===null&&(l=Ir(),s=s.insert(u.largestBatchId,l)),l.set(u.getKey(),u)}}let a=Ir(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,l)=>a.set(u,l)),!(a.size()>=i)););return _.resolve(a)}ht(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Nl(n,r));let s=this.hr.get(n);s===void 0&&(s=te(),this.hr.set(n,s)),this.hr.set(n,s.add(r.key))}};var Ll=class{constructor(){this.Pr=new Se(it.Ir),this.Tr=new Se(it.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){let r=new it(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new it(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){let n=new M(new me([])),r=new it(n,e),i=new it(n,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let n=new M(new me([])),r=new it(n,e),i=new it(n,e+1),s=te();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new it(e,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},it=class{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return M.comparator(e.key,n.key)||J(e.pr,n.pr)}static Er(e,n){return J(e.pr,n.pr)||M.comparator(e.key,n.key)}};var Sw=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new Se(it.Ir)}checkEmpty(e){return _.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Rl(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new it(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return _.resolve(o)}lookupMutationBatch(e,n){return _.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.br(r),s=i<0?0:i;return _.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return _.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return _.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new it(n,0),i=new it(n,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),_.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Se(J);return n.forEach(i=>{let s=new it(i,0),o=new it(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),_.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;M.isDocumentKey(s)||(s=s.child(""));let o=new it(new M(s),0),a=new Se(J);return this.wr.forEachWhile(c=>{let u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.pr)),!0)},o),_.resolve(this.Dr(a))}Dr(e){let n=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){L(this.Cr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return _.forEach(n.mutations,i=>{let s=new it(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){let r=new it(n,0),i=this.wr.firstAfterOrEqual(r);return _.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,_.resolve()}Cr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var Aw=class{constructor(e){this.vr=e,this.docs=function(){return new Oe(M.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return _.resolve(r?r.document.mutableCopy():at.newInvalidDocument(n))}getEntries(e,n){let r=ln();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():at.newInvalidDocument(i))}),_.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=ln(),o=n.path,a=new M(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:u,value:{document:l}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||DE(rN(l),r)<=0||(i.has(l.key)||Ql(n,l))&&(s=s.insert(l.key,l.mutableCopy()))}return _.resolve(s)}getAllFromCollectionGroup(e,n,r,i){k()}Fr(e,n){return _.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Mw(this)}getSize(e){return _.resolve(this.size)}},Mw=class extends cg{constructor(e){super(),this.ar=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),_.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}};var Rw=class{constructor(e){this.persistence=e,this.Mr=new Ar(n=>Js(n),Wl),this.lastRemoteSnapshotVersion=U.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Ll,this.targetCount=0,this.Lr=Qa.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,i)=>n(i)),_.resolve()}getLastRemoteSnapshotVersion(e){return _.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return _.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),_.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),_.resolve()}qn(e){this.Mr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Lr=new Qa(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,_.resolve()}updateTargetData(e,n){return this.qn(n),_.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,_.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),_.waitFor(s).next(()=>i)}getTargetCount(e){return _.resolve(this.targetCount)}getTargetData(e,n){let r=this.Mr.get(n)||null;return _.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),_.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),_.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),_.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Nr.gr(n);return _.resolve(r)}containsKey(e,n){return _.resolve(this.Nr.containsKey(n))}};var lg=class{constructor(e,n){this.Br={},this.overlays={},this.kr=new _n(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new Rw(this),this.indexManager=new mw,this.remoteDocumentCache=function(i){return new Aw(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new tg(n),this.$r=new Dw(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Tw,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new Sw(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){I("MemoryPersistence","Starting transaction:",e);let i=new Nw(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,n){return _.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}},Nw=class extends Hp{constructor(e){super(),this.currentSequenceNumber=e}},dg=class t{constructor(e){this.persistence=e,this.zr=new Ll,this.jr=null}static Hr(e){return new t(e)}get Jr(){if(this.jr)return this.jr;throw k()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),_.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),_.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),_.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return _.forEach(this.Jr,r=>{let i=M.fromPath(r);return this.Yr(e,i).next(s=>{s||n.removeEntry(i,U.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return _.or([()=>_.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}};var Pw=class{constructor(e){this.serializer=e}N(e,n,r,i){let s=new qp("createOrUpgrade",n);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",nR,{unique:!0}),c.createObjectStore("documentMutations")}(e),BR(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=_.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),BR(e)),o=o.next(()=>function(c){let u=c.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:U.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",l)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,u){return u.store("mutations").W().next(l=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",nR,{unique:!0});let d=u.store("mutations"),h=l.map(f=>d.put(f));return _.waitFor(h)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let u=c.createObjectStore("documentOverlays",{keyPath:F6});u.createIndex("collectionPathOverlayIndex",V6,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",L6,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let u=c.createObjectStore("remoteDocumentsV14",{keyPath:b6});u.createIndex("documentKeyIndex",D6),u.createIndex("collectionGroupIndex",T6)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:N6}).createIndex("sequenceNumberIndex",P6,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:k6}).createIndex("documentKeyIndex",O6,{unique:!1})}(e))),o}ei(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=og(i)}).next(()=>{let r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>_.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>_.forEach(a,c=>{L(c.userId===s.userId);let u=Gs(this.serializer,c);return JN(e,s.userId,u).next(()=>{})}))}))}ti(e){let n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.Y((o,a)=>{let c=new me(o),u=function(d){return[0,zt(d)]}(c);s.push(n.get(u).next(l=>l?_.resolve():(d=>n.put({targetId:0,path:zt(d),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>_.waitFor(s))})}ni(e,n){e.createObjectStore("collectionParents",{keyPath:R6});let r=n.store("collectionParents"),i=new Vl,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:zt(c)})}};return n.store("remoteDocuments").Y({J:!0},(o,a)=>{let c=new me(o);return s(c.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([o,a,c],u)=>{let l=Er(a);return s(l.popLast())}))}ri(e){let n=e.store("targets");return n.Y((r,i)=>{let s=yl(i),o=YN(this.serializer,s);return n.put(o)})}ii(e,n){let r=n.store("remoteDocuments"),i=[];return r.Y((s,o)=>{let a=n.store("remoteDocumentsV14"),c=function(d){return d.document?new M(me.fromString(d.document.name).popFirst(5)):d.noDocument?M.fromSegments(d.noDocument.path):d.unknownDocument?M.fromSegments(d.unknownDocument.path):k()}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>_.waitFor(i))}si(e,n){let r=n.store("mutations"),i=nP(this.serializer),s=new lg(dg.Hr,this.serializer.ct);return r.W().next(o=>{let a=new Map;return o.forEach(c=>{var u;let l=(u=a.get(c.userId))!==null&&u!==void 0?u:te();Gs(this.serializer,c).keys().forEach(d=>l=l.add(d)),a.set(c.userId,l)}),_.forEach(a,(c,u)=>{let l=new st(u),d=rg.lt(this.serializer,l),h=s.getIndexManager(l),f=ag.lt(l,this.serializer,h,s.referenceDelegate);return new ug(i,f,d,h).recalculateAndSaveOverlaysForDocumentKeys(new Dl(n,_n._e),c).next()})})}};function BR(t){t.createObjectStore("targetDocuments",{keyPath:A6}).createIndex("documentTargetsIndex",M6,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",S6,{unique:!0}),t.createObjectStore("targetGlobal")}var Cx="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",kw=class t{constructor(e,n,r,i,s,o,a,c,u,l,d=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=u,this.ai=l,this.ui=d,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=h=>Promise.resolve(),!t.D())throw new w(y.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Ew(this,i),this.Ti=n+"main",this.serializer=new tg(c),this.Ei=new ei(this.Ti,this.ui,new Pw(this.serializer)),this.Qr=new yw(this.referenceDelegate,this.serializer),this.remoteDocumentCache=nP(this.serializer),this.$r=new uw,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,l===!1&&Ke("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new w(y.FAILED_PRECONDITION,Cx);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new _n(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=n=>g(this,null,function*(){if(this.started)return e(n)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.B(n=>g(this,null,function*(){n.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>g(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Np(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(n=>{n||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(n=>this.isPrimary&&!n?this.yi(e).next(()=>!1):!!n&&this.wi(e).next(()=>!0))).catch(e=>{if(Yi(e))return I("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return I("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return ml(e).get("owner").next(n=>_.resolve(this.Si(n)))}bi(e){return Np(e).delete(this.clientId)}Di(){return g(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{let r=yt(n,"clientMetadata");return r.W().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return _.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let n of e)this.di.removeItem(this.Fi(n.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?_.resolve(!0):ml(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)){if(this.Si(n)&&this.networkEnabled)return!0;if(!this.Si(n)){if(!n.allowTabSynchronization)throw new w(y.FAILED_PRECONDITION,Cx);return!1}}return!(!this.networkEnabled||!this.inForeground)||Np(e).W().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&I("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return g(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let n=new Dl(e,_n._e);return this.yi(n).next(()=>this.bi(n))}),this.Ei.close(),this.Li()})}vi(e,n){return e.filter(r=>this.Ci(r.updateTimeMs,n)&&!this.Mi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>Np(e).W().next(n=>this.vi(n,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,n){return ag.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new _w(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return rg.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,n,r){I("IndexedDbPersistence","Starting transaction:",e);let i=n==="readonly"?"readonly":"readwrite",s=function(c){return c===15?B6:c===14?uN:c===13?cN:c===12?j6:c===11?aN:void k()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new Dl(a,this.kr?this.kr.next():_n._e),n==="readwrite-primary"?this.gi(o).next(c=>!!c||this.pi(o)).next(c=>{if(!c)throw Ke(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new w(y.FAILED_PRECONDITION,iN);return r(o)}).next(c=>this.wi(o).next(()=>c)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return ml(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)&&!this.Si(n)&&!(this.ai||this.allowTabSynchronization&&n.allowTabSynchronization))throw new w(y.FAILED_PRECONDITION,Cx)})}wi(e){let n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ml(e).put("owner",n)}static D(){return ei.D()}yi(e){let n=ml(e);return n.get("owner").next(r=>this.Si(r)?(I("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):_.resolve())}Ci(e,n){let r=Date.now();return!(e<r-n)&&(!(e>r)||(Ke(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let n=/(?:Version|Mobile)\/1[456]/;e_()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var n;try{let r=((n=this.di)===null||n===void 0?void 0:n.getItem(this.Fi(e)))!==null;return I("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ke("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){Ke("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function ml(t){return yt(t,"owner")}function Np(t){return yt(t,"clientMetadata")}function OE(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Ow=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=i}static Ki(e,n){let r=te(),i=te();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var Fw=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var hg=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return e_()?8:ei.v(Vc())>0?6:4}()}initialize(e,n){this.zi=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.ji(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new Fw;return this.Ji(e,n,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,n,o,a.size)})}).next(()=>s.result)}Yi(e,n,r,i){return r.documentReadCount<this.Wi?(Na()<=Cn.DEBUG&&I("QueryEngine","SDK will not create cache indexes for query:",Pa(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),_.resolve()):(Na()<=Cn.DEBUG&&I("QueryEngine","Query:",Pa(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(Na()<=Cn.DEBUG&&I("QueryEngine","The SDK decides to create cache indexes for query:",Pa(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Wt(n))):_.resolve())}ji(e,n){if(fR(n))return _.resolve(null);let r=Wt(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Zp(n,null,"F"),r=Wt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=te(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let u=this.Zi(n,a);return this.Xi(n,u,o,c.readTime)?this.ji(e,Zp(n,null,"F")):this.es(e,u,n,c)}))})))}Hi(e,n,r,i){return fR(n)||i.isEqual(U.min())?_.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(n,s);return this.Xi(n,o,r,i)?_.resolve(null):(Na()<=Cn.DEBUG&&I("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Pa(n)),this.es(e,o,n,nN(i,-1)).next(a=>a))})}Zi(e,n){let r=new Se(EN(e));return n.forEach((i,s)=>{Ql(e,s)&&(r=r.add(s))}),r}Xi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,n,r){return Na()<=Cn.DEBUG&&I("QueryEngine","Using full collection scan to execute query:",Pa(n)),this.zi.getDocumentsMatchingQuery(e,n,On.min(),r)}es(e,n,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Vw=class{constructor(e,n,r,i){this.persistence=e,this.ts=n,this.serializer=i,this.ns=new Oe(J),this.rs=new Ar(s=>Js(s),Wl),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ug(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ns))}};function rP(t,e,n,r){return new Vw(t,e,n,r)}function iP(t,e){return g(this,null,function*(){let n=R(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n._s(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=te();for(let u of i){o.push(u.batchId);for(let l of u.mutations)c=c.add(l.key)}for(let u of s){a.push(u.batchId);for(let l of u.mutations)c=c.add(l.key)}return n.localDocuments.getDocuments(r,c).next(u=>({us:u,removedBatchIds:o,addedBatchIds:a}))})})})}function v8(t,e){let n=R(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(a,c,u,l){let d=u.batch,h=d.keys(),f=_.resolve();return h.forEach(p=>{f=f.next(()=>l.getEntry(c,p)).next(m=>{let v=u.docVersions.get(p);L(v!==null),m.version.compareTo(v)<0&&(d.applyToRemoteDocument(m,u),m.isValidDocument()&&(m.setReadTime(u.commitVersion),l.addEntry(m)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(c,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=te();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function sP(t){let e=R(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function x8(t,e){let n=R(t),r=e.snapshotVersion,i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;let a=[];e.targetChanges.forEach((l,d)=>{let h=i.get(d);if(!h)return;a.push(n.Qr.removeMatchingKeys(s,l.removedDocuments,d).next(()=>n.Qr.addMatchingKeys(s,l.addedDocuments,d)));let f=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(_t.EMPTY_BYTE_STRING,U.min()).withLastLimboFreeSnapshotVersion(U.min()):l.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(l.resumeToken,r)),i=i.insert(d,f),function(m,v,b){return m.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=3e8?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(h,f,l)&&a.push(n.Qr.updateTargetData(s,f))});let c=ln(),u=te();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,l))}),a.push(oP(s,o,e.documentUpdates).next(l=>{c=l.cs,u=l.ls})),!r.isEqual(U.min())){let l=n.Qr.getLastRemoteSnapshotVersion(s).next(d=>n.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(l)}return _.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(n.ns=i,s))}function oP(t,e,n){let r=te(),i=te();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=ln();return n.forEach((a,c)=>{let u=s.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(U.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):I("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{cs:o,ls:i}})}function w8(t,e){let n=R(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Ya(t,e){let n=R(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Qr.getTargetData(r,e).next(s=>s?(i=s,_.resolve(i)):n.Qr.allocateTargetId(r).next(o=>(i=new Ka(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(r.targetId,r),n.rs.set(e,r.targetId)),r})}function Za(t,e,n){return g(this,null,function*(){let r=R(t),i=r.ns.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Yi(o))throw o;I("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function fg(t,e,n){let r=R(t),i=U.min(),s=te();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,l){let d=R(c),h=d.rs.get(l);return h!==void 0?_.resolve(d.ns.get(h)):d.Qr.getTargetData(u,l)}(r,o,Wt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,n?i:U.min(),n?s:te())).next(a=>(uP(r,wN(e),a),{documents:a,hs:s})))}function aP(t,e){let n=R(t),r=R(n.Qr),i=n.ns.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function cP(t,e){let n=R(t),r=n.ss.get(e)||U.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.os.getAllFromCollectionGroup(i,e,nN(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(uP(n,e,i),i))}function uP(t,e,n){let r=t.ss.get(e)||U.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.ss.set(e,r)}function E8(t,e,n,r){return g(this,null,function*(){let i=R(t),s=te(),o=ln();for(let u of n){let l=e.Ps(u.metadata.name);u.document&&(s=s.add(l));let d=e.Is(u);d.setReadTime(e.Ts(u.metadata.readTime)),o=o.insert(l,d)}let a=i.os.newChangeBuffer({trackRemovals:!0}),c=yield Ya(i,function(l){return Wt(sc(me.fromString(`__bundle__/docs/${l}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",u=>oP(u,a,o).next(l=>(a.apply(u),l)).next(l=>i.Qr.removeMatchingKeysForTargetId(u,c.targetId).next(()=>i.Qr.addMatchingKeys(u,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(u,l.cs,l.ls)).next(()=>l.cs)))})}function I8(r,i){return g(this,arguments,function*(t,e,n=te()){let s=yield Ya(t,Wt(PE(e.bundledQuery))),o=R(t);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=Ye(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.$r.saveNamedQuery(a,e);let u=s.withResumeToken(_t.EMPTY_BYTE_STRING,c);return o.ns=o.ns.insert(u.targetId,u),o.Qr.updateTargetData(a,u).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,n,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function UR(t,e){return`firestore_clients_${t}_${e}`}function $R(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function bx(t,e){return`firestore_targets_${t}_${e}`}var pg=class t{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Es(e,n,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new w(i.error.code,i.error.message))),o?new t(e,n,i.state,s):(Ke("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},El=class t{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Es(e,n){let r=JSON.parse(n),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new w(r.error.code,r.error.message))),s?new t(e,r.state,i):(Ke("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},gg=class t{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Es(e,n){let r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=RE();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=sN(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new t(e,s):(Ke("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}},Lw=class t{constructor(e,n){this.clientId=e,this.onlineState=n}static Es(e){let n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t(n.clientId,n.onlineState):(Ke("SharedClientState",`Failed to parse online state: ${e}`),null)}},jl=class{constructor(){this.activeTargetIds=RE()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Il=class{constructor(e,n,r,i,s){this.window=e,this.oi=n,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new Oe(J),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=UR(this.persistenceKey,this.Vs),this.Ss=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new jl),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Fs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return g(this,null,function*(){let e=yield this.syncEngine.Bi();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(UR(this.persistenceKey,r));if(i){let s=gg.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let n=this.storage.getItem(this.vs);if(n){let r=this.xs(n);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let n=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,n,r){this.Ls(e,n,r),this.Bs(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(bx(this.persistenceKey,e));if(r){let i=El.Es(e,r);i&&(n=i.state)}}return this.ks.As(e),this.Ms(),n}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(bx(this.persistenceKey,e))}updateQueryState(e,n,r){this.qs(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let n=this.storage.getItem(e);return I("SharedClientState","READ",e,n),n}setItem(e,n){I("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){I("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let n=e;if(n.storageArea===this.storage){if(I("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ws)return void Ke("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>g(this,null,function*(){if(this.started){if(n.key!==null){if(this.bs.test(n.key)){if(n.newValue==null){let r=this.$s(n.key);return this.Us(r,null)}{let r=this.Ws(n.key,n.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){let r=this.Gs(n.key,n.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(n.key)){if(n.newValue!==null){let r=this.js(n.key,n.newValue);if(r)return this.Hs(r)}}else if(n.key===this.vs){if(n.newValue!==null){let r=this.xs(n.newValue);if(r)return this.Os(r)}}else if(n.key===this.Ss){let r=function(s){let o=_n._e;if(s!=null)try{let a=JSON.parse(s);L(typeof a=="number"),o=a}catch(a){Ke("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==_n._e&&this.sequenceNumberHandler(r)}else if(n.key===this.Fs){let r=this.Js(n.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(n)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,n,r){let i=new pg(this.currentUser,e,n,r),s=$R(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Bs(e){let n=$R(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Qs(e){let n={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(n))}qs(e,n,r){let i=bx(this.persistenceKey,e),s=new El(e,n,r);this.setItem(i,s.ds())}Ks(e){let n=JSON.stringify(Array.from(e));this.setItem(this.Fs,n)}$s(e){let n=this.bs.exec(e);return n?n[1]:null}Ws(e,n){let r=this.$s(e);return gg.Es(r,n)}Gs(e,n){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return pg.Es(new st(s),i,n)}js(e,n){let r=this.Cs.exec(e),i=Number(r[1]);return El.Es(i,n)}xs(e){return Lw.Es(e)}Js(e){return JSON.parse(e)}zs(e){return g(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);I("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,n){let r=n?this.ps.insert(e,n):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let n=RE();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}},mg=class{constructor(){this.no=new jl,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,n,r){this.ro[e]=n}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new jl,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var jw=class{io(e){}shutdown(){}};var _g=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){I("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){I("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Pp=null;function Dx(){return Pp===null?Pp=function(){return 268435456+Math.round(2147483648*Math.random())}():Pp++,"0x"+Pp.toString(16)}var C8={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Bw=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}};var kt="WebChannelConnection",Uw=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.fo=r+"://"+n.host,this.po=`projects/${i}/databases/${s}`,this.yo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get wo(){return!1}So(n,r,i,s,o){let a=Dx(),c=this.bo(n,r.toUriEncodedString());I("RestConnection",`Sending RPC '${n}' ${a}:`,c,i);let u={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(u,s,o),this.Co(n,c,u,i).then(l=>(I("RestConnection",`Received RPC '${n}' ${a}: `,l),l),l=>{throw kn("RestConnection",`RPC '${n}' ${a} failed with error: `,l,"url: ",c,"request:",i),l})}vo(n,r,i,s,o,a){return this.So(n,r,i,s,o)}Do(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ic}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}bo(n,r){let i=C8[n];return`${this.fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,n,r,i){let s=Dx();return new Promise((o,a)=>{let c=new ZM;c.setWithCredentials(!0),c.listenOnce(QM.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Ap.NO_ERROR:let l=c.getResponseJson();I(kt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(l)),o(l);break;case Ap.TIMEOUT:I(kt,`RPC '${e}' ${s} timed out`),a(new w(y.DEADLINE_EXCEEDED,"Request time out"));break;case Ap.HTTP_ERROR:let d=c.getStatus();if(I(kt,`RPC '${e}' ${s} failed with status:`,d,"response text:",c.getResponseText()),d>0){let h=c.getResponseJson();Array.isArray(h)&&(h=h[0]);let f=h?.error;if(f&&f.status&&f.message){let p=function(v){let b=v.toLowerCase().replace(/_/g,"-");return Object.values(y).indexOf(b)>=0?b:y.UNKNOWN}(f.status);a(new w(p,f.message))}else a(new w(y.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new w(y.UNAVAILABLE,"Connection failed."));break;default:k()}}finally{I(kt,`RPC '${e}' ${s} completed.`)}});let u=JSON.stringify(i);I(kt,`RPC '${e}' ${s} sending request:`,i),c.send(n,"POST",u,r,15)})}Fo(e,n,r){let i=Dx(),s=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=WM(),a=KM(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Do(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;let l=s.join("");I(kt,`Creating RPC '${e}' stream ${i}: ${l}`,c);let d=o.createWebChannel(l,c),h=!1,f=!1,p=new Bw({lo:v=>{f?I(kt,`Not sending because RPC '${e}' stream ${i} is closed:`,v):(h||(I(kt,`Opening RPC '${e}' stream ${i} transport.`),d.open(),h=!0),I(kt,`RPC '${e}' stream ${i} sending:`,v),d.send(v))},ho:()=>d.close()}),m=(v,b,F)=>{v.listen(b,T=>{try{F(T)}catch(H){setTimeout(()=>{throw H},0)}})};return m(d,hl.EventType.OPEN,()=>{f||I(kt,`RPC '${e}' stream ${i} transport opened.`)}),m(d,hl.EventType.CLOSE,()=>{f||(f=!0,I(kt,`RPC '${e}' stream ${i} transport closed`),p.Vo())}),m(d,hl.EventType.ERROR,v=>{f||(f=!0,kn(kt,`RPC '${e}' stream ${i} transport errored:`,v),p.Vo(new w(y.UNAVAILABLE,"The operation could not be completed")))}),m(d,hl.EventType.MESSAGE,v=>{var b;if(!f){let F=v.data[0];L(!!F);let T=F,H=T.error||((b=T[0])===null||b===void 0?void 0:b.error);if(H){I(kt,`RPC '${e}' stream ${i} received error:`,H);let W=H.status,Z=function(Zm){let jd=rt[Zm];if(jd!==void 0)return FN(jd)}(W),be=H.message;Z===void 0&&(Z=y.INTERNAL,be="Unknown error status: "+W+" with message "+H.message),f=!0,p.Vo(new w(Z,be)),d.close()}else I(kt,`RPC '${e}' stream ${i} received:`,F),p.mo(F)}}),m(a,YM.STAT_EVENT,v=>{v.stat===Ex.PROXY?I(kt,`RPC '${e}' stream ${i} detected buffering proxy`):v.stat===Ex.NOPROXY&&I(kt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.Ro()},0),p}};function lP(){return typeof window<"u"?window:null}function Lp(){return typeof document<"u"?document:null}function Yl(t){return new iw(t,!0)}var Bl=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=n,this.Mo=r,this.xo=i,this.Oo=s,this.No=0,this.Lo=null,this.Bo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();let n=Math.floor(this.No+this.Qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,n-r);i>0&&I("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Lo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){this.Lo!==null&&(this.Lo.skipDelay(),this.Lo=null)}cancel(){this.Lo!==null&&(this.Lo.cancel(),this.Lo=null)}Qo(){return(Math.random()-.5)*this.No}};var yg=class{constructor(e,n,r,i,s,o,a,c){this.oi=e,this.$o=r,this.Uo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new Bl(e,n)}Ho(){return this.state===1||this.state===5||this.Jo()}Jo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Yo()}stop(){return g(this,null,function*(){this.Ho()&&(yield this.close(0))})}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&this.Go===null&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,()=>this.e_()))}t_(e){this.n_(),this.stream.send(e)}e_(){return g(this,null,function*(){if(this.Jo())return this.close(0)})}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}close(e,n){return g(this,null,function*(){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,e!==4?this.jo.reset():n&&n.code===y.RESOURCE_EXHAUSTED?(Ke(n.toString()),Ke("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):n&&n.code===y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.To(n)})}i_(){}auth(){this.state=1;let e=this.s_(this.Wo),n=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Wo===n&&this.o_(r,i)},r=>{e(()=>{let i=new w(y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.__(i)})})}o_(e,n){let r=this.s_(this.Wo);this.stream=this.a_(e,n),this.stream.Po(()=>{r(()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,()=>(this.Jo()&&(this.state=3),Promise.resolve())),this.listener.Po()))}),this.stream.To(i=>{r(()=>this.__(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Yo(){this.state=5,this.jo.qo(()=>g(this,null,function*(){this.state=0,this.start()}))}__(e){return I("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return n=>{this.oi.enqueueAndForget(()=>this.Wo===e?n():(I("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},$w=class extends yg{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}a_(e,n){return this.connection.Fo("Listen",e,n)}onMessage(e){this.jo.reset();let n=c8(this.serializer,e),r=function(s){if(!("targetChange"in s))return U.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?U.min():o.readTime?Ye(o.readTime):U.min()}(e);return this.listener.u_(n,r)}c_(e){let n={};n.database=aw(this.serializer),n.addTarget=function(s,o){let a,c=o.target;if(a=Qp(c)?{documents:qN(s,c)}:{query:GN(s,c).ut},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=LN(s,o.resumeToken);let u=sw(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(U.min())>0){a.readTime=Wa(s,o.snapshotVersion.toTimestamp());let u=sw(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);let r=l8(this.serializer,e);r&&(n.labels=r),this.t_(n)}l_(e){let n={};n.database=aw(this.serializer),n.removeTarget=e,this.t_(n)}},Hw=class extends yg{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,n){return this.connection.Fo("Write",e,n)}onMessage(e){if(L(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();let n=u8(e.writeResults,e.commitTime),r=Ye(e.commitTime);return this.listener.T_(r,n)}return L(!e.writeResults||e.writeResults.length===0),this.h_=!0,this.listener.E_()}d_(){let e={};e.database=aw(this.serializer),this.t_(e)}I_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>Fl(this.serializer,r))};this.t_(n)}};var qw=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new w(y.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,ow(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new w(y.UNKNOWN,s.toString())})}vo(e,n,r,i,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.vo(e,ow(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new w(y.UNKNOWN,o.toString())})}terminate(){this.A_=!0,this.connection.terminate()}};var Gw=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){this.m_===0&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve())))}S_(e){this.state==="Online"?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,e==="Online"&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(Ke(n),this.g_=!1):I("OnlineStateTracker",n)}b_(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}};var zw=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=s,this.M_.io(o=>{r.enqueueAndForget(()=>g(this,null,function*(){Zi(this)&&(I("RemoteStore","Restarting streams for network reachability change."),yield function(c){return g(this,null,function*(){let u=R(c);u.v_.add(4),yield oc(u),u.x_.set("Unknown"),u.v_.delete(4),yield Zl(u)})}(this))}))}),this.x_=new Gw(r,i)}};function Zl(t){return g(this,null,function*(){if(Zi(t))for(let e of t.F_)yield e(!0)})}function oc(t){return g(this,null,function*(){for(let e of t.F_)yield e(!1)})}function Vg(t,e){let n=R(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),LE(n)?VE(n):cc(n).Jo()&&FE(n,e))}function Xa(t,e){let n=R(t),r=cc(n);n.C_.delete(e),r.Jo()&&dP(n,e),n.C_.size===0&&(r.Jo()?r.Xo():Zi(n)&&n.x_.set("Unknown"))}function FE(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(U.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}cc(t).c_(e)}function dP(t,e){t.O_.Oe(e),cc(t).l_(e)}function VE(t){t.O_=new rw({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),cc(t).start(),t.x_.p_()}function LE(t){return Zi(t)&&!cc(t).Ho()&&t.C_.size>0}function Zi(t){return R(t).v_.size===0}function hP(t){t.O_=void 0}function b8(t){return g(this,null,function*(){t.C_.forEach((e,n)=>{FE(t,e)})})}function D8(t,e){return g(this,null,function*(){hP(t),LE(t)?(t.x_.S_(e),VE(t)):t.x_.set("Unknown")})}function T8(t,e,n){return g(this,null,function*(){if(t.x_.set("Online"),e instanceof Jp&&e.state===2&&e.cause)try{yield function(i,s){return g(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.C_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.C_.delete(a),i.O_.removeTarget(a))})}(t,e)}catch(r){I("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield vg(t,r)}else if(e instanceof Ba?t.O_.$e(e):e instanceof Xp?t.O_.Je(e):t.O_.Ge(e),!n.isEqual(U.min()))try{let r=yield sP(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.O_.it(o);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){let l=s.C_.get(u);l&&s.C_.set(u,l.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,u)=>{let l=s.C_.get(c);if(!l)return;s.C_.set(c,l.withResumeToken(_t.EMPTY_BYTE_STRING,l.snapshotVersion)),dP(s,c);let d=new Ka(l.target,c,u,l.sequenceNumber);FE(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){I("RemoteStore","Failed to raise snapshot:",r),yield vg(t,r)}})}function vg(t,e,n){return g(this,null,function*(){if(!Yi(e))throw e;t.v_.add(1),yield oc(t),t.x_.set("Offline"),n||(n=()=>sP(t.localStore)),t.asyncQueue.enqueueRetryable(()=>g(this,null,function*(){I("RemoteStore","Retrying IndexedDB access"),yield n(),t.v_.delete(1),yield Zl(t)}))})}function fP(t,e){return e().catch(n=>vg(t,n,e))}function ac(t){return g(this,null,function*(){let e=R(t),n=Ki(e),r=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;S8(e);)try{let i=yield w8(e.localStore,r);if(i===null){e.D_.length===0&&n.Xo();break}r=i.batchId,A8(e,i)}catch(i){yield vg(e,i)}pP(e)&&gP(e)})}function S8(t){return Zi(t)&&t.D_.length<10}function A8(t,e){t.D_.push(e);let n=Ki(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function pP(t){return Zi(t)&&!Ki(t).Ho()&&t.D_.length>0}function gP(t){Ki(t).start()}function M8(t){return g(this,null,function*(){Ki(t).d_()})}function R8(t){return g(this,null,function*(){let e=Ki(t);for(let n of t.D_)e.I_(n.mutations)})}function N8(t,e,n){return g(this,null,function*(){let r=t.D_.shift(),i=ew.from(r,e,n);yield fP(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield ac(t)})}function P8(t,e){return g(this,null,function*(){e&&Ki(t).P_&&(yield function(r,i){return g(this,null,function*(){if(function(o){return ON(o)&&o!==y.ABORTED}(i.code)){let s=r.D_.shift();Ki(r).Zo(),yield fP(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield ac(r)}})}(t,e)),pP(t)&&gP(t)})}function HR(t,e){return g(this,null,function*(){let n=R(t);n.asyncQueue.verifyOperationInProgress(),I("RemoteStore","RemoteStore received new credentials");let r=Zi(n);n.v_.add(3),yield oc(n),r&&n.x_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),yield Zl(n)})}function Ww(t,e){return g(this,null,function*(){let n=R(t);e?(n.v_.delete(2),yield Zl(n)):e||(n.v_.add(2),yield oc(n),n.x_.set("Unknown"))})}function cc(t){return t.N_||(t.N_=function(n,r,i){let s=R(n);return s.R_(),new $w(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:b8.bind(null,t),To:D8.bind(null,t),u_:T8.bind(null,t)}),t.F_.push(e=>g(this,null,function*(){e?(t.N_.Zo(),LE(t)?VE(t):t.x_.set("Unknown")):(yield t.N_.stop(),hP(t))}))),t.N_}function Ki(t){return t.L_||(t.L_=function(n,r,i){let s=R(n);return s.R_(),new Hw(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:M8.bind(null,t),To:P8.bind(null,t),E_:R8.bind(null,t),T_:N8.bind(null,t)}),t.F_.push(e=>g(this,null,function*(){e?(t.L_.Zo(),yield ac(t)):(yield t.L_.stop(),t.D_.length>0&&(I("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.L_}var Kw=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ot,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new w(y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function uc(t,e){if(Ke("AsyncQueue",`${e}: ${t}`),Yi(t))return new w(y.UNAVAILABLE,`${e}: ${t}`);throw t}var xg=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||M.comparator(n.key,r.key):(n,r)=>M.comparator(n.key,r.key),this.keyedMap=_l(),this.sortedSet=new Oe(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var wg=class{constructor(){this.B_=new Oe(M.comparator)}track(e){let n=e.doc.key,r=this.B_.get(n);r?e.type!==0&&r.type===3?this.B_=this.B_.insert(n,e):e.type===3&&r.type!==1?this.B_=this.B_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.B_=this.B_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.B_=this.B_.remove(n):e.type===1&&r.type===2?this.B_=this.B_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):k():this.B_=this.B_.insert(n,e)}k_(){let e=[];return this.B_.inorderTraversal((n,r)=>{e.push(r)}),e}},Ja=class t{constructor(e,n,r,i,s,o,a,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,xg.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Kl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var Qw=class{constructor(){this.q_=void 0,this.Q_=[]}K_(){return this.Q_.some(e=>e.U_())}},Yw=class{constructor(){this.queries=new Ar(e=>xN(e),Kl),this.onlineState="Unknown",this.W_=new Set}};function jE(t,e){return g(this,null,function*(){let n=R(t),r=3,i=e.query,s=n.queries.get(i);s?!s.K_()&&e.U_()&&(r=2):(s=new Qw,r=e.U_()?0:1);try{switch(r){case 0:s.q_=yield n.onListen(i,!0);break;case 1:s.q_=yield n.onListen(i,!1);break;case 2:yield n.onFirstRemoteStoreListen(i)}}catch(o){let a=uc(o,`Initialization of query '${Pa(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Q_.push(e),e.G_(n.onlineState),s.q_&&e.z_(s.q_)&&UE(n)})}function BE(t,e){return g(this,null,function*(){let n=R(t),r=e.query,i=3,s=n.queries.get(r);if(s){let o=s.Q_.indexOf(e);o>=0&&(s.Q_.splice(o,1),s.Q_.length===0?i=e.U_()?0:1:!s.K_()&&e.U_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}})}function k8(t,e){let n=R(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.Q_)a.z_(i)&&(r=!0);o.q_=i}}r&&UE(n)}function O8(t,e,n){let r=R(t),i=r.queries.get(e);if(i)for(let s of i.Q_)s.onError(n);r.queries.delete(e)}function UE(t){t.W_.forEach(e=>{e.next()})}var Zw,qR;(qR=Zw||(Zw={})).j_="default",qR.Cache="cache";var Ul=class{constructor(e,n,r){this.query=e,this.H_=n,this.J_=!1,this.Y_=null,this.onlineState="Unknown",this.options=r||{}}z_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Ja(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.J_?this.Z_(e)&&(this.H_.next(e),n=!0):this.X_(e,this.onlineState)&&(this.ea(e),n=!0),this.Y_=e,n}onError(e){this.H_.error(e)}G_(e){this.onlineState=e;let n=!1;return this.Y_&&!this.J_&&this.X_(this.Y_,e)&&(this.ea(this.Y_),n=!0),n}X_(e,n){if(!e.fromCache||!this.U_())return!0;let r=n!=="Offline";return(!this.options.ta||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Z_(e){if(e.docChanges.length>0)return!0;let n=this.Y_&&this.Y_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ea(e){e=Ja.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.J_=!0,this.H_.next(e)}U_(){return this.options.source!==Zw.Cache}};var Xw=class{constructor(e,n){this.na=e,this.byteLength=n}ra(){return"metadata"in this.na}};var Eg=class{constructor(e){this.serializer=e}Ps(e){return br(this.serializer,e)}Is(e){return e.metadata.exists?HN(this.serializer,e.document,!1):at.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return Ye(e)}},Jw=class{constructor(e,n,r){this.ia=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=mP(e)}sa(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.na.namedQuery)this.queries.push(e.na.namedQuery);else if(e.na.documentMetadata){this.documents.push({metadata:e.na.documentMetadata}),e.na.documentMetadata.exists||++n;let r=me.fromString(e.na.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.na.document&&(this.documents[this.documents.length-1].document=e.na.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}oa(e){let n=new Map,r=new Eg(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(n.get(o)||te()).add(s);n.set(o,a)}}return n}complete(){return g(this,null,function*(){let e=yield E8(this.localStore,new Eg(this.serializer),this.documents,this.ia.id),n=this.oa(this.documents);for(let r of this.queries)yield I8(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,_a:this.collectionGroups,aa:e}})}};function mP(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Ig=class{constructor(e){this.key=e}},Cg=class{constructor(e){this.key=e}},bg=class{constructor(e,n){this.query=e,this.ua=n,this.ca=null,this.hasCachedResults=!1,this.current=!1,this.la=te(),this.mutatedKeys=te(),this.ha=EN(e),this.Pa=new xg(this.ha)}get Ia(){return this.ua}Ta(e,n){let r=n?n.Ea:new wg,i=n?n.Pa:this.Pa,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((l,d)=>{let h=i.get(l),f=Ql(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),m=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations),v=!1;h&&f?h.data.isEqual(f.data)?p!==m&&(r.track({type:3,doc:f}),v=!0):this.da(h,f)||(r.track({type:2,doc:f}),v=!0,(c&&this.ha(f,c)>0||u&&this.ha(f,u)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),v=!0):h&&!f&&(r.track({type:1,doc:h}),v=!0,(c||u)&&(a=!0)),v&&(f?(o=o.add(f),s=m?s.add(l):s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{Pa:o,Ea:r,Xi:a,mutatedKeys:s}}da(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.Pa;this.Pa=e.Pa,this.mutatedKeys=e.mutatedKeys;let o=e.Ea.k_();o.sort((l,d)=>function(f,p){let m=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return k()}};return m(f)-m(p)}(l.type,d.type)||this.ha(l.doc,d.doc)),this.Aa(r),i=i!=null&&i;let a=n&&!i?this.Ra():[],c=this.la.size===0&&this.current&&!i?1:0,u=c!==this.ca;return this.ca=c,o.length!==0||u?{snapshot:new Ja(this.query,e.Pa,s,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),Va:a}:{Va:a}}G_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Pa:this.Pa,Ea:new wg,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{Va:[]}}ma(e){return!this.ua.has(e)&&!!this.Pa.has(e)&&!this.Pa.get(e).hasLocalMutations}Aa(e){e&&(e.addedDocuments.forEach(n=>this.ua=this.ua.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ua=this.ua.delete(n)),this.current=e.current)}Ra(){if(!this.current)return[];let e=this.la;this.la=te(),this.Pa.forEach(r=>{this.ma(r.key)&&(this.la=this.la.add(r.key))});let n=[];return e.forEach(r=>{this.la.has(r)||n.push(new Cg(r))}),this.la.forEach(r=>{e.has(r)||n.push(new Ig(r))}),n}fa(e){this.ua=e.hs,this.la=te();let n=this.Ta(e.documents);return this.applyChanges(n,!0)}ga(){return Ja.fromInitialDocuments(this.query,this.Pa,this.mutatedKeys,this.ca===0,this.hasCachedResults)}},eE=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},tE=class{constructor(e){this.key=e,this.pa=!1}},nE=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.ya={},this.wa=new Ar(a=>xN(a),Kl),this.Sa=new Map,this.ba=new Set,this.Da=new Oe(M.comparator),this.Ca=new Map,this.va=new Ll,this.Fa={},this.Ma=new Map,this.xa=Qa.Ln(),this.onlineState="Unknown",this.Oa=void 0}get isPrimaryClient(){return this.Oa===!0}};function F8(t,e,n=!0){return g(this,null,function*(){let r=Lg(t),i,s=r.wa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ga()):i=yield _P(r,e,n,!0),i})}function V8(t,e){return g(this,null,function*(){let n=Lg(t);yield _P(n,e,!0,!1)})}function _P(t,e,n,r){return g(this,null,function*(){let i=yield Ya(t.localStore,Wt(e)),s=i.targetId,o=n?t.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield $E(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&Vg(t.remoteStore,i),a})}function $E(t,e,n,r,i){return g(this,null,function*(){t.Na=(d,h,f)=>function(m,v,b,F){return g(this,null,function*(){let T=v.view.Ta(b);T.Xi&&(T=yield fg(m.localStore,v.query,!1).then(({documents:be})=>v.view.Ta(be,T)));let H=F&&F.targetChanges.get(v.targetId),W=F&&F.targetMismatches.get(v.targetId)!=null,Z=v.view.applyChanges(T,m.isPrimaryClient,H,W);return rE(m,v.targetId,Z.Va),Z.snapshot})}(t,d,h,f);let s=yield fg(t.localStore,e,!0),o=new bg(e,s.hs),a=o.Ta(s.documents),c=kl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,c);rE(t,n,u.Va);let l=new eE(e,n,o);return t.wa.set(e,l),t.Sa.has(n)?t.Sa.get(n).push(e):t.Sa.set(n,[e]),u.snapshot})}function L8(t,e,n){return g(this,null,function*(){let r=R(t),i=r.wa.get(e),s=r.Sa.get(i.targetId);if(s.length>1)return r.Sa.set(i.targetId,s.filter(o=>!Kl(o,e))),void r.wa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Za(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Xa(r.remoteStore,i.targetId),ec(r,i.targetId)}).catch(Qi))):(ec(r,i.targetId),yield Za(r.localStore,i.targetId,!0))})}function j8(t,e){return g(this,null,function*(){let n=R(t),r=n.wa.get(e),i=n.Sa.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Xa(n.remoteStore,r.targetId))})}function B8(t,e,n){return g(this,null,function*(){let r=zE(t);try{let i=yield function(o,a){let c=R(o),u=Be.now(),l=a.reduce((f,p)=>f.add(p.key),te()),d,h;return c.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=ln(),m=te();return c.os.getEntries(f,l).next(v=>{p=v,p.forEach((b,F)=>{F.isValidDocument()||(m=m.add(b))})}).next(()=>c.localDocuments.getOverlayedDocuments(f,p)).next(v=>{d=v;let b=[];for(let F of a){let T=t8(F,d.get(F.key).overlayedDocument);T!=null&&b.push(new er(F.key,T,fN(T.value.mapValue),Ge.exists(!0)))}return c.mutationQueue.addMutationBatch(f,u,b,a)}).next(v=>{h=v;let b=v.applyToLocalDocumentSet(d,m);return c.documentOverlayCache.saveOverlays(f,v.batchId,b)})}).then(()=>({batchId:h.batchId,changes:CN(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let u=o.Fa[o.currentUser.toKey()];u||(u=new Oe(J)),u=u.insert(a,c),o.Fa[o.currentUser.toKey()]=u}(r,i.batchId,n),yield si(r,i.changes),yield ac(r.remoteStore)}catch(i){let s=uc(i,"Failed to persist write");n.reject(s)}})}function yP(t,e){return g(this,null,function*(){let n=R(t);try{let r=yield x8(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.Ca.get(s);o&&(L(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.pa=!0:i.modifiedDocuments.size>0?L(o.pa):i.removedDocuments.size>0&&(L(o.pa),o.pa=!1))}),yield si(n,r,e)}catch(r){yield Qi(r)}})}function GR(t,e,n){let r=R(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.wa.forEach((s,o)=>{let a=o.view.G_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=R(o);c.onlineState=a;let u=!1;c.queries.forEach((l,d)=>{for(let h of d.Q_)h.G_(a)&&(u=!0)}),u&&UE(c)}(r.eventManager,e),i.length&&r.ya.u_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function U8(t,e,n){return g(this,null,function*(){let r=R(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.Ca.get(e),s=i&&i.key;if(s){let o=new Oe(M.comparator);o=o.insert(s,at.newNoDocument(s,U.min()));let a=te().add(s),c=new Pl(U.min(),new Map,new Oe(J),o,a);yield yP(r,c),r.Da=r.Da.remove(s),r.Ca.delete(e),GE(r)}else yield Za(r.localStore,e,!1).then(()=>ec(r,e,n)).catch(Qi)})}function $8(t,e){return g(this,null,function*(){let n=R(t),r=e.batch.batchId;try{let i=yield v8(n.localStore,e);qE(n,r,null),HE(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield si(n,i)}catch(i){yield Qi(i)}})}function H8(t,e,n){return g(this,null,function*(){let r=R(t);try{let i=yield function(o,a){let c=R(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let l;return c.mutationQueue.lookupMutationBatch(u,a).next(d=>(L(d!==null),l=d.keys(),c.mutationQueue.removeMutationBatch(u,d))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,l,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,l)).next(()=>c.localDocuments.getDocuments(u,l))})}(r.localStore,e);qE(r,e,n),HE(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield si(r,i)}catch(i){yield Qi(i)}})}function q8(t,e){return g(this,null,function*(){let n=R(t);Zi(n.remoteStore)||I("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=R(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(n.localStore);if(r===-1)return void e.resolve();let i=n.Ma.get(r)||[];i.push(e),n.Ma.set(r,i)}catch(r){let i=uc(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function HE(t,e){(t.Ma.get(e)||[]).forEach(n=>{n.resolve()}),t.Ma.delete(e)}function qE(t,e,n){let r=R(t),i=r.Fa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Fa[r.currentUser.toKey()]=i}}function ec(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.Sa.get(e))t.wa.delete(r),n&&t.ya.La(r,n);t.Sa.delete(e),t.isPrimaryClient&&t.va.Vr(e).forEach(r=>{t.va.containsKey(r)||vP(t,r)})}function vP(t,e){t.ba.delete(e.path.canonicalString());let n=t.Da.get(e);n!==null&&(Xa(t.remoteStore,n),t.Da=t.Da.remove(e),t.Ca.delete(n),GE(t))}function rE(t,e,n){for(let r of n)r instanceof Ig?(t.va.addReference(r.key,e),G8(t,r)):r instanceof Cg?(I("SyncEngine","Document no longer in limbo: "+r.key),t.va.removeReference(r.key,e),t.va.containsKey(r.key)||vP(t,r.key)):k()}function G8(t,e){let n=e.key,r=n.path.canonicalString();t.Da.get(n)||t.ba.has(r)||(I("SyncEngine","New document in limbo: "+n),t.ba.add(r),GE(t))}function GE(t){for(;t.ba.size>0&&t.Da.size<t.maxConcurrentLimboResolutions;){let e=t.ba.values().next().value;t.ba.delete(e);let n=new M(me.fromString(e)),r=t.xa.next();t.Ca.set(r,new tE(n)),t.Da=t.Da.insert(n,r),Vg(t.remoteStore,new Ka(Wt(sc(n.path)),r,"TargetPurposeLimboResolution",_n._e))}}function si(t,e,n){return g(this,null,function*(){let r=R(t),i=[],s=[],o=[];r.wa.isEmpty()||(r.wa.forEach((a,c)=>{o.push(r.Na(c,e,n).then(u=>{if((u||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,u?.fromCache?"not-current":"current"),u){i.push(u);let l=Ow.Ki(c.targetId,u);s.push(l)}}))}),yield Promise.all(o),r.ya.u_(i),yield function(c,u){return g(this,null,function*(){let l=R(c);try{yield l.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>_.forEach(u,h=>_.forEach(h.qi,f=>l.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>_.forEach(h.Qi,f=>l.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!Yi(d))throw d;I("LocalStore","Failed to update sequence numbers: "+d)}for(let d of u){let h=d.targetId;if(!d.fromCache){let f=l.ns.get(h),p=f.snapshotVersion,m=f.withLastLimboFreeSnapshotVersion(p);l.ns=l.ns.insert(h,m)}}})}(r.localStore,s))})}function z8(t,e){return g(this,null,function*(){let n=R(t);if(!n.currentUser.isEqual(e)){I("SyncEngine","User change. New user:",e.toKey());let r=yield iP(n.localStore,e);n.currentUser=e,function(s,o){s.Ma.forEach(a=>{a.forEach(c=>{c.reject(new w(y.CANCELLED,o))})}),s.Ma.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield si(n,r.us)}})}function W8(t,e){let n=R(t),r=n.Ca.get(e);if(r&&r.pa)return te().add(r.key);{let i=te(),s=n.Sa.get(e);if(!s)return i;for(let o of s){let a=n.wa.get(o);i=i.unionWith(a.view.Ia)}return i}}function K8(t,e){return g(this,null,function*(){let n=R(t),r=yield fg(n.localStore,e.query,!0),i=e.view.fa(r);return n.isPrimaryClient&&rE(n,e.targetId,i.Va),i})}function Q8(t,e){return g(this,null,function*(){let n=R(t);return cP(n.localStore,e).then(r=>si(n,r))})}function Y8(t,e,n,r){return g(this,null,function*(){let i=R(t),s=yield function(a,c){let u=R(a),l=R(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",d=>l.vn(d,c).next(h=>h?u.localDocuments.getDocuments(d,h):_.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?yield ac(i.remoteStore):n==="acknowledged"||n==="rejected"?(qE(i,e,r||null),HE(i,e),function(a,c){R(R(a).mutationQueue).Mn(c)}(i.localStore,e)):k(),yield si(i,s)):I("SyncEngine","Cannot apply mutation batch with id: "+e)})}function Z8(t,e){return g(this,null,function*(){let n=R(t);if(Lg(n),zE(n),e===!0&&n.Oa!==!0){let r=n.sharedClientState.getAllActiveQueryTargets(),i=yield zR(n,r.toArray());n.Oa=!0,yield Ww(n.remoteStore,!0);for(let s of i)Vg(n.remoteStore,s)}else if(e===!1&&n.Oa!==!1){let r=[],i=Promise.resolve();n.Sa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(ec(n,o),Za(n.localStore,o,!0))),Xa(n.remoteStore,o)}),yield i,yield zR(n,r),function(o){let a=R(o);a.Ca.forEach((c,u)=>{Xa(a.remoteStore,u)}),a.va.mr(),a.Ca=new Map,a.Da=new Oe(M.comparator)}(n),n.Oa=!1,yield Ww(n.remoteStore,!1)}})}function zR(t,e,n){return g(this,null,function*(){let r=R(t),i=[],s=[];for(let o of e){let a,c=r.Sa.get(o);if(c&&c.length!==0){a=yield Ya(r.localStore,Wt(c[0]));for(let u of c){let l=r.wa.get(u),d=yield K8(r,l);d.snapshot&&s.push(d.snapshot)}}else{let u=yield aP(r.localStore,o);a=yield Ya(r.localStore,u),yield $E(r,xP(u),o,!1,a.resumeToken)}i.push(a)}return r.ya.u_(s),i})}function xP(t){return vN(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function X8(t){return function(n){return R(R(n).persistence).Bi()}(R(t).localStore)}function J8(t,e,n,r){return g(this,null,function*(){let i=R(t);if(i.Oa)return void I("SyncEngine","Ignoring unexpected query state notification.");let s=i.Sa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{let o=yield cP(i.localStore,wN(s[0])),a=Pl.createSynthesizedRemoteEventForCurrentChange(e,n==="current",_t.EMPTY_BYTE_STRING);yield si(i,o,a);break}case"rejected":yield Za(i.localStore,e,!0),ec(i,e,r);break;default:k()}})}function e$(t,e,n){return g(this,null,function*(){let r=Lg(t);if(r.Oa){for(let i of e){if(r.Sa.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){I("SyncEngine","Adding an already active target "+i);continue}let s=yield aP(r.localStore,i),o=yield Ya(r.localStore,s);yield $E(r,xP(s),o.targetId,!1,o.resumeToken),Vg(r.remoteStore,o)}for(let i of n)r.Sa.has(i)&&(yield Za(r.localStore,i,!1).then(()=>{Xa(r.remoteStore,i),ec(r,i)}).catch(Qi))}})}function Lg(t){let e=R(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=yP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=W8.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=U8.bind(null,e),e.ya.u_=k8.bind(null,e.eventManager),e.ya.La=O8.bind(null,e.eventManager),e}function zE(t){let e=R(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=$8.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=H8.bind(null,e),e}function t$(t,e,n){let r=R(t);(function(s,o,a){return g(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(f,p){let m=R(f),v=Ye(p.createTime);return m.persistence.runTransaction("hasNewerBundle","readonly",b=>m.$r.getBundleMetadata(b,p.id)).then(b=>!!b&&b.createTime.compareTo(v)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(mP(c));let u=new Jw(c,s.localStore,o.serializer),l=yield o.Ba();for(;l;){let h=yield u.sa(l);h&&a._updateProgress(h),l=yield o.Ba()}let d=yield u.complete();return yield si(s,d.aa,void 0),yield function(f,p){let m=R(f);return m.persistence.runTransaction("Save bundle","readwrite",v=>m.$r.saveBundleMetadata(v,p))}(s.localStore,c),a._completeWith(d.progress),Promise.resolve(d._a)}catch(c){return kn("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var $l=class{constructor(){this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){this.serializer=Yl(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return rP(this.persistence,new hg,e.initialUser,this.serializer)}createPersistence(e){return new lg(dg.Hr,this.serializer)}createSharedClientState(e){return new mg}terminate(){return g(this,null,function*(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Dg=class t extends $l{constructor(e,n,r){super(),this.ka=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){yield Xm(t.prototype,this,"initialize").call(this,e),yield this.ka.initialize(this,e),yield zE(this.ka.syncEngine),yield ac(this.ka.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return rP(this.persistence,new hg,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){let r=this.persistence.referenceDelegate.garbageCollector;return new xw(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){let r=new Lx(n,this.persistence);return new Vx(e.asyncQueue,r)}createPersistence(e){let n=OE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Pn.withCacheSize(this.cacheSizeBytes):Pn.DEFAULT;return new kw(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,lP(),Lp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new mg}},iE=class t extends Dg{constructor(e,n){super(e,n,!1),this.ka=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){return g(this,null,function*(){yield Xm(t.prototype,this,"initialize").call(this,e);let n=this.ka.syncEngine;this.sharedClientState instanceof Il&&(this.sharedClientState.syncEngine={Zs:Y8.bind(null,n),Xs:J8.bind(null,n),eo:e$.bind(null,n),Bi:X8.bind(null,n),Ys:Q8.bind(null,n)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>g(this,null,function*(){yield Z8(this.ka.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let n=lP();if(!Il.D(n))throw new w(y.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=OE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Il(n,e.asyncQueue,r,e.clientId,e.initialUser)}},Hl=class{initialize(e,n){return g(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>GR(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=z8.bind(null,this.syncEngine),yield Ww(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new Yw}()}createDatastore(e){let n=Yl(e.databaseInfo.databaseId),r=function(s){return new Uw(s)}(e.databaseInfo);return function(s,o,a,c){return new qw(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new zw(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>GR(this.syncEngine,n,0),function(){return _g.D()?new _g:new jw}())}createSyncEngine(e,n){return function(i,s,o,a,c,u,l){let d=new nE(i,s,o,a,c,u);return l&&(d.Oa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return g(this,null,function*(){var e;yield function(r){return g(this,null,function*(){let i=R(r);I("RemoteStore","RemoteStore shutting down."),i.v_.add(5),yield oc(i),i.M_.shutdown(),i.x_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function WR(t,e=10240){let n=0;return{read(){return g(this,null,function*(){if(n<t.byteLength){let i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}})},cancel(){return g(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var tc=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.qa(this.observer.next,e)}error(e){this.observer.error?this.qa(this.observer.error,e):Ke("Uncaught Error in snapshot listener:",e.toString())}Qa(){this.muted=!0}qa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var sE=class{constructor(e,n){this.Ka=e,this.serializer=n,this.metadata=new ot,this.buffer=new Uint8Array,this.$a=function(){return new TextDecoder("utf-8")}(),this.Ua().then(r=>{r&&r.ra()?this.metadata.resolve(r.na.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.na)}`))},r=>this.metadata.reject(r))}close(){return this.Ka.cancel()}getMetadata(){return g(this,null,function*(){return this.metadata.promise})}Ba(){return g(this,null,function*(){return yield this.getMetadata(),this.Ua()})}Ua(){return g(this,null,function*(){let e=yield this.Wa();if(e===null)return null;let n=this.$a.decode(e),r=Number(n);isNaN(r)&&this.Ga(`length string (${n}) is not valid number`);let i=yield this.za(r);return new Xw(JSON.parse(i),e.length+r)})}ja(){return this.buffer.findIndex(e=>e===123)}Wa(){return g(this,null,function*(){for(;this.ja()<0&&!(yield this.Ha()););if(this.buffer.length===0)return null;let e=this.ja();e<0&&this.Ga("Reached the end of bundle when a length string is expected.");let n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n})}za(e){return g(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ha())&&this.Ga("Reached the end of bundle when more is expected.");let n=this.$a.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n})}Ga(e){throw this.Ka.cancel(),new Error(`Invalid bundle format: ${e}`)}Ha(){return g(this,null,function*(){let e=yield this.Ka.read();if(!e.done){let n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done})}};var oE=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new w(y.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let n=yield function(i,s){return g(this,null,function*(){let o=R(i),a={documents:s.map(d=>Ol(o.serializer,d))},c=yield o.vo("BatchGetDocuments",o.serializer.databaseId,me.emptyPath(),a,s.length),u=new Map;c.forEach(d=>{let h=a8(o.serializer,d);u.set(h.key.toString(),h)});let l=[];return s.forEach(d=>{let h=u.get(d.toString());L(!!h),l.push(h)}),l})}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n})}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Wi(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{let i=M.fromPath(r);this.mutations.push(new Ml(i,this.precondition(i)))}),yield function(r,i){return g(this,null,function*(){let s=R(r),o={writes:i.map(a=>Fl(s.serializer,a))};yield s.So("Commit",s.serializer.databaseId,me.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw k();n=U.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new w(y.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){let n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(U.min())?Ge.exists(!1):Ge.updateTime(n):Ge.none()}preconditionForUpdate(e){let n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(U.min()))throw new w(y.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ge.updateTime(n)}return Ge.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var aE=class{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Ja=r.maxAttempts,this.jo=new Bl(this.asyncQueue,"transaction_retry")}Ya(){this.Ja-=1,this.Za()}Za(){this.jo.qo(()=>g(this,null,function*(){let e=new oE(this.datastore),n=this.Xa(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.eu(i)}))}).catch(r=>{this.eu(r)})}))}Xa(e){try{let n=this.updateFunction(e);return!zl(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}eu(e){this.Ja>0&&this.tu(e)?(this.Ja-=1,this.asyncQueue.enqueueAndForget(()=>(this.Za(),Promise.resolve()))):this.deferred.reject(e)}tu(e){if(e.name==="FirebaseError"){let n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!ON(n)}return!1}};var cE=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=st.UNAUTHENTICATED,this.clientId=Up.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>g(this,null,function*(){I("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(I("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new w(y.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ot;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=uc(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function jp(t,e){return g(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),I("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>g(this,null,function*(){r.isEqual(i)||(yield iP(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function uE(t,e){return g(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield WE(t);I("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>HR(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>HR(e.remoteStore,i)),t._onlineComponents=e})}function wP(t){return t.name==="FirebaseError"?t.code===y.FAILED_PRECONDITION||t.code===y.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function WE(t){return g(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){I("FirestoreClient","Using user provided OfflineComponentProvider");try{yield jp(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!wP(n))throw n;kn("Error using user provided cache. Falling back to memory cache: "+n),yield jp(t,new $l)}}else I("FirestoreClient","Using default OfflineComponentProvider"),yield jp(t,new $l);return t._offlineComponents})}function jg(t){return g(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(I("FirestoreClient","Using user provided OnlineComponentProvider"),yield uE(t,t._uninitializedComponentsProvider._online)):(I("FirestoreClient","Using default OnlineComponentProvider"),yield uE(t,new Hl))),t._onlineComponents})}function EP(t){return WE(t).then(e=>e.persistence)}function KE(t){return WE(t).then(e=>e.localStore)}function IP(t){return jg(t).then(e=>e.remoteStore)}function QE(t){return jg(t).then(e=>e.syncEngine)}function n$(t){return jg(t).then(e=>e.datastore)}function nc(t){return g(this,null,function*(){let e=yield jg(t),n=e.eventManager;return n.onListen=F8.bind(null,e.syncEngine),n.onUnlisten=L8.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=V8.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=j8.bind(null,e.syncEngine),n})}function r$(t){return t.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield EP(t),n=yield IP(t);return e.setNetworkEnabled(!0),function(i){let s=R(i);return s.v_.delete(0),Zl(s)}(n)}))}function i$(t){return t.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield EP(t),n=yield IP(t);return e.setNetworkEnabled(!1),function(i){return g(this,null,function*(){let s=R(i);s.v_.add(0),yield oc(s),s.x_.set("Offline")})}(n)}))}function s$(t,e){let n=new ot;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield function(u,l){let d=R(u);return d.persistence.runTransaction("read document","readonly",h=>d.localDocuments.getDocument(h,l))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new w(y.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=uc(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield KE(t),e,n)})),n.promise}function CP(t,e,n={}){let r=new ot;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,u){let l=new tc({next:h=>{o.enqueueAndForget(()=>BE(s,d));let f=h.docs.has(a);!f&&h.fromCache?u.reject(new w(y.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&c&&c.source==="server"?u.reject(new w(y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(h)},error:h=>u.reject(h)}),d=new Ul(sc(a.path),l,{includeMetadataChanges:!0,ta:!0});return jE(s,d)}(yield nc(t),t.asyncQueue,e,n,r)})),r.promise}function o$(t,e){let n=new ot;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield fg(i,s,!0),c=new bg(s,a.hs),u=c.Ta(a.documents),l=c.applyChanges(u,!1);o.resolve(l.snapshot)}catch(a){let c=uc(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield KE(t),e,n)})),n.promise}function bP(t,e,n={}){let r=new ot;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,u){let l=new tc({next:h=>{o.enqueueAndForget(()=>BE(s,d)),h.fromCache&&c.source==="server"?u.reject(new w(y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(h)},error:h=>u.reject(h)}),d=new Ul(a,l,{includeMetadataChanges:!0,ta:!0});return jE(s,d)}(yield nc(t),t.asyncQueue,e,n,r)})),r.promise}function a$(t,e){let n=new tc(e);return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){R(i).W_.add(s),s.next()}(yield nc(t),n)})),()=>{n.Qa(),t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){R(i).W_.delete(s)}(yield nc(t),n)}))}}function c$(t,e,n,r){let i=function(o,a){let c;return c=typeof o=="string"?VN().encode(o):o,function(l,d){return new sE(l,d)}(function(l,d){if(l instanceof Uint8Array)return WR(l,d);if(l instanceof ArrayBuffer)return WR(new Uint8Array(l),d);if(l instanceof ReadableStream)return l.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(n,Yl(e));t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){t$(yield QE(t),i,r)}))}function u$(t,e){return t.asyncQueue.enqueue(()=>g(this,null,function*(){return function(r,i){let s=R(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield KE(t),e)}))}function DP(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var KR=new Map;function YE(t,e,n){if(!n)throw new w(y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function ZE(t,e,n,r){if(e===!0&&r===!0)throw new w(y.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function QR(t){if(!M.isDocumentKey(t))throw new w(y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function YR(t){if(M.isDocumentKey(t))throw new w(y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Bg(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":k()}function _e(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new w(y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=Bg(t);throw new w(y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function TP(t,e){if(e<=0)throw new w(y.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}var Tg=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new w(y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new w(y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ZE("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=DP((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new w(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new w(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new w(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},ro=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Tg({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new w(y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new w(y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Tg(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Tx;switch(r.type){case"firstParty":return new Rx(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new w(y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=KR.get(n);r&&(I("ComponentProvider","Removing Datastore"),KR.delete(n),r.terminate())}(this),Promise.resolve()}};function SP(t,e,n,r={}){var i;let s=(t=_e(t,ro))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&kn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=st.MOCK_USER;else{a=$d(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new w(y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new st(u)}t._authCredentials=new Sx(new Bp(a,c))}}var At=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},Ne=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Dr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},Dr=class t extends At{constructor(e,n,r){super(e,n,sc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ne(this.firestore,null,new M(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function XE(t,e,...n){if(t=le(t),YE("collection","path",e),t instanceof ro){let r=me.fromString(e,...n);return YR(r),new Dr(t,null,r)}{if(!(t instanceof Ne||t instanceof Dr))throw new w(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(me.fromString(e,...n));return YR(r),new Dr(t.firestore,null,r)}}function AP(t,e){if(t=_e(t,ro),YE("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new w(y.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new At(t,null,function(r){return new Jn(me.emptyPath(),r)}(e))}function Xl(t,e,...n){if(t=le(t),arguments.length===1&&(e=Up.newId()),YE("doc","path",e),t instanceof ro){let r=me.fromString(e,...n);return QR(r),new Ne(t,null,new M(r))}{if(!(t instanceof Ne||t instanceof Dr))throw new w(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(me.fromString(e,...n));return QR(r),new Ne(t.firestore,t instanceof Dr?t.converter:null,new M(r))}}function JE(t,e){return t=le(t),e=le(e),(t instanceof Ne||t instanceof Dr)&&(e instanceof Ne||e instanceof Dr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function eI(t,e){return t=le(t),e=le(e),t instanceof At&&e instanceof At&&t.firestore===e.firestore&&Kl(t._query,e._query)&&t.converter===e.converter}var lE=class{constructor(){this.nu=Promise.resolve(),this.ru=[],this.iu=!1,this.su=[],this.ou=null,this._u=!1,this.au=!1,this.uu=[],this.jo=new Bl(this,"async_queue_retry"),this.cu=()=>{let n=Lp();n&&I("AsyncQueue","Visibility state changed to "+n.visibilityState),this.jo.Ko()};let e=Lp();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.cu)}get isShuttingDown(){return this.iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.lu(),this.hu(e)}enterRestrictedMode(e){if(!this.iu){this.iu=!0,this.au=e||!1;let n=Lp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.cu)}}enqueue(e){if(this.lu(),this.iu)return new Promise(()=>{});let n=new ot;return this.hu(()=>this.iu&&this.au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.ru.push(e),this.Pu()))}Pu(){return g(this,null,function*(){if(this.ru.length!==0){try{yield this.ru[0](),this.ru.shift(),this.jo.reset()}catch(e){if(!Yi(e))throw e;I("AsyncQueue","Operation failed with retryable error: "+e)}this.ru.length>0&&this.jo.qo(()=>this.Pu())}})}hu(e){let n=this.nu.then(()=>(this._u=!0,e().catch(r=>{this.ou=r,this._u=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Ke("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this._u=!1,r))));return this.nu=n,n}enqueueAfterDelay(e,n,r){this.lu(),this.uu.indexOf(e)>-1&&(n=0);let i=Kw.createAndSchedule(this,e,n,r,s=>this.Iu(s));return this.su.push(i),i}lu(){this.ou&&k()}verifyOperationInProgress(){}Tu(){return g(this,null,function*(){let e;do e=this.nu,yield e;while(e!==this.nu)})}Eu(e){for(let n of this.su)if(n.timerId===e)return!0;return!1}du(e){return this.Tu().then(()=>{this.su.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.su)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tu()})}Au(e){this.uu.push(e)}Iu(e){let n=this.su.indexOf(e);this.su.splice(n,1)}};function dE(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var hE=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new ot,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var MP=-1,Le=class extends ro{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new lE}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||RP(this),this._firestoreClient.terminate()}};function dt(t){return t._firestoreClient||RP(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function RP(t){var e,n,r;let i=t._freezeSettings(),s=function(a,c,u,l){return new jx(a,c,u,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,DP(l.experimentalLongPollingOptions),l.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new cE(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function NP(t,e){UP(t=_e(t,Le));let n=dt(t);if(n._uninitializedComponentsProvider)throw new w(y.FAILED_PRECONDITION,"SDK cache is already specified.");kn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=t._freezeSettings(),i=new Hl;return kP(n,i,new Dg(i,r.cacheSizeBytes,e?.forceOwnership))}function PP(t){UP(t=_e(t,Le));let e=dt(t);if(e._uninitializedComponentsProvider)throw new w(y.FAILED_PRECONDITION,"SDK cache is already specified.");kn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=t._freezeSettings(),r=new Hl;return kP(e,r,new iE(r,n.cacheSizeBytes))}function kP(t,e,n){let r=new ot;return t.asyncQueue.enqueue(()=>g(this,null,function*(){try{yield jp(t,n),yield uE(t,e),r.resolve()}catch(i){let s=i;if(!wP(s))throw s;kn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function OP(t){if(t._initialized&&!t._terminated)throw new w(y.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new ot;return t._queue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{yield function(r){return g(this,null,function*(){if(!ei.D())return Promise.resolve();let i=r+"main";yield ei.delete(i)})}(OE(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}})),e.promise}function FP(t){return function(n){let r=new ot;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return q8(yield QE(n),r)})),r.promise}(dt(t=_e(t,Le)))}function VP(t){return r$(dt(t=_e(t,Le)))}function LP(t){return i$(dt(t=_e(t,Le)))}function jP(t,e){let n=dt(t=_e(t,Le)),r=new hE;return c$(n,t._databaseId,e,r),r}function BP(t,e){return u$(dt(t=_e(t,Le)),e).then(n=>n?new At(t,null,n.query):null)}function UP(t){if(t._initialized||t._terminated)throw new w(y.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Mr=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(_t.fromBase64String(e))}catch(n){throw new w(y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(_t.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var tr=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new w(y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Qe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ri=class{constructor(e){this._methodName=e}};var io=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new w(y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new w(y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return J(this._lat,e._lat)||J(this._long,e._long)}};var l$=/^__.*__$/,fE=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new er(e,this.data,this.fieldMask,n,this.fieldTransforms):new zi(e,this.data,n,this.fieldTransforms)}},Sg=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new er(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function $P(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw k()}}var Ag=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ru(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Vu(){return this.settings.Vu}mu(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}fu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.mu({path:r,gu:!1});return i.pu(e),i}yu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.mu({path:r,gu:!1});return i.Ru(),i}wu(e){return this.mu({path:void 0,gu:!0})}Su(e){return Mg(e,this.settings.methodName,this.settings.bu||!1,this.path,this.settings.Du)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Ru(){if(this.path)for(let e=0;e<this.path.length;e++)this.pu(this.path.get(e))}pu(e){if(e.length===0)throw this.Su("Document fields must not be empty");if($P(this.Vu)&&l$.test(e))throw this.Su('Document fields cannot begin and end with "__"')}},pE=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Yl(e)}Cu(e,n,r,i=!1){return new Ag({Vu:e,methodName:n,Du:r,path:Qe.emptyPath(),gu:!1,bu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function co(t){let e=t._freezeSettings(),n=Yl(t._databaseId);return new pE(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Ug(t,e,n,r,i,s={}){let o=t.Cu(s.merge||s.mergeFields?2:0,e,n,i);rI("Data must be an object, but it was:",o,r);let a=GP(r,o),c,u;if(s.merge)c=new yn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){let l=[];for(let d of s.mergeFields){let h=vE(e,d,n);if(!o.contains(h))throw new w(y.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);WP(l,h)||l.push(h)}c=new yn(l),u=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,u=o.fieldTransforms;return new fE(new Ot(a),c,u)}var ql=class t extends ri{_toFieldTransform(e){if(e.Vu!==2)throw e.Vu===1?e.Su(`${this._methodName}() can only appear at the top level of your update data`):e.Su(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};function HP(t,e,n){return new Ag({Vu:3,Du:e.settings.Du,methodName:t._methodName,gu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var gE=class t extends ri{_toFieldTransform(e){return new eo(e.path,new qi)}isEqual(e){return e instanceof t}},mE=class t extends ri{constructor(e,n){super(e),this.vu=n}_toFieldTransform(e){let n=HP(this,e,!0),r=this.vu.map(s=>uo(s,n)),i=new ti(r);return new eo(e.path,i)}isEqual(e){return e instanceof t&&t_(this.vu,e.vu)}},_E=class t extends ri{constructor(e,n){super(e),this.vu=n}_toFieldTransform(e){let n=HP(this,e,!0),r=this.vu.map(s=>uo(s,n)),i=new ni(r);return new eo(e.path,i)}isEqual(e){return e instanceof t&&t_(this.vu,e.vu)}},yE=class t extends ri{constructor(e,n){super(e),this.Fu=n}_toFieldTransform(e){let n=new Gi(e.serializer,SN(e.serializer,this.Fu));return new eo(e.path,n)}isEqual(e){return e instanceof t&&this.Fu===e.Fu}};function tI(t,e,n,r){let i=t.Cu(1,e,n);rI("Data must be an object, but it was:",i,r);let s=[],o=Ot.empty();ao(r,(c,u)=>{let l=iI(e,c,n);u=le(u);let d=i.yu(l);if(u instanceof ql)s.push(l);else{let h=uo(u,d);h!=null&&(s.push(l),o.set(l,h))}});let a=new yn(s);return new Sg(o,a,i.fieldTransforms)}function nI(t,e,n,r,i,s){let o=t.Cu(1,e,n),a=[vE(e,r,n)],c=[i];if(s.length%2!=0)throw new w(y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(vE(e,s[h])),c.push(s[h+1]);let u=[],l=Ot.empty();for(let h=a.length-1;h>=0;--h)if(!WP(u,a[h])){let f=a[h],p=c[h];p=le(p);let m=o.yu(f);if(p instanceof ql)u.push(f);else{let v=uo(p,m);v!=null&&(u.push(f),l.set(f,v))}}let d=new yn(u);return new Sg(l,d,o.fieldTransforms)}function qP(t,e,n,r=!1){return uo(n,t.Cu(r?4:3,e))}function uo(t,e){if(zP(t=le(t)))return rI("Unsupported field value:",e,t),GP(t,e);if(t instanceof ri)return function(r,i){if(!$P(i.Vu))throw i.Su(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Su(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.gu&&e.Vu!==4)throw e.Su("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=uo(a,i.wu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=le(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return SN(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Be.fromDate(r);return{timestampValue:Wa(i.serializer,s)}}if(r instanceof Be){let s=new Be(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Wa(i.serializer,s)}}if(r instanceof io)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Mr)return{bytesValue:LN(i.serializer,r._byteString)};if(r instanceof Ne){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Su(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:NE(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Su(`Unsupported field value: ${Bg(r)}`)}(t,e)}function GP(t,e){let n={};return lN(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ao(t,(r,i)=>{let s=uo(i,e.fu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function zP(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Be||t instanceof io||t instanceof Mr||t instanceof Ne||t instanceof ri)}function rI(t,e,n){if(!zP(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=Bg(n);throw r==="an object"?e.Su(t+" a custom object"):e.Su(t+" "+r)}}function vE(t,e,n){if((e=le(e))instanceof tr)return e._internalPath;if(typeof e=="string")return iI(t,e);throw Mg("Field path arguments must be of type string or ",t,!1,void 0,n)}var d$=new RegExp("[~\\*/\\[\\]]");function iI(t,e,n){if(e.search(d$)>=0)throw Mg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new tr(...e.split("."))._internalPath}catch{throw Mg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Mg(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new w(y.INVALID_ARGUMENT,a+t+c)}function WP(t,e){return t.some(n=>n.isEqual(e))}var so=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ne(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new xE(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field($g("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},xE=class extends so{data(){return super.data()}};function $g(t,e){return typeof e=="string"?iI(t,e):e instanceof tr?e._internalPath:e._delegate._internalPath}function KP(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new w(y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Gl=class{},oo=class extends Gl{};function oi(t,e,...n){let r=[];e instanceof Gl&&r.push(e),r=r.concat(n),function(s){let o=s.filter(c=>c instanceof wE).length,a=s.filter(c=>c instanceof Rg).length;if(o>1||o>0&&a>0)throw new w(y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var Rg=class t extends oo{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return ik(e._query,n),new At(e.firestore,e.converter,Xx(e._query,n))}_parse(e){let n=co(e.firestore);return function(s,o,a,c,u,l,d){let h;if(u.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new w(y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){XR(d,l);let f=[];for(let p of d)f.push(ZR(c,s,p));h={arrayValue:{values:f}}}else h=ZR(c,s,d)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||XR(d,l),h=qP(a,o,d,l==="in"||l==="not-in");return fe.create(u,l,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function QP(t,e,n){let r=e,i=$g("where",t);return Rg._create(i,r,n)}var wE=class t extends Gl{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ce.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)ik(o,c),o=Xx(o,c)}(e._query,n),new At(e.firestore,e.converter,Xx(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var EE=class t extends oo{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t(e,n)}_apply(e){let n=function(i,s,o){if(i.startAt!==null)throw new w(y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new w(y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Xs(s,o)}(e._query,this._field,this._direction);return new At(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new Jn(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}};function YP(t,e="asc"){let n=e,r=$g("orderBy",t);return EE._create(r,n)}var Ng=class t extends oo{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){return new At(e.firestore,e.converter,Zp(e._query,this._limit,this._limitType))}};function ZP(t){return TP("limit",t),Ng._create("limit",t,"F")}function XP(t){return TP("limitToLast",t),Ng._create("limitToLast",t,"L")}var Pg=class t extends oo{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=rk(e,this.type,this._docOrFields,this._inclusive);return new At(e.firestore,e.converter,function(i,s){return new Jn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function JP(...t){return Pg._create("startAt",t,!0)}function ek(...t){return Pg._create("startAfter",t,!1)}var kg=class t extends oo{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=rk(e,this.type,this._docOrFields,this._inclusive);return new At(e.firestore,e.converter,function(i,s){return new Jn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function tk(...t){return kg._create("endBefore",t,!1)}function nk(...t){return kg._create("endAt",t,!0)}function rk(t,e,n,r){if(n[0]=le(n[0]),n[0]instanceof so)return function(s,o,a,c,u){if(!c)throw new w(y.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let l=[];for(let d of ja(s))if(d.field.isKeyField())l.push(Zs(o,c.key));else{let h=c.data.field(d.field);if(Fg(h))throw new w(y.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){let f=d.field.canonicalString();throw new w(y.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}l.push(h)}return new Sr(l,u)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{let i=co(t.firestore);return function(o,a,c,u,l,d){let h=o.explicitOrderBy;if(l.length>h.length)throw new w(y.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let f=[];for(let p=0;p<l.length;p++){let m=l[p];if(h[p].field.isKeyField()){if(typeof m!="string")throw new w(y.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof m}`);if(!ME(o)&&m.indexOf("/")!==-1)throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${m}' contains a slash.`);let v=o.path.child(me.fromString(m));if(!M.isDocumentKey(v))throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${v}' is not because it contains an odd number of segments.`);let b=new M(v);f.push(Zs(a,b))}else{let v=qP(c,u,m);f.push(v)}}return new Sr(f,d)}(t._query,t.firestore._databaseId,i,e,n,r)}}function ZR(t,e,n){if(typeof(n=le(n))=="string"){if(n==="")throw new w(y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ME(e)&&n.indexOf("/")!==-1)throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(me.fromString(n));if(!M.isDocumentKey(r))throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Zs(t,new M(r))}if(n instanceof Ne)return Zs(t,n._key);throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Bg(n)}.`)}function XR(t,e){if(!Array.isArray(t)||t.length===0)throw new w(y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ik(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new w(y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new w(y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var rc=class{convertValue(e,n="none"){switch(Ys(e)){case 0:return null;case 1:return e.booleanValue;case 2:return qe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ui(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw k()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return ao(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new io(qe(e.latitude),qe(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=SE(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Tl(e));default:return null}}convertTimestamp(e){let n=Bi(e);return new Be(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=me.fromString(e);L(QN(r));let i=new $i(r.get(1),r.get(3)),s=new M(r.popFirst(5));return i.isEqual(n)||Ke(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function Hg(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var IE=class extends rc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ne(this.firestore,null,n)}};var Jr=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Fn=class extends so{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new Li(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field($g("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},Li=class extends Fn{data(e={}){return super.data(e)}},nr=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Jr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Li(this._firestore,this._userDataWriter,r.key,r,new Jr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new w(y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new Li(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Jr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new Li(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Jr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),u=-1,l=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),l=o.indexOf(a.doc.key)),{type:h$(a.type),doc:c,oldIndex:u,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function h$(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return k()}}function sI(t,e){return t instanceof Fn&&e instanceof Fn?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof nr&&e instanceof nr&&t._firestore===e._firestore&&eI(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function sk(t){t=_e(t,Ne);let e=_e(t.firestore,Le);return CP(dt(e),t._key).then(n=>uI(e,t,n))}var ii=class extends rc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ne(this.firestore,null,n)}};function ok(t){t=_e(t,Ne);let e=_e(t.firestore,Le),n=dt(e),r=new ii(e);return s$(n,t._key).then(i=>new Fn(e,r,t._key,i,new Jr(i!==null&&i.hasLocalMutations,!0),t.converter))}function ak(t){t=_e(t,Ne);let e=_e(t.firestore,Le);return CP(dt(e),t._key,{source:"server"}).then(n=>uI(e,t,n))}function ck(t){t=_e(t,At);let e=_e(t.firestore,Le),n=dt(e),r=new ii(e);return KP(t._query),bP(n,t._query).then(i=>new nr(e,r,t,i))}function uk(t){t=_e(t,At);let e=_e(t.firestore,Le),n=dt(e),r=new ii(e);return o$(n,t._query).then(i=>new nr(e,r,t,i))}function lk(t){t=_e(t,At);let e=_e(t.firestore,Le),n=dt(e),r=new ii(e);return bP(n,t._query,{source:"server"}).then(i=>new nr(e,r,t,i))}function oI(t,e,n){t=_e(t,Ne);let r=_e(t.firestore,Le),i=Hg(t.converter,e,n);return lc(r,[Ug(co(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Ge.none())])}function aI(t,e,n,...r){t=_e(t,Ne);let i=_e(t.firestore,Le),s=co(i),o;return o=typeof(e=le(e))=="string"||e instanceof tr?nI(s,"updateDoc",t._key,e,n,r):tI(s,"updateDoc",t._key,e),lc(i,[o.toMutation(t._key,Ge.exists(!0))])}function dk(t){return lc(_e(t.firestore,Le),[new Wi(t._key,Ge.none())])}function hk(t,e){let n=_e(t.firestore,Le),r=Xl(t),i=Hg(t.converter,e);return lc(n,[Ug(co(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Ge.exists(!1))]).then(()=>r)}function cI(t,...e){var n,r,i;t=le(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||dE(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(dE(e[o])){let d=e[o];e[o]=(n=d.next)===null||n===void 0?void 0:n.bind(d),e[o+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let c,u,l;if(t instanceof Ne)u=_e(t.firestore,Le),l=sc(t._key.path),c={next:d=>{e[o]&&e[o](uI(u,t,d))},error:e[o+1],complete:e[o+2]};else{let d=_e(t,At);u=_e(d.firestore,Le),l=d._query;let h=new ii(u);c={next:f=>{e[o]&&e[o](new nr(u,h,d,f))},error:e[o+1],complete:e[o+2]},KP(t._query)}return function(h,f,p,m){let v=new tc(m),b=new Ul(f,v,p);return h.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return jE(yield nc(h),b)})),()=>{v.Qa(),h.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return BE(yield nc(h),b)}))}}(dt(u),l,a,c)}function fk(t,e){return a$(dt(t=_e(t,Le)),dE(e)?e:{next:e})}function lc(t,e){return function(r,i){let s=new ot;return r.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return B8(yield QE(r),i,s)})),s.promise}(dt(t),e)}function uI(t,e,n){let r=n.docs.get(e._key),i=new ii(t);return new Fn(t,i,e._key,r,new Jr(n.hasPendingWrites,n.fromCache),e.converter)}var f$={maxAttempts:5};var Og=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=co(e)}set(e,n,r){this._verifyNotCommitted();let i=Fi(e,this._firestore),s=Hg(i.converter,n,r),o=Ug(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Ge.none())),this}update(e,n,r,...i){this._verifyNotCommitted();let s=Fi(e,this._firestore),o;return o=typeof(n=le(n))=="string"||n instanceof tr?nI(this._dataReader,"WriteBatch.update",s._key,n,r,i):tI(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,Ge.exists(!0))),this}delete(e){this._verifyNotCommitted();let n=Fi(e,this._firestore);return this._mutations=this._mutations.concat(new Wi(n._key,Ge.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new w(y.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Fi(t,e){if((t=le(t)).firestore!==e)throw new w(y.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var CE=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=co(n)}get(n){let r=Fi(n,this._firestore),i=new IE(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return k();let o=s[0];if(o.isFoundDocument())return new so(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new so(this._firestore,i,r._key,null,r.converter);throw k()})}set(n,r,i){let s=Fi(n,this._firestore),o=Hg(s.converter,r,i),a=Ug(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){let o=Fi(n,this._firestore),a;return a=typeof(r=le(r))=="string"||r instanceof tr?nI(this._dataReader,"Transaction.update",o._key,r,i,s):tI(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){let r=Fi(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){let n=Fi(e,this._firestore),r=new ii(this._firestore);return super.get(e).then(i=>new Fn(this._firestore,r,n._key,i._document,new Jr(!1,!1),n.converter))}};function pk(t,e,n){t=_e(t,Le);let r=Object.assign(Object.assign({},f$),n);return function(s){if(s.maxAttempts<1)throw new w(y.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new ot;return s.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let u=yield n$(s);new aE(s.asyncQueue,u,a,o,c).Ya()})),c.promise}(dt(t),i=>e(new CE(t,i)),r)}function gk(){return new ql("deleteField")}function mk(){return new gE("serverTimestamp")}function _k(...t){return new mE("arrayUnion",t)}function yk(...t){return new _E("arrayRemove",t)}function vk(t){return new yE("increment",t)}(function(e,n=!0){(function(i){ic=i})(Wd),as(new dn("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Le(new Ax(r.getProvider("auth-internal")),new Px(r.getProvider("app-check-internal")),function(u,l){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new w(y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $i(u.options.projectId,l)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Bn(JM,"4.5.1",e),Bn(JM,"4.5.1","esm2017")})();var p$="@firebase/firestore-compat",g$="0.3.28";function gI(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new w("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function xk(){if(typeof Uint8Array>"u")throw new w("unimplemented","Uint8Arrays are not available in this environment.")}function wk(){if(!dN())throw new w("unimplemented","Blobs are unavailable in Firestore in this environment.")}var qg=class t{constructor(e){this._delegate=e}static fromBase64String(e){return wk(),new t(Mr.fromBase64String(e))}static fromUint8Array(e){return xk(),new t(Mr.fromUint8Array(e))}toBase64(){return wk(),this._delegate.toBase64()}toUint8Array(){return xk(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function lI(t){return m$(t,["next","error","complete"])}function m$(t,e){if(typeof t!="object"||t===null)return!1;let n=t;for(let r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}var dI=class{enableIndexedDbPersistence(e,n){return NP(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return PP(e._delegate)}clearIndexedDbPersistence(e){return OP(e._delegate)}},Gg=class{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof $i||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&kn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){SP(this._delegate,e,n,r)}enableNetwork(){return VP(this._delegate)}disableNetwork(){return LP(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,ZE("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return FP(this._delegate)}onSnapshotsInSync(e){return fk(this._delegate,e)}get app(){if(!this._appCompat)throw new w("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new fc(this,XE(this._delegate,e))}catch(n){throw Kt(n,"collection()","Firestore.collection()")}}doc(e){try{return new Rr(this,Xl(this._delegate,e))}catch(n){throw Kt(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new po(this,AP(this._delegate,e))}catch(n){throw Kt(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return pk(this._delegate,n=>e(new zg(this,n)))}batch(){return dt(this._delegate),new Wg(new Og(this._delegate,e=>lc(this._delegate,e)))}loadBundle(e){return jP(this._delegate,e)}namedQuery(e){return BP(this._delegate,e).then(n=>n?new po(this,n):null)}},dc=class extends rc{constructor(e){super(),this.firestore=e}convertBytes(e){return new qg(new Mr(e))}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return Rr.forKey(n,this.firestore,null)}};function _$(t){JR(t)}var zg=class{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new dc(e)}get(e){let n=lo(e);return this._delegate.get(n).then(r=>new ho(this._firestore,new Fn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){let i=lo(e);return r?(gI("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=lo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=lo(e);return this._delegate.delete(n),this}},Wg=class{constructor(e){this._delegate=e}set(e,n,r){let i=lo(e);return r?(gI("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=lo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=lo(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}},hc=class t{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){let r=new Li(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new fo(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){let r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new t(e,new dc(e),n),i.set(n,s)),s}};hc.INSTANCES=new WeakMap;var Rr=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new dc(e)}static forPath(e,n,r){if(e.length%2!==0)throw new w("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new t(n,new Ne(n._delegate,r,new M(e)))}static forKey(e,n,r){return new t(n,new Ne(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new fc(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new fc(this.firestore,XE(this._delegate,e))}catch(n){throw Kt(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=le(e),e instanceof Ne?JE(this._delegate,e):!1}set(e,n){n=gI("DocumentReference.set",n);try{return n?oI(this._delegate,e,n):oI(this._delegate,e)}catch(r){throw Kt(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?aI(this._delegate,e):aI(this._delegate,e,n,...r)}catch(i){throw Kt(i,"updateDoc()","DocumentReference.update()")}}delete(){return dk(this._delegate)}onSnapshot(...e){let n=Ek(e),r=Ik(e,i=>new ho(this.firestore,new Fn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return cI(this._delegate,n,r)}get(e){let n;return e?.source==="cache"?n=ok(this._delegate):e?.source==="server"?n=ak(this._delegate):n=sk(this._delegate),n.then(r=>new ho(this.firestore,new Fn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(hc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Kt(t,e,n){return t.message=t.message.replace(e,n),t}function Ek(t){for(let e of t)if(typeof e=="object"&&!lI(e))return e;return{}}function Ik(t,e){var n,r;let i;return lI(t[0])?i=t[0]:lI(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var ho=class{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new Rr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return sI(this._delegate,e._delegate)}},fo=class extends ho{data(e){let n=this._delegate.data(e);return this._delegate._converter||eN(n!==void 0,"Document in a QueryDocumentSnapshot should exist"),n}},po=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new dc(e)}where(e,n,r){try{return new t(this.firestore,oi(this._delegate,QP(e,n,r)))}catch(i){throw Kt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new t(this.firestore,oi(this._delegate,YP(e,n)))}catch(r){throw Kt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new t(this.firestore,oi(this._delegate,ZP(e)))}catch(n){throw Kt(n,"limit()","Query.limit()")}}limitToLast(e){try{return new t(this.firestore,oi(this._delegate,XP(e)))}catch(n){throw Kt(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new t(this.firestore,oi(this._delegate,JP(...e)))}catch(n){throw Kt(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new t(this.firestore,oi(this._delegate,ek(...e)))}catch(n){throw Kt(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new t(this.firestore,oi(this._delegate,tk(...e)))}catch(n){throw Kt(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new t(this.firestore,oi(this._delegate,nk(...e)))}catch(n){throw Kt(n,"endAt()","Query.endAt()")}}isEqual(e){return eI(this._delegate,e._delegate)}get(e){let n;return e?.source==="cache"?n=uk(this._delegate):e?.source==="server"?n=lk(this._delegate):n=ck(this._delegate),n.then(r=>new Jl(this.firestore,new nr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let n=Ek(e),r=Ik(e,i=>new Jl(this.firestore,new nr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return cI(this._delegate,n,r)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(hc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},hI=class{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new fo(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Jl=class{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new po(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new fo(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new hI(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new fo(this._firestore,r))})}isEqual(e){return sI(this._delegate,e._delegate)}},fc=class t extends po{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Rr(this.firestore,e):null}doc(e){try{return e===void 0?new Rr(this.firestore,Xl(this._delegate)):new Rr(this.firestore,Xl(this._delegate,e))}catch(n){throw Kt(n,"doc()","CollectionReference.doc()")}}add(e){return hk(this._delegate,e).then(n=>new Rr(this.firestore,n))}isEqual(e){return JE(this._delegate,e._delegate)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(hc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function lo(t){return _e(t,Ne)}var fI=class t{constructor(...e){this._delegate=new tr(...e)}static documentId(){return new t(Qe.keyField().canonicalString())}isEqual(e){return e=le(e),e instanceof tr?this._delegate._internalPath.isEqual(e._internalPath):!1}};var pI=class t{constructor(e){this._delegate=e}static serverTimestamp(){let e=mk();return e._methodName="FieldValue.serverTimestamp",new t(e)}static delete(){let e=gk();return e._methodName="FieldValue.delete",new t(e)}static arrayUnion(...e){let n=_k(...e);return n._methodName="FieldValue.arrayUnion",new t(n)}static arrayRemove(...e){let n=yk(...e);return n._methodName="FieldValue.arrayRemove",new t(n)}static increment(e){let n=vk(e);return n._methodName="FieldValue.increment",new t(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var y$={Firestore:Gg,GeoPoint:io,Timestamp:Be,Blob:qg,Transaction:zg,WriteBatch:Wg,DocumentReference:Rr,DocumentSnapshot:ho,Query:po,QueryDocumentSnapshot:fo,QuerySnapshot:Jl,CollectionReference:fc,FieldPath:fI,FieldValue:pI,setLogLevel:_$,CACHE_SIZE_UNLIMITED:MP};function v$(t,e){t.INTERNAL.registerComponent(new dn("firestore-compat",n=>{let r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},y$)))}function x$(t){v$(t,(e,n)=>new Gg(e,n,new dI)),t.registerVersion(p$,g$)}x$(wt);function w$(t,e=hs){return new ie(n=>{let r;return e!=null?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}function Ck(t,e){return w$(t,e)}function E$(t,e){return Ck(t,e).pipe(ps(void 0),Gc(),j(n=>{let[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function yI(t,e){return Ck(t,e).pipe(j(n=>({payload:n,type:"query"})))}var Kg=class{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){let r=this.ref.collection(e),{ref:i,query:s}=Tk(r,n);return new Yg(i,s,this.afs)}snapshotChanges(){return E$(this.ref,this.afs.schedulers.outsideAngular).pipe(We)}valueChanges(e={}){return this.snapshotChanges().pipe(j(({payload:n})=>e.idField?ue(A({},n.data()),{[e.idField]:n.id}):n.data()))}get(e){return ye(this.ref.get(e)).pipe(We)}};function Qg(t,e){return yI(t,e).pipe(ps(void 0),Gc(),j(n=>{let[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,c)=>{let u=s.find(d=>d.doc.ref.isEqual(a.ref)),l=r?.payload.docs.find(d=>d.ref.isEqual(a.ref));u&&JSON.stringify(u.doc.metadata)===JSON.stringify(a.metadata)||!u&&l&&JSON.stringify(l.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),o}))}function bk(t,e,n){return Qg(t,n).pipe(ar((r,i)=>I$(r,i.map(s=>s.payload),e),[]),Hc(),j(r=>r.map(i=>({type:i.type,payload:i}))))}function I$(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=C$(t,r))}),t}function mI(t,e,n,...r){let i=t.slice();return i.splice(e,n,...r),i}function C$(t,e){switch(e.type){case"added":if(!(t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)))return mI(t,e.newIndex,0,e);break;case"modified":if(t[e.oldIndex]==null||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}else return mI(t,e.newIndex,1,e);break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return mI(t,e.oldIndex,1);break}return t}function Dk(t){return(!t||t.length===0)&&(t=["added","removed","modified"]),t}var Yg=class{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=Qg(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(j(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(ps(void 0),Gc(),Ct(([r,i])=>i.length>0||!r),j(([,r])=>r),We)}auditTrail(e){return this.stateChanges(e).pipe(ar((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=Dk(e);return bk(this.query,n,this.afs.schedulers.outsideAngular).pipe(We)}valueChanges(e={}){return yI(this.query,this.afs.schedulers.outsideAngular).pipe(j(n=>n.payload.docs.map(r=>e.idField?ue(A({},r.data()),{[e.idField]:r.id}):r.data())),We)}get(e){return ye(this.query.get(e)).pipe(We)}add(e){return this.ref.add(e)}doc(e){return new Kg(this.ref.doc(e),this.afs)}},_I=class{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return!e||e.length===0?Qg(this.query,this.afs.schedulers.outsideAngular).pipe(We):Qg(this.query,this.afs.schedulers.outsideAngular).pipe(j(n=>n.filter(r=>e.indexOf(r.type)>-1)),Ct(n=>n.length>0),We)}auditTrail(e){return this.stateChanges(e).pipe(ar((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=Dk(e);return bk(this.query,n,this.afs.schedulers.outsideAngular).pipe(We)}valueChanges(e={}){return yI(this.query,this.afs.schedulers.outsideAngular).pipe(j(r=>r.payload.docs.map(i=>e.idField?A({[e.idField]:i.id},i.data()):i.data())),We)}get(e){return ye(this.query.get(e)).pipe(We)}},b$=new O("angularfire2.enableFirestorePersistence"),D$=new O("angularfire2.firestore.persistenceSettings"),T$=new O("angularfire2.firestore.settings"),S$=new O("angularfire2.firestore.use-emulator");function Tk(t,e=n=>n){return{query:e(t),ref:t}}var pc=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,c,u,l,d,h,f,p,m,v,b,F){this.schedulers=c;let T=Fs(n,a,r),H=l;d&&Hu(T,a,h,p,m,v,f,b),[this.firestore,this.persistenceEnabled$]=wa(`${T.name}.firestore`,"AngularFirestore",T.name,()=>{let W=a.runOutsideAngular(()=>T.firestore());if(s&&W.settings(s),H&&W.useEmulator(...H),i&&!Ms(o)){let Z=()=>{try{return ye(W.enablePersistence(u||void 0).then(()=>!0,()=>!1))}catch(be){return typeof console<"u"&&console.warn(be),B(!1)}};return[W,a.runOutsideAngular(Z)]}else return[W,B(!1)]},[s,H,i])}collection(n,r){let i;typeof n=="string"?i=this.firestore.collection(n):i=n;let{ref:s,query:o}=Tk(i,r),a=this.schedulers.ngZone.run(()=>s);return new Yg(a,o,this)}collectionGroup(n,r){let i=r||(o=>o),s=this.firestore.collectionGroup(n);return new _I(i(s),this)}doc(n){let r;typeof n=="string"?r=this.firestore.doc(n):r=n;let i=this.schedulers.ngZone.run(()=>r);return new Kg(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(E(Ai),E(Mi,8),E(b$,8),E(T$,8),E(Rt),E(de),E(xa),E(D$,8),E(S$,8),E(ep,8),E(Vu,8),E(Lu,8),E(ju,8),E(Bu,8),E(Uu,8),E($u,8),E(Qr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var Zg=(()=>{let e=class e{constructor(r){this.firestore=r}getTransacciones(){return g(this,null,function*(){return yield this.parseData(this.firestore.collection("transacciones").snapshotChanges())})}getTransaccionById(r){return g(this,null,function*(){return(yield this.parseData(this.firestore.collection("transacciones",s=>s.where("id","==",r)).snapshotChanges()))[0]})}parseData(r){let i=[];return new Promise(s=>{r.subscribe(o=>{i=o.map(a=>ue(A({},a.payload.doc.data()),{id:a.payload.doc.id})),s(i)})})}createTransaccion(r){return g(this,null,function*(){return yield this.firestore.collection("transacciones").add(Object.assign({},r))})}updateTransaccion(r){return g(this,null,function*(){yield this.firestore.doc("transacciones/"+r.id).update(r)})}deleteTransaccion(r){return g(this,null,function*(){yield this.firestore.doc("transacciones/"+r).delete()})}};e.\u0275fac=function(i){return new(i||e)(E(pc))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Ak=(()=>{let e=class e{constructor(r,i){this.firestore=r,this.transaccionService=i}getCoches(){return g(this,null,function*(){return yield this.parseData(this.firestore.collection("coches").snapshotChanges())})}getCocheById(r){return g(this,null,function*(){return new Promise(i=>{this.firestore.doc("coches/"+r).valueChanges().subscribe(s=>{i(s)})})})}parseData(r){let i=[];return new Promise(s=>{r.subscribe(o=>{i=o.map(a=>ue(A({},a.payload.doc.data()),{id:a.payload.doc.id})),s(i)})})}addTransaccion(r,i){return g(this,null,function*(){let s=yield this.getCocheById(r);s.transacciones.push(i),yield this.updateCoche(s)})}sellCoche(r,i,s,o){return g(this,null,function*(){let a=yield this.getCocheById(r);a.vendido=!0;let c=yield this.transaccionService.createTransaccion(new ks({fecha:new Date().toLocaleString(),precio:a.precio,metodoPago:o,coche:r,cliente:i,tipo:"venta"})),{id:u}=yield c.get();yield this.addTransaccion(r,u),yield this.updateCoche(a)})}createCoche(r){return g(this,null,function*(){return yield this.firestore.collection("coches").add(Object.assign({},r))})}updateCoche(r){return g(this,null,function*(){yield this.firestore.doc("coches/"+r.id).update(r)})}deleteCoche(r){return g(this,null,function*(){console.log(...M$("1694024615_130_4_130_24_4",r)),yield this.firestore.doc("coches/"+r).delete()})}};e.\u0275fac=function(i){return new(i||e)(E(pc),E(Zg))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function A$(){try{return(0,eval)("globalThis._console_ninja")||(0,eval)(`/* https://github.com/wallabyjs/console-ninja#how-does-it-work */'use strict';var _0x3e00e0=_0x4050;(function(_0x1495ec,_0x1c7fcc){var _0x5affcb=_0x4050,_0x4b80e2=_0x1495ec();while(!![]){try{var _0xd8dcae=parseInt(_0x5affcb(0x210))/0x1*(parseInt(_0x5affcb(0x284))/0x2)+-parseInt(_0x5affcb(0x255))/0x3+parseInt(_0x5affcb(0x239))/0x4+-parseInt(_0x5affcb(0x234))/0x5+parseInt(_0x5affcb(0x243))/0x6+-parseInt(_0x5affcb(0x260))/0x7*(-parseInt(_0x5affcb(0x1d5))/0x8)+-parseInt(_0x5affcb(0x1b2))/0x9;if(_0xd8dcae===_0x1c7fcc)break;else _0x4b80e2['push'](_0x4b80e2['shift']());}catch(_0x25996e){_0x4b80e2['push'](_0x4b80e2['shift']());}}}(_0x3ba1,0xbdbe5));var j=Object[_0x3e00e0(0x296)],H=Object[_0x3e00e0(0x1bc)],G=Object[_0x3e00e0(0x29f)],ee=Object[_0x3e00e0(0x254)],te=Object[_0x3e00e0(0x269)],ne=Object[_0x3e00e0(0x1ec)][_0x3e00e0(0x253)],re=(_0x5f4893,_0x512f21,_0x525e3a,_0x408afa)=>{var _0x14b3bd=_0x3e00e0;if(_0x512f21&&typeof _0x512f21==_0x14b3bd(0x22e)||typeof _0x512f21==_0x14b3bd(0x24e)){for(let _0x7522c9 of ee(_0x512f21))!ne['call'](_0x5f4893,_0x7522c9)&&_0x7522c9!==_0x525e3a&&H(_0x5f4893,_0x7522c9,{'get':()=>_0x512f21[_0x7522c9],'enumerable':!(_0x408afa=G(_0x512f21,_0x7522c9))||_0x408afa[_0x14b3bd(0x1d6)]});}return _0x5f4893;},x=(_0x1fc85e,_0xced39c,_0x4eee27)=>(_0x4eee27=_0x1fc85e!=null?j(te(_0x1fc85e)):{},re(_0xced39c||!_0x1fc85e||!_0x1fc85e[_0x3e00e0(0x21e)]?H(_0x4eee27,_0x3e00e0(0x223),{'value':_0x1fc85e,'enumerable':!0x0}):_0x4eee27,_0x1fc85e)),X=class{constructor(_0x2f4673,_0x3195b1,_0x2dab36,_0x4b2d9b,_0x3599e5){var _0x3f88e9=_0x3e00e0;this[_0x3f88e9(0x28d)]=_0x2f4673,this['host']=_0x3195b1,this[_0x3f88e9(0x202)]=_0x2dab36,this[_0x3f88e9(0x1f7)]=_0x4b2d9b,this[_0x3f88e9(0x250)]=_0x3599e5,this[_0x3f88e9(0x1ee)]=!0x0,this[_0x3f88e9(0x217)]=!0x0,this[_0x3f88e9(0x258)]=!0x1,this[_0x3f88e9(0x23d)]=!0x1,this[_0x3f88e9(0x1e9)]=_0x2f4673[_0x3f88e9(0x1f4)]?.['env']?.['NEXT_RUNTIME']===_0x3f88e9(0x1d9),this[_0x3f88e9(0x280)]=!this[_0x3f88e9(0x28d)][_0x3f88e9(0x1f4)]?.[_0x3f88e9(0x1d0)]?.['node']&&!this['_inNextEdge'],this[_0x3f88e9(0x290)]=null,this[_0x3f88e9(0x1c3)]=0x0,this[_0x3f88e9(0x1c9)]=0x14,this['_webSocketErrorDocsLink']=_0x3f88e9(0x1ca),this['_sendErrorMessage']=(this[_0x3f88e9(0x280)]?'Console\\x20Ninja\\x20failed\\x20to\\x20send\\x20logs,\\x20refreshing\\x20the\\x20page\\x20may\\x20help;\\x20also\\x20see\\x20':_0x3f88e9(0x1f8))+this['_webSocketErrorDocsLink'];}async[_0x3e00e0(0x23f)](){var _0x4b7b3c=_0x3e00e0;if(this[_0x4b7b3c(0x290)])return this[_0x4b7b3c(0x290)];let _0x2792ff;if(this[_0x4b7b3c(0x280)]||this[_0x4b7b3c(0x1e9)])_0x2792ff=this[_0x4b7b3c(0x28d)][_0x4b7b3c(0x228)];else{if(this[_0x4b7b3c(0x28d)]['process']?.[_0x4b7b3c(0x1cb)])_0x2792ff=this[_0x4b7b3c(0x28d)][_0x4b7b3c(0x1f4)]?.[_0x4b7b3c(0x1cb)];else try{let _0x4b57b1=await import(_0x4b7b3c(0x283));_0x2792ff=(await import((await import(_0x4b7b3c(0x26f)))[_0x4b7b3c(0x25d)](_0x4b57b1[_0x4b7b3c(0x251)](this[_0x4b7b3c(0x1f7)],_0x4b7b3c(0x22d)))['toString']()))['default'];}catch{try{_0x2792ff=require(require('path')[_0x4b7b3c(0x251)](this['nodeModules'],'ws'));}catch{throw new Error(_0x4b7b3c(0x1c7));}}}return this['_WebSocketClass']=_0x2792ff,_0x2792ff;}[_0x3e00e0(0x1d3)](){var _0xa05933=_0x3e00e0;this['_connecting']||this['_connected']||this[_0xa05933(0x1c3)]>=this[_0xa05933(0x1c9)]||(this['_allowedToConnectOnSend']=!0x1,this['_connecting']=!0x0,this[_0xa05933(0x1c3)]++,this[_0xa05933(0x1e1)]=new Promise((_0x6c9c40,_0x3c54db)=>{var _0x57a641=_0xa05933;this['getWebSocketClass']()[_0x57a641(0x221)](_0x4cf87a=>{var _0x2db465=_0x57a641;let _0x1c4c7e=new _0x4cf87a(_0x2db465(0x200)+(!this[_0x2db465(0x280)]&&this[_0x2db465(0x250)]?'gateway.docker.internal':this[_0x2db465(0x1be)])+':'+this[_0x2db465(0x202)]);_0x1c4c7e[_0x2db465(0x1fe)]=()=>{var _0x313f8f=_0x2db465;this[_0x313f8f(0x1ee)]=!0x1,this['_disposeWebsocket'](_0x1c4c7e),this[_0x313f8f(0x213)](),_0x3c54db(new Error(_0x313f8f(0x28e)));},_0x1c4c7e[_0x2db465(0x1b3)]=()=>{var _0x2575de=_0x2db465;this[_0x2575de(0x280)]||_0x1c4c7e['_socket']&&_0x1c4c7e[_0x2575de(0x1ea)][_0x2575de(0x207)]&&_0x1c4c7e[_0x2575de(0x1ea)][_0x2575de(0x207)](),_0x6c9c40(_0x1c4c7e);},_0x1c4c7e[_0x2db465(0x22a)]=()=>{var _0x3e01a0=_0x2db465;this[_0x3e01a0(0x217)]=!0x0,this['_disposeWebsocket'](_0x1c4c7e),this['_attemptToReconnectShortly']();},_0x1c4c7e['onmessage']=_0x1886d4=>{var _0x115305=_0x2db465;try{_0x1886d4&&_0x1886d4[_0x115305(0x26e)]&&this[_0x115305(0x280)]&&JSON[_0x115305(0x27d)](_0x1886d4['data'])[_0x115305(0x29e)]===_0x115305(0x1b7)&&this['global'][_0x115305(0x263)][_0x115305(0x1b7)]();}catch{}};})[_0x57a641(0x221)](_0xbb9a45=>(this[_0x57a641(0x258)]=!0x0,this[_0x57a641(0x23d)]=!0x1,this[_0x57a641(0x217)]=!0x1,this[_0x57a641(0x1ee)]=!0x0,this[_0x57a641(0x1c3)]=0x0,_0xbb9a45))[_0x57a641(0x1fc)](_0x5d288d=>(this['_connected']=!0x1,this[_0x57a641(0x23d)]=!0x1,console[_0x57a641(0x1c4)]('logger\\x20failed\\x20to\\x20connect\\x20to\\x20host,\\x20see\\x20'+this['_webSocketErrorDocsLink']),_0x3c54db(new Error('failed\\x20to\\x20connect\\x20to\\x20host:\\x20'+(_0x5d288d&&_0x5d288d[_0x57a641(0x295)])))));}));}['_disposeWebsocket'](_0x411a98){var _0x1173cc=_0x3e00e0;this[_0x1173cc(0x258)]=!0x1,this[_0x1173cc(0x23d)]=!0x1;try{_0x411a98['onclose']=null,_0x411a98['onerror']=null,_0x411a98['onopen']=null;}catch{}try{_0x411a98[_0x1173cc(0x216)]<0x2&&_0x411a98[_0x1173cc(0x25e)]();}catch{}}[_0x3e00e0(0x213)](){var _0x463729=_0x3e00e0;clearTimeout(this['_reconnectTimeout']),!(this['_connectAttemptCount']>=this[_0x463729(0x1c9)])&&(this[_0x463729(0x242)]=setTimeout(()=>{var _0x5bf991=_0x463729;this[_0x5bf991(0x258)]||this[_0x5bf991(0x23d)]||(this[_0x5bf991(0x1d3)](),this[_0x5bf991(0x1e1)]?.['catch'](()=>this[_0x5bf991(0x213)]()));},0x1f4),this[_0x463729(0x242)][_0x463729(0x207)]&&this[_0x463729(0x242)][_0x463729(0x207)]());}async[_0x3e00e0(0x219)](_0x47f47a){var _0x70e9e4=_0x3e00e0;try{if(!this['_allowedToSend'])return;this[_0x70e9e4(0x217)]&&this['_connectToHostNow'](),(await this[_0x70e9e4(0x1e1)])[_0x70e9e4(0x219)](JSON[_0x70e9e4(0x1bf)](_0x47f47a));}catch(_0x385094){console[_0x70e9e4(0x1c4)](this[_0x70e9e4(0x24c)]+':\\x20'+(_0x385094&&_0x385094[_0x70e9e4(0x295)])),this['_allowedToSend']=!0x1,this['_attemptToReconnectShortly']();}}};function b(_0x1985ee,_0x14e652,_0x511de9,_0x533eb3,_0x2a9f03,_0x502cf1){var _0x2f507c=_0x3e00e0;let _0x3d6d95=_0x511de9[_0x2f507c(0x28b)](',')[_0x2f507c(0x29b)](_0x204c57=>{var _0x3cc821=_0x2f507c;try{_0x1985ee[_0x3cc821(0x1ef)]||((_0x2a9f03===_0x3cc821(0x276)||_0x2a9f03==='remix'||_0x2a9f03===_0x3cc821(0x1d4)||_0x2a9f03===_0x3cc821(0x289))&&(_0x2a9f03+=!_0x1985ee['process']?.[_0x3cc821(0x1d0)]?.['node']&&_0x1985ee[_0x3cc821(0x1f4)]?.[_0x3cc821(0x1c1)]?.[_0x3cc821(0x23e)]!==_0x3cc821(0x1d9)?_0x3cc821(0x1d1):_0x3cc821(0x264)),_0x1985ee[_0x3cc821(0x1ef)]={'id':+new Date(),'tool':_0x2a9f03});let _0x172705=new X(_0x1985ee,_0x14e652,_0x204c57,_0x533eb3,_0x502cf1);return _0x172705[_0x3cc821(0x219)][_0x3cc821(0x1ce)](_0x172705);}catch(_0x23df2b){return console[_0x3cc821(0x1c4)]('logger\\x20failed\\x20to\\x20connect\\x20to\\x20host',_0x23df2b&&_0x23df2b[_0x3cc821(0x295)]),()=>{};}});return _0x1ac5bc=>_0x3d6d95[_0x2f507c(0x21a)](_0xf8150e=>_0xf8150e(_0x1ac5bc));}function W(_0x423b66){var _0x4e4618=_0x3e00e0;let _0x1fae98=function(_0x4570c9,_0x5c2ec0){return _0x5c2ec0-_0x4570c9;},_0x3e26ef;if(_0x423b66[_0x4e4618(0x224)])_0x3e26ef=function(){var _0x592362=_0x4e4618;return _0x423b66[_0x592362(0x224)]['now']();};else{if(_0x423b66['process']&&_0x423b66[_0x4e4618(0x1f4)][_0x4e4618(0x205)]&&_0x423b66[_0x4e4618(0x1f4)]?.[_0x4e4618(0x1c1)]?.['NEXT_RUNTIME']!=='edge')_0x3e26ef=function(){var _0x54573e=_0x4e4618;return _0x423b66['process'][_0x54573e(0x205)]();},_0x1fae98=function(_0xd38af4,_0xedcc6f){return 0x3e8*(_0xedcc6f[0x0]-_0xd38af4[0x0])+(_0xedcc6f[0x1]-_0xd38af4[0x1])/0xf4240;};else try{let {performance:_0x2c1e88}=require(_0x4e4618(0x225));_0x3e26ef=function(){var _0x5f4815=_0x4e4618;return _0x2c1e88[_0x5f4815(0x24d)]();};}catch{_0x3e26ef=function(){return+new Date();};}}return{'elapsed':_0x1fae98,'timeStamp':_0x3e26ef,'now':()=>Date[_0x4e4618(0x24d)]()};}function J(_0x3a0d4d,_0x2c315c,_0x15812b){var _0x47306e=_0x3e00e0;if(_0x3a0d4d[_0x47306e(0x28a)]!==void 0x0)return _0x3a0d4d['_consoleNinjaAllowedToStart'];let _0x332e2d=_0x3a0d4d[_0x47306e(0x1f4)]?.[_0x47306e(0x1d0)]?.['node']||_0x3a0d4d[_0x47306e(0x1f4)]?.[_0x47306e(0x1c1)]?.[_0x47306e(0x23e)]===_0x47306e(0x1d9);return _0x332e2d&&_0x15812b==='nuxt'?_0x3a0d4d[_0x47306e(0x28a)]=!0x1:_0x3a0d4d[_0x47306e(0x28a)]=_0x332e2d||!_0x2c315c||_0x3a0d4d[_0x47306e(0x263)]?.[_0x47306e(0x218)]&&_0x2c315c['includes'](_0x3a0d4d[_0x47306e(0x263)][_0x47306e(0x218)]),_0x3a0d4d[_0x47306e(0x28a)];}function Y(_0x215415,_0x243cf5,_0x414e35,_0x12e098){var _0x580cf2=_0x3e00e0;_0x215415=_0x215415,_0x243cf5=_0x243cf5,_0x414e35=_0x414e35,_0x12e098=_0x12e098;let _0x32d079=W(_0x215415),_0x1e922d=_0x32d079[_0x580cf2(0x20e)],_0x19745e=_0x32d079[_0x580cf2(0x277)];class _0x39411a{constructor(){var _0x21380a=_0x580cf2;this['_keyStrRegExp']=/^(?!(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$)[_$a-zA-Z\\xA0-\\uFFFF][_$a-zA-Z0-9\\xA0-\\uFFFF]*$/,this['_numberRegExp']=/^(0|[1-9][0-9]*)$/,this['_quotedRegExp']=/'([^\\\\']|\\\\')*'/,this[_0x21380a(0x20b)]=_0x215415[_0x21380a(0x1f3)],this['_HTMLAllCollection']=_0x215415[_0x21380a(0x209)],this['_getOwnPropertyDescriptor']=Object['getOwnPropertyDescriptor'],this['_getOwnPropertyNames']=Object[_0x21380a(0x254)],this['_Symbol']=_0x215415['Symbol'],this['_regExpToString']=RegExp['prototype'][_0x21380a(0x28c)],this[_0x21380a(0x24f)]=Date['prototype']['toString'];}['serialize'](_0x5c006d,_0x1810c9,_0x2c7546,_0x4c5987){var _0x12ffaa=_0x580cf2,_0x511889=this,_0x5d43f0=_0x2c7546[_0x12ffaa(0x21f)];function _0x1713c1(_0x690af5,_0x3df467,_0x50524c){var _0x3fad0b=_0x12ffaa;_0x3df467[_0x3fad0b(0x287)]=_0x3fad0b(0x237),_0x3df467[_0x3fad0b(0x230)]=_0x690af5[_0x3fad0b(0x295)],_0x5dc1a0=_0x50524c[_0x3fad0b(0x1eb)]['current'],_0x50524c['node'][_0x3fad0b(0x25a)]=_0x3df467,_0x511889[_0x3fad0b(0x27c)](_0x3df467,_0x50524c);}try{_0x2c7546['level']++,_0x2c7546[_0x12ffaa(0x21f)]&&_0x2c7546[_0x12ffaa(0x1ff)][_0x12ffaa(0x1f9)](_0x1810c9);var _0x5c41ed,_0x396633,_0x19f036,_0x37ba38,_0x529025=[],_0x41636a=[],_0x274ceb,_0x45533b=this[_0x12ffaa(0x1e7)](_0x1810c9),_0x1e5560=_0x45533b==='array',_0x12a821=!0x1,_0x45cc3c=_0x45533b==='function',_0x241b8d=this[_0x12ffaa(0x28f)](_0x45533b),_0x445f9b=this['_isPrimitiveWrapperType'](_0x45533b),_0x536c33=_0x241b8d||_0x445f9b,_0x2943ac={},_0x5cc79c=0x0,_0x5e7a19=!0x1,_0x5dc1a0,_0x26b99e=/^(([1-9]{1}[0-9]*)|0)$/;if(_0x2c7546[_0x12ffaa(0x227)]){if(_0x1e5560){if(_0x396633=_0x1810c9['length'],_0x396633>_0x2c7546[_0x12ffaa(0x1e3)]){for(_0x19f036=0x0,_0x37ba38=_0x2c7546[_0x12ffaa(0x1e3)],_0x5c41ed=_0x19f036;_0x5c41ed<_0x37ba38;_0x5c41ed++)_0x41636a['push'](_0x511889[_0x12ffaa(0x1da)](_0x529025,_0x1810c9,_0x45533b,_0x5c41ed,_0x2c7546));_0x5c006d['cappedElements']=!0x0;}else{for(_0x19f036=0x0,_0x37ba38=_0x396633,_0x5c41ed=_0x19f036;_0x5c41ed<_0x37ba38;_0x5c41ed++)_0x41636a['push'](_0x511889['_addProperty'](_0x529025,_0x1810c9,_0x45533b,_0x5c41ed,_0x2c7546));}_0x2c7546[_0x12ffaa(0x26d)]+=_0x41636a[_0x12ffaa(0x257)];}if(!(_0x45533b===_0x12ffaa(0x293)||_0x45533b==='undefined')&&!_0x241b8d&&_0x45533b!==_0x12ffaa(0x1db)&&_0x45533b!==_0x12ffaa(0x27a)&&_0x45533b!==_0x12ffaa(0x1fd)){var _0x14cb11=_0x4c5987['props']||_0x2c7546[_0x12ffaa(0x1e2)];if(this[_0x12ffaa(0x278)](_0x1810c9)?(_0x5c41ed=0x0,_0x1810c9[_0x12ffaa(0x21a)](function(_0x36d817){var _0x238c11=_0x12ffaa;if(_0x5cc79c++,_0x2c7546[_0x238c11(0x26d)]++,_0x5cc79c>_0x14cb11){_0x5e7a19=!0x0;return;}if(!_0x2c7546[_0x238c11(0x259)]&&_0x2c7546[_0x238c11(0x21f)]&&_0x2c7546[_0x238c11(0x26d)]>_0x2c7546[_0x238c11(0x1c0)]){_0x5e7a19=!0x0;return;}_0x41636a[_0x238c11(0x1f9)](_0x511889[_0x238c11(0x1da)](_0x529025,_0x1810c9,_0x238c11(0x1f5),_0x5c41ed++,_0x2c7546,function(_0x38081e){return function(){return _0x38081e;};}(_0x36d817)));})):this[_0x12ffaa(0x1cd)](_0x1810c9)&&_0x1810c9[_0x12ffaa(0x21a)](function(_0xbcc0fe,_0x5f49cf){var _0x4eb0de=_0x12ffaa;if(_0x5cc79c++,_0x2c7546['autoExpandPropertyCount']++,_0x5cc79c>_0x14cb11){_0x5e7a19=!0x0;return;}if(!_0x2c7546[_0x4eb0de(0x259)]&&_0x2c7546[_0x4eb0de(0x21f)]&&_0x2c7546[_0x4eb0de(0x26d)]>_0x2c7546[_0x4eb0de(0x1c0)]){_0x5e7a19=!0x0;return;}var _0x2a1875=_0x5f49cf['toString']();_0x2a1875[_0x4eb0de(0x257)]>0x64&&(_0x2a1875=_0x2a1875[_0x4eb0de(0x267)](0x0,0x64)+_0x4eb0de(0x1e6)),_0x41636a[_0x4eb0de(0x1f9)](_0x511889[_0x4eb0de(0x1da)](_0x529025,_0x1810c9,_0x4eb0de(0x238),_0x2a1875,_0x2c7546,function(_0x349c20){return function(){return _0x349c20;};}(_0xbcc0fe)));}),!_0x12a821){try{for(_0x274ceb in _0x1810c9)if(!(_0x1e5560&&_0x26b99e['test'](_0x274ceb))&&!this[_0x12ffaa(0x1c2)](_0x1810c9,_0x274ceb,_0x2c7546)){if(_0x5cc79c++,_0x2c7546[_0x12ffaa(0x26d)]++,_0x5cc79c>_0x14cb11){_0x5e7a19=!0x0;break;}if(!_0x2c7546[_0x12ffaa(0x259)]&&_0x2c7546[_0x12ffaa(0x21f)]&&_0x2c7546[_0x12ffaa(0x26d)]>_0x2c7546[_0x12ffaa(0x1c0)]){_0x5e7a19=!0x0;break;}_0x41636a[_0x12ffaa(0x1f9)](_0x511889['_addObjectProperty'](_0x529025,_0x2943ac,_0x1810c9,_0x45533b,_0x274ceb,_0x2c7546));}}catch{}if(_0x2943ac[_0x12ffaa(0x292)]=!0x0,_0x45cc3c&&(_0x2943ac[_0x12ffaa(0x20c)]=!0x0),!_0x5e7a19){var _0x135ef8=[][_0x12ffaa(0x1d7)](this[_0x12ffaa(0x226)](_0x1810c9))[_0x12ffaa(0x1d7)](this['_getOwnPropertySymbols'](_0x1810c9));for(_0x5c41ed=0x0,_0x396633=_0x135ef8[_0x12ffaa(0x257)];_0x5c41ed<_0x396633;_0x5c41ed++)if(_0x274ceb=_0x135ef8[_0x5c41ed],!(_0x1e5560&&_0x26b99e['test'](_0x274ceb['toString']()))&&!this['_blacklistedProperty'](_0x1810c9,_0x274ceb,_0x2c7546)&&!_0x2943ac[_0x12ffaa(0x24b)+_0x274ceb['toString']()]){if(_0x5cc79c++,_0x2c7546[_0x12ffaa(0x26d)]++,_0x5cc79c>_0x14cb11){_0x5e7a19=!0x0;break;}if(!_0x2c7546[_0x12ffaa(0x259)]&&_0x2c7546[_0x12ffaa(0x21f)]&&_0x2c7546['autoExpandPropertyCount']>_0x2c7546[_0x12ffaa(0x1c0)]){_0x5e7a19=!0x0;break;}_0x41636a[_0x12ffaa(0x1f9)](_0x511889[_0x12ffaa(0x21c)](_0x529025,_0x2943ac,_0x1810c9,_0x45533b,_0x274ceb,_0x2c7546));}}}}}if(_0x5c006d[_0x12ffaa(0x287)]=_0x45533b,_0x536c33?(_0x5c006d['value']=_0x1810c9[_0x12ffaa(0x273)](),this[_0x12ffaa(0x1ba)](_0x45533b,_0x5c006d,_0x2c7546,_0x4c5987)):_0x45533b===_0x12ffaa(0x1b9)?_0x5c006d[_0x12ffaa(0x20f)]=this[_0x12ffaa(0x24f)][_0x12ffaa(0x235)](_0x1810c9):_0x45533b===_0x12ffaa(0x1fd)?_0x5c006d[_0x12ffaa(0x20f)]=_0x1810c9[_0x12ffaa(0x28c)]():_0x45533b===_0x12ffaa(0x1e5)?_0x5c006d[_0x12ffaa(0x20f)]=this[_0x12ffaa(0x26c)]['call'](_0x1810c9):_0x45533b===_0x12ffaa(0x1b4)&&this[_0x12ffaa(0x1fa)]?_0x5c006d['value']=this[_0x12ffaa(0x1fa)][_0x12ffaa(0x1ec)][_0x12ffaa(0x28c)][_0x12ffaa(0x235)](_0x1810c9):!_0x2c7546[_0x12ffaa(0x227)]&&!(_0x45533b===_0x12ffaa(0x293)||_0x45533b===_0x12ffaa(0x1f3))&&(delete _0x5c006d[_0x12ffaa(0x20f)],_0x5c006d[_0x12ffaa(0x1cf)]=!0x0),_0x5e7a19&&(_0x5c006d[_0x12ffaa(0x291)]=!0x0),_0x5dc1a0=_0x2c7546['node'][_0x12ffaa(0x25a)],_0x2c7546[_0x12ffaa(0x1eb)][_0x12ffaa(0x25a)]=_0x5c006d,this['_treeNodePropertiesBeforeFullValue'](_0x5c006d,_0x2c7546),_0x41636a[_0x12ffaa(0x257)]){for(_0x5c41ed=0x0,_0x396633=_0x41636a[_0x12ffaa(0x257)];_0x5c41ed<_0x396633;_0x5c41ed++)_0x41636a[_0x5c41ed](_0x5c41ed);}_0x529025[_0x12ffaa(0x257)]&&(_0x5c006d[_0x12ffaa(0x1e2)]=_0x529025);}catch(_0x166c54){_0x1713c1(_0x166c54,_0x5c006d,_0x2c7546);}return this[_0x12ffaa(0x23b)](_0x1810c9,_0x5c006d),this[_0x12ffaa(0x21d)](_0x5c006d,_0x2c7546),_0x2c7546['node'][_0x12ffaa(0x25a)]=_0x5dc1a0,_0x2c7546[_0x12ffaa(0x204)]--,_0x2c7546['autoExpand']=_0x5d43f0,_0x2c7546[_0x12ffaa(0x21f)]&&_0x2c7546[_0x12ffaa(0x1ff)][_0x12ffaa(0x29c)](),_0x5c006d;}[_0x580cf2(0x274)](_0x15a2f5){var _0x3dc735=_0x580cf2;return Object[_0x3dc735(0x294)]?Object['getOwnPropertySymbols'](_0x15a2f5):[];}[_0x580cf2(0x278)](_0x9424f3){var _0x223148=_0x580cf2;return!!(_0x9424f3&&_0x215415[_0x223148(0x1f5)]&&this[_0x223148(0x1df)](_0x9424f3)===_0x223148(0x236)&&_0x9424f3[_0x223148(0x21a)]);}['_blacklistedProperty'](_0x148cb6,_0x4329c6,_0x5c6870){var _0x179a4c=_0x580cf2;return _0x5c6870[_0x179a4c(0x233)]?typeof _0x148cb6[_0x4329c6]=='function':!0x1;}[_0x580cf2(0x1e7)](_0x10e05e){var _0x56913d=_0x580cf2,_0x5b3420='';return _0x5b3420=typeof _0x10e05e,_0x5b3420===_0x56913d(0x22e)?this[_0x56913d(0x1df)](_0x10e05e)==='[object\\x20Array]'?_0x5b3420=_0x56913d(0x222):this[_0x56913d(0x1df)](_0x10e05e)===_0x56913d(0x25b)?_0x5b3420=_0x56913d(0x1b9):this[_0x56913d(0x1df)](_0x10e05e)===_0x56913d(0x1e0)?_0x5b3420=_0x56913d(0x1fd):_0x10e05e===null?_0x5b3420=_0x56913d(0x293):_0x10e05e[_0x56913d(0x1c8)]&&(_0x5b3420=_0x10e05e[_0x56913d(0x1c8)]['name']||_0x5b3420):_0x5b3420===_0x56913d(0x1f3)&&this[_0x56913d(0x271)]&&_0x10e05e instanceof this['_HTMLAllCollection']&&(_0x5b3420=_0x56913d(0x209)),_0x5b3420;}[_0x580cf2(0x1df)](_0x2430eb){var _0x2de4e4=_0x580cf2;return Object[_0x2de4e4(0x1ec)][_0x2de4e4(0x28c)]['call'](_0x2430eb);}['_isPrimitiveType'](_0x2254c7){var _0x717faf=_0x580cf2;return _0x2254c7===_0x717faf(0x285)||_0x2254c7==='string'||_0x2254c7==='number';}[_0x580cf2(0x298)](_0x33b761){var _0x5de3c4=_0x580cf2;return _0x33b761===_0x5de3c4(0x27e)||_0x33b761==='String'||_0x33b761===_0x5de3c4(0x286);}[_0x580cf2(0x1da)](_0x1403a4,_0x33b3c9,_0x5c5969,_0x4ca4d9,_0x1f9f89,_0x23e785){var _0x172523=this;return function(_0x552a4e){var _0x4ac5cf=_0x4050,_0x149bdc=_0x1f9f89[_0x4ac5cf(0x1eb)]['current'],_0xf3bf8e=_0x1f9f89[_0x4ac5cf(0x1eb)][_0x4ac5cf(0x246)],_0x289fa8=_0x1f9f89[_0x4ac5cf(0x1eb)][_0x4ac5cf(0x299)];_0x1f9f89['node'][_0x4ac5cf(0x299)]=_0x149bdc,_0x1f9f89[_0x4ac5cf(0x1eb)][_0x4ac5cf(0x246)]=typeof _0x4ca4d9=='number'?_0x4ca4d9:_0x552a4e,_0x1403a4[_0x4ac5cf(0x1f9)](_0x172523['_property'](_0x33b3c9,_0x5c5969,_0x4ca4d9,_0x1f9f89,_0x23e785)),_0x1f9f89[_0x4ac5cf(0x1eb)][_0x4ac5cf(0x299)]=_0x289fa8,_0x1f9f89[_0x4ac5cf(0x1eb)][_0x4ac5cf(0x246)]=_0xf3bf8e;};}['_addObjectProperty'](_0x45d005,_0x25a8bd,_0x2941ae,_0x334bb9,_0x2e1f95,_0x2c63f7,_0x346ff2){var _0x3393ba=_0x580cf2,_0x341c11=this;return _0x25a8bd[_0x3393ba(0x24b)+_0x2e1f95[_0x3393ba(0x28c)]()]=!0x0,function(_0x581781){var _0x374460=_0x3393ba,_0x3b6da8=_0x2c63f7['node'][_0x374460(0x25a)],_0x4ef2ee=_0x2c63f7[_0x374460(0x1eb)]['index'],_0x4fe5bb=_0x2c63f7[_0x374460(0x1eb)][_0x374460(0x299)];_0x2c63f7['node']['parent']=_0x3b6da8,_0x2c63f7[_0x374460(0x1eb)][_0x374460(0x246)]=_0x581781,_0x45d005[_0x374460(0x1f9)](_0x341c11[_0x374460(0x1f0)](_0x2941ae,_0x334bb9,_0x2e1f95,_0x2c63f7,_0x346ff2)),_0x2c63f7[_0x374460(0x1eb)][_0x374460(0x299)]=_0x4fe5bb,_0x2c63f7[_0x374460(0x1eb)][_0x374460(0x246)]=_0x4ef2ee;};}[_0x580cf2(0x1f0)](_0x949503,_0x40b535,_0x107e4c,_0x19820a,_0x5c53d8){var _0x2d5853=_0x580cf2,_0x5ab694=this;_0x5c53d8||(_0x5c53d8=function(_0x5f2fcc,_0x206d35){return _0x5f2fcc[_0x206d35];});var _0x1134e9=_0x107e4c['toString'](),_0x14b66d=_0x19820a[_0x2d5853(0x203)]||{},_0x42313b=_0x19820a[_0x2d5853(0x227)],_0x3e99cc=_0x19820a['isExpressionToEvaluate'];try{var _0x3a59ef=this[_0x2d5853(0x1cd)](_0x949503),_0x167d32=_0x1134e9;_0x3a59ef&&_0x167d32[0x0]==='\\x27'&&(_0x167d32=_0x167d32[_0x2d5853(0x1d2)](0x1,_0x167d32[_0x2d5853(0x257)]-0x2));var _0x1746b8=_0x19820a[_0x2d5853(0x203)]=_0x14b66d[_0x2d5853(0x24b)+_0x167d32];_0x1746b8&&(_0x19820a[_0x2d5853(0x227)]=_0x19820a[_0x2d5853(0x227)]+0x1),_0x19820a[_0x2d5853(0x259)]=!!_0x1746b8;var _0x8036e=typeof _0x107e4c=='symbol',_0x1e667b={'name':_0x8036e||_0x3a59ef?_0x1134e9:this[_0x2d5853(0x1bd)](_0x1134e9)};if(_0x8036e&&(_0x1e667b[_0x2d5853(0x1b4)]=!0x0),!(_0x40b535===_0x2d5853(0x222)||_0x40b535===_0x2d5853(0x1de))){var _0x36d41d=this[_0x2d5853(0x1d8)](_0x949503,_0x107e4c);if(_0x36d41d&&(_0x36d41d[_0x2d5853(0x231)]&&(_0x1e667b[_0x2d5853(0x262)]=!0x0),_0x36d41d[_0x2d5853(0x272)]&&!_0x1746b8&&!_0x19820a[_0x2d5853(0x29a)]))return _0x1e667b[_0x2d5853(0x261)]=!0x0,this[_0x2d5853(0x265)](_0x1e667b,_0x19820a),_0x1e667b;}var _0x1ab170;try{_0x1ab170=_0x5c53d8(_0x949503,_0x107e4c);}catch(_0x368958){return _0x1e667b={'name':_0x1134e9,'type':_0x2d5853(0x237),'error':_0x368958['message']},this[_0x2d5853(0x265)](_0x1e667b,_0x19820a),_0x1e667b;}var _0x84ca62=this[_0x2d5853(0x1e7)](_0x1ab170),_0x1ab3e7=this[_0x2d5853(0x28f)](_0x84ca62);if(_0x1e667b[_0x2d5853(0x287)]=_0x84ca62,_0x1ab3e7)this[_0x2d5853(0x265)](_0x1e667b,_0x19820a,_0x1ab170,function(){var _0x423481=_0x2d5853;_0x1e667b[_0x423481(0x20f)]=_0x1ab170[_0x423481(0x273)](),!_0x1746b8&&_0x5ab694[_0x423481(0x1ba)](_0x84ca62,_0x1e667b,_0x19820a,{});});else{var _0xa08ad1=_0x19820a[_0x2d5853(0x21f)]&&_0x19820a['level']<_0x19820a[_0x2d5853(0x27f)]&&_0x19820a[_0x2d5853(0x1ff)][_0x2d5853(0x268)](_0x1ab170)<0x0&&_0x84ca62!==_0x2d5853(0x24e)&&_0x19820a[_0x2d5853(0x26d)]<_0x19820a[_0x2d5853(0x1c0)];_0xa08ad1||_0x19820a[_0x2d5853(0x204)]<_0x42313b||_0x1746b8?(this['serialize'](_0x1e667b,_0x1ab170,_0x19820a,_0x1746b8||{}),this[_0x2d5853(0x23b)](_0x1ab170,_0x1e667b)):this['_processTreeNodeResult'](_0x1e667b,_0x19820a,_0x1ab170,function(){var _0x52fe44=_0x2d5853;_0x84ca62==='null'||_0x84ca62===_0x52fe44(0x1f3)||(delete _0x1e667b[_0x52fe44(0x20f)],_0x1e667b['capped']=!0x0);});}return _0x1e667b;}finally{_0x19820a[_0x2d5853(0x203)]=_0x14b66d,_0x19820a[_0x2d5853(0x227)]=_0x42313b,_0x19820a[_0x2d5853(0x259)]=_0x3e99cc;}}[_0x580cf2(0x1ba)](_0x48c102,_0x234116,_0x1ca502,_0x54835a){var _0x3aaaed=_0x580cf2,_0x133d8f=_0x54835a[_0x3aaaed(0x1c5)]||_0x1ca502['strLength'];if((_0x48c102===_0x3aaaed(0x1dc)||_0x48c102===_0x3aaaed(0x1db))&&_0x234116['value']){let _0x5a33f7=_0x234116[_0x3aaaed(0x20f)][_0x3aaaed(0x257)];_0x1ca502['allStrLength']+=_0x5a33f7,_0x1ca502[_0x3aaaed(0x22b)]>_0x1ca502[_0x3aaaed(0x266)]?(_0x234116['capped']='',delete _0x234116[_0x3aaaed(0x20f)]):_0x5a33f7>_0x133d8f&&(_0x234116['capped']=_0x234116[_0x3aaaed(0x20f)][_0x3aaaed(0x1d2)](0x0,_0x133d8f),delete _0x234116['value']);}}[_0x580cf2(0x1cd)](_0x447e6b){var _0x14a105=_0x580cf2;return!!(_0x447e6b&&_0x215415['Map']&&this[_0x14a105(0x1df)](_0x447e6b)==='[object\\x20Map]'&&_0x447e6b[_0x14a105(0x21a)]);}[_0x580cf2(0x1bd)](_0x1bb517){var _0x47b23d=_0x580cf2;if(_0x1bb517[_0x47b23d(0x24a)](/^\\d+$/))return _0x1bb517;var _0x2659aa;try{_0x2659aa=JSON[_0x47b23d(0x1bf)](''+_0x1bb517);}catch{_0x2659aa='\\x22'+this[_0x47b23d(0x1df)](_0x1bb517)+'\\x22';}return _0x2659aa[_0x47b23d(0x24a)](/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?_0x2659aa=_0x2659aa[_0x47b23d(0x1d2)](0x1,_0x2659aa[_0x47b23d(0x257)]-0x2):_0x2659aa=_0x2659aa[_0x47b23d(0x288)](/'/g,'\\x5c\\x27')[_0x47b23d(0x288)](/\\\\"/g,'\\x22')[_0x47b23d(0x288)](/(^"|"$)/g,'\\x27'),_0x2659aa;}[_0x580cf2(0x265)](_0x4a636c,_0x5984ec,_0x2f6cd2,_0x457c04){var _0x569e80=_0x580cf2;this[_0x569e80(0x27c)](_0x4a636c,_0x5984ec),_0x457c04&&_0x457c04(),this[_0x569e80(0x23b)](_0x2f6cd2,_0x4a636c),this['_treeNodePropertiesAfterFullValue'](_0x4a636c,_0x5984ec);}['_treeNodePropertiesBeforeFullValue'](_0x8e1725,_0x5a6fe4){var _0x4aea0f=_0x580cf2;this[_0x4aea0f(0x247)](_0x8e1725,_0x5a6fe4),this['_setNodeQueryPath'](_0x8e1725,_0x5a6fe4),this['_setNodeExpressionPath'](_0x8e1725,_0x5a6fe4),this[_0x4aea0f(0x245)](_0x8e1725,_0x5a6fe4);}[_0x580cf2(0x247)](_0x53059c,_0x46a130){}[_0x580cf2(0x211)](_0x9a1c3c,_0x4ddcc8){}[_0x580cf2(0x208)](_0x153d8f,_0x1b813e){}[_0x580cf2(0x1fb)](_0x166dd0){var _0x4af6c8=_0x580cf2;return _0x166dd0===this[_0x4af6c8(0x20b)];}[_0x580cf2(0x21d)](_0xb25851,_0x12000f){var _0x35c7b8=_0x580cf2;this['_setNodeLabel'](_0xb25851,_0x12000f),this['_setNodeExpandableState'](_0xb25851),_0x12000f[_0x35c7b8(0x20d)]&&this[_0x35c7b8(0x21b)](_0xb25851),this[_0x35c7b8(0x297)](_0xb25851,_0x12000f),this[_0x35c7b8(0x232)](_0xb25851,_0x12000f),this[_0x35c7b8(0x229)](_0xb25851);}[_0x580cf2(0x23b)](_0x3a692c,_0x34a849){var _0xe0d5e7=_0x580cf2;let _0x3b0162;try{_0x215415[_0xe0d5e7(0x1dd)]&&(_0x3b0162=_0x215415[_0xe0d5e7(0x1dd)]['error'],_0x215415['console']['error']=function(){}),_0x3a692c&&typeof _0x3a692c[_0xe0d5e7(0x257)]==_0xe0d5e7(0x1f1)&&(_0x34a849[_0xe0d5e7(0x257)]=_0x3a692c[_0xe0d5e7(0x257)]);}catch{}finally{_0x3b0162&&(_0x215415['console'][_0xe0d5e7(0x230)]=_0x3b0162);}if(_0x34a849[_0xe0d5e7(0x287)]===_0xe0d5e7(0x1f1)||_0x34a849[_0xe0d5e7(0x287)]===_0xe0d5e7(0x286)){if(isNaN(_0x34a849[_0xe0d5e7(0x20f)]))_0x34a849['nan']=!0x0,delete _0x34a849[_0xe0d5e7(0x20f)];else switch(_0x34a849['value']){case Number[_0xe0d5e7(0x201)]:_0x34a849[_0xe0d5e7(0x22c)]=!0x0,delete _0x34a849['value'];break;case Number[_0xe0d5e7(0x1f6)]:_0x34a849['negativeInfinity']=!0x0,delete _0x34a849[_0xe0d5e7(0x20f)];break;case 0x0:this['_isNegativeZero'](_0x34a849['value'])&&(_0x34a849['negativeZero']=!0x0);break;}}else _0x34a849['type']===_0xe0d5e7(0x24e)&&typeof _0x3a692c[_0xe0d5e7(0x279)]=='string'&&_0x3a692c[_0xe0d5e7(0x279)]&&_0x34a849[_0xe0d5e7(0x279)]&&_0x3a692c['name']!==_0x34a849[_0xe0d5e7(0x279)]&&(_0x34a849[_0xe0d5e7(0x270)]=_0x3a692c['name']);}[_0x580cf2(0x215)](_0x48d840){var _0x58b943=_0x580cf2;return 0x1/_0x48d840===Number[_0x58b943(0x1f6)];}[_0x580cf2(0x21b)](_0x52cab4){var _0x2f97cc=_0x580cf2;!_0x52cab4[_0x2f97cc(0x1e2)]||!_0x52cab4[_0x2f97cc(0x1e2)][_0x2f97cc(0x257)]||_0x52cab4[_0x2f97cc(0x287)]===_0x2f97cc(0x222)||_0x52cab4['type']===_0x2f97cc(0x238)||_0x52cab4['type']==='Set'||_0x52cab4[_0x2f97cc(0x1e2)]['sort'](function(_0x28b6c8,_0x3277ac){var _0x574835=_0x2f97cc,_0x8ddd5a=_0x28b6c8[_0x574835(0x279)][_0x574835(0x1b5)](),_0x5c5bbd=_0x3277ac['name'][_0x574835(0x1b5)]();return _0x8ddd5a<_0x5c5bbd?-0x1:_0x8ddd5a>_0x5c5bbd?0x1:0x0;});}['_addFunctionsNode'](_0x214a8b,_0x2c6909){var _0x9c1f6b=_0x580cf2;if(!(_0x2c6909['noFunctions']||!_0x214a8b['props']||!_0x214a8b[_0x9c1f6b(0x1e2)][_0x9c1f6b(0x257)])){for(var _0x4e67b9=[],_0x5efe0a=[],_0x1f2f67=0x0,_0x44506b=_0x214a8b['props']['length'];_0x1f2f67<_0x44506b;_0x1f2f67++){var _0x479203=_0x214a8b['props'][_0x1f2f67];_0x479203[_0x9c1f6b(0x287)]===_0x9c1f6b(0x24e)?_0x4e67b9[_0x9c1f6b(0x1f9)](_0x479203):_0x5efe0a[_0x9c1f6b(0x1f9)](_0x479203);}if(!(!_0x5efe0a[_0x9c1f6b(0x257)]||_0x4e67b9['length']<=0x1)){_0x214a8b[_0x9c1f6b(0x1e2)]=_0x5efe0a;var _0x31b386={'functionsNode':!0x0,'props':_0x4e67b9};this[_0x9c1f6b(0x247)](_0x31b386,_0x2c6909),this[_0x9c1f6b(0x208)](_0x31b386,_0x2c6909),this[_0x9c1f6b(0x240)](_0x31b386),this[_0x9c1f6b(0x245)](_0x31b386,_0x2c6909),_0x31b386['id']+='\\x20f',_0x214a8b[_0x9c1f6b(0x1e2)][_0x9c1f6b(0x241)](_0x31b386);}}}[_0x580cf2(0x232)](_0x3980e5,_0x378fb1){}[_0x580cf2(0x240)](_0x1bbee1){}[_0x580cf2(0x22f)](_0x59cca2){var _0x3a8c68=_0x580cf2;return Array[_0x3a8c68(0x249)](_0x59cca2)||typeof _0x59cca2==_0x3a8c68(0x22e)&&this[_0x3a8c68(0x1df)](_0x59cca2)==='[object\\x20Array]';}[_0x580cf2(0x245)](_0x559321,_0xc8a8c6){}[_0x580cf2(0x229)](_0x4d0efb){var _0x5200be=_0x580cf2;delete _0x4d0efb[_0x5200be(0x1e4)],delete _0x4d0efb['_hasSetOnItsPath'],delete _0x4d0efb[_0x5200be(0x206)];}[_0x580cf2(0x29d)](_0x5bbc19,_0x501b71){}}let _0x55375b=new _0x39411a(),_0x5692c0={'props':0x64,'elements':0x64,'strLength':0x400*0x32,'totalStrLength':0x400*0x32,'autoExpandLimit':0x1388,'autoExpandMaxDepth':0xa},_0x223e3e={'props':0x5,'elements':0x5,'strLength':0x100,'totalStrLength':0x100*0x3,'autoExpandLimit':0x1e,'autoExpandMaxDepth':0x2};function _0x4ab6c9(_0x4f9b32,_0x2d57a6,_0x517fc1,_0x14445b,_0x4f8f22,_0x7c9ae3){var _0x296ff5=_0x580cf2;let _0x27eb2b,_0xb7c039;try{_0xb7c039=_0x19745e(),_0x27eb2b=_0x414e35[_0x2d57a6],!_0x27eb2b||_0xb7c039-_0x27eb2b['ts']>0x1f4&&_0x27eb2b['count']&&_0x27eb2b[_0x296ff5(0x1b8)]/_0x27eb2b[_0x296ff5(0x212)]<0x64?(_0x414e35[_0x2d57a6]=_0x27eb2b={'count':0x0,'time':0x0,'ts':_0xb7c039},_0x414e35[_0x296ff5(0x281)]={}):_0xb7c039-_0x414e35[_0x296ff5(0x281)]['ts']>0x32&&_0x414e35[_0x296ff5(0x281)]['count']&&_0x414e35[_0x296ff5(0x281)][_0x296ff5(0x1b8)]/_0x414e35['hits'][_0x296ff5(0x212)]<0x64&&(_0x414e35[_0x296ff5(0x281)]={});let _0x4f1fd0=[],_0x165369=_0x27eb2b[_0x296ff5(0x282)]||_0x414e35[_0x296ff5(0x281)][_0x296ff5(0x282)]?_0x223e3e:_0x5692c0,_0x341129=_0x14c918=>{var _0x11bf1b=_0x296ff5;let _0x1db7ec={};return _0x1db7ec['props']=_0x14c918['props'],_0x1db7ec[_0x11bf1b(0x1e3)]=_0x14c918[_0x11bf1b(0x1e3)],_0x1db7ec['strLength']=_0x14c918[_0x11bf1b(0x1c5)],_0x1db7ec[_0x11bf1b(0x266)]=_0x14c918[_0x11bf1b(0x266)],_0x1db7ec[_0x11bf1b(0x1c0)]=_0x14c918[_0x11bf1b(0x1c0)],_0x1db7ec[_0x11bf1b(0x27f)]=_0x14c918[_0x11bf1b(0x27f)],_0x1db7ec['sortProps']=!0x1,_0x1db7ec[_0x11bf1b(0x233)]=!_0x243cf5,_0x1db7ec[_0x11bf1b(0x227)]=0x1,_0x1db7ec[_0x11bf1b(0x204)]=0x0,_0x1db7ec[_0x11bf1b(0x220)]='root_exp_id',_0x1db7ec[_0x11bf1b(0x1f2)]=_0x11bf1b(0x214),_0x1db7ec['autoExpand']=!0x0,_0x1db7ec[_0x11bf1b(0x1ff)]=[],_0x1db7ec[_0x11bf1b(0x26d)]=0x0,_0x1db7ec[_0x11bf1b(0x29a)]=!0x0,_0x1db7ec['allStrLength']=0x0,_0x1db7ec[_0x11bf1b(0x1eb)]={'current':void 0x0,'parent':void 0x0,'index':0x0},_0x1db7ec;};for(var _0x1efdc8=0x0;_0x1efdc8<_0x4f8f22[_0x296ff5(0x257)];_0x1efdc8++)_0x4f1fd0[_0x296ff5(0x1f9)](_0x55375b[_0x296ff5(0x248)]({'timeNode':_0x4f9b32==='time'||void 0x0},_0x4f8f22[_0x1efdc8],_0x341129(_0x165369),{}));if(_0x4f9b32===_0x296ff5(0x1bb)){let _0x1692d3=Error[_0x296ff5(0x244)];try{Error['stackTraceLimit']=0x1/0x0,_0x4f1fd0[_0x296ff5(0x1f9)](_0x55375b['serialize']({'stackNode':!0x0},new Error()[_0x296ff5(0x252)],_0x341129(_0x165369),{'strLength':0x1/0x0}));}finally{Error[_0x296ff5(0x244)]=_0x1692d3;}}return{'method':_0x296ff5(0x25f),'version':_0x12e098,'args':[{'ts':_0x517fc1,'session':_0x14445b,'args':_0x4f1fd0,'id':_0x2d57a6,'context':_0x7c9ae3}]};}catch(_0x315eb1){return{'method':_0x296ff5(0x25f),'version':_0x12e098,'args':[{'ts':_0x517fc1,'session':_0x14445b,'args':[{'type':_0x296ff5(0x237),'error':_0x315eb1&&_0x315eb1[_0x296ff5(0x295)]}],'id':_0x2d57a6,'context':_0x7c9ae3}]};}finally{try{if(_0x27eb2b&&_0xb7c039){let _0xe9e58d=_0x19745e();_0x27eb2b[_0x296ff5(0x212)]++,_0x27eb2b[_0x296ff5(0x1b8)]+=_0x1e922d(_0xb7c039,_0xe9e58d),_0x27eb2b['ts']=_0xe9e58d,_0x414e35['hits'][_0x296ff5(0x212)]++,_0x414e35[_0x296ff5(0x281)]['time']+=_0x1e922d(_0xb7c039,_0xe9e58d),_0x414e35[_0x296ff5(0x281)]['ts']=_0xe9e58d,(_0x27eb2b['count']>0x32||_0x27eb2b[_0x296ff5(0x1b8)]>0x64)&&(_0x27eb2b[_0x296ff5(0x282)]=!0x0),(_0x414e35[_0x296ff5(0x281)]['count']>0x3e8||_0x414e35[_0x296ff5(0x281)][_0x296ff5(0x1b8)]>0x12c)&&(_0x414e35[_0x296ff5(0x281)][_0x296ff5(0x282)]=!0x0);}}catch{}}}return _0x4ab6c9;}function _0x3ba1(){var _0x3cb73c=['set','_addLoadNode','noFunctions','1206340CLTvMI','call','[object\\x20Set]','unknown','Map','4195960EqFetw','','_additionalMetadata','timeEnd','_connecting','NEXT_RUNTIME','getWebSocketClass','_setNodeExpandableState','unshift','_reconnectTimeout','2487450WbCORR','stackTraceLimit','_setNodePermissions','index','_setNodeId','serialize','isArray','match','_p_','_sendErrorMessage','now','function','_dateToString','dockerizedApp','join','stack','hasOwnProperty','getOwnPropertyNames','956202PGyymO','disabledTrace','length','_connected','isExpressionToEvaluate','current','[object\\x20Date]','60394','pathToFileURL','close','log','26929djpwuv','getter','setter','location','\\x20server','_processTreeNodeResult','totalStrLength','slice','indexOf','getPrototypeOf','127.0.0.1','_console_ninja','_regExpToString','autoExpandPropertyCount','data','url','funcName','_HTMLAllCollection','get','valueOf','_getOwnPropertySymbols','1.0.0','next.js','timeStamp','_isSet','name','Buffer','coverage','_treeNodePropertiesBeforeFullValue','parse','Boolean','autoExpandMaxDepth','_inBrowser','hits','reduceLimits','path','26QMRMjI','boolean','Number','type','replace','angular','_consoleNinjaAllowedToStart','split','toString','global','logger\\x20websocket\\x20error','_isPrimitiveType','_WebSocketClass','cappedProps','_p_length','null','getOwnPropertySymbols','message','create','_addFunctionsNode','_isPrimitiveWrapperType','parent','resolveGetters','map','pop','_setNodeExpressionPath','method','getOwnPropertyDescriptor','21533868gqWHvM','onopen','symbol','toLowerCase','','reload','time','date','_capIfString','trace','defineProperty','_propertyName','host','stringify','autoExpandLimit','env','_blacklistedProperty','_connectAttemptCount','warn','strLength',':logPointId:','failed\\x20to\\x20find\\x20and\\x20load\\x20WebSocket','constructor','_maxConnectAttemptCount','https://tinyurl.com/37x8b79t','_WebSocket','1712660479123','_isMap','bind','capped','versions','\\x20browser','substr','_connectToHostNow','astro','2696crpfQW','enumerable','concat','_getOwnPropertyDescriptor','edge','_addProperty','String','string','console','Error','_objectToString','[object\\x20BigInt]','_ws','props','elements','_hasSymbolPropertyOnItsPath','RegExp','...','_type','disabledLog','_inNextEdge','_socket','node','prototype','angular','_allowedToSend','_console_ninja_session','_property','number','rootExpression','undefined','process','Set','NEGATIVE_INFINITY','nodeModules','Console\\x20Ninja\\x20failed\\x20to\\x20send\\x20logs,\\x20restarting\\x20the\\x20process\\x20may\\x20help;\\x20also\\x20see\\x20','push','_Symbol','_isUndefined','catch','bigint','onerror','autoExpandPreviousObjects','ws://','POSITIVE_INFINITY','port','expressionsToEvaluate','level','hrtime','_hasMapOnItsPath','unref','_setNodeLabel','HTMLAllCollection',["localhost","127.0.0.1","example.cypress.io","LAPTOP-1V5HLGOD","172.27.80.1","192.168.56.1","10.0.0.19"],'_undefined','_p_name','sortProps','elapsed','value','74603ihYVjm','_setNodeQueryPath','count','_attemptToReconnectShortly','root_exp','_isNegativeZero','readyState','_allowedToConnectOnSend','hostname','send','forEach','_sortProps','_addObjectProperty','_treeNodePropertiesAfterFullValue','__es'+'Module','autoExpand','expId','then','array','default','performance','perf_hooks','_getOwnPropertyNames','depth','WebSocket','_cleanNode','onclose','allStrLength','positiveInfinity','ws/index.js','object','_isArray','error'];_0x3ba1=function(){return _0x3cb73c;};return _0x3ba1();}function _0x4050(_0x1c8374,_0x5de145){var _0x3ba176=_0x3ba1();return _0x4050=function(_0x4050b6,_0x21c3f2){_0x4050b6=_0x4050b6-0x1b2;var _0x778d89=_0x3ba176[_0x4050b6];return _0x778d89;},_0x4050(_0x1c8374,_0x5de145);}((_0x487bd,_0x5c4a99,_0x4c2d22,_0x10b48f,_0x227054,_0x4f59aa,_0x4c070f,_0x4250b1,_0x4da373,_0x1553fd)=>{var _0x226a79=_0x3e00e0;if(_0x487bd[_0x226a79(0x26b)])return _0x487bd[_0x226a79(0x26b)];if(!J(_0x487bd,_0x4250b1,_0x227054))return _0x487bd[_0x226a79(0x26b)]={'consoleLog':()=>{},'consoleTrace':()=>{},'consoleTime':()=>{},'consoleTimeEnd':()=>{},'autoLog':()=>{},'autoLogMany':()=>{},'autoTraceMany':()=>{},'coverage':()=>{},'autoTrace':()=>{},'autoTime':()=>{},'autoTimeEnd':()=>{}},_0x487bd[_0x226a79(0x26b)];let _0x103977=W(_0x487bd),_0x287de0=_0x103977[_0x226a79(0x20e)],_0x42af2b=_0x103977['timeStamp'],_0x49bbf3=_0x103977['now'],_0xe07dc4={'hits':{},'ts':{}},_0x4bdb46=Y(_0x487bd,_0x4da373,_0xe07dc4,_0x4f59aa),_0x5b442d=_0x51c231=>{_0xe07dc4['ts'][_0x51c231]=_0x42af2b();},_0x1fa9ee=(_0x2bf05a,_0x3b55dd)=>{var _0x50ccc1=_0x226a79;let _0x26b57d=_0xe07dc4['ts'][_0x3b55dd];if(delete _0xe07dc4['ts'][_0x3b55dd],_0x26b57d){let _0x2d3478=_0x287de0(_0x26b57d,_0x42af2b());_0x20f993(_0x4bdb46(_0x50ccc1(0x1b8),_0x2bf05a,_0x49bbf3(),_0x4acb65,[_0x2d3478],_0x3b55dd));}},_0x842b9b=_0x272ce1=>_0x185cc5=>{var _0x38e8e3=_0x226a79;try{_0x5b442d(_0x185cc5),_0x272ce1(_0x185cc5);}finally{_0x487bd[_0x38e8e3(0x1dd)]['time']=_0x272ce1;}},_0x2d0550=_0x54edb2=>_0x4db119=>{var _0x5b39c3=_0x226a79;try{let [_0x33c90b,_0x3198b1]=_0x4db119[_0x5b39c3(0x28b)](_0x5b39c3(0x1c6));_0x1fa9ee(_0x3198b1,_0x33c90b),_0x54edb2(_0x33c90b);}finally{_0x487bd['console'][_0x5b39c3(0x23c)]=_0x54edb2;}};_0x487bd[_0x226a79(0x26b)]={'consoleLog':(_0x2a467d,_0x10253c)=>{var _0xb052d=_0x226a79;_0x487bd['console']['log'][_0xb052d(0x279)]!==_0xb052d(0x1e8)&&_0x20f993(_0x4bdb46('log',_0x2a467d,_0x49bbf3(),_0x4acb65,_0x10253c));},'consoleTrace':(_0x20e2bb,_0x4de0d7)=>{var _0x28e452=_0x226a79;_0x487bd[_0x28e452(0x1dd)][_0x28e452(0x25f)][_0x28e452(0x279)]!==_0x28e452(0x256)&&_0x20f993(_0x4bdb46(_0x28e452(0x1bb),_0x20e2bb,_0x49bbf3(),_0x4acb65,_0x4de0d7));},'consoleTime':()=>{var _0x24e2e1=_0x226a79;_0x487bd['console'][_0x24e2e1(0x1b8)]=_0x842b9b(_0x487bd[_0x24e2e1(0x1dd)][_0x24e2e1(0x1b8)]);},'consoleTimeEnd':()=>{var _0x3c3822=_0x226a79;_0x487bd['console'][_0x3c3822(0x23c)]=_0x2d0550(_0x487bd[_0x3c3822(0x1dd)][_0x3c3822(0x23c)]);},'autoLog':(_0x39acfb,_0x3c947a)=>{var _0x53b01d=_0x226a79;_0x20f993(_0x4bdb46(_0x53b01d(0x25f),_0x3c947a,_0x49bbf3(),_0x4acb65,[_0x39acfb]));},'autoLogMany':(_0x5c0f7,_0xd934fd)=>{var _0x365320=_0x226a79;_0x20f993(_0x4bdb46(_0x365320(0x25f),_0x5c0f7,_0x49bbf3(),_0x4acb65,_0xd934fd));},'autoTrace':(_0x543ec0,_0x471149)=>{_0x20f993(_0x4bdb46('trace',_0x471149,_0x49bbf3(),_0x4acb65,[_0x543ec0]));},'autoTraceMany':(_0x7a10e6,_0x5bcec8)=>{var _0x512abc=_0x226a79;_0x20f993(_0x4bdb46(_0x512abc(0x1bb),_0x7a10e6,_0x49bbf3(),_0x4acb65,_0x5bcec8));},'autoTime':(_0x229ff6,_0x12be8f,_0x538b55)=>{_0x5b442d(_0x538b55);},'autoTimeEnd':(_0x12ab50,_0x1f3a17,_0x210e06)=>{_0x1fa9ee(_0x1f3a17,_0x210e06);},'coverage':_0x37d67d=>{var _0x6e1486=_0x226a79;_0x20f993({'method':_0x6e1486(0x27b),'version':_0x4f59aa,'args':[{'id':_0x37d67d}]});}};let _0x20f993=b(_0x487bd,_0x5c4a99,_0x4c2d22,_0x10b48f,_0x227054,_0x1553fd),_0x4acb65=_0x487bd[_0x226a79(0x1ef)];return _0x487bd[_0x226a79(0x26b)];})(globalThis,_0x3e00e0(0x26a),_0x3e00e0(0x25c),"c:\\\\Users\\\\gatit\\\\.vscode\\\\extensions\\\\wallabyjs.console-ninja-1.0.298\\\\node_modules",_0x3e00e0(0x1ed),_0x3e00e0(0x275),_0x3e00e0(0x1cc),_0x3e00e0(0x20a),_0x3e00e0(0x1b6),_0x3e00e0(0x23a));`)}catch{}}function M$(t,...e){try{A$().consoleLog(t,e)}catch{}return e}var Lk=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(re(Gr),re(pr))},e.\u0275dir=bt({type:e});let t=e;return t})(),tm=(()=>{let e=class e extends Lk{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ei(e)))(s||e)}})(),e.\u0275dir=bt({type:e,features:[zr]});let t=e;return t})(),rd=new O("");var N$={provide:rd,useExisting:xi(()=>mc),multi:!0};function P$(){let t=gr()?gr().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var k$=new O(""),mc=(()=>{let e=class e extends Lk{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!P$())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(re(Gr),re(pr),re(k$,8))},e.\u0275dir=bt({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&Ve("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[sa([N$]),zr]});let t=e;return t})();var O$=new O(""),F$=new O("");function jk(t){return t!=null}function Bk(t){return Ts(t)?ye(t):t}function Uk(t){let e={};return t.forEach(n=>{e=n!=null?A(A({},e),n):e}),Object.keys(e).length===0?null:e}function $k(t,e){return e.map(n=>n(t))}function V$(t){return!t.validate}function Hk(t){return t.map(e=>V$(e)?e:n=>e.validate(n))}function L$(t){if(!t)return null;let e=t.filter(jk);return e.length==0?null:function(n){return Uk($k(n,e))}}function qk(t){return t!=null?L$(Hk(t)):null}function j$(t){if(!t)return null;let e=t.filter(jk);return e.length==0?null:function(n){let r=$k(n,e).map(Bk);return w_(r).pipe(j(Uk))}}function Gk(t){return t!=null?j$(Hk(t)):null}function Mk(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function B$(t){return t._rawValidators}function U$(t){return t._rawAsyncValidators}function xI(t){return t?Array.isArray(t)?t:[t]:[]}function Jg(t,e){return Array.isArray(t)?t.includes(e):t===e}function Rk(t,e){let n=xI(e);return xI(t).forEach(i=>{Jg(n,i)||n.push(i)}),n}function Nk(t,e){return xI(e).filter(n=>!Jg(t,n))}var em=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=qk(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Gk(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},wI=class extends em{get formDirective(){return null}get path(){return null}},nd=class extends em{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},EI=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},$$={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},pne=ue(A({},$$),{"[class.ng-submitted]":"isSubmitted"}),_c=(()=>{let e=class e extends EI{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(re(nd,2))},e.\u0275dir=bt({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&hy("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[zr]});let t=e;return t})();var ed="VALID",Xg="INVALID",gc="PENDING",td="DISABLED";function H$(t){return(nm(t)?t.validators:t)||null}function q$(t){return Array.isArray(t)?qk(t):t||null}function G$(t,e){return(nm(e)?e.asyncValidators:t)||null}function z$(t){return Array.isArray(t)?Gk(t):t||null}function nm(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}var II=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===ed}get invalid(){return this.status===Xg}get pending(){return this.status==gc}get disabled(){return this.status===td}get enabled(){return this.status!==td}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Rk(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Rk(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Nk(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Nk(e,this._rawAsyncValidators))}hasValidator(e){return Jg(this._rawValidators,e)}hasAsyncValidator(e){return Jg(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=gc,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=td,this.errors=null,this._forEachChild(r=>{r.disable(ue(A({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ue(A({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=ed,this._forEachChild(r=>{r.enable(ue(A({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ue(A({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===ed||this.status===gc)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?td:ed}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=gc,this._hasOwnPendingAsyncValidator=!0;let n=Bk(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new lt,this.statusChanges=new lt}_calculateStatus(){return this._allControlsDisabled()?td:this.errors?Xg:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(gc)?gc:this._anyControlsHaveStatus(Xg)?Xg:ed}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){nm(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=q$(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=z$(this._rawAsyncValidators)}};var zk=new O("CallSetDisabledState",{providedIn:"root",factory:()=>CI}),CI="always";function W$(t,e){return[...e.path,t]}function K$(t,e,n=CI){Y$(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),Z$(t,e),J$(t,e),X$(t,e),Q$(t,e)}function Pk(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function Q$(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function Y$(t,e){let n=B$(t);e.validator!==null?t.setValidators(Mk(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=U$(t);e.asyncValidator!==null?t.setAsyncValidators(Mk(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();Pk(e._rawValidators,i),Pk(e._rawAsyncValidators,i)}function Z$(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&Wk(t,e)})}function X$(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&Wk(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function Wk(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function J$(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function e7(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function t7(t){return Object.getPrototypeOf(t.constructor)===tm}function n7(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(s=>{s.constructor===mc?n=s:t7(s)?r=s:i=s}),i||r||n||null}function kk(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function Ok(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var r7=class extends II{constructor(e=null,n,r){super(H$(n),G$(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),nm(n)&&(n.nonNullable||n.initialValueIsDefault)&&(Ok(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){kk(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){kk(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Ok(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var i7={provide:nd,useExisting:xi(()=>go)},Fk=Promise.resolve(),go=(()=>{let e=class e extends nd{constructor(r,i,s,o,a,c){super(),this._changeDetectorRef=a,this.callSetDisabledState=c,this.control=new r7,this._registered=!1,this.name="",this.update=new lt,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=n7(this,o)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),e7(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){K$(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){Fk.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,s=i!==0&&As(i);Fk.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?W$(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(re(wI,9),re(O$,10),re(F$,10),re(rd,10),re(Ss,8),re(zk,8))},e.\u0275dir=bt({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[Ut.None,"disabled","isDisabled"],model:[Ut.None,"ngModel","model"],options:[Ut.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[sa([i7]),zr,Cs]});let t=e;return t})();var s7={provide:rd,useExisting:xi(()=>id),multi:!0},id=(()=>{let e=class e extends tm{writeValue(r){let i=r??"";this.setProperty("value",i)}registerOnChange(r){this.onChange=i=>{r(i==""?null:parseFloat(i))}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ei(e)))(s||e)}})(),e.\u0275dir=bt({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,s){i&1&&Ve("input",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},features:[sa([s7]),zr]});let t=e;return t})();var o7={provide:rd,useExisting:xi(()=>yc),multi:!0};function Kk(t,e){return t==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function a7(t){return t.split(":")[0]}var yc=(()=>{let e=class e extends tm{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i=this._getOptionId(r),s=Kk(i,r);this.setProperty("value",s)}registerOnChange(r){this.onChange=i=>{this.value=this._getOptionValue(i),r(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),r))return i;return null}_getOptionValue(r){let i=a7(r);return this._optionMap.has(i)?this._optionMap.get(i):r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ei(e)))(s||e)}})(),e.\u0275dir=bt({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,s){i&1&&Ve("change",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[sa([o7]),zr]});let t=e;return t})(),rm=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(r){this._select!=null&&(this._select._optionMap.set(this.id,r),this._setElementValue(Kk(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._setElementValue(r),this._select&&this._select.writeValue(this._select.value)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(re(pr),re(Gr),re(yc,9))},e.\u0275dir=bt({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})(),c7={provide:rd,useExisting:xi(()=>Qk),multi:!0};function Vk(t,e){return t==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function u7(t){return t.split(":")[0]}var Qk=(()=>{let e=class e extends tm{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i;if(Array.isArray(r)){let s=r.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(r){this.onChange=i=>{let s=[],o=i.selectedOptions;if(o!==void 0){let a=o;for(let c=0;c<a.length;c++){let u=a[c],l=this._getOptionValue(u.value);s.push(l)}}else{let a=i.options;for(let c=0;c<a.length;c++){let u=a[c];if(u.selected){let l=this._getOptionValue(u.value);s.push(l)}}}this.value=s,r(s)}}_registerOption(r){let i=(this._idCounter++).toString();return this._optionMap.set(i,r),i}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,r))return i;return null}_getOptionValue(r){let i=u7(r);return this._optionMap.has(i)?this._optionMap.get(i)._value:r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Ei(e)))(s||e)}})(),e.\u0275dir=bt({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,s){i&1&&Ve("change",function(a){return s.onChange(a.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[sa([c7]),zr]});let t=e;return t})(),im=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(r){this._select!=null&&(this._value=r,this._setElementValue(Vk(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._select?(this._value=r,this._setElementValue(Vk(this.id,r)),this._select.writeValue(this._select.value)):this._setElementValue(r)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}_setSelected(r){this._renderer.setProperty(this._element.nativeElement,"selected",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(re(pr),re(Gr),re(Qk,9))},e.\u0275dir=bt({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})();var l7=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=tt({type:e}),e.\u0275inj=et({});let t=e;return t})();var Yk=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:zk,useValue:r.callSetDisabledState??CI}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=tt({type:e}),e.\u0275inj=et({imports:[l7]});let t=e;return t})();var vc=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=tn({type:e,selectors:[["app-loader"]],decls:1,vars:0,consts:[[1,"loader"]],template:function(i,s){i&1&&on(0,"div",0)},styles:[".loader[_ngcontent-%COMP%]{width:120px;aspect-ratio:1;--_c:no-repeat radial-gradient(farthest-side,var(--yellow) 92%,#0000);background:var(--_c) top,var(--_c) left,var(--_c) right,var(--_c) bottom;background-size:27px 27px;animation:_ngcontent-%COMP%_l7 1s infinite;margin:3rem auto}@keyframes _ngcontent-%COMP%_l7{to{transform:rotate(.5turn)}}"]});let t=e;return t})();function d7(t,e){t&1&&(x(0,"h2"),S(1,"A\xF1adir coche"),C())}function h7(t,e){t&1&&(x(0,"h2"),S(1,"Modificar coche"),C())}function f7(t,e){if(t&1){let n=qt();x(0,"div")(1,"button",15),Ve("click",function(){$t(n);let i=ft();return Ht(i.createCoche())}),S(2,"A\xF1adir"),C()()}}function p7(t,e){if(t&1){let n=qt();x(0,"div")(1,"button",16),Ve("click",function(){$t(n);let i=ft();return Ht(i.updateCoche())}),S(2,"Modificar"),C()()}}function g7(t,e){if(t&1){let n=qt();x(0,"div")(1,"button",17),Ve("click",function(){$t(n);let i=ft();return Ht(i.deleteCoche())}),S(2,"Eliminar"),C()()}}function m7(t,e){if(t&1){let n=qt();x(0,"div")(1,"button",18),Ve("click",function(){$t(n);let i=ft();return Ht(i.sellCoche())}),S(2,"Vender"),C()()}}function _7(t,e){if(t&1){let n=qt();x(0,"div")(1,"button",15),Ve("click",function(){$t(n);let i=ft();return Ht(i.resetCurrentCoche())}),S(2," A\xF1adir nuevo "),C()()}}function y7(t,e){if(t&1){let n=qt();x(0,"tr",21)(1,"td"),S(2),C(),x(3,"td"),S(4),C(),x(5,"td"),S(6),C(),x(7,"td"),S(8),C(),x(9,"td"),S(10),C(),x(11,"td"),S(12),C(),x(13,"td")(14,"button",22),Ve("click",function(){let i=$t(n).$implicit,s=ft(2);return Ht(s.setCurrentCoche(i))}),S(15," Seleccionar "),C()()()}if(t&2){let n=e.$implicit;Ds("id",n.id),G(2),Dt(n.marca),G(2),Dt(n.modelo),G(2),lu("",n.kilometros," KM"),G(2),Dt(n.transmision),G(2),lu("",n.precio," $"),G(2),Dt(n.vendido)}}function v7(t,e){if(t&1&&(x(0,"table",19)(1,"thead")(2,"tr")(3,"th"),S(4,"Marca"),C(),x(5,"th"),S(6,"Modelo"),C(),x(7,"th"),S(8,"Kilometros"),C(),x(9,"th"),S(10,"Transmision"),C(),x(11,"th"),S(12,"Precio"),C(),x(13,"th"),S(14,"Vendido"),C(),x(15,"th"),S(16,"Acciones"),C()()(),x(17,"tbody"),sn(18,y7,16,7,"tr",20),C()()),t&2){let n=ft();G(18),Re("ngForOf",n.coches)}}function x7(t,e){t&1&&on(0,"app-loader")}var Zk=(()=>{let e=class e{constructor(r){this.cocheService=r,this.state=Qn.create,this.isLoading=!0,this.MODES=Qn,this.coches=[],this.currentCoche=new va({marca:"",modelo:"",precio:0,kilometros:0,vendido:!1,transmision:"",due\u00F1oActual:""})}ngOnInit(){this.updateCoches()}updateCoches(){return g(this,null,function*(){this.isLoading=!0,this.coches=yield this.cocheService.getCoches(),this.isLoading=!1})}createCoche(){return g(this,null,function*(){let r=new va({marca:this.currentCoche.marca,modelo:this.currentCoche.modelo,precio:this.currentCoche.precio,kilometros:this.currentCoche.kilometros,vendido:!1,transmision:this.currentCoche.transmision,due\u00F1oActual:""});yield this.cocheService.createCoche(r),yield this.updateCoches(),this.resetCurrentCoche()})}updateCoche(){return g(this,null,function*(){yield this.cocheService.updateCoche(this.currentCoche),yield this.updateCoches(),this.resetCurrentCoche()})}deleteCoche(){return g(this,null,function*(){yield this.cocheService.deleteCoche(this.currentCoche.id),yield this.updateCoches(),this.resetCurrentCoche()})}setCurrentCoche(r){return g(this,null,function*(){this.currentCoche=r,this.state=Qn.select})}resetCurrentCoche(){return g(this,null,function*(){this.currentCoche=new va({marca:"",modelo:"",precio:0,kilometros:0,vendido:!1,transmision:"",due\u00F1oActual:""}),this.state=Qn.create,yield this.updateCoches()})}sellCoche(){return g(this,null,function*(){let r=this.currentCoche;yield this.cocheService.sellCoche(r.id,"123123",r.precio,"efectivo"),this.resetCurrentCoche(),yield this.updateCoches()})}};e.\u0275fac=function(i){return new(i||e)(re(Ak))},e.\u0275cmp=tn({type:e,selectors:[["app-coches"]],decls:42,vars:14,consts:[[1,"page"],[1,"row"],[1,"input-column"],[1,"container-title"],[4,"ngIf"],[1,"container"],[1,"input-row"],["type","text",3,"ngModelChange","ngModel"],["type","number",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],["value","manual"],["value","automatica"],[1,"container","botones"],[1,"table-column"],["class","table",4,"ngIf"],[1,"btn","add",3,"click"],[1,"btn","mod",3,"click"],[1,"btn","del",3,"click"],[1,"btn","sell",3,"click"],[1,"table"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],[1,"btn","btn-primary",3,"click"]],template:function(i,s){i&1&&(x(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),sn(4,d7,2,0,"h2",4)(5,h7,2,0,"h2",4),C(),x(6,"div",5)(7,"div",6)(8,"label"),S(9," Marca "),x(10,"input",7),cn("ngModelChange",function(a){return fn(s.currentCoche.marca,a)||(s.currentCoche.marca=a),a}),C()()(),x(11,"div",6)(12,"label"),S(13," Modelo "),x(14,"input",7),cn("ngModelChange",function(a){return fn(s.currentCoche.modelo,a)||(s.currentCoche.modelo=a),a}),C()()(),x(15,"div",6)(16,"label"),S(17," Kilometros "),x(18,"input",8),cn("ngModelChange",function(a){return fn(s.currentCoche.kilometros,a)||(s.currentCoche.kilometros=a),a}),C()()(),x(19,"div",6)(20,"label"),S(21," Transmision "),x(22,"select",9),cn("ngModelChange",function(a){return fn(s.currentCoche.transmision,a)||(s.currentCoche.transmision=a),a}),x(23,"option",10),S(24,"Manual"),C(),x(25,"option",11),S(26,"Automatica"),C()()()(),x(27,"div",6)(28,"label"),S(29," Precio "),x(30,"input",8),cn("ngModelChange",function(a){return fn(s.currentCoche.precio,a)||(s.currentCoche.precio=a),a}),C()()()(),x(31,"div",12),sn(32,f7,3,0,"div",4)(33,p7,3,0,"div",4)(34,g7,3,0,"div",4)(35,m7,3,0,"div",4)(36,_7,3,0,"div",4),C()(),x(37,"div",13)(38,"h2"),S(39,"Coches"),C(),sn(40,v7,19,1,"table",14)(41,x7,1,0,"app-loader",4),C()()()),i&2&&(G(4),Re("ngIf",s.state===s.MODES.create),G(),Re("ngIf",s.state===s.MODES.select),G(5),an("ngModel",s.currentCoche.marca),G(4),an("ngModel",s.currentCoche.modelo),G(4),an("ngModel",s.currentCoche.kilometros),G(4),an("ngModel",s.currentCoche.transmision),G(8),an("ngModel",s.currentCoche.precio),G(2),Re("ngIf",s.state===s.MODES.create),G(),Re("ngIf",s.state===s.MODES.select),G(),Re("ngIf",s.state===s.MODES.select),G(),Re("ngIf",s.state===s.MODES.select&&!s.currentCoche.vendido),G(),Re("ngIf",s.state===s.MODES.select),G(4),Re("ngIf",!s.isLoading),G(),Re("ngIf",s.isLoading))},dependencies:[ca,ua,rm,im,mc,id,yc,_c,go,vc]});let t=e;return t})();function w7(t,e){if(t&1){let n=qt();x(0,"tr",14)(1,"td"),S(2),C(),x(3,"td"),S(4),C(),x(5,"td"),S(6),C(),x(7,"td"),S(8),C(),x(9,"td"),S(10),C(),x(11,"td")(12,"button",15),Ve("click",function(){let i=$t(n).$implicit,s=ft(2);return Ht(s.setCurrentTransaccion(i))}),S(13,"Seleccionar"),C()()()}if(t&2){let n=e.$implicit;Ds("id",n.id),G(2),Dt(n.fecha),G(2),Dt(n.precio),G(2),Dt(n.metodoPago),G(2),Dt(n.coche),G(2),Dt(n.cliente)}}function E7(t,e){if(t&1&&(x(0,"table",12)(1,"thead")(2,"tr")(3,"th"),S(4,"Fecha"),C(),x(5,"th"),S(6,"Precio"),C(),x(7,"th"),S(8,"Metodo de Pago"),C(),x(9,"th"),S(10,"Coche"),C(),x(11,"th"),S(12,"Cliente"),C()()(),x(13,"tbody"),sn(14,w7,14,6,"tr",13),C()()),t&2){let n=ft();G(14),Re("ngForOf",n.transacciones)}}function I7(t,e){t&1&&on(0,"app-loader")}var Xk=(()=>{let e=class e{constructor(r){this.transaccionService=r,this.isLoading=!0,this.transacciones=[],this.currentTransaccion=new ks({fecha:new Date().toLocaleString(),precio:0,metodoPago:"",coche:"",cliente:"",tipo:""})}ngOnInit(){this.updateTransacciones()}updateTransacciones(){return g(this,null,function*(){this.isLoading=!0,this.transacciones=yield this.transaccionService.getTransacciones(),this.isLoading=!1})}updateTransaccion(){return g(this,null,function*(){yield this.transaccionService.updateTransaccion(this.currentTransaccion),this.resetCurrentTransaccion(),yield this.updateTransacciones()})}setCurrentTransaccion(r){this.currentTransaccion=r}resetCurrentTransaccion(){this.currentTransaccion=new ks({fecha:new Date().toLocaleString(),precio:0,metodoPago:"",coche:"",cliente:"",tipo:""})}};e.\u0275fac=function(i){return new(i||e)(re(Zg))},e.\u0275cmp=tn({type:e,selectors:[["app-transacciones"]],decls:23,vars:3,consts:[[1,"page"],[1,"row","reverse"],[1,"input-column"],[1,"input-row"],[3,"ngModelChange","ngModel"],["value","efectivo"],["value","credito"],["value","debito"],[1,"btn","upd",3,"click"],[1,"table-column"],["class","table",4,"ngIf"],[4,"ngIf"],[1,"table"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],[1,"btn","btn-primary",3,"click"]],template:function(i,s){i&1&&(x(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),S(4,"Actualizar transaccion"),C(),x(5,"div",3)(6,"label"),S(7," M\xE9todo de pago "),x(8,"select",4),cn("ngModelChange",function(a){return fn(s.currentTransaccion.metodoPago,a)||(s.currentTransaccion.metodoPago=a),a}),x(9,"option",5),S(10,"Efectivo"),C(),x(11,"option",6),S(12,"Credito"),C(),x(13,"option",7),S(14,"Debito"),C()()()(),x(15,"div")(16,"button",8),Ve("click",function(){return s.updateTransaccion()}),S(17,"Actualizar"),C()()(),x(18,"div",9)(19,"h2"),S(20,"Transacciones"),C(),sn(21,E7,15,1,"table",10)(22,I7,1,0,"app-loader",11),C()()()),i&2&&(G(8),an("ngModel",s.currentTransaccion.metodoPago),G(13),Re("ngIf",!s.isLoading),G(),Re("ngIf",s.isLoading))},dependencies:[ca,ua,rm,im,yc,_c,go,vc]});let t=e;return t})();var sd=class{constructor(e){this.id="",this.nombre="",this.apellidos="",this.email="",this.telefono="",this.coches=[],this.transacciones=[],this.nombre=e.nombre,this.apellidos=e.apellidos,this.email=e.email,this.telefono=e.telefono}};var Jk=(()=>{let e=class e{constructor(r){this.firestore=r}getClientes(){return g(this,null,function*(){return yield this.parseData(this.firestore.collection("clientes").snapshotChanges())})}getClienteById(r){return g(this,null,function*(){return(yield this.parseData(this.firestore.collection("clientes",s=>s.where("id","==",r)).snapshotChanges()))[0]})}parseData(r){let i=[];return new Promise(s=>{r.subscribe(o=>{i=o.map(a=>ue(A({},a.payload.doc.data()),{id:a.payload.doc.id})),s(i)})})}createCliente(r){return g(this,null,function*(){return yield this.firestore.collection("clientes").add(Object.assign({},r))})}updateCliente(r){return g(this,null,function*(){yield this.firestore.doc("clientes/"+r.id).update(r)})}deleteCliente(r){return g(this,null,function*(){yield this.firestore.doc("clientes/"+r).delete()})}addCoche(r,i){return g(this,null,function*(){let s=yield this.getClienteById(r);s.coches.push(i),yield this.updateCliente(s)})}removeCoche(r,i){return g(this,null,function*(){let s=yield this.getClienteById(r);s.coches=s.coches.filter(o=>o!==i),yield this.updateCliente(s)})}addTransaccion(r,i){return g(this,null,function*(){let s=yield this.getClienteById(r);s.transacciones.push(i),yield this.updateCliente(s)})}};e.\u0275fac=function(i){return new(i||e)(E(pc))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function b7(t,e){t&1&&(x(0,"h2"),S(1,"A\xF1adir cliente"),C())}function D7(t,e){t&1&&(x(0,"h2"),S(1,"Modificar cliente"),C())}function T7(t,e){if(t&1){let n=qt();x(0,"div")(1,"button",12),Ve("click",function(){$t(n);let i=ft();return Ht(i.createCliente())}),S(2,"A\xF1adir"),C()()}}function S7(t,e){if(t&1){let n=qt();x(0,"div")(1,"button",13),Ve("click",function(){$t(n);let i=ft();return Ht(i.updateCliente())}),S(2," Modificar "),C()()}}function A7(t,e){if(t&1){let n=qt();x(0,"div")(1,"button",14),Ve("click",function(){$t(n);let i=ft();return Ht(i.deleteCliente())}),S(2," Eliminar "),C()()}}function M7(t,e){if(t&1){let n=qt();x(0,"div")(1,"button",12),Ve("click",function(){$t(n);let i=ft();return Ht(i.resetCurrentCliente())}),S(2," A\xF1adir nuevo "),C()()}}function R7(t,e){if(t&1){let n=qt();x(0,"tr",17)(1,"td"),S(2),C(),x(3,"td"),S(4),C(),x(5,"td"),S(6),C(),x(7,"td"),S(8),C(),x(9,"td")(10,"button",18),Ve("click",function(){let i=$t(n).$implicit,s=ft(2);return Ht(s.setCurrentCliente(i))}),S(11," Editar "),C()()()}if(t&2){let n=e.$implicit;Ds("id",n.id),G(2),Dt(n.nombre),G(2),Dt(n.apellidos),G(2),Dt(n.email),G(2),Dt(n.telefono)}}function N7(t,e){if(t&1&&(x(0,"table",15)(1,"thead")(2,"tr")(3,"th"),S(4,"Nombre"),C(),x(5,"th"),S(6,"Apellidos"),C(),x(7,"th"),S(8,"Email"),C(),x(9,"th"),S(10,"Telefono"),C(),x(11,"th"),S(12,"Acciones"),C()()(),x(13,"tbody"),sn(14,R7,12,5,"tr",16),C()()),t&2){let n=ft();G(14),Re("ngForOf",n.clientes)}}function P7(t,e){t&1&&on(0,"app-loader")}var e2=(()=>{let e=class e{constructor(r){this.clienteService=r,this.isLoading=!0,this.state=Qn.create,this.MODES=Qn,this.clientes=[],this.currentCliente=new sd({nombre:"",apellidos:"",email:"",telefono:""})}ngOnInit(){this.updateClientes()}updateClientes(){return g(this,null,function*(){this.isLoading=!0,this.clientes=yield this.clienteService.getClientes(),this.isLoading=!1})}createCliente(){return g(this,null,function*(){yield this.clienteService.createCliente(this.currentCliente),this.resetCurrentCliente(),yield this.updateClientes()})}updateCliente(){return g(this,null,function*(){yield this.clienteService.updateCliente(this.currentCliente),this.resetCurrentCliente(),yield this.updateClientes()})}deleteCliente(){return g(this,null,function*(){yield this.clienteService.deleteCliente(this.currentCliente.id),yield this.updateClientes()})}setCurrentCliente(r){this.currentCliente=r,this.state=Qn.select}resetCurrentCliente(){this.currentCliente=new sd({nombre:"",apellidos:"",email:"",telefono:""}),this.state=Qn.create}};e.\u0275fac=function(i){return new(i||e)(re(Jk))},e.\u0275cmp=tn({type:e,selectors:[["app-clientes"]],decls:33,vars:12,consts:[[1,"page"],[1,"row"],[1,"input-column"],[1,"container-title"],[4,"ngIf"],[1,"container"],[1,"input-row"],["type","text",3,"ngModelChange","ngModel"],["type","number",3,"ngModelChange","ngModel"],[1,"container","botones"],[1,"table-column"],["class","table",4,"ngIf"],[1,"btn","add",3,"click"],[1,"btn","mod",3,"click"],[1,"btn","del",3,"click"],[1,"table"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],[1,"btn","btn-primary",3,"click"]],template:function(i,s){i&1&&(x(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),sn(4,b7,2,0,"h2",4)(5,D7,2,0,"h2",4),C(),x(6,"div",5)(7,"div",6)(8,"label"),S(9," Nombre "),x(10,"input",7),cn("ngModelChange",function(a){return fn(s.currentCliente.nombre,a)||(s.currentCliente.nombre=a),a}),C()()(),x(11,"div",6)(12,"label"),S(13," Apellidos "),x(14,"input",7),cn("ngModelChange",function(a){return fn(s.currentCliente.apellidos,a)||(s.currentCliente.apellidos=a),a}),C()()(),x(15,"div",6)(16,"label"),S(17," Email "),x(18,"input",7),cn("ngModelChange",function(a){return fn(s.currentCliente.email,a)||(s.currentCliente.email=a),a}),C()()(),x(19,"div",6)(20,"label"),S(21," Telefono "),x(22,"input",8),cn("ngModelChange",function(a){return fn(s.currentCliente.telefono,a)||(s.currentCliente.telefono=a),a}),C()()(),x(23,"div",9),sn(24,T7,3,0,"div",4)(25,S7,3,0,"div",4)(26,A7,3,0,"div",4)(27,M7,3,0,"div",4),C()()(),x(28,"div",10)(29,"h2"),S(30,"Clientes"),C(),sn(31,N7,15,1,"table",11)(32,P7,1,0,"app-loader",4),C()()()),i&2&&(G(4),Re("ngIf",s.state===s.MODES.create),G(),Re("ngIf",s.state===s.MODES.select),G(5),an("ngModel",s.currentCliente.nombre),G(4),an("ngModel",s.currentCliente.apellidos),G(4),an("ngModel",s.currentCliente.email),G(4),an("ngModel",s.currentCliente.telefono),G(2),Re("ngIf",s.state===s.MODES.create),G(),Re("ngIf",s.state===s.MODES.select),G(),Re("ngIf",s.state===s.MODES.select),G(),Re("ngIf",s.state===s.MODES.select),G(4),Re("ngIf",!s.isLoading),G(),Re("ngIf",s.isLoading))},dependencies:[ca,ua,mc,id,_c,go,vc]});let t=e;return t})();var k7=[{path:"home",component:Ev},{path:"coches",component:Zk},{path:"transacciones",component:Xk},{path:"clientes",component:e2},{path:"**",component:Ev}],t2=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=tt({type:e}),e.\u0275inj=et({imports:[wv.forRoot(k7),wv]});let t=e;return t})();var n2={production:!1,firebaseConfig:{apiKey:"AIzaSyAMKh_kgg0H6tNsbFMzG6bnrUO_GXcEPZU",authDomain:"car-b8820.firebaseapp.com",projectId:"car-b8820",storageBucket:"car-b8820.appspot.com",messagingSenderId:"312572004386",appId:"1:312572004386:web:78a5bf3d16d316157b227b"}};var r2="@firebase/database",i2="1.0.4";var LC="";function jC(t){LC=t}var kI=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ze(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:qd(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var OI=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return In(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var O2=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new kI(e)}}catch{}return new OI},_o=O2("localStorage"),FI=O2("sessionStorage");var Ic=new li("@firebase/database"),F2=function(){let t=1;return function(){return t++}}(),V2=function(t){let e=Pb(t),n=new Nb;n.update(e);let r=n.digest();return Ud.encodeByteArray(r)},Ad=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Ad.apply(null,r):typeof r=="object"?e+=Ze(r):e+=r,e+=" "}return e},yo=null,s2=!0,L2=function(t,e){D(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Ic.logLevel=Cn.VERBOSE,yo=Ic.log.bind(Ic),e&&FI.set("logging_enabled",!0)):typeof t=="function"?yo=t:(yo=null,FI.remove("logging_enabled"))},vt=function(...t){if(s2===!0&&(s2=!1,yo===null&&FI.get("logging_enabled")===!0&&L2(!0)),yo){let e=Ad.apply(null,t);yo(e)}},Md=function(t){return function(...e){vt(t,...e)}},VI=function(...t){let e="FIREBASE INTERNAL ERROR: "+Ad(...t);Ic.error(e)},kr=function(...t){let e=`FIREBASE FATAL ERROR: ${Ad(...t)}`;throw Ic.error(e),new Error(e)},Ft=function(...t){let e="FIREBASE WARNING: "+Ad(...t);Ic.warn(e)},O7=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Ft("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Nm=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},F7=function(t){if(sr()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},ts="[MIN_NAME]",ai="[MAX_NAME]",xo=function(t,e){if(t===e)return 0;if(t===ts||e===ai)return-1;if(e===ts||t===ai)return 1;{let n=o2(t),r=o2(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},V7=function(t,e){return t===e?0:t<e?-1:1},od=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Ze(e))},BC=function(t){if(typeof t!="object"||t===null)return Ze(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=Ze(e[r]),n+=":",n+=BC(t[e[r]]);return n+="}",n},j2=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function xt(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var B2=function(t){D(!Nm(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,c;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let u=[];for(c=n;c;c-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(i?1:0),u.reverse();let l=u.join(""),d="";for(c=0;c<64;c+=8){let h=parseInt(l.substr(c,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},L7=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},j7=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function B7(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var U7=new RegExp("^-?(0*)\\d{1,10}$"),$7=-2147483648,H7=2147483647,o2=function(t){if(U7.test(t)){let e=Number(t);if(e>=$7&&e<=H7)return e}return null},Nc=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw Ft("Exception was thrown by user callback.",n),e},Math.floor(0))}},q7=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},ld=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var LI=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Ft(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var jI=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(vt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ft(e)}},dd=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),om="5",U2="v",$2="s",H2="r",q2="f",G2=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,z2="ls",W2="p",BI="ac",K2="websocket",Q2="long_polling";var am=class{constructor(e,n,r,i,s=!1,o="",a=!1,c=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=_o.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&_o.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function G7(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function Y2(t,e,n){D(typeof e=="string","typeof type must == string"),D(typeof n=="object","typeof params must == object");let r;if(e===K2)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===Q2)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);G7(t)&&(n.ns=t.namespace);let i=[];return xt(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var UI=class{constructor(){this.counters_={}}incrementCounter(e,n=1){In(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return bb(this.counters_)}};var TI={},SI={};function UC(t){let e=t.toString();return TI[e]||(TI[e]=new UI),TI[e]}function z7(t,e){let n=t.toString();return SI[n]||(SI[n]=e()),SI[n]}var $I=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Nc(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var a2="start",W7="close",K7="pLPCommand",Q7="pRTLPCB",Z2="id",X2="pw",J2="ser",Y7="cb",Z7="seg",X7="ts",J7="d",eH="dframe",eO=1870,tO=30,tH=eO-tO,nH=25e3,rH=3e4,gd=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Md(e),this.stats_=UC(n),this.urlFn=c=>(this.appCheckToken&&(c[BI]=this.appCheckToken),Y2(n,Q2,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new $I(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(rH)),F7(()=>{if(this.isClosed_)return;this.scriptTagHolder=new HI((...s)=>{let[o,a,c,u,l]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===a2)this.id=a,this.password=c;else if(o===W7)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[a2]="t",r[J2]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[Y7]=this.scriptTagHolder.uniqueCallbackIdentifier),r[U2]=om,this.transportSessionId&&(r[$2]=this.transportSessionId),this.lastSessionId&&(r[z2]=this.lastSessionId),this.applicationId&&(r[W2]=this.applicationId),this.appCheckToken&&(r[BI]=this.appCheckToken),typeof location<"u"&&location.hostname&&G2.test(location.hostname)&&(r[H2]=q2);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return sr()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!L7()&&!j7()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=Ze(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=Cb(n),i=j2(r,tH);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(sr())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[eH]="t",r[Z2]=e,r[X2]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=Ze(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},HI=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,sr())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=F2(),window[K7+this.uniqueCallbackIdentifier]=e,window[Q7+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){vt("frame writing exception"),a.stack&&vt(a.stack),vt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||vt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[Z2]=this.myID,e[X2]=this.myPW,e[J2]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+tO+r.length<=eO;){let o=this.pendingSegs.shift();r=r+"&"+Z7+i+"="+o.seg+"&"+X7+i+"="+o.ts+"&"+J7+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(nH)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){sr()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{vt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var iH=16384,sH=45e3,cm=null;typeof MozWebSocket<"u"?cm=MozWebSocket:typeof WebSocket<"u"&&(cm=WebSocket);var wc=(()=>{class t{constructor(n,r,i,s,o,a,c){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Md(this.connId),this.stats_=UC(r),this.connURL=t.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[U2]=om,!sr()&&typeof location<"u"&&location.hostname&&G2.test(location.hostname)&&(a[H2]=q2),r&&(a[$2]=r),i&&(a[z2]=i),s&&(a[BI]=s),o&&(a[W2]=o),Y2(n,K2,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,_o.set("previous_websocket_failure",!0);try{let i;if(sr()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${om}/${LC}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new cm(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&cm!==null&&!t.forceDisallow_}static previouslyFailed(){return _o.isInMemoryStorage||_o.get("previous_websocket_failure")===!0}markConnectionHealthy(){_o.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=qd(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(D(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=Ze(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=j2(r,iH);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(sH))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),nO=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[gd,wc]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=wc&&wc.isAvailable(),i=r&&!wc.previouslyFailed();if(n.webSocketOnly&&(r||Ft("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[wc];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),oH=6e4,aH=5e3,cH=10*1024,uH=100*1024,AI="t",c2="d",lH="s",u2="r",dH="e",l2="o",d2="a",h2="n",f2="p",hH="h",qI=class{constructor(e,n,r,i,s,o,a,c,u,l){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Md("c:"+this.id+":"),this.transportManager_=new nO(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=ld(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>uH?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>cH?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(AI in e){let n=e[AI];n===d2?this.upgradeIfSecondaryHealthy_():n===u2?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===l2&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=od("t",e),r=od("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:f2,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:d2,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:h2,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=od("t",e),r=od("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=od(AI,e);if(c2 in e){let r=e[c2];if(n===hH){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===h2){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===lH?this.onConnectionShutdown_(r):n===u2?this.onReset_(r):n===dH?VI("Server Error: "+r):n===l2?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):VI("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),om!==r&&Ft("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),ld(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(oH))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ld(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(aH))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:f2,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(_o.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var um=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var lm=class{constructor(e){this.allowedEvents_=e,this.listeners_={},D(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){D(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var dm=class t extends lm{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Jm()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return D(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var p2=32,g2=768,xe=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function ve(){return new xe("")}function se(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function ns(t){return t.pieces_.length-t.pieceNum_}function Ae(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new xe(t.pieces_,e)}function $C(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function fH(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function md(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function rO(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new xe(e,0)}function je(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof xe)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new xe(n,0)}function oe(t){return t.pieceNum_>=t.pieces_.length}function Qt(t,e){let n=se(t),r=se(e);if(n===null)return e;if(n===r)return Qt(Ae(t),Ae(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function pH(t,e){let n=md(t,0),r=md(e,0);for(let i=0;i<n.length&&i<r.length;i++){let s=xo(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function HC(t,e){if(ns(t)!==ns(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Vn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(ns(t)>ns(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var GI=class{constructor(e,n){this.errorPrefix_=n,this.parts_=md(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=jc(this.parts_[r]);iO(this)}};function gH(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=jc(e),iO(t)}function mH(t){let e=t.parts_.pop();t.byteLength_-=jc(e),t.parts_.length>0&&(t.byteLength_-=1)}function iO(t){if(t.byteLength_>g2)throw new Error(t.errorPrefix_+"has a key path longer than "+g2+" bytes ("+t.byteLength_+").");if(t.parts_.length>p2)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+p2+") or object contains a cycle "+mo(t))}function mo(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var zI=class t extends lm{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return D(e==="visible","Unknown event type: "+e),[this.visible_]}};var ad=1e3,_H=60*5*1e3,m2=30*1e3,yH=1.3,vH=3e4,xH="server_kill",_2=3,qC=(()=>{class t extends um{constructor(n,r,i,s,o,a,c,u){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=u,this.id=t.nextPersistentConnectionId_++,this.log_=Md("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ad,this.maxReconnectDelay_=_H,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!sr())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");zI.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&dm.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(Ze(o)),D(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new ht,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),D(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),D(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,c=>{let u=c.d,l=c.s;t.warnOnListenWarnings_(u,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",c),l!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(l,u))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&In(n,"w")){let i=ui(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Ft(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||Mb(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=m2)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=Ab(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),D(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+Ze(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):VI("Unrecognized action received from server: "+Ze(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){D(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ad,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=ad,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>vH&&(this.reconnectDelay_=ad),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*yH)}this.onConnectStatus_(!1)}establishConnection_(){return g(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,u=function(){c?c.close():(a=!0,i())},l=function(h){D(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(h)};this.realtime_={close:u,sendRequest:l};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?vt("getToken() completed but was canceled"):(vt("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,c=new qI(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,p=>{Ft(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(xH)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&Ft(h),u())}}})}interrupt(n){vt("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){vt("Resuming connection for reason: "+n),delete this.interruptReasons_[n],Gd(this.interruptReasons_)&&(this.reconnectDelay_=ad,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>BC(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new xe(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){vt("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=_2&&(this.reconnectDelay_=m2,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){vt("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=_2&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";sr()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+LC.replace(/\./g,"-")]=1,Jm()?n["framework.cordova"]=1:Db()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=dm.getInstance().currentlyOnline();return Gd(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),ce=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var Cc=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new ce(ts,e),i=new ce(ts,n);return this.compare(r,i)!==0}minPost(){return ce.MIN}};var sm,hm=class extends Cc{static get __EMPTY_NODE(){return sm}static set __EMPTY_NODE(e){sm=e}compare(e,n){return xo(e.name,n.name)}isDefinedOn(e){throw bo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ce.MIN}maxPost(){return new ce(ai,sm)}makePost(e,n){return D(typeof e=="string","KeyIndex indexValue must always be a string."),new ce(e,sm)}toString(){return".key"}},Pr=new hm;var Ec=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},rr=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??Ln.EMPTY_NODE,this.right=o??Ln.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ln.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return Ln.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),WI=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new rr(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Ln=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,rr.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,rr.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ec(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Ec(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Ec(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Ec(this.root_,null,this.comparator_,!0,e)}};Ln.EMPTY_NODE=new WI;function wH(t,e){return xo(t.name,e.name)}function GC(t,e){return xo(t,e)}var KI;function EH(t){KI=t}var sO=function(t){return typeof t=="number"?"number:"+B2(t):"string:"+t},oO=function(t){if(t.isLeafNode()){let e=t.val();D(typeof e=="string"||typeof e=="number"||typeof e=="object"&&In(e,".sv"),"Priority must be a string or number.")}else D(t===KI||t.isEmpty(),"priority of unexpected type.");D(t===KI||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var y2,bc=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,D(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),oO(this.priorityNode_)}static set __childrenNodeConstructor(n){y2=n}static get __childrenNodeConstructor(){return y2}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return oe(n)?this:se(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=se(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(D(i!==".priority"||ns(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ae(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+sO(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=B2(this.value_):n+=this.value_,this.lazyHash_=V2(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(D(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return D(s>=0,"Unknown leaf type: "+r),D(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),aO,cO;function IH(t){aO=t}function CH(t){cO=t}var QI=class extends Cc{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?xo(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ce.MIN}maxPost(){return new ce(ai,new bc("[PRIORITY-POST]",cO))}makePost(e,n){let r=aO(e);return new ce(n,new bc("[PRIORITY-POST]",r))}toString(){return".priority"}},Pe=new QI;var bH=Math.log(2),YI=class{constructor(e){let n=s=>parseInt(Math.log(s)/bH,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},fm=function(t,e,n,r){t.sort(e);let i=function(c,u){let l=u-c,d,h;if(l===0)return null;if(l===1)return d=t[c],h=n?n(d):d,new rr(h,d.node,rr.BLACK,null,null);{let f=parseInt(l/2,10)+c,p=i(c,f),m=i(f+1,u);return d=t[f],h=n?n(d):d,new rr(h,d.node,rr.BLACK,p,m)}},s=function(c){let u=null,l=null,d=t.length,h=function(p,m){let v=d-p,b=d;d-=p;let F=i(v+1,b),T=t[v],H=n?n(T):T;f(new rr(H,T.node,m,null,F))},f=function(p){u?(u.left=p,u=p):(l=p,u=p)};for(let p=0;p<c.count;++p){let m=c.nextBitIsOne(),v=Math.pow(2,c.count-(p+1));m?h(v,rr.BLACK):(h(v,rr.BLACK),h(v,rr.RED))}return l},o=new YI(t.length),a=s(o);return new Ln(r||e,a)};var MI,xc={},Dc=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return D(xc&&Pe,"ChildrenNode.ts has not been loaded"),MI=MI||new t({".priority":xc},{".priority":Pe}),MI}get(e){let n=ui(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Ln?n:null}hasIndex(e){return In(this.indexSet_,e.toString())}addIndex(e,n){D(e!==Pr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(ce.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=fm(r,e.getCompare()):a=xc;let c=e.toString(),u=Object.assign({},this.indexSet_);u[c]=e;let l=Object.assign({},this.indexes_);return l[c]=a,new t(l,u)}addToIndexes(e,n){let r=Lc(this.indexes_,(i,s)=>{let o=ui(this.indexSet_,s);if(D(o,"Missing index implementation for "+s),i===xc)if(o.isDefinedOn(e.node)){let a=[],c=n.getIterator(ce.Wrap),u=c.getNext();for(;u;)u.name!==e.name&&a.push(u),u=c.getNext();return a.push(e),fm(a,o.getCompare())}else return xc;else{let a=n.get(e.name),c=i;return a&&(c=c.remove(new ce(e.name,a))),c.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=Lc(this.indexes_,i=>{if(i===xc)return i;{let s=n.get(e.name);return s?i.remove(new ce(e.name,s)):i}});return new t(r,this.indexSet_)}};var cd,ee=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&oO(this.priorityNode_),this.children_.isEmpty()&&D(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return cd||(cd=new t(new Ln(GC),null,Dc.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||cd}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?cd:r}}getChild(n){let r=se(n);return r===null?this:this.getImmediateChild(r).getChild(Ae(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(D(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new ce(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?cd:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=se(n);if(i===null)return r;{D(se(n)!==".priority"||ns(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Ae(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Pe,(a,c)=>{r[a]=c.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+sO(this.getPriority().val())+":"),this.forEachChild(Pe,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":V2(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new ce(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new ce(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new ce(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,ce.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,ce.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===Rd?-1:0}withIndex(n){if(n===Pr||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===Pr||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Pe),s=r.getIterator(Pe),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===Pr?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),ZI=class extends ee{constructor(){super(new Ln(GC),ee.EMPTY_NODE,Dc.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ee.EMPTY_NODE}isEmpty(){return!1}},Rd=new ZI;Object.defineProperties(ce,{MIN:{value:new ce(ts,ee.EMPTY_NODE)},MAX:{value:new ce(ai,Rd)}});hm.__EMPTY_NODE=ee.EMPTY_NODE;bc.__childrenNodeConstructor=ee;EH(Rd);CH(Rd);var DH=!0;function Ue(t,e=null){if(t===null)return ee.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),D(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new bc(n,Ue(e))}if(!(t instanceof Array)&&DH){let n=[],r=!1;if(xt(t,(o,a)=>{if(o.substring(0,1)!=="."){let c=Ue(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),n.push(new ce(o,c)))}}),n.length===0)return ee.EMPTY_NODE;let s=fm(n,wH,o=>o.name,GC);if(r){let o=fm(n,Pe.getCompare());return new ee(s,Ue(e),new Dc({".priority":o},{".priority":Pe}))}else return new ee(s,Ue(e),Dc.Default)}else{let n=ee.EMPTY_NODE;return xt(t,(r,i)=>{if(In(t,r)&&r.substring(0,1)!=="."){let s=Ue(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(Ue(e))}}IH(Ue);var _d=class extends Cc{constructor(e){super(),this.indexPath_=e,D(!oe(e)&&se(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?xo(e.name,n.name):s}makePost(e,n){let r=Ue(e),i=ee.EMPTY_NODE.updateChild(this.indexPath_,r);return new ce(n,i)}maxPost(){let e=ee.EMPTY_NODE.updateChild(this.indexPath_,Rd);return new ce(ai,e)}toString(){return md(this.indexPath_,0).join("/")}};var XI=class extends Cc{compare(e,n){let r=e.node.compareTo(n.node);return r===0?xo(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ce.MIN}maxPost(){return ce.MAX}makePost(e,n){let r=Ue(e);return new ce(n,r)}toString(){return".value"}},zC=new XI;function uO(t){return{type:"value",snapshotNode:t}}function Tc(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function yd(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function vd(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function TH(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var xd=class{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){D(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(yd(n,a)):D(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Tc(n,r)):o.trackChildChange(vd(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Pe,(i,s)=>{n.hasChild(i)||r.trackChildChange(yd(i,s))}),n.isLeafNode()||n.forEachChild(Pe,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(vd(i,s,o))}else r.trackChildChange(Tc(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?ee.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var pm=class t{constructor(e){this.indexedFilter_=new xd(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new ce(n,r))||(r=ee.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=ee.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(ee.EMPTY_NODE);let s=this;return n.forEachChild(Pe,(o,a)=>{s.matches(new ce(o,a))||(i=i.updateImmediateChild(o,ee.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var JI=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{let r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new pm(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new ce(n,r))||(r=ee.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=ee.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=ee.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(ee.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,ee.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();let a=e;D(a.numChildren()===this.limit_,"");let c=new ce(n,r),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),l=this.rangedFilter_.matches(c);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=i.getChildAfterChild(this.index_,u,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);let f=h==null?1:o(h,c);if(l&&!r.isEmpty()&&f>=0)return s?.trackChildChange(vd(n,r,d)),a.updateImmediateChild(n,r);{s?.trackChildChange(yd(n,d));let m=a.updateImmediateChild(n,ee.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(Tc(h.name,h.node)),m.updateImmediateChild(h.name,h.node)):m}}else return r.isEmpty()?e:l&&o(u,c)>=0?(s!=null&&(s.trackChildChange(yd(u.name,u.node)),s.trackChildChange(Tc(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(u.name,ee.EMPTY_NODE)):e}};var wd=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Pe}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return D(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return D(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ts}hasEnd(){return this.endSet_}getIndexEndValue(){return D(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return D(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ai}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return D(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Pe}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function SH(t){return t.loadsAllData()?new xd(t.getIndex()):t.hasLimit()?new JI(t):new pm(t)}function AH(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function MH(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function eC(t,e,n){let r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function RH(t,e,n){let r;return t.index_===Pr||n?r=eC(t,e,n):r=eC(t,e,ai),r.startAfterSet_=!0,r}function tC(t,e,n){let r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function NH(t,e,n){let r;return t.index_===Pr||n?r=tC(t,e,n):r=tC(t,e,ts),r.endBeforeSet_=!0,r}function Pm(t,e){let n=t.copy();return n.index_=e,n}function v2(t){let e={};if(t.isDefault())return e;let n;if(t.index_===Pe?n="$priority":t.index_===zC?n="$value":t.index_===Pr?n="$key":(D(t.index_ instanceof _d,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Ze(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=Ze(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+Ze(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=Ze(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+Ze(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function x2(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Pe&&(e.i=t.index_.toString()),e}var nC=class t extends um{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Md("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(D(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let c=v2(e._queryParams);this.restRequest_(s+".json",c,(u,l)=>{let d=l;if(u===404&&(d=null,u=null),u===null&&this.onDataUpdate_(s,d,!1,r),ui(this.listens_,o)===a){let h;u?u===401?h="permission_denied":h="rest_error:"+u:h="ok",i(h,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=v2(e._queryParams),r=e._path.toString(),i=new ht;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Rb(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=qd(a.responseText)}catch{Ft("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&Ft("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var rC=class{constructor(){this.rootNode_=ee.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function gm(){return{value:null,children:new Map}}function Pc(t,e,n){if(oe(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=se(e);t.children.has(r)||t.children.set(r,gm());let i=t.children.get(r);e=Ae(e),Pc(i,e,n)}}function iC(t,e){if(oe(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(Pe,(r,i)=>{Pc(t,new xe(r),i)}),iC(t,e)}}else if(t.children.size>0){let n=se(e);return e=Ae(e),t.children.has(n)&&iC(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function sC(t,e,n){t.value!==null?n(e,t.value):PH(t,(r,i)=>{let s=new xe(e.toString()+"/"+r);sC(i,s,n)})}function PH(t,e){t.children.forEach((n,r)=>{e(r,n)})}var oC=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&xt(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var w2=10*1e3,kH=30*1e3,OH=5*60*1e3,aC=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new oC(e);let r=w2+(kH-w2)*Math.random();ld(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;xt(e,(i,s)=>{s>0&&In(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),ld(this.reportStats_.bind(this),Math.floor(Math.random()*2*OH))}};var Nr=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(Nr||{});function WC(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function KC(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function QC(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var cC=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Nr.ACK_USER_WRITE,this.source=WC()}operationForChild(e){if(oe(this.path)){if(this.affectedTree.value!=null)return D(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new xe(e));return new t(ve(),n,this.revert)}}else return D(se(this.path)===e,"operationForChild called for unrelated child."),new t(Ae(this.path),this.affectedTree,this.revert)}};var mm=class t{constructor(e,n){this.source=e,this.path=n,this.type=Nr.LISTEN_COMPLETE}operationForChild(e){return oe(this.path)?new t(this.source,ve()):new t(this.source,Ae(this.path))}};var Sc=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Nr.OVERWRITE}operationForChild(e){return oe(this.path)?new t(this.source,ve(),this.snap.getImmediateChild(e)):new t(this.source,Ae(this.path),this.snap)}};var Ed=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Nr.MERGE}operationForChild(e){if(oe(this.path)){let n=this.children.subtree(new xe(e));return n.isEmpty()?null:n.value?new Sc(this.source,ve(),n.value):new t(this.source,ve(),n)}else return D(se(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,Ae(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Or=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(oe(e))return this.isFullyInitialized()&&!this.filtered_;let n=se(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var uC=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function FH(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(TH(o.childName,o.snapshotNode))}),ud(t,i,"child_removed",e,r,n),ud(t,i,"child_added",e,r,n),ud(t,i,"child_moved",s,r,n),ud(t,i,"child_changed",e,r,n),ud(t,i,"value",e,r,n),i}function ud(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,c)=>LH(t,a,c)),o.forEach(a=>{let c=VH(t,a,s);i.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(c,t.query_))})})}function VH(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function LH(t,e,n){if(e.childName==null||n.childName==null)throw bo("Should only compare child_ events.");let r=new ce(e.childName,e.snapshotNode),i=new ce(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function km(t,e){return{eventCache:t,serverCache:e}}function hd(t,e,n,r){return km(new Or(e,n,r),t.serverCache)}function lO(t,e,n,r){return km(t.eventCache,new Or(e,n,r))}function _m(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function vo(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var RI,jH=()=>(RI||(RI=new Ln(V7)),RI),Yt=class t{constructor(e,n=jH()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return xt(e,(r,i)=>{n=n.set(new xe(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:ve(),value:this.value};if(oe(e))return null;{let r=se(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Ae(e),n);return s!=null?{path:je(new xe(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(oe(e))return this;{let n=se(e),r=this.children.get(n);return r!==null?r.subtree(Ae(e)):new t(null)}}set(e,n){if(oe(e))return new t(n,this.children);{let r=se(e),s=(this.children.get(r)||new t(null)).set(Ae(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(oe(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=se(e),r=this.children.get(n);if(r){let i=r.remove(Ae(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(oe(e))return this.value;{let n=se(e),r=this.children.get(n);return r?r.get(Ae(e)):null}}setTree(e,n){if(oe(e))return n;{let r=se(e),s=(this.children.get(r)||new t(null)).setTree(Ae(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(ve(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(je(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,ve(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(oe(e))return null;{let s=se(e),o=this.children.get(s);return o?o.findOnPath_(Ae(e),je(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,ve(),n)}foreachOnPath_(e,n,r){if(oe(e))return this;{this.value&&r(n,this.value);let i=se(e),s=this.children.get(i);return s?s.foreachOnPath_(Ae(e),je(n,i),r):new t(null)}}foreach(e){this.foreach_(ve(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(je(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var ir=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new Yt(null))}};function fd(t,e,n){if(oe(e))return new ir(new Yt(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=Qt(i,e);return s=s.updateChild(o,n),new ir(t.writeTree_.set(i,s))}else{let i=new Yt(n),s=t.writeTree_.setTree(e,i);return new ir(s)}}}function lC(t,e,n){let r=t;return xt(n,(i,s)=>{r=fd(r,je(e,i),s)}),r}function E2(t,e){if(oe(e))return ir.empty();{let n=t.writeTree_.setTree(e,new Yt(null));return new ir(n)}}function dC(t,e){return wo(t,e)!=null}function wo(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Qt(n.path,e)):null}function I2(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Pe,(r,i)=>{e.push(new ce(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ce(r,i.value))}),e}function Ji(t,e){if(oe(e))return t;{let n=wo(t,e);return n!=null?new ir(new Yt(n)):new ir(t.writeTree_.subtree(e))}}function hC(t){return t.writeTree_.isEmpty()}function Ac(t,e){return dO(ve(),t.writeTree_,e)}function dO(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(D(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=dO(je(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(je(t,".priority"),r)),n}}function Om(t,e){return gO(e,t)}function BH(t,e,n,r,i){D(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=fd(t.visibleWrites,e,n)),t.lastWriteId=r}function UH(t,e,n,r){D(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=lC(t.visibleWrites,e,n),t.lastWriteId=r}function $H(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function HH(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);D(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&qH(a,r.path)?i=!1:Vn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return GH(t),!0;if(r.snap)t.visibleWrites=E2(t.visibleWrites,r.path);else{let a=r.children;xt(a,c=>{t.visibleWrites=E2(t.visibleWrites,je(r.path,c))})}return!0}else return!1}function qH(t,e){if(t.snap)return Vn(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&Vn(je(t.path,n),e))return!0;return!1}function GH(t){t.visibleWrites=hO(t.allWrites,zH,ve()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function zH(t){return t.visible}function hO(t,e,n){let r=ir.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)Vn(n,o)?(a=Qt(n,o),r=fd(r,a,s.snap)):Vn(o,n)&&(a=Qt(o,n),r=fd(r,ve(),s.snap.getChild(a)));else if(s.children){if(Vn(n,o))a=Qt(n,o),r=lC(r,a,s.children);else if(Vn(o,n))if(a=Qt(o,n),oe(a))r=lC(r,ve(),s.children);else{let c=ui(s.children,se(a));if(c){let u=c.getChild(Ae(a));r=fd(r,ve(),u)}}}else throw bo("WriteRecord should have .snap or .children")}}return r}function fO(t,e,n,r,i){if(!r&&!i){let s=wo(t.visibleWrites,e);if(s!=null)return s;{let o=Ji(t.visibleWrites,e);if(hC(o))return n;if(n==null&&!dC(o,ve()))return null;{let a=n||ee.EMPTY_NODE;return Ac(o,a)}}}else{let s=Ji(t.visibleWrites,e);if(!i&&hC(s))return n;if(!i&&n==null&&!dC(s,ve()))return null;{let o=function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&(Vn(u.path,e)||Vn(e,u.path))},a=hO(t.allWrites,o,e),c=n||ee.EMPTY_NODE;return Ac(a,c)}}}function WH(t,e,n){let r=ee.EMPTY_NODE,i=wo(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Pe,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=Ji(t.visibleWrites,e);return n.forEachChild(Pe,(o,a)=>{let c=Ac(Ji(s,new xe(o)),a);r=r.updateImmediateChild(o,c)}),I2(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=Ji(t.visibleWrites,e);return I2(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function KH(t,e,n,r,i){D(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=je(e,n);if(dC(t.visibleWrites,s))return null;{let o=Ji(t.visibleWrites,s);return hC(o)?i.getChild(n):Ac(o,i.getChild(n))}}function QH(t,e,n,r){let i=je(e,n),s=wo(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=Ji(t.visibleWrites,i);return Ac(o,r.getNode().getImmediateChild(n))}else return null}function YH(t,e){return wo(t.visibleWrites,e)}function ZH(t,e,n,r,i,s,o){let a,c=Ji(t.visibleWrites,e),u=wo(c,ve());if(u!=null)a=u;else if(n!=null)a=Ac(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let l=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),f=h.getNext();for(;f&&l.length<i;)d(f,r)!==0&&l.push(f),f=h.getNext();return l}else return[]}function XH(){return{visibleWrites:ir.empty(),allWrites:[],lastWriteId:-1}}function ym(t,e,n,r){return fO(t.writeTree,t.treePath,e,n,r)}function YC(t,e){return WH(t.writeTree,t.treePath,e)}function C2(t,e,n,r){return KH(t.writeTree,t.treePath,e,n,r)}function vm(t,e){return YH(t.writeTree,je(t.treePath,e))}function JH(t,e,n,r,i,s){return ZH(t.writeTree,t.treePath,e,n,r,i,s)}function ZC(t,e,n){return QH(t.writeTree,t.treePath,e,n)}function pO(t,e){return gO(je(t.treePath,e),t.writeTree)}function gO(t,e){return{treePath:t,writeTree:e}}var fC=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;D(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),D(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,vd(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,yd(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,Tc(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,vd(r,e.snapshotNode,i.oldSnap));else throw bo("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var pC=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},mO=new pC,Id=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new Or(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return ZC(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:vo(this.viewCache_),s=JH(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function eq(t){return{filter:t}}function tq(t,e){D(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),D(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function nq(t,e,n,r,i){let s=new fC,o,a;if(n.type===Nr.OVERWRITE){let u=n;u.source.fromUser?o=gC(t,e,u.path,u.snap,r,i,s):(D(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!oe(u.path),o=xm(t,e,u.path,u.snap,r,i,a,s))}else if(n.type===Nr.MERGE){let u=n;u.source.fromUser?o=iq(t,e,u.path,u.children,r,i,s):(D(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=mC(t,e,u.path,u.children,r,i,a,s))}else if(n.type===Nr.ACK_USER_WRITE){let u=n;u.revert?o=aq(t,e,u.path,r,i,s):o=sq(t,e,u.path,u.affectedTree,r,i,s)}else if(n.type===Nr.LISTEN_COMPLETE)o=oq(t,e,n.path,r,s);else throw bo("Unknown operation type: "+n.type);let c=s.getChanges();return rq(e,o,c),{viewCache:o,changes:c}}function rq(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=_m(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(uO(_m(e)))}}function _O(t,e,n,r,i,s){let o=e.eventCache;if(vm(r,n)!=null)return e;{let a,c;if(oe(n))if(D(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let u=vo(e),l=u instanceof ee?u:ee.EMPTY_NODE,d=YC(r,l);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let u=ym(r,vo(e));a=t.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{let u=se(n);if(u===".priority"){D(ns(n)===1,"Can't have a priority with additional path components");let l=o.getNode();c=e.serverCache.getNode();let d=C2(r,n,l,c);d!=null?a=t.filter.updatePriority(l,d):a=o.getNode()}else{let l=Ae(n),d;if(o.isCompleteForChild(u)){c=e.serverCache.getNode();let h=C2(r,n,o.getNode(),c);h!=null?d=o.getNode().getImmediateChild(u).updateChild(l,h):d=o.getNode().getImmediateChild(u)}else d=ZC(r,u,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),u,d,l,i,s):a=o.getNode()}}return hd(e,a,o.isFullyInitialized()||oe(n),t.filter.filtersNodes())}}function xm(t,e,n,r,i,s,o,a){let c=e.serverCache,u,l=o?t.filter:t.filter.getIndexedFilter();if(oe(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){let f=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),f,null)}else{let f=se(n);if(!c.isCompleteForPath(n)&&ns(n)>1)return e;let p=Ae(n),v=c.getNode().getImmediateChild(f).updateChild(p,r);f===".priority"?u=l.updatePriority(c.getNode(),v):u=l.updateChild(c.getNode(),f,v,p,mO,null)}let d=lO(e,u,c.isFullyInitialized()||oe(n),l.filtersNodes()),h=new Id(i,d,s);return _O(t,d,n,i,h,a)}function gC(t,e,n,r,i,s,o){let a=e.eventCache,c,u,l=new Id(i,e,s);if(oe(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,o),c=hd(e,u,!0,t.filter.filtersNodes());else{let d=se(n);if(d===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),r),c=hd(e,u,a.isFullyInitialized(),a.isFiltered());else{let h=Ae(n),f=a.getNode().getImmediateChild(d),p;if(oe(h))p=r;else{let m=l.getCompleteChild(d);m!=null?$C(h)===".priority"&&m.getChild(rO(h)).isEmpty()?p=m:p=m.updateChild(h,r):p=ee.EMPTY_NODE}if(f.equals(p))c=e;else{let m=t.filter.updateChild(a.getNode(),d,p,h,l,o);c=hd(e,m,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function b2(t,e){return t.eventCache.isCompleteForChild(e)}function iq(t,e,n,r,i,s,o){let a=e;return r.foreach((c,u)=>{let l=je(n,c);b2(e,se(l))&&(a=gC(t,a,l,u,i,s,o))}),r.foreach((c,u)=>{let l=je(n,c);b2(e,se(l))||(a=gC(t,a,l,u,i,s,o))}),a}function D2(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function mC(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;oe(n)?u=r:u=new Yt(null).setTree(n,r);let l=e.serverCache.getNode();return u.children.inorderTraversal((d,h)=>{if(l.hasChild(d)){let f=e.serverCache.getNode().getImmediateChild(d),p=D2(t,f,h);c=xm(t,c,new xe(d),p,i,s,o,a)}}),u.children.inorderTraversal((d,h)=>{let f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!l.hasChild(d)&&!f){let p=e.serverCache.getNode().getImmediateChild(d),m=D2(t,p,h);c=xm(t,c,new xe(d),m,i,s,o,a)}}),c}function sq(t,e,n,r,i,s,o){if(vm(i,n)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(oe(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return xm(t,e,n,c.getNode().getChild(n),i,s,a,o);if(oe(n)){let u=new Yt(null);return c.getNode().forEachChild(Pr,(l,d)=>{u=u.set(new xe(l),d)}),mC(t,e,n,u,i,s,a,o)}else return e}else{let u=new Yt(null);return r.foreach((l,d)=>{let h=je(n,l);c.isCompleteForPath(h)&&(u=u.set(l,c.getNode().getChild(h)))}),mC(t,e,n,u,i,s,a,o)}}function oq(t,e,n,r,i){let s=e.serverCache,o=lO(e,s.getNode(),s.isFullyInitialized()||oe(n),s.isFiltered());return _O(t,o,n,r,mO,i)}function aq(t,e,n,r,i,s){let o;if(vm(r,n)!=null)return e;{let a=new Id(r,e,i),c=e.eventCache.getNode(),u;if(oe(n)||se(n)===".priority"){let l;if(e.serverCache.isFullyInitialized())l=ym(r,vo(e));else{let d=e.serverCache.getNode();D(d instanceof ee,"serverChildren would be complete if leaf node"),l=YC(r,d)}l=l,u=t.filter.updateFullNode(c,l,s)}else{let l=se(n),d=ZC(r,l,e.serverCache);d==null&&e.serverCache.isCompleteForChild(l)&&(d=c.getImmediateChild(l)),d!=null?u=t.filter.updateChild(c,l,d,Ae(n),a,s):e.eventCache.getNode().hasChild(l)?u=t.filter.updateChild(c,l,ee.EMPTY_NODE,Ae(n),a,s):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=ym(r,vo(e)),o.isLeafNode()&&(u=t.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||vm(r,ve())!=null,hd(e,u,o,t.filter.filtersNodes())}}var _C=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new xd(r.getIndex()),s=SH(r);this.processor_=eq(s);let o=n.serverCache,a=n.eventCache,c=i.updateFullNode(ee.EMPTY_NODE,o.getNode(),null),u=s.updateFullNode(ee.EMPTY_NODE,a.getNode(),null),l=new Or(c,o.isFullyInitialized(),i.filtersNodes()),d=new Or(u,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=km(d,l),this.eventGenerator_=new uC(this.query_)}get query(){return this.query_}};function cq(t){return t.viewCache_.serverCache.getNode()}function uq(t){return _m(t.viewCache_)}function lq(t,e){let n=vo(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!oe(e)&&!n.getImmediateChild(se(e)).isEmpty())?n.getChild(e):null}function T2(t){return t.eventRegistrations_.length===0}function dq(t,e){t.eventRegistrations_.push(e)}function S2(t,e,n){let r=[];if(n){D(e==null,"A cancel should cancel all event registrations.");let i=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function A2(t,e,n,r){e.type===Nr.MERGE&&e.source.queryId!==null&&(D(vo(t.viewCache_),"We should always have a full cache before handling merges"),D(_m(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=nq(t.processor_,i,e,n,r);return tq(t.processor_,s.viewCache),D(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,yO(t,s.changes,s.viewCache.eventCache.getNode(),null)}function hq(t,e){let n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Pe,(s,o)=>{r.push(Tc(s,o))}),n.isFullyInitialized()&&r.push(uO(n.getNode())),yO(t,r,n.getNode(),e)}function yO(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return FH(t.eventGenerator_,e,n,i)}var wm,Em=class{constructor(){this.views=new Map}};function fq(t){D(!wm,"__referenceConstructor has already been defined"),wm=t}function pq(){return D(wm,"Reference.ts has not been loaded"),wm}function gq(t){return t.views.size===0}function XC(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return D(s!=null,"SyncTree gave us an op for an invalid query."),A2(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat(A2(o,e,n,r));return s}}function vO(t,e,n,r,i){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=ym(n,i?r:null),c=!1;a?c=!0:r instanceof ee?(a=YC(n,r),c=!1):(a=ee.EMPTY_NODE,c=!1);let u=km(new Or(a,c,!1),new Or(r,i,!1));return new _C(e,u)}return o}function mq(t,e,n,r,i,s){let o=vO(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),dq(o,n),hq(o,n)}function _q(t,e,n,r){let i=e._queryIdentifier,s=[],o=[],a=rs(t);if(i==="default")for(let[c,u]of t.views.entries())o=o.concat(S2(u,n,r)),T2(u)&&(t.views.delete(c),u.query._queryParams.loadsAllData()||s.push(u.query));else{let c=t.views.get(i);c&&(o=o.concat(S2(c,n,r)),T2(c)&&(t.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!rs(t)&&s.push(new(pq())(e._repo,e._path)),{removed:s,events:o}}function xO(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function es(t,e){let n=null;for(let r of t.views.values())n=n||lq(r,e);return n}function wO(t,e){if(e._queryParams.loadsAllData())return Fm(t);{let r=e._queryIdentifier;return t.views.get(r)}}function EO(t,e){return wO(t,e)!=null}function rs(t){return Fm(t)!=null}function Fm(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Im;function yq(t){D(!Im,"__referenceConstructor has already been defined"),Im=t}function vq(){return D(Im,"Reference.ts has not been loaded"),Im}var xq=1,Cm=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Yt(null),this.pendingWriteTree_=XH(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function JC(t,e,n,r,i){return BH(t.pendingWriteTree_,e,n,r,i),i?kc(t,new Sc(WC(),e,n)):[]}function wq(t,e,n,r){UH(t.pendingWriteTree_,e,n,r);let i=Yt.fromObject(n);return kc(t,new Ed(WC(),e,i))}function Xi(t,e,n=!1){let r=$H(t.pendingWriteTree_,e);if(HH(t.pendingWriteTree_,e)){let s=new Yt(null);return r.snap!=null?s=s.set(ve(),!0):xt(r.children,o=>{s=s.set(new xe(o),!0)}),kc(t,new cC(r.path,s,n))}else return[]}function Nd(t,e,n){return kc(t,new Sc(KC(),e,n))}function Eq(t,e,n){let r=Yt.fromObject(n);return kc(t,new Ed(KC(),e,r))}function Iq(t,e){return kc(t,new mm(KC(),e))}function Cq(t,e,n){let r=eb(t,n);if(r){let i=tb(r),s=i.path,o=i.queryId,a=Qt(s,e),c=new mm(QC(o),a);return nb(t,s,c)}else return[]}function bm(t,e,n,r,i=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||EO(o,e))){let c=_q(o,e,n,r);gq(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let u=c.removed;if(a=c.events,!i){let l=u.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,f)=>rs(f));if(l&&!d){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let f=Tq(h);for(let p=0;p<f.length;++p){let m=f[p],v=m.query,b=DO(t,m);t.listenProvider_.startListening(pd(v),Cd(t,v),b.hashFn,b.onComplete)}}}!d&&u.length>0&&!r&&(l?t.listenProvider_.stopListening(pd(e),null):u.forEach(h=>{let f=t.queryToTagMap.get(Lm(h));t.listenProvider_.stopListening(pd(h),f)}))}Sq(t,u)}return a}function IO(t,e,n,r){let i=eb(t,r);if(i!=null){let s=tb(i),o=s.path,a=s.queryId,c=Qt(o,e),u=new Sc(QC(a),c,n);return nb(t,o,u)}else return[]}function bq(t,e,n,r){let i=eb(t,r);if(i){let s=tb(i),o=s.path,a=s.queryId,c=Qt(o,e),u=Yt.fromObject(n),l=new Ed(QC(a),c,u);return nb(t,o,l)}else return[]}function yC(t,e,n,r=!1){let i=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(h,f)=>{let p=Qt(h,i);s=s||es(f,p),o=o||rs(f)});let a=t.syncPointTree_.get(i);a?(o=o||rs(a),s=s||es(a,ve())):(a=new Em,t.syncPointTree_=t.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=ee.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((f,p)=>{let m=es(p,ve());m&&(s=s.updateImmediateChild(f,m))}));let u=EO(a,e);if(!u&&!e._queryParams.loadsAllData()){let h=Lm(e);D(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let f=Aq();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}let l=Om(t.pendingWriteTree_,i),d=mq(a,e,n,l,s,c);if(!u&&!o&&!r){let h=wO(a,e);d=d.concat(Mq(t,e,h))}return d}function Vm(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let c=Qt(o,e),u=es(a,c);if(u)return u});return fO(i,e,s,n,!0)}function Dq(t,e){let n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(u,l)=>{let d=Qt(u,n);r=r||es(l,d)});let i=t.syncPointTree_.get(n);i?r=r||es(i,ve()):(i=new Em,t.syncPointTree_=t.syncPointTree_.set(n,i));let s=r!=null,o=s?new Or(r,!0,!1):null,a=Om(t.pendingWriteTree_,e._path),c=vO(i,e,a,s?o.getNode():ee.EMPTY_NODE,s);return uq(c)}function kc(t,e){return CO(e,t.syncPointTree_,null,Om(t.pendingWriteTree_,ve()))}function CO(t,e,n,r){if(oe(t.path))return bO(t,e,n,r);{let i=e.get(ve());n==null&&i!=null&&(n=es(i,ve()));let s=[],o=se(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){let u=n?n.getImmediateChild(o):null,l=pO(r,o);s=s.concat(CO(a,c,u,l))}return i&&(s=s.concat(XC(i,t,r,n))),s}}function bO(t,e,n,r){let i=e.get(ve());n==null&&i!=null&&(n=es(i,ve()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=n?n.getImmediateChild(o):null,u=pO(r,o),l=t.operationForChild(o);l&&(s=s.concat(bO(l,a,c,u)))}),i&&(s=s.concat(XC(i,t,r,n))),s}function DO(t,e){let n=e.query,r=Cd(t,n);return{hashFn:()=>(cq(e)||ee.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?Cq(t,n._path,r):Iq(t,n._path);{let s=B7(i,n);return bm(t,n,null,s)}}}}function Cd(t,e){let n=Lm(e);return t.queryToTagMap.get(n)}function Lm(t){return t._path.toString()+"$"+t._queryIdentifier}function eb(t,e){return t.tagToQueryMap.get(e)}function tb(t){let e=t.indexOf("$");return D(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new xe(t.substr(0,e))}}function nb(t,e,n){let r=t.syncPointTree_.get(e);D(r,"Missing sync point for query tag that we're tracking");let i=Om(t.pendingWriteTree_,e);return XC(r,n,i,null)}function Tq(t){return t.fold((e,n,r)=>{if(n&&rs(n))return[Fm(n)];{let i=[];return n&&(i=xO(n)),xt(r,(s,o)=>{i=i.concat(o)}),i}})}function pd(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(vq())(t._repo,t._path):t}function Sq(t,e){for(let n=0;n<e.length;++n){let r=e[n];if(!r._queryParams.loadsAllData()){let i=Lm(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function Aq(){return xq++}function Mq(t,e,n){let r=e._path,i=Cd(t,e),s=DO(t,n),o=t.listenProvider_.startListening(pd(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)D(!rs(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((u,l,d)=>{if(!oe(u)&&l&&rs(l))return[Fm(l).query];{let h=[];return l&&(h=h.concat(xO(l).map(f=>f.query))),xt(d,(f,p)=>{h=h.concat(p)}),h}});for(let u=0;u<c.length;++u){let l=c[u];t.listenProvider_.stopListening(pd(l),Cd(t,l))}}return o}var vC=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},xC=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=je(this.path_,e);return new t(this.syncTree_,n)}node(){return Vm(this.syncTree_,this.path_)}},Rq=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},M2=function(t,e,n){if(!t||typeof t!="object")return t;if(D(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return Nq(t[".sv"],e,n);if(typeof t[".sv"]=="object")return Pq(t[".sv"],e);D(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},Nq=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:D(!1,"Unexpected server value: "+t)}},Pq=function(t,e,n){t.hasOwnProperty("increment")||D(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&D(!1,"Unexpected increment value: "+r);let i=e.node();if(D(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},TO=function(t,e,n,r){return ib(e,new xC(n,t),r)},rb=function(t,e,n){return ib(t,new vC(e),n)};function ib(t,e,n){let r=t.getPriority().val(),i=M2(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=M2(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new bc(a,Ue(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new bc(i))),o.forEachChild(Pe,(a,c)=>{let u=ib(c,e.getImmediateChild(a),n);u!==c&&(s=s.updateImmediateChild(a,u))}),s}}var bd=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function jm(t,e){let n=e instanceof xe?e:new xe(e),r=t,i=se(n);for(;i!==null;){let s=ui(r.node.children,i)||{children:{},childCount:0};r=new bd(i,r,s),n=Ae(n),i=se(n)}return r}function Eo(t){return t.node.value}function sb(t,e){t.node.value=e,wC(t)}function SO(t){return t.node.childCount>0}function kq(t){return Eo(t)===void 0&&!SO(t)}function Bm(t,e){xt(t.node.children,(n,r)=>{e(new bd(n,t,r))})}function AO(t,e,n,r){n&&!r&&e(t),Bm(t,i=>{AO(i,e,!0,r)}),n&&r&&e(t)}function Oq(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Pd(t){return new xe(t.parent===null?t.name:Pd(t.parent)+"/"+t.name)}function wC(t){t.parent!==null&&Fq(t.parent,t.name,t)}function Fq(t,e,n){let r=kq(n),i=In(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,wC(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,wC(t))}var Vq=/[\[\].#$\/\u0000-\u001F\u007F]/,Lq=/[\[\].#$\u0000-\u001F\u007F]/,NI=10*1024*1024,Um=function(t){return typeof t=="string"&&t.length!==0&&!Vq.test(t)},MO=function(t){return typeof t=="string"&&t.length!==0&&!Lq.test(t)},jq=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),MO(t)},Dd=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Nm(t)||t&&typeof t=="object"&&In(t,".sv")},Fr=function(t,e,n,r){r&&e===void 0||kd(Jt(t,"value"),e,n)},kd=function(t,e,n){let r=n instanceof xe?new GI(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+mo(r));if(typeof e=="function")throw new Error(t+"contains a function "+mo(r)+" with contents = "+e.toString());if(Nm(e))throw new Error(t+"contains "+e.toString()+" "+mo(r));if(typeof e=="string"&&e.length>NI/3&&jc(e)>NI)throw new Error(t+"contains a string greater than "+NI+" utf8 bytes "+mo(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(xt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Um(o)))throw new Error(t+" contains an invalid key ("+o+") "+mo(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);gH(r,o),kd(t,a,r),mH(r)}),i&&s)throw new Error(t+' contains ".value" child '+mo(r)+" in addition to actual children.")}},Bq=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];let s=md(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!Um(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(pH);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&Vn(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},RO=function(t,e,n,r){if(r&&e===void 0)return;let i=Jt(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];xt(e,(o,a)=>{let c=new xe(o);if(kd(i,a,je(n,c)),$C(c)===".priority"&&!Dd(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),Bq(i,s)},ob=function(t,e,n){if(!(n&&e===void 0)){if(Nm(e))throw new Error(Jt(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Dd(e))throw new Error(Jt(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Od=function(t,e,n,r){if(!(r&&n===void 0)&&!Um(n))throw new Error(Jt(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Oc=function(t,e,n,r){if(!(r&&n===void 0)&&!MO(n))throw new Error(Jt(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Uq=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Oc(t,e,n,r)},vn=function(t,e){if(se(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},NO=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Um(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!jq(n))throw new Error(Jt(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var EC=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function $m(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!HC(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function PO(t,e,n){$m(t,n),kO(t,r=>HC(r,e))}function xn(t,e,n){$m(t,n),kO(t,r=>Vn(r,e)||Vn(e,r))}function kO(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?($q(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function $q(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();yo&&vt("event: "+n.toString()),Nc(r)}}}var OO="repo_interrupt",Hq=25,IC=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new EC,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=gm(),this.transactionQueueTree_=new bd,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function qq(t,e,n){if(t.stats_=UC(t.repoInfo_),t.forceRestClient_||q7())t.server_=new nC(t.repoInfo_,(r,i,s,o)=>{R2(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>N2(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ze(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new qC(t.repoInfo_,e,(r,i,s,o)=>{R2(t,r,i,s,o)},r=>{N2(t,r)},r=>{Gq(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=z7(t.repoInfo_,()=>new aC(t.stats_,t.server_)),t.infoData_=new rC,t.infoSyncTree_=new Cm({startListening:(r,i,s,o)=>{let a=[],c=t.infoData_.getNode(r._path);return c.isEmpty()||(a=Nd(t.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),ab(t,"connected",!1),t.serverSyncTree_=new Cm({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,c)=>{let u=o(a,c);xn(t.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function FO(t){let n=t.infoData_.getNode(new xe(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Fd(t){return Rq({timestamp:FO(t)})}function R2(t,e,n,r,i){t.dataUpdateCount++;let s=new xe(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let c=Lc(n,u=>Ue(u));o=bq(t.serverSyncTree_,s,c,i)}else{let c=Ue(n);o=IO(t.serverSyncTree_,s,c,i)}else if(r){let c=Lc(n,u=>Ue(u));o=Eq(t.serverSyncTree_,s,c)}else{let c=Ue(n);o=Nd(t.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=Mc(t,s)),xn(t.eventQueue_,a,o)}function N2(t,e){ab(t,"connected",e),e===!1&&Kq(t)}function Gq(t,e){xt(e,(n,r)=>{ab(t,n,r)})}function ab(t,e,n){let r=new xe("/.info/"+e),i=Ue(n);t.infoData_.updateSnapshot(r,i);let s=Nd(t.infoSyncTree_,r,i);xn(t.eventQueue_,r,s)}function Hm(t){return t.nextWriteId_++}function zq(t,e,n){let r=Dq(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{let s=Ue(i).withIndex(e._queryParams.getIndex());yC(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Nd(t.serverSyncTree_,e._path,s);else{let a=Cd(t.serverSyncTree_,e);o=IO(t.serverSyncTree_,e._path,s,a)}return xn(t.eventQueue_,e._path,o),bm(t.serverSyncTree_,e,n,null,!0),s},i=>(Fc(t,"get for query "+Ze(e)+" failed: "+i),Promise.reject(new Error(i))))}function cb(t,e,n,r,i){Fc(t,"set",{path:e.toString(),value:n,priority:r});let s=Fd(t),o=Ue(n,r),a=Vm(t.serverSyncTree_,e),c=rb(o,a,s),u=Hm(t),l=JC(t.serverSyncTree_,e,c,u,!0);$m(t.eventQueue_,l),t.server_.put(e.toString(),o.val(!0),(h,f)=>{let p=h==="ok";p||Ft("set at "+e+" failed: "+h);let m=Xi(t.serverSyncTree_,u,!p);xn(t.eventQueue_,e,m),is(t,i,h,f)});let d=lb(t,e);Mc(t,d),xn(t.eventQueue_,d,[])}function Wq(t,e,n,r){Fc(t,"update",{path:e.toString(),value:n});let i=!0,s=Fd(t),o={};if(xt(n,(a,c)=>{i=!1,o[a]=TO(je(e,a),Ue(c),t.serverSyncTree_,s)}),i)vt("update() called with empty data.  Don't do anything."),is(t,r,"ok",void 0);else{let a=Hm(t),c=wq(t.serverSyncTree_,e,o,a);$m(t.eventQueue_,c),t.server_.merge(e.toString(),n,(u,l)=>{let d=u==="ok";d||Ft("update at "+e+" failed: "+u);let h=Xi(t.serverSyncTree_,a,!d),f=h.length>0?Mc(t,e):e;xn(t.eventQueue_,f,h),is(t,r,u,l)}),xt(n,u=>{let l=lb(t,je(e,u));Mc(t,l)}),xn(t.eventQueue_,e,[])}}function Kq(t){Fc(t,"onDisconnectEvents");let e=Fd(t),n=gm();sC(t.onDisconnect_,ve(),(i,s)=>{let o=TO(i,s,t.serverSyncTree_,e);Pc(n,i,o)});let r=[];sC(n,ve(),(i,s)=>{r=r.concat(Nd(t.serverSyncTree_,i,s));let o=lb(t,i);Mc(t,o)}),t.onDisconnect_=gm(),xn(t.eventQueue_,ve(),r)}function Qq(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&iC(t.onDisconnect_,e),is(t,n,r,i)})}function P2(t,e,n,r){let i=Ue(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Pc(t.onDisconnect_,e,i),is(t,r,s,o)})}function Yq(t,e,n,r,i){let s=Ue(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&Pc(t.onDisconnect_,e,s),is(t,i,o,a)})}function Zq(t,e,n,r){if(Gd(n)){vt("onDisconnect().update() called with empty data.  Don't do anything."),is(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&xt(n,(o,a)=>{let c=Ue(a);Pc(t.onDisconnect_,je(e,o),c)}),is(t,r,i,s)})}function Xq(t,e,n){let r;se(e._path)===".info"?r=yC(t.infoSyncTree_,e,n):r=yC(t.serverSyncTree_,e,n),PO(t.eventQueue_,e._path,r)}function CC(t,e,n){let r;se(e._path)===".info"?r=bm(t.infoSyncTree_,e,n):r=bm(t.serverSyncTree_,e,n),PO(t.eventQueue_,e._path,r)}function VO(t){t.persistentConnection_&&t.persistentConnection_.interrupt(OO)}function Jq(t){t.persistentConnection_&&t.persistentConnection_.resume(OO)}function Fc(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),vt(n,...e)}function is(t,e,n,r){e&&Nc(()=>{if(n==="ok")e(null);else{let i=(n||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function eG(t,e,n,r,i,s){Fc(t,"transaction on "+e);let o={path:e,update:n,onComplete:r,status:null,order:F2(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=ub(t,e,void 0);o.currentInputSnapshot=a;let c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{kd("transaction failed: Data returned ",c,o.path),o.status=0;let u=jm(t.transactionQueueTree_,e),l=Eo(u)||[];l.push(o),sb(u,l);let d;typeof c=="object"&&c!==null&&In(c,".priority")?(d=ui(c,".priority"),D(Dd(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(Vm(t.serverSyncTree_,e)||ee.EMPTY_NODE).getPriority().val();let h=Fd(t),f=Ue(c,d),p=rb(f,a,h);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=Hm(t);let m=JC(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);xn(t.eventQueue_,e,m),qm(t,t.transactionQueueTree_)}}function ub(t,e,n){return Vm(t.serverSyncTree_,e,n)||ee.EMPTY_NODE}function qm(t,e=t.transactionQueueTree_){if(e||Gm(t,e),Eo(e)){let n=jO(t,e);D(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&tG(t,Pd(e),n)}else SO(e)&&Bm(e,n=>{qm(t,n)})}function tG(t,e,n){let r=n.map(u=>u.currentWriteId),i=ub(t,e,r),s=i,o=i.hash();for(let u=0;u<n.length;u++){let l=n[u];D(l.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),l.status=1,l.retryCount++;let d=Qt(e,l.path);s=s.updateChild(d,l.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;t.server_.put(c.toString(),a,u=>{Fc(t,"transaction put response",{path:c.toString(),status:u});let l=[];if(u==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,l=l.concat(Xi(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();Gm(t,jm(t.transactionQueueTree_,e)),qm(t,t.transactionQueueTree_),xn(t.eventQueue_,e,l);for(let h=0;h<d.length;h++)Nc(d[h])}else{if(u==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{Ft("transaction at "+c.toString()+" failed: "+u);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=u}Mc(t,e)}},o)}function Mc(t,e){let n=LO(t,e),r=Pd(n),i=jO(t,n);return nG(t,i,r),r}function nG(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],u=Qt(n,c.path),l=!1,d;if(D(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)l=!0,d=c.abortReason,i=i.concat(Xi(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=Hq)l=!0,d="maxretry",i=i.concat(Xi(t.serverSyncTree_,c.currentWriteId,!0));else{let h=ub(t,c.path,o);c.currentInputSnapshot=h;let f=e[a].update(h.val());if(f!==void 0){kd("transaction failed: Data returned ",f,c.path);let p=Ue(f);typeof f=="object"&&f!=null&&In(f,".priority")||(p=p.updatePriority(h.getPriority()));let v=c.currentWriteId,b=Fd(t),F=rb(p,h,b);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=F,c.currentWriteId=Hm(t),o.splice(o.indexOf(v),1),i=i.concat(JC(t.serverSyncTree_,c.path,F,c.currentWriteId,c.applyLocally)),i=i.concat(Xi(t.serverSyncTree_,v,!0))}else l=!0,d="nodata",i=i.concat(Xi(t.serverSyncTree_,c.currentWriteId,!0))}xn(t.eventQueue_,n,i),i=[],l&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}Gm(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Nc(r[a]);qm(t,t.transactionQueueTree_)}function LO(t,e){let n,r=t.transactionQueueTree_;for(n=se(e);n!==null&&Eo(r)===void 0;)r=jm(r,n),e=Ae(e),n=se(e);return r}function jO(t,e){let n=[];return BO(t,e,n),n.sort((r,i)=>r.order-i.order),n}function BO(t,e,n){let r=Eo(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);Bm(e,i=>{BO(t,i,n)})}function Gm(t,e){let n=Eo(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,sb(e,n.length>0?n:void 0)}Bm(e,r=>{Gm(t,r)})}function lb(t,e){let n=Pd(LO(t,e)),r=jm(t.transactionQueueTree_,e);return Oq(r,i=>{PI(t,i)}),PI(t,r),AO(r,i=>{PI(t,i)}),n}function PI(t,e){let n=Eo(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(D(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(D(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(Xi(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?sb(e,void 0):n.length=s+1,xn(t.eventQueue_,Pd(e),i);for(let o=0;o<r.length;o++)Nc(r[o])}}function rG(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function iG(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Ft(`Invalid query segment '${n}' in query '${t}'`)}return e}var bC=function(t,e){let n=sG(t),r=n.namespace;n.domain==="firebase.com"&&kr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&kr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||O7();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new am(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new xe(n.pathString)}},sG=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",c=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));let l=t.indexOf("/");l===-1&&(l=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(l,d)),l<d&&(i=rG(t.substring(l,d)));let h=iG(t.substring(Math.min(t.length,d)));u=e.indexOf(":"),u>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;let f=e.slice(0,u);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=r}"ns"in h&&(s=h.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var k2="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",oG=function(){let t=0,e=[];return function(n){let r=n===t;t=n;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=k2.charAt(n%64),n=Math.floor(n/64);D(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=k2.charAt(e[i]);return D(o.length===20,"nextPushId: Length should be 20."),o}}();var Dm=class{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Ze(this.snapshot.exportVal())}},Tm=class{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Td=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return D(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var Sm=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new ht;return Qq(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){vn("OnDisconnect.remove",this._path);let e=new ht;return P2(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){vn("OnDisconnect.set",this._path),Fr("OnDisconnect.set",e,this._path,!1);let n=new ht;return P2(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){vn("OnDisconnect.setWithPriority",this._path),Fr("OnDisconnect.setWithPriority",e,this._path,!1),ob("OnDisconnect.setWithPriority",n,!1);let r=new ht;return Yq(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){vn("OnDisconnect.update",this._path),RO("OnDisconnect.update",e,this._path,!1);let n=new ht;return Zq(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var Zt=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return oe(this._path)?null:$C(this._path)}get ref(){return new wn(this._repo,this._path)}get _queryIdentifier(){let e=x2(this._queryParams),n=BC(e);return n==="{}"?"default":n}get _queryObject(){return x2(this._queryParams)}isEqual(e){if(e=le(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=HC(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+fH(this._path)}};function zm(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function os(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Pr){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==ts)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==ai)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Pe){if(e!=null&&!Dd(e)||n!=null&&!Dd(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(D(t.getIndex()instanceof _d||t.getIndex()===zC,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Wm(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var wn=class t extends Zt{constructor(e,n){super(e,n,new wd,!1)}get parent(){let e=rO(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Rc=class t{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new xe(e),r=ss(this.ref,e);return new t(this._node.getChild(n),r,Pe)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new t(i,ss(this.ref,r),Pe)))}hasChild(e){let n=new xe(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function db(t,e){return t=le(t),t._checkNotDeleted("ref"),e!==void 0?ss(t._root,e):t._root}function hb(t,e){t=le(t),t._checkNotDeleted("refFromURL");let n=bC(e,t._repo.repoInfo_.nodeAdmin);NO("refFromURL",n);let r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&kr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),db(t,n.path.toString())}function ss(t,e){return t=le(t),se(t._path)===null?Uq("child","path",e,!1):Oc("child","path",e,!1),new wn(t._repo,je(t._path,e))}function UO(t,e){t=le(t),vn("push",t._path),Fr("push",e,t._path,!0);let n=FO(t._repo),r=oG(n),i=ss(t,r),s=ss(t,r),o;return e!=null?o=Km(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function $O(t){return vn("remove",t._path),Km(t,null)}function Km(t,e){t=le(t),vn("set",t._path),Fr("set",e,t._path,!1);let n=new ht;return cb(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function HO(t,e){t=le(t),vn("setPriority",t._path),ob("setPriority",e,!1);let n=new ht;return cb(t._repo,je(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function qO(t,e,n){if(vn("setWithPriority",t._path),Fr("setWithPriority",e,t._path,!1),ob("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let r=new ht;return cb(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function GO(t,e){RO("update",e,t._path,!1);let n=new ht;return Wq(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function zO(t){t=le(t);let e=new Td(()=>{}),n=new Sd(e);return zq(t._repo,t,n).then(r=>new Rc(r,new wn(t._repo,t._path),t._queryParams.getIndex()))}var Sd=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let r=n._queryParams.getIndex();return new Dm("value",this,new Rc(e.snapshotNode,new wn(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Tm(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},Am=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Tm(this,e,n):null}createEvent(e,n){D(e.childName!=null,"Child events should have a childName.");let r=ss(new wn(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new Dm(e.type,this,new Rc(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Vd(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=n,u=(l,d)=>{CC(t._repo,t,a),c(l,d)};u.userCallback=n.userCallback,u.context=n.context,n=u}let o=new Td(n,s||void 0),a=e==="value"?new Sd(o):new Am(e,o);return Xq(t._repo,t,a),()=>CC(t._repo,t,a)}function Qm(t,e,n,r){return Vd(t,"value",e,n,r)}function fb(t,e,n,r){return Vd(t,"child_added",e,n,r)}function pb(t,e,n,r){return Vd(t,"child_changed",e,n,r)}function gb(t,e,n,r){return Vd(t,"child_moved",e,n,r)}function mb(t,e,n,r){return Vd(t,"child_removed",e,n,r)}function _b(t,e,n){let r=null,i=n?new Td(n):null;e==="value"?r=new Sd(i):e&&(r=new Am(e,i)),CC(t._repo,t,r)}var En=class{},Mm=class extends En{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){Fr("endAt",this._value,e._path,!0);let n=tC(e._queryParams,this._value,this._key);if(Wm(n),os(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Zt(e._repo,e._path,n,e._orderByCalled)}};function WO(t,e){return Od("endAt","key",e,!0),new Mm(t,e)}var DC=class extends En{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){Fr("endBefore",this._value,e._path,!1);let n=NH(e._queryParams,this._value,this._key);if(Wm(n),os(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Zt(e._repo,e._path,n,e._orderByCalled)}};function KO(t,e){return Od("endBefore","key",e,!0),new DC(t,e)}var Rm=class extends En{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){Fr("startAt",this._value,e._path,!0);let n=eC(e._queryParams,this._value,this._key);if(Wm(n),os(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Zt(e._repo,e._path,n,e._orderByCalled)}};function QO(t=null,e){return Od("startAt","key",e,!0),new Rm(t,e)}var TC=class extends En{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){Fr("startAfter",this._value,e._path,!1);let n=RH(e._queryParams,this._value,this._key);if(Wm(n),os(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Zt(e._repo,e._path,n,e._orderByCalled)}};function YO(t,e){return Od("startAfter","key",e,!0),new TC(t,e)}var SC=class extends En{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Zt(e._repo,e._path,AH(e._queryParams,this._limit),e._orderByCalled)}};function ZO(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new SC(t)}var AC=class extends En{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Zt(e._repo,e._path,MH(e._queryParams,this._limit),e._orderByCalled)}};function XO(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new AC(t)}var MC=class extends En{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){zm(e,"orderByChild");let n=new xe(this._path);if(oe(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new _d(n),i=Pm(e._queryParams,r);return os(i),new Zt(e._repo,e._path,i,!0)}};function JO(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Oc("orderByChild","path",t,!1),new MC(t)}var RC=class extends En{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){zm(e,"orderByKey");let n=Pm(e._queryParams,Pr);return os(n),new Zt(e._repo,e._path,n,!0)}};function eF(){return new RC}var NC=class extends En{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){zm(e,"orderByPriority");let n=Pm(e._queryParams,Pe);return os(n),new Zt(e._repo,e._path,n,!0)}};function tF(){return new NC}var PC=class extends En{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){zm(e,"orderByValue");let n=Pm(e._queryParams,zC);return os(n),new Zt(e._repo,e._path,n,!0)}};function nF(){return new PC}var kC=class extends En{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(Fr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Mm(this._value,this._key)._apply(new Rm(this._value,this._key)._apply(e))}};function rF(t,e){return Od("equalTo","key",e,!0),new kC(t,e)}function jn(t,...e){let n=le(t);for(let r of e)n=r._apply(n);return n}fq(wn);yq(wn);var aG="FIREBASE_DATABASE_EMULATOR_HOST",OC={},cG=!1;function uG(t,e,n,r){t.repoInfo_=new am(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function yb(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||kr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),vt("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=bC(s,i),a=o.repoInfo,c,u;typeof process<"u"&&process.env&&(u=process.env[aG]),u?(c=!0,s=`http://${u}?ns=${a.namespace}`,o=bC(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let l=i&&c?new dd(dd.OWNER):new jI(t.name,t.options,e);NO("Invalid Firebase Database URL",o),oe(o.path)||kr("Database URL must point to the root of a Firebase Database (not including a child path).");let d=dG(a,t,l,new LI(t.name,n));return new FC(d,t)}function lG(t,e){let n=OC[e];(!n||n[t.key]!==t)&&kr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),VO(t),delete n[t.key]}function dG(t,e,n,r){let i=OC[e.name];i||(i={},OC[e.name]=i);let s=i[t.toURLString()];return s&&kr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new IC(t,cG,n,r),i[t.toURLString()]=s,s}var FC=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(qq(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new wn(this._repo,ve())),this._rootInternal}_delete(){return this._rootInternal!==null&&(lG(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&kr("Cannot call "+e+" on a deleted database.")}};function iF(){nO.IS_TRANSPORT_INITIALIZED&&Ft("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function sF(){iF(),gd.forceDisallow()}function oF(){iF(),wc.forceDisallow(),gd.forceAllow()}function aF(t,e,n,r={}){t=le(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&kr("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&kr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new dd(dd.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:$d(r.mockUserToken,t.app.options.projectId);s=new dd(o)}uG(i,e,n,s)}function cF(t){t=le(t),t._checkNotDeleted("goOffline"),VO(t._repo)}function uF(t){t=le(t),t._checkNotDeleted("goOnline"),Jq(t._repo)}function lF(t,e){L2(t,e)}function hG(t){jC(Wd),as(new dn("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return yb(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),Bn(r2,i2,t),Bn(r2,i2,"esm2017")}var fG={".sv":"timestamp"};function dF(){return fG}function hF(t){return{".sv":{increment:t}}}var VC=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function fF(t,e,n){var r;if(t=le(t),vn("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let i=(r=n?.applyLocally)!==null&&r!==void 0?r:!0,s=new ht,o=(c,u,l)=>{let d=null;c?s.reject(c):(d=new Rc(l,new wn(t._repo,t._path),Pe),s.resolve(new VC(u,d)))},a=Qm(t,()=>{});return eG(t._repo,t._path,e,o,a,i),s.promise}qC.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};qC.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};hG();var pG="@firebase/database-compat",gG="1.0.4";var mG=new li("@firebase/database-compat"),pF=function(t){let e="FIREBASE WARNING: "+t;mG.warn(e)};var _G=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(Jt(t,e)+"must be a boolean.")},yG=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Jt(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var vb=class{constructor(e){this._delegate=e}cancel(e){q("OnDisconnect.cancel",0,1,arguments.length),ct("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){q("OnDisconnect.remove",0,1,arguments.length),ct("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){q("OnDisconnect.set",1,2,arguments.length),ct("OnDisconnect.set","onComplete",n,!0);let r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){q("OnDisconnect.setWithPriority",2,3,arguments.length),ct("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(q("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,pF("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ct("OnDisconnect.update","onComplete",n,!0);let r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}};var xb=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return q("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var Io=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return q("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return q("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return q("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return q("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return q("DataSnapshot.child",0,1,arguments.length),e=String(e),Oc("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return q("DataSnapshot.hasChild",1,1,arguments.length),Oc("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return q("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return q("DataSnapshot.forEach",1,1,arguments.length),ct("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return q("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return q("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return q("DataSnapshot.ref",0,0,arguments.length),new ci(this._database,this._delegate.ref)}get ref(){return this.getRef()}},Ym=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;q("Query.on",2,4,arguments.length),ct("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",r,i),a=(u,l)=>{n.call(o.context,new Io(this.database,u),l)};a.userCallback=n,a.context=o.context;let c=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return Qm(this._delegate,a,c),n;case"child_added":return fb(this._delegate,a,c),n;case"child_removed":return mb(this._delegate,a,c),n;case"child_changed":return pb(this._delegate,a,c),n;case"child_moved":return gb(this._delegate,a,c),n;default:throw new Error(Jt("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(q("Query.off",0,3,arguments.length),yG("Query.off",e,!0),ct("Query.off","callback",n,!0),n_("Query.off","context",r,!0),n){let i=()=>{};i.userCallback=n,i.context=r,_b(this._delegate,e,i)}else _b(this._delegate,e)}get(){return zO(this._delegate).then(e=>new Io(this.database,e))}once(e,n,r,i){q("Query.once",1,4,arguments.length),ct("Query.once","callback",n,!0);let s=t.getCancelAndContextArgs_("Query.once",r,i),o=new ht,a=(u,l)=>{let d=new Io(this.database,u);n&&n.call(s.context,d,l),o.resolve(d)};a.userCallback=n,a.context=s.context;let c=u=>{s.cancel&&s.cancel.call(s.context,u),o.reject(u)};switch(e){case"value":Qm(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":fb(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":mb(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":pb(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":gb(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(Jt("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return q("Query.limitToFirst",1,1,arguments.length),new t(this.database,jn(this._delegate,ZO(e)))}limitToLast(e){return q("Query.limitToLast",1,1,arguments.length),new t(this.database,jn(this._delegate,XO(e)))}orderByChild(e){return q("Query.orderByChild",1,1,arguments.length),new t(this.database,jn(this._delegate,JO(e)))}orderByKey(){return q("Query.orderByKey",0,0,arguments.length),new t(this.database,jn(this._delegate,eF()))}orderByPriority(){return q("Query.orderByPriority",0,0,arguments.length),new t(this.database,jn(this._delegate,tF()))}orderByValue(){return q("Query.orderByValue",0,0,arguments.length),new t(this.database,jn(this._delegate,nF()))}startAt(e=null,n){return q("Query.startAt",0,2,arguments.length),new t(this.database,jn(this._delegate,QO(e,n)))}startAfter(e=null,n){return q("Query.startAfter",0,2,arguments.length),new t(this.database,jn(this._delegate,YO(e,n)))}endAt(e=null,n){return q("Query.endAt",0,2,arguments.length),new t(this.database,jn(this._delegate,WO(e,n)))}endBefore(e=null,n){return q("Query.endBefore",0,2,arguments.length),new t(this.database,jn(this._delegate,KO(e,n)))}equalTo(e,n){return q("Query.equalTo",1,2,arguments.length),new t(this.database,jn(this._delegate,rF(e,n)))}toString(){return q("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return q("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(q("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){let i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,ct(e,"cancel",i.cancel,!0),i.context=r,n_(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(Jt(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new ci(this.database,new wn(this._delegate._repo,this._delegate._path))}},ci=class t extends Ym{constructor(e,n){super(e,new Zt(n._repo,n._path,new wd,!1)),this.database=e,this._delegate=n}getKey(){return q("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return q("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,ss(this._delegate,e))}getParent(){q("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return q("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){q("Reference.set",1,2,arguments.length),ct("Reference.set","onComplete",n,!0);let r=Km(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(q("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,pF("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}vn("Reference.update",this._delegate._path),ct("Reference.update","onComplete",n,!0);let r=GO(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){q("Reference.setWithPriority",2,3,arguments.length),ct("Reference.setWithPriority","onComplete",r,!0);let i=qO(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){q("Reference.remove",0,1,arguments.length),ct("Reference.remove","onComplete",e,!0);let n=$O(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){q("Reference.transaction",1,3,arguments.length),ct("Reference.transaction","transactionUpdate",e,!1),ct("Reference.transaction","onComplete",n,!0),_G("Reference.transaction","applyLocally",r,!0);let i=fF(this._delegate,e,{applyLocally:r}).then(s=>new xb(s.committed,new Io(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){q("Reference.setPriority",1,2,arguments.length),ct("Reference.setPriority","onComplete",n,!0);let r=HO(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){q("Reference.push",0,2,arguments.length),ct("Reference.push","onComplete",n,!0);let r=UO(this._delegate,e),i=r.then(o=>new t(this.database,o));n&&i.then(()=>n(null),o=>n(o));let s=new t(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return vn("Reference.onDisconnect",this._delegate._path),new vb(new Sm(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var Co=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:sF,forceLongPolling:oF}}useEmulator(e,n,r={}){aF(this._delegate,e,n,r)}ref(e){if(q("database.ref",0,1,arguments.length),e instanceof ci){let n=hb(this._delegate,e.toString());return new ci(this,n)}else{let n=db(this._delegate,e);return new ci(this,n)}}refFromURL(e){q("database.refFromURL",1,1,arguments.length);let r=hb(this._delegate,e);return new ci(this,r)}goOffline(){return q("database.goOffline",0,0,arguments.length),cF(this._delegate)}goOnline(){return q("database.goOnline",0,0,arguments.length),uF(this._delegate)}};Co.ServerValue={TIMESTAMP:dF(),increment:t=>hF(t)};function vG({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){jC(n);let a=new r_("database-standalone"),c=new zd("auth-internal",a);c.setComponent(new dn("auth-internal",()=>r,"PRIVATE"));let u;return i&&(u=new zd("app-check-internal",a),u.setComponent(new dn("app-check-internal",()=>i,"PRIVATE"))),{instance:new Co(yb(t,c,u,e,o),t),namespace:s}}var xG=Object.freeze({__proto__:null,initStandalone:vG});var wG=Co.ServerValue;function EG(t){t.INTERNAL.registerComponent(new dn("database-compat",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new Co(i,r)},"PUBLIC").setServiceProps({Reference:ci,Query:Ym,Database:Co,DataSnapshot:Io,enableLogging:lF,INTERNAL:xG,ServerValue:wG}).setMultipleInstances(!0)),t.registerVersion(pG,gG)}EG(wt);function Ld(t,e,n="on",r=hs){return new ie(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),n==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),n==="on"?{unsubscribe(){s!=null&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(j(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),zc())}function IG(t){return typeof t=="string"}function CG(t){return typeof t.exportVal=="function"}function vF(t){return t==null}function xF(t){return typeof t.set=="function"}function gF(t,e){return xF(e)?e:t.ref(e)}function wF(t,e){if(IG(t))return e.stringCase();if(xF(t))return e.firebaseCase();if(CG(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function EF(t){return(vF(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function IF(t,e,n){e=EF(e);let r=e.map(i=>Ld(t,i,"on",n));return Lo(...r)}function bG(t,e,n){let r=IF(t,e).pipe(ar((i,s)=>[...i,s],[]));return TG(t,r,n)}function DG(t,e){return Ld(t,"value","on",e).pipe(j(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}function TG(t,e,n){return DG(t,n).pipe(T_(e),j(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(c=>c.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),b_(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),j(i=>i.actions))}function mF(t,e){return function(r,i){return wF(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function SG(t){return function(n){return n?wF(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function AG(t,e,n){return Ld(t,"value","once",n).pipe(Fe(r=>{let i=[B(r)];return e.forEach(s=>i.push(Ld(t,s,"on",n))),Lo(...i).pipe(ar(RG,[]))}),Hc())}function CF(t,e){let n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function MG(t,e){if(vF(e))return 0;{let n=CF(t,e);return n===-1?t.length:n+1}}function RG(t,e){let{payload:n,prevKey:r,key:i}=e,s=CF(t,i),o=MG(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(c=>{let u={payload:c,type:"value",prevKey:a,key:c.key};return a=c.key,t=[...t,u],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(c=>c.payload.key!==n.key),t.splice(o,0,e));else{if(r==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=t.splice(s,1)[0];return t=t.slice(),t.splice(o,0,a),t}return t;default:return t}}function _F(t,e,n){return e=EF(e),AG(t,e,n)}function NG(t,e){let n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:mF(r,"update"),set:mF(r,"set"),push:i=>r.push(i),remove:SG(r),snapshotChanges(i){return _F(t,i,n).pipe(We)},stateChanges(i){return IF(t,i,n).pipe(We)},auditTrail(i){return bG(t,i,n).pipe(We)},valueChanges(i,s){return _F(t,i,n).pipe(j(a=>a.map(c=>s&&s.idField?ue(A({},c.payload.val()),{[s.idField]:c.key}):c.payload.val())),We)}}}function yF(t,e){return function(){return Ld(t,"value","on",e)}}function PG(t,e){return{query:t,snapshotChanges(){return yF(t,e.schedulers.outsideAngular)().pipe(We)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return yF(t,e.schedulers.outsideAngular)().pipe(We,j(r=>r.payload.exists()?r.payload.val():null))}}}var kG=new O("angularfire2.realtimeDatabaseURL"),OG=new O("angularfire2.database.use-emulator"),FG=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,c,u,l,d,h,f,p,m,v){this.schedulers=a;let b=c,F=Fs(n,o,r);u&&Hu(F,o,l,h,f,p,d,m),this.database=wa(`${F.name}.database.${i}`,"AngularFireDatabase",F.name,()=>{let T=o.runOutsideAngular(()=>F.database(i||void 0));return b&&T.useEmulator(...b),T},[b])}list(n,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>gF(this.database,n)),s=i;return r&&(s=r(i)),NG(s,this)}object(n){let r=this.schedulers.ngZone.runOutsideAngular(()=>gF(this.database,n));return PG(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(E(Ai),E(Mi,8),E(kG,8),E(Rt),E(de),E(xa),E(OG,8),E(ep,8),E(Vu,8),E(Lu,8),E(ju,8),E(Bu,8),E(Uu,8),E($u,8),E(Qr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),bF=(()=>{class t{constructor(){wt.registerVersion("angularfire",Os.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=tt({type:t});static \u0275inj=et({providers:[FG]})}return t})();var DF=(()=>{let e=class e{constructor(){this.title="360Car"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=tn({type:e,selectors:[["app-root"]],decls:21,vars:0,consts:[[1,"navbar"],["routerLink","/home",1,"navbar-brand"],["src","./assets/images/OIG_WB_white.png","alt","logo",1,"logo"],["routerLink","/home"],["routerLink","/coches"],["routerLink","/transacciones"],["routerLink","/clientes"],[1,"container"]],template:function(i,s){i&1&&(x(0,"header")(1,"nav",0)(2,"a",1),on(3,"img",2),x(4,"span"),S(5,"360Car"),C()(),x(6,"ul")(7,"li")(8,"a",3),S(9,"Home"),C()(),x(10,"li")(11,"a",4),S(12,"Coches"),C()(),x(13,"li")(14,"a",5),S(15,"Transacciones"),C()(),x(16,"li")(17,"a",6),S(18,"Clientes"),C()()()()(),x(19,"div",7),on(20,"router-outlet"),C())},dependencies:[pv,d1],styles:[".navbar[_ngcontent-%COMP%]{padding:0 2rem;display:flex;justify-content:space-between;align-items:center;background-color:var(--black)}.navbar-brand[_ngcontent-%COMP%]{display:flex;align-items:center}img[_ngcontent-%COMP%]{height:6rem}ul[_ngcontent-%COMP%]{display:flex;flex-direction:row}li[_ngcontent-%COMP%]{list-style:none;list-style-type:none;margin-left:3rem}a[_ngcontent-%COMP%]{text-decoration:none;color:var(--white);font-weight:700;font-size:1rem;transition:color ease .6s;padding:1rem}a[_ngcontent-%COMP%]:hover{color:var(--yellow)}"]});let t=e;return t})();var TF=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=tt({type:e,bootstrap:[DF]}),e.\u0275inj=et({imports:[IA,t2,Yk,M1.initializeApp(n2.firebaseConfig),bF]});let t=e;return t})();EA().bootstrapModule(TF).catch(t=>console.error(t));
